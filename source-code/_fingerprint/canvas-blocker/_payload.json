[{"data":1,"prerenderedAt":2325},["Reactive",2],{"navigation":3,"/source-code/_fingerprint/canvas-blocker":386,"/source-code/_fingerprint/canvas-blocker-surround":2318},[4,32,80,96,123,129,135,369,375,381],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":42,"_path":43},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":45,"_path":46},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":48,"_path":49},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":51,"_path":52},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":54,"_path":55},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":57,"_path":58},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":60,"_path":61},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":63,"_path":64},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":66,"_path":67},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":69,"_path":70},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":72,"_path":73},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":75,"_path":76},"🚝 四十二篇系列","/articles/fourty-two",{"title":78,"_path":79},"📝 技术博客归档","/articles/fold",{"title":81,"_path":82,"children":83},"造物 / Make","/tools",[84,87,90,93],{"title":85,"_path":86},"🌐 AnySort","/tools/anysort",{"title":88,"_path":89},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":91,"_path":92},"👓 Crapto","/tools/crypto-inline",{"title":94,"_path":95},"🖨️ any-to-base64","/tools/any-to-base64",{"title":97,"_path":98,"children":99},"吉他剧场 / Music","/music",[100,102,105,108,111,114,117,120],{"title":101,"_path":98},"🎸 FingerStyle！",{"title":103,"_path":104},"🌬️ 等待的风","/music/wind",{"title":106,"_path":107},"💕 约定的海洋","/music/ocean",{"title":109,"_path":110},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":112,"_path":113},"🌏 残酷天使的行动纲领","/music/eva",{"title":115,"_path":116},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":118,"_path":119},"🍷 Wu Wei","/music/wu-wei",{"title":121,"_path":122},"🌅 无题","/music/untitled",{"title":124,"_path":125,"children":126},"画点什么 / Paint","/paint",[127],{"title":128,"_path":125},"🚧 正在施工",{"title":130,"_path":131,"children":132},"知识地图 / Maps","/maps",[133],{"title":134,"_path":131},"🏁 知识地图",{"title":136,"_path":137,"children":138},"零散的笔记 / Gists","/gists",[139,141,144,147,150,153,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366],{"title":140,"_path":137},"🧊 Gists",{"title":142,"_path":143},"网站的可访问性","/gists/accessibility",{"title":145,"_path":146},"Bit","/gists/bit",{"title":148,"_path":149},"图片模糊","/gists/blur",{"title":151,"_path":152},"渲染相关笔记","/gists/c4d",{"title":154,"_path":155},"CDN 问题记录","/gists/cdn",{"title":157,"_path":158},"消毒剂","/gists/cleaner",{"title":160,"_path":161},"Windows Command","/gists/cmd",{"title":163,"_path":164},"Command","/gists/command",{"title":166,"_path":167},"复杂科学","/gists/complexity-science",{"title":169,"_path":170},"宇宙","/gists/cosmos",{"title":172,"_path":173},"C++","/gists/cpp",{"title":175,"_path":176},"Data Structure","/gists/data-structure",{"title":178,"_path":179},"DEPRESSION","/gists/depression",{"title":181,"_path":182},"设计模式","/gists/design-patterns",{"title":184,"_path":185},"Developer Experience","/gists/developer-experience",{"title":187,"_path":188},"Device Metrics","/gists/device-metrix",{"title":190,"_path":191},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":193,"_path":194},"正则表达式","/gists/eegex",{"title":196,"_path":197},"Emoji","/gists/emoji",{"title":199,"_path":200},"工程","/gists/engineering",{"title":202,"_path":203},"熵","/gists/entropy",{"title":205,"_path":206},"Environment","/gists/environment",{"title":208,"_path":209},"Erlang","/gists/erlang",{"title":211,"_path":212},"逃离塔克夫","/gists/escape-from-tarkov",{"title":214,"_path":215},"ESNext (ES6-ES11)","/gists/esnext",{"title":217,"_path":218},"Eval！","/gists/eval",{"title":220,"_path":221},"Flutter","/gists/flutter",{"title":223,"_path":224},"字体","/gists/font",{"title":226,"_path":227},"JS 函数式编程","/gists/functional",{"title":229,"_path":230},"Google C++ Standard","/gists/google-cpp-standard",{"title":232,"_path":233},"双向链接完全体","/gists/graph",{"title":235,"_path":236},"Hardwares","/gists/hardwares",{"title":238,"_path":239},"哈希冲突","/gists/hash-collision",{"title":241,"_path":242},"信息设计","/gists/information-design",{"title":244,"_path":245},"InstantPage","/gists/instant.page",{"title":247,"_path":248},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":250,"_path":251},"KVStore","/gists/key-value-db",{"title":253,"_path":254},"Kubernetes","/gists/kubernetes",{"title":256,"_path":257},"Makefile","/gists/makefile",{"title":259,"_path":260},"Markdown Inline Style","/gists/markdown-nice",{"title":262,"_path":263},"小程序","/gists/miniapp",{"title":265,"_path":266},"减小页面快照体积","/gists/minify-html",{"title":268,"_path":269},"mklink","/gists/mklink",{"title":271,"_path":272},"Mock","/gists/mock",{"title":274,"_path":275},"多端应用","/gists/multy-end-app",{"title":277,"_path":278},"神经科学","/gists/neuroscience",{"title":280,"_path":281},"OO","/gists/oo",{"title":283,"_path":284},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":286,"_path":287},"人物","/gists/person",{"title":289,"_path":290},"PInvoke","/gists/pinvoke",{"title":292,"_path":293},"像素","/gists/pixel",{"title":295,"_path":296},"PowerShell","/gists/powershell",{"title":298,"_path":299},"量子","/gists/quantum",{"title":301,"_path":302},"保持好奇心","/gists/questions",{"title":304,"_path":305},"React Native","/gists/react-native",{"title":307,"_path":308},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":310,"_path":311},"SEO","/gists/seo",{"title":313,"_path":314},"Shader","/gists/shader",{"title":316,"_path":317},"Shape Up","/gists/shape-up",{"title":319,"_path":320},"睡觉","/gists/sleep",{"title":322,"_path":323},"States","/gists/states",{"title":325,"_path":326},"Storage","/gists/storage",{"title":328,"_path":329},"音视频流处理","/gists/stream-cli",{"title":331,"_path":332},"Symbol","/gists/symbol",{"title":334,"_path":335},"系统论","/gists/systems-theory",{"title":337,"_path":338},"Taro","/gists/taro",{"title":340,"_path":341},"任务切片","/gists/task-slice",{"title":343,"_path":344},"技术偏好","/gists/tech-dudge",{"title":346,"_path":347},"Untitled","/gists/untitled",{"title":349,"_path":350},"可变字体","/gists/variable-font",{"title":352,"_path":353},"视觉错觉","/gists/visual-illusion",{"title":355,"_path":356},"SS(SSR)","/gists/vpn",{"title":358,"_path":359},"VS Code 插件开发","/gists/vscode-plugin",{"title":361,"_path":362},"Web Components","/gists/web-components",{"title":364,"_path":365},"Windows","/gists/windows",{"title":367,"_path":368},"查缺补漏","/gists/wrong",{"title":370,"_path":371,"children":372},"代码笔记 / Gists","/source-code",[373],{"title":374,"_path":371},"🚄 代码笔记",{"title":376,"_path":377,"children":378},"我 / Abount","/hire",[379],{"title":380,"_path":377},"📬 技术简历",{"title":382,"_path":383,"children":384},"todo","/todo",[385],{"title":382,"_path":383},{"_path":387,"_dir":388,"_draft":389,"_partial":390,"_locale":391,"title":392,"description":391,"body":393,"_type":2313,"_id":2314,"_source":2315,"_file":2316,"_extension":2317},"/source-code/_fingerprint/canvas-blocker","_fingerprint",false,true,"","Canvas Blocker",{"type":394,"children":395,"toc":2303},"root",[396,404,410,416,466,471,477,482,487,864,869,874,881,886,911,916,1074,1079,1662,1668,1673,1686,1691,2268,2274,2279,2284,2297],{"type":397,"tag":398,"props":399,"children":401},"element","h1",{"id":400},"canvas-blocker",[402],{"type":403,"value":392},"text",{"type":397,"tag":405,"props":406,"children":408},"h2",{"id":407},"前言",[409],{"type":403,"value":407},{"type":397,"tag":411,"props":412,"children":413},"p",{},[414],{"type":403,"value":415},"最近在看一些反反爬相关的东西，期间找到了 Canvas Blocker 这个神奇的库。他是一个浏览器扩展，声称能拦截以下几种类型的指纹追踪：",{"type":397,"tag":417,"props":418,"children":419},"ul",{},[420,426,431,436,441,446,451,456,461],{"type":397,"tag":421,"props":422,"children":423},"li",{},[424],{"type":403,"value":425},"Canvas 2D",{"type":397,"tag":421,"props":427,"children":428},{},[429],{"type":403,"value":430},"WebGL",{"type":397,"tag":421,"props":432,"children":433},{},[434],{"type":403,"value":435},"Web Audio",{"type":397,"tag":421,"props":437,"children":438},{},[439],{"type":403,"value":440},"History",{"type":397,"tag":421,"props":442,"children":443},{},[444],{"type":403,"value":445},"Window",{"type":397,"tag":421,"props":447,"children":448},{},[449],{"type":403,"value":450},"DOMRect",{"type":397,"tag":421,"props":452,"children":453},{},[454],{"type":403,"value":455},"TextMetrics",{"type":397,"tag":421,"props":457,"children":458},{},[459],{"type":403,"value":460},"Navigator",{"type":397,"tag":421,"props":462,"children":463},{},[464],{"type":403,"value":465},"Screen",{"type":397,"tag":411,"props":467,"children":468},{},[469],{"type":403,"value":470},"让我们大致拆解一下，看看其原理是什么。",{"type":397,"tag":405,"props":472,"children":474},{"id":473},"intercept",[475],{"type":403,"value":476},"Intercept",{"type":397,"tag":411,"props":478,"children":479},{},[480],{"type":403,"value":481},"Blocker 最主要的思路就是用伪造的函数篡改属性的 Getter 以及某些 API。",{"type":397,"tag":411,"props":483,"children":484},{},[485],{"type":403,"value":486},"篡改的入口在 intercept.js 中，先根据页面 URL 检查当前页面是否允许篡改，允许的话就通过 interceptFns、interceptGetters 实施具体步骤。",{"type":397,"tag":488,"props":489,"children":493},"pre",{"className":490,"code":491,"language":492,"meta":391,"style":391},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","scope.intercept = function intercept({subject: windowToProcess}, apis){\n  const siteStatus = apis.check({url: getURL(windowToProcess)})\n  logging.verbose(\"status for page\", windowToProcess, siteStatus)\n  if (siteStatus.mode !== \"allow\"){\n    interceptFunctions(windowToProcess, siteStatus, apis)\n    interceptGetters(windowToProcess, siteStatus, apis)\n  }\n}\n","js",[494],{"type":397,"tag":495,"props":496,"children":497},"code",{"__ignoreMap":391},[498,575,656,715,772,809,846,855],{"type":397,"tag":499,"props":500,"children":503},"span",{"class":501,"line":502},"line",1,[504,510,516,521,527,533,538,543,549,554,560,565,570],{"type":397,"tag":499,"props":505,"children":507},{"style":506},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[508],{"type":403,"value":509},"scope",{"type":397,"tag":499,"props":511,"children":513},{"style":512},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[514],{"type":403,"value":515},".",{"type":397,"tag":499,"props":517,"children":519},{"style":518},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[520],{"type":403,"value":473},{"type":397,"tag":499,"props":522,"children":524},{"style":523},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[525],{"type":403,"value":526}," =",{"type":397,"tag":499,"props":528,"children":530},{"style":529},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-light-font-style:inherit;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[531],{"type":403,"value":532}," function",{"type":397,"tag":499,"props":534,"children":535},{"style":518},[536],{"type":403,"value":537}," intercept",{"type":397,"tag":499,"props":539,"children":540},{"style":512},[541],{"type":403,"value":542},"({",{"type":397,"tag":499,"props":544,"children":546},{"style":545},"--shiki-light:#E53935;--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#F8F8F2",[547],{"type":403,"value":548},"subject",{"type":397,"tag":499,"props":550,"children":551},{"style":512},[552],{"type":403,"value":553},":",{"type":397,"tag":499,"props":555,"children":557},{"style":556},"--shiki-light:#90A4AE;--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[558],{"type":403,"value":559}," windowToProcess",{"type":397,"tag":499,"props":561,"children":562},{"style":512},[563],{"type":403,"value":564},"},",{"type":397,"tag":499,"props":566,"children":567},{"style":556},[568],{"type":403,"value":569}," apis",{"type":397,"tag":499,"props":571,"children":572},{"style":512},[573],{"type":403,"value":574},"){\n",{"type":397,"tag":499,"props":576,"children":578},{"class":501,"line":577},2,[579,584,590,594,598,602,607,613,618,623,627,632,636,641,646,651],{"type":397,"tag":499,"props":580,"children":581},{"style":529},[582],{"type":403,"value":583},"  const",{"type":397,"tag":499,"props":585,"children":587},{"style":586},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[588],{"type":403,"value":589}," siteStatus",{"type":397,"tag":499,"props":591,"children":592},{"style":523},[593],{"type":403,"value":526},{"type":397,"tag":499,"props":595,"children":596},{"style":506},[597],{"type":403,"value":569},{"type":397,"tag":499,"props":599,"children":600},{"style":512},[601],{"type":403,"value":515},{"type":397,"tag":499,"props":603,"children":604},{"style":518},[605],{"type":403,"value":606},"check",{"type":397,"tag":499,"props":608,"children":610},{"style":609},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[611],{"type":403,"value":612},"(",{"type":397,"tag":499,"props":614,"children":615},{"style":512},[616],{"type":403,"value":617},"{",{"type":397,"tag":499,"props":619,"children":620},{"style":609},[621],{"type":403,"value":622},"url",{"type":397,"tag":499,"props":624,"children":625},{"style":512},[626],{"type":403,"value":553},{"type":397,"tag":499,"props":628,"children":629},{"style":518},[630],{"type":403,"value":631}," getURL",{"type":397,"tag":499,"props":633,"children":634},{"style":609},[635],{"type":403,"value":612},{"type":397,"tag":499,"props":637,"children":638},{"style":506},[639],{"type":403,"value":640},"windowToProcess",{"type":397,"tag":499,"props":642,"children":643},{"style":609},[644],{"type":403,"value":645},")",{"type":397,"tag":499,"props":647,"children":648},{"style":512},[649],{"type":403,"value":650},"}",{"type":397,"tag":499,"props":652,"children":653},{"style":609},[654],{"type":403,"value":655},")\n",{"type":397,"tag":499,"props":657,"children":659},{"class":501,"line":658},3,[660,665,669,674,678,684,690,694,699,703,707,711],{"type":397,"tag":499,"props":661,"children":662},{"style":506},[663],{"type":403,"value":664},"  logging",{"type":397,"tag":499,"props":666,"children":667},{"style":512},[668],{"type":403,"value":515},{"type":397,"tag":499,"props":670,"children":671},{"style":518},[672],{"type":403,"value":673},"verbose",{"type":397,"tag":499,"props":675,"children":676},{"style":609},[677],{"type":403,"value":612},{"type":397,"tag":499,"props":679,"children":681},{"style":680},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[682],{"type":403,"value":683},"\"",{"type":397,"tag":499,"props":685,"children":687},{"style":686},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[688],{"type":403,"value":689},"status for page",{"type":397,"tag":499,"props":691,"children":692},{"style":680},[693],{"type":403,"value":683},{"type":397,"tag":499,"props":695,"children":696},{"style":512},[697],{"type":403,"value":698},",",{"type":397,"tag":499,"props":700,"children":701},{"style":506},[702],{"type":403,"value":559},{"type":397,"tag":499,"props":704,"children":705},{"style":512},[706],{"type":403,"value":698},{"type":397,"tag":499,"props":708,"children":709},{"style":506},[710],{"type":403,"value":589},{"type":397,"tag":499,"props":712,"children":713},{"style":609},[714],{"type":403,"value":655},{"type":397,"tag":499,"props":716,"children":718},{"class":501,"line":717},4,[719,725,730,735,739,744,749,754,759,763,767],{"type":397,"tag":499,"props":720,"children":722},{"style":721},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[723],{"type":403,"value":724},"  if",{"type":397,"tag":499,"props":726,"children":727},{"style":609},[728],{"type":403,"value":729}," (",{"type":397,"tag":499,"props":731,"children":732},{"style":506},[733],{"type":403,"value":734},"siteStatus",{"type":397,"tag":499,"props":736,"children":737},{"style":512},[738],{"type":403,"value":515},{"type":397,"tag":499,"props":740,"children":741},{"style":506},[742],{"type":403,"value":743},"mode",{"type":397,"tag":499,"props":745,"children":746},{"style":523},[747],{"type":403,"value":748}," !==",{"type":397,"tag":499,"props":750,"children":751},{"style":680},[752],{"type":403,"value":753}," \"",{"type":397,"tag":499,"props":755,"children":756},{"style":686},[757],{"type":403,"value":758},"allow",{"type":397,"tag":499,"props":760,"children":761},{"style":680},[762],{"type":403,"value":683},{"type":397,"tag":499,"props":764,"children":765},{"style":609},[766],{"type":403,"value":645},{"type":397,"tag":499,"props":768,"children":769},{"style":512},[770],{"type":403,"value":771},"{\n",{"type":397,"tag":499,"props":773,"children":775},{"class":501,"line":774},5,[776,781,785,789,793,797,801,805],{"type":397,"tag":499,"props":777,"children":778},{"style":518},[779],{"type":403,"value":780},"    interceptFunctions",{"type":397,"tag":499,"props":782,"children":783},{"style":609},[784],{"type":403,"value":612},{"type":397,"tag":499,"props":786,"children":787},{"style":506},[788],{"type":403,"value":640},{"type":397,"tag":499,"props":790,"children":791},{"style":512},[792],{"type":403,"value":698},{"type":397,"tag":499,"props":794,"children":795},{"style":506},[796],{"type":403,"value":589},{"type":397,"tag":499,"props":798,"children":799},{"style":512},[800],{"type":403,"value":698},{"type":397,"tag":499,"props":802,"children":803},{"style":506},[804],{"type":403,"value":569},{"type":397,"tag":499,"props":806,"children":807},{"style":609},[808],{"type":403,"value":655},{"type":397,"tag":499,"props":810,"children":812},{"class":501,"line":811},6,[813,818,822,826,830,834,838,842],{"type":397,"tag":499,"props":814,"children":815},{"style":518},[816],{"type":403,"value":817},"    interceptGetters",{"type":397,"tag":499,"props":819,"children":820},{"style":609},[821],{"type":403,"value":612},{"type":397,"tag":499,"props":823,"children":824},{"style":506},[825],{"type":403,"value":640},{"type":397,"tag":499,"props":827,"children":828},{"style":512},[829],{"type":403,"value":698},{"type":397,"tag":499,"props":831,"children":832},{"style":506},[833],{"type":403,"value":589},{"type":397,"tag":499,"props":835,"children":836},{"style":512},[837],{"type":403,"value":698},{"type":397,"tag":499,"props":839,"children":840},{"style":506},[841],{"type":403,"value":569},{"type":397,"tag":499,"props":843,"children":844},{"style":609},[845],{"type":403,"value":655},{"type":397,"tag":499,"props":847,"children":849},{"class":501,"line":848},7,[850],{"type":397,"tag":499,"props":851,"children":852},{"style":512},[853],{"type":403,"value":854},"  }\n",{"type":397,"tag":499,"props":856,"children":858},{"class":501,"line":857},8,[859],{"type":397,"tag":499,"props":860,"children":861},{"style":512},[862],{"type":403,"value":863},"}\n",{"type":397,"tag":405,"props":865,"children":867},{"id":866},"window",[868],{"type":403,"value":445},{"type":397,"tag":411,"props":870,"children":871},{},[872],{"type":403,"value":873},"Blocker 篡改了 Window 的两个属性，window.name 和 window.opener。这两个属性和指纹没有直接关系，但却是一种“帮助函数”，能够帮助恶意网站追踪指纹以及窃取隐私。",{"type":397,"tag":875,"props":876,"children":878},"h3",{"id":877},"windowname",[879],{"type":403,"value":880},"window.name",{"type":397,"tag":411,"props":882,"children":883},{},[884],{"type":403,"value":885},"在过去的浏览器中，window.name 能够跨站点传输数据，并且能逃逸同源策略。从 Firefox 88 开始，用户通过点击超链接跳转到新页面时，window.name 将被置空，不过为了不造成更大的破坏，当用户从跳转后页面回到之前页面时，window.name 会被还原。",{"type":397,"tag":417,"props":887,"children":888},{},[889,901],{"type":397,"tag":421,"props":890,"children":891},{},[892],{"type":397,"tag":893,"props":894,"children":898},"a",{"href":895,"rel":896},"https://blog.mozilla.org/security/2021/04/19/firefox-88-combats-window-name-privacy-abuses/",[897],"nofollow",[899],{"type":403,"value":900},"Firefox 88 combats window.name privacy abuses",{"type":397,"tag":421,"props":902,"children":903},{},[904],{"type":397,"tag":893,"props":905,"children":908},{"href":906,"rel":907},"https://wpt.fyi/results/html/browsers/windows/clear-window-name.https.html?label=master&label=experimental&aligned",[897],[909],{"type":403,"value":910},"clear-window-name@web-platform-tests",{"type":397,"tag":411,"props":912,"children":913},{},[914],{"type":403,"value":915},"在使用 JS 设置 window.name 时，Blcoker 会记录下设置的值。original.call 调用原有的 window.name setter；windowNames 只做记录，稍后会用到。",{"type":397,"tag":488,"props":917,"children":919},{"className":490,"code":918,"language":492,"meta":391,"style":391},"{\n  set name(name){\n    // 调用原有 setting 设置 window.name\n    original.call(this, ...arguments)\n    // 把 name 记录下来\n    windowNames.set(this, name)\n  }\n}\n",[920],{"type":397,"tag":495,"props":921,"children":922},{"__ignoreMap":391},[923,930,960,969,1015,1023,1060,1067],{"type":397,"tag":499,"props":924,"children":925},{"class":501,"line":502},[926],{"type":397,"tag":499,"props":927,"children":928},{"style":512},[929],{"type":403,"value":771},{"type":397,"tag":499,"props":931,"children":932},{"class":501,"line":577},[933,938,943,947,952,956],{"type":397,"tag":499,"props":934,"children":935},{"style":506},[936],{"type":403,"value":937},"  set",{"type":397,"tag":499,"props":939,"children":940},{"style":518},[941],{"type":403,"value":942}," name",{"type":397,"tag":499,"props":944,"children":945},{"style":609},[946],{"type":403,"value":612},{"type":397,"tag":499,"props":948,"children":949},{"style":506},[950],{"type":403,"value":951},"name",{"type":397,"tag":499,"props":953,"children":954},{"style":609},[955],{"type":403,"value":645},{"type":397,"tag":499,"props":957,"children":958},{"style":512},[959],{"type":403,"value":771},{"type":397,"tag":499,"props":961,"children":962},{"class":501,"line":658},[963],{"type":397,"tag":499,"props":964,"children":966},{"style":965},"--shiki-light:#90A4AE;--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[967],{"type":403,"value":968},"    // 调用原有 setting 设置 window.name\n",{"type":397,"tag":499,"props":970,"children":971},{"class":501,"line":717},[972,977,981,986,990,996,1000,1005,1011],{"type":397,"tag":499,"props":973,"children":974},{"style":506},[975],{"type":403,"value":976},"    original",{"type":397,"tag":499,"props":978,"children":979},{"style":512},[980],{"type":403,"value":515},{"type":397,"tag":499,"props":982,"children":983},{"style":518},[984],{"type":403,"value":985},"call",{"type":397,"tag":499,"props":987,"children":988},{"style":609},[989],{"type":403,"value":612},{"type":397,"tag":499,"props":991,"children":993},{"style":992},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[994],{"type":403,"value":995},"this",{"type":397,"tag":499,"props":997,"children":998},{"style":512},[999],{"type":403,"value":698},{"type":397,"tag":499,"props":1001,"children":1002},{"style":523},[1003],{"type":403,"value":1004}," ...",{"type":397,"tag":499,"props":1006,"children":1008},{"style":1007},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[1009],{"type":403,"value":1010},"arguments",{"type":397,"tag":499,"props":1012,"children":1013},{"style":609},[1014],{"type":403,"value":655},{"type":397,"tag":499,"props":1016,"children":1017},{"class":501,"line":774},[1018],{"type":397,"tag":499,"props":1019,"children":1020},{"style":965},[1021],{"type":403,"value":1022},"    // 把 name 记录下来\n",{"type":397,"tag":499,"props":1024,"children":1025},{"class":501,"line":811},[1026,1031,1035,1040,1044,1048,1052,1056],{"type":397,"tag":499,"props":1027,"children":1028},{"style":506},[1029],{"type":403,"value":1030},"    windowNames",{"type":397,"tag":499,"props":1032,"children":1033},{"style":512},[1034],{"type":403,"value":515},{"type":397,"tag":499,"props":1036,"children":1037},{"style":518},[1038],{"type":403,"value":1039},"set",{"type":397,"tag":499,"props":1041,"children":1042},{"style":609},[1043],{"type":403,"value":612},{"type":397,"tag":499,"props":1045,"children":1046},{"style":992},[1047],{"type":403,"value":995},{"type":397,"tag":499,"props":1049,"children":1050},{"style":512},[1051],{"type":403,"value":698},{"type":397,"tag":499,"props":1053,"children":1054},{"style":506},[1055],{"type":403,"value":942},{"type":397,"tag":499,"props":1057,"children":1058},{"style":609},[1059],{"type":403,"value":655},{"type":397,"tag":499,"props":1061,"children":1062},{"class":501,"line":848},[1063],{"type":397,"tag":499,"props":1064,"children":1065},{"style":512},[1066],{"type":403,"value":854},{"type":397,"tag":499,"props":1068,"children":1069},{"class":501,"line":857},[1070],{"type":397,"tag":499,"props":1071,"children":1072},{"style":512},[1073],{"type":403,"value":863},{"type":397,"tag":411,"props":1075,"children":1076},{},[1077],{"type":403,"value":1078},"因为只有通过显式的 window.name = 'xxx' 才会触发 windowNames 中记录的值的改变，所以一旦在 b.com 读取到的 window.name 不是 windowNames 记录的值，就说明浏览器泄露了 window.name，此时需要返回伪造的值。",{"type":397,"tag":488,"props":1080,"children":1082},{"className":490,"code":1081,"language":492,"meta":391,"style":391},"{\n  get name(){\n    return checkerWrapper(checker, this, arguments, function(args, check){\n      const {notify, original, prefs} = check\n\n      // 读取 b.com 的 window.name 可能会返回 a.com 的 window.name\n      const originalName = original.call(this, ...args)\n\n      // 根据配置，iframes 中返回的 window.name 可以赦免此伪造规则，\n      // this !== this.top 是一种快速检测当前 window 是否在 iframe 中的方法\n      if (\n        this !== this.top &&\n        prefs(\"allowWindowNameInFrames\", this.location)\n      ){\n        return originalName\n      }\n\n      // 只有通过显式的 window.name = 'xxx' 才会触发 windowNames 中记录的值的改变，\n      // 所以一旦 windowNames 记录的值和 originalName 不一样，\n      // 就说明当前浏览器犯了 window.name 泄露的错误\n      const returnedName = windowNames.get(this) || \"\"\n      if (originalName !== returnedName){\n        notify(\"fakedWindowReadout\")\n      }\n      return returnedName\n    });\n  }\n}\n",[1083],{"type":397,"tag":495,"props":1084,"children":1085},{"__ignoreMap":391},[1086,1093,1114,1184,1233,1241,1249,1301,1308,1317,1326,1340,1371,1418,1431,1445,1454,1462,1471,1480,1489,1543,1576,1606,1614,1628,1646,1654],{"type":397,"tag":499,"props":1087,"children":1088},{"class":501,"line":502},[1089],{"type":397,"tag":499,"props":1090,"children":1091},{"style":512},[1092],{"type":403,"value":771},{"type":397,"tag":499,"props":1094,"children":1095},{"class":501,"line":577},[1096,1101,1105,1110],{"type":397,"tag":499,"props":1097,"children":1098},{"style":506},[1099],{"type":403,"value":1100},"  get",{"type":397,"tag":499,"props":1102,"children":1103},{"style":518},[1104],{"type":403,"value":942},{"type":397,"tag":499,"props":1106,"children":1107},{"style":609},[1108],{"type":403,"value":1109},"()",{"type":397,"tag":499,"props":1111,"children":1112},{"style":512},[1113],{"type":403,"value":771},{"type":397,"tag":499,"props":1115,"children":1116},{"class":501,"line":658},[1117,1122,1127,1131,1136,1140,1145,1149,1154,1158,1162,1166,1171,1175,1180],{"type":397,"tag":499,"props":1118,"children":1119},{"style":721},[1120],{"type":403,"value":1121},"    return",{"type":397,"tag":499,"props":1123,"children":1124},{"style":518},[1125],{"type":403,"value":1126}," checkerWrapper",{"type":397,"tag":499,"props":1128,"children":1129},{"style":609},[1130],{"type":403,"value":612},{"type":397,"tag":499,"props":1132,"children":1133},{"style":506},[1134],{"type":403,"value":1135},"checker",{"type":397,"tag":499,"props":1137,"children":1138},{"style":512},[1139],{"type":403,"value":698},{"type":397,"tag":499,"props":1141,"children":1142},{"style":992},[1143],{"type":403,"value":1144}," this",{"type":397,"tag":499,"props":1146,"children":1147},{"style":512},[1148],{"type":403,"value":698},{"type":397,"tag":499,"props":1150,"children":1151},{"style":1007},[1152],{"type":403,"value":1153}," arguments",{"type":397,"tag":499,"props":1155,"children":1156},{"style":512},[1157],{"type":403,"value":698},{"type":397,"tag":499,"props":1159,"children":1160},{"style":529},[1161],{"type":403,"value":532},{"type":397,"tag":499,"props":1163,"children":1164},{"style":512},[1165],{"type":403,"value":612},{"type":397,"tag":499,"props":1167,"children":1168},{"style":556},[1169],{"type":403,"value":1170},"args",{"type":397,"tag":499,"props":1172,"children":1173},{"style":512},[1174],{"type":403,"value":698},{"type":397,"tag":499,"props":1176,"children":1177},{"style":556},[1178],{"type":403,"value":1179}," check",{"type":397,"tag":499,"props":1181,"children":1182},{"style":512},[1183],{"type":403,"value":574},{"type":397,"tag":499,"props":1185,"children":1186},{"class":501,"line":717},[1187,1192,1197,1202,1206,1211,1215,1220,1224,1228],{"type":397,"tag":499,"props":1188,"children":1189},{"style":529},[1190],{"type":403,"value":1191},"      const",{"type":397,"tag":499,"props":1193,"children":1194},{"style":512},[1195],{"type":403,"value":1196}," {",{"type":397,"tag":499,"props":1198,"children":1199},{"style":586},[1200],{"type":403,"value":1201},"notify",{"type":397,"tag":499,"props":1203,"children":1204},{"style":512},[1205],{"type":403,"value":698},{"type":397,"tag":499,"props":1207,"children":1208},{"style":586},[1209],{"type":403,"value":1210}," original",{"type":397,"tag":499,"props":1212,"children":1213},{"style":512},[1214],{"type":403,"value":698},{"type":397,"tag":499,"props":1216,"children":1217},{"style":586},[1218],{"type":403,"value":1219}," prefs",{"type":397,"tag":499,"props":1221,"children":1222},{"style":512},[1223],{"type":403,"value":650},{"type":397,"tag":499,"props":1225,"children":1226},{"style":523},[1227],{"type":403,"value":526},{"type":397,"tag":499,"props":1229,"children":1230},{"style":506},[1231],{"type":403,"value":1232}," check\n",{"type":397,"tag":499,"props":1234,"children":1235},{"class":501,"line":774},[1236],{"type":397,"tag":499,"props":1237,"children":1238},{"emptyLinePlaceholder":390},[1239],{"type":403,"value":1240},"\n",{"type":397,"tag":499,"props":1242,"children":1243},{"class":501,"line":811},[1244],{"type":397,"tag":499,"props":1245,"children":1246},{"style":965},[1247],{"type":403,"value":1248},"      // 读取 b.com 的 window.name 可能会返回 a.com 的 window.name\n",{"type":397,"tag":499,"props":1250,"children":1251},{"class":501,"line":848},[1252,1256,1261,1265,1269,1273,1277,1281,1285,1289,1293,1297],{"type":397,"tag":499,"props":1253,"children":1254},{"style":529},[1255],{"type":403,"value":1191},{"type":397,"tag":499,"props":1257,"children":1258},{"style":586},[1259],{"type":403,"value":1260}," originalName",{"type":397,"tag":499,"props":1262,"children":1263},{"style":523},[1264],{"type":403,"value":526},{"type":397,"tag":499,"props":1266,"children":1267},{"style":506},[1268],{"type":403,"value":1210},{"type":397,"tag":499,"props":1270,"children":1271},{"style":512},[1272],{"type":403,"value":515},{"type":397,"tag":499,"props":1274,"children":1275},{"style":518},[1276],{"type":403,"value":985},{"type":397,"tag":499,"props":1278,"children":1279},{"style":609},[1280],{"type":403,"value":612},{"type":397,"tag":499,"props":1282,"children":1283},{"style":992},[1284],{"type":403,"value":995},{"type":397,"tag":499,"props":1286,"children":1287},{"style":512},[1288],{"type":403,"value":698},{"type":397,"tag":499,"props":1290,"children":1291},{"style":523},[1292],{"type":403,"value":1004},{"type":397,"tag":499,"props":1294,"children":1295},{"style":506},[1296],{"type":403,"value":1170},{"type":397,"tag":499,"props":1298,"children":1299},{"style":609},[1300],{"type":403,"value":655},{"type":397,"tag":499,"props":1302,"children":1303},{"class":501,"line":857},[1304],{"type":397,"tag":499,"props":1305,"children":1306},{"emptyLinePlaceholder":390},[1307],{"type":403,"value":1240},{"type":397,"tag":499,"props":1309,"children":1311},{"class":501,"line":1310},9,[1312],{"type":397,"tag":499,"props":1313,"children":1314},{"style":965},[1315],{"type":403,"value":1316},"      // 根据配置，iframes 中返回的 window.name 可以赦免此伪造规则，\n",{"type":397,"tag":499,"props":1318,"children":1320},{"class":501,"line":1319},10,[1321],{"type":397,"tag":499,"props":1322,"children":1323},{"style":965},[1324],{"type":403,"value":1325},"      // this !== this.top 是一种快速检测当前 window 是否在 iframe 中的方法\n",{"type":397,"tag":499,"props":1327,"children":1329},{"class":501,"line":1328},11,[1330,1335],{"type":397,"tag":499,"props":1331,"children":1332},{"style":721},[1333],{"type":403,"value":1334},"      if",{"type":397,"tag":499,"props":1336,"children":1337},{"style":609},[1338],{"type":403,"value":1339}," (\n",{"type":397,"tag":499,"props":1341,"children":1343},{"class":501,"line":1342},12,[1344,1349,1353,1357,1361,1366],{"type":397,"tag":499,"props":1345,"children":1346},{"style":992},[1347],{"type":403,"value":1348},"        this",{"type":397,"tag":499,"props":1350,"children":1351},{"style":523},[1352],{"type":403,"value":748},{"type":397,"tag":499,"props":1354,"children":1355},{"style":992},[1356],{"type":403,"value":1144},{"type":397,"tag":499,"props":1358,"children":1359},{"style":512},[1360],{"type":403,"value":515},{"type":397,"tag":499,"props":1362,"children":1363},{"style":506},[1364],{"type":403,"value":1365},"top",{"type":397,"tag":499,"props":1367,"children":1368},{"style":523},[1369],{"type":403,"value":1370}," &&\n",{"type":397,"tag":499,"props":1372,"children":1374},{"class":501,"line":1373},13,[1375,1380,1384,1388,1393,1397,1401,1405,1409,1414],{"type":397,"tag":499,"props":1376,"children":1377},{"style":518},[1378],{"type":403,"value":1379},"        prefs",{"type":397,"tag":499,"props":1381,"children":1382},{"style":609},[1383],{"type":403,"value":612},{"type":397,"tag":499,"props":1385,"children":1386},{"style":680},[1387],{"type":403,"value":683},{"type":397,"tag":499,"props":1389,"children":1390},{"style":686},[1391],{"type":403,"value":1392},"allowWindowNameInFrames",{"type":397,"tag":499,"props":1394,"children":1395},{"style":680},[1396],{"type":403,"value":683},{"type":397,"tag":499,"props":1398,"children":1399},{"style":512},[1400],{"type":403,"value":698},{"type":397,"tag":499,"props":1402,"children":1403},{"style":992},[1404],{"type":403,"value":1144},{"type":397,"tag":499,"props":1406,"children":1407},{"style":512},[1408],{"type":403,"value":515},{"type":397,"tag":499,"props":1410,"children":1411},{"style":506},[1412],{"type":403,"value":1413},"location",{"type":397,"tag":499,"props":1415,"children":1416},{"style":609},[1417],{"type":403,"value":655},{"type":397,"tag":499,"props":1419,"children":1421},{"class":501,"line":1420},14,[1422,1427],{"type":397,"tag":499,"props":1423,"children":1424},{"style":609},[1425],{"type":403,"value":1426},"      )",{"type":397,"tag":499,"props":1428,"children":1429},{"style":512},[1430],{"type":403,"value":771},{"type":397,"tag":499,"props":1432,"children":1434},{"class":501,"line":1433},15,[1435,1440],{"type":397,"tag":499,"props":1436,"children":1437},{"style":721},[1438],{"type":403,"value":1439},"        return",{"type":397,"tag":499,"props":1441,"children":1442},{"style":506},[1443],{"type":403,"value":1444}," originalName\n",{"type":397,"tag":499,"props":1446,"children":1448},{"class":501,"line":1447},16,[1449],{"type":397,"tag":499,"props":1450,"children":1451},{"style":512},[1452],{"type":403,"value":1453},"      }\n",{"type":397,"tag":499,"props":1455,"children":1457},{"class":501,"line":1456},17,[1458],{"type":397,"tag":499,"props":1459,"children":1460},{"emptyLinePlaceholder":390},[1461],{"type":403,"value":1240},{"type":397,"tag":499,"props":1463,"children":1465},{"class":501,"line":1464},18,[1466],{"type":397,"tag":499,"props":1467,"children":1468},{"style":965},[1469],{"type":403,"value":1470},"      // 只有通过显式的 window.name = 'xxx' 才会触发 windowNames 中记录的值的改变，\n",{"type":397,"tag":499,"props":1472,"children":1474},{"class":501,"line":1473},19,[1475],{"type":397,"tag":499,"props":1476,"children":1477},{"style":965},[1478],{"type":403,"value":1479},"      // 所以一旦 windowNames 记录的值和 originalName 不一样，\n",{"type":397,"tag":499,"props":1481,"children":1483},{"class":501,"line":1482},20,[1484],{"type":397,"tag":499,"props":1485,"children":1486},{"style":965},[1487],{"type":403,"value":1488},"      // 就说明当前浏览器犯了 window.name 泄露的错误\n",{"type":397,"tag":499,"props":1490,"children":1492},{"class":501,"line":1491},21,[1493,1497,1502,1506,1511,1515,1520,1524,1528,1533,1538],{"type":397,"tag":499,"props":1494,"children":1495},{"style":529},[1496],{"type":403,"value":1191},{"type":397,"tag":499,"props":1498,"children":1499},{"style":586},[1500],{"type":403,"value":1501}," returnedName",{"type":397,"tag":499,"props":1503,"children":1504},{"style":523},[1505],{"type":403,"value":526},{"type":397,"tag":499,"props":1507,"children":1508},{"style":506},[1509],{"type":403,"value":1510}," windowNames",{"type":397,"tag":499,"props":1512,"children":1513},{"style":512},[1514],{"type":403,"value":515},{"type":397,"tag":499,"props":1516,"children":1517},{"style":518},[1518],{"type":403,"value":1519},"get",{"type":397,"tag":499,"props":1521,"children":1522},{"style":609},[1523],{"type":403,"value":612},{"type":397,"tag":499,"props":1525,"children":1526},{"style":992},[1527],{"type":403,"value":995},{"type":397,"tag":499,"props":1529,"children":1530},{"style":609},[1531],{"type":403,"value":1532},") ",{"type":397,"tag":499,"props":1534,"children":1535},{"style":523},[1536],{"type":403,"value":1537},"||",{"type":397,"tag":499,"props":1539,"children":1540},{"style":680},[1541],{"type":403,"value":1542}," \"\"\n",{"type":397,"tag":499,"props":1544,"children":1546},{"class":501,"line":1545},22,[1547,1551,1555,1560,1564,1568,1572],{"type":397,"tag":499,"props":1548,"children":1549},{"style":721},[1550],{"type":403,"value":1334},{"type":397,"tag":499,"props":1552,"children":1553},{"style":609},[1554],{"type":403,"value":729},{"type":397,"tag":499,"props":1556,"children":1557},{"style":506},[1558],{"type":403,"value":1559},"originalName",{"type":397,"tag":499,"props":1561,"children":1562},{"style":523},[1563],{"type":403,"value":748},{"type":397,"tag":499,"props":1565,"children":1566},{"style":506},[1567],{"type":403,"value":1501},{"type":397,"tag":499,"props":1569,"children":1570},{"style":609},[1571],{"type":403,"value":645},{"type":397,"tag":499,"props":1573,"children":1574},{"style":512},[1575],{"type":403,"value":771},{"type":397,"tag":499,"props":1577,"children":1579},{"class":501,"line":1578},23,[1580,1585,1589,1593,1598,1602],{"type":397,"tag":499,"props":1581,"children":1582},{"style":518},[1583],{"type":403,"value":1584},"        notify",{"type":397,"tag":499,"props":1586,"children":1587},{"style":609},[1588],{"type":403,"value":612},{"type":397,"tag":499,"props":1590,"children":1591},{"style":680},[1592],{"type":403,"value":683},{"type":397,"tag":499,"props":1594,"children":1595},{"style":686},[1596],{"type":403,"value":1597},"fakedWindowReadout",{"type":397,"tag":499,"props":1599,"children":1600},{"style":680},[1601],{"type":403,"value":683},{"type":397,"tag":499,"props":1603,"children":1604},{"style":609},[1605],{"type":403,"value":655},{"type":397,"tag":499,"props":1607,"children":1609},{"class":501,"line":1608},24,[1610],{"type":397,"tag":499,"props":1611,"children":1612},{"style":512},[1613],{"type":403,"value":1453},{"type":397,"tag":499,"props":1615,"children":1617},{"class":501,"line":1616},25,[1618,1623],{"type":397,"tag":499,"props":1619,"children":1620},{"style":721},[1621],{"type":403,"value":1622},"      return",{"type":397,"tag":499,"props":1624,"children":1625},{"style":506},[1626],{"type":403,"value":1627}," returnedName\n",{"type":397,"tag":499,"props":1629,"children":1631},{"class":501,"line":1630},26,[1632,1637,1641],{"type":397,"tag":499,"props":1633,"children":1634},{"style":512},[1635],{"type":403,"value":1636},"    }",{"type":397,"tag":499,"props":1638,"children":1639},{"style":609},[1640],{"type":403,"value":645},{"type":397,"tag":499,"props":1642,"children":1643},{"style":512},[1644],{"type":403,"value":1645},";\n",{"type":397,"tag":499,"props":1647,"children":1649},{"class":501,"line":1648},27,[1650],{"type":397,"tag":499,"props":1651,"children":1652},{"style":512},[1653],{"type":403,"value":854},{"type":397,"tag":499,"props":1655,"children":1657},{"class":501,"line":1656},28,[1658],{"type":397,"tag":499,"props":1659,"children":1660},{"style":512},[1661],{"type":403,"value":863},{"type":397,"tag":405,"props":1663,"children":1665},{"id":1664},"windowopener",[1666],{"type":403,"value":1667},"window.opener",{"type":397,"tag":411,"props":1669,"children":1670},{},[1671],{"type":403,"value":1672},"在过去的浏览器中，当页面通过超链接或 window.open 的方式从 A 网站跳转到 B 网站时，如果制定了 target 属性却没有指定 rel=\"norefer\" 属性，那么在 B 网站是可以使用 window.opener 获取到 A 网站的部分信息的。也就是说，在 B 网站中可以修改 window.opener.location.href = 'x' 从而让 A 网站自动跳转到 X 网站。如果页面跳转时使用 target=\"__blank\" 打开了新页面，那么用户更加不可能注意到 A 网站的恶意跳转。",{"type":397,"tag":417,"props":1674,"children":1675},{},[1676],{"type":397,"tag":421,"props":1677,"children":1678},{},[1679],{"type":397,"tag":893,"props":1680,"children":1683},{"href":1681,"rel":1682},"https://cwe.mitre.org/data/definitions/1022.html",[897],[1684],{"type":403,"value":1685},"CWE-1022: Use of Web Link to Untrusted Target with window.opener Access",{"type":397,"tag":411,"props":1687,"children":1688},{},[1689],{"type":403,"value":1690},"Blocker 对 window.opener 的防范比较简单，直接返回 null 就完事儿了。考虑到现代浏览器已经修复了这个漏洞，该篡改的设置的值默认是关闭的。",{"type":397,"tag":488,"props":1692,"children":1694},{"className":490,"code":1693,"language":492,"meta":391,"style":391},"{\n  // 修改 Getter 使 window.opener 一直返回 null\n  getterGenerator: function(checker){\n    const temp = {\n      get opener(){\n        return checkerWrapper(checker, this, arguments, function(args, check){\n          const {notify, original} = check\n          const originalOpener = original.call(this, ...args)\n          if (originalOpener !== null){\n            notify(\"fakedWindowReadout\")\n          }\n          return null\n        })\n      }\n    }\n    return Object.getOwnPropertyDescriptor(temp, \"opener\").get\n  },\n  // 修改 Descriptor.Value 使得 window.opener 一直返回 null，\n  // 这是一种兼容，在部分浏览器中，\n  //  window.opener 是通过 value 而不是 getter 获取的值\n  valueGenerator: function({original, notify}){\n    if (original !== null){\n      notify(\"fakedWindowReadout\")\n    }\n    return null\n  }\n}\n",[1695],{"type":397,"tag":495,"props":1696,"children":1697},{"__ignoreMap":391},[1698,1705,1713,1742,1764,1783,1846,1882,1934,1969,1997,2005,2018,2030,2037,2045,2105,2113,2121,2129,2137,2176,2208,2236,2243,2254,2261],{"type":397,"tag":499,"props":1699,"children":1700},{"class":501,"line":502},[1701],{"type":397,"tag":499,"props":1702,"children":1703},{"style":512},[1704],{"type":403,"value":771},{"type":397,"tag":499,"props":1706,"children":1707},{"class":501,"line":577},[1708],{"type":397,"tag":499,"props":1709,"children":1710},{"style":965},[1711],{"type":403,"value":1712},"  // 修改 Getter 使 window.opener 一直返回 null\n",{"type":397,"tag":499,"props":1714,"children":1715},{"class":501,"line":658},[1716,1722,1726,1730,1734,1738],{"type":397,"tag":499,"props":1717,"children":1719},{"style":1718},"--shiki-light:#E2931D;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#F8F8F2",[1720],{"type":403,"value":1721},"  getterGenerator",{"type":397,"tag":499,"props":1723,"children":1724},{"style":512},[1725],{"type":403,"value":553},{"type":397,"tag":499,"props":1727,"children":1728},{"style":529},[1729],{"type":403,"value":532},{"type":397,"tag":499,"props":1731,"children":1732},{"style":512},[1733],{"type":403,"value":612},{"type":397,"tag":499,"props":1735,"children":1736},{"style":556},[1737],{"type":403,"value":1135},{"type":397,"tag":499,"props":1739,"children":1740},{"style":512},[1741],{"type":403,"value":574},{"type":397,"tag":499,"props":1743,"children":1744},{"class":501,"line":717},[1745,1750,1755,1759],{"type":397,"tag":499,"props":1746,"children":1747},{"style":529},[1748],{"type":403,"value":1749},"    const",{"type":397,"tag":499,"props":1751,"children":1752},{"style":586},[1753],{"type":403,"value":1754}," temp",{"type":397,"tag":499,"props":1756,"children":1757},{"style":523},[1758],{"type":403,"value":526},{"type":397,"tag":499,"props":1760,"children":1761},{"style":512},[1762],{"type":403,"value":1763}," {\n",{"type":397,"tag":499,"props":1765,"children":1766},{"class":501,"line":774},[1767,1772,1778],{"type":397,"tag":499,"props":1768,"children":1769},{"style":529},[1770],{"type":403,"value":1771},"      get",{"type":397,"tag":499,"props":1773,"children":1775},{"style":1774},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1776],{"type":403,"value":1777}," opener",{"type":397,"tag":499,"props":1779,"children":1780},{"style":512},[1781],{"type":403,"value":1782},"(){\n",{"type":397,"tag":499,"props":1784,"children":1785},{"class":501,"line":811},[1786,1790,1794,1798,1802,1806,1810,1814,1818,1822,1826,1830,1834,1838,1842],{"type":397,"tag":499,"props":1787,"children":1788},{"style":721},[1789],{"type":403,"value":1439},{"type":397,"tag":499,"props":1791,"children":1792},{"style":518},[1793],{"type":403,"value":1126},{"type":397,"tag":499,"props":1795,"children":1796},{"style":609},[1797],{"type":403,"value":612},{"type":397,"tag":499,"props":1799,"children":1800},{"style":506},[1801],{"type":403,"value":1135},{"type":397,"tag":499,"props":1803,"children":1804},{"style":512},[1805],{"type":403,"value":698},{"type":397,"tag":499,"props":1807,"children":1808},{"style":992},[1809],{"type":403,"value":1144},{"type":397,"tag":499,"props":1811,"children":1812},{"style":512},[1813],{"type":403,"value":698},{"type":397,"tag":499,"props":1815,"children":1816},{"style":1007},[1817],{"type":403,"value":1153},{"type":397,"tag":499,"props":1819,"children":1820},{"style":512},[1821],{"type":403,"value":698},{"type":397,"tag":499,"props":1823,"children":1824},{"style":529},[1825],{"type":403,"value":532},{"type":397,"tag":499,"props":1827,"children":1828},{"style":512},[1829],{"type":403,"value":612},{"type":397,"tag":499,"props":1831,"children":1832},{"style":556},[1833],{"type":403,"value":1170},{"type":397,"tag":499,"props":1835,"children":1836},{"style":512},[1837],{"type":403,"value":698},{"type":397,"tag":499,"props":1839,"children":1840},{"style":556},[1841],{"type":403,"value":1179},{"type":397,"tag":499,"props":1843,"children":1844},{"style":512},[1845],{"type":403,"value":574},{"type":397,"tag":499,"props":1847,"children":1848},{"class":501,"line":848},[1849,1854,1858,1862,1866,1870,1874,1878],{"type":397,"tag":499,"props":1850,"children":1851},{"style":529},[1852],{"type":403,"value":1853},"          const",{"type":397,"tag":499,"props":1855,"children":1856},{"style":512},[1857],{"type":403,"value":1196},{"type":397,"tag":499,"props":1859,"children":1860},{"style":586},[1861],{"type":403,"value":1201},{"type":397,"tag":499,"props":1863,"children":1864},{"style":512},[1865],{"type":403,"value":698},{"type":397,"tag":499,"props":1867,"children":1868},{"style":586},[1869],{"type":403,"value":1210},{"type":397,"tag":499,"props":1871,"children":1872},{"style":512},[1873],{"type":403,"value":650},{"type":397,"tag":499,"props":1875,"children":1876},{"style":523},[1877],{"type":403,"value":526},{"type":397,"tag":499,"props":1879,"children":1880},{"style":506},[1881],{"type":403,"value":1232},{"type":397,"tag":499,"props":1883,"children":1884},{"class":501,"line":857},[1885,1889,1894,1898,1902,1906,1910,1914,1918,1922,1926,1930],{"type":397,"tag":499,"props":1886,"children":1887},{"style":529},[1888],{"type":403,"value":1853},{"type":397,"tag":499,"props":1890,"children":1891},{"style":586},[1892],{"type":403,"value":1893}," originalOpener",{"type":397,"tag":499,"props":1895,"children":1896},{"style":523},[1897],{"type":403,"value":526},{"type":397,"tag":499,"props":1899,"children":1900},{"style":506},[1901],{"type":403,"value":1210},{"type":397,"tag":499,"props":1903,"children":1904},{"style":512},[1905],{"type":403,"value":515},{"type":397,"tag":499,"props":1907,"children":1908},{"style":518},[1909],{"type":403,"value":985},{"type":397,"tag":499,"props":1911,"children":1912},{"style":609},[1913],{"type":403,"value":612},{"type":397,"tag":499,"props":1915,"children":1916},{"style":992},[1917],{"type":403,"value":995},{"type":397,"tag":499,"props":1919,"children":1920},{"style":512},[1921],{"type":403,"value":698},{"type":397,"tag":499,"props":1923,"children":1924},{"style":523},[1925],{"type":403,"value":1004},{"type":397,"tag":499,"props":1927,"children":1928},{"style":506},[1929],{"type":403,"value":1170},{"type":397,"tag":499,"props":1931,"children":1932},{"style":609},[1933],{"type":403,"value":655},{"type":397,"tag":499,"props":1935,"children":1936},{"class":501,"line":1310},[1937,1942,1946,1951,1955,1961,1965],{"type":397,"tag":499,"props":1938,"children":1939},{"style":721},[1940],{"type":403,"value":1941},"          if",{"type":397,"tag":499,"props":1943,"children":1944},{"style":609},[1945],{"type":403,"value":729},{"type":397,"tag":499,"props":1947,"children":1948},{"style":506},[1949],{"type":403,"value":1950},"originalOpener",{"type":397,"tag":499,"props":1952,"children":1953},{"style":523},[1954],{"type":403,"value":748},{"type":397,"tag":499,"props":1956,"children":1958},{"style":1957},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1959],{"type":403,"value":1960}," null",{"type":397,"tag":499,"props":1962,"children":1963},{"style":609},[1964],{"type":403,"value":645},{"type":397,"tag":499,"props":1966,"children":1967},{"style":512},[1968],{"type":403,"value":771},{"type":397,"tag":499,"props":1970,"children":1971},{"class":501,"line":1319},[1972,1977,1981,1985,1989,1993],{"type":397,"tag":499,"props":1973,"children":1974},{"style":518},[1975],{"type":403,"value":1976},"            notify",{"type":397,"tag":499,"props":1978,"children":1979},{"style":609},[1980],{"type":403,"value":612},{"type":397,"tag":499,"props":1982,"children":1983},{"style":680},[1984],{"type":403,"value":683},{"type":397,"tag":499,"props":1986,"children":1987},{"style":686},[1988],{"type":403,"value":1597},{"type":397,"tag":499,"props":1990,"children":1991},{"style":680},[1992],{"type":403,"value":683},{"type":397,"tag":499,"props":1994,"children":1995},{"style":609},[1996],{"type":403,"value":655},{"type":397,"tag":499,"props":1998,"children":1999},{"class":501,"line":1328},[2000],{"type":397,"tag":499,"props":2001,"children":2002},{"style":512},[2003],{"type":403,"value":2004},"          }\n",{"type":397,"tag":499,"props":2006,"children":2007},{"class":501,"line":1342},[2008,2013],{"type":397,"tag":499,"props":2009,"children":2010},{"style":721},[2011],{"type":403,"value":2012},"          return",{"type":397,"tag":499,"props":2014,"children":2015},{"style":1957},[2016],{"type":403,"value":2017}," null\n",{"type":397,"tag":499,"props":2019,"children":2020},{"class":501,"line":1373},[2021,2026],{"type":397,"tag":499,"props":2022,"children":2023},{"style":512},[2024],{"type":403,"value":2025},"        }",{"type":397,"tag":499,"props":2027,"children":2028},{"style":609},[2029],{"type":403,"value":655},{"type":397,"tag":499,"props":2031,"children":2032},{"class":501,"line":1420},[2033],{"type":397,"tag":499,"props":2034,"children":2035},{"style":512},[2036],{"type":403,"value":1453},{"type":397,"tag":499,"props":2038,"children":2039},{"class":501,"line":1433},[2040],{"type":397,"tag":499,"props":2041,"children":2042},{"style":512},[2043],{"type":403,"value":2044},"    }\n",{"type":397,"tag":499,"props":2046,"children":2047},{"class":501,"line":1447},[2048,2052,2057,2061,2066,2070,2075,2079,2083,2088,2092,2096,2100],{"type":397,"tag":499,"props":2049,"children":2050},{"style":721},[2051],{"type":403,"value":1121},{"type":397,"tag":499,"props":2053,"children":2054},{"style":506},[2055],{"type":403,"value":2056}," Object",{"type":397,"tag":499,"props":2058,"children":2059},{"style":512},[2060],{"type":403,"value":515},{"type":397,"tag":499,"props":2062,"children":2063},{"style":518},[2064],{"type":403,"value":2065},"getOwnPropertyDescriptor",{"type":397,"tag":499,"props":2067,"children":2068},{"style":609},[2069],{"type":403,"value":612},{"type":397,"tag":499,"props":2071,"children":2072},{"style":506},[2073],{"type":403,"value":2074},"temp",{"type":397,"tag":499,"props":2076,"children":2077},{"style":512},[2078],{"type":403,"value":698},{"type":397,"tag":499,"props":2080,"children":2081},{"style":680},[2082],{"type":403,"value":753},{"type":397,"tag":499,"props":2084,"children":2085},{"style":686},[2086],{"type":403,"value":2087},"opener",{"type":397,"tag":499,"props":2089,"children":2090},{"style":680},[2091],{"type":403,"value":683},{"type":397,"tag":499,"props":2093,"children":2094},{"style":609},[2095],{"type":403,"value":645},{"type":397,"tag":499,"props":2097,"children":2098},{"style":512},[2099],{"type":403,"value":515},{"type":397,"tag":499,"props":2101,"children":2102},{"style":506},[2103],{"type":403,"value":2104},"get\n",{"type":397,"tag":499,"props":2106,"children":2107},{"class":501,"line":1456},[2108],{"type":397,"tag":499,"props":2109,"children":2110},{"style":512},[2111],{"type":403,"value":2112},"  },\n",{"type":397,"tag":499,"props":2114,"children":2115},{"class":501,"line":1464},[2116],{"type":397,"tag":499,"props":2117,"children":2118},{"style":965},[2119],{"type":403,"value":2120},"  // 修改 Descriptor.Value 使得 window.opener 一直返回 null，\n",{"type":397,"tag":499,"props":2122,"children":2123},{"class":501,"line":1473},[2124],{"type":397,"tag":499,"props":2125,"children":2126},{"style":965},[2127],{"type":403,"value":2128},"  // 这是一种兼容，在部分浏览器中，\n",{"type":397,"tag":499,"props":2130,"children":2131},{"class":501,"line":1482},[2132],{"type":397,"tag":499,"props":2133,"children":2134},{"style":965},[2135],{"type":403,"value":2136},"  //  window.opener 是通过 value 而不是 getter 获取的值\n",{"type":397,"tag":499,"props":2138,"children":2139},{"class":501,"line":1491},[2140,2145,2149,2153,2157,2162,2166,2171],{"type":397,"tag":499,"props":2141,"children":2142},{"style":1718},[2143],{"type":403,"value":2144},"  valueGenerator",{"type":397,"tag":499,"props":2146,"children":2147},{"style":512},[2148],{"type":403,"value":553},{"type":397,"tag":499,"props":2150,"children":2151},{"style":529},[2152],{"type":403,"value":532},{"type":397,"tag":499,"props":2154,"children":2155},{"style":512},[2156],{"type":403,"value":542},{"type":397,"tag":499,"props":2158,"children":2159},{"style":556},[2160],{"type":403,"value":2161},"original",{"type":397,"tag":499,"props":2163,"children":2164},{"style":512},[2165],{"type":403,"value":698},{"type":397,"tag":499,"props":2167,"children":2168},{"style":556},[2169],{"type":403,"value":2170}," notify",{"type":397,"tag":499,"props":2172,"children":2173},{"style":512},[2174],{"type":403,"value":2175},"}){\n",{"type":397,"tag":499,"props":2177,"children":2178},{"class":501,"line":1545},[2179,2184,2188,2192,2196,2200,2204],{"type":397,"tag":499,"props":2180,"children":2181},{"style":721},[2182],{"type":403,"value":2183},"    if",{"type":397,"tag":499,"props":2185,"children":2186},{"style":609},[2187],{"type":403,"value":729},{"type":397,"tag":499,"props":2189,"children":2190},{"style":506},[2191],{"type":403,"value":2161},{"type":397,"tag":499,"props":2193,"children":2194},{"style":523},[2195],{"type":403,"value":748},{"type":397,"tag":499,"props":2197,"children":2198},{"style":1957},[2199],{"type":403,"value":1960},{"type":397,"tag":499,"props":2201,"children":2202},{"style":609},[2203],{"type":403,"value":645},{"type":397,"tag":499,"props":2205,"children":2206},{"style":512},[2207],{"type":403,"value":771},{"type":397,"tag":499,"props":2209,"children":2210},{"class":501,"line":1578},[2211,2216,2220,2224,2228,2232],{"type":397,"tag":499,"props":2212,"children":2213},{"style":518},[2214],{"type":403,"value":2215},"      notify",{"type":397,"tag":499,"props":2217,"children":2218},{"style":609},[2219],{"type":403,"value":612},{"type":397,"tag":499,"props":2221,"children":2222},{"style":680},[2223],{"type":403,"value":683},{"type":397,"tag":499,"props":2225,"children":2226},{"style":686},[2227],{"type":403,"value":1597},{"type":397,"tag":499,"props":2229,"children":2230},{"style":680},[2231],{"type":403,"value":683},{"type":397,"tag":499,"props":2233,"children":2234},{"style":609},[2235],{"type":403,"value":655},{"type":397,"tag":499,"props":2237,"children":2238},{"class":501,"line":1608},[2239],{"type":397,"tag":499,"props":2240,"children":2241},{"style":512},[2242],{"type":403,"value":2044},{"type":397,"tag":499,"props":2244,"children":2245},{"class":501,"line":1616},[2246,2250],{"type":397,"tag":499,"props":2247,"children":2248},{"style":721},[2249],{"type":403,"value":1121},{"type":397,"tag":499,"props":2251,"children":2252},{"style":1957},[2253],{"type":403,"value":2017},{"type":397,"tag":499,"props":2255,"children":2256},{"class":501,"line":1630},[2257],{"type":397,"tag":499,"props":2258,"children":2259},{"style":512},[2260],{"type":403,"value":854},{"type":397,"tag":499,"props":2262,"children":2263},{"class":501,"line":1648},[2264],{"type":397,"tag":499,"props":2265,"children":2266},{"style":512},[2267],{"type":403,"value":863},{"type":397,"tag":405,"props":2269,"children":2271},{"id":2270},"canvas",[2272],{"type":403,"value":2273},"Canvas",{"type":397,"tag":411,"props":2275,"children":2276},{},[2277],{"type":403,"value":2278},"伪造了 getContext、getDataURL 等 API，并替代了原本正常的 API。",{"type":397,"tag":405,"props":2280,"children":2282},{"id":2281},"相关链接",[2283],{"type":403,"value":2281},{"type":397,"tag":417,"props":2285,"children":2286},{},[2287],{"type":397,"tag":421,"props":2288,"children":2289},{},[2290],{"type":397,"tag":893,"props":2291,"children":2294},{"href":2292,"rel":2293},"https://github.com/kkapsner/CanvasBlocker",[897],[2295],{"type":403,"value":2296},"CanvasBlocker",{"type":397,"tag":2298,"props":2299,"children":2300},"style",{},[2301],{"type":403,"value":2302},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":391,"searchDepth":577,"depth":577,"links":2304},[2305,2306,2307,2310,2311,2312],{"id":407,"depth":577,"text":407},{"id":473,"depth":577,"text":476},{"id":866,"depth":577,"text":445,"children":2308},[2309],{"id":877,"depth":658,"text":880},{"id":1664,"depth":577,"text":1667},{"id":2270,"depth":577,"text":2273},{"id":2281,"depth":577,"text":2281},"markdown","content:8.source-code:_fingerprint:canvas-blocker.md","content","8.source-code/_fingerprint/canvas-blocker.md","md",[2319,2322],{"_path":2320,"title":2321,"description":391},"/source-code/_es/object-assign","Object.prototype.assign",{"_path":2323,"title":2324,"description":391},"/source-code/_js/element-plus","ElementPlus",1710257734674]