[{"data":1,"prerenderedAt":4373},["Reactive",2],{"navigation":3,"/source-code/_node/node-watch":383,"/source-code/_node/node-watch-surround":4365},[4,32,80,96,123,129,135,366,372,378],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":42,"_path":43},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":45,"_path":46},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":48,"_path":49},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":51,"_path":52},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":54,"_path":55},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":57,"_path":58},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":60,"_path":61},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":63,"_path":64},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":66,"_path":67},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":69,"_path":70},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":72,"_path":73},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":75,"_path":76},"🚝 四十二篇系列","/articles/fourty-two",{"title":78,"_path":79},"📝 技术博客归档","/articles/fold",{"title":81,"_path":82,"children":83},"造物 / Make","/tools",[84,87,90,93],{"title":85,"_path":86},"🌐 AnySort","/tools/anysort",{"title":88,"_path":89},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":91,"_path":92},"👓 Crapto","/tools/crypto-inline",{"title":94,"_path":95},"🖨️ any-to-base64","/tools/any-to-base64",{"title":97,"_path":98,"children":99},"吉他剧场 / Music","/music",[100,102,105,108,111,114,117,120],{"title":101,"_path":98},"🎸 FingerStyle！",{"title":103,"_path":104},"🌬️ 等待的风","/music/wind",{"title":106,"_path":107},"💕 约定的海洋","/music/ocean",{"title":109,"_path":110},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":112,"_path":113},"🌏 残酷天使的行动纲领","/music/eva",{"title":115,"_path":116},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":118,"_path":119},"🍷 Wu Wei","/music/wu-wei",{"title":121,"_path":122},"🌅 无题","/music/untitled",{"title":124,"_path":125,"children":126},"画点什么 / Paint","/paint",[127],{"title":128,"_path":125},"🚧 正在施工",{"title":130,"_path":131,"children":132},"知识地图 / Maps","/maps",[133],{"title":134,"_path":131},"🏁 知识地图",{"title":136,"_path":137,"children":138},"零散的笔记 / Gists","/gists",[139,141,144,147,150,153,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363],{"title":140,"_path":137},"🧊 Gists",{"title":142,"_path":143},"网站的可访问性","/gists/accessibility",{"title":145,"_path":146},"图片模糊","/gists/blur",{"title":148,"_path":149},"渲染相关笔记","/gists/c4d",{"title":151,"_path":152},"CDN 问题记录","/gists/cdn",{"title":154,"_path":155},"消毒剂","/gists/cleaner",{"title":157,"_path":158},"Windows Command","/gists/cmd",{"title":160,"_path":161},"Command","/gists/command",{"title":163,"_path":164},"复杂科学","/gists/complexity-science",{"title":166,"_path":167},"宇宙","/gists/cosmos",{"title":169,"_path":170},"C++","/gists/cpp",{"title":172,"_path":173},"Data Structure","/gists/data-structure",{"title":175,"_path":176},"DEPRESSION","/gists/depression",{"title":178,"_path":179},"设计模式","/gists/design-patterns",{"title":181,"_path":182},"Developer Experience","/gists/developer-experience",{"title":184,"_path":185},"Device Metrics","/gists/device-metrix",{"title":187,"_path":188},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":190,"_path":191},"正则表达式","/gists/eegex",{"title":193,"_path":194},"Emoji","/gists/emoji",{"title":196,"_path":197},"工程","/gists/engineering",{"title":199,"_path":200},"熵","/gists/entropy",{"title":202,"_path":203},"Environment","/gists/environment",{"title":205,"_path":206},"Erlang","/gists/erlang",{"title":208,"_path":209},"逃离塔克夫","/gists/escape-from-tarkov",{"title":211,"_path":212},"ESNext (ES6-ES11)","/gists/esnext",{"title":214,"_path":215},"Eval！","/gists/eval",{"title":217,"_path":218},"Flutter","/gists/flutter",{"title":220,"_path":221},"字体","/gists/font",{"title":223,"_path":224},"JS 函数式编程","/gists/functional",{"title":226,"_path":227},"Google C++ Standard","/gists/google-cpp-standard",{"title":229,"_path":230},"双向链接完全体","/gists/graph",{"title":232,"_path":233},"Hardwares","/gists/hardwares",{"title":235,"_path":236},"哈希冲突","/gists/hash-collision",{"title":238,"_path":239},"信息设计","/gists/information-design",{"title":241,"_path":242},"InstantPage","/gists/instant.page",{"title":244,"_path":245},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":247,"_path":248},"KVStore","/gists/key-value-db",{"title":250,"_path":251},"Kubernetes","/gists/kubernetes",{"title":253,"_path":254},"Makefile","/gists/makefile",{"title":256,"_path":257},"Markdown Inline Style","/gists/markdown-nice",{"title":259,"_path":260},"小程序","/gists/miniapp",{"title":262,"_path":263},"减小页面快照体积","/gists/minify-html",{"title":265,"_path":266},"mklink","/gists/mklink",{"title":268,"_path":269},"Mock","/gists/mock",{"title":271,"_path":272},"多端应用","/gists/multy-end-app",{"title":274,"_path":275},"神经科学","/gists/neuroscience",{"title":277,"_path":278},"OO","/gists/oo",{"title":280,"_path":281},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":283,"_path":284},"人物","/gists/person",{"title":286,"_path":287},"PInvoke","/gists/pinvoke",{"title":289,"_path":290},"像素","/gists/pixel",{"title":292,"_path":293},"PowerShell","/gists/powershell",{"title":295,"_path":296},"量子","/gists/quantum",{"title":298,"_path":299},"保持好奇心","/gists/questions",{"title":301,"_path":302},"React Native","/gists/react-native",{"title":304,"_path":305},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":307,"_path":308},"SEO","/gists/seo",{"title":310,"_path":311},"Shader","/gists/shader",{"title":313,"_path":314},"Shape Up","/gists/shape-up",{"title":316,"_path":317},"睡觉","/gists/sleep",{"title":319,"_path":320},"States","/gists/states",{"title":322,"_path":323},"Storage","/gists/storage",{"title":325,"_path":326},"音视频流处理","/gists/stream-cli",{"title":328,"_path":329},"Symbol","/gists/symbol",{"title":331,"_path":332},"系统论","/gists/systems-theory",{"title":334,"_path":335},"Taro","/gists/taro",{"title":337,"_path":338},"任务切片","/gists/task-slice",{"title":340,"_path":341},"技术偏好","/gists/tech-dudge",{"title":343,"_path":344},"Untitled","/gists/untitled",{"title":346,"_path":347},"可变字体","/gists/variable-font",{"title":349,"_path":350},"视觉错觉","/gists/visual-illusion",{"title":352,"_path":353},"SS(SSR)","/gists/vpn",{"title":355,"_path":356},"VS Code 插件开发","/gists/vscode-plugin",{"title":358,"_path":359},"Web Components","/gists/web-components",{"title":361,"_path":362},"Windows","/gists/windows",{"title":364,"_path":365},"查缺补漏","/gists/wrong",{"title":367,"_path":368,"children":369},"代码笔记 / Gists","/source-code",[370],{"title":371,"_path":368},"🚄 代码笔记",{"title":373,"_path":374,"children":375},"我 / Abount","/hire",[376],{"title":377,"_path":374},"📬 技术简历",{"title":379,"_path":380,"children":381},"todo","/todo",[382],{"title":379,"_path":380},{"_path":384,"_dir":385,"_draft":386,"_partial":387,"_locale":388,"title":389,"description":390,"body":391,"_type":4360,"_id":4361,"_source":4362,"_file":4363,"_extension":4364},"/source-code/_node/node-watch","_node",false,true,"","node-watch","node-watch 是在 fs.watch 的基础上封装而来的库，能监听文件变化",{"type":392,"children":393,"toc":4353},"root",[394,402,408,1145,1161,1438,1443,1620,1625,2295,2300,2757,2762,3913,3918,3923,4080,4085,4182,4187,4192,4217,4222,4261,4266,4272,4277,4282,4287,4319,4324,4347],{"type":395,"tag":396,"props":397,"children":399},"element","h2",{"id":398},"实现",[400],{"type":401,"value":398},"text",{"type":395,"tag":403,"props":404,"children":405},"p",{},[406],{"type":401,"value":407},"从提交历史来看，最初的提交的代码非常简单，几乎是只多了一个递归监听功能。在 normalizeCall 函数中使用计时函数，把回调往后延迟了 100ms，防止短暂时间内同一个文件多次修改（比方说某些编辑器保存文件时会先生成一个临时文件）。",{"type":395,"tag":409,"props":410,"children":414},"pre",{"className":411,"code":412,"language":413,"meta":388,"style":388},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","//  https://github.com/yuanchuan/node-watch/commit/d2d8e2db4b771f918d67d261708752d8eb5c17b3\nfunction watch(dir, cb) {\n  if (is.File(dir)) {\n    fs.watchFile(dir, function(err) {\n      normalizeCall(cb, dir)\n    })\n    return\n  }\n  if (is.Directory(dir)) {\n    fs.watch(dir, function(err, fname) {\n      normalizeCall(cb,  \n        path.join(dir, fname)\n      )\n    })\n    fs.readdir(dir, function(err, files) {\n      if (err) throw err\n      files.forEach(function(n) { \n        var file = path.join(dir, n)\n        if ( is.Directory(file) ) {\n          watch(file, cb)\n        }\n      })\n    })     \n  }\n} \n","js",[415],{"type":395,"tag":416,"props":417,"children":418},"code",{"__ignoreMap":388},[419,431,479,529,581,613,626,635,644,685,743,768,806,815,827,885,917,966,1020,1064,1093,1102,1115,1128,1136],{"type":395,"tag":420,"props":421,"children":424},"span",{"class":422,"line":423},"line",1,[425],{"type":395,"tag":420,"props":426,"children":428},{"style":427},"--shiki-light:#90A4AE;--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[429],{"type":401,"value":430},"//  https://github.com/yuanchuan/node-watch/commit/d2d8e2db4b771f918d67d261708752d8eb5c17b3\n",{"type":395,"tag":420,"props":432,"children":434},{"class":422,"line":433},2,[435,441,447,453,459,464,469,474],{"type":395,"tag":420,"props":436,"children":438},{"style":437},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-light-font-style:inherit;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[439],{"type":401,"value":440},"function",{"type":395,"tag":420,"props":442,"children":444},{"style":443},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[445],{"type":401,"value":446}," watch",{"type":395,"tag":420,"props":448,"children":450},{"style":449},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[451],{"type":401,"value":452},"(",{"type":395,"tag":420,"props":454,"children":456},{"style":455},"--shiki-light:#90A4AE;--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[457],{"type":401,"value":458},"dir",{"type":395,"tag":420,"props":460,"children":461},{"style":449},[462],{"type":401,"value":463},",",{"type":395,"tag":420,"props":465,"children":466},{"style":455},[467],{"type":401,"value":468}," cb",{"type":395,"tag":420,"props":470,"children":471},{"style":449},[472],{"type":401,"value":473},")",{"type":395,"tag":420,"props":475,"children":476},{"style":449},[477],{"type":401,"value":478}," {\n",{"type":395,"tag":420,"props":480,"children":482},{"class":422,"line":481},3,[483,489,495,501,506,511,515,519,524],{"type":395,"tag":420,"props":484,"children":486},{"style":485},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[487],{"type":401,"value":488},"  if",{"type":395,"tag":420,"props":490,"children":492},{"style":491},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[493],{"type":401,"value":494}," (",{"type":395,"tag":420,"props":496,"children":498},{"style":497},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[499],{"type":401,"value":500},"is",{"type":395,"tag":420,"props":502,"children":503},{"style":449},[504],{"type":401,"value":505},".",{"type":395,"tag":420,"props":507,"children":508},{"style":443},[509],{"type":401,"value":510},"File",{"type":395,"tag":420,"props":512,"children":513},{"style":491},[514],{"type":401,"value":452},{"type":395,"tag":420,"props":516,"children":517},{"style":497},[518],{"type":401,"value":458},{"type":395,"tag":420,"props":520,"children":521},{"style":491},[522],{"type":401,"value":523},")) ",{"type":395,"tag":420,"props":525,"children":526},{"style":449},[527],{"type":401,"value":528},"{\n",{"type":395,"tag":420,"props":530,"children":532},{"class":422,"line":531},4,[533,538,542,547,551,555,559,564,568,573,577],{"type":395,"tag":420,"props":534,"children":535},{"style":497},[536],{"type":401,"value":537},"    fs",{"type":395,"tag":420,"props":539,"children":540},{"style":449},[541],{"type":401,"value":505},{"type":395,"tag":420,"props":543,"children":544},{"style":443},[545],{"type":401,"value":546},"watchFile",{"type":395,"tag":420,"props":548,"children":549},{"style":491},[550],{"type":401,"value":452},{"type":395,"tag":420,"props":552,"children":553},{"style":497},[554],{"type":401,"value":458},{"type":395,"tag":420,"props":556,"children":557},{"style":449},[558],{"type":401,"value":463},{"type":395,"tag":420,"props":560,"children":561},{"style":437},[562],{"type":401,"value":563}," function",{"type":395,"tag":420,"props":565,"children":566},{"style":449},[567],{"type":401,"value":452},{"type":395,"tag":420,"props":569,"children":570},{"style":455},[571],{"type":401,"value":572},"err",{"type":395,"tag":420,"props":574,"children":575},{"style":449},[576],{"type":401,"value":473},{"type":395,"tag":420,"props":578,"children":579},{"style":449},[580],{"type":401,"value":478},{"type":395,"tag":420,"props":582,"children":584},{"class":422,"line":583},5,[585,590,594,599,603,608],{"type":395,"tag":420,"props":586,"children":587},{"style":443},[588],{"type":401,"value":589},"      normalizeCall",{"type":395,"tag":420,"props":591,"children":592},{"style":491},[593],{"type":401,"value":452},{"type":395,"tag":420,"props":595,"children":596},{"style":497},[597],{"type":401,"value":598},"cb",{"type":395,"tag":420,"props":600,"children":601},{"style":449},[602],{"type":401,"value":463},{"type":395,"tag":420,"props":604,"children":605},{"style":497},[606],{"type":401,"value":607}," dir",{"type":395,"tag":420,"props":609,"children":610},{"style":491},[611],{"type":401,"value":612},")\n",{"type":395,"tag":420,"props":614,"children":616},{"class":422,"line":615},6,[617,622],{"type":395,"tag":420,"props":618,"children":619},{"style":449},[620],{"type":401,"value":621},"    }",{"type":395,"tag":420,"props":623,"children":624},{"style":491},[625],{"type":401,"value":612},{"type":395,"tag":420,"props":627,"children":629},{"class":422,"line":628},7,[630],{"type":395,"tag":420,"props":631,"children":632},{"style":485},[633],{"type":401,"value":634},"    return\n",{"type":395,"tag":420,"props":636,"children":638},{"class":422,"line":637},8,[639],{"type":395,"tag":420,"props":640,"children":641},{"style":449},[642],{"type":401,"value":643},"  }\n",{"type":395,"tag":420,"props":645,"children":647},{"class":422,"line":646},9,[648,652,656,660,664,669,673,677,681],{"type":395,"tag":420,"props":649,"children":650},{"style":485},[651],{"type":401,"value":488},{"type":395,"tag":420,"props":653,"children":654},{"style":491},[655],{"type":401,"value":494},{"type":395,"tag":420,"props":657,"children":658},{"style":497},[659],{"type":401,"value":500},{"type":395,"tag":420,"props":661,"children":662},{"style":449},[663],{"type":401,"value":505},{"type":395,"tag":420,"props":665,"children":666},{"style":443},[667],{"type":401,"value":668},"Directory",{"type":395,"tag":420,"props":670,"children":671},{"style":491},[672],{"type":401,"value":452},{"type":395,"tag":420,"props":674,"children":675},{"style":497},[676],{"type":401,"value":458},{"type":395,"tag":420,"props":678,"children":679},{"style":491},[680],{"type":401,"value":523},{"type":395,"tag":420,"props":682,"children":683},{"style":449},[684],{"type":401,"value":528},{"type":395,"tag":420,"props":686,"children":688},{"class":422,"line":687},10,[689,693,697,702,706,710,714,718,722,726,730,735,739],{"type":395,"tag":420,"props":690,"children":691},{"style":497},[692],{"type":401,"value":537},{"type":395,"tag":420,"props":694,"children":695},{"style":449},[696],{"type":401,"value":505},{"type":395,"tag":420,"props":698,"children":699},{"style":443},[700],{"type":401,"value":701},"watch",{"type":395,"tag":420,"props":703,"children":704},{"style":491},[705],{"type":401,"value":452},{"type":395,"tag":420,"props":707,"children":708},{"style":497},[709],{"type":401,"value":458},{"type":395,"tag":420,"props":711,"children":712},{"style":449},[713],{"type":401,"value":463},{"type":395,"tag":420,"props":715,"children":716},{"style":437},[717],{"type":401,"value":563},{"type":395,"tag":420,"props":719,"children":720},{"style":449},[721],{"type":401,"value":452},{"type":395,"tag":420,"props":723,"children":724},{"style":455},[725],{"type":401,"value":572},{"type":395,"tag":420,"props":727,"children":728},{"style":449},[729],{"type":401,"value":463},{"type":395,"tag":420,"props":731,"children":732},{"style":455},[733],{"type":401,"value":734}," fname",{"type":395,"tag":420,"props":736,"children":737},{"style":449},[738],{"type":401,"value":473},{"type":395,"tag":420,"props":740,"children":741},{"style":449},[742],{"type":401,"value":478},{"type":395,"tag":420,"props":744,"children":746},{"class":422,"line":745},11,[747,751,755,759,763],{"type":395,"tag":420,"props":748,"children":749},{"style":443},[750],{"type":401,"value":589},{"type":395,"tag":420,"props":752,"children":753},{"style":491},[754],{"type":401,"value":452},{"type":395,"tag":420,"props":756,"children":757},{"style":497},[758],{"type":401,"value":598},{"type":395,"tag":420,"props":760,"children":761},{"style":449},[762],{"type":401,"value":463},{"type":395,"tag":420,"props":764,"children":765},{"style":491},[766],{"type":401,"value":767},"  \n",{"type":395,"tag":420,"props":769,"children":771},{"class":422,"line":770},12,[772,777,781,786,790,794,798,802],{"type":395,"tag":420,"props":773,"children":774},{"style":497},[775],{"type":401,"value":776},"        path",{"type":395,"tag":420,"props":778,"children":779},{"style":449},[780],{"type":401,"value":505},{"type":395,"tag":420,"props":782,"children":783},{"style":443},[784],{"type":401,"value":785},"join",{"type":395,"tag":420,"props":787,"children":788},{"style":491},[789],{"type":401,"value":452},{"type":395,"tag":420,"props":791,"children":792},{"style":497},[793],{"type":401,"value":458},{"type":395,"tag":420,"props":795,"children":796},{"style":449},[797],{"type":401,"value":463},{"type":395,"tag":420,"props":799,"children":800},{"style":497},[801],{"type":401,"value":734},{"type":395,"tag":420,"props":803,"children":804},{"style":491},[805],{"type":401,"value":612},{"type":395,"tag":420,"props":807,"children":809},{"class":422,"line":808},13,[810],{"type":395,"tag":420,"props":811,"children":812},{"style":491},[813],{"type":401,"value":814},"      )\n",{"type":395,"tag":420,"props":816,"children":818},{"class":422,"line":817},14,[819,823],{"type":395,"tag":420,"props":820,"children":821},{"style":449},[822],{"type":401,"value":621},{"type":395,"tag":420,"props":824,"children":825},{"style":491},[826],{"type":401,"value":612},{"type":395,"tag":420,"props":828,"children":830},{"class":422,"line":829},15,[831,835,839,844,848,852,856,860,864,868,872,877,881],{"type":395,"tag":420,"props":832,"children":833},{"style":497},[834],{"type":401,"value":537},{"type":395,"tag":420,"props":836,"children":837},{"style":449},[838],{"type":401,"value":505},{"type":395,"tag":420,"props":840,"children":841},{"style":443},[842],{"type":401,"value":843},"readdir",{"type":395,"tag":420,"props":845,"children":846},{"style":491},[847],{"type":401,"value":452},{"type":395,"tag":420,"props":849,"children":850},{"style":497},[851],{"type":401,"value":458},{"type":395,"tag":420,"props":853,"children":854},{"style":449},[855],{"type":401,"value":463},{"type":395,"tag":420,"props":857,"children":858},{"style":437},[859],{"type":401,"value":563},{"type":395,"tag":420,"props":861,"children":862},{"style":449},[863],{"type":401,"value":452},{"type":395,"tag":420,"props":865,"children":866},{"style":455},[867],{"type":401,"value":572},{"type":395,"tag":420,"props":869,"children":870},{"style":449},[871],{"type":401,"value":463},{"type":395,"tag":420,"props":873,"children":874},{"style":455},[875],{"type":401,"value":876}," files",{"type":395,"tag":420,"props":878,"children":879},{"style":449},[880],{"type":401,"value":473},{"type":395,"tag":420,"props":882,"children":883},{"style":449},[884],{"type":401,"value":478},{"type":395,"tag":420,"props":886,"children":888},{"class":422,"line":887},16,[889,894,898,902,907,912],{"type":395,"tag":420,"props":890,"children":891},{"style":485},[892],{"type":401,"value":893},"      if",{"type":395,"tag":420,"props":895,"children":896},{"style":491},[897],{"type":401,"value":494},{"type":395,"tag":420,"props":899,"children":900},{"style":497},[901],{"type":401,"value":572},{"type":395,"tag":420,"props":903,"children":904},{"style":491},[905],{"type":401,"value":906},") ",{"type":395,"tag":420,"props":908,"children":909},{"style":485},[910],{"type":401,"value":911},"throw",{"type":395,"tag":420,"props":913,"children":914},{"style":497},[915],{"type":401,"value":916}," err\n",{"type":395,"tag":420,"props":918,"children":920},{"class":422,"line":919},17,[921,926,930,935,939,943,947,952,956,961],{"type":395,"tag":420,"props":922,"children":923},{"style":497},[924],{"type":401,"value":925},"      files",{"type":395,"tag":420,"props":927,"children":928},{"style":449},[929],{"type":401,"value":505},{"type":395,"tag":420,"props":931,"children":932},{"style":443},[933],{"type":401,"value":934},"forEach",{"type":395,"tag":420,"props":936,"children":937},{"style":491},[938],{"type":401,"value":452},{"type":395,"tag":420,"props":940,"children":941},{"style":437},[942],{"type":401,"value":440},{"type":395,"tag":420,"props":944,"children":945},{"style":449},[946],{"type":401,"value":452},{"type":395,"tag":420,"props":948,"children":949},{"style":455},[950],{"type":401,"value":951},"n",{"type":395,"tag":420,"props":953,"children":954},{"style":449},[955],{"type":401,"value":473},{"type":395,"tag":420,"props":957,"children":958},{"style":449},[959],{"type":401,"value":960}," {",{"type":395,"tag":420,"props":962,"children":963},{"style":491},[964],{"type":401,"value":965}," \n",{"type":395,"tag":420,"props":967,"children":969},{"class":422,"line":968},18,[970,975,980,986,991,995,999,1003,1007,1011,1016],{"type":395,"tag":420,"props":971,"children":972},{"style":437},[973],{"type":401,"value":974},"        var",{"type":395,"tag":420,"props":976,"children":977},{"style":497},[978],{"type":401,"value":979}," file",{"type":395,"tag":420,"props":981,"children":983},{"style":982},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[984],{"type":401,"value":985}," =",{"type":395,"tag":420,"props":987,"children":988},{"style":497},[989],{"type":401,"value":990}," path",{"type":395,"tag":420,"props":992,"children":993},{"style":449},[994],{"type":401,"value":505},{"type":395,"tag":420,"props":996,"children":997},{"style":443},[998],{"type":401,"value":785},{"type":395,"tag":420,"props":1000,"children":1001},{"style":491},[1002],{"type":401,"value":452},{"type":395,"tag":420,"props":1004,"children":1005},{"style":497},[1006],{"type":401,"value":458},{"type":395,"tag":420,"props":1008,"children":1009},{"style":449},[1010],{"type":401,"value":463},{"type":395,"tag":420,"props":1012,"children":1013},{"style":497},[1014],{"type":401,"value":1015}," n",{"type":395,"tag":420,"props":1017,"children":1018},{"style":491},[1019],{"type":401,"value":612},{"type":395,"tag":420,"props":1021,"children":1023},{"class":422,"line":1022},19,[1024,1029,1034,1038,1042,1046,1050,1055,1060],{"type":395,"tag":420,"props":1025,"children":1026},{"style":485},[1027],{"type":401,"value":1028},"        if",{"type":395,"tag":420,"props":1030,"children":1031},{"style":491},[1032],{"type":401,"value":1033}," ( ",{"type":395,"tag":420,"props":1035,"children":1036},{"style":497},[1037],{"type":401,"value":500},{"type":395,"tag":420,"props":1039,"children":1040},{"style":449},[1041],{"type":401,"value":505},{"type":395,"tag":420,"props":1043,"children":1044},{"style":443},[1045],{"type":401,"value":668},{"type":395,"tag":420,"props":1047,"children":1048},{"style":491},[1049],{"type":401,"value":452},{"type":395,"tag":420,"props":1051,"children":1052},{"style":497},[1053],{"type":401,"value":1054},"file",{"type":395,"tag":420,"props":1056,"children":1057},{"style":491},[1058],{"type":401,"value":1059},") ) ",{"type":395,"tag":420,"props":1061,"children":1062},{"style":449},[1063],{"type":401,"value":528},{"type":395,"tag":420,"props":1065,"children":1067},{"class":422,"line":1066},20,[1068,1073,1077,1081,1085,1089],{"type":395,"tag":420,"props":1069,"children":1070},{"style":443},[1071],{"type":401,"value":1072},"          watch",{"type":395,"tag":420,"props":1074,"children":1075},{"style":491},[1076],{"type":401,"value":452},{"type":395,"tag":420,"props":1078,"children":1079},{"style":497},[1080],{"type":401,"value":1054},{"type":395,"tag":420,"props":1082,"children":1083},{"style":449},[1084],{"type":401,"value":463},{"type":395,"tag":420,"props":1086,"children":1087},{"style":497},[1088],{"type":401,"value":468},{"type":395,"tag":420,"props":1090,"children":1091},{"style":491},[1092],{"type":401,"value":612},{"type":395,"tag":420,"props":1094,"children":1096},{"class":422,"line":1095},21,[1097],{"type":395,"tag":420,"props":1098,"children":1099},{"style":449},[1100],{"type":401,"value":1101},"        }\n",{"type":395,"tag":420,"props":1103,"children":1105},{"class":422,"line":1104},22,[1106,1111],{"type":395,"tag":420,"props":1107,"children":1108},{"style":449},[1109],{"type":401,"value":1110},"      }",{"type":395,"tag":420,"props":1112,"children":1113},{"style":491},[1114],{"type":401,"value":612},{"type":395,"tag":420,"props":1116,"children":1118},{"class":422,"line":1117},23,[1119,1123],{"type":395,"tag":420,"props":1120,"children":1121},{"style":449},[1122],{"type":401,"value":621},{"type":395,"tag":420,"props":1124,"children":1125},{"style":491},[1126],{"type":401,"value":1127},")     \n",{"type":395,"tag":420,"props":1129,"children":1131},{"class":422,"line":1130},24,[1132],{"type":395,"tag":420,"props":1133,"children":1134},{"style":449},[1135],{"type":401,"value":643},{"type":395,"tag":420,"props":1137,"children":1139},{"class":422,"line":1138},25,[1140],{"type":395,"tag":420,"props":1141,"children":1142},{"style":449},[1143],{"type":401,"value":1144},"}\n",{"type":395,"tag":403,"props":1146,"children":1147},{},[1148,1150,1159],{"type":401,"value":1149},"由于 fs.watchFile 可能导致",{"type":395,"tag":1151,"props":1152,"children":1156},"a",{"href":1153,"rel":1154},"https://nodejs.org/api/fs.html#fs_fs_watchfile_filename_options_listener",[1155],"nofollow",[1157],{"type":401,"value":1158},"高 CPU 负载等问题",{"type":401,"value":1160},"，watch 文件时使用 watch 其父目录作替代，并通过匹配事件参数是否和此文件同名来判断是否要触发回调函数。",{"type":395,"tag":409,"props":1162,"children":1164},{"className":411,"code":1163,"language":413,"meta":388,"style":388},"if (is.file(fpath)) {\n  var parent = path.resolve(fpath, '..')\n  fs.watch(parent, function(evt, fname) {\n    if (path.basename(fpath) === fname) {\n      normalizeCall(fpath, options, cb)\n    }\n  })\n} \n",[1165],{"type":395,"tag":416,"props":1166,"children":1167},{"__ignoreMap":388},[1168,1198,1262,1320,1375,1411,1419,1431],{"type":395,"tag":420,"props":1169,"children":1170},{"class":422,"line":423},[1171,1176,1181,1185,1189,1194],{"type":395,"tag":420,"props":1172,"children":1173},{"style":485},[1174],{"type":401,"value":1175},"if",{"type":395,"tag":420,"props":1177,"children":1178},{"style":497},[1179],{"type":401,"value":1180}," (is",{"type":395,"tag":420,"props":1182,"children":1183},{"style":449},[1184],{"type":401,"value":505},{"type":395,"tag":420,"props":1186,"children":1187},{"style":443},[1188],{"type":401,"value":1054},{"type":395,"tag":420,"props":1190,"children":1191},{"style":497},[1192],{"type":401,"value":1193},"(fpath)) ",{"type":395,"tag":420,"props":1195,"children":1196},{"style":449},[1197],{"type":401,"value":528},{"type":395,"tag":420,"props":1199,"children":1200},{"class":422,"line":433},[1201,1206,1211,1215,1219,1223,1228,1232,1237,1241,1247,1253,1258],{"type":395,"tag":420,"props":1202,"children":1203},{"style":437},[1204],{"type":401,"value":1205},"  var",{"type":395,"tag":420,"props":1207,"children":1208},{"style":497},[1209],{"type":401,"value":1210}," parent",{"type":395,"tag":420,"props":1212,"children":1213},{"style":982},[1214],{"type":401,"value":985},{"type":395,"tag":420,"props":1216,"children":1217},{"style":497},[1218],{"type":401,"value":990},{"type":395,"tag":420,"props":1220,"children":1221},{"style":449},[1222],{"type":401,"value":505},{"type":395,"tag":420,"props":1224,"children":1225},{"style":443},[1226],{"type":401,"value":1227},"resolve",{"type":395,"tag":420,"props":1229,"children":1230},{"style":491},[1231],{"type":401,"value":452},{"type":395,"tag":420,"props":1233,"children":1234},{"style":497},[1235],{"type":401,"value":1236},"fpath",{"type":395,"tag":420,"props":1238,"children":1239},{"style":449},[1240],{"type":401,"value":463},{"type":395,"tag":420,"props":1242,"children":1244},{"style":1243},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[1245],{"type":401,"value":1246}," '",{"type":395,"tag":420,"props":1248,"children":1250},{"style":1249},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[1251],{"type":401,"value":1252},"..",{"type":395,"tag":420,"props":1254,"children":1255},{"style":1243},[1256],{"type":401,"value":1257},"'",{"type":395,"tag":420,"props":1259,"children":1260},{"style":491},[1261],{"type":401,"value":612},{"type":395,"tag":420,"props":1263,"children":1264},{"class":422,"line":481},[1265,1270,1274,1278,1282,1287,1291,1295,1299,1304,1308,1312,1316],{"type":395,"tag":420,"props":1266,"children":1267},{"style":497},[1268],{"type":401,"value":1269},"  fs",{"type":395,"tag":420,"props":1271,"children":1272},{"style":449},[1273],{"type":401,"value":505},{"type":395,"tag":420,"props":1275,"children":1276},{"style":443},[1277],{"type":401,"value":701},{"type":395,"tag":420,"props":1279,"children":1280},{"style":491},[1281],{"type":401,"value":452},{"type":395,"tag":420,"props":1283,"children":1284},{"style":497},[1285],{"type":401,"value":1286},"parent",{"type":395,"tag":420,"props":1288,"children":1289},{"style":449},[1290],{"type":401,"value":463},{"type":395,"tag":420,"props":1292,"children":1293},{"style":437},[1294],{"type":401,"value":563},{"type":395,"tag":420,"props":1296,"children":1297},{"style":449},[1298],{"type":401,"value":452},{"type":395,"tag":420,"props":1300,"children":1301},{"style":455},[1302],{"type":401,"value":1303},"evt",{"type":395,"tag":420,"props":1305,"children":1306},{"style":449},[1307],{"type":401,"value":463},{"type":395,"tag":420,"props":1309,"children":1310},{"style":455},[1311],{"type":401,"value":734},{"type":395,"tag":420,"props":1313,"children":1314},{"style":449},[1315],{"type":401,"value":473},{"type":395,"tag":420,"props":1317,"children":1318},{"style":449},[1319],{"type":401,"value":478},{"type":395,"tag":420,"props":1321,"children":1322},{"class":422,"line":531},[1323,1328,1332,1337,1341,1346,1350,1354,1358,1363,1367,1371],{"type":395,"tag":420,"props":1324,"children":1325},{"style":485},[1326],{"type":401,"value":1327},"    if",{"type":395,"tag":420,"props":1329,"children":1330},{"style":491},[1331],{"type":401,"value":494},{"type":395,"tag":420,"props":1333,"children":1334},{"style":497},[1335],{"type":401,"value":1336},"path",{"type":395,"tag":420,"props":1338,"children":1339},{"style":449},[1340],{"type":401,"value":505},{"type":395,"tag":420,"props":1342,"children":1343},{"style":443},[1344],{"type":401,"value":1345},"basename",{"type":395,"tag":420,"props":1347,"children":1348},{"style":491},[1349],{"type":401,"value":452},{"type":395,"tag":420,"props":1351,"children":1352},{"style":497},[1353],{"type":401,"value":1236},{"type":395,"tag":420,"props":1355,"children":1356},{"style":491},[1357],{"type":401,"value":906},{"type":395,"tag":420,"props":1359,"children":1360},{"style":982},[1361],{"type":401,"value":1362},"===",{"type":395,"tag":420,"props":1364,"children":1365},{"style":497},[1366],{"type":401,"value":734},{"type":395,"tag":420,"props":1368,"children":1369},{"style":491},[1370],{"type":401,"value":906},{"type":395,"tag":420,"props":1372,"children":1373},{"style":449},[1374],{"type":401,"value":528},{"type":395,"tag":420,"props":1376,"children":1377},{"class":422,"line":583},[1378,1382,1386,1390,1394,1399,1403,1407],{"type":395,"tag":420,"props":1379,"children":1380},{"style":443},[1381],{"type":401,"value":589},{"type":395,"tag":420,"props":1383,"children":1384},{"style":491},[1385],{"type":401,"value":452},{"type":395,"tag":420,"props":1387,"children":1388},{"style":497},[1389],{"type":401,"value":1236},{"type":395,"tag":420,"props":1391,"children":1392},{"style":449},[1393],{"type":401,"value":463},{"type":395,"tag":420,"props":1395,"children":1396},{"style":497},[1397],{"type":401,"value":1398}," options",{"type":395,"tag":420,"props":1400,"children":1401},{"style":449},[1402],{"type":401,"value":463},{"type":395,"tag":420,"props":1404,"children":1405},{"style":497},[1406],{"type":401,"value":468},{"type":395,"tag":420,"props":1408,"children":1409},{"style":491},[1410],{"type":401,"value":612},{"type":395,"tag":420,"props":1412,"children":1413},{"class":422,"line":615},[1414],{"type":395,"tag":420,"props":1415,"children":1416},{"style":449},[1417],{"type":401,"value":1418},"    }\n",{"type":395,"tag":420,"props":1420,"children":1421},{"class":422,"line":628},[1422,1427],{"type":395,"tag":420,"props":1423,"children":1424},{"style":449},[1425],{"type":401,"value":1426},"  }",{"type":395,"tag":420,"props":1428,"children":1429},{"style":491},[1430],{"type":401,"value":612},{"type":395,"tag":420,"props":1432,"children":1433},{"class":422,"line":637},[1434],{"type":395,"tag":420,"props":1435,"children":1436},{"style":449},[1437],{"type":401,"value":1144},{"type":395,"tag":403,"props":1439,"children":1440},{},[1441],{"type":401,"value":1442},"如果目录中带有符号链接，node-watch 会默认跟踪下去，同时使用一个默认的 maxSymbolLevel 数字配置项，设置最大跟踪层数，防止死循环或性能问题。",{"type":395,"tag":409,"props":1444,"children":1446},{"className":411,"code":1445,"language":413,"meta":388,"style":388},"function watch(fpath, options, cb) {\n  if (is.symbolic(fpath) \n    && !(options.followSymLinks \n      && options.maxSymLevel--)) {\n    return\n  }\n}\n",[1447],{"type":395,"tag":416,"props":1448,"children":1449},{"__ignoreMap":388},[1450,1493,1530,1565,1599,1606,1613],{"type":395,"tag":420,"props":1451,"children":1452},{"class":422,"line":423},[1453,1457,1461,1465,1469,1473,1477,1481,1485,1489],{"type":395,"tag":420,"props":1454,"children":1455},{"style":437},[1456],{"type":401,"value":440},{"type":395,"tag":420,"props":1458,"children":1459},{"style":443},[1460],{"type":401,"value":446},{"type":395,"tag":420,"props":1462,"children":1463},{"style":449},[1464],{"type":401,"value":452},{"type":395,"tag":420,"props":1466,"children":1467},{"style":455},[1468],{"type":401,"value":1236},{"type":395,"tag":420,"props":1470,"children":1471},{"style":449},[1472],{"type":401,"value":463},{"type":395,"tag":420,"props":1474,"children":1475},{"style":455},[1476],{"type":401,"value":1398},{"type":395,"tag":420,"props":1478,"children":1479},{"style":449},[1480],{"type":401,"value":463},{"type":395,"tag":420,"props":1482,"children":1483},{"style":455},[1484],{"type":401,"value":468},{"type":395,"tag":420,"props":1486,"children":1487},{"style":449},[1488],{"type":401,"value":473},{"type":395,"tag":420,"props":1490,"children":1491},{"style":449},[1492],{"type":401,"value":478},{"type":395,"tag":420,"props":1494,"children":1495},{"class":422,"line":433},[1496,1500,1504,1508,1512,1517,1521,1525],{"type":395,"tag":420,"props":1497,"children":1498},{"style":485},[1499],{"type":401,"value":488},{"type":395,"tag":420,"props":1501,"children":1502},{"style":491},[1503],{"type":401,"value":494},{"type":395,"tag":420,"props":1505,"children":1506},{"style":497},[1507],{"type":401,"value":500},{"type":395,"tag":420,"props":1509,"children":1510},{"style":449},[1511],{"type":401,"value":505},{"type":395,"tag":420,"props":1513,"children":1514},{"style":443},[1515],{"type":401,"value":1516},"symbolic",{"type":395,"tag":420,"props":1518,"children":1519},{"style":491},[1520],{"type":401,"value":452},{"type":395,"tag":420,"props":1522,"children":1523},{"style":497},[1524],{"type":401,"value":1236},{"type":395,"tag":420,"props":1526,"children":1527},{"style":491},[1528],{"type":401,"value":1529},") \n",{"type":395,"tag":420,"props":1531,"children":1532},{"class":422,"line":481},[1533,1538,1543,1547,1552,1556,1561],{"type":395,"tag":420,"props":1534,"children":1535},{"style":982},[1536],{"type":401,"value":1537},"    &&",{"type":395,"tag":420,"props":1539,"children":1540},{"style":982},[1541],{"type":401,"value":1542}," !",{"type":395,"tag":420,"props":1544,"children":1545},{"style":491},[1546],{"type":401,"value":452},{"type":395,"tag":420,"props":1548,"children":1549},{"style":497},[1550],{"type":401,"value":1551},"options",{"type":395,"tag":420,"props":1553,"children":1554},{"style":449},[1555],{"type":401,"value":505},{"type":395,"tag":420,"props":1557,"children":1558},{"style":497},[1559],{"type":401,"value":1560},"followSymLinks",{"type":395,"tag":420,"props":1562,"children":1563},{"style":491},[1564],{"type":401,"value":965},{"type":395,"tag":420,"props":1566,"children":1567},{"class":422,"line":531},[1568,1573,1577,1581,1586,1591,1595],{"type":395,"tag":420,"props":1569,"children":1570},{"style":982},[1571],{"type":401,"value":1572},"      &&",{"type":395,"tag":420,"props":1574,"children":1575},{"style":497},[1576],{"type":401,"value":1398},{"type":395,"tag":420,"props":1578,"children":1579},{"style":449},[1580],{"type":401,"value":505},{"type":395,"tag":420,"props":1582,"children":1583},{"style":497},[1584],{"type":401,"value":1585},"maxSymLevel",{"type":395,"tag":420,"props":1587,"children":1588},{"style":982},[1589],{"type":401,"value":1590},"--",{"type":395,"tag":420,"props":1592,"children":1593},{"style":491},[1594],{"type":401,"value":523},{"type":395,"tag":420,"props":1596,"children":1597},{"style":449},[1598],{"type":401,"value":528},{"type":395,"tag":420,"props":1600,"children":1601},{"class":422,"line":583},[1602],{"type":395,"tag":420,"props":1603,"children":1604},{"style":485},[1605],{"type":401,"value":634},{"type":395,"tag":420,"props":1607,"children":1608},{"class":422,"line":615},[1609],{"type":395,"tag":420,"props":1610,"children":1611},{"style":449},[1612],{"type":401,"value":643},{"type":395,"tag":420,"props":1614,"children":1615},{"class":422,"line":628},[1616],{"type":395,"tag":420,"props":1617,"children":1618},{"style":449},[1619],{"type":401,"value":1144},{"type":395,"tag":403,"props":1621,"children":1622},{},[1623],{"type":401,"value":1624},"NodeJS 文档提到，fs.watch 的 recursive 选项在 Linux 中是无效的，因为 fs.watch 的实现依赖具体操作系统底层 API。所以到底要不要用原生的 recursive 选项需要提前判断一下，node-watch 的实现挺粗暴，直接使用 IO 操作去检测：先到系统临时文件目录创建一些文件夹，然后监听它们并删除里面的内容，如果超时了还没有触发 watcher 的 change 事件，那就说明不是原生支持 recursive 选项。",{"type":395,"tag":409,"props":1626,"children":1628},{"className":411,"code":1627,"language":413,"meta":388,"style":388},"var IS_SUPPORT\n\ntry {\n  watcher = fs.watch(parent, options)\n} catch (e) {\n  if (e.code == 'ERR_FEATURE_UNAVAILABLE_ON_PLATFORM') {\n    return fn(IS_SUPPORT = false)\n  } else {\n    throw e\n  }\n}\n\nvar timer = setTimeout(function() {\n  watcher.close()\n  stack.cleanup(function() {\n    fn(IS_SUPPORT = false)\n  })\n}, 200)\n\nwatcher.on('change', function(evt, name) {\n  if (path.basename(file) === path.basename(name)) {\n    watcher.close()\n    clearTimeout(timer)\n    stack.cleanup(function() {\n      fn(IS_SUPPORT = true)\n    })\n  }\n})\n",[1629],{"type":395,"tag":416,"props":1630,"children":1631},{"__ignoreMap":388},[1632,1646,1654,1666,1711,1733,1783,1819,1835,1848,1855,1862,1869,1908,1929,1962,1990,2001,2019,2026,2093,2161,2181,2202,2234,2263,2275,2283],{"type":395,"tag":420,"props":1633,"children":1634},{"class":422,"line":423},[1635,1640],{"type":395,"tag":420,"props":1636,"children":1637},{"style":437},[1638],{"type":401,"value":1639},"var",{"type":395,"tag":420,"props":1641,"children":1643},{"style":1642},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[1644],{"type":401,"value":1645}," IS_SUPPORT\n",{"type":395,"tag":420,"props":1647,"children":1648},{"class":422,"line":433},[1649],{"type":395,"tag":420,"props":1650,"children":1651},{"emptyLinePlaceholder":387},[1652],{"type":401,"value":1653},"\n",{"type":395,"tag":420,"props":1655,"children":1656},{"class":422,"line":481},[1657,1662],{"type":395,"tag":420,"props":1658,"children":1659},{"style":485},[1660],{"type":401,"value":1661},"try",{"type":395,"tag":420,"props":1663,"children":1664},{"style":449},[1665],{"type":401,"value":478},{"type":395,"tag":420,"props":1667,"children":1668},{"class":422,"line":531},[1669,1674,1678,1683,1687,1691,1695,1699,1703,1707],{"type":395,"tag":420,"props":1670,"children":1671},{"style":497},[1672],{"type":401,"value":1673},"  watcher",{"type":395,"tag":420,"props":1675,"children":1676},{"style":982},[1677],{"type":401,"value":985},{"type":395,"tag":420,"props":1679,"children":1680},{"style":497},[1681],{"type":401,"value":1682}," fs",{"type":395,"tag":420,"props":1684,"children":1685},{"style":449},[1686],{"type":401,"value":505},{"type":395,"tag":420,"props":1688,"children":1689},{"style":443},[1690],{"type":401,"value":701},{"type":395,"tag":420,"props":1692,"children":1693},{"style":491},[1694],{"type":401,"value":452},{"type":395,"tag":420,"props":1696,"children":1697},{"style":497},[1698],{"type":401,"value":1286},{"type":395,"tag":420,"props":1700,"children":1701},{"style":449},[1702],{"type":401,"value":463},{"type":395,"tag":420,"props":1704,"children":1705},{"style":497},[1706],{"type":401,"value":1398},{"type":395,"tag":420,"props":1708,"children":1709},{"style":491},[1710],{"type":401,"value":612},{"type":395,"tag":420,"props":1712,"children":1713},{"class":422,"line":583},[1714,1719,1724,1729],{"type":395,"tag":420,"props":1715,"children":1716},{"style":449},[1717],{"type":401,"value":1718},"}",{"type":395,"tag":420,"props":1720,"children":1721},{"style":485},[1722],{"type":401,"value":1723}," catch",{"type":395,"tag":420,"props":1725,"children":1726},{"style":497},[1727],{"type":401,"value":1728}," (e) ",{"type":395,"tag":420,"props":1730,"children":1731},{"style":449},[1732],{"type":401,"value":528},{"type":395,"tag":420,"props":1734,"children":1735},{"class":422,"line":615},[1736,1740,1744,1749,1753,1757,1762,1766,1771,1775,1779],{"type":395,"tag":420,"props":1737,"children":1738},{"style":485},[1739],{"type":401,"value":488},{"type":395,"tag":420,"props":1741,"children":1742},{"style":491},[1743],{"type":401,"value":494},{"type":395,"tag":420,"props":1745,"children":1746},{"style":497},[1747],{"type":401,"value":1748},"e",{"type":395,"tag":420,"props":1750,"children":1751},{"style":449},[1752],{"type":401,"value":505},{"type":395,"tag":420,"props":1754,"children":1755},{"style":497},[1756],{"type":401,"value":416},{"type":395,"tag":420,"props":1758,"children":1759},{"style":982},[1760],{"type":401,"value":1761}," ==",{"type":395,"tag":420,"props":1763,"children":1764},{"style":1243},[1765],{"type":401,"value":1246},{"type":395,"tag":420,"props":1767,"children":1768},{"style":1249},[1769],{"type":401,"value":1770},"ERR_FEATURE_UNAVAILABLE_ON_PLATFORM",{"type":395,"tag":420,"props":1772,"children":1773},{"style":1243},[1774],{"type":401,"value":1257},{"type":395,"tag":420,"props":1776,"children":1777},{"style":491},[1778],{"type":401,"value":906},{"type":395,"tag":420,"props":1780,"children":1781},{"style":449},[1782],{"type":401,"value":528},{"type":395,"tag":420,"props":1784,"children":1785},{"class":422,"line":628},[1786,1791,1796,1800,1805,1809,1815],{"type":395,"tag":420,"props":1787,"children":1788},{"style":485},[1789],{"type":401,"value":1790},"    return",{"type":395,"tag":420,"props":1792,"children":1793},{"style":443},[1794],{"type":401,"value":1795}," fn",{"type":395,"tag":420,"props":1797,"children":1798},{"style":491},[1799],{"type":401,"value":452},{"type":395,"tag":420,"props":1801,"children":1802},{"style":1642},[1803],{"type":401,"value":1804},"IS_SUPPORT",{"type":395,"tag":420,"props":1806,"children":1807},{"style":982},[1808],{"type":401,"value":985},{"type":395,"tag":420,"props":1810,"children":1812},{"style":1811},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1813],{"type":401,"value":1814}," false",{"type":395,"tag":420,"props":1816,"children":1817},{"style":491},[1818],{"type":401,"value":612},{"type":395,"tag":420,"props":1820,"children":1821},{"class":422,"line":637},[1822,1826,1831],{"type":395,"tag":420,"props":1823,"children":1824},{"style":449},[1825],{"type":401,"value":1426},{"type":395,"tag":420,"props":1827,"children":1828},{"style":485},[1829],{"type":401,"value":1830}," else",{"type":395,"tag":420,"props":1832,"children":1833},{"style":449},[1834],{"type":401,"value":478},{"type":395,"tag":420,"props":1836,"children":1837},{"class":422,"line":646},[1838,1843],{"type":395,"tag":420,"props":1839,"children":1840},{"style":485},[1841],{"type":401,"value":1842},"    throw",{"type":395,"tag":420,"props":1844,"children":1845},{"style":497},[1846],{"type":401,"value":1847}," e\n",{"type":395,"tag":420,"props":1849,"children":1850},{"class":422,"line":687},[1851],{"type":395,"tag":420,"props":1852,"children":1853},{"style":449},[1854],{"type":401,"value":643},{"type":395,"tag":420,"props":1856,"children":1857},{"class":422,"line":745},[1858],{"type":395,"tag":420,"props":1859,"children":1860},{"style":449},[1861],{"type":401,"value":1144},{"type":395,"tag":420,"props":1863,"children":1864},{"class":422,"line":770},[1865],{"type":395,"tag":420,"props":1866,"children":1867},{"emptyLinePlaceholder":387},[1868],{"type":401,"value":1653},{"type":395,"tag":420,"props":1870,"children":1871},{"class":422,"line":808},[1872,1876,1881,1886,1891,1895,1899,1904],{"type":395,"tag":420,"props":1873,"children":1874},{"style":437},[1875],{"type":401,"value":1639},{"type":395,"tag":420,"props":1877,"children":1878},{"style":497},[1879],{"type":401,"value":1880}," timer ",{"type":395,"tag":420,"props":1882,"children":1883},{"style":982},[1884],{"type":401,"value":1885},"=",{"type":395,"tag":420,"props":1887,"children":1888},{"style":443},[1889],{"type":401,"value":1890}," setTimeout",{"type":395,"tag":420,"props":1892,"children":1893},{"style":497},[1894],{"type":401,"value":452},{"type":395,"tag":420,"props":1896,"children":1897},{"style":437},[1898],{"type":401,"value":440},{"type":395,"tag":420,"props":1900,"children":1901},{"style":449},[1902],{"type":401,"value":1903},"()",{"type":395,"tag":420,"props":1905,"children":1906},{"style":449},[1907],{"type":401,"value":478},{"type":395,"tag":420,"props":1909,"children":1910},{"class":422,"line":817},[1911,1915,1919,1924],{"type":395,"tag":420,"props":1912,"children":1913},{"style":497},[1914],{"type":401,"value":1673},{"type":395,"tag":420,"props":1916,"children":1917},{"style":449},[1918],{"type":401,"value":505},{"type":395,"tag":420,"props":1920,"children":1921},{"style":443},[1922],{"type":401,"value":1923},"close",{"type":395,"tag":420,"props":1925,"children":1926},{"style":491},[1927],{"type":401,"value":1928},"()\n",{"type":395,"tag":420,"props":1930,"children":1931},{"class":422,"line":829},[1932,1937,1941,1946,1950,1954,1958],{"type":395,"tag":420,"props":1933,"children":1934},{"style":497},[1935],{"type":401,"value":1936},"  stack",{"type":395,"tag":420,"props":1938,"children":1939},{"style":449},[1940],{"type":401,"value":505},{"type":395,"tag":420,"props":1942,"children":1943},{"style":443},[1944],{"type":401,"value":1945},"cleanup",{"type":395,"tag":420,"props":1947,"children":1948},{"style":491},[1949],{"type":401,"value":452},{"type":395,"tag":420,"props":1951,"children":1952},{"style":437},[1953],{"type":401,"value":440},{"type":395,"tag":420,"props":1955,"children":1956},{"style":449},[1957],{"type":401,"value":1903},{"type":395,"tag":420,"props":1959,"children":1960},{"style":449},[1961],{"type":401,"value":478},{"type":395,"tag":420,"props":1963,"children":1964},{"class":422,"line":887},[1965,1970,1974,1978,1982,1986],{"type":395,"tag":420,"props":1966,"children":1967},{"style":443},[1968],{"type":401,"value":1969},"    fn",{"type":395,"tag":420,"props":1971,"children":1972},{"style":491},[1973],{"type":401,"value":452},{"type":395,"tag":420,"props":1975,"children":1976},{"style":1642},[1977],{"type":401,"value":1804},{"type":395,"tag":420,"props":1979,"children":1980},{"style":982},[1981],{"type":401,"value":985},{"type":395,"tag":420,"props":1983,"children":1984},{"style":1811},[1985],{"type":401,"value":1814},{"type":395,"tag":420,"props":1987,"children":1988},{"style":491},[1989],{"type":401,"value":612},{"type":395,"tag":420,"props":1991,"children":1992},{"class":422,"line":919},[1993,1997],{"type":395,"tag":420,"props":1994,"children":1995},{"style":449},[1996],{"type":401,"value":1426},{"type":395,"tag":420,"props":1998,"children":1999},{"style":491},[2000],{"type":401,"value":612},{"type":395,"tag":420,"props":2002,"children":2003},{"class":422,"line":968},[2004,2009,2015],{"type":395,"tag":420,"props":2005,"children":2006},{"style":449},[2007],{"type":401,"value":2008},"},",{"type":395,"tag":420,"props":2010,"children":2012},{"style":2011},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2013],{"type":401,"value":2014}," 200",{"type":395,"tag":420,"props":2016,"children":2017},{"style":497},[2018],{"type":401,"value":612},{"type":395,"tag":420,"props":2020,"children":2021},{"class":422,"line":1022},[2022],{"type":395,"tag":420,"props":2023,"children":2024},{"emptyLinePlaceholder":387},[2025],{"type":401,"value":1653},{"type":395,"tag":420,"props":2027,"children":2028},{"class":422,"line":1066},[2029,2034,2038,2043,2047,2051,2056,2060,2064,2068,2072,2076,2080,2085,2089],{"type":395,"tag":420,"props":2030,"children":2031},{"style":497},[2032],{"type":401,"value":2033},"watcher",{"type":395,"tag":420,"props":2035,"children":2036},{"style":449},[2037],{"type":401,"value":505},{"type":395,"tag":420,"props":2039,"children":2040},{"style":443},[2041],{"type":401,"value":2042},"on",{"type":395,"tag":420,"props":2044,"children":2045},{"style":497},[2046],{"type":401,"value":452},{"type":395,"tag":420,"props":2048,"children":2049},{"style":1243},[2050],{"type":401,"value":1257},{"type":395,"tag":420,"props":2052,"children":2053},{"style":1249},[2054],{"type":401,"value":2055},"change",{"type":395,"tag":420,"props":2057,"children":2058},{"style":1243},[2059],{"type":401,"value":1257},{"type":395,"tag":420,"props":2061,"children":2062},{"style":449},[2063],{"type":401,"value":463},{"type":395,"tag":420,"props":2065,"children":2066},{"style":437},[2067],{"type":401,"value":563},{"type":395,"tag":420,"props":2069,"children":2070},{"style":449},[2071],{"type":401,"value":452},{"type":395,"tag":420,"props":2073,"children":2074},{"style":455},[2075],{"type":401,"value":1303},{"type":395,"tag":420,"props":2077,"children":2078},{"style":449},[2079],{"type":401,"value":463},{"type":395,"tag":420,"props":2081,"children":2082},{"style":455},[2083],{"type":401,"value":2084}," name",{"type":395,"tag":420,"props":2086,"children":2087},{"style":449},[2088],{"type":401,"value":473},{"type":395,"tag":420,"props":2090,"children":2091},{"style":449},[2092],{"type":401,"value":478},{"type":395,"tag":420,"props":2094,"children":2095},{"class":422,"line":1095},[2096,2100,2104,2108,2112,2116,2120,2124,2128,2132,2136,2140,2144,2148,2153,2157],{"type":395,"tag":420,"props":2097,"children":2098},{"style":485},[2099],{"type":401,"value":488},{"type":395,"tag":420,"props":2101,"children":2102},{"style":491},[2103],{"type":401,"value":494},{"type":395,"tag":420,"props":2105,"children":2106},{"style":497},[2107],{"type":401,"value":1336},{"type":395,"tag":420,"props":2109,"children":2110},{"style":449},[2111],{"type":401,"value":505},{"type":395,"tag":420,"props":2113,"children":2114},{"style":443},[2115],{"type":401,"value":1345},{"type":395,"tag":420,"props":2117,"children":2118},{"style":491},[2119],{"type":401,"value":452},{"type":395,"tag":420,"props":2121,"children":2122},{"style":497},[2123],{"type":401,"value":1054},{"type":395,"tag":420,"props":2125,"children":2126},{"style":491},[2127],{"type":401,"value":906},{"type":395,"tag":420,"props":2129,"children":2130},{"style":982},[2131],{"type":401,"value":1362},{"type":395,"tag":420,"props":2133,"children":2134},{"style":497},[2135],{"type":401,"value":990},{"type":395,"tag":420,"props":2137,"children":2138},{"style":449},[2139],{"type":401,"value":505},{"type":395,"tag":420,"props":2141,"children":2142},{"style":443},[2143],{"type":401,"value":1345},{"type":395,"tag":420,"props":2145,"children":2146},{"style":491},[2147],{"type":401,"value":452},{"type":395,"tag":420,"props":2149,"children":2150},{"style":497},[2151],{"type":401,"value":2152},"name",{"type":395,"tag":420,"props":2154,"children":2155},{"style":491},[2156],{"type":401,"value":523},{"type":395,"tag":420,"props":2158,"children":2159},{"style":449},[2160],{"type":401,"value":528},{"type":395,"tag":420,"props":2162,"children":2163},{"class":422,"line":1104},[2164,2169,2173,2177],{"type":395,"tag":420,"props":2165,"children":2166},{"style":497},[2167],{"type":401,"value":2168},"    watcher",{"type":395,"tag":420,"props":2170,"children":2171},{"style":449},[2172],{"type":401,"value":505},{"type":395,"tag":420,"props":2174,"children":2175},{"style":443},[2176],{"type":401,"value":1923},{"type":395,"tag":420,"props":2178,"children":2179},{"style":491},[2180],{"type":401,"value":1928},{"type":395,"tag":420,"props":2182,"children":2183},{"class":422,"line":1117},[2184,2189,2193,2198],{"type":395,"tag":420,"props":2185,"children":2186},{"style":443},[2187],{"type":401,"value":2188},"    clearTimeout",{"type":395,"tag":420,"props":2190,"children":2191},{"style":491},[2192],{"type":401,"value":452},{"type":395,"tag":420,"props":2194,"children":2195},{"style":497},[2196],{"type":401,"value":2197},"timer",{"type":395,"tag":420,"props":2199,"children":2200},{"style":491},[2201],{"type":401,"value":612},{"type":395,"tag":420,"props":2203,"children":2204},{"class":422,"line":1130},[2205,2210,2214,2218,2222,2226,2230],{"type":395,"tag":420,"props":2206,"children":2207},{"style":497},[2208],{"type":401,"value":2209},"    stack",{"type":395,"tag":420,"props":2211,"children":2212},{"style":449},[2213],{"type":401,"value":505},{"type":395,"tag":420,"props":2215,"children":2216},{"style":443},[2217],{"type":401,"value":1945},{"type":395,"tag":420,"props":2219,"children":2220},{"style":491},[2221],{"type":401,"value":452},{"type":395,"tag":420,"props":2223,"children":2224},{"style":437},[2225],{"type":401,"value":440},{"type":395,"tag":420,"props":2227,"children":2228},{"style":449},[2229],{"type":401,"value":1903},{"type":395,"tag":420,"props":2231,"children":2232},{"style":449},[2233],{"type":401,"value":478},{"type":395,"tag":420,"props":2235,"children":2236},{"class":422,"line":1138},[2237,2242,2246,2250,2254,2259],{"type":395,"tag":420,"props":2238,"children":2239},{"style":443},[2240],{"type":401,"value":2241},"      fn",{"type":395,"tag":420,"props":2243,"children":2244},{"style":491},[2245],{"type":401,"value":452},{"type":395,"tag":420,"props":2247,"children":2248},{"style":1642},[2249],{"type":401,"value":1804},{"type":395,"tag":420,"props":2251,"children":2252},{"style":982},[2253],{"type":401,"value":985},{"type":395,"tag":420,"props":2255,"children":2256},{"style":1811},[2257],{"type":401,"value":2258}," true",{"type":395,"tag":420,"props":2260,"children":2261},{"style":491},[2262],{"type":401,"value":612},{"type":395,"tag":420,"props":2264,"children":2266},{"class":422,"line":2265},26,[2267,2271],{"type":395,"tag":420,"props":2268,"children":2269},{"style":449},[2270],{"type":401,"value":621},{"type":395,"tag":420,"props":2272,"children":2273},{"style":491},[2274],{"type":401,"value":612},{"type":395,"tag":420,"props":2276,"children":2278},{"class":422,"line":2277},27,[2279],{"type":395,"tag":420,"props":2280,"children":2281},{"style":449},[2282],{"type":401,"value":643},{"type":395,"tag":420,"props":2284,"children":2286},{"class":422,"line":2285},28,[2287,2291],{"type":395,"tag":420,"props":2288,"children":2289},{"style":449},[2290],{"type":401,"value":1718},{"type":395,"tag":420,"props":2292,"children":2293},{"style":497},[2294],{"type":401,"value":612},{"type":395,"tag":403,"props":2296,"children":2297},{},[2298],{"type":401,"value":2299},"Watcher 仅向外暴露指定方法。",{"type":395,"tag":409,"props":2301,"children":2303},{"className":411,"code":2302,"language":413,"meta":388,"style":388},"Watcher.prototype.expose = function() {\n  var expose = {}\n  var self = this\n  var methods = [\n    'on', 'emit', 'once',\n    'close', 'isClosed',\n    'listeners', 'setMaxListeners', 'getMaxListeners',\n    'getWatchedPaths'\n  ]\n  methods.forEach(function(name) {\n    expose[name] = function() {\n      return self[name].apply(self, arguments)\n    }\n  })\n  return expose\n}\n",[2304],{"type":395,"tag":416,"props":2305,"children":2306},{"__ignoreMap":388},[2307,2350,2371,2393,2414,2469,2505,2559,2576,2584,2624,2662,2719,2726,2737,2750],{"type":395,"tag":420,"props":2308,"children":2309},{"class":422,"line":423},[2310,2316,2320,2325,2329,2334,2338,2342,2346],{"type":395,"tag":420,"props":2311,"children":2313},{"style":2312},"--shiki-light:#E2931D;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-light-font-style:inherit;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[2314],{"type":401,"value":2315},"Watcher",{"type":395,"tag":420,"props":2317,"children":2318},{"style":449},[2319],{"type":401,"value":505},{"type":395,"tag":420,"props":2321,"children":2322},{"style":1642},[2323],{"type":401,"value":2324},"prototype",{"type":395,"tag":420,"props":2326,"children":2327},{"style":449},[2328],{"type":401,"value":505},{"type":395,"tag":420,"props":2330,"children":2331},{"style":443},[2332],{"type":401,"value":2333},"expose",{"type":395,"tag":420,"props":2335,"children":2336},{"style":982},[2337],{"type":401,"value":985},{"type":395,"tag":420,"props":2339,"children":2340},{"style":437},[2341],{"type":401,"value":563},{"type":395,"tag":420,"props":2343,"children":2344},{"style":449},[2345],{"type":401,"value":1903},{"type":395,"tag":420,"props":2347,"children":2348},{"style":449},[2349],{"type":401,"value":478},{"type":395,"tag":420,"props":2351,"children":2352},{"class":422,"line":433},[2353,2357,2362,2366],{"type":395,"tag":420,"props":2354,"children":2355},{"style":437},[2356],{"type":401,"value":1205},{"type":395,"tag":420,"props":2358,"children":2359},{"style":497},[2360],{"type":401,"value":2361}," expose",{"type":395,"tag":420,"props":2363,"children":2364},{"style":982},[2365],{"type":401,"value":985},{"type":395,"tag":420,"props":2367,"children":2368},{"style":449},[2369],{"type":401,"value":2370}," {}\n",{"type":395,"tag":420,"props":2372,"children":2373},{"class":422,"line":481},[2374,2378,2383,2387],{"type":395,"tag":420,"props":2375,"children":2376},{"style":437},[2377],{"type":401,"value":1205},{"type":395,"tag":420,"props":2379,"children":2380},{"style":497},[2381],{"type":401,"value":2382}," self",{"type":395,"tag":420,"props":2384,"children":2385},{"style":982},[2386],{"type":401,"value":985},{"type":395,"tag":420,"props":2388,"children":2390},{"style":2389},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[2391],{"type":401,"value":2392}," this\n",{"type":395,"tag":420,"props":2394,"children":2395},{"class":422,"line":531},[2396,2400,2405,2409],{"type":395,"tag":420,"props":2397,"children":2398},{"style":437},[2399],{"type":401,"value":1205},{"type":395,"tag":420,"props":2401,"children":2402},{"style":497},[2403],{"type":401,"value":2404}," methods",{"type":395,"tag":420,"props":2406,"children":2407},{"style":982},[2408],{"type":401,"value":985},{"type":395,"tag":420,"props":2410,"children":2411},{"style":491},[2412],{"type":401,"value":2413}," [\n",{"type":395,"tag":420,"props":2415,"children":2416},{"class":422,"line":583},[2417,2422,2426,2430,2434,2438,2443,2447,2451,2455,2460,2464],{"type":395,"tag":420,"props":2418,"children":2419},{"style":1243},[2420],{"type":401,"value":2421},"    '",{"type":395,"tag":420,"props":2423,"children":2424},{"style":1249},[2425],{"type":401,"value":2042},{"type":395,"tag":420,"props":2427,"children":2428},{"style":1243},[2429],{"type":401,"value":1257},{"type":395,"tag":420,"props":2431,"children":2432},{"style":449},[2433],{"type":401,"value":463},{"type":395,"tag":420,"props":2435,"children":2436},{"style":1243},[2437],{"type":401,"value":1246},{"type":395,"tag":420,"props":2439,"children":2440},{"style":1249},[2441],{"type":401,"value":2442},"emit",{"type":395,"tag":420,"props":2444,"children":2445},{"style":1243},[2446],{"type":401,"value":1257},{"type":395,"tag":420,"props":2448,"children":2449},{"style":449},[2450],{"type":401,"value":463},{"type":395,"tag":420,"props":2452,"children":2453},{"style":1243},[2454],{"type":401,"value":1246},{"type":395,"tag":420,"props":2456,"children":2457},{"style":1249},[2458],{"type":401,"value":2459},"once",{"type":395,"tag":420,"props":2461,"children":2462},{"style":1243},[2463],{"type":401,"value":1257},{"type":395,"tag":420,"props":2465,"children":2466},{"style":449},[2467],{"type":401,"value":2468},",\n",{"type":395,"tag":420,"props":2470,"children":2471},{"class":422,"line":615},[2472,2476,2480,2484,2488,2492,2497,2501],{"type":395,"tag":420,"props":2473,"children":2474},{"style":1243},[2475],{"type":401,"value":2421},{"type":395,"tag":420,"props":2477,"children":2478},{"style":1249},[2479],{"type":401,"value":1923},{"type":395,"tag":420,"props":2481,"children":2482},{"style":1243},[2483],{"type":401,"value":1257},{"type":395,"tag":420,"props":2485,"children":2486},{"style":449},[2487],{"type":401,"value":463},{"type":395,"tag":420,"props":2489,"children":2490},{"style":1243},[2491],{"type":401,"value":1246},{"type":395,"tag":420,"props":2493,"children":2494},{"style":1249},[2495],{"type":401,"value":2496},"isClosed",{"type":395,"tag":420,"props":2498,"children":2499},{"style":1243},[2500],{"type":401,"value":1257},{"type":395,"tag":420,"props":2502,"children":2503},{"style":449},[2504],{"type":401,"value":2468},{"type":395,"tag":420,"props":2506,"children":2507},{"class":422,"line":628},[2508,2512,2517,2521,2525,2529,2534,2538,2542,2546,2551,2555],{"type":395,"tag":420,"props":2509,"children":2510},{"style":1243},[2511],{"type":401,"value":2421},{"type":395,"tag":420,"props":2513,"children":2514},{"style":1249},[2515],{"type":401,"value":2516},"listeners",{"type":395,"tag":420,"props":2518,"children":2519},{"style":1243},[2520],{"type":401,"value":1257},{"type":395,"tag":420,"props":2522,"children":2523},{"style":449},[2524],{"type":401,"value":463},{"type":395,"tag":420,"props":2526,"children":2527},{"style":1243},[2528],{"type":401,"value":1246},{"type":395,"tag":420,"props":2530,"children":2531},{"style":1249},[2532],{"type":401,"value":2533},"setMaxListeners",{"type":395,"tag":420,"props":2535,"children":2536},{"style":1243},[2537],{"type":401,"value":1257},{"type":395,"tag":420,"props":2539,"children":2540},{"style":449},[2541],{"type":401,"value":463},{"type":395,"tag":420,"props":2543,"children":2544},{"style":1243},[2545],{"type":401,"value":1246},{"type":395,"tag":420,"props":2547,"children":2548},{"style":1249},[2549],{"type":401,"value":2550},"getMaxListeners",{"type":395,"tag":420,"props":2552,"children":2553},{"style":1243},[2554],{"type":401,"value":1257},{"type":395,"tag":420,"props":2556,"children":2557},{"style":449},[2558],{"type":401,"value":2468},{"type":395,"tag":420,"props":2560,"children":2561},{"class":422,"line":637},[2562,2566,2571],{"type":395,"tag":420,"props":2563,"children":2564},{"style":1243},[2565],{"type":401,"value":2421},{"type":395,"tag":420,"props":2567,"children":2568},{"style":1249},[2569],{"type":401,"value":2570},"getWatchedPaths",{"type":395,"tag":420,"props":2572,"children":2573},{"style":1243},[2574],{"type":401,"value":2575},"'\n",{"type":395,"tag":420,"props":2577,"children":2578},{"class":422,"line":646},[2579],{"type":395,"tag":420,"props":2580,"children":2581},{"style":491},[2582],{"type":401,"value":2583},"  ]\n",{"type":395,"tag":420,"props":2585,"children":2586},{"class":422,"line":687},[2587,2592,2596,2600,2604,2608,2612,2616,2620],{"type":395,"tag":420,"props":2588,"children":2589},{"style":497},[2590],{"type":401,"value":2591},"  methods",{"type":395,"tag":420,"props":2593,"children":2594},{"style":449},[2595],{"type":401,"value":505},{"type":395,"tag":420,"props":2597,"children":2598},{"style":443},[2599],{"type":401,"value":934},{"type":395,"tag":420,"props":2601,"children":2602},{"style":491},[2603],{"type":401,"value":452},{"type":395,"tag":420,"props":2605,"children":2606},{"style":437},[2607],{"type":401,"value":440},{"type":395,"tag":420,"props":2609,"children":2610},{"style":449},[2611],{"type":401,"value":452},{"type":395,"tag":420,"props":2613,"children":2614},{"style":455},[2615],{"type":401,"value":2152},{"type":395,"tag":420,"props":2617,"children":2618},{"style":449},[2619],{"type":401,"value":473},{"type":395,"tag":420,"props":2621,"children":2622},{"style":449},[2623],{"type":401,"value":478},{"type":395,"tag":420,"props":2625,"children":2626},{"class":422,"line":745},[2627,2632,2637,2641,2646,2650,2654,2658],{"type":395,"tag":420,"props":2628,"children":2629},{"style":497},[2630],{"type":401,"value":2631},"    expose",{"type":395,"tag":420,"props":2633,"children":2634},{"style":491},[2635],{"type":401,"value":2636},"[",{"type":395,"tag":420,"props":2638,"children":2639},{"style":497},[2640],{"type":401,"value":2152},{"type":395,"tag":420,"props":2642,"children":2643},{"style":491},[2644],{"type":401,"value":2645},"] ",{"type":395,"tag":420,"props":2647,"children":2648},{"style":982},[2649],{"type":401,"value":1885},{"type":395,"tag":420,"props":2651,"children":2652},{"style":437},[2653],{"type":401,"value":563},{"type":395,"tag":420,"props":2655,"children":2656},{"style":449},[2657],{"type":401,"value":1903},{"type":395,"tag":420,"props":2659,"children":2660},{"style":449},[2661],{"type":401,"value":478},{"type":395,"tag":420,"props":2663,"children":2664},{"class":422,"line":770},[2665,2670,2674,2678,2682,2687,2691,2696,2700,2705,2709,2715],{"type":395,"tag":420,"props":2666,"children":2667},{"style":485},[2668],{"type":401,"value":2669},"      return",{"type":395,"tag":420,"props":2671,"children":2672},{"style":497},[2673],{"type":401,"value":2382},{"type":395,"tag":420,"props":2675,"children":2676},{"style":491},[2677],{"type":401,"value":2636},{"type":395,"tag":420,"props":2679,"children":2680},{"style":497},[2681],{"type":401,"value":2152},{"type":395,"tag":420,"props":2683,"children":2684},{"style":491},[2685],{"type":401,"value":2686},"]",{"type":395,"tag":420,"props":2688,"children":2689},{"style":449},[2690],{"type":401,"value":505},{"type":395,"tag":420,"props":2692,"children":2693},{"style":443},[2694],{"type":401,"value":2695},"apply",{"type":395,"tag":420,"props":2697,"children":2698},{"style":491},[2699],{"type":401,"value":452},{"type":395,"tag":420,"props":2701,"children":2702},{"style":497},[2703],{"type":401,"value":2704},"self",{"type":395,"tag":420,"props":2706,"children":2707},{"style":449},[2708],{"type":401,"value":463},{"type":395,"tag":420,"props":2710,"children":2712},{"style":2711},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[2713],{"type":401,"value":2714}," arguments",{"type":395,"tag":420,"props":2716,"children":2717},{"style":491},[2718],{"type":401,"value":612},{"type":395,"tag":420,"props":2720,"children":2721},{"class":422,"line":808},[2722],{"type":395,"tag":420,"props":2723,"children":2724},{"style":449},[2725],{"type":401,"value":1418},{"type":395,"tag":420,"props":2727,"children":2728},{"class":422,"line":817},[2729,2733],{"type":395,"tag":420,"props":2730,"children":2731},{"style":449},[2732],{"type":401,"value":1426},{"type":395,"tag":420,"props":2734,"children":2735},{"style":491},[2736],{"type":401,"value":612},{"type":395,"tag":420,"props":2738,"children":2739},{"class":422,"line":829},[2740,2745],{"type":395,"tag":420,"props":2741,"children":2742},{"style":485},[2743],{"type":401,"value":2744},"  return",{"type":395,"tag":420,"props":2746,"children":2747},{"style":497},[2748],{"type":401,"value":2749}," expose\n",{"type":395,"tag":420,"props":2751,"children":2752},{"class":422,"line":887},[2753],{"type":395,"tag":420,"props":2754,"children":2755},{"style":449},[2756],{"type":401,"value":1144},{"type":395,"tag":403,"props":2758,"children":2759},{},[2760],{"type":401,"value":2761},"监听路径支持传数组，我们当然希望就算是数组，也是由同一个 EventEmitter 来管理事件的，传入的是既然是数组，那么自然会生成多个 watcher 实例，只不过代码中使用了 composeWatcher 函数，把这些事件整合并向外发送。",{"type":395,"tag":409,"props":2763,"children":2765},{"className":411,"code":2764,"language":413,"meta":388,"style":388},"function composeWatcher(watchers) {\n  // 使用一个新的 watcher 整合事件列表\n  var watcher = new Watcher()\n  var filterDups = createDupsFilter()\n  var counter = watchers.length\n\n  watchers.forEach(function(w) {\n    w.on('change', filterDups(function(evt, name) {\n      watcher.emit('change', evt, name)\n    }))\n    w.on('error', function(err) {\n      watcher.emit('error', err)\n    })\n    w.on('ready', function() {\n      if (!(--counter)) {\n        emitReady(watcher)\n      }\n    })\n  })\n\n  watcher.close = function() {\n    watchers.forEach(function(w) {\n      w.close()\n    })\n    process.nextTick(emitClose, watcher)\n  }\n\n  watcher.getWatchedPaths = function(fn) {\n    if (is.func(fn)) {\n      var promises = watchers.map(function(w) {\n        return new Promise(function(resolve) {\n          w.getWatchedPaths(resolve)\n        })\n      })\n      Promise.all(promises).then(function(result) {\n        var ret = unique(flat1(result))\n        fn(ret)\n      })\n    }\n  }\n\n  return watcher.expose()\n}\n",[2766],{"type":395,"tag":416,"props":2767,"children":2768},{"__ignoreMap":388},[2769,2798,2806,2836,2861,2891,2898,2939,3011,3064,3076,3132,3176,3187,3235,3272,3292,3300,3311,3322,3329,3360,3400,3420,3431,3469,3476,3483,3523,3564,3619,3661,3690,3703,3715,3780,3823,3845,3857,3865,3873,3881,3905],{"type":395,"tag":420,"props":2770,"children":2771},{"class":422,"line":423},[2772,2776,2781,2785,2790,2794],{"type":395,"tag":420,"props":2773,"children":2774},{"style":437},[2775],{"type":401,"value":440},{"type":395,"tag":420,"props":2777,"children":2778},{"style":443},[2779],{"type":401,"value":2780}," composeWatcher",{"type":395,"tag":420,"props":2782,"children":2783},{"style":449},[2784],{"type":401,"value":452},{"type":395,"tag":420,"props":2786,"children":2787},{"style":455},[2788],{"type":401,"value":2789},"watchers",{"type":395,"tag":420,"props":2791,"children":2792},{"style":449},[2793],{"type":401,"value":473},{"type":395,"tag":420,"props":2795,"children":2796},{"style":449},[2797],{"type":401,"value":478},{"type":395,"tag":420,"props":2799,"children":2800},{"class":422,"line":433},[2801],{"type":395,"tag":420,"props":2802,"children":2803},{"style":427},[2804],{"type":401,"value":2805},"  // 使用一个新的 watcher 整合事件列表\n",{"type":395,"tag":420,"props":2807,"children":2808},{"class":422,"line":481},[2809,2813,2818,2822,2827,2832],{"type":395,"tag":420,"props":2810,"children":2811},{"style":437},[2812],{"type":401,"value":1205},{"type":395,"tag":420,"props":2814,"children":2815},{"style":497},[2816],{"type":401,"value":2817}," watcher",{"type":395,"tag":420,"props":2819,"children":2820},{"style":982},[2821],{"type":401,"value":985},{"type":395,"tag":420,"props":2823,"children":2824},{"style":982},[2825],{"type":401,"value":2826}," new",{"type":395,"tag":420,"props":2828,"children":2829},{"style":443},[2830],{"type":401,"value":2831}," Watcher",{"type":395,"tag":420,"props":2833,"children":2834},{"style":491},[2835],{"type":401,"value":1928},{"type":395,"tag":420,"props":2837,"children":2838},{"class":422,"line":531},[2839,2843,2848,2852,2857],{"type":395,"tag":420,"props":2840,"children":2841},{"style":437},[2842],{"type":401,"value":1205},{"type":395,"tag":420,"props":2844,"children":2845},{"style":497},[2846],{"type":401,"value":2847}," filterDups",{"type":395,"tag":420,"props":2849,"children":2850},{"style":982},[2851],{"type":401,"value":985},{"type":395,"tag":420,"props":2853,"children":2854},{"style":443},[2855],{"type":401,"value":2856}," createDupsFilter",{"type":395,"tag":420,"props":2858,"children":2859},{"style":491},[2860],{"type":401,"value":1928},{"type":395,"tag":420,"props":2862,"children":2863},{"class":422,"line":583},[2864,2868,2873,2877,2882,2886],{"type":395,"tag":420,"props":2865,"children":2866},{"style":437},[2867],{"type":401,"value":1205},{"type":395,"tag":420,"props":2869,"children":2870},{"style":497},[2871],{"type":401,"value":2872}," counter",{"type":395,"tag":420,"props":2874,"children":2875},{"style":982},[2876],{"type":401,"value":985},{"type":395,"tag":420,"props":2878,"children":2879},{"style":497},[2880],{"type":401,"value":2881}," watchers",{"type":395,"tag":420,"props":2883,"children":2884},{"style":449},[2885],{"type":401,"value":505},{"type":395,"tag":420,"props":2887,"children":2888},{"style":1642},[2889],{"type":401,"value":2890},"length\n",{"type":395,"tag":420,"props":2892,"children":2893},{"class":422,"line":615},[2894],{"type":395,"tag":420,"props":2895,"children":2896},{"emptyLinePlaceholder":387},[2897],{"type":401,"value":1653},{"type":395,"tag":420,"props":2899,"children":2900},{"class":422,"line":628},[2901,2906,2910,2914,2918,2922,2926,2931,2935],{"type":395,"tag":420,"props":2902,"children":2903},{"style":497},[2904],{"type":401,"value":2905},"  watchers",{"type":395,"tag":420,"props":2907,"children":2908},{"style":449},[2909],{"type":401,"value":505},{"type":395,"tag":420,"props":2911,"children":2912},{"style":443},[2913],{"type":401,"value":934},{"type":395,"tag":420,"props":2915,"children":2916},{"style":491},[2917],{"type":401,"value":452},{"type":395,"tag":420,"props":2919,"children":2920},{"style":437},[2921],{"type":401,"value":440},{"type":395,"tag":420,"props":2923,"children":2924},{"style":449},[2925],{"type":401,"value":452},{"type":395,"tag":420,"props":2927,"children":2928},{"style":455},[2929],{"type":401,"value":2930},"w",{"type":395,"tag":420,"props":2932,"children":2933},{"style":449},[2934],{"type":401,"value":473},{"type":395,"tag":420,"props":2936,"children":2937},{"style":449},[2938],{"type":401,"value":478},{"type":395,"tag":420,"props":2940,"children":2941},{"class":422,"line":637},[2942,2947,2951,2955,2959,2963,2967,2971,2975,2979,2983,2987,2991,2995,2999,3003,3007],{"type":395,"tag":420,"props":2943,"children":2944},{"style":497},[2945],{"type":401,"value":2946},"    w",{"type":395,"tag":420,"props":2948,"children":2949},{"style":449},[2950],{"type":401,"value":505},{"type":395,"tag":420,"props":2952,"children":2953},{"style":443},[2954],{"type":401,"value":2042},{"type":395,"tag":420,"props":2956,"children":2957},{"style":491},[2958],{"type":401,"value":452},{"type":395,"tag":420,"props":2960,"children":2961},{"style":1243},[2962],{"type":401,"value":1257},{"type":395,"tag":420,"props":2964,"children":2965},{"style":1249},[2966],{"type":401,"value":2055},{"type":395,"tag":420,"props":2968,"children":2969},{"style":1243},[2970],{"type":401,"value":1257},{"type":395,"tag":420,"props":2972,"children":2973},{"style":449},[2974],{"type":401,"value":463},{"type":395,"tag":420,"props":2976,"children":2977},{"style":443},[2978],{"type":401,"value":2847},{"type":395,"tag":420,"props":2980,"children":2981},{"style":491},[2982],{"type":401,"value":452},{"type":395,"tag":420,"props":2984,"children":2985},{"style":437},[2986],{"type":401,"value":440},{"type":395,"tag":420,"props":2988,"children":2989},{"style":449},[2990],{"type":401,"value":452},{"type":395,"tag":420,"props":2992,"children":2993},{"style":455},[2994],{"type":401,"value":1303},{"type":395,"tag":420,"props":2996,"children":2997},{"style":449},[2998],{"type":401,"value":463},{"type":395,"tag":420,"props":3000,"children":3001},{"style":455},[3002],{"type":401,"value":2084},{"type":395,"tag":420,"props":3004,"children":3005},{"style":449},[3006],{"type":401,"value":473},{"type":395,"tag":420,"props":3008,"children":3009},{"style":449},[3010],{"type":401,"value":478},{"type":395,"tag":420,"props":3012,"children":3013},{"class":422,"line":646},[3014,3019,3023,3027,3031,3035,3039,3043,3047,3052,3056,3060],{"type":395,"tag":420,"props":3015,"children":3016},{"style":497},[3017],{"type":401,"value":3018},"      watcher",{"type":395,"tag":420,"props":3020,"children":3021},{"style":449},[3022],{"type":401,"value":505},{"type":395,"tag":420,"props":3024,"children":3025},{"style":443},[3026],{"type":401,"value":2442},{"type":395,"tag":420,"props":3028,"children":3029},{"style":491},[3030],{"type":401,"value":452},{"type":395,"tag":420,"props":3032,"children":3033},{"style":1243},[3034],{"type":401,"value":1257},{"type":395,"tag":420,"props":3036,"children":3037},{"style":1249},[3038],{"type":401,"value":2055},{"type":395,"tag":420,"props":3040,"children":3041},{"style":1243},[3042],{"type":401,"value":1257},{"type":395,"tag":420,"props":3044,"children":3045},{"style":449},[3046],{"type":401,"value":463},{"type":395,"tag":420,"props":3048,"children":3049},{"style":497},[3050],{"type":401,"value":3051}," evt",{"type":395,"tag":420,"props":3053,"children":3054},{"style":449},[3055],{"type":401,"value":463},{"type":395,"tag":420,"props":3057,"children":3058},{"style":497},[3059],{"type":401,"value":2084},{"type":395,"tag":420,"props":3061,"children":3062},{"style":491},[3063],{"type":401,"value":612},{"type":395,"tag":420,"props":3065,"children":3066},{"class":422,"line":687},[3067,3071],{"type":395,"tag":420,"props":3068,"children":3069},{"style":449},[3070],{"type":401,"value":621},{"type":395,"tag":420,"props":3072,"children":3073},{"style":491},[3074],{"type":401,"value":3075},"))\n",{"type":395,"tag":420,"props":3077,"children":3078},{"class":422,"line":745},[3079,3083,3087,3091,3095,3099,3104,3108,3112,3116,3120,3124,3128],{"type":395,"tag":420,"props":3080,"children":3081},{"style":497},[3082],{"type":401,"value":2946},{"type":395,"tag":420,"props":3084,"children":3085},{"style":449},[3086],{"type":401,"value":505},{"type":395,"tag":420,"props":3088,"children":3089},{"style":443},[3090],{"type":401,"value":2042},{"type":395,"tag":420,"props":3092,"children":3093},{"style":491},[3094],{"type":401,"value":452},{"type":395,"tag":420,"props":3096,"children":3097},{"style":1243},[3098],{"type":401,"value":1257},{"type":395,"tag":420,"props":3100,"children":3101},{"style":1249},[3102],{"type":401,"value":3103},"error",{"type":395,"tag":420,"props":3105,"children":3106},{"style":1243},[3107],{"type":401,"value":1257},{"type":395,"tag":420,"props":3109,"children":3110},{"style":449},[3111],{"type":401,"value":463},{"type":395,"tag":420,"props":3113,"children":3114},{"style":437},[3115],{"type":401,"value":563},{"type":395,"tag":420,"props":3117,"children":3118},{"style":449},[3119],{"type":401,"value":452},{"type":395,"tag":420,"props":3121,"children":3122},{"style":455},[3123],{"type":401,"value":572},{"type":395,"tag":420,"props":3125,"children":3126},{"style":449},[3127],{"type":401,"value":473},{"type":395,"tag":420,"props":3129,"children":3130},{"style":449},[3131],{"type":401,"value":478},{"type":395,"tag":420,"props":3133,"children":3134},{"class":422,"line":770},[3135,3139,3143,3147,3151,3155,3159,3163,3167,3172],{"type":395,"tag":420,"props":3136,"children":3137},{"style":497},[3138],{"type":401,"value":3018},{"type":395,"tag":420,"props":3140,"children":3141},{"style":449},[3142],{"type":401,"value":505},{"type":395,"tag":420,"props":3144,"children":3145},{"style":443},[3146],{"type":401,"value":2442},{"type":395,"tag":420,"props":3148,"children":3149},{"style":491},[3150],{"type":401,"value":452},{"type":395,"tag":420,"props":3152,"children":3153},{"style":1243},[3154],{"type":401,"value":1257},{"type":395,"tag":420,"props":3156,"children":3157},{"style":1249},[3158],{"type":401,"value":3103},{"type":395,"tag":420,"props":3160,"children":3161},{"style":1243},[3162],{"type":401,"value":1257},{"type":395,"tag":420,"props":3164,"children":3165},{"style":449},[3166],{"type":401,"value":463},{"type":395,"tag":420,"props":3168,"children":3169},{"style":497},[3170],{"type":401,"value":3171}," err",{"type":395,"tag":420,"props":3173,"children":3174},{"style":491},[3175],{"type":401,"value":612},{"type":395,"tag":420,"props":3177,"children":3178},{"class":422,"line":808},[3179,3183],{"type":395,"tag":420,"props":3180,"children":3181},{"style":449},[3182],{"type":401,"value":621},{"type":395,"tag":420,"props":3184,"children":3185},{"style":491},[3186],{"type":401,"value":612},{"type":395,"tag":420,"props":3188,"children":3189},{"class":422,"line":817},[3190,3194,3198,3202,3206,3210,3215,3219,3223,3227,3231],{"type":395,"tag":420,"props":3191,"children":3192},{"style":497},[3193],{"type":401,"value":2946},{"type":395,"tag":420,"props":3195,"children":3196},{"style":449},[3197],{"type":401,"value":505},{"type":395,"tag":420,"props":3199,"children":3200},{"style":443},[3201],{"type":401,"value":2042},{"type":395,"tag":420,"props":3203,"children":3204},{"style":491},[3205],{"type":401,"value":452},{"type":395,"tag":420,"props":3207,"children":3208},{"style":1243},[3209],{"type":401,"value":1257},{"type":395,"tag":420,"props":3211,"children":3212},{"style":1249},[3213],{"type":401,"value":3214},"ready",{"type":395,"tag":420,"props":3216,"children":3217},{"style":1243},[3218],{"type":401,"value":1257},{"type":395,"tag":420,"props":3220,"children":3221},{"style":449},[3222],{"type":401,"value":463},{"type":395,"tag":420,"props":3224,"children":3225},{"style":437},[3226],{"type":401,"value":563},{"type":395,"tag":420,"props":3228,"children":3229},{"style":449},[3230],{"type":401,"value":1903},{"type":395,"tag":420,"props":3232,"children":3233},{"style":449},[3234],{"type":401,"value":478},{"type":395,"tag":420,"props":3236,"children":3237},{"class":422,"line":829},[3238,3242,3246,3251,3255,3259,3264,3268],{"type":395,"tag":420,"props":3239,"children":3240},{"style":485},[3241],{"type":401,"value":893},{"type":395,"tag":420,"props":3243,"children":3244},{"style":491},[3245],{"type":401,"value":494},{"type":395,"tag":420,"props":3247,"children":3248},{"style":982},[3249],{"type":401,"value":3250},"!",{"type":395,"tag":420,"props":3252,"children":3253},{"style":491},[3254],{"type":401,"value":452},{"type":395,"tag":420,"props":3256,"children":3257},{"style":982},[3258],{"type":401,"value":1590},{"type":395,"tag":420,"props":3260,"children":3261},{"style":497},[3262],{"type":401,"value":3263},"counter",{"type":395,"tag":420,"props":3265,"children":3266},{"style":491},[3267],{"type":401,"value":523},{"type":395,"tag":420,"props":3269,"children":3270},{"style":449},[3271],{"type":401,"value":528},{"type":395,"tag":420,"props":3273,"children":3274},{"class":422,"line":887},[3275,3280,3284,3288],{"type":395,"tag":420,"props":3276,"children":3277},{"style":443},[3278],{"type":401,"value":3279},"        emitReady",{"type":395,"tag":420,"props":3281,"children":3282},{"style":491},[3283],{"type":401,"value":452},{"type":395,"tag":420,"props":3285,"children":3286},{"style":497},[3287],{"type":401,"value":2033},{"type":395,"tag":420,"props":3289,"children":3290},{"style":491},[3291],{"type":401,"value":612},{"type":395,"tag":420,"props":3293,"children":3294},{"class":422,"line":919},[3295],{"type":395,"tag":420,"props":3296,"children":3297},{"style":449},[3298],{"type":401,"value":3299},"      }\n",{"type":395,"tag":420,"props":3301,"children":3302},{"class":422,"line":968},[3303,3307],{"type":395,"tag":420,"props":3304,"children":3305},{"style":449},[3306],{"type":401,"value":621},{"type":395,"tag":420,"props":3308,"children":3309},{"style":491},[3310],{"type":401,"value":612},{"type":395,"tag":420,"props":3312,"children":3313},{"class":422,"line":1022},[3314,3318],{"type":395,"tag":420,"props":3315,"children":3316},{"style":449},[3317],{"type":401,"value":1426},{"type":395,"tag":420,"props":3319,"children":3320},{"style":491},[3321],{"type":401,"value":612},{"type":395,"tag":420,"props":3323,"children":3324},{"class":422,"line":1066},[3325],{"type":395,"tag":420,"props":3326,"children":3327},{"emptyLinePlaceholder":387},[3328],{"type":401,"value":1653},{"type":395,"tag":420,"props":3330,"children":3331},{"class":422,"line":1095},[3332,3336,3340,3344,3348,3352,3356],{"type":395,"tag":420,"props":3333,"children":3334},{"style":497},[3335],{"type":401,"value":1673},{"type":395,"tag":420,"props":3337,"children":3338},{"style":449},[3339],{"type":401,"value":505},{"type":395,"tag":420,"props":3341,"children":3342},{"style":443},[3343],{"type":401,"value":1923},{"type":395,"tag":420,"props":3345,"children":3346},{"style":982},[3347],{"type":401,"value":985},{"type":395,"tag":420,"props":3349,"children":3350},{"style":437},[3351],{"type":401,"value":563},{"type":395,"tag":420,"props":3353,"children":3354},{"style":449},[3355],{"type":401,"value":1903},{"type":395,"tag":420,"props":3357,"children":3358},{"style":449},[3359],{"type":401,"value":478},{"type":395,"tag":420,"props":3361,"children":3362},{"class":422,"line":1104},[3363,3368,3372,3376,3380,3384,3388,3392,3396],{"type":395,"tag":420,"props":3364,"children":3365},{"style":497},[3366],{"type":401,"value":3367},"    watchers",{"type":395,"tag":420,"props":3369,"children":3370},{"style":449},[3371],{"type":401,"value":505},{"type":395,"tag":420,"props":3373,"children":3374},{"style":443},[3375],{"type":401,"value":934},{"type":395,"tag":420,"props":3377,"children":3378},{"style":491},[3379],{"type":401,"value":452},{"type":395,"tag":420,"props":3381,"children":3382},{"style":437},[3383],{"type":401,"value":440},{"type":395,"tag":420,"props":3385,"children":3386},{"style":449},[3387],{"type":401,"value":452},{"type":395,"tag":420,"props":3389,"children":3390},{"style":455},[3391],{"type":401,"value":2930},{"type":395,"tag":420,"props":3393,"children":3394},{"style":449},[3395],{"type":401,"value":473},{"type":395,"tag":420,"props":3397,"children":3398},{"style":449},[3399],{"type":401,"value":478},{"type":395,"tag":420,"props":3401,"children":3402},{"class":422,"line":1117},[3403,3408,3412,3416],{"type":395,"tag":420,"props":3404,"children":3405},{"style":497},[3406],{"type":401,"value":3407},"      w",{"type":395,"tag":420,"props":3409,"children":3410},{"style":449},[3411],{"type":401,"value":505},{"type":395,"tag":420,"props":3413,"children":3414},{"style":443},[3415],{"type":401,"value":1923},{"type":395,"tag":420,"props":3417,"children":3418},{"style":491},[3419],{"type":401,"value":1928},{"type":395,"tag":420,"props":3421,"children":3422},{"class":422,"line":1130},[3423,3427],{"type":395,"tag":420,"props":3424,"children":3425},{"style":449},[3426],{"type":401,"value":621},{"type":395,"tag":420,"props":3428,"children":3429},{"style":491},[3430],{"type":401,"value":612},{"type":395,"tag":420,"props":3432,"children":3433},{"class":422,"line":1138},[3434,3439,3443,3448,3452,3457,3461,3465],{"type":395,"tag":420,"props":3435,"children":3436},{"style":497},[3437],{"type":401,"value":3438},"    process",{"type":395,"tag":420,"props":3440,"children":3441},{"style":449},[3442],{"type":401,"value":505},{"type":395,"tag":420,"props":3444,"children":3445},{"style":443},[3446],{"type":401,"value":3447},"nextTick",{"type":395,"tag":420,"props":3449,"children":3450},{"style":491},[3451],{"type":401,"value":452},{"type":395,"tag":420,"props":3453,"children":3454},{"style":497},[3455],{"type":401,"value":3456},"emitClose",{"type":395,"tag":420,"props":3458,"children":3459},{"style":449},[3460],{"type":401,"value":463},{"type":395,"tag":420,"props":3462,"children":3463},{"style":497},[3464],{"type":401,"value":2817},{"type":395,"tag":420,"props":3466,"children":3467},{"style":491},[3468],{"type":401,"value":612},{"type":395,"tag":420,"props":3470,"children":3471},{"class":422,"line":2265},[3472],{"type":395,"tag":420,"props":3473,"children":3474},{"style":449},[3475],{"type":401,"value":643},{"type":395,"tag":420,"props":3477,"children":3478},{"class":422,"line":2277},[3479],{"type":395,"tag":420,"props":3480,"children":3481},{"emptyLinePlaceholder":387},[3482],{"type":401,"value":1653},{"type":395,"tag":420,"props":3484,"children":3485},{"class":422,"line":2285},[3486,3490,3494,3498,3502,3506,3510,3515,3519],{"type":395,"tag":420,"props":3487,"children":3488},{"style":497},[3489],{"type":401,"value":1673},{"type":395,"tag":420,"props":3491,"children":3492},{"style":449},[3493],{"type":401,"value":505},{"type":395,"tag":420,"props":3495,"children":3496},{"style":443},[3497],{"type":401,"value":2570},{"type":395,"tag":420,"props":3499,"children":3500},{"style":982},[3501],{"type":401,"value":985},{"type":395,"tag":420,"props":3503,"children":3504},{"style":437},[3505],{"type":401,"value":563},{"type":395,"tag":420,"props":3507,"children":3508},{"style":449},[3509],{"type":401,"value":452},{"type":395,"tag":420,"props":3511,"children":3512},{"style":455},[3513],{"type":401,"value":3514},"fn",{"type":395,"tag":420,"props":3516,"children":3517},{"style":449},[3518],{"type":401,"value":473},{"type":395,"tag":420,"props":3520,"children":3521},{"style":449},[3522],{"type":401,"value":478},{"type":395,"tag":420,"props":3524,"children":3526},{"class":422,"line":3525},29,[3527,3531,3535,3539,3543,3548,3552,3556,3560],{"type":395,"tag":420,"props":3528,"children":3529},{"style":485},[3530],{"type":401,"value":1327},{"type":395,"tag":420,"props":3532,"children":3533},{"style":491},[3534],{"type":401,"value":494},{"type":395,"tag":420,"props":3536,"children":3537},{"style":497},[3538],{"type":401,"value":500},{"type":395,"tag":420,"props":3540,"children":3541},{"style":449},[3542],{"type":401,"value":505},{"type":395,"tag":420,"props":3544,"children":3545},{"style":443},[3546],{"type":401,"value":3547},"func",{"type":395,"tag":420,"props":3549,"children":3550},{"style":491},[3551],{"type":401,"value":452},{"type":395,"tag":420,"props":3553,"children":3554},{"style":497},[3555],{"type":401,"value":3514},{"type":395,"tag":420,"props":3557,"children":3558},{"style":491},[3559],{"type":401,"value":523},{"type":395,"tag":420,"props":3561,"children":3562},{"style":449},[3563],{"type":401,"value":528},{"type":395,"tag":420,"props":3565,"children":3567},{"class":422,"line":3566},30,[3568,3573,3578,3582,3586,3590,3595,3599,3603,3607,3611,3615],{"type":395,"tag":420,"props":3569,"children":3570},{"style":437},[3571],{"type":401,"value":3572},"      var",{"type":395,"tag":420,"props":3574,"children":3575},{"style":497},[3576],{"type":401,"value":3577}," promises",{"type":395,"tag":420,"props":3579,"children":3580},{"style":982},[3581],{"type":401,"value":985},{"type":395,"tag":420,"props":3583,"children":3584},{"style":497},[3585],{"type":401,"value":2881},{"type":395,"tag":420,"props":3587,"children":3588},{"style":449},[3589],{"type":401,"value":505},{"type":395,"tag":420,"props":3591,"children":3592},{"style":443},[3593],{"type":401,"value":3594},"map",{"type":395,"tag":420,"props":3596,"children":3597},{"style":491},[3598],{"type":401,"value":452},{"type":395,"tag":420,"props":3600,"children":3601},{"style":437},[3602],{"type":401,"value":440},{"type":395,"tag":420,"props":3604,"children":3605},{"style":449},[3606],{"type":401,"value":452},{"type":395,"tag":420,"props":3608,"children":3609},{"style":455},[3610],{"type":401,"value":2930},{"type":395,"tag":420,"props":3612,"children":3613},{"style":449},[3614],{"type":401,"value":473},{"type":395,"tag":420,"props":3616,"children":3617},{"style":449},[3618],{"type":401,"value":478},{"type":395,"tag":420,"props":3620,"children":3622},{"class":422,"line":3621},31,[3623,3628,3632,3637,3641,3645,3649,3653,3657],{"type":395,"tag":420,"props":3624,"children":3625},{"style":485},[3626],{"type":401,"value":3627},"        return",{"type":395,"tag":420,"props":3629,"children":3630},{"style":982},[3631],{"type":401,"value":2826},{"type":395,"tag":420,"props":3633,"children":3634},{"style":2312},[3635],{"type":401,"value":3636}," Promise",{"type":395,"tag":420,"props":3638,"children":3639},{"style":491},[3640],{"type":401,"value":452},{"type":395,"tag":420,"props":3642,"children":3643},{"style":437},[3644],{"type":401,"value":440},{"type":395,"tag":420,"props":3646,"children":3647},{"style":449},[3648],{"type":401,"value":452},{"type":395,"tag":420,"props":3650,"children":3651},{"style":455},[3652],{"type":401,"value":1227},{"type":395,"tag":420,"props":3654,"children":3655},{"style":449},[3656],{"type":401,"value":473},{"type":395,"tag":420,"props":3658,"children":3659},{"style":449},[3660],{"type":401,"value":478},{"type":395,"tag":420,"props":3662,"children":3664},{"class":422,"line":3663},32,[3665,3670,3674,3678,3682,3686],{"type":395,"tag":420,"props":3666,"children":3667},{"style":497},[3668],{"type":401,"value":3669},"          w",{"type":395,"tag":420,"props":3671,"children":3672},{"style":449},[3673],{"type":401,"value":505},{"type":395,"tag":420,"props":3675,"children":3676},{"style":443},[3677],{"type":401,"value":2570},{"type":395,"tag":420,"props":3679,"children":3680},{"style":491},[3681],{"type":401,"value":452},{"type":395,"tag":420,"props":3683,"children":3684},{"style":497},[3685],{"type":401,"value":1227},{"type":395,"tag":420,"props":3687,"children":3688},{"style":491},[3689],{"type":401,"value":612},{"type":395,"tag":420,"props":3691,"children":3693},{"class":422,"line":3692},33,[3694,3699],{"type":395,"tag":420,"props":3695,"children":3696},{"style":449},[3697],{"type":401,"value":3698},"        }",{"type":395,"tag":420,"props":3700,"children":3701},{"style":491},[3702],{"type":401,"value":612},{"type":395,"tag":420,"props":3704,"children":3706},{"class":422,"line":3705},34,[3707,3711],{"type":395,"tag":420,"props":3708,"children":3709},{"style":449},[3710],{"type":401,"value":1110},{"type":395,"tag":420,"props":3712,"children":3713},{"style":491},[3714],{"type":401,"value":612},{"type":395,"tag":420,"props":3716,"children":3718},{"class":422,"line":3717},35,[3719,3724,3728,3733,3737,3742,3746,3750,3755,3759,3763,3767,3772,3776],{"type":395,"tag":420,"props":3720,"children":3721},{"style":2312},[3722],{"type":401,"value":3723},"      Promise",{"type":395,"tag":420,"props":3725,"children":3726},{"style":449},[3727],{"type":401,"value":505},{"type":395,"tag":420,"props":3729,"children":3730},{"style":443},[3731],{"type":401,"value":3732},"all",{"type":395,"tag":420,"props":3734,"children":3735},{"style":491},[3736],{"type":401,"value":452},{"type":395,"tag":420,"props":3738,"children":3739},{"style":497},[3740],{"type":401,"value":3741},"promises",{"type":395,"tag":420,"props":3743,"children":3744},{"style":491},[3745],{"type":401,"value":473},{"type":395,"tag":420,"props":3747,"children":3748},{"style":449},[3749],{"type":401,"value":505},{"type":395,"tag":420,"props":3751,"children":3752},{"style":443},[3753],{"type":401,"value":3754},"then",{"type":395,"tag":420,"props":3756,"children":3757},{"style":491},[3758],{"type":401,"value":452},{"type":395,"tag":420,"props":3760,"children":3761},{"style":437},[3762],{"type":401,"value":440},{"type":395,"tag":420,"props":3764,"children":3765},{"style":449},[3766],{"type":401,"value":452},{"type":395,"tag":420,"props":3768,"children":3769},{"style":455},[3770],{"type":401,"value":3771},"result",{"type":395,"tag":420,"props":3773,"children":3774},{"style":449},[3775],{"type":401,"value":473},{"type":395,"tag":420,"props":3777,"children":3778},{"style":449},[3779],{"type":401,"value":478},{"type":395,"tag":420,"props":3781,"children":3783},{"class":422,"line":3782},36,[3784,3788,3793,3797,3802,3806,3811,3815,3819],{"type":395,"tag":420,"props":3785,"children":3786},{"style":437},[3787],{"type":401,"value":974},{"type":395,"tag":420,"props":3789,"children":3790},{"style":497},[3791],{"type":401,"value":3792}," ret",{"type":395,"tag":420,"props":3794,"children":3795},{"style":982},[3796],{"type":401,"value":985},{"type":395,"tag":420,"props":3798,"children":3799},{"style":443},[3800],{"type":401,"value":3801}," unique",{"type":395,"tag":420,"props":3803,"children":3804},{"style":491},[3805],{"type":401,"value":452},{"type":395,"tag":420,"props":3807,"children":3808},{"style":443},[3809],{"type":401,"value":3810},"flat1",{"type":395,"tag":420,"props":3812,"children":3813},{"style":491},[3814],{"type":401,"value":452},{"type":395,"tag":420,"props":3816,"children":3817},{"style":497},[3818],{"type":401,"value":3771},{"type":395,"tag":420,"props":3820,"children":3821},{"style":491},[3822],{"type":401,"value":3075},{"type":395,"tag":420,"props":3824,"children":3826},{"class":422,"line":3825},37,[3827,3832,3836,3841],{"type":395,"tag":420,"props":3828,"children":3829},{"style":443},[3830],{"type":401,"value":3831},"        fn",{"type":395,"tag":420,"props":3833,"children":3834},{"style":491},[3835],{"type":401,"value":452},{"type":395,"tag":420,"props":3837,"children":3838},{"style":497},[3839],{"type":401,"value":3840},"ret",{"type":395,"tag":420,"props":3842,"children":3843},{"style":491},[3844],{"type":401,"value":612},{"type":395,"tag":420,"props":3846,"children":3848},{"class":422,"line":3847},38,[3849,3853],{"type":395,"tag":420,"props":3850,"children":3851},{"style":449},[3852],{"type":401,"value":1110},{"type":395,"tag":420,"props":3854,"children":3855},{"style":491},[3856],{"type":401,"value":612},{"type":395,"tag":420,"props":3858,"children":3860},{"class":422,"line":3859},39,[3861],{"type":395,"tag":420,"props":3862,"children":3863},{"style":449},[3864],{"type":401,"value":1418},{"type":395,"tag":420,"props":3866,"children":3868},{"class":422,"line":3867},40,[3869],{"type":395,"tag":420,"props":3870,"children":3871},{"style":449},[3872],{"type":401,"value":643},{"type":395,"tag":420,"props":3874,"children":3876},{"class":422,"line":3875},41,[3877],{"type":395,"tag":420,"props":3878,"children":3879},{"emptyLinePlaceholder":387},[3880],{"type":401,"value":1653},{"type":395,"tag":420,"props":3882,"children":3884},{"class":422,"line":3883},42,[3885,3889,3893,3897,3901],{"type":395,"tag":420,"props":3886,"children":3887},{"style":485},[3888],{"type":401,"value":2744},{"type":395,"tag":420,"props":3890,"children":3891},{"style":497},[3892],{"type":401,"value":2817},{"type":395,"tag":420,"props":3894,"children":3895},{"style":449},[3896],{"type":401,"value":505},{"type":395,"tag":420,"props":3898,"children":3899},{"style":443},[3900],{"type":401,"value":2333},{"type":395,"tag":420,"props":3902,"children":3903},{"style":491},[3904],{"type":401,"value":1928},{"type":395,"tag":420,"props":3906,"children":3908},{"class":422,"line":3907},43,[3909],{"type":395,"tag":420,"props":3910,"children":3911},{"style":449},[3912],{"type":401,"value":1144},{"type":395,"tag":396,"props":3914,"children":3916},{"id":3915},"工具函数",[3917],{"type":401,"value":3915},{"type":395,"tag":403,"props":3919,"children":3920},{},[3921],{"type":401,"value":3922},"通过索引快速去重。第一次见到有人使用 filter 方法的第三个参数。",{"type":395,"tag":409,"props":3924,"children":3926},{"className":411,"code":3925,"language":413,"meta":388,"style":388},"function unique(arr) {\n  return arr.filter(function(v, i, self) {\n    return self.indexOf(v) === i\n  })\n}\n",[3927],{"type":395,"tag":416,"props":3928,"children":3929},{"__ignoreMap":388},[3930,3958,4021,4062,4073],{"type":395,"tag":420,"props":3931,"children":3932},{"class":422,"line":423},[3933,3937,3941,3945,3950,3954],{"type":395,"tag":420,"props":3934,"children":3935},{"style":437},[3936],{"type":401,"value":440},{"type":395,"tag":420,"props":3938,"children":3939},{"style":443},[3940],{"type":401,"value":3801},{"type":395,"tag":420,"props":3942,"children":3943},{"style":449},[3944],{"type":401,"value":452},{"type":395,"tag":420,"props":3946,"children":3947},{"style":455},[3948],{"type":401,"value":3949},"arr",{"type":395,"tag":420,"props":3951,"children":3952},{"style":449},[3953],{"type":401,"value":473},{"type":395,"tag":420,"props":3955,"children":3956},{"style":449},[3957],{"type":401,"value":478},{"type":395,"tag":420,"props":3959,"children":3960},{"class":422,"line":433},[3961,3965,3970,3974,3979,3983,3987,3991,3996,4000,4005,4009,4013,4017],{"type":395,"tag":420,"props":3962,"children":3963},{"style":485},[3964],{"type":401,"value":2744},{"type":395,"tag":420,"props":3966,"children":3967},{"style":497},[3968],{"type":401,"value":3969}," arr",{"type":395,"tag":420,"props":3971,"children":3972},{"style":449},[3973],{"type":401,"value":505},{"type":395,"tag":420,"props":3975,"children":3976},{"style":443},[3977],{"type":401,"value":3978},"filter",{"type":395,"tag":420,"props":3980,"children":3981},{"style":491},[3982],{"type":401,"value":452},{"type":395,"tag":420,"props":3984,"children":3985},{"style":437},[3986],{"type":401,"value":440},{"type":395,"tag":420,"props":3988,"children":3989},{"style":449},[3990],{"type":401,"value":452},{"type":395,"tag":420,"props":3992,"children":3993},{"style":455},[3994],{"type":401,"value":3995},"v",{"type":395,"tag":420,"props":3997,"children":3998},{"style":449},[3999],{"type":401,"value":463},{"type":395,"tag":420,"props":4001,"children":4002},{"style":455},[4003],{"type":401,"value":4004}," i",{"type":395,"tag":420,"props":4006,"children":4007},{"style":449},[4008],{"type":401,"value":463},{"type":395,"tag":420,"props":4010,"children":4011},{"style":455},[4012],{"type":401,"value":2382},{"type":395,"tag":420,"props":4014,"children":4015},{"style":449},[4016],{"type":401,"value":473},{"type":395,"tag":420,"props":4018,"children":4019},{"style":449},[4020],{"type":401,"value":478},{"type":395,"tag":420,"props":4022,"children":4023},{"class":422,"line":481},[4024,4028,4032,4036,4041,4045,4049,4053,4057],{"type":395,"tag":420,"props":4025,"children":4026},{"style":485},[4027],{"type":401,"value":1790},{"type":395,"tag":420,"props":4029,"children":4030},{"style":497},[4031],{"type":401,"value":2382},{"type":395,"tag":420,"props":4033,"children":4034},{"style":449},[4035],{"type":401,"value":505},{"type":395,"tag":420,"props":4037,"children":4038},{"style":443},[4039],{"type":401,"value":4040},"indexOf",{"type":395,"tag":420,"props":4042,"children":4043},{"style":491},[4044],{"type":401,"value":452},{"type":395,"tag":420,"props":4046,"children":4047},{"style":497},[4048],{"type":401,"value":3995},{"type":395,"tag":420,"props":4050,"children":4051},{"style":491},[4052],{"type":401,"value":906},{"type":395,"tag":420,"props":4054,"children":4055},{"style":982},[4056],{"type":401,"value":1362},{"type":395,"tag":420,"props":4058,"children":4059},{"style":497},[4060],{"type":401,"value":4061}," i\n",{"type":395,"tag":420,"props":4063,"children":4064},{"class":422,"line":531},[4065,4069],{"type":395,"tag":420,"props":4066,"children":4067},{"style":449},[4068],{"type":401,"value":1426},{"type":395,"tag":420,"props":4070,"children":4071},{"style":491},[4072],{"type":401,"value":612},{"type":395,"tag":420,"props":4074,"children":4075},{"class":422,"line":583},[4076],{"type":395,"tag":420,"props":4077,"children":4078},{"style":449},[4079],{"type":401,"value":1144},{"type":395,"tag":403,"props":4081,"children":4082},{},[4083],{"type":401,"value":4084},"获取 UUID，这个有意思，但不知道效率怎么样。",{"type":395,"tag":409,"props":4086,"children":4088},{"className":411,"code":4087,"language":413,"meta":388,"style":388},"const getUUID = () => Math.random().toString(16).substr(2)\n",[4089],{"type":395,"tag":416,"props":4090,"children":4091},{"__ignoreMap":388},[4092],{"type":395,"tag":420,"props":4093,"children":4094},{"class":422,"line":423},[4095,4100,4106,4110,4115,4120,4125,4129,4134,4138,4142,4147,4151,4156,4160,4164,4169,4173,4178],{"type":395,"tag":420,"props":4096,"children":4097},{"style":437},[4098],{"type":401,"value":4099},"const",{"type":395,"tag":420,"props":4101,"children":4103},{"style":4102},"--shiki-light:#90A4AE;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[4104],{"type":401,"value":4105}," getUUID",{"type":395,"tag":420,"props":4107,"children":4108},{"style":982},[4109],{"type":401,"value":985},{"type":395,"tag":420,"props":4111,"children":4112},{"style":449},[4113],{"type":401,"value":4114}," ()",{"type":395,"tag":420,"props":4116,"children":4117},{"style":437},[4118],{"type":401,"value":4119}," =>",{"type":395,"tag":420,"props":4121,"children":4122},{"style":497},[4123],{"type":401,"value":4124}," Math",{"type":395,"tag":420,"props":4126,"children":4127},{"style":449},[4128],{"type":401,"value":505},{"type":395,"tag":420,"props":4130,"children":4131},{"style":443},[4132],{"type":401,"value":4133},"random",{"type":395,"tag":420,"props":4135,"children":4136},{"style":497},[4137],{"type":401,"value":1903},{"type":395,"tag":420,"props":4139,"children":4140},{"style":449},[4141],{"type":401,"value":505},{"type":395,"tag":420,"props":4143,"children":4144},{"style":443},[4145],{"type":401,"value":4146},"toString",{"type":395,"tag":420,"props":4148,"children":4149},{"style":497},[4150],{"type":401,"value":452},{"type":395,"tag":420,"props":4152,"children":4153},{"style":2011},[4154],{"type":401,"value":4155},"16",{"type":395,"tag":420,"props":4157,"children":4158},{"style":497},[4159],{"type":401,"value":473},{"type":395,"tag":420,"props":4161,"children":4162},{"style":449},[4163],{"type":401,"value":505},{"type":395,"tag":420,"props":4165,"children":4166},{"style":443},[4167],{"type":401,"value":4168},"substr",{"type":395,"tag":420,"props":4170,"children":4171},{"style":497},[4172],{"type":401,"value":452},{"type":395,"tag":420,"props":4174,"children":4175},{"style":2011},[4176],{"type":401,"value":4177},"2",{"type":395,"tag":420,"props":4179,"children":4180},{"style":497},[4181],{"type":401,"value":612},{"type":395,"tag":396,"props":4183,"children":4185},{"id":4184},"考虑的点",[4186],{"type":401,"value":4184},{"type":395,"tag":403,"props":4188,"children":4189},{},[4190],{"type":401,"value":4191},"最后总结一下一些框架设计相关的小细节，如果需要自己设计一个 fs.watch，可能要做以下考虑：",{"type":395,"tag":4193,"props":4194,"children":4195},"ul",{},[4196,4202,4207,4212],{"type":395,"tag":4197,"props":4198,"children":4199},"li",{},[4200],{"type":401,"value":4201},"使用原生依赖吗？使用原生依赖会带来更高的性能，但是也会增加代码难度以及测试的复杂度",{"type":395,"tag":4197,"props":4203,"children":4204},{},[4205],{"type":401,"value":4206},"支持本地符号路径吗？支持网络路径吗？",{"type":395,"tag":4197,"props":4208,"children":4209},{},[4210],{"type":401,"value":4211},"如何控制包的大小？",{"type":395,"tag":4197,"props":4213,"children":4214},{},[4215],{"type":401,"value":4216},"由于不同系统的底层依赖不同，那么 API 要怎么设计，屏蔽底层，才能便于使用？",{"type":395,"tag":403,"props":4218,"children":4219},{},[4220],{"type":401,"value":4221},"也注意到一些有意思的问题：",{"type":395,"tag":4193,"props":4223,"children":4224},{},[4225,4237,4249],{"type":395,"tag":4197,"props":4226,"children":4227},{},[4228,4230],{"type":401,"value":4229},"Windows，删除正在监听的文件夹，",{"type":395,"tag":1151,"props":4231,"children":4234},{"href":4232,"rel":4233},"https://github.com/nodejs/node/issues/31702",[1155],[4235],{"type":401,"value":4236},"会发生什么事情？",{"type":395,"tag":4197,"props":4238,"children":4239},{},[4240,4242],{"type":401,"value":4241},"Linux，单个进程能操作的文件数量有上限，",{"type":395,"tag":1151,"props":4243,"children":4246},{"href":4244,"rel":4245},"https://github.com/nodejs/node-v0.x-archive/issues/2479",[1155],[4247],{"type":401,"value":4248},"该怎么解决？",{"type":395,"tag":4197,"props":4250,"children":4251},{},[4252,4254],{"type":401,"value":4253},"碰到操作系统或应用层面的问题，导致文件在短时间内多次触发更新，",{"type":395,"tag":1151,"props":4255,"children":4258},{"href":4256,"rel":4257},"https://github.com/yuanchuan/node-watch/blob/4cac915ab7cb5cc6a95263712e9def1004c35f78/lib/watch.js#L68",[1155],[4259],{"type":401,"value":4260},"怎么处理呢？",{"type":395,"tag":396,"props":4262,"children":4264},{"id":4263},"题外话",[4265],{"type":401,"value":4263},{"type":395,"tag":4267,"props":4268,"children":4271},"l-link",{"label":4269,"source":4270},"《Recursive Node.js fs.watch on Linux》","https://stackoverflow.com/questions/43112227/recursive-node-js-fs-watch-on-linux",[],{"type":395,"tag":403,"props":4273,"children":4274},{},[4275],{"type":401,"value":4276},"这个回答中的 node-watch 为啥会被踩，我没看很懂。",{"type":395,"tag":396,"props":4278,"children":4280},{"id":4279},"其它资料",[4281],{"type":401,"value":4279},{"type":395,"tag":403,"props":4283,"children":4284},{},[4285],{"type":401,"value":4286},"相关类库：",{"type":395,"tag":4193,"props":4288,"children":4289},{},[4290,4299,4309],{"type":395,"tag":4197,"props":4291,"children":4292},{},[4293],{"type":395,"tag":1151,"props":4294,"children":4297},{"href":4295,"rel":4296},"https://www.npmjs.com/package/watcher",[1155],[4298],{"type":401,"value":2033},{"type":395,"tag":4197,"props":4300,"children":4301},{},[4302],{"type":395,"tag":1151,"props":4303,"children":4306},{"href":4304,"rel":4305},"https://github.com/paulmillr/chokidar",[1155],[4307],{"type":401,"value":4308},"chokidar",{"type":395,"tag":4197,"props":4310,"children":4311},{},[4312],{"type":395,"tag":1151,"props":4313,"children":4316},{"href":4314,"rel":4315},"https://github.com/Axosoft/nsfw",[1155],[4317],{"type":401,"value":4318},"nsfw",{"type":395,"tag":403,"props":4320,"children":4321},{},[4322],{"type":401,"value":4323},"推荐阅读：",{"type":395,"tag":4193,"props":4325,"children":4326},{},[4327,4337],{"type":395,"tag":4197,"props":4328,"children":4329},{},[4330],{"type":395,"tag":1151,"props":4331,"children":4334},{"href":4332,"rel":4333},"https://juejin.cn/post/7000262974430511117",[1155],[4335],{"type":401,"value":4336},"《node-watch、Chokidar封装思路解析》",{"type":395,"tag":4197,"props":4338,"children":4339},{},[4340],{"type":395,"tag":1151,"props":4341,"children":4344},{"href":4342,"rel":4343},"https://www.jianshu.com/p/09dae09457fa",[1155],[4345],{"type":401,"value":4346},"《如何利用 Nodejs 监听文件夹》",{"type":395,"tag":4348,"props":4349,"children":4350},"style",{},[4351],{"type":401,"value":4352},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":388,"searchDepth":433,"depth":433,"links":4354},[4355,4356,4357,4358,4359],{"id":398,"depth":433,"text":398},{"id":3915,"depth":433,"text":3915},{"id":4184,"depth":433,"text":4184},{"id":4263,"depth":433,"text":4263},{"id":4279,"depth":433,"text":4279},"markdown","content:8.source-code:_node:node-watch.md","content","8.source-code/_node/node-watch.md","md",[4366,4370],{"_path":4367,"title":4368,"description":4369},"/source-code/_module/is-online","判断 NodeJS 是否在线","之前被组长问道要如何判断 NodeJS 是否在线，我不假思索回答：“Ping 百度试试。”。调用 Ping 需要 child_process，那还不如直接改用内置的 DNS 试试是否在线更简单一些。不过会不会碰到缓存等问题，没往下细想了。今天正好在别人的博客看到了 NodeJS DNS 模块，突然想起这个问题，于是就搜了一下相关库。找到了 internet-available 这个玩意儿。这里一起来看看他们的实现。",{"_path":4371,"title":4372,"description":388},"/source-code/_ts/type-challenges","TypeScript Type Chanllenges",1708107579391]