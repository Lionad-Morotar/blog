[{"data":1,"prerenderedAt":4385},["ShallowReactive",2],{"navigation":3,"/source-code/_node/node-watch":393,"/source-code/_node/node-watch-surround":4376},[4,35,86,105,132,138,144,150,387],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":45,"_path":46},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":48,"_path":49},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":51,"_path":52},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":54,"_path":55},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":57,"_path":58},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":60,"_path":61},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":63,"_path":64},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":66,"_path":67},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":69,"_path":70},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":72,"_path":73},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":75,"_path":76},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":78,"_path":79},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":81,"_path":82},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":84,"_path":85},"📝 技术博客归档","/articles/archive",{"title":87,"_path":88,"children":89},"造物 / Make","/tools",[90,93,96,99,102],{"title":91,"_path":92},"🥥 Coconut","/tools/coconut",{"title":94,"_path":95},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":97,"_path":98},"🌐 AnySort","/tools/anysort",{"title":100,"_path":101},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":103,"_path":104},"👓 Crapto","/tools/crypto-inline",{"title":106,"_path":107,"children":108},"吉他剧场 / Music","/music",[109,111,114,117,120,123,126,129],{"title":110,"_path":107},"🎸 FingerStyle！",{"title":112,"_path":113},"🌬️ 等待的风","/music/wind",{"title":115,"_path":116},"💕 约定的海洋","/music/ocean",{"title":118,"_path":119},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":121,"_path":122},"🌏 残酷天使的行动纲领","/music/eva",{"title":124,"_path":125},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":127,"_path":128},"🍷 Wu Wei","/music/wu-wei",{"title":130,"_path":131},"🌅 无题","/music/untitled",{"title":133,"_path":134,"children":135},"画点什么 / Paint","/paint",[136],{"title":137,"_path":134},"🚧 正在施工",{"title":139,"_path":140,"children":141},"读书笔记 / Notes","/books",[142],{"title":143,"_path":140},"📕 读书笔记",{"title":145,"_path":146,"children":147},"知识地图 / Maps","/maps",[148],{"title":149,"_path":146},"🏁 知识地图",{"title":151,"_path":152,"children":153},"零散的笔记 / Gists","/gists",[154,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375,378,381,384],{"title":155,"_path":152},"🧊 Gists",{"title":157,"_path":158},"网站的可访问性","/gists/accessibility",{"title":160,"_path":161},"Bit","/gists/bit",{"title":163,"_path":164},"图片模糊","/gists/blur",{"title":166,"_path":167},"渲染相关笔记","/gists/c4d",{"title":169,"_path":170},"CDN 问题记录","/gists/cdn",{"title":172,"_path":173},"消毒剂","/gists/cleaner",{"title":175,"_path":176},"Windows Command","/gists/cmd",{"title":178,"_path":179},"Command","/gists/command",{"title":181,"_path":182},"复杂科学","/gists/complexity-science",{"title":184,"_path":185},"GitHub Copilot","/gists/copilot",{"title":187,"_path":188},"宇宙","/gists/cosmos",{"title":190,"_path":191},"C++","/gists/cpp",{"title":193,"_path":194},"DEPRESSION","/gists/depression",{"title":196,"_path":197},"Developer Experience","/gists/developer-experience",{"title":199,"_path":200},"Device Metrics","/gists/device-metrix",{"title":202,"_path":203},"数字化转型","/gists/digital-transformation",{"title":205,"_path":206},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":208,"_path":209},"正则表达式","/gists/eegex",{"title":211,"_path":212},"Emoji","/gists/emoji",{"title":214,"_path":215},"工程","/gists/engineering",{"title":217,"_path":218},"熵","/gists/entropy",{"title":220,"_path":221},"Environment","/gists/environment",{"title":223,"_path":224},"Erlang","/gists/erlang",{"title":226,"_path":227},"逃离塔克夫","/gists/escape-from-tarkov",{"title":229,"_path":230},"ESNext (ES6-ES11)","/gists/esnext",{"title":232,"_path":233},"Eval！","/gists/eval",{"title":235,"_path":236},"Flutter","/gists/flutter",{"title":238,"_path":239},"字体","/gists/font",{"title":241,"_path":242},"JS 函数式编程","/gists/functional",{"title":244,"_path":245},"游戏化","/gists/gamification",{"title":247,"_path":248},"Google C++ Standard","/gists/google-cpp-standard",{"title":250,"_path":251},"双向链接完全体","/gists/graph",{"title":253,"_path":254},"Hardwares","/gists/hardwares",{"title":256,"_path":257},"哈希冲突","/gists/hash-collision",{"title":259,"_path":260},"信息设计","/gists/information-design",{"title":262,"_path":263},"InstantPage","/gists/instant.page",{"title":265,"_path":266},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":268,"_path":269},"KVStore","/gists/key-value-db",{"title":271,"_path":272},"Kubernetes","/gists/kubernetes",{"title":274,"_path":275},"Makefile","/gists/makefile",{"title":277,"_path":278},"Markdown Inline Style","/gists/markdown-nice",{"title":280,"_path":281},"小程序","/gists/miniapp",{"title":283,"_path":284},"减小页面快照体积","/gists/minify-html",{"title":286,"_path":287},"mklink","/gists/mklink",{"title":289,"_path":290},"Mock","/gists/mock",{"title":292,"_path":293},"多人协作系统","/gists/multiplayer",{"title":295,"_path":296},"多端应用","/gists/multy-end-app",{"title":298,"_path":299},"神经科学","/gists/neuroscience",{"title":301,"_path":302},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":304,"_path":305},"PInvoke","/gists/pinvoke",{"title":307,"_path":308},"像素","/gists/pixel",{"title":310,"_path":311},"PowerShell","/gists/powershell",{"title":313,"_path":314},"量子","/gists/quantum",{"title":316,"_path":317},"保持好奇心","/gists/questions",{"title":319,"_path":320},"React Native","/gists/react-native",{"title":322,"_path":323},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":325,"_path":326},"SEO","/gists/seo",{"title":328,"_path":329},"Shader","/gists/shader",{"title":331,"_path":332},"Shape Up","/gists/shape-up",{"title":334,"_path":335},"睡觉","/gists/sleep",{"title":337,"_path":338},"记录奇怪的问题","/gists/solved",{"title":340,"_path":341},"States","/gists/states",{"title":343,"_path":344},"Storage","/gists/storage",{"title":346,"_path":347},"音视频流处理","/gists/stream-cli",{"title":349,"_path":350},"Symbol","/gists/symbol",{"title":352,"_path":353},"系统论","/gists/systems-theory",{"title":355,"_path":356},"Taro","/gists/taro",{"title":358,"_path":359},"任务切片","/gists/task-slice",{"title":361,"_path":362},"技术偏好","/gists/tech-dudge",{"title":364,"_path":365},"Untitled","/gists/untitled",{"title":367,"_path":368},"可变字体","/gists/variable-font",{"title":370,"_path":371},"视觉错觉","/gists/visual-illusion",{"title":373,"_path":374},"SS(SSR)","/gists/vpn",{"title":376,"_path":377},"VS Code 插件开发","/gists/vscode-plugin",{"title":379,"_path":380},"Web Components","/gists/web-components",{"title":382,"_path":383},"Windows","/gists/windows",{"title":385,"_path":386},"查缺补漏","/gists/wrong",{"title":388,"_path":389,"children":390},"我 / About","/hire",[391],{"title":392,"_path":389},"📬 技术简历",{"_path":394,"_dir":395,"_draft":396,"_partial":397,"_locale":398,"title":399,"description":400,"body":401,"_type":4370,"_id":4371,"_source":4372,"_file":4373,"_stem":4374,"_extension":4375},"/source-code/_node/node-watch","_node",false,true,"","node-watch","node-watch 是在 fs.watch 的基础上封装而来的库，能监听文件变化",{"type":402,"children":403,"toc":4363},"root",[404,412,418,1155,1171,1448,1453,1630,1635,2305,2310,2767,2772,3923,3928,3933,4090,4095,4192,4197,4202,4227,4232,4271,4276,4282,4287,4292,4297,4329,4334,4357],{"type":405,"tag":406,"props":407,"children":409},"element","h2",{"id":408},"实现",[410],{"type":411,"value":408},"text",{"type":405,"tag":413,"props":414,"children":415},"p",{},[416],{"type":411,"value":417},"从提交历史来看，最初的提交的代码非常简单，几乎是只多了一个递归监听功能。在 normalizeCall 函数中使用计时函数，把回调往后延迟了 100ms，防止短暂时间内同一个文件多次修改（比方说某些编辑器保存文件时会先生成一个临时文件）。",{"type":405,"tag":419,"props":420,"children":424},"pre",{"className":421,"code":422,"language":423,"meta":398,"style":398},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","//  https://github.com/yuanchuan/node-watch/commit/d2d8e2db4b771f918d67d261708752d8eb5c17b3\nfunction watch(dir, cb) {\n  if (is.File(dir)) {\n    fs.watchFile(dir, function(err) {\n      normalizeCall(cb, dir)\n    })\n    return\n  }\n  if (is.Directory(dir)) {\n    fs.watch(dir, function(err, fname) {\n      normalizeCall(cb,  \n        path.join(dir, fname)\n      )\n    })\n    fs.readdir(dir, function(err, files) {\n      if (err) throw err\n      files.forEach(function(n) { \n        var file = path.join(dir, n)\n        if ( is.Directory(file) ) {\n          watch(file, cb)\n        }\n      })\n    })     \n  }\n} \n","js",[425],{"type":405,"tag":426,"props":427,"children":428},"code",{"__ignoreMap":398},[429,441,489,539,591,623,636,645,654,695,753,778,816,825,837,895,927,976,1030,1074,1103,1112,1125,1138,1146],{"type":405,"tag":430,"props":431,"children":434},"span",{"class":432,"line":433},"line",1,[435],{"type":405,"tag":430,"props":436,"children":438},{"style":437},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[439],{"type":411,"value":440},"//  https://github.com/yuanchuan/node-watch/commit/d2d8e2db4b771f918d67d261708752d8eb5c17b3\n",{"type":405,"tag":430,"props":442,"children":444},{"class":432,"line":443},2,[445,451,457,463,469,474,479,484],{"type":405,"tag":430,"props":446,"children":448},{"style":447},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[449],{"type":411,"value":450},"function",{"type":405,"tag":430,"props":452,"children":454},{"style":453},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[455],{"type":411,"value":456}," watch",{"type":405,"tag":430,"props":458,"children":460},{"style":459},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[461],{"type":411,"value":462},"(",{"type":405,"tag":430,"props":464,"children":466},{"style":465},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[467],{"type":411,"value":468},"dir",{"type":405,"tag":430,"props":470,"children":471},{"style":459},[472],{"type":411,"value":473},",",{"type":405,"tag":430,"props":475,"children":476},{"style":465},[477],{"type":411,"value":478}," cb",{"type":405,"tag":430,"props":480,"children":481},{"style":459},[482],{"type":411,"value":483},")",{"type":405,"tag":430,"props":485,"children":486},{"style":459},[487],{"type":411,"value":488}," {\n",{"type":405,"tag":430,"props":490,"children":492},{"class":432,"line":491},3,[493,499,505,511,516,521,525,529,534],{"type":405,"tag":430,"props":494,"children":496},{"style":495},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[497],{"type":411,"value":498},"  if",{"type":405,"tag":430,"props":500,"children":502},{"style":501},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[503],{"type":411,"value":504}," (",{"type":405,"tag":430,"props":506,"children":508},{"style":507},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[509],{"type":411,"value":510},"is",{"type":405,"tag":430,"props":512,"children":513},{"style":459},[514],{"type":411,"value":515},".",{"type":405,"tag":430,"props":517,"children":518},{"style":453},[519],{"type":411,"value":520},"File",{"type":405,"tag":430,"props":522,"children":523},{"style":501},[524],{"type":411,"value":462},{"type":405,"tag":430,"props":526,"children":527},{"style":507},[528],{"type":411,"value":468},{"type":405,"tag":430,"props":530,"children":531},{"style":501},[532],{"type":411,"value":533},")) ",{"type":405,"tag":430,"props":535,"children":536},{"style":459},[537],{"type":411,"value":538},"{\n",{"type":405,"tag":430,"props":540,"children":542},{"class":432,"line":541},4,[543,548,552,557,561,565,569,574,578,583,587],{"type":405,"tag":430,"props":544,"children":545},{"style":507},[546],{"type":411,"value":547},"    fs",{"type":405,"tag":430,"props":549,"children":550},{"style":459},[551],{"type":411,"value":515},{"type":405,"tag":430,"props":553,"children":554},{"style":453},[555],{"type":411,"value":556},"watchFile",{"type":405,"tag":430,"props":558,"children":559},{"style":501},[560],{"type":411,"value":462},{"type":405,"tag":430,"props":562,"children":563},{"style":507},[564],{"type":411,"value":468},{"type":405,"tag":430,"props":566,"children":567},{"style":459},[568],{"type":411,"value":473},{"type":405,"tag":430,"props":570,"children":571},{"style":447},[572],{"type":411,"value":573}," function",{"type":405,"tag":430,"props":575,"children":576},{"style":459},[577],{"type":411,"value":462},{"type":405,"tag":430,"props":579,"children":580},{"style":465},[581],{"type":411,"value":582},"err",{"type":405,"tag":430,"props":584,"children":585},{"style":459},[586],{"type":411,"value":483},{"type":405,"tag":430,"props":588,"children":589},{"style":459},[590],{"type":411,"value":488},{"type":405,"tag":430,"props":592,"children":594},{"class":432,"line":593},5,[595,600,604,609,613,618],{"type":405,"tag":430,"props":596,"children":597},{"style":453},[598],{"type":411,"value":599},"      normalizeCall",{"type":405,"tag":430,"props":601,"children":602},{"style":501},[603],{"type":411,"value":462},{"type":405,"tag":430,"props":605,"children":606},{"style":507},[607],{"type":411,"value":608},"cb",{"type":405,"tag":430,"props":610,"children":611},{"style":459},[612],{"type":411,"value":473},{"type":405,"tag":430,"props":614,"children":615},{"style":507},[616],{"type":411,"value":617}," dir",{"type":405,"tag":430,"props":619,"children":620},{"style":501},[621],{"type":411,"value":622},")\n",{"type":405,"tag":430,"props":624,"children":626},{"class":432,"line":625},6,[627,632],{"type":405,"tag":430,"props":628,"children":629},{"style":459},[630],{"type":411,"value":631},"    }",{"type":405,"tag":430,"props":633,"children":634},{"style":501},[635],{"type":411,"value":622},{"type":405,"tag":430,"props":637,"children":639},{"class":432,"line":638},7,[640],{"type":405,"tag":430,"props":641,"children":642},{"style":495},[643],{"type":411,"value":644},"    return\n",{"type":405,"tag":430,"props":646,"children":648},{"class":432,"line":647},8,[649],{"type":405,"tag":430,"props":650,"children":651},{"style":459},[652],{"type":411,"value":653},"  }\n",{"type":405,"tag":430,"props":655,"children":657},{"class":432,"line":656},9,[658,662,666,670,674,679,683,687,691],{"type":405,"tag":430,"props":659,"children":660},{"style":495},[661],{"type":411,"value":498},{"type":405,"tag":430,"props":663,"children":664},{"style":501},[665],{"type":411,"value":504},{"type":405,"tag":430,"props":667,"children":668},{"style":507},[669],{"type":411,"value":510},{"type":405,"tag":430,"props":671,"children":672},{"style":459},[673],{"type":411,"value":515},{"type":405,"tag":430,"props":675,"children":676},{"style":453},[677],{"type":411,"value":678},"Directory",{"type":405,"tag":430,"props":680,"children":681},{"style":501},[682],{"type":411,"value":462},{"type":405,"tag":430,"props":684,"children":685},{"style":507},[686],{"type":411,"value":468},{"type":405,"tag":430,"props":688,"children":689},{"style":501},[690],{"type":411,"value":533},{"type":405,"tag":430,"props":692,"children":693},{"style":459},[694],{"type":411,"value":538},{"type":405,"tag":430,"props":696,"children":698},{"class":432,"line":697},10,[699,703,707,712,716,720,724,728,732,736,740,745,749],{"type":405,"tag":430,"props":700,"children":701},{"style":507},[702],{"type":411,"value":547},{"type":405,"tag":430,"props":704,"children":705},{"style":459},[706],{"type":411,"value":515},{"type":405,"tag":430,"props":708,"children":709},{"style":453},[710],{"type":411,"value":711},"watch",{"type":405,"tag":430,"props":713,"children":714},{"style":501},[715],{"type":411,"value":462},{"type":405,"tag":430,"props":717,"children":718},{"style":507},[719],{"type":411,"value":468},{"type":405,"tag":430,"props":721,"children":722},{"style":459},[723],{"type":411,"value":473},{"type":405,"tag":430,"props":725,"children":726},{"style":447},[727],{"type":411,"value":573},{"type":405,"tag":430,"props":729,"children":730},{"style":459},[731],{"type":411,"value":462},{"type":405,"tag":430,"props":733,"children":734},{"style":465},[735],{"type":411,"value":582},{"type":405,"tag":430,"props":737,"children":738},{"style":459},[739],{"type":411,"value":473},{"type":405,"tag":430,"props":741,"children":742},{"style":465},[743],{"type":411,"value":744}," fname",{"type":405,"tag":430,"props":746,"children":747},{"style":459},[748],{"type":411,"value":483},{"type":405,"tag":430,"props":750,"children":751},{"style":459},[752],{"type":411,"value":488},{"type":405,"tag":430,"props":754,"children":756},{"class":432,"line":755},11,[757,761,765,769,773],{"type":405,"tag":430,"props":758,"children":759},{"style":453},[760],{"type":411,"value":599},{"type":405,"tag":430,"props":762,"children":763},{"style":501},[764],{"type":411,"value":462},{"type":405,"tag":430,"props":766,"children":767},{"style":507},[768],{"type":411,"value":608},{"type":405,"tag":430,"props":770,"children":771},{"style":459},[772],{"type":411,"value":473},{"type":405,"tag":430,"props":774,"children":775},{"style":501},[776],{"type":411,"value":777},"  \n",{"type":405,"tag":430,"props":779,"children":781},{"class":432,"line":780},12,[782,787,791,796,800,804,808,812],{"type":405,"tag":430,"props":783,"children":784},{"style":507},[785],{"type":411,"value":786},"        path",{"type":405,"tag":430,"props":788,"children":789},{"style":459},[790],{"type":411,"value":515},{"type":405,"tag":430,"props":792,"children":793},{"style":453},[794],{"type":411,"value":795},"join",{"type":405,"tag":430,"props":797,"children":798},{"style":501},[799],{"type":411,"value":462},{"type":405,"tag":430,"props":801,"children":802},{"style":507},[803],{"type":411,"value":468},{"type":405,"tag":430,"props":805,"children":806},{"style":459},[807],{"type":411,"value":473},{"type":405,"tag":430,"props":809,"children":810},{"style":507},[811],{"type":411,"value":744},{"type":405,"tag":430,"props":813,"children":814},{"style":501},[815],{"type":411,"value":622},{"type":405,"tag":430,"props":817,"children":819},{"class":432,"line":818},13,[820],{"type":405,"tag":430,"props":821,"children":822},{"style":501},[823],{"type":411,"value":824},"      )\n",{"type":405,"tag":430,"props":826,"children":828},{"class":432,"line":827},14,[829,833],{"type":405,"tag":430,"props":830,"children":831},{"style":459},[832],{"type":411,"value":631},{"type":405,"tag":430,"props":834,"children":835},{"style":501},[836],{"type":411,"value":622},{"type":405,"tag":430,"props":838,"children":840},{"class":432,"line":839},15,[841,845,849,854,858,862,866,870,874,878,882,887,891],{"type":405,"tag":430,"props":842,"children":843},{"style":507},[844],{"type":411,"value":547},{"type":405,"tag":430,"props":846,"children":847},{"style":459},[848],{"type":411,"value":515},{"type":405,"tag":430,"props":850,"children":851},{"style":453},[852],{"type":411,"value":853},"readdir",{"type":405,"tag":430,"props":855,"children":856},{"style":501},[857],{"type":411,"value":462},{"type":405,"tag":430,"props":859,"children":860},{"style":507},[861],{"type":411,"value":468},{"type":405,"tag":430,"props":863,"children":864},{"style":459},[865],{"type":411,"value":473},{"type":405,"tag":430,"props":867,"children":868},{"style":447},[869],{"type":411,"value":573},{"type":405,"tag":430,"props":871,"children":872},{"style":459},[873],{"type":411,"value":462},{"type":405,"tag":430,"props":875,"children":876},{"style":465},[877],{"type":411,"value":582},{"type":405,"tag":430,"props":879,"children":880},{"style":459},[881],{"type":411,"value":473},{"type":405,"tag":430,"props":883,"children":884},{"style":465},[885],{"type":411,"value":886}," files",{"type":405,"tag":430,"props":888,"children":889},{"style":459},[890],{"type":411,"value":483},{"type":405,"tag":430,"props":892,"children":893},{"style":459},[894],{"type":411,"value":488},{"type":405,"tag":430,"props":896,"children":898},{"class":432,"line":897},16,[899,904,908,912,917,922],{"type":405,"tag":430,"props":900,"children":901},{"style":495},[902],{"type":411,"value":903},"      if",{"type":405,"tag":430,"props":905,"children":906},{"style":501},[907],{"type":411,"value":504},{"type":405,"tag":430,"props":909,"children":910},{"style":507},[911],{"type":411,"value":582},{"type":405,"tag":430,"props":913,"children":914},{"style":501},[915],{"type":411,"value":916},") ",{"type":405,"tag":430,"props":918,"children":919},{"style":495},[920],{"type":411,"value":921},"throw",{"type":405,"tag":430,"props":923,"children":924},{"style":507},[925],{"type":411,"value":926}," err\n",{"type":405,"tag":430,"props":928,"children":930},{"class":432,"line":929},17,[931,936,940,945,949,953,957,962,966,971],{"type":405,"tag":430,"props":932,"children":933},{"style":507},[934],{"type":411,"value":935},"      files",{"type":405,"tag":430,"props":937,"children":938},{"style":459},[939],{"type":411,"value":515},{"type":405,"tag":430,"props":941,"children":942},{"style":453},[943],{"type":411,"value":944},"forEach",{"type":405,"tag":430,"props":946,"children":947},{"style":501},[948],{"type":411,"value":462},{"type":405,"tag":430,"props":950,"children":951},{"style":447},[952],{"type":411,"value":450},{"type":405,"tag":430,"props":954,"children":955},{"style":459},[956],{"type":411,"value":462},{"type":405,"tag":430,"props":958,"children":959},{"style":465},[960],{"type":411,"value":961},"n",{"type":405,"tag":430,"props":963,"children":964},{"style":459},[965],{"type":411,"value":483},{"type":405,"tag":430,"props":967,"children":968},{"style":459},[969],{"type":411,"value":970}," {",{"type":405,"tag":430,"props":972,"children":973},{"style":501},[974],{"type":411,"value":975}," \n",{"type":405,"tag":430,"props":977,"children":979},{"class":432,"line":978},18,[980,985,990,996,1001,1005,1009,1013,1017,1021,1026],{"type":405,"tag":430,"props":981,"children":982},{"style":447},[983],{"type":411,"value":984},"        var",{"type":405,"tag":430,"props":986,"children":987},{"style":507},[988],{"type":411,"value":989}," file",{"type":405,"tag":430,"props":991,"children":993},{"style":992},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[994],{"type":411,"value":995}," =",{"type":405,"tag":430,"props":997,"children":998},{"style":507},[999],{"type":411,"value":1000}," path",{"type":405,"tag":430,"props":1002,"children":1003},{"style":459},[1004],{"type":411,"value":515},{"type":405,"tag":430,"props":1006,"children":1007},{"style":453},[1008],{"type":411,"value":795},{"type":405,"tag":430,"props":1010,"children":1011},{"style":501},[1012],{"type":411,"value":462},{"type":405,"tag":430,"props":1014,"children":1015},{"style":507},[1016],{"type":411,"value":468},{"type":405,"tag":430,"props":1018,"children":1019},{"style":459},[1020],{"type":411,"value":473},{"type":405,"tag":430,"props":1022,"children":1023},{"style":507},[1024],{"type":411,"value":1025}," n",{"type":405,"tag":430,"props":1027,"children":1028},{"style":501},[1029],{"type":411,"value":622},{"type":405,"tag":430,"props":1031,"children":1033},{"class":432,"line":1032},19,[1034,1039,1044,1048,1052,1056,1060,1065,1070],{"type":405,"tag":430,"props":1035,"children":1036},{"style":495},[1037],{"type":411,"value":1038},"        if",{"type":405,"tag":430,"props":1040,"children":1041},{"style":501},[1042],{"type":411,"value":1043}," ( ",{"type":405,"tag":430,"props":1045,"children":1046},{"style":507},[1047],{"type":411,"value":510},{"type":405,"tag":430,"props":1049,"children":1050},{"style":459},[1051],{"type":411,"value":515},{"type":405,"tag":430,"props":1053,"children":1054},{"style":453},[1055],{"type":411,"value":678},{"type":405,"tag":430,"props":1057,"children":1058},{"style":501},[1059],{"type":411,"value":462},{"type":405,"tag":430,"props":1061,"children":1062},{"style":507},[1063],{"type":411,"value":1064},"file",{"type":405,"tag":430,"props":1066,"children":1067},{"style":501},[1068],{"type":411,"value":1069},") ) ",{"type":405,"tag":430,"props":1071,"children":1072},{"style":459},[1073],{"type":411,"value":538},{"type":405,"tag":430,"props":1075,"children":1077},{"class":432,"line":1076},20,[1078,1083,1087,1091,1095,1099],{"type":405,"tag":430,"props":1079,"children":1080},{"style":453},[1081],{"type":411,"value":1082},"          watch",{"type":405,"tag":430,"props":1084,"children":1085},{"style":501},[1086],{"type":411,"value":462},{"type":405,"tag":430,"props":1088,"children":1089},{"style":507},[1090],{"type":411,"value":1064},{"type":405,"tag":430,"props":1092,"children":1093},{"style":459},[1094],{"type":411,"value":473},{"type":405,"tag":430,"props":1096,"children":1097},{"style":507},[1098],{"type":411,"value":478},{"type":405,"tag":430,"props":1100,"children":1101},{"style":501},[1102],{"type":411,"value":622},{"type":405,"tag":430,"props":1104,"children":1106},{"class":432,"line":1105},21,[1107],{"type":405,"tag":430,"props":1108,"children":1109},{"style":459},[1110],{"type":411,"value":1111},"        }\n",{"type":405,"tag":430,"props":1113,"children":1115},{"class":432,"line":1114},22,[1116,1121],{"type":405,"tag":430,"props":1117,"children":1118},{"style":459},[1119],{"type":411,"value":1120},"      }",{"type":405,"tag":430,"props":1122,"children":1123},{"style":501},[1124],{"type":411,"value":622},{"type":405,"tag":430,"props":1126,"children":1128},{"class":432,"line":1127},23,[1129,1133],{"type":405,"tag":430,"props":1130,"children":1131},{"style":459},[1132],{"type":411,"value":631},{"type":405,"tag":430,"props":1134,"children":1135},{"style":501},[1136],{"type":411,"value":1137},")     \n",{"type":405,"tag":430,"props":1139,"children":1141},{"class":432,"line":1140},24,[1142],{"type":405,"tag":430,"props":1143,"children":1144},{"style":459},[1145],{"type":411,"value":653},{"type":405,"tag":430,"props":1147,"children":1149},{"class":432,"line":1148},25,[1150],{"type":405,"tag":430,"props":1151,"children":1152},{"style":459},[1153],{"type":411,"value":1154},"}\n",{"type":405,"tag":413,"props":1156,"children":1157},{},[1158,1160,1169],{"type":411,"value":1159},"由于 fs.watchFile 可能导致",{"type":405,"tag":1161,"props":1162,"children":1166},"a",{"href":1163,"rel":1164},"https://nodejs.org/api/fs.html#fs_fs_watchfile_filename_options_listener",[1165],"nofollow",[1167],{"type":411,"value":1168},"高 CPU 负载等问题",{"type":411,"value":1170},"，watch 文件时使用 watch 其父目录作替代，并通过匹配事件参数是否和此文件同名来判断是否要触发回调函数。",{"type":405,"tag":419,"props":1172,"children":1174},{"className":421,"code":1173,"language":423,"meta":398,"style":398},"if (is.file(fpath)) {\n  var parent = path.resolve(fpath, '..')\n  fs.watch(parent, function(evt, fname) {\n    if (path.basename(fpath) === fname) {\n      normalizeCall(fpath, options, cb)\n    }\n  })\n} \n",[1175],{"type":405,"tag":426,"props":1176,"children":1177},{"__ignoreMap":398},[1178,1208,1272,1330,1385,1421,1429,1441],{"type":405,"tag":430,"props":1179,"children":1180},{"class":432,"line":433},[1181,1186,1191,1195,1199,1204],{"type":405,"tag":430,"props":1182,"children":1183},{"style":495},[1184],{"type":411,"value":1185},"if",{"type":405,"tag":430,"props":1187,"children":1188},{"style":507},[1189],{"type":411,"value":1190}," (is",{"type":405,"tag":430,"props":1192,"children":1193},{"style":459},[1194],{"type":411,"value":515},{"type":405,"tag":430,"props":1196,"children":1197},{"style":453},[1198],{"type":411,"value":1064},{"type":405,"tag":430,"props":1200,"children":1201},{"style":507},[1202],{"type":411,"value":1203},"(fpath)) ",{"type":405,"tag":430,"props":1205,"children":1206},{"style":459},[1207],{"type":411,"value":538},{"type":405,"tag":430,"props":1209,"children":1210},{"class":432,"line":443},[1211,1216,1221,1225,1229,1233,1238,1242,1247,1251,1257,1263,1268],{"type":405,"tag":430,"props":1212,"children":1213},{"style":447},[1214],{"type":411,"value":1215},"  var",{"type":405,"tag":430,"props":1217,"children":1218},{"style":507},[1219],{"type":411,"value":1220}," parent",{"type":405,"tag":430,"props":1222,"children":1223},{"style":992},[1224],{"type":411,"value":995},{"type":405,"tag":430,"props":1226,"children":1227},{"style":507},[1228],{"type":411,"value":1000},{"type":405,"tag":430,"props":1230,"children":1231},{"style":459},[1232],{"type":411,"value":515},{"type":405,"tag":430,"props":1234,"children":1235},{"style":453},[1236],{"type":411,"value":1237},"resolve",{"type":405,"tag":430,"props":1239,"children":1240},{"style":501},[1241],{"type":411,"value":462},{"type":405,"tag":430,"props":1243,"children":1244},{"style":507},[1245],{"type":411,"value":1246},"fpath",{"type":405,"tag":430,"props":1248,"children":1249},{"style":459},[1250],{"type":411,"value":473},{"type":405,"tag":430,"props":1252,"children":1254},{"style":1253},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[1255],{"type":411,"value":1256}," '",{"type":405,"tag":430,"props":1258,"children":1260},{"style":1259},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[1261],{"type":411,"value":1262},"..",{"type":405,"tag":430,"props":1264,"children":1265},{"style":1253},[1266],{"type":411,"value":1267},"'",{"type":405,"tag":430,"props":1269,"children":1270},{"style":501},[1271],{"type":411,"value":622},{"type":405,"tag":430,"props":1273,"children":1274},{"class":432,"line":491},[1275,1280,1284,1288,1292,1297,1301,1305,1309,1314,1318,1322,1326],{"type":405,"tag":430,"props":1276,"children":1277},{"style":507},[1278],{"type":411,"value":1279},"  fs",{"type":405,"tag":430,"props":1281,"children":1282},{"style":459},[1283],{"type":411,"value":515},{"type":405,"tag":430,"props":1285,"children":1286},{"style":453},[1287],{"type":411,"value":711},{"type":405,"tag":430,"props":1289,"children":1290},{"style":501},[1291],{"type":411,"value":462},{"type":405,"tag":430,"props":1293,"children":1294},{"style":507},[1295],{"type":411,"value":1296},"parent",{"type":405,"tag":430,"props":1298,"children":1299},{"style":459},[1300],{"type":411,"value":473},{"type":405,"tag":430,"props":1302,"children":1303},{"style":447},[1304],{"type":411,"value":573},{"type":405,"tag":430,"props":1306,"children":1307},{"style":459},[1308],{"type":411,"value":462},{"type":405,"tag":430,"props":1310,"children":1311},{"style":465},[1312],{"type":411,"value":1313},"evt",{"type":405,"tag":430,"props":1315,"children":1316},{"style":459},[1317],{"type":411,"value":473},{"type":405,"tag":430,"props":1319,"children":1320},{"style":465},[1321],{"type":411,"value":744},{"type":405,"tag":430,"props":1323,"children":1324},{"style":459},[1325],{"type":411,"value":483},{"type":405,"tag":430,"props":1327,"children":1328},{"style":459},[1329],{"type":411,"value":488},{"type":405,"tag":430,"props":1331,"children":1332},{"class":432,"line":541},[1333,1338,1342,1347,1351,1356,1360,1364,1368,1373,1377,1381],{"type":405,"tag":430,"props":1334,"children":1335},{"style":495},[1336],{"type":411,"value":1337},"    if",{"type":405,"tag":430,"props":1339,"children":1340},{"style":501},[1341],{"type":411,"value":504},{"type":405,"tag":430,"props":1343,"children":1344},{"style":507},[1345],{"type":411,"value":1346},"path",{"type":405,"tag":430,"props":1348,"children":1349},{"style":459},[1350],{"type":411,"value":515},{"type":405,"tag":430,"props":1352,"children":1353},{"style":453},[1354],{"type":411,"value":1355},"basename",{"type":405,"tag":430,"props":1357,"children":1358},{"style":501},[1359],{"type":411,"value":462},{"type":405,"tag":430,"props":1361,"children":1362},{"style":507},[1363],{"type":411,"value":1246},{"type":405,"tag":430,"props":1365,"children":1366},{"style":501},[1367],{"type":411,"value":916},{"type":405,"tag":430,"props":1369,"children":1370},{"style":992},[1371],{"type":411,"value":1372},"===",{"type":405,"tag":430,"props":1374,"children":1375},{"style":507},[1376],{"type":411,"value":744},{"type":405,"tag":430,"props":1378,"children":1379},{"style":501},[1380],{"type":411,"value":916},{"type":405,"tag":430,"props":1382,"children":1383},{"style":459},[1384],{"type":411,"value":538},{"type":405,"tag":430,"props":1386,"children":1387},{"class":432,"line":593},[1388,1392,1396,1400,1404,1409,1413,1417],{"type":405,"tag":430,"props":1389,"children":1390},{"style":453},[1391],{"type":411,"value":599},{"type":405,"tag":430,"props":1393,"children":1394},{"style":501},[1395],{"type":411,"value":462},{"type":405,"tag":430,"props":1397,"children":1398},{"style":507},[1399],{"type":411,"value":1246},{"type":405,"tag":430,"props":1401,"children":1402},{"style":459},[1403],{"type":411,"value":473},{"type":405,"tag":430,"props":1405,"children":1406},{"style":507},[1407],{"type":411,"value":1408}," options",{"type":405,"tag":430,"props":1410,"children":1411},{"style":459},[1412],{"type":411,"value":473},{"type":405,"tag":430,"props":1414,"children":1415},{"style":507},[1416],{"type":411,"value":478},{"type":405,"tag":430,"props":1418,"children":1419},{"style":501},[1420],{"type":411,"value":622},{"type":405,"tag":430,"props":1422,"children":1423},{"class":432,"line":625},[1424],{"type":405,"tag":430,"props":1425,"children":1426},{"style":459},[1427],{"type":411,"value":1428},"    }\n",{"type":405,"tag":430,"props":1430,"children":1431},{"class":432,"line":638},[1432,1437],{"type":405,"tag":430,"props":1433,"children":1434},{"style":459},[1435],{"type":411,"value":1436},"  }",{"type":405,"tag":430,"props":1438,"children":1439},{"style":501},[1440],{"type":411,"value":622},{"type":405,"tag":430,"props":1442,"children":1443},{"class":432,"line":647},[1444],{"type":405,"tag":430,"props":1445,"children":1446},{"style":459},[1447],{"type":411,"value":1154},{"type":405,"tag":413,"props":1449,"children":1450},{},[1451],{"type":411,"value":1452},"如果目录中带有符号链接，node-watch 会默认跟踪下去，同时使用一个默认的 maxSymbolLevel 数字配置项，设置最大跟踪层数，防止死循环或性能问题。",{"type":405,"tag":419,"props":1454,"children":1456},{"className":421,"code":1455,"language":423,"meta":398,"style":398},"function watch(fpath, options, cb) {\n  if (is.symbolic(fpath) \n    && !(options.followSymLinks \n      && options.maxSymLevel--)) {\n    return\n  }\n}\n",[1457],{"type":405,"tag":426,"props":1458,"children":1459},{"__ignoreMap":398},[1460,1503,1540,1575,1609,1616,1623],{"type":405,"tag":430,"props":1461,"children":1462},{"class":432,"line":433},[1463,1467,1471,1475,1479,1483,1487,1491,1495,1499],{"type":405,"tag":430,"props":1464,"children":1465},{"style":447},[1466],{"type":411,"value":450},{"type":405,"tag":430,"props":1468,"children":1469},{"style":453},[1470],{"type":411,"value":456},{"type":405,"tag":430,"props":1472,"children":1473},{"style":459},[1474],{"type":411,"value":462},{"type":405,"tag":430,"props":1476,"children":1477},{"style":465},[1478],{"type":411,"value":1246},{"type":405,"tag":430,"props":1480,"children":1481},{"style":459},[1482],{"type":411,"value":473},{"type":405,"tag":430,"props":1484,"children":1485},{"style":465},[1486],{"type":411,"value":1408},{"type":405,"tag":430,"props":1488,"children":1489},{"style":459},[1490],{"type":411,"value":473},{"type":405,"tag":430,"props":1492,"children":1493},{"style":465},[1494],{"type":411,"value":478},{"type":405,"tag":430,"props":1496,"children":1497},{"style":459},[1498],{"type":411,"value":483},{"type":405,"tag":430,"props":1500,"children":1501},{"style":459},[1502],{"type":411,"value":488},{"type":405,"tag":430,"props":1504,"children":1505},{"class":432,"line":443},[1506,1510,1514,1518,1522,1527,1531,1535],{"type":405,"tag":430,"props":1507,"children":1508},{"style":495},[1509],{"type":411,"value":498},{"type":405,"tag":430,"props":1511,"children":1512},{"style":501},[1513],{"type":411,"value":504},{"type":405,"tag":430,"props":1515,"children":1516},{"style":507},[1517],{"type":411,"value":510},{"type":405,"tag":430,"props":1519,"children":1520},{"style":459},[1521],{"type":411,"value":515},{"type":405,"tag":430,"props":1523,"children":1524},{"style":453},[1525],{"type":411,"value":1526},"symbolic",{"type":405,"tag":430,"props":1528,"children":1529},{"style":501},[1530],{"type":411,"value":462},{"type":405,"tag":430,"props":1532,"children":1533},{"style":507},[1534],{"type":411,"value":1246},{"type":405,"tag":430,"props":1536,"children":1537},{"style":501},[1538],{"type":411,"value":1539},") \n",{"type":405,"tag":430,"props":1541,"children":1542},{"class":432,"line":491},[1543,1548,1553,1557,1562,1566,1571],{"type":405,"tag":430,"props":1544,"children":1545},{"style":992},[1546],{"type":411,"value":1547},"    &&",{"type":405,"tag":430,"props":1549,"children":1550},{"style":992},[1551],{"type":411,"value":1552}," !",{"type":405,"tag":430,"props":1554,"children":1555},{"style":501},[1556],{"type":411,"value":462},{"type":405,"tag":430,"props":1558,"children":1559},{"style":507},[1560],{"type":411,"value":1561},"options",{"type":405,"tag":430,"props":1563,"children":1564},{"style":459},[1565],{"type":411,"value":515},{"type":405,"tag":430,"props":1567,"children":1568},{"style":507},[1569],{"type":411,"value":1570},"followSymLinks",{"type":405,"tag":430,"props":1572,"children":1573},{"style":501},[1574],{"type":411,"value":975},{"type":405,"tag":430,"props":1576,"children":1577},{"class":432,"line":541},[1578,1583,1587,1591,1596,1601,1605],{"type":405,"tag":430,"props":1579,"children":1580},{"style":992},[1581],{"type":411,"value":1582},"      &&",{"type":405,"tag":430,"props":1584,"children":1585},{"style":507},[1586],{"type":411,"value":1408},{"type":405,"tag":430,"props":1588,"children":1589},{"style":459},[1590],{"type":411,"value":515},{"type":405,"tag":430,"props":1592,"children":1593},{"style":507},[1594],{"type":411,"value":1595},"maxSymLevel",{"type":405,"tag":430,"props":1597,"children":1598},{"style":992},[1599],{"type":411,"value":1600},"--",{"type":405,"tag":430,"props":1602,"children":1603},{"style":501},[1604],{"type":411,"value":533},{"type":405,"tag":430,"props":1606,"children":1607},{"style":459},[1608],{"type":411,"value":538},{"type":405,"tag":430,"props":1610,"children":1611},{"class":432,"line":593},[1612],{"type":405,"tag":430,"props":1613,"children":1614},{"style":495},[1615],{"type":411,"value":644},{"type":405,"tag":430,"props":1617,"children":1618},{"class":432,"line":625},[1619],{"type":405,"tag":430,"props":1620,"children":1621},{"style":459},[1622],{"type":411,"value":653},{"type":405,"tag":430,"props":1624,"children":1625},{"class":432,"line":638},[1626],{"type":405,"tag":430,"props":1627,"children":1628},{"style":459},[1629],{"type":411,"value":1154},{"type":405,"tag":413,"props":1631,"children":1632},{},[1633],{"type":411,"value":1634},"NodeJS 文档提到，fs.watch 的 recursive 选项在 Linux 中是无效的，因为 fs.watch 的实现依赖具体操作系统底层 API。所以到底要不要用原生的 recursive 选项需要提前判断一下，node-watch 的实现挺粗暴，直接使用 IO 操作去检测：先到系统临时文件目录创建一些文件夹，然后监听它们并删除里面的内容，如果超时了还没有触发 watcher 的 change 事件，那就说明不是原生支持 recursive 选项。",{"type":405,"tag":419,"props":1636,"children":1638},{"className":421,"code":1637,"language":423,"meta":398,"style":398},"var IS_SUPPORT\n\ntry {\n  watcher = fs.watch(parent, options)\n} catch (e) {\n  if (e.code == 'ERR_FEATURE_UNAVAILABLE_ON_PLATFORM') {\n    return fn(IS_SUPPORT = false)\n  } else {\n    throw e\n  }\n}\n\nvar timer = setTimeout(function() {\n  watcher.close()\n  stack.cleanup(function() {\n    fn(IS_SUPPORT = false)\n  })\n}, 200)\n\nwatcher.on('change', function(evt, name) {\n  if (path.basename(file) === path.basename(name)) {\n    watcher.close()\n    clearTimeout(timer)\n    stack.cleanup(function() {\n      fn(IS_SUPPORT = true)\n    })\n  }\n})\n",[1639],{"type":405,"tag":426,"props":1640,"children":1641},{"__ignoreMap":398},[1642,1656,1664,1676,1721,1743,1793,1829,1845,1858,1865,1872,1879,1918,1939,1972,2000,2011,2029,2036,2103,2171,2191,2212,2244,2273,2285,2293],{"type":405,"tag":430,"props":1643,"children":1644},{"class":432,"line":433},[1645,1650],{"type":405,"tag":430,"props":1646,"children":1647},{"style":447},[1648],{"type":411,"value":1649},"var",{"type":405,"tag":430,"props":1651,"children":1653},{"style":1652},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[1654],{"type":411,"value":1655}," IS_SUPPORT\n",{"type":405,"tag":430,"props":1657,"children":1658},{"class":432,"line":443},[1659],{"type":405,"tag":430,"props":1660,"children":1661},{"emptyLinePlaceholder":397},[1662],{"type":411,"value":1663},"\n",{"type":405,"tag":430,"props":1665,"children":1666},{"class":432,"line":491},[1667,1672],{"type":405,"tag":430,"props":1668,"children":1669},{"style":495},[1670],{"type":411,"value":1671},"try",{"type":405,"tag":430,"props":1673,"children":1674},{"style":459},[1675],{"type":411,"value":488},{"type":405,"tag":430,"props":1677,"children":1678},{"class":432,"line":541},[1679,1684,1688,1693,1697,1701,1705,1709,1713,1717],{"type":405,"tag":430,"props":1680,"children":1681},{"style":507},[1682],{"type":411,"value":1683},"  watcher",{"type":405,"tag":430,"props":1685,"children":1686},{"style":992},[1687],{"type":411,"value":995},{"type":405,"tag":430,"props":1689,"children":1690},{"style":507},[1691],{"type":411,"value":1692}," fs",{"type":405,"tag":430,"props":1694,"children":1695},{"style":459},[1696],{"type":411,"value":515},{"type":405,"tag":430,"props":1698,"children":1699},{"style":453},[1700],{"type":411,"value":711},{"type":405,"tag":430,"props":1702,"children":1703},{"style":501},[1704],{"type":411,"value":462},{"type":405,"tag":430,"props":1706,"children":1707},{"style":507},[1708],{"type":411,"value":1296},{"type":405,"tag":430,"props":1710,"children":1711},{"style":459},[1712],{"type":411,"value":473},{"type":405,"tag":430,"props":1714,"children":1715},{"style":507},[1716],{"type":411,"value":1408},{"type":405,"tag":430,"props":1718,"children":1719},{"style":501},[1720],{"type":411,"value":622},{"type":405,"tag":430,"props":1722,"children":1723},{"class":432,"line":593},[1724,1729,1734,1739],{"type":405,"tag":430,"props":1725,"children":1726},{"style":459},[1727],{"type":411,"value":1728},"}",{"type":405,"tag":430,"props":1730,"children":1731},{"style":495},[1732],{"type":411,"value":1733}," catch",{"type":405,"tag":430,"props":1735,"children":1736},{"style":507},[1737],{"type":411,"value":1738}," (e) ",{"type":405,"tag":430,"props":1740,"children":1741},{"style":459},[1742],{"type":411,"value":538},{"type":405,"tag":430,"props":1744,"children":1745},{"class":432,"line":625},[1746,1750,1754,1759,1763,1767,1772,1776,1781,1785,1789],{"type":405,"tag":430,"props":1747,"children":1748},{"style":495},[1749],{"type":411,"value":498},{"type":405,"tag":430,"props":1751,"children":1752},{"style":501},[1753],{"type":411,"value":504},{"type":405,"tag":430,"props":1755,"children":1756},{"style":507},[1757],{"type":411,"value":1758},"e",{"type":405,"tag":430,"props":1760,"children":1761},{"style":459},[1762],{"type":411,"value":515},{"type":405,"tag":430,"props":1764,"children":1765},{"style":507},[1766],{"type":411,"value":426},{"type":405,"tag":430,"props":1768,"children":1769},{"style":992},[1770],{"type":411,"value":1771}," ==",{"type":405,"tag":430,"props":1773,"children":1774},{"style":1253},[1775],{"type":411,"value":1256},{"type":405,"tag":430,"props":1777,"children":1778},{"style":1259},[1779],{"type":411,"value":1780},"ERR_FEATURE_UNAVAILABLE_ON_PLATFORM",{"type":405,"tag":430,"props":1782,"children":1783},{"style":1253},[1784],{"type":411,"value":1267},{"type":405,"tag":430,"props":1786,"children":1787},{"style":501},[1788],{"type":411,"value":916},{"type":405,"tag":430,"props":1790,"children":1791},{"style":459},[1792],{"type":411,"value":538},{"type":405,"tag":430,"props":1794,"children":1795},{"class":432,"line":638},[1796,1801,1806,1810,1815,1819,1825],{"type":405,"tag":430,"props":1797,"children":1798},{"style":495},[1799],{"type":411,"value":1800},"    return",{"type":405,"tag":430,"props":1802,"children":1803},{"style":453},[1804],{"type":411,"value":1805}," fn",{"type":405,"tag":430,"props":1807,"children":1808},{"style":501},[1809],{"type":411,"value":462},{"type":405,"tag":430,"props":1811,"children":1812},{"style":1652},[1813],{"type":411,"value":1814},"IS_SUPPORT",{"type":405,"tag":430,"props":1816,"children":1817},{"style":992},[1818],{"type":411,"value":995},{"type":405,"tag":430,"props":1820,"children":1822},{"style":1821},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1823],{"type":411,"value":1824}," false",{"type":405,"tag":430,"props":1826,"children":1827},{"style":501},[1828],{"type":411,"value":622},{"type":405,"tag":430,"props":1830,"children":1831},{"class":432,"line":647},[1832,1836,1841],{"type":405,"tag":430,"props":1833,"children":1834},{"style":459},[1835],{"type":411,"value":1436},{"type":405,"tag":430,"props":1837,"children":1838},{"style":495},[1839],{"type":411,"value":1840}," else",{"type":405,"tag":430,"props":1842,"children":1843},{"style":459},[1844],{"type":411,"value":488},{"type":405,"tag":430,"props":1846,"children":1847},{"class":432,"line":656},[1848,1853],{"type":405,"tag":430,"props":1849,"children":1850},{"style":495},[1851],{"type":411,"value":1852},"    throw",{"type":405,"tag":430,"props":1854,"children":1855},{"style":507},[1856],{"type":411,"value":1857}," e\n",{"type":405,"tag":430,"props":1859,"children":1860},{"class":432,"line":697},[1861],{"type":405,"tag":430,"props":1862,"children":1863},{"style":459},[1864],{"type":411,"value":653},{"type":405,"tag":430,"props":1866,"children":1867},{"class":432,"line":755},[1868],{"type":405,"tag":430,"props":1869,"children":1870},{"style":459},[1871],{"type":411,"value":1154},{"type":405,"tag":430,"props":1873,"children":1874},{"class":432,"line":780},[1875],{"type":405,"tag":430,"props":1876,"children":1877},{"emptyLinePlaceholder":397},[1878],{"type":411,"value":1663},{"type":405,"tag":430,"props":1880,"children":1881},{"class":432,"line":818},[1882,1886,1891,1896,1901,1905,1909,1914],{"type":405,"tag":430,"props":1883,"children":1884},{"style":447},[1885],{"type":411,"value":1649},{"type":405,"tag":430,"props":1887,"children":1888},{"style":507},[1889],{"type":411,"value":1890}," timer ",{"type":405,"tag":430,"props":1892,"children":1893},{"style":992},[1894],{"type":411,"value":1895},"=",{"type":405,"tag":430,"props":1897,"children":1898},{"style":453},[1899],{"type":411,"value":1900}," setTimeout",{"type":405,"tag":430,"props":1902,"children":1903},{"style":507},[1904],{"type":411,"value":462},{"type":405,"tag":430,"props":1906,"children":1907},{"style":447},[1908],{"type":411,"value":450},{"type":405,"tag":430,"props":1910,"children":1911},{"style":459},[1912],{"type":411,"value":1913},"()",{"type":405,"tag":430,"props":1915,"children":1916},{"style":459},[1917],{"type":411,"value":488},{"type":405,"tag":430,"props":1919,"children":1920},{"class":432,"line":827},[1921,1925,1929,1934],{"type":405,"tag":430,"props":1922,"children":1923},{"style":507},[1924],{"type":411,"value":1683},{"type":405,"tag":430,"props":1926,"children":1927},{"style":459},[1928],{"type":411,"value":515},{"type":405,"tag":430,"props":1930,"children":1931},{"style":453},[1932],{"type":411,"value":1933},"close",{"type":405,"tag":430,"props":1935,"children":1936},{"style":501},[1937],{"type":411,"value":1938},"()\n",{"type":405,"tag":430,"props":1940,"children":1941},{"class":432,"line":839},[1942,1947,1951,1956,1960,1964,1968],{"type":405,"tag":430,"props":1943,"children":1944},{"style":507},[1945],{"type":411,"value":1946},"  stack",{"type":405,"tag":430,"props":1948,"children":1949},{"style":459},[1950],{"type":411,"value":515},{"type":405,"tag":430,"props":1952,"children":1953},{"style":453},[1954],{"type":411,"value":1955},"cleanup",{"type":405,"tag":430,"props":1957,"children":1958},{"style":501},[1959],{"type":411,"value":462},{"type":405,"tag":430,"props":1961,"children":1962},{"style":447},[1963],{"type":411,"value":450},{"type":405,"tag":430,"props":1965,"children":1966},{"style":459},[1967],{"type":411,"value":1913},{"type":405,"tag":430,"props":1969,"children":1970},{"style":459},[1971],{"type":411,"value":488},{"type":405,"tag":430,"props":1973,"children":1974},{"class":432,"line":897},[1975,1980,1984,1988,1992,1996],{"type":405,"tag":430,"props":1976,"children":1977},{"style":453},[1978],{"type":411,"value":1979},"    fn",{"type":405,"tag":430,"props":1981,"children":1982},{"style":501},[1983],{"type":411,"value":462},{"type":405,"tag":430,"props":1985,"children":1986},{"style":1652},[1987],{"type":411,"value":1814},{"type":405,"tag":430,"props":1989,"children":1990},{"style":992},[1991],{"type":411,"value":995},{"type":405,"tag":430,"props":1993,"children":1994},{"style":1821},[1995],{"type":411,"value":1824},{"type":405,"tag":430,"props":1997,"children":1998},{"style":501},[1999],{"type":411,"value":622},{"type":405,"tag":430,"props":2001,"children":2002},{"class":432,"line":929},[2003,2007],{"type":405,"tag":430,"props":2004,"children":2005},{"style":459},[2006],{"type":411,"value":1436},{"type":405,"tag":430,"props":2008,"children":2009},{"style":501},[2010],{"type":411,"value":622},{"type":405,"tag":430,"props":2012,"children":2013},{"class":432,"line":978},[2014,2019,2025],{"type":405,"tag":430,"props":2015,"children":2016},{"style":459},[2017],{"type":411,"value":2018},"},",{"type":405,"tag":430,"props":2020,"children":2022},{"style":2021},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2023],{"type":411,"value":2024}," 200",{"type":405,"tag":430,"props":2026,"children":2027},{"style":507},[2028],{"type":411,"value":622},{"type":405,"tag":430,"props":2030,"children":2031},{"class":432,"line":1032},[2032],{"type":405,"tag":430,"props":2033,"children":2034},{"emptyLinePlaceholder":397},[2035],{"type":411,"value":1663},{"type":405,"tag":430,"props":2037,"children":2038},{"class":432,"line":1076},[2039,2044,2048,2053,2057,2061,2066,2070,2074,2078,2082,2086,2090,2095,2099],{"type":405,"tag":430,"props":2040,"children":2041},{"style":507},[2042],{"type":411,"value":2043},"watcher",{"type":405,"tag":430,"props":2045,"children":2046},{"style":459},[2047],{"type":411,"value":515},{"type":405,"tag":430,"props":2049,"children":2050},{"style":453},[2051],{"type":411,"value":2052},"on",{"type":405,"tag":430,"props":2054,"children":2055},{"style":507},[2056],{"type":411,"value":462},{"type":405,"tag":430,"props":2058,"children":2059},{"style":1253},[2060],{"type":411,"value":1267},{"type":405,"tag":430,"props":2062,"children":2063},{"style":1259},[2064],{"type":411,"value":2065},"change",{"type":405,"tag":430,"props":2067,"children":2068},{"style":1253},[2069],{"type":411,"value":1267},{"type":405,"tag":430,"props":2071,"children":2072},{"style":459},[2073],{"type":411,"value":473},{"type":405,"tag":430,"props":2075,"children":2076},{"style":447},[2077],{"type":411,"value":573},{"type":405,"tag":430,"props":2079,"children":2080},{"style":459},[2081],{"type":411,"value":462},{"type":405,"tag":430,"props":2083,"children":2084},{"style":465},[2085],{"type":411,"value":1313},{"type":405,"tag":430,"props":2087,"children":2088},{"style":459},[2089],{"type":411,"value":473},{"type":405,"tag":430,"props":2091,"children":2092},{"style":465},[2093],{"type":411,"value":2094}," name",{"type":405,"tag":430,"props":2096,"children":2097},{"style":459},[2098],{"type":411,"value":483},{"type":405,"tag":430,"props":2100,"children":2101},{"style":459},[2102],{"type":411,"value":488},{"type":405,"tag":430,"props":2104,"children":2105},{"class":432,"line":1105},[2106,2110,2114,2118,2122,2126,2130,2134,2138,2142,2146,2150,2154,2158,2163,2167],{"type":405,"tag":430,"props":2107,"children":2108},{"style":495},[2109],{"type":411,"value":498},{"type":405,"tag":430,"props":2111,"children":2112},{"style":501},[2113],{"type":411,"value":504},{"type":405,"tag":430,"props":2115,"children":2116},{"style":507},[2117],{"type":411,"value":1346},{"type":405,"tag":430,"props":2119,"children":2120},{"style":459},[2121],{"type":411,"value":515},{"type":405,"tag":430,"props":2123,"children":2124},{"style":453},[2125],{"type":411,"value":1355},{"type":405,"tag":430,"props":2127,"children":2128},{"style":501},[2129],{"type":411,"value":462},{"type":405,"tag":430,"props":2131,"children":2132},{"style":507},[2133],{"type":411,"value":1064},{"type":405,"tag":430,"props":2135,"children":2136},{"style":501},[2137],{"type":411,"value":916},{"type":405,"tag":430,"props":2139,"children":2140},{"style":992},[2141],{"type":411,"value":1372},{"type":405,"tag":430,"props":2143,"children":2144},{"style":507},[2145],{"type":411,"value":1000},{"type":405,"tag":430,"props":2147,"children":2148},{"style":459},[2149],{"type":411,"value":515},{"type":405,"tag":430,"props":2151,"children":2152},{"style":453},[2153],{"type":411,"value":1355},{"type":405,"tag":430,"props":2155,"children":2156},{"style":501},[2157],{"type":411,"value":462},{"type":405,"tag":430,"props":2159,"children":2160},{"style":507},[2161],{"type":411,"value":2162},"name",{"type":405,"tag":430,"props":2164,"children":2165},{"style":501},[2166],{"type":411,"value":533},{"type":405,"tag":430,"props":2168,"children":2169},{"style":459},[2170],{"type":411,"value":538},{"type":405,"tag":430,"props":2172,"children":2173},{"class":432,"line":1114},[2174,2179,2183,2187],{"type":405,"tag":430,"props":2175,"children":2176},{"style":507},[2177],{"type":411,"value":2178},"    watcher",{"type":405,"tag":430,"props":2180,"children":2181},{"style":459},[2182],{"type":411,"value":515},{"type":405,"tag":430,"props":2184,"children":2185},{"style":453},[2186],{"type":411,"value":1933},{"type":405,"tag":430,"props":2188,"children":2189},{"style":501},[2190],{"type":411,"value":1938},{"type":405,"tag":430,"props":2192,"children":2193},{"class":432,"line":1127},[2194,2199,2203,2208],{"type":405,"tag":430,"props":2195,"children":2196},{"style":453},[2197],{"type":411,"value":2198},"    clearTimeout",{"type":405,"tag":430,"props":2200,"children":2201},{"style":501},[2202],{"type":411,"value":462},{"type":405,"tag":430,"props":2204,"children":2205},{"style":507},[2206],{"type":411,"value":2207},"timer",{"type":405,"tag":430,"props":2209,"children":2210},{"style":501},[2211],{"type":411,"value":622},{"type":405,"tag":430,"props":2213,"children":2214},{"class":432,"line":1140},[2215,2220,2224,2228,2232,2236,2240],{"type":405,"tag":430,"props":2216,"children":2217},{"style":507},[2218],{"type":411,"value":2219},"    stack",{"type":405,"tag":430,"props":2221,"children":2222},{"style":459},[2223],{"type":411,"value":515},{"type":405,"tag":430,"props":2225,"children":2226},{"style":453},[2227],{"type":411,"value":1955},{"type":405,"tag":430,"props":2229,"children":2230},{"style":501},[2231],{"type":411,"value":462},{"type":405,"tag":430,"props":2233,"children":2234},{"style":447},[2235],{"type":411,"value":450},{"type":405,"tag":430,"props":2237,"children":2238},{"style":459},[2239],{"type":411,"value":1913},{"type":405,"tag":430,"props":2241,"children":2242},{"style":459},[2243],{"type":411,"value":488},{"type":405,"tag":430,"props":2245,"children":2246},{"class":432,"line":1148},[2247,2252,2256,2260,2264,2269],{"type":405,"tag":430,"props":2248,"children":2249},{"style":453},[2250],{"type":411,"value":2251},"      fn",{"type":405,"tag":430,"props":2253,"children":2254},{"style":501},[2255],{"type":411,"value":462},{"type":405,"tag":430,"props":2257,"children":2258},{"style":1652},[2259],{"type":411,"value":1814},{"type":405,"tag":430,"props":2261,"children":2262},{"style":992},[2263],{"type":411,"value":995},{"type":405,"tag":430,"props":2265,"children":2266},{"style":1821},[2267],{"type":411,"value":2268}," true",{"type":405,"tag":430,"props":2270,"children":2271},{"style":501},[2272],{"type":411,"value":622},{"type":405,"tag":430,"props":2274,"children":2276},{"class":432,"line":2275},26,[2277,2281],{"type":405,"tag":430,"props":2278,"children":2279},{"style":459},[2280],{"type":411,"value":631},{"type":405,"tag":430,"props":2282,"children":2283},{"style":501},[2284],{"type":411,"value":622},{"type":405,"tag":430,"props":2286,"children":2288},{"class":432,"line":2287},27,[2289],{"type":405,"tag":430,"props":2290,"children":2291},{"style":459},[2292],{"type":411,"value":653},{"type":405,"tag":430,"props":2294,"children":2296},{"class":432,"line":2295},28,[2297,2301],{"type":405,"tag":430,"props":2298,"children":2299},{"style":459},[2300],{"type":411,"value":1728},{"type":405,"tag":430,"props":2302,"children":2303},{"style":507},[2304],{"type":411,"value":622},{"type":405,"tag":413,"props":2306,"children":2307},{},[2308],{"type":411,"value":2309},"Watcher 仅向外暴露指定方法。",{"type":405,"tag":419,"props":2311,"children":2313},{"className":421,"code":2312,"language":423,"meta":398,"style":398},"Watcher.prototype.expose = function() {\n  var expose = {}\n  var self = this\n  var methods = [\n    'on', 'emit', 'once',\n    'close', 'isClosed',\n    'listeners', 'setMaxListeners', 'getMaxListeners',\n    'getWatchedPaths'\n  ]\n  methods.forEach(function(name) {\n    expose[name] = function() {\n      return self[name].apply(self, arguments)\n    }\n  })\n  return expose\n}\n",[2314],{"type":405,"tag":426,"props":2315,"children":2316},{"__ignoreMap":398},[2317,2360,2381,2403,2424,2479,2515,2569,2586,2594,2634,2672,2729,2736,2747,2760],{"type":405,"tag":430,"props":2318,"children":2319},{"class":432,"line":433},[2320,2326,2330,2335,2339,2344,2348,2352,2356],{"type":405,"tag":430,"props":2321,"children":2323},{"style":2322},"--shiki-light:#E2931D;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[2324],{"type":411,"value":2325},"Watcher",{"type":405,"tag":430,"props":2327,"children":2328},{"style":459},[2329],{"type":411,"value":515},{"type":405,"tag":430,"props":2331,"children":2332},{"style":1652},[2333],{"type":411,"value":2334},"prototype",{"type":405,"tag":430,"props":2336,"children":2337},{"style":459},[2338],{"type":411,"value":515},{"type":405,"tag":430,"props":2340,"children":2341},{"style":453},[2342],{"type":411,"value":2343},"expose",{"type":405,"tag":430,"props":2345,"children":2346},{"style":992},[2347],{"type":411,"value":995},{"type":405,"tag":430,"props":2349,"children":2350},{"style":447},[2351],{"type":411,"value":573},{"type":405,"tag":430,"props":2353,"children":2354},{"style":459},[2355],{"type":411,"value":1913},{"type":405,"tag":430,"props":2357,"children":2358},{"style":459},[2359],{"type":411,"value":488},{"type":405,"tag":430,"props":2361,"children":2362},{"class":432,"line":443},[2363,2367,2372,2376],{"type":405,"tag":430,"props":2364,"children":2365},{"style":447},[2366],{"type":411,"value":1215},{"type":405,"tag":430,"props":2368,"children":2369},{"style":507},[2370],{"type":411,"value":2371}," expose",{"type":405,"tag":430,"props":2373,"children":2374},{"style":992},[2375],{"type":411,"value":995},{"type":405,"tag":430,"props":2377,"children":2378},{"style":459},[2379],{"type":411,"value":2380}," {}\n",{"type":405,"tag":430,"props":2382,"children":2383},{"class":432,"line":491},[2384,2388,2393,2397],{"type":405,"tag":430,"props":2385,"children":2386},{"style":447},[2387],{"type":411,"value":1215},{"type":405,"tag":430,"props":2389,"children":2390},{"style":507},[2391],{"type":411,"value":2392}," self",{"type":405,"tag":430,"props":2394,"children":2395},{"style":992},[2396],{"type":411,"value":995},{"type":405,"tag":430,"props":2398,"children":2400},{"style":2399},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[2401],{"type":411,"value":2402}," this\n",{"type":405,"tag":430,"props":2404,"children":2405},{"class":432,"line":541},[2406,2410,2415,2419],{"type":405,"tag":430,"props":2407,"children":2408},{"style":447},[2409],{"type":411,"value":1215},{"type":405,"tag":430,"props":2411,"children":2412},{"style":507},[2413],{"type":411,"value":2414}," methods",{"type":405,"tag":430,"props":2416,"children":2417},{"style":992},[2418],{"type":411,"value":995},{"type":405,"tag":430,"props":2420,"children":2421},{"style":501},[2422],{"type":411,"value":2423}," [\n",{"type":405,"tag":430,"props":2425,"children":2426},{"class":432,"line":593},[2427,2432,2436,2440,2444,2448,2453,2457,2461,2465,2470,2474],{"type":405,"tag":430,"props":2428,"children":2429},{"style":1253},[2430],{"type":411,"value":2431},"    '",{"type":405,"tag":430,"props":2433,"children":2434},{"style":1259},[2435],{"type":411,"value":2052},{"type":405,"tag":430,"props":2437,"children":2438},{"style":1253},[2439],{"type":411,"value":1267},{"type":405,"tag":430,"props":2441,"children":2442},{"style":459},[2443],{"type":411,"value":473},{"type":405,"tag":430,"props":2445,"children":2446},{"style":1253},[2447],{"type":411,"value":1256},{"type":405,"tag":430,"props":2449,"children":2450},{"style":1259},[2451],{"type":411,"value":2452},"emit",{"type":405,"tag":430,"props":2454,"children":2455},{"style":1253},[2456],{"type":411,"value":1267},{"type":405,"tag":430,"props":2458,"children":2459},{"style":459},[2460],{"type":411,"value":473},{"type":405,"tag":430,"props":2462,"children":2463},{"style":1253},[2464],{"type":411,"value":1256},{"type":405,"tag":430,"props":2466,"children":2467},{"style":1259},[2468],{"type":411,"value":2469},"once",{"type":405,"tag":430,"props":2471,"children":2472},{"style":1253},[2473],{"type":411,"value":1267},{"type":405,"tag":430,"props":2475,"children":2476},{"style":459},[2477],{"type":411,"value":2478},",\n",{"type":405,"tag":430,"props":2480,"children":2481},{"class":432,"line":625},[2482,2486,2490,2494,2498,2502,2507,2511],{"type":405,"tag":430,"props":2483,"children":2484},{"style":1253},[2485],{"type":411,"value":2431},{"type":405,"tag":430,"props":2487,"children":2488},{"style":1259},[2489],{"type":411,"value":1933},{"type":405,"tag":430,"props":2491,"children":2492},{"style":1253},[2493],{"type":411,"value":1267},{"type":405,"tag":430,"props":2495,"children":2496},{"style":459},[2497],{"type":411,"value":473},{"type":405,"tag":430,"props":2499,"children":2500},{"style":1253},[2501],{"type":411,"value":1256},{"type":405,"tag":430,"props":2503,"children":2504},{"style":1259},[2505],{"type":411,"value":2506},"isClosed",{"type":405,"tag":430,"props":2508,"children":2509},{"style":1253},[2510],{"type":411,"value":1267},{"type":405,"tag":430,"props":2512,"children":2513},{"style":459},[2514],{"type":411,"value":2478},{"type":405,"tag":430,"props":2516,"children":2517},{"class":432,"line":638},[2518,2522,2527,2531,2535,2539,2544,2548,2552,2556,2561,2565],{"type":405,"tag":430,"props":2519,"children":2520},{"style":1253},[2521],{"type":411,"value":2431},{"type":405,"tag":430,"props":2523,"children":2524},{"style":1259},[2525],{"type":411,"value":2526},"listeners",{"type":405,"tag":430,"props":2528,"children":2529},{"style":1253},[2530],{"type":411,"value":1267},{"type":405,"tag":430,"props":2532,"children":2533},{"style":459},[2534],{"type":411,"value":473},{"type":405,"tag":430,"props":2536,"children":2537},{"style":1253},[2538],{"type":411,"value":1256},{"type":405,"tag":430,"props":2540,"children":2541},{"style":1259},[2542],{"type":411,"value":2543},"setMaxListeners",{"type":405,"tag":430,"props":2545,"children":2546},{"style":1253},[2547],{"type":411,"value":1267},{"type":405,"tag":430,"props":2549,"children":2550},{"style":459},[2551],{"type":411,"value":473},{"type":405,"tag":430,"props":2553,"children":2554},{"style":1253},[2555],{"type":411,"value":1256},{"type":405,"tag":430,"props":2557,"children":2558},{"style":1259},[2559],{"type":411,"value":2560},"getMaxListeners",{"type":405,"tag":430,"props":2562,"children":2563},{"style":1253},[2564],{"type":411,"value":1267},{"type":405,"tag":430,"props":2566,"children":2567},{"style":459},[2568],{"type":411,"value":2478},{"type":405,"tag":430,"props":2570,"children":2571},{"class":432,"line":647},[2572,2576,2581],{"type":405,"tag":430,"props":2573,"children":2574},{"style":1253},[2575],{"type":411,"value":2431},{"type":405,"tag":430,"props":2577,"children":2578},{"style":1259},[2579],{"type":411,"value":2580},"getWatchedPaths",{"type":405,"tag":430,"props":2582,"children":2583},{"style":1253},[2584],{"type":411,"value":2585},"'\n",{"type":405,"tag":430,"props":2587,"children":2588},{"class":432,"line":656},[2589],{"type":405,"tag":430,"props":2590,"children":2591},{"style":501},[2592],{"type":411,"value":2593},"  ]\n",{"type":405,"tag":430,"props":2595,"children":2596},{"class":432,"line":697},[2597,2602,2606,2610,2614,2618,2622,2626,2630],{"type":405,"tag":430,"props":2598,"children":2599},{"style":507},[2600],{"type":411,"value":2601},"  methods",{"type":405,"tag":430,"props":2603,"children":2604},{"style":459},[2605],{"type":411,"value":515},{"type":405,"tag":430,"props":2607,"children":2608},{"style":453},[2609],{"type":411,"value":944},{"type":405,"tag":430,"props":2611,"children":2612},{"style":501},[2613],{"type":411,"value":462},{"type":405,"tag":430,"props":2615,"children":2616},{"style":447},[2617],{"type":411,"value":450},{"type":405,"tag":430,"props":2619,"children":2620},{"style":459},[2621],{"type":411,"value":462},{"type":405,"tag":430,"props":2623,"children":2624},{"style":465},[2625],{"type":411,"value":2162},{"type":405,"tag":430,"props":2627,"children":2628},{"style":459},[2629],{"type":411,"value":483},{"type":405,"tag":430,"props":2631,"children":2632},{"style":459},[2633],{"type":411,"value":488},{"type":405,"tag":430,"props":2635,"children":2636},{"class":432,"line":755},[2637,2642,2647,2651,2656,2660,2664,2668],{"type":405,"tag":430,"props":2638,"children":2639},{"style":507},[2640],{"type":411,"value":2641},"    expose",{"type":405,"tag":430,"props":2643,"children":2644},{"style":501},[2645],{"type":411,"value":2646},"[",{"type":405,"tag":430,"props":2648,"children":2649},{"style":507},[2650],{"type":411,"value":2162},{"type":405,"tag":430,"props":2652,"children":2653},{"style":501},[2654],{"type":411,"value":2655},"] ",{"type":405,"tag":430,"props":2657,"children":2658},{"style":992},[2659],{"type":411,"value":1895},{"type":405,"tag":430,"props":2661,"children":2662},{"style":447},[2663],{"type":411,"value":573},{"type":405,"tag":430,"props":2665,"children":2666},{"style":459},[2667],{"type":411,"value":1913},{"type":405,"tag":430,"props":2669,"children":2670},{"style":459},[2671],{"type":411,"value":488},{"type":405,"tag":430,"props":2673,"children":2674},{"class":432,"line":780},[2675,2680,2684,2688,2692,2697,2701,2706,2710,2715,2719,2725],{"type":405,"tag":430,"props":2676,"children":2677},{"style":495},[2678],{"type":411,"value":2679},"      return",{"type":405,"tag":430,"props":2681,"children":2682},{"style":507},[2683],{"type":411,"value":2392},{"type":405,"tag":430,"props":2685,"children":2686},{"style":501},[2687],{"type":411,"value":2646},{"type":405,"tag":430,"props":2689,"children":2690},{"style":507},[2691],{"type":411,"value":2162},{"type":405,"tag":430,"props":2693,"children":2694},{"style":501},[2695],{"type":411,"value":2696},"]",{"type":405,"tag":430,"props":2698,"children":2699},{"style":459},[2700],{"type":411,"value":515},{"type":405,"tag":430,"props":2702,"children":2703},{"style":453},[2704],{"type":411,"value":2705},"apply",{"type":405,"tag":430,"props":2707,"children":2708},{"style":501},[2709],{"type":411,"value":462},{"type":405,"tag":430,"props":2711,"children":2712},{"style":507},[2713],{"type":411,"value":2714},"self",{"type":405,"tag":430,"props":2716,"children":2717},{"style":459},[2718],{"type":411,"value":473},{"type":405,"tag":430,"props":2720,"children":2722},{"style":2721},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[2723],{"type":411,"value":2724}," arguments",{"type":405,"tag":430,"props":2726,"children":2727},{"style":501},[2728],{"type":411,"value":622},{"type":405,"tag":430,"props":2730,"children":2731},{"class":432,"line":818},[2732],{"type":405,"tag":430,"props":2733,"children":2734},{"style":459},[2735],{"type":411,"value":1428},{"type":405,"tag":430,"props":2737,"children":2738},{"class":432,"line":827},[2739,2743],{"type":405,"tag":430,"props":2740,"children":2741},{"style":459},[2742],{"type":411,"value":1436},{"type":405,"tag":430,"props":2744,"children":2745},{"style":501},[2746],{"type":411,"value":622},{"type":405,"tag":430,"props":2748,"children":2749},{"class":432,"line":839},[2750,2755],{"type":405,"tag":430,"props":2751,"children":2752},{"style":495},[2753],{"type":411,"value":2754},"  return",{"type":405,"tag":430,"props":2756,"children":2757},{"style":507},[2758],{"type":411,"value":2759}," expose\n",{"type":405,"tag":430,"props":2761,"children":2762},{"class":432,"line":897},[2763],{"type":405,"tag":430,"props":2764,"children":2765},{"style":459},[2766],{"type":411,"value":1154},{"type":405,"tag":413,"props":2768,"children":2769},{},[2770],{"type":411,"value":2771},"监听路径支持传数组，我们当然希望就算是数组，也是由同一个 EventEmitter 来管理事件的，传入的是既然是数组，那么自然会生成多个 watcher 实例，只不过代码中使用了 composeWatcher 函数，把这些事件整合并向外发送。",{"type":405,"tag":419,"props":2773,"children":2775},{"className":421,"code":2774,"language":423,"meta":398,"style":398},"function composeWatcher(watchers) {\n  // 使用一个新的 watcher 整合事件列表\n  var watcher = new Watcher()\n  var filterDups = createDupsFilter()\n  var counter = watchers.length\n\n  watchers.forEach(function(w) {\n    w.on('change', filterDups(function(evt, name) {\n      watcher.emit('change', evt, name)\n    }))\n    w.on('error', function(err) {\n      watcher.emit('error', err)\n    })\n    w.on('ready', function() {\n      if (!(--counter)) {\n        emitReady(watcher)\n      }\n    })\n  })\n\n  watcher.close = function() {\n    watchers.forEach(function(w) {\n      w.close()\n    })\n    process.nextTick(emitClose, watcher)\n  }\n\n  watcher.getWatchedPaths = function(fn) {\n    if (is.func(fn)) {\n      var promises = watchers.map(function(w) {\n        return new Promise(function(resolve) {\n          w.getWatchedPaths(resolve)\n        })\n      })\n      Promise.all(promises).then(function(result) {\n        var ret = unique(flat1(result))\n        fn(ret)\n      })\n    }\n  }\n\n  return watcher.expose()\n}\n",[2776],{"type":405,"tag":426,"props":2777,"children":2778},{"__ignoreMap":398},[2779,2808,2816,2846,2871,2901,2908,2949,3021,3074,3086,3142,3186,3197,3245,3282,3302,3310,3321,3332,3339,3370,3410,3430,3441,3479,3486,3493,3533,3574,3629,3671,3700,3713,3725,3790,3833,3855,3867,3875,3883,3891,3915],{"type":405,"tag":430,"props":2780,"children":2781},{"class":432,"line":433},[2782,2786,2791,2795,2800,2804],{"type":405,"tag":430,"props":2783,"children":2784},{"style":447},[2785],{"type":411,"value":450},{"type":405,"tag":430,"props":2787,"children":2788},{"style":453},[2789],{"type":411,"value":2790}," composeWatcher",{"type":405,"tag":430,"props":2792,"children":2793},{"style":459},[2794],{"type":411,"value":462},{"type":405,"tag":430,"props":2796,"children":2797},{"style":465},[2798],{"type":411,"value":2799},"watchers",{"type":405,"tag":430,"props":2801,"children":2802},{"style":459},[2803],{"type":411,"value":483},{"type":405,"tag":430,"props":2805,"children":2806},{"style":459},[2807],{"type":411,"value":488},{"type":405,"tag":430,"props":2809,"children":2810},{"class":432,"line":443},[2811],{"type":405,"tag":430,"props":2812,"children":2813},{"style":437},[2814],{"type":411,"value":2815},"  // 使用一个新的 watcher 整合事件列表\n",{"type":405,"tag":430,"props":2817,"children":2818},{"class":432,"line":491},[2819,2823,2828,2832,2837,2842],{"type":405,"tag":430,"props":2820,"children":2821},{"style":447},[2822],{"type":411,"value":1215},{"type":405,"tag":430,"props":2824,"children":2825},{"style":507},[2826],{"type":411,"value":2827}," watcher",{"type":405,"tag":430,"props":2829,"children":2830},{"style":992},[2831],{"type":411,"value":995},{"type":405,"tag":430,"props":2833,"children":2834},{"style":992},[2835],{"type":411,"value":2836}," new",{"type":405,"tag":430,"props":2838,"children":2839},{"style":453},[2840],{"type":411,"value":2841}," Watcher",{"type":405,"tag":430,"props":2843,"children":2844},{"style":501},[2845],{"type":411,"value":1938},{"type":405,"tag":430,"props":2847,"children":2848},{"class":432,"line":541},[2849,2853,2858,2862,2867],{"type":405,"tag":430,"props":2850,"children":2851},{"style":447},[2852],{"type":411,"value":1215},{"type":405,"tag":430,"props":2854,"children":2855},{"style":507},[2856],{"type":411,"value":2857}," filterDups",{"type":405,"tag":430,"props":2859,"children":2860},{"style":992},[2861],{"type":411,"value":995},{"type":405,"tag":430,"props":2863,"children":2864},{"style":453},[2865],{"type":411,"value":2866}," createDupsFilter",{"type":405,"tag":430,"props":2868,"children":2869},{"style":501},[2870],{"type":411,"value":1938},{"type":405,"tag":430,"props":2872,"children":2873},{"class":432,"line":593},[2874,2878,2883,2887,2892,2896],{"type":405,"tag":430,"props":2875,"children":2876},{"style":447},[2877],{"type":411,"value":1215},{"type":405,"tag":430,"props":2879,"children":2880},{"style":507},[2881],{"type":411,"value":2882}," counter",{"type":405,"tag":430,"props":2884,"children":2885},{"style":992},[2886],{"type":411,"value":995},{"type":405,"tag":430,"props":2888,"children":2889},{"style":507},[2890],{"type":411,"value":2891}," watchers",{"type":405,"tag":430,"props":2893,"children":2894},{"style":459},[2895],{"type":411,"value":515},{"type":405,"tag":430,"props":2897,"children":2898},{"style":1652},[2899],{"type":411,"value":2900},"length\n",{"type":405,"tag":430,"props":2902,"children":2903},{"class":432,"line":625},[2904],{"type":405,"tag":430,"props":2905,"children":2906},{"emptyLinePlaceholder":397},[2907],{"type":411,"value":1663},{"type":405,"tag":430,"props":2909,"children":2910},{"class":432,"line":638},[2911,2916,2920,2924,2928,2932,2936,2941,2945],{"type":405,"tag":430,"props":2912,"children":2913},{"style":507},[2914],{"type":411,"value":2915},"  watchers",{"type":405,"tag":430,"props":2917,"children":2918},{"style":459},[2919],{"type":411,"value":515},{"type":405,"tag":430,"props":2921,"children":2922},{"style":453},[2923],{"type":411,"value":944},{"type":405,"tag":430,"props":2925,"children":2926},{"style":501},[2927],{"type":411,"value":462},{"type":405,"tag":430,"props":2929,"children":2930},{"style":447},[2931],{"type":411,"value":450},{"type":405,"tag":430,"props":2933,"children":2934},{"style":459},[2935],{"type":411,"value":462},{"type":405,"tag":430,"props":2937,"children":2938},{"style":465},[2939],{"type":411,"value":2940},"w",{"type":405,"tag":430,"props":2942,"children":2943},{"style":459},[2944],{"type":411,"value":483},{"type":405,"tag":430,"props":2946,"children":2947},{"style":459},[2948],{"type":411,"value":488},{"type":405,"tag":430,"props":2950,"children":2951},{"class":432,"line":647},[2952,2957,2961,2965,2969,2973,2977,2981,2985,2989,2993,2997,3001,3005,3009,3013,3017],{"type":405,"tag":430,"props":2953,"children":2954},{"style":507},[2955],{"type":411,"value":2956},"    w",{"type":405,"tag":430,"props":2958,"children":2959},{"style":459},[2960],{"type":411,"value":515},{"type":405,"tag":430,"props":2962,"children":2963},{"style":453},[2964],{"type":411,"value":2052},{"type":405,"tag":430,"props":2966,"children":2967},{"style":501},[2968],{"type":411,"value":462},{"type":405,"tag":430,"props":2970,"children":2971},{"style":1253},[2972],{"type":411,"value":1267},{"type":405,"tag":430,"props":2974,"children":2975},{"style":1259},[2976],{"type":411,"value":2065},{"type":405,"tag":430,"props":2978,"children":2979},{"style":1253},[2980],{"type":411,"value":1267},{"type":405,"tag":430,"props":2982,"children":2983},{"style":459},[2984],{"type":411,"value":473},{"type":405,"tag":430,"props":2986,"children":2987},{"style":453},[2988],{"type":411,"value":2857},{"type":405,"tag":430,"props":2990,"children":2991},{"style":501},[2992],{"type":411,"value":462},{"type":405,"tag":430,"props":2994,"children":2995},{"style":447},[2996],{"type":411,"value":450},{"type":405,"tag":430,"props":2998,"children":2999},{"style":459},[3000],{"type":411,"value":462},{"type":405,"tag":430,"props":3002,"children":3003},{"style":465},[3004],{"type":411,"value":1313},{"type":405,"tag":430,"props":3006,"children":3007},{"style":459},[3008],{"type":411,"value":473},{"type":405,"tag":430,"props":3010,"children":3011},{"style":465},[3012],{"type":411,"value":2094},{"type":405,"tag":430,"props":3014,"children":3015},{"style":459},[3016],{"type":411,"value":483},{"type":405,"tag":430,"props":3018,"children":3019},{"style":459},[3020],{"type":411,"value":488},{"type":405,"tag":430,"props":3022,"children":3023},{"class":432,"line":656},[3024,3029,3033,3037,3041,3045,3049,3053,3057,3062,3066,3070],{"type":405,"tag":430,"props":3025,"children":3026},{"style":507},[3027],{"type":411,"value":3028},"      watcher",{"type":405,"tag":430,"props":3030,"children":3031},{"style":459},[3032],{"type":411,"value":515},{"type":405,"tag":430,"props":3034,"children":3035},{"style":453},[3036],{"type":411,"value":2452},{"type":405,"tag":430,"props":3038,"children":3039},{"style":501},[3040],{"type":411,"value":462},{"type":405,"tag":430,"props":3042,"children":3043},{"style":1253},[3044],{"type":411,"value":1267},{"type":405,"tag":430,"props":3046,"children":3047},{"style":1259},[3048],{"type":411,"value":2065},{"type":405,"tag":430,"props":3050,"children":3051},{"style":1253},[3052],{"type":411,"value":1267},{"type":405,"tag":430,"props":3054,"children":3055},{"style":459},[3056],{"type":411,"value":473},{"type":405,"tag":430,"props":3058,"children":3059},{"style":507},[3060],{"type":411,"value":3061}," evt",{"type":405,"tag":430,"props":3063,"children":3064},{"style":459},[3065],{"type":411,"value":473},{"type":405,"tag":430,"props":3067,"children":3068},{"style":507},[3069],{"type":411,"value":2094},{"type":405,"tag":430,"props":3071,"children":3072},{"style":501},[3073],{"type":411,"value":622},{"type":405,"tag":430,"props":3075,"children":3076},{"class":432,"line":697},[3077,3081],{"type":405,"tag":430,"props":3078,"children":3079},{"style":459},[3080],{"type":411,"value":631},{"type":405,"tag":430,"props":3082,"children":3083},{"style":501},[3084],{"type":411,"value":3085},"))\n",{"type":405,"tag":430,"props":3087,"children":3088},{"class":432,"line":755},[3089,3093,3097,3101,3105,3109,3114,3118,3122,3126,3130,3134,3138],{"type":405,"tag":430,"props":3090,"children":3091},{"style":507},[3092],{"type":411,"value":2956},{"type":405,"tag":430,"props":3094,"children":3095},{"style":459},[3096],{"type":411,"value":515},{"type":405,"tag":430,"props":3098,"children":3099},{"style":453},[3100],{"type":411,"value":2052},{"type":405,"tag":430,"props":3102,"children":3103},{"style":501},[3104],{"type":411,"value":462},{"type":405,"tag":430,"props":3106,"children":3107},{"style":1253},[3108],{"type":411,"value":1267},{"type":405,"tag":430,"props":3110,"children":3111},{"style":1259},[3112],{"type":411,"value":3113},"error",{"type":405,"tag":430,"props":3115,"children":3116},{"style":1253},[3117],{"type":411,"value":1267},{"type":405,"tag":430,"props":3119,"children":3120},{"style":459},[3121],{"type":411,"value":473},{"type":405,"tag":430,"props":3123,"children":3124},{"style":447},[3125],{"type":411,"value":573},{"type":405,"tag":430,"props":3127,"children":3128},{"style":459},[3129],{"type":411,"value":462},{"type":405,"tag":430,"props":3131,"children":3132},{"style":465},[3133],{"type":411,"value":582},{"type":405,"tag":430,"props":3135,"children":3136},{"style":459},[3137],{"type":411,"value":483},{"type":405,"tag":430,"props":3139,"children":3140},{"style":459},[3141],{"type":411,"value":488},{"type":405,"tag":430,"props":3143,"children":3144},{"class":432,"line":780},[3145,3149,3153,3157,3161,3165,3169,3173,3177,3182],{"type":405,"tag":430,"props":3146,"children":3147},{"style":507},[3148],{"type":411,"value":3028},{"type":405,"tag":430,"props":3150,"children":3151},{"style":459},[3152],{"type":411,"value":515},{"type":405,"tag":430,"props":3154,"children":3155},{"style":453},[3156],{"type":411,"value":2452},{"type":405,"tag":430,"props":3158,"children":3159},{"style":501},[3160],{"type":411,"value":462},{"type":405,"tag":430,"props":3162,"children":3163},{"style":1253},[3164],{"type":411,"value":1267},{"type":405,"tag":430,"props":3166,"children":3167},{"style":1259},[3168],{"type":411,"value":3113},{"type":405,"tag":430,"props":3170,"children":3171},{"style":1253},[3172],{"type":411,"value":1267},{"type":405,"tag":430,"props":3174,"children":3175},{"style":459},[3176],{"type":411,"value":473},{"type":405,"tag":430,"props":3178,"children":3179},{"style":507},[3180],{"type":411,"value":3181}," err",{"type":405,"tag":430,"props":3183,"children":3184},{"style":501},[3185],{"type":411,"value":622},{"type":405,"tag":430,"props":3187,"children":3188},{"class":432,"line":818},[3189,3193],{"type":405,"tag":430,"props":3190,"children":3191},{"style":459},[3192],{"type":411,"value":631},{"type":405,"tag":430,"props":3194,"children":3195},{"style":501},[3196],{"type":411,"value":622},{"type":405,"tag":430,"props":3198,"children":3199},{"class":432,"line":827},[3200,3204,3208,3212,3216,3220,3225,3229,3233,3237,3241],{"type":405,"tag":430,"props":3201,"children":3202},{"style":507},[3203],{"type":411,"value":2956},{"type":405,"tag":430,"props":3205,"children":3206},{"style":459},[3207],{"type":411,"value":515},{"type":405,"tag":430,"props":3209,"children":3210},{"style":453},[3211],{"type":411,"value":2052},{"type":405,"tag":430,"props":3213,"children":3214},{"style":501},[3215],{"type":411,"value":462},{"type":405,"tag":430,"props":3217,"children":3218},{"style":1253},[3219],{"type":411,"value":1267},{"type":405,"tag":430,"props":3221,"children":3222},{"style":1259},[3223],{"type":411,"value":3224},"ready",{"type":405,"tag":430,"props":3226,"children":3227},{"style":1253},[3228],{"type":411,"value":1267},{"type":405,"tag":430,"props":3230,"children":3231},{"style":459},[3232],{"type":411,"value":473},{"type":405,"tag":430,"props":3234,"children":3235},{"style":447},[3236],{"type":411,"value":573},{"type":405,"tag":430,"props":3238,"children":3239},{"style":459},[3240],{"type":411,"value":1913},{"type":405,"tag":430,"props":3242,"children":3243},{"style":459},[3244],{"type":411,"value":488},{"type":405,"tag":430,"props":3246,"children":3247},{"class":432,"line":839},[3248,3252,3256,3261,3265,3269,3274,3278],{"type":405,"tag":430,"props":3249,"children":3250},{"style":495},[3251],{"type":411,"value":903},{"type":405,"tag":430,"props":3253,"children":3254},{"style":501},[3255],{"type":411,"value":504},{"type":405,"tag":430,"props":3257,"children":3258},{"style":992},[3259],{"type":411,"value":3260},"!",{"type":405,"tag":430,"props":3262,"children":3263},{"style":501},[3264],{"type":411,"value":462},{"type":405,"tag":430,"props":3266,"children":3267},{"style":992},[3268],{"type":411,"value":1600},{"type":405,"tag":430,"props":3270,"children":3271},{"style":507},[3272],{"type":411,"value":3273},"counter",{"type":405,"tag":430,"props":3275,"children":3276},{"style":501},[3277],{"type":411,"value":533},{"type":405,"tag":430,"props":3279,"children":3280},{"style":459},[3281],{"type":411,"value":538},{"type":405,"tag":430,"props":3283,"children":3284},{"class":432,"line":897},[3285,3290,3294,3298],{"type":405,"tag":430,"props":3286,"children":3287},{"style":453},[3288],{"type":411,"value":3289},"        emitReady",{"type":405,"tag":430,"props":3291,"children":3292},{"style":501},[3293],{"type":411,"value":462},{"type":405,"tag":430,"props":3295,"children":3296},{"style":507},[3297],{"type":411,"value":2043},{"type":405,"tag":430,"props":3299,"children":3300},{"style":501},[3301],{"type":411,"value":622},{"type":405,"tag":430,"props":3303,"children":3304},{"class":432,"line":929},[3305],{"type":405,"tag":430,"props":3306,"children":3307},{"style":459},[3308],{"type":411,"value":3309},"      }\n",{"type":405,"tag":430,"props":3311,"children":3312},{"class":432,"line":978},[3313,3317],{"type":405,"tag":430,"props":3314,"children":3315},{"style":459},[3316],{"type":411,"value":631},{"type":405,"tag":430,"props":3318,"children":3319},{"style":501},[3320],{"type":411,"value":622},{"type":405,"tag":430,"props":3322,"children":3323},{"class":432,"line":1032},[3324,3328],{"type":405,"tag":430,"props":3325,"children":3326},{"style":459},[3327],{"type":411,"value":1436},{"type":405,"tag":430,"props":3329,"children":3330},{"style":501},[3331],{"type":411,"value":622},{"type":405,"tag":430,"props":3333,"children":3334},{"class":432,"line":1076},[3335],{"type":405,"tag":430,"props":3336,"children":3337},{"emptyLinePlaceholder":397},[3338],{"type":411,"value":1663},{"type":405,"tag":430,"props":3340,"children":3341},{"class":432,"line":1105},[3342,3346,3350,3354,3358,3362,3366],{"type":405,"tag":430,"props":3343,"children":3344},{"style":507},[3345],{"type":411,"value":1683},{"type":405,"tag":430,"props":3347,"children":3348},{"style":459},[3349],{"type":411,"value":515},{"type":405,"tag":430,"props":3351,"children":3352},{"style":453},[3353],{"type":411,"value":1933},{"type":405,"tag":430,"props":3355,"children":3356},{"style":992},[3357],{"type":411,"value":995},{"type":405,"tag":430,"props":3359,"children":3360},{"style":447},[3361],{"type":411,"value":573},{"type":405,"tag":430,"props":3363,"children":3364},{"style":459},[3365],{"type":411,"value":1913},{"type":405,"tag":430,"props":3367,"children":3368},{"style":459},[3369],{"type":411,"value":488},{"type":405,"tag":430,"props":3371,"children":3372},{"class":432,"line":1114},[3373,3378,3382,3386,3390,3394,3398,3402,3406],{"type":405,"tag":430,"props":3374,"children":3375},{"style":507},[3376],{"type":411,"value":3377},"    watchers",{"type":405,"tag":430,"props":3379,"children":3380},{"style":459},[3381],{"type":411,"value":515},{"type":405,"tag":430,"props":3383,"children":3384},{"style":453},[3385],{"type":411,"value":944},{"type":405,"tag":430,"props":3387,"children":3388},{"style":501},[3389],{"type":411,"value":462},{"type":405,"tag":430,"props":3391,"children":3392},{"style":447},[3393],{"type":411,"value":450},{"type":405,"tag":430,"props":3395,"children":3396},{"style":459},[3397],{"type":411,"value":462},{"type":405,"tag":430,"props":3399,"children":3400},{"style":465},[3401],{"type":411,"value":2940},{"type":405,"tag":430,"props":3403,"children":3404},{"style":459},[3405],{"type":411,"value":483},{"type":405,"tag":430,"props":3407,"children":3408},{"style":459},[3409],{"type":411,"value":488},{"type":405,"tag":430,"props":3411,"children":3412},{"class":432,"line":1127},[3413,3418,3422,3426],{"type":405,"tag":430,"props":3414,"children":3415},{"style":507},[3416],{"type":411,"value":3417},"      w",{"type":405,"tag":430,"props":3419,"children":3420},{"style":459},[3421],{"type":411,"value":515},{"type":405,"tag":430,"props":3423,"children":3424},{"style":453},[3425],{"type":411,"value":1933},{"type":405,"tag":430,"props":3427,"children":3428},{"style":501},[3429],{"type":411,"value":1938},{"type":405,"tag":430,"props":3431,"children":3432},{"class":432,"line":1140},[3433,3437],{"type":405,"tag":430,"props":3434,"children":3435},{"style":459},[3436],{"type":411,"value":631},{"type":405,"tag":430,"props":3438,"children":3439},{"style":501},[3440],{"type":411,"value":622},{"type":405,"tag":430,"props":3442,"children":3443},{"class":432,"line":1148},[3444,3449,3453,3458,3462,3467,3471,3475],{"type":405,"tag":430,"props":3445,"children":3446},{"style":507},[3447],{"type":411,"value":3448},"    process",{"type":405,"tag":430,"props":3450,"children":3451},{"style":459},[3452],{"type":411,"value":515},{"type":405,"tag":430,"props":3454,"children":3455},{"style":453},[3456],{"type":411,"value":3457},"nextTick",{"type":405,"tag":430,"props":3459,"children":3460},{"style":501},[3461],{"type":411,"value":462},{"type":405,"tag":430,"props":3463,"children":3464},{"style":507},[3465],{"type":411,"value":3466},"emitClose",{"type":405,"tag":430,"props":3468,"children":3469},{"style":459},[3470],{"type":411,"value":473},{"type":405,"tag":430,"props":3472,"children":3473},{"style":507},[3474],{"type":411,"value":2827},{"type":405,"tag":430,"props":3476,"children":3477},{"style":501},[3478],{"type":411,"value":622},{"type":405,"tag":430,"props":3480,"children":3481},{"class":432,"line":2275},[3482],{"type":405,"tag":430,"props":3483,"children":3484},{"style":459},[3485],{"type":411,"value":653},{"type":405,"tag":430,"props":3487,"children":3488},{"class":432,"line":2287},[3489],{"type":405,"tag":430,"props":3490,"children":3491},{"emptyLinePlaceholder":397},[3492],{"type":411,"value":1663},{"type":405,"tag":430,"props":3494,"children":3495},{"class":432,"line":2295},[3496,3500,3504,3508,3512,3516,3520,3525,3529],{"type":405,"tag":430,"props":3497,"children":3498},{"style":507},[3499],{"type":411,"value":1683},{"type":405,"tag":430,"props":3501,"children":3502},{"style":459},[3503],{"type":411,"value":515},{"type":405,"tag":430,"props":3505,"children":3506},{"style":453},[3507],{"type":411,"value":2580},{"type":405,"tag":430,"props":3509,"children":3510},{"style":992},[3511],{"type":411,"value":995},{"type":405,"tag":430,"props":3513,"children":3514},{"style":447},[3515],{"type":411,"value":573},{"type":405,"tag":430,"props":3517,"children":3518},{"style":459},[3519],{"type":411,"value":462},{"type":405,"tag":430,"props":3521,"children":3522},{"style":465},[3523],{"type":411,"value":3524},"fn",{"type":405,"tag":430,"props":3526,"children":3527},{"style":459},[3528],{"type":411,"value":483},{"type":405,"tag":430,"props":3530,"children":3531},{"style":459},[3532],{"type":411,"value":488},{"type":405,"tag":430,"props":3534,"children":3536},{"class":432,"line":3535},29,[3537,3541,3545,3549,3553,3558,3562,3566,3570],{"type":405,"tag":430,"props":3538,"children":3539},{"style":495},[3540],{"type":411,"value":1337},{"type":405,"tag":430,"props":3542,"children":3543},{"style":501},[3544],{"type":411,"value":504},{"type":405,"tag":430,"props":3546,"children":3547},{"style":507},[3548],{"type":411,"value":510},{"type":405,"tag":430,"props":3550,"children":3551},{"style":459},[3552],{"type":411,"value":515},{"type":405,"tag":430,"props":3554,"children":3555},{"style":453},[3556],{"type":411,"value":3557},"func",{"type":405,"tag":430,"props":3559,"children":3560},{"style":501},[3561],{"type":411,"value":462},{"type":405,"tag":430,"props":3563,"children":3564},{"style":507},[3565],{"type":411,"value":3524},{"type":405,"tag":430,"props":3567,"children":3568},{"style":501},[3569],{"type":411,"value":533},{"type":405,"tag":430,"props":3571,"children":3572},{"style":459},[3573],{"type":411,"value":538},{"type":405,"tag":430,"props":3575,"children":3577},{"class":432,"line":3576},30,[3578,3583,3588,3592,3596,3600,3605,3609,3613,3617,3621,3625],{"type":405,"tag":430,"props":3579,"children":3580},{"style":447},[3581],{"type":411,"value":3582},"      var",{"type":405,"tag":430,"props":3584,"children":3585},{"style":507},[3586],{"type":411,"value":3587}," promises",{"type":405,"tag":430,"props":3589,"children":3590},{"style":992},[3591],{"type":411,"value":995},{"type":405,"tag":430,"props":3593,"children":3594},{"style":507},[3595],{"type":411,"value":2891},{"type":405,"tag":430,"props":3597,"children":3598},{"style":459},[3599],{"type":411,"value":515},{"type":405,"tag":430,"props":3601,"children":3602},{"style":453},[3603],{"type":411,"value":3604},"map",{"type":405,"tag":430,"props":3606,"children":3607},{"style":501},[3608],{"type":411,"value":462},{"type":405,"tag":430,"props":3610,"children":3611},{"style":447},[3612],{"type":411,"value":450},{"type":405,"tag":430,"props":3614,"children":3615},{"style":459},[3616],{"type":411,"value":462},{"type":405,"tag":430,"props":3618,"children":3619},{"style":465},[3620],{"type":411,"value":2940},{"type":405,"tag":430,"props":3622,"children":3623},{"style":459},[3624],{"type":411,"value":483},{"type":405,"tag":430,"props":3626,"children":3627},{"style":459},[3628],{"type":411,"value":488},{"type":405,"tag":430,"props":3630,"children":3632},{"class":432,"line":3631},31,[3633,3638,3642,3647,3651,3655,3659,3663,3667],{"type":405,"tag":430,"props":3634,"children":3635},{"style":495},[3636],{"type":411,"value":3637},"        return",{"type":405,"tag":430,"props":3639,"children":3640},{"style":992},[3641],{"type":411,"value":2836},{"type":405,"tag":430,"props":3643,"children":3644},{"style":2322},[3645],{"type":411,"value":3646}," Promise",{"type":405,"tag":430,"props":3648,"children":3649},{"style":501},[3650],{"type":411,"value":462},{"type":405,"tag":430,"props":3652,"children":3653},{"style":447},[3654],{"type":411,"value":450},{"type":405,"tag":430,"props":3656,"children":3657},{"style":459},[3658],{"type":411,"value":462},{"type":405,"tag":430,"props":3660,"children":3661},{"style":465},[3662],{"type":411,"value":1237},{"type":405,"tag":430,"props":3664,"children":3665},{"style":459},[3666],{"type":411,"value":483},{"type":405,"tag":430,"props":3668,"children":3669},{"style":459},[3670],{"type":411,"value":488},{"type":405,"tag":430,"props":3672,"children":3674},{"class":432,"line":3673},32,[3675,3680,3684,3688,3692,3696],{"type":405,"tag":430,"props":3676,"children":3677},{"style":507},[3678],{"type":411,"value":3679},"          w",{"type":405,"tag":430,"props":3681,"children":3682},{"style":459},[3683],{"type":411,"value":515},{"type":405,"tag":430,"props":3685,"children":3686},{"style":453},[3687],{"type":411,"value":2580},{"type":405,"tag":430,"props":3689,"children":3690},{"style":501},[3691],{"type":411,"value":462},{"type":405,"tag":430,"props":3693,"children":3694},{"style":507},[3695],{"type":411,"value":1237},{"type":405,"tag":430,"props":3697,"children":3698},{"style":501},[3699],{"type":411,"value":622},{"type":405,"tag":430,"props":3701,"children":3703},{"class":432,"line":3702},33,[3704,3709],{"type":405,"tag":430,"props":3705,"children":3706},{"style":459},[3707],{"type":411,"value":3708},"        }",{"type":405,"tag":430,"props":3710,"children":3711},{"style":501},[3712],{"type":411,"value":622},{"type":405,"tag":430,"props":3714,"children":3716},{"class":432,"line":3715},34,[3717,3721],{"type":405,"tag":430,"props":3718,"children":3719},{"style":459},[3720],{"type":411,"value":1120},{"type":405,"tag":430,"props":3722,"children":3723},{"style":501},[3724],{"type":411,"value":622},{"type":405,"tag":430,"props":3726,"children":3728},{"class":432,"line":3727},35,[3729,3734,3738,3743,3747,3752,3756,3760,3765,3769,3773,3777,3782,3786],{"type":405,"tag":430,"props":3730,"children":3731},{"style":2322},[3732],{"type":411,"value":3733},"      Promise",{"type":405,"tag":430,"props":3735,"children":3736},{"style":459},[3737],{"type":411,"value":515},{"type":405,"tag":430,"props":3739,"children":3740},{"style":453},[3741],{"type":411,"value":3742},"all",{"type":405,"tag":430,"props":3744,"children":3745},{"style":501},[3746],{"type":411,"value":462},{"type":405,"tag":430,"props":3748,"children":3749},{"style":507},[3750],{"type":411,"value":3751},"promises",{"type":405,"tag":430,"props":3753,"children":3754},{"style":501},[3755],{"type":411,"value":483},{"type":405,"tag":430,"props":3757,"children":3758},{"style":459},[3759],{"type":411,"value":515},{"type":405,"tag":430,"props":3761,"children":3762},{"style":453},[3763],{"type":411,"value":3764},"then",{"type":405,"tag":430,"props":3766,"children":3767},{"style":501},[3768],{"type":411,"value":462},{"type":405,"tag":430,"props":3770,"children":3771},{"style":447},[3772],{"type":411,"value":450},{"type":405,"tag":430,"props":3774,"children":3775},{"style":459},[3776],{"type":411,"value":462},{"type":405,"tag":430,"props":3778,"children":3779},{"style":465},[3780],{"type":411,"value":3781},"result",{"type":405,"tag":430,"props":3783,"children":3784},{"style":459},[3785],{"type":411,"value":483},{"type":405,"tag":430,"props":3787,"children":3788},{"style":459},[3789],{"type":411,"value":488},{"type":405,"tag":430,"props":3791,"children":3793},{"class":432,"line":3792},36,[3794,3798,3803,3807,3812,3816,3821,3825,3829],{"type":405,"tag":430,"props":3795,"children":3796},{"style":447},[3797],{"type":411,"value":984},{"type":405,"tag":430,"props":3799,"children":3800},{"style":507},[3801],{"type":411,"value":3802}," ret",{"type":405,"tag":430,"props":3804,"children":3805},{"style":992},[3806],{"type":411,"value":995},{"type":405,"tag":430,"props":3808,"children":3809},{"style":453},[3810],{"type":411,"value":3811}," unique",{"type":405,"tag":430,"props":3813,"children":3814},{"style":501},[3815],{"type":411,"value":462},{"type":405,"tag":430,"props":3817,"children":3818},{"style":453},[3819],{"type":411,"value":3820},"flat1",{"type":405,"tag":430,"props":3822,"children":3823},{"style":501},[3824],{"type":411,"value":462},{"type":405,"tag":430,"props":3826,"children":3827},{"style":507},[3828],{"type":411,"value":3781},{"type":405,"tag":430,"props":3830,"children":3831},{"style":501},[3832],{"type":411,"value":3085},{"type":405,"tag":430,"props":3834,"children":3836},{"class":432,"line":3835},37,[3837,3842,3846,3851],{"type":405,"tag":430,"props":3838,"children":3839},{"style":453},[3840],{"type":411,"value":3841},"        fn",{"type":405,"tag":430,"props":3843,"children":3844},{"style":501},[3845],{"type":411,"value":462},{"type":405,"tag":430,"props":3847,"children":3848},{"style":507},[3849],{"type":411,"value":3850},"ret",{"type":405,"tag":430,"props":3852,"children":3853},{"style":501},[3854],{"type":411,"value":622},{"type":405,"tag":430,"props":3856,"children":3858},{"class":432,"line":3857},38,[3859,3863],{"type":405,"tag":430,"props":3860,"children":3861},{"style":459},[3862],{"type":411,"value":1120},{"type":405,"tag":430,"props":3864,"children":3865},{"style":501},[3866],{"type":411,"value":622},{"type":405,"tag":430,"props":3868,"children":3870},{"class":432,"line":3869},39,[3871],{"type":405,"tag":430,"props":3872,"children":3873},{"style":459},[3874],{"type":411,"value":1428},{"type":405,"tag":430,"props":3876,"children":3878},{"class":432,"line":3877},40,[3879],{"type":405,"tag":430,"props":3880,"children":3881},{"style":459},[3882],{"type":411,"value":653},{"type":405,"tag":430,"props":3884,"children":3886},{"class":432,"line":3885},41,[3887],{"type":405,"tag":430,"props":3888,"children":3889},{"emptyLinePlaceholder":397},[3890],{"type":411,"value":1663},{"type":405,"tag":430,"props":3892,"children":3894},{"class":432,"line":3893},42,[3895,3899,3903,3907,3911],{"type":405,"tag":430,"props":3896,"children":3897},{"style":495},[3898],{"type":411,"value":2754},{"type":405,"tag":430,"props":3900,"children":3901},{"style":507},[3902],{"type":411,"value":2827},{"type":405,"tag":430,"props":3904,"children":3905},{"style":459},[3906],{"type":411,"value":515},{"type":405,"tag":430,"props":3908,"children":3909},{"style":453},[3910],{"type":411,"value":2343},{"type":405,"tag":430,"props":3912,"children":3913},{"style":501},[3914],{"type":411,"value":1938},{"type":405,"tag":430,"props":3916,"children":3918},{"class":432,"line":3917},43,[3919],{"type":405,"tag":430,"props":3920,"children":3921},{"style":459},[3922],{"type":411,"value":1154},{"type":405,"tag":406,"props":3924,"children":3926},{"id":3925},"工具函数",[3927],{"type":411,"value":3925},{"type":405,"tag":413,"props":3929,"children":3930},{},[3931],{"type":411,"value":3932},"通过索引快速去重。第一次见到有人使用 filter 方法的第三个参数。",{"type":405,"tag":419,"props":3934,"children":3936},{"className":421,"code":3935,"language":423,"meta":398,"style":398},"function unique(arr) {\n  return arr.filter(function(v, i, self) {\n    return self.indexOf(v) === i\n  })\n}\n",[3937],{"type":405,"tag":426,"props":3938,"children":3939},{"__ignoreMap":398},[3940,3968,4031,4072,4083],{"type":405,"tag":430,"props":3941,"children":3942},{"class":432,"line":433},[3943,3947,3951,3955,3960,3964],{"type":405,"tag":430,"props":3944,"children":3945},{"style":447},[3946],{"type":411,"value":450},{"type":405,"tag":430,"props":3948,"children":3949},{"style":453},[3950],{"type":411,"value":3811},{"type":405,"tag":430,"props":3952,"children":3953},{"style":459},[3954],{"type":411,"value":462},{"type":405,"tag":430,"props":3956,"children":3957},{"style":465},[3958],{"type":411,"value":3959},"arr",{"type":405,"tag":430,"props":3961,"children":3962},{"style":459},[3963],{"type":411,"value":483},{"type":405,"tag":430,"props":3965,"children":3966},{"style":459},[3967],{"type":411,"value":488},{"type":405,"tag":430,"props":3969,"children":3970},{"class":432,"line":443},[3971,3975,3980,3984,3989,3993,3997,4001,4006,4010,4015,4019,4023,4027],{"type":405,"tag":430,"props":3972,"children":3973},{"style":495},[3974],{"type":411,"value":2754},{"type":405,"tag":430,"props":3976,"children":3977},{"style":507},[3978],{"type":411,"value":3979}," arr",{"type":405,"tag":430,"props":3981,"children":3982},{"style":459},[3983],{"type":411,"value":515},{"type":405,"tag":430,"props":3985,"children":3986},{"style":453},[3987],{"type":411,"value":3988},"filter",{"type":405,"tag":430,"props":3990,"children":3991},{"style":501},[3992],{"type":411,"value":462},{"type":405,"tag":430,"props":3994,"children":3995},{"style":447},[3996],{"type":411,"value":450},{"type":405,"tag":430,"props":3998,"children":3999},{"style":459},[4000],{"type":411,"value":462},{"type":405,"tag":430,"props":4002,"children":4003},{"style":465},[4004],{"type":411,"value":4005},"v",{"type":405,"tag":430,"props":4007,"children":4008},{"style":459},[4009],{"type":411,"value":473},{"type":405,"tag":430,"props":4011,"children":4012},{"style":465},[4013],{"type":411,"value":4014}," i",{"type":405,"tag":430,"props":4016,"children":4017},{"style":459},[4018],{"type":411,"value":473},{"type":405,"tag":430,"props":4020,"children":4021},{"style":465},[4022],{"type":411,"value":2392},{"type":405,"tag":430,"props":4024,"children":4025},{"style":459},[4026],{"type":411,"value":483},{"type":405,"tag":430,"props":4028,"children":4029},{"style":459},[4030],{"type":411,"value":488},{"type":405,"tag":430,"props":4032,"children":4033},{"class":432,"line":491},[4034,4038,4042,4046,4051,4055,4059,4063,4067],{"type":405,"tag":430,"props":4035,"children":4036},{"style":495},[4037],{"type":411,"value":1800},{"type":405,"tag":430,"props":4039,"children":4040},{"style":507},[4041],{"type":411,"value":2392},{"type":405,"tag":430,"props":4043,"children":4044},{"style":459},[4045],{"type":411,"value":515},{"type":405,"tag":430,"props":4047,"children":4048},{"style":453},[4049],{"type":411,"value":4050},"indexOf",{"type":405,"tag":430,"props":4052,"children":4053},{"style":501},[4054],{"type":411,"value":462},{"type":405,"tag":430,"props":4056,"children":4057},{"style":507},[4058],{"type":411,"value":4005},{"type":405,"tag":430,"props":4060,"children":4061},{"style":501},[4062],{"type":411,"value":916},{"type":405,"tag":430,"props":4064,"children":4065},{"style":992},[4066],{"type":411,"value":1372},{"type":405,"tag":430,"props":4068,"children":4069},{"style":507},[4070],{"type":411,"value":4071}," i\n",{"type":405,"tag":430,"props":4073,"children":4074},{"class":432,"line":541},[4075,4079],{"type":405,"tag":430,"props":4076,"children":4077},{"style":459},[4078],{"type":411,"value":1436},{"type":405,"tag":430,"props":4080,"children":4081},{"style":501},[4082],{"type":411,"value":622},{"type":405,"tag":430,"props":4084,"children":4085},{"class":432,"line":593},[4086],{"type":405,"tag":430,"props":4087,"children":4088},{"style":459},[4089],{"type":411,"value":1154},{"type":405,"tag":413,"props":4091,"children":4092},{},[4093],{"type":411,"value":4094},"获取 UUID，这个有意思，但不知道效率怎么样。",{"type":405,"tag":419,"props":4096,"children":4098},{"className":421,"code":4097,"language":423,"meta":398,"style":398},"const getUUID = () => Math.random().toString(16).substr(2)\n",[4099],{"type":405,"tag":426,"props":4100,"children":4101},{"__ignoreMap":398},[4102],{"type":405,"tag":430,"props":4103,"children":4104},{"class":432,"line":433},[4105,4110,4116,4120,4125,4130,4135,4139,4144,4148,4152,4157,4161,4166,4170,4174,4179,4183,4188],{"type":405,"tag":430,"props":4106,"children":4107},{"style":447},[4108],{"type":411,"value":4109},"const",{"type":405,"tag":430,"props":4111,"children":4113},{"style":4112},"--shiki-light:#90A4AE;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[4114],{"type":411,"value":4115}," getUUID",{"type":405,"tag":430,"props":4117,"children":4118},{"style":992},[4119],{"type":411,"value":995},{"type":405,"tag":430,"props":4121,"children":4122},{"style":459},[4123],{"type":411,"value":4124}," ()",{"type":405,"tag":430,"props":4126,"children":4127},{"style":447},[4128],{"type":411,"value":4129}," =>",{"type":405,"tag":430,"props":4131,"children":4132},{"style":507},[4133],{"type":411,"value":4134}," Math",{"type":405,"tag":430,"props":4136,"children":4137},{"style":459},[4138],{"type":411,"value":515},{"type":405,"tag":430,"props":4140,"children":4141},{"style":453},[4142],{"type":411,"value":4143},"random",{"type":405,"tag":430,"props":4145,"children":4146},{"style":507},[4147],{"type":411,"value":1913},{"type":405,"tag":430,"props":4149,"children":4150},{"style":459},[4151],{"type":411,"value":515},{"type":405,"tag":430,"props":4153,"children":4154},{"style":453},[4155],{"type":411,"value":4156},"toString",{"type":405,"tag":430,"props":4158,"children":4159},{"style":507},[4160],{"type":411,"value":462},{"type":405,"tag":430,"props":4162,"children":4163},{"style":2021},[4164],{"type":411,"value":4165},"16",{"type":405,"tag":430,"props":4167,"children":4168},{"style":507},[4169],{"type":411,"value":483},{"type":405,"tag":430,"props":4171,"children":4172},{"style":459},[4173],{"type":411,"value":515},{"type":405,"tag":430,"props":4175,"children":4176},{"style":453},[4177],{"type":411,"value":4178},"substr",{"type":405,"tag":430,"props":4180,"children":4181},{"style":507},[4182],{"type":411,"value":462},{"type":405,"tag":430,"props":4184,"children":4185},{"style":2021},[4186],{"type":411,"value":4187},"2",{"type":405,"tag":430,"props":4189,"children":4190},{"style":507},[4191],{"type":411,"value":622},{"type":405,"tag":406,"props":4193,"children":4195},{"id":4194},"考虑的点",[4196],{"type":411,"value":4194},{"type":405,"tag":413,"props":4198,"children":4199},{},[4200],{"type":411,"value":4201},"最后总结一下一些框架设计相关的小细节，如果需要自己设计一个 fs.watch，可能要做以下考虑：",{"type":405,"tag":4203,"props":4204,"children":4205},"ul",{},[4206,4212,4217,4222],{"type":405,"tag":4207,"props":4208,"children":4209},"li",{},[4210],{"type":411,"value":4211},"使用原生依赖吗？使用原生依赖会带来更高的性能，但是也会增加代码难度以及测试的复杂度",{"type":405,"tag":4207,"props":4213,"children":4214},{},[4215],{"type":411,"value":4216},"支持本地符号路径吗？支持网络路径吗？",{"type":405,"tag":4207,"props":4218,"children":4219},{},[4220],{"type":411,"value":4221},"如何控制包的大小？",{"type":405,"tag":4207,"props":4223,"children":4224},{},[4225],{"type":411,"value":4226},"由于不同系统的底层依赖不同，那么 API 要怎么设计，屏蔽底层，才能便于使用？",{"type":405,"tag":413,"props":4228,"children":4229},{},[4230],{"type":411,"value":4231},"也注意到一些有意思的问题：",{"type":405,"tag":4203,"props":4233,"children":4234},{},[4235,4247,4259],{"type":405,"tag":4207,"props":4236,"children":4237},{},[4238,4240],{"type":411,"value":4239},"Windows，删除正在监听的文件夹，",{"type":405,"tag":1161,"props":4241,"children":4244},{"href":4242,"rel":4243},"https://github.com/nodejs/node/issues/31702",[1165],[4245],{"type":411,"value":4246},"会发生什么事情？",{"type":405,"tag":4207,"props":4248,"children":4249},{},[4250,4252],{"type":411,"value":4251},"Linux，单个进程能操作的文件数量有上限，",{"type":405,"tag":1161,"props":4253,"children":4256},{"href":4254,"rel":4255},"https://github.com/nodejs/node-v0.x-archive/issues/2479",[1165],[4257],{"type":411,"value":4258},"该怎么解决？",{"type":405,"tag":4207,"props":4260,"children":4261},{},[4262,4264],{"type":411,"value":4263},"碰到操作系统或应用层面的问题，导致文件在短时间内多次触发更新，",{"type":405,"tag":1161,"props":4265,"children":4268},{"href":4266,"rel":4267},"https://github.com/yuanchuan/node-watch/blob/4cac915ab7cb5cc6a95263712e9def1004c35f78/lib/watch.js#L68",[1165],[4269],{"type":411,"value":4270},"怎么处理呢？",{"type":405,"tag":406,"props":4272,"children":4274},{"id":4273},"题外话",[4275],{"type":411,"value":4273},{"type":405,"tag":4277,"props":4278,"children":4281},"l-link",{"label":4279,"source":4280},"《Recursive Node.js fs.watch on Linux》","https://stackoverflow.com/questions/43112227/recursive-node-js-fs-watch-on-linux",[],{"type":405,"tag":413,"props":4283,"children":4284},{},[4285],{"type":411,"value":4286},"这个回答中的 node-watch 为啥会被踩，我没看很懂。",{"type":405,"tag":406,"props":4288,"children":4290},{"id":4289},"其它资料",[4291],{"type":411,"value":4289},{"type":405,"tag":413,"props":4293,"children":4294},{},[4295],{"type":411,"value":4296},"相关类库：",{"type":405,"tag":4203,"props":4298,"children":4299},{},[4300,4309,4319],{"type":405,"tag":4207,"props":4301,"children":4302},{},[4303],{"type":405,"tag":1161,"props":4304,"children":4307},{"href":4305,"rel":4306},"https://www.npmjs.com/package/watcher",[1165],[4308],{"type":411,"value":2043},{"type":405,"tag":4207,"props":4310,"children":4311},{},[4312],{"type":405,"tag":1161,"props":4313,"children":4316},{"href":4314,"rel":4315},"https://github.com/paulmillr/chokidar",[1165],[4317],{"type":411,"value":4318},"chokidar",{"type":405,"tag":4207,"props":4320,"children":4321},{},[4322],{"type":405,"tag":1161,"props":4323,"children":4326},{"href":4324,"rel":4325},"https://github.com/Axosoft/nsfw",[1165],[4327],{"type":411,"value":4328},"nsfw",{"type":405,"tag":413,"props":4330,"children":4331},{},[4332],{"type":411,"value":4333},"推荐阅读：",{"type":405,"tag":4203,"props":4335,"children":4336},{},[4337,4347],{"type":405,"tag":4207,"props":4338,"children":4339},{},[4340],{"type":405,"tag":1161,"props":4341,"children":4344},{"href":4342,"rel":4343},"https://juejin.cn/post/7000262974430511117",[1165],[4345],{"type":411,"value":4346},"《node-watch、Chokidar封装思路解析》",{"type":405,"tag":4207,"props":4348,"children":4349},{},[4350],{"type":405,"tag":1161,"props":4351,"children":4354},{"href":4352,"rel":4353},"https://www.jianshu.com/p/09dae09457fa",[1165],[4355],{"type":411,"value":4356},"《如何利用 Nodejs 监听文件夹》",{"type":405,"tag":4358,"props":4359,"children":4360},"style",{},[4361],{"type":411,"value":4362},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":398,"searchDepth":443,"depth":443,"links":4364},[4365,4366,4367,4368,4369],{"id":408,"depth":443,"text":408},{"id":3925,"depth":443,"text":3925},{"id":4194,"depth":443,"text":4194},{"id":4273,"depth":443,"text":4273},{"id":4289,"depth":443,"text":4289},"markdown","content:8.source-code:_node:node-watch.md","content","8.source-code/_node/node-watch.md","8.source-code/_node/node-watch","md",[4377,4381],{"_path":4378,"title":4379,"description":4380},"/source-code/_module/is-online","判断 NodeJS 是否在线","之前被组长问道要如何判断 NodeJS 是否在线，我不假思索回答：“Ping 百度试试。”。调用 Ping 需要 child_process，那还不如直接改用内置的 DNS 试试是否在线更简单一些。不过会不会碰到缓存等问题，没往下细想了。今天正好在别人的博客看到了 NodeJS DNS 模块，突然想起这个问题，于是就搜了一下相关库。找到了 internet-available 这个玩意儿。这里一起来看看他们的实现。",{"_path":4382,"title":4383,"description":4384},"/source-code/_ts/type-challenges","TypeScript Type Challenges","TypeScript type challenges",1741604966745]