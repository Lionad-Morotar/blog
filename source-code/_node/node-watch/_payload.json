[{"data":1,"prerenderedAt":4401},["ShallowReactive",2],{"navigation":3,"/source-code/_node/node-watch":410,"/source-code/_node/node-watch-surround":4393},[4,32,83,102,129,135,141,147,393,399,405],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77,80],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":42,"_path":43},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":45,"_path":46},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":48,"_path":49},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":51,"_path":52},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":54,"_path":55},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":57,"_path":58},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":60,"_path":61},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":63,"_path":64},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":66,"_path":67},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":69,"_path":70},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":72,"_path":73},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":75,"_path":76},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":78,"_path":79},"🚝 四十二篇系列","/articles/fourty-two",{"title":81,"_path":82},"📝 技术博客归档","/articles/fold",{"title":84,"_path":85,"children":86},"造物 / Make","/tools",[87,90,93,96,99],{"title":88,"_path":89},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":91,"_path":92},"🌐 AnySort","/tools/anysort",{"title":94,"_path":95},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":97,"_path":98},"👓 Crapto","/tools/crypto-inline",{"title":100,"_path":101},"🖨️ any-to-base64","/tools/any-to-base64",{"title":103,"_path":104,"children":105},"吉他剧场 / Music","/music",[106,108,111,114,117,120,123,126],{"title":107,"_path":104},"🎸 FingerStyle！",{"title":109,"_path":110},"🌬️ 等待的风","/music/wind",{"title":112,"_path":113},"💕 约定的海洋","/music/ocean",{"title":115,"_path":116},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":118,"_path":119},"🌏 残酷天使的行动纲领","/music/eva",{"title":121,"_path":122},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":124,"_path":125},"🍷 Wu Wei","/music/wu-wei",{"title":127,"_path":128},"🌅 无题","/music/untitled",{"title":130,"_path":131,"children":132},"画点什么 / Paint","/paint",[133],{"title":134,"_path":131},"🚧 正在施工",{"title":136,"_path":137,"children":138},"读书笔记 / Notes","/books",[139],{"title":140,"_path":137},"📕 读书笔记",{"title":142,"_path":143,"children":144},"知识地图 / Maps","/maps",[145],{"title":146,"_path":143},"🏁 知识地图",{"title":148,"_path":149,"children":150},"零散的笔记 / Gists","/gists",[151,153,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375,378,381,384,387,390],{"title":152,"_path":149},"🧊 Gists",{"title":154,"_path":155},"网站的可访问性","/gists/accessibility",{"title":157,"_path":158},"Bit","/gists/bit",{"title":160,"_path":161},"图片模糊","/gists/blur",{"title":163,"_path":164},"渲染相关笔记","/gists/c4d",{"title":166,"_path":167},"CDN 问题记录","/gists/cdn",{"title":169,"_path":170},"消毒剂","/gists/cleaner",{"title":172,"_path":173},"Windows Command","/gists/cmd",{"title":175,"_path":176},"Command","/gists/command",{"title":178,"_path":179},"复杂科学","/gists/complexity-science",{"title":181,"_path":182},"GitHub Copilot","/gists/copilot",{"title":184,"_path":185},"宇宙","/gists/cosmos",{"title":187,"_path":188},"C++","/gists/cpp",{"title":190,"_path":191},"Data Structure","/gists/data-structure",{"title":193,"_path":194},"DEPRESSION","/gists/depression",{"title":196,"_path":197},"设计模式","/gists/design-patterns",{"title":199,"_path":200},"Developer Experience","/gists/developer-experience",{"title":202,"_path":203},"Device Metrics","/gists/device-metrix",{"title":205,"_path":206},"数字化转型","/gists/digital-transformation",{"title":208,"_path":209},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":211,"_path":212},"正则表达式","/gists/eegex",{"title":214,"_path":215},"Emoji","/gists/emoji",{"title":217,"_path":218},"工程","/gists/engineering",{"title":220,"_path":221},"熵","/gists/entropy",{"title":223,"_path":224},"Environment","/gists/environment",{"title":226,"_path":227},"Erlang","/gists/erlang",{"title":229,"_path":230},"逃离塔克夫","/gists/escape-from-tarkov",{"title":232,"_path":233},"ESNext (ES6-ES11)","/gists/esnext",{"title":235,"_path":236},"Eval！","/gists/eval",{"title":238,"_path":239},"Flutter","/gists/flutter",{"title":241,"_path":242},"字体","/gists/font",{"title":244,"_path":245},"JS 函数式编程","/gists/functional",{"title":247,"_path":248},"游戏化","/gists/gamification",{"title":250,"_path":251},"Google C++ Standard","/gists/google-cpp-standard",{"title":253,"_path":254},"双向链接完全体","/gists/graph",{"title":256,"_path":257},"Hardwares","/gists/hardwares",{"title":259,"_path":260},"哈希冲突","/gists/hash-collision",{"title":262,"_path":263},"信息设计","/gists/information-design",{"title":265,"_path":266},"InstantPage","/gists/instant.page",{"title":268,"_path":269},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":271,"_path":272},"KVStore","/gists/key-value-db",{"title":274,"_path":275},"Kubernetes","/gists/kubernetes",{"title":277,"_path":278},"Makefile","/gists/makefile",{"title":280,"_path":281},"Markdown Inline Style","/gists/markdown-nice",{"title":283,"_path":284},"小程序","/gists/miniapp",{"title":286,"_path":287},"减小页面快照体积","/gists/minify-html",{"title":289,"_path":290},"mklink","/gists/mklink",{"title":292,"_path":293},"Mock","/gists/mock",{"title":295,"_path":296},"多人协作系统","/gists/multiplayer",{"title":298,"_path":299},"多端应用","/gists/multy-end-app",{"title":301,"_path":302},"神经科学","/gists/neuroscience",{"title":304,"_path":305},"OO","/gists/oo",{"title":307,"_path":308},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":310,"_path":311},"PInvoke","/gists/pinvoke",{"title":313,"_path":314},"像素","/gists/pixel",{"title":316,"_path":317},"PowerShell","/gists/powershell",{"title":319,"_path":320},"量子","/gists/quantum",{"title":322,"_path":323},"保持好奇心","/gists/questions",{"title":325,"_path":326},"React Native","/gists/react-native",{"title":328,"_path":329},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":331,"_path":332},"SEO","/gists/seo",{"title":334,"_path":335},"Shader","/gists/shader",{"title":337,"_path":338},"Shape Up","/gists/shape-up",{"title":340,"_path":341},"睡觉","/gists/sleep",{"title":343,"_path":344},"记录奇怪的问题","/gists/solved",{"title":346,"_path":347},"States","/gists/states",{"title":349,"_path":350},"Storage","/gists/storage",{"title":352,"_path":353},"音视频流处理","/gists/stream-cli",{"title":355,"_path":356},"Symbol","/gists/symbol",{"title":358,"_path":359},"系统论","/gists/systems-theory",{"title":361,"_path":362},"Taro","/gists/taro",{"title":364,"_path":365},"任务切片","/gists/task-slice",{"title":367,"_path":368},"技术偏好","/gists/tech-dudge",{"title":370,"_path":371},"Untitled","/gists/untitled",{"title":373,"_path":374},"可变字体","/gists/variable-font",{"title":376,"_path":377},"视觉错觉","/gists/visual-illusion",{"title":379,"_path":380},"SS(SSR)","/gists/vpn",{"title":382,"_path":383},"VS Code 插件开发","/gists/vscode-plugin",{"title":385,"_path":386},"Web Components","/gists/web-components",{"title":388,"_path":389},"Windows","/gists/windows",{"title":391,"_path":392},"查缺补漏","/gists/wrong",{"title":394,"_path":395,"children":396},"代码笔记 / Gists","/source-code",[397],{"title":398,"_path":395},"🚄 代码笔记",{"title":400,"_path":401,"children":402},"我 / Abount","/hire",[403],{"title":404,"_path":401},"📬 技术简历",{"title":406,"_path":407,"children":408},"todo","/todo",[409],{"title":406,"_path":407},{"_path":411,"_dir":412,"_draft":413,"_partial":414,"_locale":415,"title":416,"description":417,"body":418,"_type":4387,"_id":4388,"_source":4389,"_file":4390,"_stem":4391,"_extension":4392},"/source-code/_node/node-watch","_node",false,true,"","node-watch","node-watch 是在 fs.watch 的基础上封装而来的库，能监听文件变化",{"type":419,"children":420,"toc":4380},"root",[421,429,435,1172,1188,1465,1470,1647,1652,2322,2327,2784,2789,3940,3945,3950,4107,4112,4209,4214,4219,4244,4249,4288,4293,4299,4304,4309,4314,4346,4351,4374],{"type":422,"tag":423,"props":424,"children":426},"element","h2",{"id":425},"实现",[427],{"type":428,"value":425},"text",{"type":422,"tag":430,"props":431,"children":432},"p",{},[433],{"type":428,"value":434},"从提交历史来看，最初的提交的代码非常简单，几乎是只多了一个递归监听功能。在 normalizeCall 函数中使用计时函数，把回调往后延迟了 100ms，防止短暂时间内同一个文件多次修改（比方说某些编辑器保存文件时会先生成一个临时文件）。",{"type":422,"tag":436,"props":437,"children":441},"pre",{"className":438,"code":439,"language":440,"meta":415,"style":415},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","//  https://github.com/yuanchuan/node-watch/commit/d2d8e2db4b771f918d67d261708752d8eb5c17b3\nfunction watch(dir, cb) {\n  if (is.File(dir)) {\n    fs.watchFile(dir, function(err) {\n      normalizeCall(cb, dir)\n    })\n    return\n  }\n  if (is.Directory(dir)) {\n    fs.watch(dir, function(err, fname) {\n      normalizeCall(cb,  \n        path.join(dir, fname)\n      )\n    })\n    fs.readdir(dir, function(err, files) {\n      if (err) throw err\n      files.forEach(function(n) { \n        var file = path.join(dir, n)\n        if ( is.Directory(file) ) {\n          watch(file, cb)\n        }\n      })\n    })     \n  }\n} \n","js",[442],{"type":422,"tag":443,"props":444,"children":445},"code",{"__ignoreMap":415},[446,458,506,556,608,640,653,662,671,712,770,795,833,842,854,912,944,993,1047,1091,1120,1129,1142,1155,1163],{"type":422,"tag":447,"props":448,"children":451},"span",{"class":449,"line":450},"line",1,[452],{"type":422,"tag":447,"props":453,"children":455},{"style":454},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[456],{"type":428,"value":457},"//  https://github.com/yuanchuan/node-watch/commit/d2d8e2db4b771f918d67d261708752d8eb5c17b3\n",{"type":422,"tag":447,"props":459,"children":461},{"class":449,"line":460},2,[462,468,474,480,486,491,496,501],{"type":422,"tag":447,"props":463,"children":465},{"style":464},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[466],{"type":428,"value":467},"function",{"type":422,"tag":447,"props":469,"children":471},{"style":470},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[472],{"type":428,"value":473}," watch",{"type":422,"tag":447,"props":475,"children":477},{"style":476},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[478],{"type":428,"value":479},"(",{"type":422,"tag":447,"props":481,"children":483},{"style":482},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[484],{"type":428,"value":485},"dir",{"type":422,"tag":447,"props":487,"children":488},{"style":476},[489],{"type":428,"value":490},",",{"type":422,"tag":447,"props":492,"children":493},{"style":482},[494],{"type":428,"value":495}," cb",{"type":422,"tag":447,"props":497,"children":498},{"style":476},[499],{"type":428,"value":500},")",{"type":422,"tag":447,"props":502,"children":503},{"style":476},[504],{"type":428,"value":505}," {\n",{"type":422,"tag":447,"props":507,"children":509},{"class":449,"line":508},3,[510,516,522,528,533,538,542,546,551],{"type":422,"tag":447,"props":511,"children":513},{"style":512},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[514],{"type":428,"value":515},"  if",{"type":422,"tag":447,"props":517,"children":519},{"style":518},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[520],{"type":428,"value":521}," (",{"type":422,"tag":447,"props":523,"children":525},{"style":524},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[526],{"type":428,"value":527},"is",{"type":422,"tag":447,"props":529,"children":530},{"style":476},[531],{"type":428,"value":532},".",{"type":422,"tag":447,"props":534,"children":535},{"style":470},[536],{"type":428,"value":537},"File",{"type":422,"tag":447,"props":539,"children":540},{"style":518},[541],{"type":428,"value":479},{"type":422,"tag":447,"props":543,"children":544},{"style":524},[545],{"type":428,"value":485},{"type":422,"tag":447,"props":547,"children":548},{"style":518},[549],{"type":428,"value":550},")) ",{"type":422,"tag":447,"props":552,"children":553},{"style":476},[554],{"type":428,"value":555},"{\n",{"type":422,"tag":447,"props":557,"children":559},{"class":449,"line":558},4,[560,565,569,574,578,582,586,591,595,600,604],{"type":422,"tag":447,"props":561,"children":562},{"style":524},[563],{"type":428,"value":564},"    fs",{"type":422,"tag":447,"props":566,"children":567},{"style":476},[568],{"type":428,"value":532},{"type":422,"tag":447,"props":570,"children":571},{"style":470},[572],{"type":428,"value":573},"watchFile",{"type":422,"tag":447,"props":575,"children":576},{"style":518},[577],{"type":428,"value":479},{"type":422,"tag":447,"props":579,"children":580},{"style":524},[581],{"type":428,"value":485},{"type":422,"tag":447,"props":583,"children":584},{"style":476},[585],{"type":428,"value":490},{"type":422,"tag":447,"props":587,"children":588},{"style":464},[589],{"type":428,"value":590}," function",{"type":422,"tag":447,"props":592,"children":593},{"style":476},[594],{"type":428,"value":479},{"type":422,"tag":447,"props":596,"children":597},{"style":482},[598],{"type":428,"value":599},"err",{"type":422,"tag":447,"props":601,"children":602},{"style":476},[603],{"type":428,"value":500},{"type":422,"tag":447,"props":605,"children":606},{"style":476},[607],{"type":428,"value":505},{"type":422,"tag":447,"props":609,"children":611},{"class":449,"line":610},5,[612,617,621,626,630,635],{"type":422,"tag":447,"props":613,"children":614},{"style":470},[615],{"type":428,"value":616},"      normalizeCall",{"type":422,"tag":447,"props":618,"children":619},{"style":518},[620],{"type":428,"value":479},{"type":422,"tag":447,"props":622,"children":623},{"style":524},[624],{"type":428,"value":625},"cb",{"type":422,"tag":447,"props":627,"children":628},{"style":476},[629],{"type":428,"value":490},{"type":422,"tag":447,"props":631,"children":632},{"style":524},[633],{"type":428,"value":634}," dir",{"type":422,"tag":447,"props":636,"children":637},{"style":518},[638],{"type":428,"value":639},")\n",{"type":422,"tag":447,"props":641,"children":643},{"class":449,"line":642},6,[644,649],{"type":422,"tag":447,"props":645,"children":646},{"style":476},[647],{"type":428,"value":648},"    }",{"type":422,"tag":447,"props":650,"children":651},{"style":518},[652],{"type":428,"value":639},{"type":422,"tag":447,"props":654,"children":656},{"class":449,"line":655},7,[657],{"type":422,"tag":447,"props":658,"children":659},{"style":512},[660],{"type":428,"value":661},"    return\n",{"type":422,"tag":447,"props":663,"children":665},{"class":449,"line":664},8,[666],{"type":422,"tag":447,"props":667,"children":668},{"style":476},[669],{"type":428,"value":670},"  }\n",{"type":422,"tag":447,"props":672,"children":674},{"class":449,"line":673},9,[675,679,683,687,691,696,700,704,708],{"type":422,"tag":447,"props":676,"children":677},{"style":512},[678],{"type":428,"value":515},{"type":422,"tag":447,"props":680,"children":681},{"style":518},[682],{"type":428,"value":521},{"type":422,"tag":447,"props":684,"children":685},{"style":524},[686],{"type":428,"value":527},{"type":422,"tag":447,"props":688,"children":689},{"style":476},[690],{"type":428,"value":532},{"type":422,"tag":447,"props":692,"children":693},{"style":470},[694],{"type":428,"value":695},"Directory",{"type":422,"tag":447,"props":697,"children":698},{"style":518},[699],{"type":428,"value":479},{"type":422,"tag":447,"props":701,"children":702},{"style":524},[703],{"type":428,"value":485},{"type":422,"tag":447,"props":705,"children":706},{"style":518},[707],{"type":428,"value":550},{"type":422,"tag":447,"props":709,"children":710},{"style":476},[711],{"type":428,"value":555},{"type":422,"tag":447,"props":713,"children":715},{"class":449,"line":714},10,[716,720,724,729,733,737,741,745,749,753,757,762,766],{"type":422,"tag":447,"props":717,"children":718},{"style":524},[719],{"type":428,"value":564},{"type":422,"tag":447,"props":721,"children":722},{"style":476},[723],{"type":428,"value":532},{"type":422,"tag":447,"props":725,"children":726},{"style":470},[727],{"type":428,"value":728},"watch",{"type":422,"tag":447,"props":730,"children":731},{"style":518},[732],{"type":428,"value":479},{"type":422,"tag":447,"props":734,"children":735},{"style":524},[736],{"type":428,"value":485},{"type":422,"tag":447,"props":738,"children":739},{"style":476},[740],{"type":428,"value":490},{"type":422,"tag":447,"props":742,"children":743},{"style":464},[744],{"type":428,"value":590},{"type":422,"tag":447,"props":746,"children":747},{"style":476},[748],{"type":428,"value":479},{"type":422,"tag":447,"props":750,"children":751},{"style":482},[752],{"type":428,"value":599},{"type":422,"tag":447,"props":754,"children":755},{"style":476},[756],{"type":428,"value":490},{"type":422,"tag":447,"props":758,"children":759},{"style":482},[760],{"type":428,"value":761}," fname",{"type":422,"tag":447,"props":763,"children":764},{"style":476},[765],{"type":428,"value":500},{"type":422,"tag":447,"props":767,"children":768},{"style":476},[769],{"type":428,"value":505},{"type":422,"tag":447,"props":771,"children":773},{"class":449,"line":772},11,[774,778,782,786,790],{"type":422,"tag":447,"props":775,"children":776},{"style":470},[777],{"type":428,"value":616},{"type":422,"tag":447,"props":779,"children":780},{"style":518},[781],{"type":428,"value":479},{"type":422,"tag":447,"props":783,"children":784},{"style":524},[785],{"type":428,"value":625},{"type":422,"tag":447,"props":787,"children":788},{"style":476},[789],{"type":428,"value":490},{"type":422,"tag":447,"props":791,"children":792},{"style":518},[793],{"type":428,"value":794},"  \n",{"type":422,"tag":447,"props":796,"children":798},{"class":449,"line":797},12,[799,804,808,813,817,821,825,829],{"type":422,"tag":447,"props":800,"children":801},{"style":524},[802],{"type":428,"value":803},"        path",{"type":422,"tag":447,"props":805,"children":806},{"style":476},[807],{"type":428,"value":532},{"type":422,"tag":447,"props":809,"children":810},{"style":470},[811],{"type":428,"value":812},"join",{"type":422,"tag":447,"props":814,"children":815},{"style":518},[816],{"type":428,"value":479},{"type":422,"tag":447,"props":818,"children":819},{"style":524},[820],{"type":428,"value":485},{"type":422,"tag":447,"props":822,"children":823},{"style":476},[824],{"type":428,"value":490},{"type":422,"tag":447,"props":826,"children":827},{"style":524},[828],{"type":428,"value":761},{"type":422,"tag":447,"props":830,"children":831},{"style":518},[832],{"type":428,"value":639},{"type":422,"tag":447,"props":834,"children":836},{"class":449,"line":835},13,[837],{"type":422,"tag":447,"props":838,"children":839},{"style":518},[840],{"type":428,"value":841},"      )\n",{"type":422,"tag":447,"props":843,"children":845},{"class":449,"line":844},14,[846,850],{"type":422,"tag":447,"props":847,"children":848},{"style":476},[849],{"type":428,"value":648},{"type":422,"tag":447,"props":851,"children":852},{"style":518},[853],{"type":428,"value":639},{"type":422,"tag":447,"props":855,"children":857},{"class":449,"line":856},15,[858,862,866,871,875,879,883,887,891,895,899,904,908],{"type":422,"tag":447,"props":859,"children":860},{"style":524},[861],{"type":428,"value":564},{"type":422,"tag":447,"props":863,"children":864},{"style":476},[865],{"type":428,"value":532},{"type":422,"tag":447,"props":867,"children":868},{"style":470},[869],{"type":428,"value":870},"readdir",{"type":422,"tag":447,"props":872,"children":873},{"style":518},[874],{"type":428,"value":479},{"type":422,"tag":447,"props":876,"children":877},{"style":524},[878],{"type":428,"value":485},{"type":422,"tag":447,"props":880,"children":881},{"style":476},[882],{"type":428,"value":490},{"type":422,"tag":447,"props":884,"children":885},{"style":464},[886],{"type":428,"value":590},{"type":422,"tag":447,"props":888,"children":889},{"style":476},[890],{"type":428,"value":479},{"type":422,"tag":447,"props":892,"children":893},{"style":482},[894],{"type":428,"value":599},{"type":422,"tag":447,"props":896,"children":897},{"style":476},[898],{"type":428,"value":490},{"type":422,"tag":447,"props":900,"children":901},{"style":482},[902],{"type":428,"value":903}," files",{"type":422,"tag":447,"props":905,"children":906},{"style":476},[907],{"type":428,"value":500},{"type":422,"tag":447,"props":909,"children":910},{"style":476},[911],{"type":428,"value":505},{"type":422,"tag":447,"props":913,"children":915},{"class":449,"line":914},16,[916,921,925,929,934,939],{"type":422,"tag":447,"props":917,"children":918},{"style":512},[919],{"type":428,"value":920},"      if",{"type":422,"tag":447,"props":922,"children":923},{"style":518},[924],{"type":428,"value":521},{"type":422,"tag":447,"props":926,"children":927},{"style":524},[928],{"type":428,"value":599},{"type":422,"tag":447,"props":930,"children":931},{"style":518},[932],{"type":428,"value":933},") ",{"type":422,"tag":447,"props":935,"children":936},{"style":512},[937],{"type":428,"value":938},"throw",{"type":422,"tag":447,"props":940,"children":941},{"style":524},[942],{"type":428,"value":943}," err\n",{"type":422,"tag":447,"props":945,"children":947},{"class":449,"line":946},17,[948,953,957,962,966,970,974,979,983,988],{"type":422,"tag":447,"props":949,"children":950},{"style":524},[951],{"type":428,"value":952},"      files",{"type":422,"tag":447,"props":954,"children":955},{"style":476},[956],{"type":428,"value":532},{"type":422,"tag":447,"props":958,"children":959},{"style":470},[960],{"type":428,"value":961},"forEach",{"type":422,"tag":447,"props":963,"children":964},{"style":518},[965],{"type":428,"value":479},{"type":422,"tag":447,"props":967,"children":968},{"style":464},[969],{"type":428,"value":467},{"type":422,"tag":447,"props":971,"children":972},{"style":476},[973],{"type":428,"value":479},{"type":422,"tag":447,"props":975,"children":976},{"style":482},[977],{"type":428,"value":978},"n",{"type":422,"tag":447,"props":980,"children":981},{"style":476},[982],{"type":428,"value":500},{"type":422,"tag":447,"props":984,"children":985},{"style":476},[986],{"type":428,"value":987}," {",{"type":422,"tag":447,"props":989,"children":990},{"style":518},[991],{"type":428,"value":992}," \n",{"type":422,"tag":447,"props":994,"children":996},{"class":449,"line":995},18,[997,1002,1007,1013,1018,1022,1026,1030,1034,1038,1043],{"type":422,"tag":447,"props":998,"children":999},{"style":464},[1000],{"type":428,"value":1001},"        var",{"type":422,"tag":447,"props":1003,"children":1004},{"style":524},[1005],{"type":428,"value":1006}," file",{"type":422,"tag":447,"props":1008,"children":1010},{"style":1009},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1011],{"type":428,"value":1012}," =",{"type":422,"tag":447,"props":1014,"children":1015},{"style":524},[1016],{"type":428,"value":1017}," path",{"type":422,"tag":447,"props":1019,"children":1020},{"style":476},[1021],{"type":428,"value":532},{"type":422,"tag":447,"props":1023,"children":1024},{"style":470},[1025],{"type":428,"value":812},{"type":422,"tag":447,"props":1027,"children":1028},{"style":518},[1029],{"type":428,"value":479},{"type":422,"tag":447,"props":1031,"children":1032},{"style":524},[1033],{"type":428,"value":485},{"type":422,"tag":447,"props":1035,"children":1036},{"style":476},[1037],{"type":428,"value":490},{"type":422,"tag":447,"props":1039,"children":1040},{"style":524},[1041],{"type":428,"value":1042}," n",{"type":422,"tag":447,"props":1044,"children":1045},{"style":518},[1046],{"type":428,"value":639},{"type":422,"tag":447,"props":1048,"children":1050},{"class":449,"line":1049},19,[1051,1056,1061,1065,1069,1073,1077,1082,1087],{"type":422,"tag":447,"props":1052,"children":1053},{"style":512},[1054],{"type":428,"value":1055},"        if",{"type":422,"tag":447,"props":1057,"children":1058},{"style":518},[1059],{"type":428,"value":1060}," ( ",{"type":422,"tag":447,"props":1062,"children":1063},{"style":524},[1064],{"type":428,"value":527},{"type":422,"tag":447,"props":1066,"children":1067},{"style":476},[1068],{"type":428,"value":532},{"type":422,"tag":447,"props":1070,"children":1071},{"style":470},[1072],{"type":428,"value":695},{"type":422,"tag":447,"props":1074,"children":1075},{"style":518},[1076],{"type":428,"value":479},{"type":422,"tag":447,"props":1078,"children":1079},{"style":524},[1080],{"type":428,"value":1081},"file",{"type":422,"tag":447,"props":1083,"children":1084},{"style":518},[1085],{"type":428,"value":1086},") ) ",{"type":422,"tag":447,"props":1088,"children":1089},{"style":476},[1090],{"type":428,"value":555},{"type":422,"tag":447,"props":1092,"children":1094},{"class":449,"line":1093},20,[1095,1100,1104,1108,1112,1116],{"type":422,"tag":447,"props":1096,"children":1097},{"style":470},[1098],{"type":428,"value":1099},"          watch",{"type":422,"tag":447,"props":1101,"children":1102},{"style":518},[1103],{"type":428,"value":479},{"type":422,"tag":447,"props":1105,"children":1106},{"style":524},[1107],{"type":428,"value":1081},{"type":422,"tag":447,"props":1109,"children":1110},{"style":476},[1111],{"type":428,"value":490},{"type":422,"tag":447,"props":1113,"children":1114},{"style":524},[1115],{"type":428,"value":495},{"type":422,"tag":447,"props":1117,"children":1118},{"style":518},[1119],{"type":428,"value":639},{"type":422,"tag":447,"props":1121,"children":1123},{"class":449,"line":1122},21,[1124],{"type":422,"tag":447,"props":1125,"children":1126},{"style":476},[1127],{"type":428,"value":1128},"        }\n",{"type":422,"tag":447,"props":1130,"children":1132},{"class":449,"line":1131},22,[1133,1138],{"type":422,"tag":447,"props":1134,"children":1135},{"style":476},[1136],{"type":428,"value":1137},"      }",{"type":422,"tag":447,"props":1139,"children":1140},{"style":518},[1141],{"type":428,"value":639},{"type":422,"tag":447,"props":1143,"children":1145},{"class":449,"line":1144},23,[1146,1150],{"type":422,"tag":447,"props":1147,"children":1148},{"style":476},[1149],{"type":428,"value":648},{"type":422,"tag":447,"props":1151,"children":1152},{"style":518},[1153],{"type":428,"value":1154},")     \n",{"type":422,"tag":447,"props":1156,"children":1158},{"class":449,"line":1157},24,[1159],{"type":422,"tag":447,"props":1160,"children":1161},{"style":476},[1162],{"type":428,"value":670},{"type":422,"tag":447,"props":1164,"children":1166},{"class":449,"line":1165},25,[1167],{"type":422,"tag":447,"props":1168,"children":1169},{"style":476},[1170],{"type":428,"value":1171},"}\n",{"type":422,"tag":430,"props":1173,"children":1174},{},[1175,1177,1186],{"type":428,"value":1176},"由于 fs.watchFile 可能导致",{"type":422,"tag":1178,"props":1179,"children":1183},"a",{"href":1180,"rel":1181},"https://nodejs.org/api/fs.html#fs_fs_watchfile_filename_options_listener",[1182],"nofollow",[1184],{"type":428,"value":1185},"高 CPU 负载等问题",{"type":428,"value":1187},"，watch 文件时使用 watch 其父目录作替代，并通过匹配事件参数是否和此文件同名来判断是否要触发回调函数。",{"type":422,"tag":436,"props":1189,"children":1191},{"className":438,"code":1190,"language":440,"meta":415,"style":415},"if (is.file(fpath)) {\n  var parent = path.resolve(fpath, '..')\n  fs.watch(parent, function(evt, fname) {\n    if (path.basename(fpath) === fname) {\n      normalizeCall(fpath, options, cb)\n    }\n  })\n} \n",[1192],{"type":422,"tag":443,"props":1193,"children":1194},{"__ignoreMap":415},[1195,1225,1289,1347,1402,1438,1446,1458],{"type":422,"tag":447,"props":1196,"children":1197},{"class":449,"line":450},[1198,1203,1208,1212,1216,1221],{"type":422,"tag":447,"props":1199,"children":1200},{"style":512},[1201],{"type":428,"value":1202},"if",{"type":422,"tag":447,"props":1204,"children":1205},{"style":524},[1206],{"type":428,"value":1207}," (is",{"type":422,"tag":447,"props":1209,"children":1210},{"style":476},[1211],{"type":428,"value":532},{"type":422,"tag":447,"props":1213,"children":1214},{"style":470},[1215],{"type":428,"value":1081},{"type":422,"tag":447,"props":1217,"children":1218},{"style":524},[1219],{"type":428,"value":1220},"(fpath)) ",{"type":422,"tag":447,"props":1222,"children":1223},{"style":476},[1224],{"type":428,"value":555},{"type":422,"tag":447,"props":1226,"children":1227},{"class":449,"line":460},[1228,1233,1238,1242,1246,1250,1255,1259,1264,1268,1274,1280,1285],{"type":422,"tag":447,"props":1229,"children":1230},{"style":464},[1231],{"type":428,"value":1232},"  var",{"type":422,"tag":447,"props":1234,"children":1235},{"style":524},[1236],{"type":428,"value":1237}," parent",{"type":422,"tag":447,"props":1239,"children":1240},{"style":1009},[1241],{"type":428,"value":1012},{"type":422,"tag":447,"props":1243,"children":1244},{"style":524},[1245],{"type":428,"value":1017},{"type":422,"tag":447,"props":1247,"children":1248},{"style":476},[1249],{"type":428,"value":532},{"type":422,"tag":447,"props":1251,"children":1252},{"style":470},[1253],{"type":428,"value":1254},"resolve",{"type":422,"tag":447,"props":1256,"children":1257},{"style":518},[1258],{"type":428,"value":479},{"type":422,"tag":447,"props":1260,"children":1261},{"style":524},[1262],{"type":428,"value":1263},"fpath",{"type":422,"tag":447,"props":1265,"children":1266},{"style":476},[1267],{"type":428,"value":490},{"type":422,"tag":447,"props":1269,"children":1271},{"style":1270},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[1272],{"type":428,"value":1273}," '",{"type":422,"tag":447,"props":1275,"children":1277},{"style":1276},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[1278],{"type":428,"value":1279},"..",{"type":422,"tag":447,"props":1281,"children":1282},{"style":1270},[1283],{"type":428,"value":1284},"'",{"type":422,"tag":447,"props":1286,"children":1287},{"style":518},[1288],{"type":428,"value":639},{"type":422,"tag":447,"props":1290,"children":1291},{"class":449,"line":508},[1292,1297,1301,1305,1309,1314,1318,1322,1326,1331,1335,1339,1343],{"type":422,"tag":447,"props":1293,"children":1294},{"style":524},[1295],{"type":428,"value":1296},"  fs",{"type":422,"tag":447,"props":1298,"children":1299},{"style":476},[1300],{"type":428,"value":532},{"type":422,"tag":447,"props":1302,"children":1303},{"style":470},[1304],{"type":428,"value":728},{"type":422,"tag":447,"props":1306,"children":1307},{"style":518},[1308],{"type":428,"value":479},{"type":422,"tag":447,"props":1310,"children":1311},{"style":524},[1312],{"type":428,"value":1313},"parent",{"type":422,"tag":447,"props":1315,"children":1316},{"style":476},[1317],{"type":428,"value":490},{"type":422,"tag":447,"props":1319,"children":1320},{"style":464},[1321],{"type":428,"value":590},{"type":422,"tag":447,"props":1323,"children":1324},{"style":476},[1325],{"type":428,"value":479},{"type":422,"tag":447,"props":1327,"children":1328},{"style":482},[1329],{"type":428,"value":1330},"evt",{"type":422,"tag":447,"props":1332,"children":1333},{"style":476},[1334],{"type":428,"value":490},{"type":422,"tag":447,"props":1336,"children":1337},{"style":482},[1338],{"type":428,"value":761},{"type":422,"tag":447,"props":1340,"children":1341},{"style":476},[1342],{"type":428,"value":500},{"type":422,"tag":447,"props":1344,"children":1345},{"style":476},[1346],{"type":428,"value":505},{"type":422,"tag":447,"props":1348,"children":1349},{"class":449,"line":558},[1350,1355,1359,1364,1368,1373,1377,1381,1385,1390,1394,1398],{"type":422,"tag":447,"props":1351,"children":1352},{"style":512},[1353],{"type":428,"value":1354},"    if",{"type":422,"tag":447,"props":1356,"children":1357},{"style":518},[1358],{"type":428,"value":521},{"type":422,"tag":447,"props":1360,"children":1361},{"style":524},[1362],{"type":428,"value":1363},"path",{"type":422,"tag":447,"props":1365,"children":1366},{"style":476},[1367],{"type":428,"value":532},{"type":422,"tag":447,"props":1369,"children":1370},{"style":470},[1371],{"type":428,"value":1372},"basename",{"type":422,"tag":447,"props":1374,"children":1375},{"style":518},[1376],{"type":428,"value":479},{"type":422,"tag":447,"props":1378,"children":1379},{"style":524},[1380],{"type":428,"value":1263},{"type":422,"tag":447,"props":1382,"children":1383},{"style":518},[1384],{"type":428,"value":933},{"type":422,"tag":447,"props":1386,"children":1387},{"style":1009},[1388],{"type":428,"value":1389},"===",{"type":422,"tag":447,"props":1391,"children":1392},{"style":524},[1393],{"type":428,"value":761},{"type":422,"tag":447,"props":1395,"children":1396},{"style":518},[1397],{"type":428,"value":933},{"type":422,"tag":447,"props":1399,"children":1400},{"style":476},[1401],{"type":428,"value":555},{"type":422,"tag":447,"props":1403,"children":1404},{"class":449,"line":610},[1405,1409,1413,1417,1421,1426,1430,1434],{"type":422,"tag":447,"props":1406,"children":1407},{"style":470},[1408],{"type":428,"value":616},{"type":422,"tag":447,"props":1410,"children":1411},{"style":518},[1412],{"type":428,"value":479},{"type":422,"tag":447,"props":1414,"children":1415},{"style":524},[1416],{"type":428,"value":1263},{"type":422,"tag":447,"props":1418,"children":1419},{"style":476},[1420],{"type":428,"value":490},{"type":422,"tag":447,"props":1422,"children":1423},{"style":524},[1424],{"type":428,"value":1425}," options",{"type":422,"tag":447,"props":1427,"children":1428},{"style":476},[1429],{"type":428,"value":490},{"type":422,"tag":447,"props":1431,"children":1432},{"style":524},[1433],{"type":428,"value":495},{"type":422,"tag":447,"props":1435,"children":1436},{"style":518},[1437],{"type":428,"value":639},{"type":422,"tag":447,"props":1439,"children":1440},{"class":449,"line":642},[1441],{"type":422,"tag":447,"props":1442,"children":1443},{"style":476},[1444],{"type":428,"value":1445},"    }\n",{"type":422,"tag":447,"props":1447,"children":1448},{"class":449,"line":655},[1449,1454],{"type":422,"tag":447,"props":1450,"children":1451},{"style":476},[1452],{"type":428,"value":1453},"  }",{"type":422,"tag":447,"props":1455,"children":1456},{"style":518},[1457],{"type":428,"value":639},{"type":422,"tag":447,"props":1459,"children":1460},{"class":449,"line":664},[1461],{"type":422,"tag":447,"props":1462,"children":1463},{"style":476},[1464],{"type":428,"value":1171},{"type":422,"tag":430,"props":1466,"children":1467},{},[1468],{"type":428,"value":1469},"如果目录中带有符号链接，node-watch 会默认跟踪下去，同时使用一个默认的 maxSymbolLevel 数字配置项，设置最大跟踪层数，防止死循环或性能问题。",{"type":422,"tag":436,"props":1471,"children":1473},{"className":438,"code":1472,"language":440,"meta":415,"style":415},"function watch(fpath, options, cb) {\n  if (is.symbolic(fpath) \n    && !(options.followSymLinks \n      && options.maxSymLevel--)) {\n    return\n  }\n}\n",[1474],{"type":422,"tag":443,"props":1475,"children":1476},{"__ignoreMap":415},[1477,1520,1557,1592,1626,1633,1640],{"type":422,"tag":447,"props":1478,"children":1479},{"class":449,"line":450},[1480,1484,1488,1492,1496,1500,1504,1508,1512,1516],{"type":422,"tag":447,"props":1481,"children":1482},{"style":464},[1483],{"type":428,"value":467},{"type":422,"tag":447,"props":1485,"children":1486},{"style":470},[1487],{"type":428,"value":473},{"type":422,"tag":447,"props":1489,"children":1490},{"style":476},[1491],{"type":428,"value":479},{"type":422,"tag":447,"props":1493,"children":1494},{"style":482},[1495],{"type":428,"value":1263},{"type":422,"tag":447,"props":1497,"children":1498},{"style":476},[1499],{"type":428,"value":490},{"type":422,"tag":447,"props":1501,"children":1502},{"style":482},[1503],{"type":428,"value":1425},{"type":422,"tag":447,"props":1505,"children":1506},{"style":476},[1507],{"type":428,"value":490},{"type":422,"tag":447,"props":1509,"children":1510},{"style":482},[1511],{"type":428,"value":495},{"type":422,"tag":447,"props":1513,"children":1514},{"style":476},[1515],{"type":428,"value":500},{"type":422,"tag":447,"props":1517,"children":1518},{"style":476},[1519],{"type":428,"value":505},{"type":422,"tag":447,"props":1521,"children":1522},{"class":449,"line":460},[1523,1527,1531,1535,1539,1544,1548,1552],{"type":422,"tag":447,"props":1524,"children":1525},{"style":512},[1526],{"type":428,"value":515},{"type":422,"tag":447,"props":1528,"children":1529},{"style":518},[1530],{"type":428,"value":521},{"type":422,"tag":447,"props":1532,"children":1533},{"style":524},[1534],{"type":428,"value":527},{"type":422,"tag":447,"props":1536,"children":1537},{"style":476},[1538],{"type":428,"value":532},{"type":422,"tag":447,"props":1540,"children":1541},{"style":470},[1542],{"type":428,"value":1543},"symbolic",{"type":422,"tag":447,"props":1545,"children":1546},{"style":518},[1547],{"type":428,"value":479},{"type":422,"tag":447,"props":1549,"children":1550},{"style":524},[1551],{"type":428,"value":1263},{"type":422,"tag":447,"props":1553,"children":1554},{"style":518},[1555],{"type":428,"value":1556},") \n",{"type":422,"tag":447,"props":1558,"children":1559},{"class":449,"line":508},[1560,1565,1570,1574,1579,1583,1588],{"type":422,"tag":447,"props":1561,"children":1562},{"style":1009},[1563],{"type":428,"value":1564},"    &&",{"type":422,"tag":447,"props":1566,"children":1567},{"style":1009},[1568],{"type":428,"value":1569}," !",{"type":422,"tag":447,"props":1571,"children":1572},{"style":518},[1573],{"type":428,"value":479},{"type":422,"tag":447,"props":1575,"children":1576},{"style":524},[1577],{"type":428,"value":1578},"options",{"type":422,"tag":447,"props":1580,"children":1581},{"style":476},[1582],{"type":428,"value":532},{"type":422,"tag":447,"props":1584,"children":1585},{"style":524},[1586],{"type":428,"value":1587},"followSymLinks",{"type":422,"tag":447,"props":1589,"children":1590},{"style":518},[1591],{"type":428,"value":992},{"type":422,"tag":447,"props":1593,"children":1594},{"class":449,"line":558},[1595,1600,1604,1608,1613,1618,1622],{"type":422,"tag":447,"props":1596,"children":1597},{"style":1009},[1598],{"type":428,"value":1599},"      &&",{"type":422,"tag":447,"props":1601,"children":1602},{"style":524},[1603],{"type":428,"value":1425},{"type":422,"tag":447,"props":1605,"children":1606},{"style":476},[1607],{"type":428,"value":532},{"type":422,"tag":447,"props":1609,"children":1610},{"style":524},[1611],{"type":428,"value":1612},"maxSymLevel",{"type":422,"tag":447,"props":1614,"children":1615},{"style":1009},[1616],{"type":428,"value":1617},"--",{"type":422,"tag":447,"props":1619,"children":1620},{"style":518},[1621],{"type":428,"value":550},{"type":422,"tag":447,"props":1623,"children":1624},{"style":476},[1625],{"type":428,"value":555},{"type":422,"tag":447,"props":1627,"children":1628},{"class":449,"line":610},[1629],{"type":422,"tag":447,"props":1630,"children":1631},{"style":512},[1632],{"type":428,"value":661},{"type":422,"tag":447,"props":1634,"children":1635},{"class":449,"line":642},[1636],{"type":422,"tag":447,"props":1637,"children":1638},{"style":476},[1639],{"type":428,"value":670},{"type":422,"tag":447,"props":1641,"children":1642},{"class":449,"line":655},[1643],{"type":422,"tag":447,"props":1644,"children":1645},{"style":476},[1646],{"type":428,"value":1171},{"type":422,"tag":430,"props":1648,"children":1649},{},[1650],{"type":428,"value":1651},"NodeJS 文档提到，fs.watch 的 recursive 选项在 Linux 中是无效的，因为 fs.watch 的实现依赖具体操作系统底层 API。所以到底要不要用原生的 recursive 选项需要提前判断一下，node-watch 的实现挺粗暴，直接使用 IO 操作去检测：先到系统临时文件目录创建一些文件夹，然后监听它们并删除里面的内容，如果超时了还没有触发 watcher 的 change 事件，那就说明不是原生支持 recursive 选项。",{"type":422,"tag":436,"props":1653,"children":1655},{"className":438,"code":1654,"language":440,"meta":415,"style":415},"var IS_SUPPORT\n\ntry {\n  watcher = fs.watch(parent, options)\n} catch (e) {\n  if (e.code == 'ERR_FEATURE_UNAVAILABLE_ON_PLATFORM') {\n    return fn(IS_SUPPORT = false)\n  } else {\n    throw e\n  }\n}\n\nvar timer = setTimeout(function() {\n  watcher.close()\n  stack.cleanup(function() {\n    fn(IS_SUPPORT = false)\n  })\n}, 200)\n\nwatcher.on('change', function(evt, name) {\n  if (path.basename(file) === path.basename(name)) {\n    watcher.close()\n    clearTimeout(timer)\n    stack.cleanup(function() {\n      fn(IS_SUPPORT = true)\n    })\n  }\n})\n",[1656],{"type":422,"tag":443,"props":1657,"children":1658},{"__ignoreMap":415},[1659,1673,1681,1693,1738,1760,1810,1846,1862,1875,1882,1889,1896,1935,1956,1989,2017,2028,2046,2053,2120,2188,2208,2229,2261,2290,2302,2310],{"type":422,"tag":447,"props":1660,"children":1661},{"class":449,"line":450},[1662,1667],{"type":422,"tag":447,"props":1663,"children":1664},{"style":464},[1665],{"type":428,"value":1666},"var",{"type":422,"tag":447,"props":1668,"children":1670},{"style":1669},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[1671],{"type":428,"value":1672}," IS_SUPPORT\n",{"type":422,"tag":447,"props":1674,"children":1675},{"class":449,"line":460},[1676],{"type":422,"tag":447,"props":1677,"children":1678},{"emptyLinePlaceholder":414},[1679],{"type":428,"value":1680},"\n",{"type":422,"tag":447,"props":1682,"children":1683},{"class":449,"line":508},[1684,1689],{"type":422,"tag":447,"props":1685,"children":1686},{"style":512},[1687],{"type":428,"value":1688},"try",{"type":422,"tag":447,"props":1690,"children":1691},{"style":476},[1692],{"type":428,"value":505},{"type":422,"tag":447,"props":1694,"children":1695},{"class":449,"line":558},[1696,1701,1705,1710,1714,1718,1722,1726,1730,1734],{"type":422,"tag":447,"props":1697,"children":1698},{"style":524},[1699],{"type":428,"value":1700},"  watcher",{"type":422,"tag":447,"props":1702,"children":1703},{"style":1009},[1704],{"type":428,"value":1012},{"type":422,"tag":447,"props":1706,"children":1707},{"style":524},[1708],{"type":428,"value":1709}," fs",{"type":422,"tag":447,"props":1711,"children":1712},{"style":476},[1713],{"type":428,"value":532},{"type":422,"tag":447,"props":1715,"children":1716},{"style":470},[1717],{"type":428,"value":728},{"type":422,"tag":447,"props":1719,"children":1720},{"style":518},[1721],{"type":428,"value":479},{"type":422,"tag":447,"props":1723,"children":1724},{"style":524},[1725],{"type":428,"value":1313},{"type":422,"tag":447,"props":1727,"children":1728},{"style":476},[1729],{"type":428,"value":490},{"type":422,"tag":447,"props":1731,"children":1732},{"style":524},[1733],{"type":428,"value":1425},{"type":422,"tag":447,"props":1735,"children":1736},{"style":518},[1737],{"type":428,"value":639},{"type":422,"tag":447,"props":1739,"children":1740},{"class":449,"line":610},[1741,1746,1751,1756],{"type":422,"tag":447,"props":1742,"children":1743},{"style":476},[1744],{"type":428,"value":1745},"}",{"type":422,"tag":447,"props":1747,"children":1748},{"style":512},[1749],{"type":428,"value":1750}," catch",{"type":422,"tag":447,"props":1752,"children":1753},{"style":524},[1754],{"type":428,"value":1755}," (e) ",{"type":422,"tag":447,"props":1757,"children":1758},{"style":476},[1759],{"type":428,"value":555},{"type":422,"tag":447,"props":1761,"children":1762},{"class":449,"line":642},[1763,1767,1771,1776,1780,1784,1789,1793,1798,1802,1806],{"type":422,"tag":447,"props":1764,"children":1765},{"style":512},[1766],{"type":428,"value":515},{"type":422,"tag":447,"props":1768,"children":1769},{"style":518},[1770],{"type":428,"value":521},{"type":422,"tag":447,"props":1772,"children":1773},{"style":524},[1774],{"type":428,"value":1775},"e",{"type":422,"tag":447,"props":1777,"children":1778},{"style":476},[1779],{"type":428,"value":532},{"type":422,"tag":447,"props":1781,"children":1782},{"style":524},[1783],{"type":428,"value":443},{"type":422,"tag":447,"props":1785,"children":1786},{"style":1009},[1787],{"type":428,"value":1788}," ==",{"type":422,"tag":447,"props":1790,"children":1791},{"style":1270},[1792],{"type":428,"value":1273},{"type":422,"tag":447,"props":1794,"children":1795},{"style":1276},[1796],{"type":428,"value":1797},"ERR_FEATURE_UNAVAILABLE_ON_PLATFORM",{"type":422,"tag":447,"props":1799,"children":1800},{"style":1270},[1801],{"type":428,"value":1284},{"type":422,"tag":447,"props":1803,"children":1804},{"style":518},[1805],{"type":428,"value":933},{"type":422,"tag":447,"props":1807,"children":1808},{"style":476},[1809],{"type":428,"value":555},{"type":422,"tag":447,"props":1811,"children":1812},{"class":449,"line":655},[1813,1818,1823,1827,1832,1836,1842],{"type":422,"tag":447,"props":1814,"children":1815},{"style":512},[1816],{"type":428,"value":1817},"    return",{"type":422,"tag":447,"props":1819,"children":1820},{"style":470},[1821],{"type":428,"value":1822}," fn",{"type":422,"tag":447,"props":1824,"children":1825},{"style":518},[1826],{"type":428,"value":479},{"type":422,"tag":447,"props":1828,"children":1829},{"style":1669},[1830],{"type":428,"value":1831},"IS_SUPPORT",{"type":422,"tag":447,"props":1833,"children":1834},{"style":1009},[1835],{"type":428,"value":1012},{"type":422,"tag":447,"props":1837,"children":1839},{"style":1838},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1840],{"type":428,"value":1841}," false",{"type":422,"tag":447,"props":1843,"children":1844},{"style":518},[1845],{"type":428,"value":639},{"type":422,"tag":447,"props":1847,"children":1848},{"class":449,"line":664},[1849,1853,1858],{"type":422,"tag":447,"props":1850,"children":1851},{"style":476},[1852],{"type":428,"value":1453},{"type":422,"tag":447,"props":1854,"children":1855},{"style":512},[1856],{"type":428,"value":1857}," else",{"type":422,"tag":447,"props":1859,"children":1860},{"style":476},[1861],{"type":428,"value":505},{"type":422,"tag":447,"props":1863,"children":1864},{"class":449,"line":673},[1865,1870],{"type":422,"tag":447,"props":1866,"children":1867},{"style":512},[1868],{"type":428,"value":1869},"    throw",{"type":422,"tag":447,"props":1871,"children":1872},{"style":524},[1873],{"type":428,"value":1874}," e\n",{"type":422,"tag":447,"props":1876,"children":1877},{"class":449,"line":714},[1878],{"type":422,"tag":447,"props":1879,"children":1880},{"style":476},[1881],{"type":428,"value":670},{"type":422,"tag":447,"props":1883,"children":1884},{"class":449,"line":772},[1885],{"type":422,"tag":447,"props":1886,"children":1887},{"style":476},[1888],{"type":428,"value":1171},{"type":422,"tag":447,"props":1890,"children":1891},{"class":449,"line":797},[1892],{"type":422,"tag":447,"props":1893,"children":1894},{"emptyLinePlaceholder":414},[1895],{"type":428,"value":1680},{"type":422,"tag":447,"props":1897,"children":1898},{"class":449,"line":835},[1899,1903,1908,1913,1918,1922,1926,1931],{"type":422,"tag":447,"props":1900,"children":1901},{"style":464},[1902],{"type":428,"value":1666},{"type":422,"tag":447,"props":1904,"children":1905},{"style":524},[1906],{"type":428,"value":1907}," timer ",{"type":422,"tag":447,"props":1909,"children":1910},{"style":1009},[1911],{"type":428,"value":1912},"=",{"type":422,"tag":447,"props":1914,"children":1915},{"style":470},[1916],{"type":428,"value":1917}," setTimeout",{"type":422,"tag":447,"props":1919,"children":1920},{"style":524},[1921],{"type":428,"value":479},{"type":422,"tag":447,"props":1923,"children":1924},{"style":464},[1925],{"type":428,"value":467},{"type":422,"tag":447,"props":1927,"children":1928},{"style":476},[1929],{"type":428,"value":1930},"()",{"type":422,"tag":447,"props":1932,"children":1933},{"style":476},[1934],{"type":428,"value":505},{"type":422,"tag":447,"props":1936,"children":1937},{"class":449,"line":844},[1938,1942,1946,1951],{"type":422,"tag":447,"props":1939,"children":1940},{"style":524},[1941],{"type":428,"value":1700},{"type":422,"tag":447,"props":1943,"children":1944},{"style":476},[1945],{"type":428,"value":532},{"type":422,"tag":447,"props":1947,"children":1948},{"style":470},[1949],{"type":428,"value":1950},"close",{"type":422,"tag":447,"props":1952,"children":1953},{"style":518},[1954],{"type":428,"value":1955},"()\n",{"type":422,"tag":447,"props":1957,"children":1958},{"class":449,"line":856},[1959,1964,1968,1973,1977,1981,1985],{"type":422,"tag":447,"props":1960,"children":1961},{"style":524},[1962],{"type":428,"value":1963},"  stack",{"type":422,"tag":447,"props":1965,"children":1966},{"style":476},[1967],{"type":428,"value":532},{"type":422,"tag":447,"props":1969,"children":1970},{"style":470},[1971],{"type":428,"value":1972},"cleanup",{"type":422,"tag":447,"props":1974,"children":1975},{"style":518},[1976],{"type":428,"value":479},{"type":422,"tag":447,"props":1978,"children":1979},{"style":464},[1980],{"type":428,"value":467},{"type":422,"tag":447,"props":1982,"children":1983},{"style":476},[1984],{"type":428,"value":1930},{"type":422,"tag":447,"props":1986,"children":1987},{"style":476},[1988],{"type":428,"value":505},{"type":422,"tag":447,"props":1990,"children":1991},{"class":449,"line":914},[1992,1997,2001,2005,2009,2013],{"type":422,"tag":447,"props":1993,"children":1994},{"style":470},[1995],{"type":428,"value":1996},"    fn",{"type":422,"tag":447,"props":1998,"children":1999},{"style":518},[2000],{"type":428,"value":479},{"type":422,"tag":447,"props":2002,"children":2003},{"style":1669},[2004],{"type":428,"value":1831},{"type":422,"tag":447,"props":2006,"children":2007},{"style":1009},[2008],{"type":428,"value":1012},{"type":422,"tag":447,"props":2010,"children":2011},{"style":1838},[2012],{"type":428,"value":1841},{"type":422,"tag":447,"props":2014,"children":2015},{"style":518},[2016],{"type":428,"value":639},{"type":422,"tag":447,"props":2018,"children":2019},{"class":449,"line":946},[2020,2024],{"type":422,"tag":447,"props":2021,"children":2022},{"style":476},[2023],{"type":428,"value":1453},{"type":422,"tag":447,"props":2025,"children":2026},{"style":518},[2027],{"type":428,"value":639},{"type":422,"tag":447,"props":2029,"children":2030},{"class":449,"line":995},[2031,2036,2042],{"type":422,"tag":447,"props":2032,"children":2033},{"style":476},[2034],{"type":428,"value":2035},"},",{"type":422,"tag":447,"props":2037,"children":2039},{"style":2038},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2040],{"type":428,"value":2041}," 200",{"type":422,"tag":447,"props":2043,"children":2044},{"style":524},[2045],{"type":428,"value":639},{"type":422,"tag":447,"props":2047,"children":2048},{"class":449,"line":1049},[2049],{"type":422,"tag":447,"props":2050,"children":2051},{"emptyLinePlaceholder":414},[2052],{"type":428,"value":1680},{"type":422,"tag":447,"props":2054,"children":2055},{"class":449,"line":1093},[2056,2061,2065,2070,2074,2078,2083,2087,2091,2095,2099,2103,2107,2112,2116],{"type":422,"tag":447,"props":2057,"children":2058},{"style":524},[2059],{"type":428,"value":2060},"watcher",{"type":422,"tag":447,"props":2062,"children":2063},{"style":476},[2064],{"type":428,"value":532},{"type":422,"tag":447,"props":2066,"children":2067},{"style":470},[2068],{"type":428,"value":2069},"on",{"type":422,"tag":447,"props":2071,"children":2072},{"style":524},[2073],{"type":428,"value":479},{"type":422,"tag":447,"props":2075,"children":2076},{"style":1270},[2077],{"type":428,"value":1284},{"type":422,"tag":447,"props":2079,"children":2080},{"style":1276},[2081],{"type":428,"value":2082},"change",{"type":422,"tag":447,"props":2084,"children":2085},{"style":1270},[2086],{"type":428,"value":1284},{"type":422,"tag":447,"props":2088,"children":2089},{"style":476},[2090],{"type":428,"value":490},{"type":422,"tag":447,"props":2092,"children":2093},{"style":464},[2094],{"type":428,"value":590},{"type":422,"tag":447,"props":2096,"children":2097},{"style":476},[2098],{"type":428,"value":479},{"type":422,"tag":447,"props":2100,"children":2101},{"style":482},[2102],{"type":428,"value":1330},{"type":422,"tag":447,"props":2104,"children":2105},{"style":476},[2106],{"type":428,"value":490},{"type":422,"tag":447,"props":2108,"children":2109},{"style":482},[2110],{"type":428,"value":2111}," name",{"type":422,"tag":447,"props":2113,"children":2114},{"style":476},[2115],{"type":428,"value":500},{"type":422,"tag":447,"props":2117,"children":2118},{"style":476},[2119],{"type":428,"value":505},{"type":422,"tag":447,"props":2121,"children":2122},{"class":449,"line":1122},[2123,2127,2131,2135,2139,2143,2147,2151,2155,2159,2163,2167,2171,2175,2180,2184],{"type":422,"tag":447,"props":2124,"children":2125},{"style":512},[2126],{"type":428,"value":515},{"type":422,"tag":447,"props":2128,"children":2129},{"style":518},[2130],{"type":428,"value":521},{"type":422,"tag":447,"props":2132,"children":2133},{"style":524},[2134],{"type":428,"value":1363},{"type":422,"tag":447,"props":2136,"children":2137},{"style":476},[2138],{"type":428,"value":532},{"type":422,"tag":447,"props":2140,"children":2141},{"style":470},[2142],{"type":428,"value":1372},{"type":422,"tag":447,"props":2144,"children":2145},{"style":518},[2146],{"type":428,"value":479},{"type":422,"tag":447,"props":2148,"children":2149},{"style":524},[2150],{"type":428,"value":1081},{"type":422,"tag":447,"props":2152,"children":2153},{"style":518},[2154],{"type":428,"value":933},{"type":422,"tag":447,"props":2156,"children":2157},{"style":1009},[2158],{"type":428,"value":1389},{"type":422,"tag":447,"props":2160,"children":2161},{"style":524},[2162],{"type":428,"value":1017},{"type":422,"tag":447,"props":2164,"children":2165},{"style":476},[2166],{"type":428,"value":532},{"type":422,"tag":447,"props":2168,"children":2169},{"style":470},[2170],{"type":428,"value":1372},{"type":422,"tag":447,"props":2172,"children":2173},{"style":518},[2174],{"type":428,"value":479},{"type":422,"tag":447,"props":2176,"children":2177},{"style":524},[2178],{"type":428,"value":2179},"name",{"type":422,"tag":447,"props":2181,"children":2182},{"style":518},[2183],{"type":428,"value":550},{"type":422,"tag":447,"props":2185,"children":2186},{"style":476},[2187],{"type":428,"value":555},{"type":422,"tag":447,"props":2189,"children":2190},{"class":449,"line":1131},[2191,2196,2200,2204],{"type":422,"tag":447,"props":2192,"children":2193},{"style":524},[2194],{"type":428,"value":2195},"    watcher",{"type":422,"tag":447,"props":2197,"children":2198},{"style":476},[2199],{"type":428,"value":532},{"type":422,"tag":447,"props":2201,"children":2202},{"style":470},[2203],{"type":428,"value":1950},{"type":422,"tag":447,"props":2205,"children":2206},{"style":518},[2207],{"type":428,"value":1955},{"type":422,"tag":447,"props":2209,"children":2210},{"class":449,"line":1144},[2211,2216,2220,2225],{"type":422,"tag":447,"props":2212,"children":2213},{"style":470},[2214],{"type":428,"value":2215},"    clearTimeout",{"type":422,"tag":447,"props":2217,"children":2218},{"style":518},[2219],{"type":428,"value":479},{"type":422,"tag":447,"props":2221,"children":2222},{"style":524},[2223],{"type":428,"value":2224},"timer",{"type":422,"tag":447,"props":2226,"children":2227},{"style":518},[2228],{"type":428,"value":639},{"type":422,"tag":447,"props":2230,"children":2231},{"class":449,"line":1157},[2232,2237,2241,2245,2249,2253,2257],{"type":422,"tag":447,"props":2233,"children":2234},{"style":524},[2235],{"type":428,"value":2236},"    stack",{"type":422,"tag":447,"props":2238,"children":2239},{"style":476},[2240],{"type":428,"value":532},{"type":422,"tag":447,"props":2242,"children":2243},{"style":470},[2244],{"type":428,"value":1972},{"type":422,"tag":447,"props":2246,"children":2247},{"style":518},[2248],{"type":428,"value":479},{"type":422,"tag":447,"props":2250,"children":2251},{"style":464},[2252],{"type":428,"value":467},{"type":422,"tag":447,"props":2254,"children":2255},{"style":476},[2256],{"type":428,"value":1930},{"type":422,"tag":447,"props":2258,"children":2259},{"style":476},[2260],{"type":428,"value":505},{"type":422,"tag":447,"props":2262,"children":2263},{"class":449,"line":1165},[2264,2269,2273,2277,2281,2286],{"type":422,"tag":447,"props":2265,"children":2266},{"style":470},[2267],{"type":428,"value":2268},"      fn",{"type":422,"tag":447,"props":2270,"children":2271},{"style":518},[2272],{"type":428,"value":479},{"type":422,"tag":447,"props":2274,"children":2275},{"style":1669},[2276],{"type":428,"value":1831},{"type":422,"tag":447,"props":2278,"children":2279},{"style":1009},[2280],{"type":428,"value":1012},{"type":422,"tag":447,"props":2282,"children":2283},{"style":1838},[2284],{"type":428,"value":2285}," true",{"type":422,"tag":447,"props":2287,"children":2288},{"style":518},[2289],{"type":428,"value":639},{"type":422,"tag":447,"props":2291,"children":2293},{"class":449,"line":2292},26,[2294,2298],{"type":422,"tag":447,"props":2295,"children":2296},{"style":476},[2297],{"type":428,"value":648},{"type":422,"tag":447,"props":2299,"children":2300},{"style":518},[2301],{"type":428,"value":639},{"type":422,"tag":447,"props":2303,"children":2305},{"class":449,"line":2304},27,[2306],{"type":422,"tag":447,"props":2307,"children":2308},{"style":476},[2309],{"type":428,"value":670},{"type":422,"tag":447,"props":2311,"children":2313},{"class":449,"line":2312},28,[2314,2318],{"type":422,"tag":447,"props":2315,"children":2316},{"style":476},[2317],{"type":428,"value":1745},{"type":422,"tag":447,"props":2319,"children":2320},{"style":524},[2321],{"type":428,"value":639},{"type":422,"tag":430,"props":2323,"children":2324},{},[2325],{"type":428,"value":2326},"Watcher 仅向外暴露指定方法。",{"type":422,"tag":436,"props":2328,"children":2330},{"className":438,"code":2329,"language":440,"meta":415,"style":415},"Watcher.prototype.expose = function() {\n  var expose = {}\n  var self = this\n  var methods = [\n    'on', 'emit', 'once',\n    'close', 'isClosed',\n    'listeners', 'setMaxListeners', 'getMaxListeners',\n    'getWatchedPaths'\n  ]\n  methods.forEach(function(name) {\n    expose[name] = function() {\n      return self[name].apply(self, arguments)\n    }\n  })\n  return expose\n}\n",[2331],{"type":422,"tag":443,"props":2332,"children":2333},{"__ignoreMap":415},[2334,2377,2398,2420,2441,2496,2532,2586,2603,2611,2651,2689,2746,2753,2764,2777],{"type":422,"tag":447,"props":2335,"children":2336},{"class":449,"line":450},[2337,2343,2347,2352,2356,2361,2365,2369,2373],{"type":422,"tag":447,"props":2338,"children":2340},{"style":2339},"--shiki-light:#E2931D;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[2341],{"type":428,"value":2342},"Watcher",{"type":422,"tag":447,"props":2344,"children":2345},{"style":476},[2346],{"type":428,"value":532},{"type":422,"tag":447,"props":2348,"children":2349},{"style":1669},[2350],{"type":428,"value":2351},"prototype",{"type":422,"tag":447,"props":2353,"children":2354},{"style":476},[2355],{"type":428,"value":532},{"type":422,"tag":447,"props":2357,"children":2358},{"style":470},[2359],{"type":428,"value":2360},"expose",{"type":422,"tag":447,"props":2362,"children":2363},{"style":1009},[2364],{"type":428,"value":1012},{"type":422,"tag":447,"props":2366,"children":2367},{"style":464},[2368],{"type":428,"value":590},{"type":422,"tag":447,"props":2370,"children":2371},{"style":476},[2372],{"type":428,"value":1930},{"type":422,"tag":447,"props":2374,"children":2375},{"style":476},[2376],{"type":428,"value":505},{"type":422,"tag":447,"props":2378,"children":2379},{"class":449,"line":460},[2380,2384,2389,2393],{"type":422,"tag":447,"props":2381,"children":2382},{"style":464},[2383],{"type":428,"value":1232},{"type":422,"tag":447,"props":2385,"children":2386},{"style":524},[2387],{"type":428,"value":2388}," expose",{"type":422,"tag":447,"props":2390,"children":2391},{"style":1009},[2392],{"type":428,"value":1012},{"type":422,"tag":447,"props":2394,"children":2395},{"style":476},[2396],{"type":428,"value":2397}," {}\n",{"type":422,"tag":447,"props":2399,"children":2400},{"class":449,"line":508},[2401,2405,2410,2414],{"type":422,"tag":447,"props":2402,"children":2403},{"style":464},[2404],{"type":428,"value":1232},{"type":422,"tag":447,"props":2406,"children":2407},{"style":524},[2408],{"type":428,"value":2409}," self",{"type":422,"tag":447,"props":2411,"children":2412},{"style":1009},[2413],{"type":428,"value":1012},{"type":422,"tag":447,"props":2415,"children":2417},{"style":2416},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[2418],{"type":428,"value":2419}," this\n",{"type":422,"tag":447,"props":2421,"children":2422},{"class":449,"line":558},[2423,2427,2432,2436],{"type":422,"tag":447,"props":2424,"children":2425},{"style":464},[2426],{"type":428,"value":1232},{"type":422,"tag":447,"props":2428,"children":2429},{"style":524},[2430],{"type":428,"value":2431}," methods",{"type":422,"tag":447,"props":2433,"children":2434},{"style":1009},[2435],{"type":428,"value":1012},{"type":422,"tag":447,"props":2437,"children":2438},{"style":518},[2439],{"type":428,"value":2440}," [\n",{"type":422,"tag":447,"props":2442,"children":2443},{"class":449,"line":610},[2444,2449,2453,2457,2461,2465,2470,2474,2478,2482,2487,2491],{"type":422,"tag":447,"props":2445,"children":2446},{"style":1270},[2447],{"type":428,"value":2448},"    '",{"type":422,"tag":447,"props":2450,"children":2451},{"style":1276},[2452],{"type":428,"value":2069},{"type":422,"tag":447,"props":2454,"children":2455},{"style":1270},[2456],{"type":428,"value":1284},{"type":422,"tag":447,"props":2458,"children":2459},{"style":476},[2460],{"type":428,"value":490},{"type":422,"tag":447,"props":2462,"children":2463},{"style":1270},[2464],{"type":428,"value":1273},{"type":422,"tag":447,"props":2466,"children":2467},{"style":1276},[2468],{"type":428,"value":2469},"emit",{"type":422,"tag":447,"props":2471,"children":2472},{"style":1270},[2473],{"type":428,"value":1284},{"type":422,"tag":447,"props":2475,"children":2476},{"style":476},[2477],{"type":428,"value":490},{"type":422,"tag":447,"props":2479,"children":2480},{"style":1270},[2481],{"type":428,"value":1273},{"type":422,"tag":447,"props":2483,"children":2484},{"style":1276},[2485],{"type":428,"value":2486},"once",{"type":422,"tag":447,"props":2488,"children":2489},{"style":1270},[2490],{"type":428,"value":1284},{"type":422,"tag":447,"props":2492,"children":2493},{"style":476},[2494],{"type":428,"value":2495},",\n",{"type":422,"tag":447,"props":2497,"children":2498},{"class":449,"line":642},[2499,2503,2507,2511,2515,2519,2524,2528],{"type":422,"tag":447,"props":2500,"children":2501},{"style":1270},[2502],{"type":428,"value":2448},{"type":422,"tag":447,"props":2504,"children":2505},{"style":1276},[2506],{"type":428,"value":1950},{"type":422,"tag":447,"props":2508,"children":2509},{"style":1270},[2510],{"type":428,"value":1284},{"type":422,"tag":447,"props":2512,"children":2513},{"style":476},[2514],{"type":428,"value":490},{"type":422,"tag":447,"props":2516,"children":2517},{"style":1270},[2518],{"type":428,"value":1273},{"type":422,"tag":447,"props":2520,"children":2521},{"style":1276},[2522],{"type":428,"value":2523},"isClosed",{"type":422,"tag":447,"props":2525,"children":2526},{"style":1270},[2527],{"type":428,"value":1284},{"type":422,"tag":447,"props":2529,"children":2530},{"style":476},[2531],{"type":428,"value":2495},{"type":422,"tag":447,"props":2533,"children":2534},{"class":449,"line":655},[2535,2539,2544,2548,2552,2556,2561,2565,2569,2573,2578,2582],{"type":422,"tag":447,"props":2536,"children":2537},{"style":1270},[2538],{"type":428,"value":2448},{"type":422,"tag":447,"props":2540,"children":2541},{"style":1276},[2542],{"type":428,"value":2543},"listeners",{"type":422,"tag":447,"props":2545,"children":2546},{"style":1270},[2547],{"type":428,"value":1284},{"type":422,"tag":447,"props":2549,"children":2550},{"style":476},[2551],{"type":428,"value":490},{"type":422,"tag":447,"props":2553,"children":2554},{"style":1270},[2555],{"type":428,"value":1273},{"type":422,"tag":447,"props":2557,"children":2558},{"style":1276},[2559],{"type":428,"value":2560},"setMaxListeners",{"type":422,"tag":447,"props":2562,"children":2563},{"style":1270},[2564],{"type":428,"value":1284},{"type":422,"tag":447,"props":2566,"children":2567},{"style":476},[2568],{"type":428,"value":490},{"type":422,"tag":447,"props":2570,"children":2571},{"style":1270},[2572],{"type":428,"value":1273},{"type":422,"tag":447,"props":2574,"children":2575},{"style":1276},[2576],{"type":428,"value":2577},"getMaxListeners",{"type":422,"tag":447,"props":2579,"children":2580},{"style":1270},[2581],{"type":428,"value":1284},{"type":422,"tag":447,"props":2583,"children":2584},{"style":476},[2585],{"type":428,"value":2495},{"type":422,"tag":447,"props":2587,"children":2588},{"class":449,"line":664},[2589,2593,2598],{"type":422,"tag":447,"props":2590,"children":2591},{"style":1270},[2592],{"type":428,"value":2448},{"type":422,"tag":447,"props":2594,"children":2595},{"style":1276},[2596],{"type":428,"value":2597},"getWatchedPaths",{"type":422,"tag":447,"props":2599,"children":2600},{"style":1270},[2601],{"type":428,"value":2602},"'\n",{"type":422,"tag":447,"props":2604,"children":2605},{"class":449,"line":673},[2606],{"type":422,"tag":447,"props":2607,"children":2608},{"style":518},[2609],{"type":428,"value":2610},"  ]\n",{"type":422,"tag":447,"props":2612,"children":2613},{"class":449,"line":714},[2614,2619,2623,2627,2631,2635,2639,2643,2647],{"type":422,"tag":447,"props":2615,"children":2616},{"style":524},[2617],{"type":428,"value":2618},"  methods",{"type":422,"tag":447,"props":2620,"children":2621},{"style":476},[2622],{"type":428,"value":532},{"type":422,"tag":447,"props":2624,"children":2625},{"style":470},[2626],{"type":428,"value":961},{"type":422,"tag":447,"props":2628,"children":2629},{"style":518},[2630],{"type":428,"value":479},{"type":422,"tag":447,"props":2632,"children":2633},{"style":464},[2634],{"type":428,"value":467},{"type":422,"tag":447,"props":2636,"children":2637},{"style":476},[2638],{"type":428,"value":479},{"type":422,"tag":447,"props":2640,"children":2641},{"style":482},[2642],{"type":428,"value":2179},{"type":422,"tag":447,"props":2644,"children":2645},{"style":476},[2646],{"type":428,"value":500},{"type":422,"tag":447,"props":2648,"children":2649},{"style":476},[2650],{"type":428,"value":505},{"type":422,"tag":447,"props":2652,"children":2653},{"class":449,"line":772},[2654,2659,2664,2668,2673,2677,2681,2685],{"type":422,"tag":447,"props":2655,"children":2656},{"style":524},[2657],{"type":428,"value":2658},"    expose",{"type":422,"tag":447,"props":2660,"children":2661},{"style":518},[2662],{"type":428,"value":2663},"[",{"type":422,"tag":447,"props":2665,"children":2666},{"style":524},[2667],{"type":428,"value":2179},{"type":422,"tag":447,"props":2669,"children":2670},{"style":518},[2671],{"type":428,"value":2672},"] ",{"type":422,"tag":447,"props":2674,"children":2675},{"style":1009},[2676],{"type":428,"value":1912},{"type":422,"tag":447,"props":2678,"children":2679},{"style":464},[2680],{"type":428,"value":590},{"type":422,"tag":447,"props":2682,"children":2683},{"style":476},[2684],{"type":428,"value":1930},{"type":422,"tag":447,"props":2686,"children":2687},{"style":476},[2688],{"type":428,"value":505},{"type":422,"tag":447,"props":2690,"children":2691},{"class":449,"line":797},[2692,2697,2701,2705,2709,2714,2718,2723,2727,2732,2736,2742],{"type":422,"tag":447,"props":2693,"children":2694},{"style":512},[2695],{"type":428,"value":2696},"      return",{"type":422,"tag":447,"props":2698,"children":2699},{"style":524},[2700],{"type":428,"value":2409},{"type":422,"tag":447,"props":2702,"children":2703},{"style":518},[2704],{"type":428,"value":2663},{"type":422,"tag":447,"props":2706,"children":2707},{"style":524},[2708],{"type":428,"value":2179},{"type":422,"tag":447,"props":2710,"children":2711},{"style":518},[2712],{"type":428,"value":2713},"]",{"type":422,"tag":447,"props":2715,"children":2716},{"style":476},[2717],{"type":428,"value":532},{"type":422,"tag":447,"props":2719,"children":2720},{"style":470},[2721],{"type":428,"value":2722},"apply",{"type":422,"tag":447,"props":2724,"children":2725},{"style":518},[2726],{"type":428,"value":479},{"type":422,"tag":447,"props":2728,"children":2729},{"style":524},[2730],{"type":428,"value":2731},"self",{"type":422,"tag":447,"props":2733,"children":2734},{"style":476},[2735],{"type":428,"value":490},{"type":422,"tag":447,"props":2737,"children":2739},{"style":2738},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[2740],{"type":428,"value":2741}," arguments",{"type":422,"tag":447,"props":2743,"children":2744},{"style":518},[2745],{"type":428,"value":639},{"type":422,"tag":447,"props":2747,"children":2748},{"class":449,"line":835},[2749],{"type":422,"tag":447,"props":2750,"children":2751},{"style":476},[2752],{"type":428,"value":1445},{"type":422,"tag":447,"props":2754,"children":2755},{"class":449,"line":844},[2756,2760],{"type":422,"tag":447,"props":2757,"children":2758},{"style":476},[2759],{"type":428,"value":1453},{"type":422,"tag":447,"props":2761,"children":2762},{"style":518},[2763],{"type":428,"value":639},{"type":422,"tag":447,"props":2765,"children":2766},{"class":449,"line":856},[2767,2772],{"type":422,"tag":447,"props":2768,"children":2769},{"style":512},[2770],{"type":428,"value":2771},"  return",{"type":422,"tag":447,"props":2773,"children":2774},{"style":524},[2775],{"type":428,"value":2776}," expose\n",{"type":422,"tag":447,"props":2778,"children":2779},{"class":449,"line":914},[2780],{"type":422,"tag":447,"props":2781,"children":2782},{"style":476},[2783],{"type":428,"value":1171},{"type":422,"tag":430,"props":2785,"children":2786},{},[2787],{"type":428,"value":2788},"监听路径支持传数组，我们当然希望就算是数组，也是由同一个 EventEmitter 来管理事件的，传入的是既然是数组，那么自然会生成多个 watcher 实例，只不过代码中使用了 composeWatcher 函数，把这些事件整合并向外发送。",{"type":422,"tag":436,"props":2790,"children":2792},{"className":438,"code":2791,"language":440,"meta":415,"style":415},"function composeWatcher(watchers) {\n  // 使用一个新的 watcher 整合事件列表\n  var watcher = new Watcher()\n  var filterDups = createDupsFilter()\n  var counter = watchers.length\n\n  watchers.forEach(function(w) {\n    w.on('change', filterDups(function(evt, name) {\n      watcher.emit('change', evt, name)\n    }))\n    w.on('error', function(err) {\n      watcher.emit('error', err)\n    })\n    w.on('ready', function() {\n      if (!(--counter)) {\n        emitReady(watcher)\n      }\n    })\n  })\n\n  watcher.close = function() {\n    watchers.forEach(function(w) {\n      w.close()\n    })\n    process.nextTick(emitClose, watcher)\n  }\n\n  watcher.getWatchedPaths = function(fn) {\n    if (is.func(fn)) {\n      var promises = watchers.map(function(w) {\n        return new Promise(function(resolve) {\n          w.getWatchedPaths(resolve)\n        })\n      })\n      Promise.all(promises).then(function(result) {\n        var ret = unique(flat1(result))\n        fn(ret)\n      })\n    }\n  }\n\n  return watcher.expose()\n}\n",[2793],{"type":422,"tag":443,"props":2794,"children":2795},{"__ignoreMap":415},[2796,2825,2833,2863,2888,2918,2925,2966,3038,3091,3103,3159,3203,3214,3262,3299,3319,3327,3338,3349,3356,3387,3427,3447,3458,3496,3503,3510,3550,3591,3646,3688,3717,3730,3742,3807,3850,3872,3884,3892,3900,3908,3932],{"type":422,"tag":447,"props":2797,"children":2798},{"class":449,"line":450},[2799,2803,2808,2812,2817,2821],{"type":422,"tag":447,"props":2800,"children":2801},{"style":464},[2802],{"type":428,"value":467},{"type":422,"tag":447,"props":2804,"children":2805},{"style":470},[2806],{"type":428,"value":2807}," composeWatcher",{"type":422,"tag":447,"props":2809,"children":2810},{"style":476},[2811],{"type":428,"value":479},{"type":422,"tag":447,"props":2813,"children":2814},{"style":482},[2815],{"type":428,"value":2816},"watchers",{"type":422,"tag":447,"props":2818,"children":2819},{"style":476},[2820],{"type":428,"value":500},{"type":422,"tag":447,"props":2822,"children":2823},{"style":476},[2824],{"type":428,"value":505},{"type":422,"tag":447,"props":2826,"children":2827},{"class":449,"line":460},[2828],{"type":422,"tag":447,"props":2829,"children":2830},{"style":454},[2831],{"type":428,"value":2832},"  // 使用一个新的 watcher 整合事件列表\n",{"type":422,"tag":447,"props":2834,"children":2835},{"class":449,"line":508},[2836,2840,2845,2849,2854,2859],{"type":422,"tag":447,"props":2837,"children":2838},{"style":464},[2839],{"type":428,"value":1232},{"type":422,"tag":447,"props":2841,"children":2842},{"style":524},[2843],{"type":428,"value":2844}," watcher",{"type":422,"tag":447,"props":2846,"children":2847},{"style":1009},[2848],{"type":428,"value":1012},{"type":422,"tag":447,"props":2850,"children":2851},{"style":1009},[2852],{"type":428,"value":2853}," new",{"type":422,"tag":447,"props":2855,"children":2856},{"style":470},[2857],{"type":428,"value":2858}," Watcher",{"type":422,"tag":447,"props":2860,"children":2861},{"style":518},[2862],{"type":428,"value":1955},{"type":422,"tag":447,"props":2864,"children":2865},{"class":449,"line":558},[2866,2870,2875,2879,2884],{"type":422,"tag":447,"props":2867,"children":2868},{"style":464},[2869],{"type":428,"value":1232},{"type":422,"tag":447,"props":2871,"children":2872},{"style":524},[2873],{"type":428,"value":2874}," filterDups",{"type":422,"tag":447,"props":2876,"children":2877},{"style":1009},[2878],{"type":428,"value":1012},{"type":422,"tag":447,"props":2880,"children":2881},{"style":470},[2882],{"type":428,"value":2883}," createDupsFilter",{"type":422,"tag":447,"props":2885,"children":2886},{"style":518},[2887],{"type":428,"value":1955},{"type":422,"tag":447,"props":2889,"children":2890},{"class":449,"line":610},[2891,2895,2900,2904,2909,2913],{"type":422,"tag":447,"props":2892,"children":2893},{"style":464},[2894],{"type":428,"value":1232},{"type":422,"tag":447,"props":2896,"children":2897},{"style":524},[2898],{"type":428,"value":2899}," counter",{"type":422,"tag":447,"props":2901,"children":2902},{"style":1009},[2903],{"type":428,"value":1012},{"type":422,"tag":447,"props":2905,"children":2906},{"style":524},[2907],{"type":428,"value":2908}," watchers",{"type":422,"tag":447,"props":2910,"children":2911},{"style":476},[2912],{"type":428,"value":532},{"type":422,"tag":447,"props":2914,"children":2915},{"style":1669},[2916],{"type":428,"value":2917},"length\n",{"type":422,"tag":447,"props":2919,"children":2920},{"class":449,"line":642},[2921],{"type":422,"tag":447,"props":2922,"children":2923},{"emptyLinePlaceholder":414},[2924],{"type":428,"value":1680},{"type":422,"tag":447,"props":2926,"children":2927},{"class":449,"line":655},[2928,2933,2937,2941,2945,2949,2953,2958,2962],{"type":422,"tag":447,"props":2929,"children":2930},{"style":524},[2931],{"type":428,"value":2932},"  watchers",{"type":422,"tag":447,"props":2934,"children":2935},{"style":476},[2936],{"type":428,"value":532},{"type":422,"tag":447,"props":2938,"children":2939},{"style":470},[2940],{"type":428,"value":961},{"type":422,"tag":447,"props":2942,"children":2943},{"style":518},[2944],{"type":428,"value":479},{"type":422,"tag":447,"props":2946,"children":2947},{"style":464},[2948],{"type":428,"value":467},{"type":422,"tag":447,"props":2950,"children":2951},{"style":476},[2952],{"type":428,"value":479},{"type":422,"tag":447,"props":2954,"children":2955},{"style":482},[2956],{"type":428,"value":2957},"w",{"type":422,"tag":447,"props":2959,"children":2960},{"style":476},[2961],{"type":428,"value":500},{"type":422,"tag":447,"props":2963,"children":2964},{"style":476},[2965],{"type":428,"value":505},{"type":422,"tag":447,"props":2967,"children":2968},{"class":449,"line":664},[2969,2974,2978,2982,2986,2990,2994,2998,3002,3006,3010,3014,3018,3022,3026,3030,3034],{"type":422,"tag":447,"props":2970,"children":2971},{"style":524},[2972],{"type":428,"value":2973},"    w",{"type":422,"tag":447,"props":2975,"children":2976},{"style":476},[2977],{"type":428,"value":532},{"type":422,"tag":447,"props":2979,"children":2980},{"style":470},[2981],{"type":428,"value":2069},{"type":422,"tag":447,"props":2983,"children":2984},{"style":518},[2985],{"type":428,"value":479},{"type":422,"tag":447,"props":2987,"children":2988},{"style":1270},[2989],{"type":428,"value":1284},{"type":422,"tag":447,"props":2991,"children":2992},{"style":1276},[2993],{"type":428,"value":2082},{"type":422,"tag":447,"props":2995,"children":2996},{"style":1270},[2997],{"type":428,"value":1284},{"type":422,"tag":447,"props":2999,"children":3000},{"style":476},[3001],{"type":428,"value":490},{"type":422,"tag":447,"props":3003,"children":3004},{"style":470},[3005],{"type":428,"value":2874},{"type":422,"tag":447,"props":3007,"children":3008},{"style":518},[3009],{"type":428,"value":479},{"type":422,"tag":447,"props":3011,"children":3012},{"style":464},[3013],{"type":428,"value":467},{"type":422,"tag":447,"props":3015,"children":3016},{"style":476},[3017],{"type":428,"value":479},{"type":422,"tag":447,"props":3019,"children":3020},{"style":482},[3021],{"type":428,"value":1330},{"type":422,"tag":447,"props":3023,"children":3024},{"style":476},[3025],{"type":428,"value":490},{"type":422,"tag":447,"props":3027,"children":3028},{"style":482},[3029],{"type":428,"value":2111},{"type":422,"tag":447,"props":3031,"children":3032},{"style":476},[3033],{"type":428,"value":500},{"type":422,"tag":447,"props":3035,"children":3036},{"style":476},[3037],{"type":428,"value":505},{"type":422,"tag":447,"props":3039,"children":3040},{"class":449,"line":673},[3041,3046,3050,3054,3058,3062,3066,3070,3074,3079,3083,3087],{"type":422,"tag":447,"props":3042,"children":3043},{"style":524},[3044],{"type":428,"value":3045},"      watcher",{"type":422,"tag":447,"props":3047,"children":3048},{"style":476},[3049],{"type":428,"value":532},{"type":422,"tag":447,"props":3051,"children":3052},{"style":470},[3053],{"type":428,"value":2469},{"type":422,"tag":447,"props":3055,"children":3056},{"style":518},[3057],{"type":428,"value":479},{"type":422,"tag":447,"props":3059,"children":3060},{"style":1270},[3061],{"type":428,"value":1284},{"type":422,"tag":447,"props":3063,"children":3064},{"style":1276},[3065],{"type":428,"value":2082},{"type":422,"tag":447,"props":3067,"children":3068},{"style":1270},[3069],{"type":428,"value":1284},{"type":422,"tag":447,"props":3071,"children":3072},{"style":476},[3073],{"type":428,"value":490},{"type":422,"tag":447,"props":3075,"children":3076},{"style":524},[3077],{"type":428,"value":3078}," evt",{"type":422,"tag":447,"props":3080,"children":3081},{"style":476},[3082],{"type":428,"value":490},{"type":422,"tag":447,"props":3084,"children":3085},{"style":524},[3086],{"type":428,"value":2111},{"type":422,"tag":447,"props":3088,"children":3089},{"style":518},[3090],{"type":428,"value":639},{"type":422,"tag":447,"props":3092,"children":3093},{"class":449,"line":714},[3094,3098],{"type":422,"tag":447,"props":3095,"children":3096},{"style":476},[3097],{"type":428,"value":648},{"type":422,"tag":447,"props":3099,"children":3100},{"style":518},[3101],{"type":428,"value":3102},"))\n",{"type":422,"tag":447,"props":3104,"children":3105},{"class":449,"line":772},[3106,3110,3114,3118,3122,3126,3131,3135,3139,3143,3147,3151,3155],{"type":422,"tag":447,"props":3107,"children":3108},{"style":524},[3109],{"type":428,"value":2973},{"type":422,"tag":447,"props":3111,"children":3112},{"style":476},[3113],{"type":428,"value":532},{"type":422,"tag":447,"props":3115,"children":3116},{"style":470},[3117],{"type":428,"value":2069},{"type":422,"tag":447,"props":3119,"children":3120},{"style":518},[3121],{"type":428,"value":479},{"type":422,"tag":447,"props":3123,"children":3124},{"style":1270},[3125],{"type":428,"value":1284},{"type":422,"tag":447,"props":3127,"children":3128},{"style":1276},[3129],{"type":428,"value":3130},"error",{"type":422,"tag":447,"props":3132,"children":3133},{"style":1270},[3134],{"type":428,"value":1284},{"type":422,"tag":447,"props":3136,"children":3137},{"style":476},[3138],{"type":428,"value":490},{"type":422,"tag":447,"props":3140,"children":3141},{"style":464},[3142],{"type":428,"value":590},{"type":422,"tag":447,"props":3144,"children":3145},{"style":476},[3146],{"type":428,"value":479},{"type":422,"tag":447,"props":3148,"children":3149},{"style":482},[3150],{"type":428,"value":599},{"type":422,"tag":447,"props":3152,"children":3153},{"style":476},[3154],{"type":428,"value":500},{"type":422,"tag":447,"props":3156,"children":3157},{"style":476},[3158],{"type":428,"value":505},{"type":422,"tag":447,"props":3160,"children":3161},{"class":449,"line":797},[3162,3166,3170,3174,3178,3182,3186,3190,3194,3199],{"type":422,"tag":447,"props":3163,"children":3164},{"style":524},[3165],{"type":428,"value":3045},{"type":422,"tag":447,"props":3167,"children":3168},{"style":476},[3169],{"type":428,"value":532},{"type":422,"tag":447,"props":3171,"children":3172},{"style":470},[3173],{"type":428,"value":2469},{"type":422,"tag":447,"props":3175,"children":3176},{"style":518},[3177],{"type":428,"value":479},{"type":422,"tag":447,"props":3179,"children":3180},{"style":1270},[3181],{"type":428,"value":1284},{"type":422,"tag":447,"props":3183,"children":3184},{"style":1276},[3185],{"type":428,"value":3130},{"type":422,"tag":447,"props":3187,"children":3188},{"style":1270},[3189],{"type":428,"value":1284},{"type":422,"tag":447,"props":3191,"children":3192},{"style":476},[3193],{"type":428,"value":490},{"type":422,"tag":447,"props":3195,"children":3196},{"style":524},[3197],{"type":428,"value":3198}," err",{"type":422,"tag":447,"props":3200,"children":3201},{"style":518},[3202],{"type":428,"value":639},{"type":422,"tag":447,"props":3204,"children":3205},{"class":449,"line":835},[3206,3210],{"type":422,"tag":447,"props":3207,"children":3208},{"style":476},[3209],{"type":428,"value":648},{"type":422,"tag":447,"props":3211,"children":3212},{"style":518},[3213],{"type":428,"value":639},{"type":422,"tag":447,"props":3215,"children":3216},{"class":449,"line":844},[3217,3221,3225,3229,3233,3237,3242,3246,3250,3254,3258],{"type":422,"tag":447,"props":3218,"children":3219},{"style":524},[3220],{"type":428,"value":2973},{"type":422,"tag":447,"props":3222,"children":3223},{"style":476},[3224],{"type":428,"value":532},{"type":422,"tag":447,"props":3226,"children":3227},{"style":470},[3228],{"type":428,"value":2069},{"type":422,"tag":447,"props":3230,"children":3231},{"style":518},[3232],{"type":428,"value":479},{"type":422,"tag":447,"props":3234,"children":3235},{"style":1270},[3236],{"type":428,"value":1284},{"type":422,"tag":447,"props":3238,"children":3239},{"style":1276},[3240],{"type":428,"value":3241},"ready",{"type":422,"tag":447,"props":3243,"children":3244},{"style":1270},[3245],{"type":428,"value":1284},{"type":422,"tag":447,"props":3247,"children":3248},{"style":476},[3249],{"type":428,"value":490},{"type":422,"tag":447,"props":3251,"children":3252},{"style":464},[3253],{"type":428,"value":590},{"type":422,"tag":447,"props":3255,"children":3256},{"style":476},[3257],{"type":428,"value":1930},{"type":422,"tag":447,"props":3259,"children":3260},{"style":476},[3261],{"type":428,"value":505},{"type":422,"tag":447,"props":3263,"children":3264},{"class":449,"line":856},[3265,3269,3273,3278,3282,3286,3291,3295],{"type":422,"tag":447,"props":3266,"children":3267},{"style":512},[3268],{"type":428,"value":920},{"type":422,"tag":447,"props":3270,"children":3271},{"style":518},[3272],{"type":428,"value":521},{"type":422,"tag":447,"props":3274,"children":3275},{"style":1009},[3276],{"type":428,"value":3277},"!",{"type":422,"tag":447,"props":3279,"children":3280},{"style":518},[3281],{"type":428,"value":479},{"type":422,"tag":447,"props":3283,"children":3284},{"style":1009},[3285],{"type":428,"value":1617},{"type":422,"tag":447,"props":3287,"children":3288},{"style":524},[3289],{"type":428,"value":3290},"counter",{"type":422,"tag":447,"props":3292,"children":3293},{"style":518},[3294],{"type":428,"value":550},{"type":422,"tag":447,"props":3296,"children":3297},{"style":476},[3298],{"type":428,"value":555},{"type":422,"tag":447,"props":3300,"children":3301},{"class":449,"line":914},[3302,3307,3311,3315],{"type":422,"tag":447,"props":3303,"children":3304},{"style":470},[3305],{"type":428,"value":3306},"        emitReady",{"type":422,"tag":447,"props":3308,"children":3309},{"style":518},[3310],{"type":428,"value":479},{"type":422,"tag":447,"props":3312,"children":3313},{"style":524},[3314],{"type":428,"value":2060},{"type":422,"tag":447,"props":3316,"children":3317},{"style":518},[3318],{"type":428,"value":639},{"type":422,"tag":447,"props":3320,"children":3321},{"class":449,"line":946},[3322],{"type":422,"tag":447,"props":3323,"children":3324},{"style":476},[3325],{"type":428,"value":3326},"      }\n",{"type":422,"tag":447,"props":3328,"children":3329},{"class":449,"line":995},[3330,3334],{"type":422,"tag":447,"props":3331,"children":3332},{"style":476},[3333],{"type":428,"value":648},{"type":422,"tag":447,"props":3335,"children":3336},{"style":518},[3337],{"type":428,"value":639},{"type":422,"tag":447,"props":3339,"children":3340},{"class":449,"line":1049},[3341,3345],{"type":422,"tag":447,"props":3342,"children":3343},{"style":476},[3344],{"type":428,"value":1453},{"type":422,"tag":447,"props":3346,"children":3347},{"style":518},[3348],{"type":428,"value":639},{"type":422,"tag":447,"props":3350,"children":3351},{"class":449,"line":1093},[3352],{"type":422,"tag":447,"props":3353,"children":3354},{"emptyLinePlaceholder":414},[3355],{"type":428,"value":1680},{"type":422,"tag":447,"props":3357,"children":3358},{"class":449,"line":1122},[3359,3363,3367,3371,3375,3379,3383],{"type":422,"tag":447,"props":3360,"children":3361},{"style":524},[3362],{"type":428,"value":1700},{"type":422,"tag":447,"props":3364,"children":3365},{"style":476},[3366],{"type":428,"value":532},{"type":422,"tag":447,"props":3368,"children":3369},{"style":470},[3370],{"type":428,"value":1950},{"type":422,"tag":447,"props":3372,"children":3373},{"style":1009},[3374],{"type":428,"value":1012},{"type":422,"tag":447,"props":3376,"children":3377},{"style":464},[3378],{"type":428,"value":590},{"type":422,"tag":447,"props":3380,"children":3381},{"style":476},[3382],{"type":428,"value":1930},{"type":422,"tag":447,"props":3384,"children":3385},{"style":476},[3386],{"type":428,"value":505},{"type":422,"tag":447,"props":3388,"children":3389},{"class":449,"line":1131},[3390,3395,3399,3403,3407,3411,3415,3419,3423],{"type":422,"tag":447,"props":3391,"children":3392},{"style":524},[3393],{"type":428,"value":3394},"    watchers",{"type":422,"tag":447,"props":3396,"children":3397},{"style":476},[3398],{"type":428,"value":532},{"type":422,"tag":447,"props":3400,"children":3401},{"style":470},[3402],{"type":428,"value":961},{"type":422,"tag":447,"props":3404,"children":3405},{"style":518},[3406],{"type":428,"value":479},{"type":422,"tag":447,"props":3408,"children":3409},{"style":464},[3410],{"type":428,"value":467},{"type":422,"tag":447,"props":3412,"children":3413},{"style":476},[3414],{"type":428,"value":479},{"type":422,"tag":447,"props":3416,"children":3417},{"style":482},[3418],{"type":428,"value":2957},{"type":422,"tag":447,"props":3420,"children":3421},{"style":476},[3422],{"type":428,"value":500},{"type":422,"tag":447,"props":3424,"children":3425},{"style":476},[3426],{"type":428,"value":505},{"type":422,"tag":447,"props":3428,"children":3429},{"class":449,"line":1144},[3430,3435,3439,3443],{"type":422,"tag":447,"props":3431,"children":3432},{"style":524},[3433],{"type":428,"value":3434},"      w",{"type":422,"tag":447,"props":3436,"children":3437},{"style":476},[3438],{"type":428,"value":532},{"type":422,"tag":447,"props":3440,"children":3441},{"style":470},[3442],{"type":428,"value":1950},{"type":422,"tag":447,"props":3444,"children":3445},{"style":518},[3446],{"type":428,"value":1955},{"type":422,"tag":447,"props":3448,"children":3449},{"class":449,"line":1157},[3450,3454],{"type":422,"tag":447,"props":3451,"children":3452},{"style":476},[3453],{"type":428,"value":648},{"type":422,"tag":447,"props":3455,"children":3456},{"style":518},[3457],{"type":428,"value":639},{"type":422,"tag":447,"props":3459,"children":3460},{"class":449,"line":1165},[3461,3466,3470,3475,3479,3484,3488,3492],{"type":422,"tag":447,"props":3462,"children":3463},{"style":524},[3464],{"type":428,"value":3465},"    process",{"type":422,"tag":447,"props":3467,"children":3468},{"style":476},[3469],{"type":428,"value":532},{"type":422,"tag":447,"props":3471,"children":3472},{"style":470},[3473],{"type":428,"value":3474},"nextTick",{"type":422,"tag":447,"props":3476,"children":3477},{"style":518},[3478],{"type":428,"value":479},{"type":422,"tag":447,"props":3480,"children":3481},{"style":524},[3482],{"type":428,"value":3483},"emitClose",{"type":422,"tag":447,"props":3485,"children":3486},{"style":476},[3487],{"type":428,"value":490},{"type":422,"tag":447,"props":3489,"children":3490},{"style":524},[3491],{"type":428,"value":2844},{"type":422,"tag":447,"props":3493,"children":3494},{"style":518},[3495],{"type":428,"value":639},{"type":422,"tag":447,"props":3497,"children":3498},{"class":449,"line":2292},[3499],{"type":422,"tag":447,"props":3500,"children":3501},{"style":476},[3502],{"type":428,"value":670},{"type":422,"tag":447,"props":3504,"children":3505},{"class":449,"line":2304},[3506],{"type":422,"tag":447,"props":3507,"children":3508},{"emptyLinePlaceholder":414},[3509],{"type":428,"value":1680},{"type":422,"tag":447,"props":3511,"children":3512},{"class":449,"line":2312},[3513,3517,3521,3525,3529,3533,3537,3542,3546],{"type":422,"tag":447,"props":3514,"children":3515},{"style":524},[3516],{"type":428,"value":1700},{"type":422,"tag":447,"props":3518,"children":3519},{"style":476},[3520],{"type":428,"value":532},{"type":422,"tag":447,"props":3522,"children":3523},{"style":470},[3524],{"type":428,"value":2597},{"type":422,"tag":447,"props":3526,"children":3527},{"style":1009},[3528],{"type":428,"value":1012},{"type":422,"tag":447,"props":3530,"children":3531},{"style":464},[3532],{"type":428,"value":590},{"type":422,"tag":447,"props":3534,"children":3535},{"style":476},[3536],{"type":428,"value":479},{"type":422,"tag":447,"props":3538,"children":3539},{"style":482},[3540],{"type":428,"value":3541},"fn",{"type":422,"tag":447,"props":3543,"children":3544},{"style":476},[3545],{"type":428,"value":500},{"type":422,"tag":447,"props":3547,"children":3548},{"style":476},[3549],{"type":428,"value":505},{"type":422,"tag":447,"props":3551,"children":3553},{"class":449,"line":3552},29,[3554,3558,3562,3566,3570,3575,3579,3583,3587],{"type":422,"tag":447,"props":3555,"children":3556},{"style":512},[3557],{"type":428,"value":1354},{"type":422,"tag":447,"props":3559,"children":3560},{"style":518},[3561],{"type":428,"value":521},{"type":422,"tag":447,"props":3563,"children":3564},{"style":524},[3565],{"type":428,"value":527},{"type":422,"tag":447,"props":3567,"children":3568},{"style":476},[3569],{"type":428,"value":532},{"type":422,"tag":447,"props":3571,"children":3572},{"style":470},[3573],{"type":428,"value":3574},"func",{"type":422,"tag":447,"props":3576,"children":3577},{"style":518},[3578],{"type":428,"value":479},{"type":422,"tag":447,"props":3580,"children":3581},{"style":524},[3582],{"type":428,"value":3541},{"type":422,"tag":447,"props":3584,"children":3585},{"style":518},[3586],{"type":428,"value":550},{"type":422,"tag":447,"props":3588,"children":3589},{"style":476},[3590],{"type":428,"value":555},{"type":422,"tag":447,"props":3592,"children":3594},{"class":449,"line":3593},30,[3595,3600,3605,3609,3613,3617,3622,3626,3630,3634,3638,3642],{"type":422,"tag":447,"props":3596,"children":3597},{"style":464},[3598],{"type":428,"value":3599},"      var",{"type":422,"tag":447,"props":3601,"children":3602},{"style":524},[3603],{"type":428,"value":3604}," promises",{"type":422,"tag":447,"props":3606,"children":3607},{"style":1009},[3608],{"type":428,"value":1012},{"type":422,"tag":447,"props":3610,"children":3611},{"style":524},[3612],{"type":428,"value":2908},{"type":422,"tag":447,"props":3614,"children":3615},{"style":476},[3616],{"type":428,"value":532},{"type":422,"tag":447,"props":3618,"children":3619},{"style":470},[3620],{"type":428,"value":3621},"map",{"type":422,"tag":447,"props":3623,"children":3624},{"style":518},[3625],{"type":428,"value":479},{"type":422,"tag":447,"props":3627,"children":3628},{"style":464},[3629],{"type":428,"value":467},{"type":422,"tag":447,"props":3631,"children":3632},{"style":476},[3633],{"type":428,"value":479},{"type":422,"tag":447,"props":3635,"children":3636},{"style":482},[3637],{"type":428,"value":2957},{"type":422,"tag":447,"props":3639,"children":3640},{"style":476},[3641],{"type":428,"value":500},{"type":422,"tag":447,"props":3643,"children":3644},{"style":476},[3645],{"type":428,"value":505},{"type":422,"tag":447,"props":3647,"children":3649},{"class":449,"line":3648},31,[3650,3655,3659,3664,3668,3672,3676,3680,3684],{"type":422,"tag":447,"props":3651,"children":3652},{"style":512},[3653],{"type":428,"value":3654},"        return",{"type":422,"tag":447,"props":3656,"children":3657},{"style":1009},[3658],{"type":428,"value":2853},{"type":422,"tag":447,"props":3660,"children":3661},{"style":2339},[3662],{"type":428,"value":3663}," Promise",{"type":422,"tag":447,"props":3665,"children":3666},{"style":518},[3667],{"type":428,"value":479},{"type":422,"tag":447,"props":3669,"children":3670},{"style":464},[3671],{"type":428,"value":467},{"type":422,"tag":447,"props":3673,"children":3674},{"style":476},[3675],{"type":428,"value":479},{"type":422,"tag":447,"props":3677,"children":3678},{"style":482},[3679],{"type":428,"value":1254},{"type":422,"tag":447,"props":3681,"children":3682},{"style":476},[3683],{"type":428,"value":500},{"type":422,"tag":447,"props":3685,"children":3686},{"style":476},[3687],{"type":428,"value":505},{"type":422,"tag":447,"props":3689,"children":3691},{"class":449,"line":3690},32,[3692,3697,3701,3705,3709,3713],{"type":422,"tag":447,"props":3693,"children":3694},{"style":524},[3695],{"type":428,"value":3696},"          w",{"type":422,"tag":447,"props":3698,"children":3699},{"style":476},[3700],{"type":428,"value":532},{"type":422,"tag":447,"props":3702,"children":3703},{"style":470},[3704],{"type":428,"value":2597},{"type":422,"tag":447,"props":3706,"children":3707},{"style":518},[3708],{"type":428,"value":479},{"type":422,"tag":447,"props":3710,"children":3711},{"style":524},[3712],{"type":428,"value":1254},{"type":422,"tag":447,"props":3714,"children":3715},{"style":518},[3716],{"type":428,"value":639},{"type":422,"tag":447,"props":3718,"children":3720},{"class":449,"line":3719},33,[3721,3726],{"type":422,"tag":447,"props":3722,"children":3723},{"style":476},[3724],{"type":428,"value":3725},"        }",{"type":422,"tag":447,"props":3727,"children":3728},{"style":518},[3729],{"type":428,"value":639},{"type":422,"tag":447,"props":3731,"children":3733},{"class":449,"line":3732},34,[3734,3738],{"type":422,"tag":447,"props":3735,"children":3736},{"style":476},[3737],{"type":428,"value":1137},{"type":422,"tag":447,"props":3739,"children":3740},{"style":518},[3741],{"type":428,"value":639},{"type":422,"tag":447,"props":3743,"children":3745},{"class":449,"line":3744},35,[3746,3751,3755,3760,3764,3769,3773,3777,3782,3786,3790,3794,3799,3803],{"type":422,"tag":447,"props":3747,"children":3748},{"style":2339},[3749],{"type":428,"value":3750},"      Promise",{"type":422,"tag":447,"props":3752,"children":3753},{"style":476},[3754],{"type":428,"value":532},{"type":422,"tag":447,"props":3756,"children":3757},{"style":470},[3758],{"type":428,"value":3759},"all",{"type":422,"tag":447,"props":3761,"children":3762},{"style":518},[3763],{"type":428,"value":479},{"type":422,"tag":447,"props":3765,"children":3766},{"style":524},[3767],{"type":428,"value":3768},"promises",{"type":422,"tag":447,"props":3770,"children":3771},{"style":518},[3772],{"type":428,"value":500},{"type":422,"tag":447,"props":3774,"children":3775},{"style":476},[3776],{"type":428,"value":532},{"type":422,"tag":447,"props":3778,"children":3779},{"style":470},[3780],{"type":428,"value":3781},"then",{"type":422,"tag":447,"props":3783,"children":3784},{"style":518},[3785],{"type":428,"value":479},{"type":422,"tag":447,"props":3787,"children":3788},{"style":464},[3789],{"type":428,"value":467},{"type":422,"tag":447,"props":3791,"children":3792},{"style":476},[3793],{"type":428,"value":479},{"type":422,"tag":447,"props":3795,"children":3796},{"style":482},[3797],{"type":428,"value":3798},"result",{"type":422,"tag":447,"props":3800,"children":3801},{"style":476},[3802],{"type":428,"value":500},{"type":422,"tag":447,"props":3804,"children":3805},{"style":476},[3806],{"type":428,"value":505},{"type":422,"tag":447,"props":3808,"children":3810},{"class":449,"line":3809},36,[3811,3815,3820,3824,3829,3833,3838,3842,3846],{"type":422,"tag":447,"props":3812,"children":3813},{"style":464},[3814],{"type":428,"value":1001},{"type":422,"tag":447,"props":3816,"children":3817},{"style":524},[3818],{"type":428,"value":3819}," ret",{"type":422,"tag":447,"props":3821,"children":3822},{"style":1009},[3823],{"type":428,"value":1012},{"type":422,"tag":447,"props":3825,"children":3826},{"style":470},[3827],{"type":428,"value":3828}," unique",{"type":422,"tag":447,"props":3830,"children":3831},{"style":518},[3832],{"type":428,"value":479},{"type":422,"tag":447,"props":3834,"children":3835},{"style":470},[3836],{"type":428,"value":3837},"flat1",{"type":422,"tag":447,"props":3839,"children":3840},{"style":518},[3841],{"type":428,"value":479},{"type":422,"tag":447,"props":3843,"children":3844},{"style":524},[3845],{"type":428,"value":3798},{"type":422,"tag":447,"props":3847,"children":3848},{"style":518},[3849],{"type":428,"value":3102},{"type":422,"tag":447,"props":3851,"children":3853},{"class":449,"line":3852},37,[3854,3859,3863,3868],{"type":422,"tag":447,"props":3855,"children":3856},{"style":470},[3857],{"type":428,"value":3858},"        fn",{"type":422,"tag":447,"props":3860,"children":3861},{"style":518},[3862],{"type":428,"value":479},{"type":422,"tag":447,"props":3864,"children":3865},{"style":524},[3866],{"type":428,"value":3867},"ret",{"type":422,"tag":447,"props":3869,"children":3870},{"style":518},[3871],{"type":428,"value":639},{"type":422,"tag":447,"props":3873,"children":3875},{"class":449,"line":3874},38,[3876,3880],{"type":422,"tag":447,"props":3877,"children":3878},{"style":476},[3879],{"type":428,"value":1137},{"type":422,"tag":447,"props":3881,"children":3882},{"style":518},[3883],{"type":428,"value":639},{"type":422,"tag":447,"props":3885,"children":3887},{"class":449,"line":3886},39,[3888],{"type":422,"tag":447,"props":3889,"children":3890},{"style":476},[3891],{"type":428,"value":1445},{"type":422,"tag":447,"props":3893,"children":3895},{"class":449,"line":3894},40,[3896],{"type":422,"tag":447,"props":3897,"children":3898},{"style":476},[3899],{"type":428,"value":670},{"type":422,"tag":447,"props":3901,"children":3903},{"class":449,"line":3902},41,[3904],{"type":422,"tag":447,"props":3905,"children":3906},{"emptyLinePlaceholder":414},[3907],{"type":428,"value":1680},{"type":422,"tag":447,"props":3909,"children":3911},{"class":449,"line":3910},42,[3912,3916,3920,3924,3928],{"type":422,"tag":447,"props":3913,"children":3914},{"style":512},[3915],{"type":428,"value":2771},{"type":422,"tag":447,"props":3917,"children":3918},{"style":524},[3919],{"type":428,"value":2844},{"type":422,"tag":447,"props":3921,"children":3922},{"style":476},[3923],{"type":428,"value":532},{"type":422,"tag":447,"props":3925,"children":3926},{"style":470},[3927],{"type":428,"value":2360},{"type":422,"tag":447,"props":3929,"children":3930},{"style":518},[3931],{"type":428,"value":1955},{"type":422,"tag":447,"props":3933,"children":3935},{"class":449,"line":3934},43,[3936],{"type":422,"tag":447,"props":3937,"children":3938},{"style":476},[3939],{"type":428,"value":1171},{"type":422,"tag":423,"props":3941,"children":3943},{"id":3942},"工具函数",[3944],{"type":428,"value":3942},{"type":422,"tag":430,"props":3946,"children":3947},{},[3948],{"type":428,"value":3949},"通过索引快速去重。第一次见到有人使用 filter 方法的第三个参数。",{"type":422,"tag":436,"props":3951,"children":3953},{"className":438,"code":3952,"language":440,"meta":415,"style":415},"function unique(arr) {\n  return arr.filter(function(v, i, self) {\n    return self.indexOf(v) === i\n  })\n}\n",[3954],{"type":422,"tag":443,"props":3955,"children":3956},{"__ignoreMap":415},[3957,3985,4048,4089,4100],{"type":422,"tag":447,"props":3958,"children":3959},{"class":449,"line":450},[3960,3964,3968,3972,3977,3981],{"type":422,"tag":447,"props":3961,"children":3962},{"style":464},[3963],{"type":428,"value":467},{"type":422,"tag":447,"props":3965,"children":3966},{"style":470},[3967],{"type":428,"value":3828},{"type":422,"tag":447,"props":3969,"children":3970},{"style":476},[3971],{"type":428,"value":479},{"type":422,"tag":447,"props":3973,"children":3974},{"style":482},[3975],{"type":428,"value":3976},"arr",{"type":422,"tag":447,"props":3978,"children":3979},{"style":476},[3980],{"type":428,"value":500},{"type":422,"tag":447,"props":3982,"children":3983},{"style":476},[3984],{"type":428,"value":505},{"type":422,"tag":447,"props":3986,"children":3987},{"class":449,"line":460},[3988,3992,3997,4001,4006,4010,4014,4018,4023,4027,4032,4036,4040,4044],{"type":422,"tag":447,"props":3989,"children":3990},{"style":512},[3991],{"type":428,"value":2771},{"type":422,"tag":447,"props":3993,"children":3994},{"style":524},[3995],{"type":428,"value":3996}," arr",{"type":422,"tag":447,"props":3998,"children":3999},{"style":476},[4000],{"type":428,"value":532},{"type":422,"tag":447,"props":4002,"children":4003},{"style":470},[4004],{"type":428,"value":4005},"filter",{"type":422,"tag":447,"props":4007,"children":4008},{"style":518},[4009],{"type":428,"value":479},{"type":422,"tag":447,"props":4011,"children":4012},{"style":464},[4013],{"type":428,"value":467},{"type":422,"tag":447,"props":4015,"children":4016},{"style":476},[4017],{"type":428,"value":479},{"type":422,"tag":447,"props":4019,"children":4020},{"style":482},[4021],{"type":428,"value":4022},"v",{"type":422,"tag":447,"props":4024,"children":4025},{"style":476},[4026],{"type":428,"value":490},{"type":422,"tag":447,"props":4028,"children":4029},{"style":482},[4030],{"type":428,"value":4031}," i",{"type":422,"tag":447,"props":4033,"children":4034},{"style":476},[4035],{"type":428,"value":490},{"type":422,"tag":447,"props":4037,"children":4038},{"style":482},[4039],{"type":428,"value":2409},{"type":422,"tag":447,"props":4041,"children":4042},{"style":476},[4043],{"type":428,"value":500},{"type":422,"tag":447,"props":4045,"children":4046},{"style":476},[4047],{"type":428,"value":505},{"type":422,"tag":447,"props":4049,"children":4050},{"class":449,"line":508},[4051,4055,4059,4063,4068,4072,4076,4080,4084],{"type":422,"tag":447,"props":4052,"children":4053},{"style":512},[4054],{"type":428,"value":1817},{"type":422,"tag":447,"props":4056,"children":4057},{"style":524},[4058],{"type":428,"value":2409},{"type":422,"tag":447,"props":4060,"children":4061},{"style":476},[4062],{"type":428,"value":532},{"type":422,"tag":447,"props":4064,"children":4065},{"style":470},[4066],{"type":428,"value":4067},"indexOf",{"type":422,"tag":447,"props":4069,"children":4070},{"style":518},[4071],{"type":428,"value":479},{"type":422,"tag":447,"props":4073,"children":4074},{"style":524},[4075],{"type":428,"value":4022},{"type":422,"tag":447,"props":4077,"children":4078},{"style":518},[4079],{"type":428,"value":933},{"type":422,"tag":447,"props":4081,"children":4082},{"style":1009},[4083],{"type":428,"value":1389},{"type":422,"tag":447,"props":4085,"children":4086},{"style":524},[4087],{"type":428,"value":4088}," i\n",{"type":422,"tag":447,"props":4090,"children":4091},{"class":449,"line":558},[4092,4096],{"type":422,"tag":447,"props":4093,"children":4094},{"style":476},[4095],{"type":428,"value":1453},{"type":422,"tag":447,"props":4097,"children":4098},{"style":518},[4099],{"type":428,"value":639},{"type":422,"tag":447,"props":4101,"children":4102},{"class":449,"line":610},[4103],{"type":422,"tag":447,"props":4104,"children":4105},{"style":476},[4106],{"type":428,"value":1171},{"type":422,"tag":430,"props":4108,"children":4109},{},[4110],{"type":428,"value":4111},"获取 UUID，这个有意思，但不知道效率怎么样。",{"type":422,"tag":436,"props":4113,"children":4115},{"className":438,"code":4114,"language":440,"meta":415,"style":415},"const getUUID = () => Math.random().toString(16).substr(2)\n",[4116],{"type":422,"tag":443,"props":4117,"children":4118},{"__ignoreMap":415},[4119],{"type":422,"tag":447,"props":4120,"children":4121},{"class":449,"line":450},[4122,4127,4133,4137,4142,4147,4152,4156,4161,4165,4169,4174,4178,4183,4187,4191,4196,4200,4205],{"type":422,"tag":447,"props":4123,"children":4124},{"style":464},[4125],{"type":428,"value":4126},"const",{"type":422,"tag":447,"props":4128,"children":4130},{"style":4129},"--shiki-light:#90A4AE;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[4131],{"type":428,"value":4132}," getUUID",{"type":422,"tag":447,"props":4134,"children":4135},{"style":1009},[4136],{"type":428,"value":1012},{"type":422,"tag":447,"props":4138,"children":4139},{"style":476},[4140],{"type":428,"value":4141}," ()",{"type":422,"tag":447,"props":4143,"children":4144},{"style":464},[4145],{"type":428,"value":4146}," =>",{"type":422,"tag":447,"props":4148,"children":4149},{"style":524},[4150],{"type":428,"value":4151}," Math",{"type":422,"tag":447,"props":4153,"children":4154},{"style":476},[4155],{"type":428,"value":532},{"type":422,"tag":447,"props":4157,"children":4158},{"style":470},[4159],{"type":428,"value":4160},"random",{"type":422,"tag":447,"props":4162,"children":4163},{"style":524},[4164],{"type":428,"value":1930},{"type":422,"tag":447,"props":4166,"children":4167},{"style":476},[4168],{"type":428,"value":532},{"type":422,"tag":447,"props":4170,"children":4171},{"style":470},[4172],{"type":428,"value":4173},"toString",{"type":422,"tag":447,"props":4175,"children":4176},{"style":524},[4177],{"type":428,"value":479},{"type":422,"tag":447,"props":4179,"children":4180},{"style":2038},[4181],{"type":428,"value":4182},"16",{"type":422,"tag":447,"props":4184,"children":4185},{"style":524},[4186],{"type":428,"value":500},{"type":422,"tag":447,"props":4188,"children":4189},{"style":476},[4190],{"type":428,"value":532},{"type":422,"tag":447,"props":4192,"children":4193},{"style":470},[4194],{"type":428,"value":4195},"substr",{"type":422,"tag":447,"props":4197,"children":4198},{"style":524},[4199],{"type":428,"value":479},{"type":422,"tag":447,"props":4201,"children":4202},{"style":2038},[4203],{"type":428,"value":4204},"2",{"type":422,"tag":447,"props":4206,"children":4207},{"style":524},[4208],{"type":428,"value":639},{"type":422,"tag":423,"props":4210,"children":4212},{"id":4211},"考虑的点",[4213],{"type":428,"value":4211},{"type":422,"tag":430,"props":4215,"children":4216},{},[4217],{"type":428,"value":4218},"最后总结一下一些框架设计相关的小细节，如果需要自己设计一个 fs.watch，可能要做以下考虑：",{"type":422,"tag":4220,"props":4221,"children":4222},"ul",{},[4223,4229,4234,4239],{"type":422,"tag":4224,"props":4225,"children":4226},"li",{},[4227],{"type":428,"value":4228},"使用原生依赖吗？使用原生依赖会带来更高的性能，但是也会增加代码难度以及测试的复杂度",{"type":422,"tag":4224,"props":4230,"children":4231},{},[4232],{"type":428,"value":4233},"支持本地符号路径吗？支持网络路径吗？",{"type":422,"tag":4224,"props":4235,"children":4236},{},[4237],{"type":428,"value":4238},"如何控制包的大小？",{"type":422,"tag":4224,"props":4240,"children":4241},{},[4242],{"type":428,"value":4243},"由于不同系统的底层依赖不同，那么 API 要怎么设计，屏蔽底层，才能便于使用？",{"type":422,"tag":430,"props":4245,"children":4246},{},[4247],{"type":428,"value":4248},"也注意到一些有意思的问题：",{"type":422,"tag":4220,"props":4250,"children":4251},{},[4252,4264,4276],{"type":422,"tag":4224,"props":4253,"children":4254},{},[4255,4257],{"type":428,"value":4256},"Windows，删除正在监听的文件夹，",{"type":422,"tag":1178,"props":4258,"children":4261},{"href":4259,"rel":4260},"https://github.com/nodejs/node/issues/31702",[1182],[4262],{"type":428,"value":4263},"会发生什么事情？",{"type":422,"tag":4224,"props":4265,"children":4266},{},[4267,4269],{"type":428,"value":4268},"Linux，单个进程能操作的文件数量有上限，",{"type":422,"tag":1178,"props":4270,"children":4273},{"href":4271,"rel":4272},"https://github.com/nodejs/node-v0.x-archive/issues/2479",[1182],[4274],{"type":428,"value":4275},"该怎么解决？",{"type":422,"tag":4224,"props":4277,"children":4278},{},[4279,4281],{"type":428,"value":4280},"碰到操作系统或应用层面的问题，导致文件在短时间内多次触发更新，",{"type":422,"tag":1178,"props":4282,"children":4285},{"href":4283,"rel":4284},"https://github.com/yuanchuan/node-watch/blob/4cac915ab7cb5cc6a95263712e9def1004c35f78/lib/watch.js#L68",[1182],[4286],{"type":428,"value":4287},"怎么处理呢？",{"type":422,"tag":423,"props":4289,"children":4291},{"id":4290},"题外话",[4292],{"type":428,"value":4290},{"type":422,"tag":4294,"props":4295,"children":4298},"l-link",{"label":4296,"source":4297},"《Recursive Node.js fs.watch on Linux》","https://stackoverflow.com/questions/43112227/recursive-node-js-fs-watch-on-linux",[],{"type":422,"tag":430,"props":4300,"children":4301},{},[4302],{"type":428,"value":4303},"这个回答中的 node-watch 为啥会被踩，我没看很懂。",{"type":422,"tag":423,"props":4305,"children":4307},{"id":4306},"其它资料",[4308],{"type":428,"value":4306},{"type":422,"tag":430,"props":4310,"children":4311},{},[4312],{"type":428,"value":4313},"相关类库：",{"type":422,"tag":4220,"props":4315,"children":4316},{},[4317,4326,4336],{"type":422,"tag":4224,"props":4318,"children":4319},{},[4320],{"type":422,"tag":1178,"props":4321,"children":4324},{"href":4322,"rel":4323},"https://www.npmjs.com/package/watcher",[1182],[4325],{"type":428,"value":2060},{"type":422,"tag":4224,"props":4327,"children":4328},{},[4329],{"type":422,"tag":1178,"props":4330,"children":4333},{"href":4331,"rel":4332},"https://github.com/paulmillr/chokidar",[1182],[4334],{"type":428,"value":4335},"chokidar",{"type":422,"tag":4224,"props":4337,"children":4338},{},[4339],{"type":422,"tag":1178,"props":4340,"children":4343},{"href":4341,"rel":4342},"https://github.com/Axosoft/nsfw",[1182],[4344],{"type":428,"value":4345},"nsfw",{"type":422,"tag":430,"props":4347,"children":4348},{},[4349],{"type":428,"value":4350},"推荐阅读：",{"type":422,"tag":4220,"props":4352,"children":4353},{},[4354,4364],{"type":422,"tag":4224,"props":4355,"children":4356},{},[4357],{"type":422,"tag":1178,"props":4358,"children":4361},{"href":4359,"rel":4360},"https://juejin.cn/post/7000262974430511117",[1182],[4362],{"type":428,"value":4363},"《node-watch、Chokidar封装思路解析》",{"type":422,"tag":4224,"props":4365,"children":4366},{},[4367],{"type":422,"tag":1178,"props":4368,"children":4371},{"href":4369,"rel":4370},"https://www.jianshu.com/p/09dae09457fa",[1182],[4372],{"type":428,"value":4373},"《如何利用 Nodejs 监听文件夹》",{"type":422,"tag":4375,"props":4376,"children":4377},"style",{},[4378],{"type":428,"value":4379},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":415,"searchDepth":460,"depth":460,"links":4381},[4382,4383,4384,4385,4386],{"id":425,"depth":460,"text":425},{"id":3942,"depth":460,"text":3942},{"id":4211,"depth":460,"text":4211},{"id":4290,"depth":460,"text":4290},{"id":4306,"depth":460,"text":4306},"markdown","content:8.source-code:_node:node-watch.md","content","8.source-code/_node/node-watch.md","8.source-code/_node/node-watch","md",[4394,4398],{"_path":4395,"title":4396,"description":4397},"/source-code/_module/is-online","判断 NodeJS 是否在线","之前被组长问道要如何判断 NodeJS 是否在线，我不假思索回答：“Ping 百度试试。”。调用 Ping 需要 child_process，那还不如直接改用内置的 DNS 试试是否在线更简单一些。不过会不会碰到缓存等问题，没往下细想了。今天正好在别人的博客看到了 NodeJS DNS 模块，突然想起这个问题，于是就搜了一下相关库。找到了 internet-available 这个玩意儿。这里一起来看看他们的实现。",{"_path":4399,"title":4400,"description":415},"/source-code/_ts/type-challenges","TypeScript Type Chanllenges",1732808713986]