[{"data":1,"prerenderedAt":1484},["ShallowReactive",2],{"navigation":3,"/source-code/_module/is-online":393,"/source-code/_module/is-online-surround":1476},[4,35,86,105,132,138,144,150,387],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":45,"_path":46},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":48,"_path":49},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":51,"_path":52},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":54,"_path":55},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":57,"_path":58},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":60,"_path":61},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":63,"_path":64},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":66,"_path":67},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":69,"_path":70},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":72,"_path":73},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":75,"_path":76},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":78,"_path":79},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":81,"_path":82},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":84,"_path":85},"📝 技术博客归档","/articles/archive",{"title":87,"_path":88,"children":89},"造物 / Make","/tools",[90,93,96,99,102],{"title":91,"_path":92},"🥥 Coconut","/tools/coconut",{"title":94,"_path":95},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":97,"_path":98},"🌐 AnySort","/tools/anysort",{"title":100,"_path":101},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":103,"_path":104},"👓 Crapto","/tools/crypto-inline",{"title":106,"_path":107,"children":108},"吉他剧场 / Music","/music",[109,111,114,117,120,123,126,129],{"title":110,"_path":107},"🎸 FingerStyle！",{"title":112,"_path":113},"🌬️ 等待的风","/music/wind",{"title":115,"_path":116},"💕 约定的海洋","/music/ocean",{"title":118,"_path":119},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":121,"_path":122},"🌏 残酷天使的行动纲领","/music/eva",{"title":124,"_path":125},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":127,"_path":128},"🍷 Wu Wei","/music/wu-wei",{"title":130,"_path":131},"🌅 无题","/music/untitled",{"title":133,"_path":134,"children":135},"画点什么 / Paint","/paint",[136],{"title":137,"_path":134},"🚧 正在施工",{"title":139,"_path":140,"children":141},"读书笔记 / Notes","/books",[142],{"title":143,"_path":140},"📕 读书笔记",{"title":145,"_path":146,"children":147},"知识地图 / Maps","/maps",[148],{"title":149,"_path":146},"🏁 知识地图",{"title":151,"_path":152,"children":153},"零散的笔记 / Gists","/gists",[154,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375,378,381,384],{"title":155,"_path":152},"🧊 Gists",{"title":157,"_path":158},"网站的可访问性","/gists/accessibility",{"title":160,"_path":161},"Bit","/gists/bit",{"title":163,"_path":164},"图片模糊","/gists/blur",{"title":166,"_path":167},"渲染相关笔记","/gists/c4d",{"title":169,"_path":170},"CDN 问题记录","/gists/cdn",{"title":172,"_path":173},"消毒剂","/gists/cleaner",{"title":175,"_path":176},"Windows Command","/gists/cmd",{"title":178,"_path":179},"Command","/gists/command",{"title":181,"_path":182},"复杂科学","/gists/complexity-science",{"title":184,"_path":185},"GitHub Copilot","/gists/copilot",{"title":187,"_path":188},"宇宙","/gists/cosmos",{"title":190,"_path":191},"C++","/gists/cpp",{"title":193,"_path":194},"DEPRESSION","/gists/depression",{"title":196,"_path":197},"Developer Experience","/gists/developer-experience",{"title":199,"_path":200},"Device Metrics","/gists/device-metrix",{"title":202,"_path":203},"数字化转型","/gists/digital-transformation",{"title":205,"_path":206},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":208,"_path":209},"正则表达式","/gists/eegex",{"title":211,"_path":212},"Emoji","/gists/emoji",{"title":214,"_path":215},"工程","/gists/engineering",{"title":217,"_path":218},"熵","/gists/entropy",{"title":220,"_path":221},"Environment","/gists/environment",{"title":223,"_path":224},"Erlang","/gists/erlang",{"title":226,"_path":227},"逃离塔克夫","/gists/escape-from-tarkov",{"title":229,"_path":230},"ESNext (ES6-ES11)","/gists/esnext",{"title":232,"_path":233},"Eval！","/gists/eval",{"title":235,"_path":236},"Flutter","/gists/flutter",{"title":238,"_path":239},"字体","/gists/font",{"title":241,"_path":242},"JS 函数式编程","/gists/functional",{"title":244,"_path":245},"游戏化","/gists/gamification",{"title":247,"_path":248},"Google C++ Standard","/gists/google-cpp-standard",{"title":250,"_path":251},"双向链接完全体","/gists/graph",{"title":253,"_path":254},"Hardwares","/gists/hardwares",{"title":256,"_path":257},"哈希冲突","/gists/hash-collision",{"title":259,"_path":260},"信息设计","/gists/information-design",{"title":262,"_path":263},"InstantPage","/gists/instant.page",{"title":265,"_path":266},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":268,"_path":269},"KVStore","/gists/key-value-db",{"title":271,"_path":272},"Kubernetes","/gists/kubernetes",{"title":274,"_path":275},"Makefile","/gists/makefile",{"title":277,"_path":278},"Markdown Inline Style","/gists/markdown-nice",{"title":280,"_path":281},"小程序","/gists/miniapp",{"title":283,"_path":284},"减小页面快照体积","/gists/minify-html",{"title":286,"_path":287},"mklink","/gists/mklink",{"title":289,"_path":290},"Mock","/gists/mock",{"title":292,"_path":293},"多人协作系统","/gists/multiplayer",{"title":295,"_path":296},"多端应用","/gists/multy-end-app",{"title":298,"_path":299},"神经科学","/gists/neuroscience",{"title":301,"_path":302},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":304,"_path":305},"PInvoke","/gists/pinvoke",{"title":307,"_path":308},"像素","/gists/pixel",{"title":310,"_path":311},"PowerShell","/gists/powershell",{"title":313,"_path":314},"量子","/gists/quantum",{"title":316,"_path":317},"保持好奇心","/gists/questions",{"title":319,"_path":320},"React Native","/gists/react-native",{"title":322,"_path":323},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":325,"_path":326},"SEO","/gists/seo",{"title":328,"_path":329},"Shader","/gists/shader",{"title":331,"_path":332},"Shape Up","/gists/shape-up",{"title":334,"_path":335},"睡觉","/gists/sleep",{"title":337,"_path":338},"记录奇怪的问题","/gists/solved",{"title":340,"_path":341},"States","/gists/states",{"title":343,"_path":344},"Storage","/gists/storage",{"title":346,"_path":347},"音视频流处理","/gists/stream-cli",{"title":349,"_path":350},"Symbol","/gists/symbol",{"title":352,"_path":353},"系统论","/gists/systems-theory",{"title":355,"_path":356},"Taro","/gists/taro",{"title":358,"_path":359},"任务切片","/gists/task-slice",{"title":361,"_path":362},"技术偏好","/gists/tech-dudge",{"title":364,"_path":365},"Untitled","/gists/untitled",{"title":367,"_path":368},"可变字体","/gists/variable-font",{"title":370,"_path":371},"视觉错觉","/gists/visual-illusion",{"title":373,"_path":374},"SS(SSR)","/gists/vpn",{"title":376,"_path":377},"VS Code 插件开发","/gists/vscode-plugin",{"title":379,"_path":380},"Web Components","/gists/web-components",{"title":382,"_path":383},"Windows","/gists/windows",{"title":385,"_path":386},"查缺补漏","/gists/wrong",{"title":388,"_path":389,"children":390},"我 / About","/hire",[391],{"title":392,"_path":389},"📬 技术简历",{"_path":394,"_dir":395,"_draft":396,"_partial":397,"_locale":398,"title":399,"description":400,"body":401,"_type":1470,"_id":1471,"_source":1472,"_file":1473,"_stem":1474,"_extension":1475},"/source-code/_module/is-online","_module",false,true,"","判断 NodeJS 是否在线","之前被组长问道要如何判断 NodeJS 是否在线，我不假思索回答：“Ping 百度试试。”。调用 Ping 需要 child_process，那还不如直接改用内置的 DNS 试试是否在线更简单一些。不过会不会碰到缓存等问题，没往下细想了。今天正好在别人的博客看到了 NodeJS DNS 模块，突然想起这个问题，于是就搜了一下相关库。找到了 internet-available 这个玩意儿。这里一起来看看他们的实现。",{"type":402,"children":403,"toc":1463},"root",[404,412,417,423,429,442,447,452,1410,1423,1437,1442,1457],{"type":405,"tag":406,"props":407,"children":409},"element","h1",{"id":408},"判断-nodejs-是否在线",[410],{"type":411,"value":399},"text",{"type":405,"tag":413,"props":414,"children":415},"p",{},[416],{"type":411,"value":400},{"type":405,"tag":418,"props":419,"children":421},"h2",{"id":420},"internet-available",[422],{"type":411,"value":420},{"type":405,"tag":424,"props":425,"children":427},"h3",{"id":426},"长话短说",[428],{"type":411,"value":426},{"type":405,"tag":413,"props":430,"children":431},{},[432,440],{"type":405,"tag":433,"props":434,"children":438},"a",{"href":435,"rel":436},"https://github.com/ourcodeworld/internet-available/blob/master/internet-available.js",[437],"nofollow",[439],{"type":411,"value":420},{"type":411,"value":441}," 使用 dns-socket 库去发起一个 google.com 的 DNS 请求。请求成功则确认服务器在线，超时则确认服务器离线。",{"type":405,"tag":424,"props":443,"children":445},{"id":444},"实现",[446],{"type":411,"value":444},{"type":405,"tag":413,"props":448,"children":449},{},[450],{"type":411,"value":451},"代码实现非常简单，不过 20 行。",{"type":405,"tag":453,"props":454,"children":458},"pre",{"className":455,"code":456,"language":457,"meta":398,"style":398},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","function internetAvailable(settings) {\n    var dns = require('dns-socket');\n    settings = settings || {};\n\n    return new Promise(function(resolve, reject){\n        // Create instance of the DNS resolver\n        // 默认超时五秒；重试次数五次\n        var socket = dns({\n            timeout: (settings.timeout || 5000),\n            retries: (settings.retries || 5)\n        });\n\n        // Run the dns lowlevel lookup\n        // 默认 DNS 服务器地址是 8.8.8.8，请求 google.com\n        // 国内需要换成 114.114.114.114 & baidu.com，原因你懂\n        socket.query({\n            questions: [{\n                type: 'A',\n                name: (settings.domainName || \"google.com\")\n            }]\n        }, (settings.port || 53), (settings.host || '8.8.8.8'));\n\n        // DNS Address solved, internet available\n        socket.on('response', () => { \n            socket.destroy(() => {\n                resolve();\n            });\n        });\n\n        // Verify for timeout of the request (cannot reach server)\n        socket.on('timeout', () => {\n            socket.destroy(() => {\n                reject();\n            });\n        });\n    });\n}\n","js",[459],{"type":405,"tag":460,"props":461,"children":462},"code",{"__ignoreMap":398},[463,503,559,587,596,649,659,668,699,751,795,812,820,829,838,847,873,895,926,979,993,1079,1087,1096,1154,1189,1206,1222,1238,1246,1255,1303,1335,1352,1368,1384,1401],{"type":405,"tag":464,"props":465,"children":468},"span",{"class":466,"line":467},"line",1,[469,475,481,487,493,498],{"type":405,"tag":464,"props":470,"children":472},{"style":471},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[473],{"type":411,"value":474},"function",{"type":405,"tag":464,"props":476,"children":478},{"style":477},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[479],{"type":411,"value":480}," internetAvailable",{"type":405,"tag":464,"props":482,"children":484},{"style":483},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[485],{"type":411,"value":486},"(",{"type":405,"tag":464,"props":488,"children":490},{"style":489},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[491],{"type":411,"value":492},"settings",{"type":405,"tag":464,"props":494,"children":495},{"style":483},[496],{"type":411,"value":497},")",{"type":405,"tag":464,"props":499,"children":500},{"style":483},[501],{"type":411,"value":502}," {\n",{"type":405,"tag":464,"props":504,"children":506},{"class":466,"line":505},2,[507,512,518,524,529,534,540,546,550,554],{"type":405,"tag":464,"props":508,"children":509},{"style":471},[510],{"type":411,"value":511},"    var",{"type":405,"tag":464,"props":513,"children":515},{"style":514},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[516],{"type":411,"value":517}," dns",{"type":405,"tag":464,"props":519,"children":521},{"style":520},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[522],{"type":411,"value":523}," =",{"type":405,"tag":464,"props":525,"children":526},{"style":477},[527],{"type":411,"value":528}," require",{"type":405,"tag":464,"props":530,"children":532},{"style":531},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[533],{"type":411,"value":486},{"type":405,"tag":464,"props":535,"children":537},{"style":536},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[538],{"type":411,"value":539},"'",{"type":405,"tag":464,"props":541,"children":543},{"style":542},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[544],{"type":411,"value":545},"dns-socket",{"type":405,"tag":464,"props":547,"children":548},{"style":536},[549],{"type":411,"value":539},{"type":405,"tag":464,"props":551,"children":552},{"style":531},[553],{"type":411,"value":497},{"type":405,"tag":464,"props":555,"children":556},{"style":483},[557],{"type":411,"value":558},";\n",{"type":405,"tag":464,"props":560,"children":562},{"class":466,"line":561},3,[563,568,572,577,582],{"type":405,"tag":464,"props":564,"children":565},{"style":514},[566],{"type":411,"value":567},"    settings",{"type":405,"tag":464,"props":569,"children":570},{"style":520},[571],{"type":411,"value":523},{"type":405,"tag":464,"props":573,"children":574},{"style":514},[575],{"type":411,"value":576}," settings",{"type":405,"tag":464,"props":578,"children":579},{"style":520},[580],{"type":411,"value":581}," ||",{"type":405,"tag":464,"props":583,"children":584},{"style":483},[585],{"type":411,"value":586}," {};\n",{"type":405,"tag":464,"props":588,"children":590},{"class":466,"line":589},4,[591],{"type":405,"tag":464,"props":592,"children":593},{"emptyLinePlaceholder":397},[594],{"type":411,"value":595},"\n",{"type":405,"tag":464,"props":597,"children":599},{"class":466,"line":598},5,[600,606,611,617,621,625,629,634,639,644],{"type":405,"tag":464,"props":601,"children":603},{"style":602},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[604],{"type":411,"value":605},"    return",{"type":405,"tag":464,"props":607,"children":608},{"style":520},[609],{"type":411,"value":610}," new",{"type":405,"tag":464,"props":612,"children":614},{"style":613},"--shiki-light:#E2931D;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[615],{"type":411,"value":616}," Promise",{"type":405,"tag":464,"props":618,"children":619},{"style":531},[620],{"type":411,"value":486},{"type":405,"tag":464,"props":622,"children":623},{"style":471},[624],{"type":411,"value":474},{"type":405,"tag":464,"props":626,"children":627},{"style":483},[628],{"type":411,"value":486},{"type":405,"tag":464,"props":630,"children":631},{"style":489},[632],{"type":411,"value":633},"resolve",{"type":405,"tag":464,"props":635,"children":636},{"style":483},[637],{"type":411,"value":638},",",{"type":405,"tag":464,"props":640,"children":641},{"style":489},[642],{"type":411,"value":643}," reject",{"type":405,"tag":464,"props":645,"children":646},{"style":483},[647],{"type":411,"value":648},"){\n",{"type":405,"tag":464,"props":650,"children":652},{"class":466,"line":651},6,[653],{"type":405,"tag":464,"props":654,"children":656},{"style":655},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[657],{"type":411,"value":658},"        // Create instance of the DNS resolver\n",{"type":405,"tag":464,"props":660,"children":662},{"class":466,"line":661},7,[663],{"type":405,"tag":464,"props":664,"children":665},{"style":655},[666],{"type":411,"value":667},"        // 默认超时五秒；重试次数五次\n",{"type":405,"tag":464,"props":669,"children":671},{"class":466,"line":670},8,[672,677,682,686,690,694],{"type":405,"tag":464,"props":673,"children":674},{"style":471},[675],{"type":411,"value":676},"        var",{"type":405,"tag":464,"props":678,"children":679},{"style":514},[680],{"type":411,"value":681}," socket",{"type":405,"tag":464,"props":683,"children":684},{"style":520},[685],{"type":411,"value":523},{"type":405,"tag":464,"props":687,"children":688},{"style":477},[689],{"type":411,"value":517},{"type":405,"tag":464,"props":691,"children":692},{"style":531},[693],{"type":411,"value":486},{"type":405,"tag":464,"props":695,"children":696},{"style":483},[697],{"type":411,"value":698},"{\n",{"type":405,"tag":464,"props":700,"children":702},{"class":466,"line":701},9,[703,708,713,718,722,727,732,736,742,746],{"type":405,"tag":464,"props":704,"children":705},{"style":531},[706],{"type":411,"value":707},"            timeout",{"type":405,"tag":464,"props":709,"children":710},{"style":483},[711],{"type":411,"value":712},":",{"type":405,"tag":464,"props":714,"children":715},{"style":531},[716],{"type":411,"value":717}," (",{"type":405,"tag":464,"props":719,"children":720},{"style":514},[721],{"type":411,"value":492},{"type":405,"tag":464,"props":723,"children":724},{"style":483},[725],{"type":411,"value":726},".",{"type":405,"tag":464,"props":728,"children":729},{"style":514},[730],{"type":411,"value":731},"timeout",{"type":405,"tag":464,"props":733,"children":734},{"style":520},[735],{"type":411,"value":581},{"type":405,"tag":464,"props":737,"children":739},{"style":738},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[740],{"type":411,"value":741}," 5000",{"type":405,"tag":464,"props":743,"children":744},{"style":531},[745],{"type":411,"value":497},{"type":405,"tag":464,"props":747,"children":748},{"style":483},[749],{"type":411,"value":750},",\n",{"type":405,"tag":464,"props":752,"children":754},{"class":466,"line":753},10,[755,760,764,768,772,776,781,785,790],{"type":405,"tag":464,"props":756,"children":757},{"style":531},[758],{"type":411,"value":759},"            retries",{"type":405,"tag":464,"props":761,"children":762},{"style":483},[763],{"type":411,"value":712},{"type":405,"tag":464,"props":765,"children":766},{"style":531},[767],{"type":411,"value":717},{"type":405,"tag":464,"props":769,"children":770},{"style":514},[771],{"type":411,"value":492},{"type":405,"tag":464,"props":773,"children":774},{"style":483},[775],{"type":411,"value":726},{"type":405,"tag":464,"props":777,"children":778},{"style":514},[779],{"type":411,"value":780},"retries",{"type":405,"tag":464,"props":782,"children":783},{"style":520},[784],{"type":411,"value":581},{"type":405,"tag":464,"props":786,"children":787},{"style":738},[788],{"type":411,"value":789}," 5",{"type":405,"tag":464,"props":791,"children":792},{"style":531},[793],{"type":411,"value":794},")\n",{"type":405,"tag":464,"props":796,"children":798},{"class":466,"line":797},11,[799,804,808],{"type":405,"tag":464,"props":800,"children":801},{"style":483},[802],{"type":411,"value":803},"        }",{"type":405,"tag":464,"props":805,"children":806},{"style":531},[807],{"type":411,"value":497},{"type":405,"tag":464,"props":809,"children":810},{"style":483},[811],{"type":411,"value":558},{"type":405,"tag":464,"props":813,"children":815},{"class":466,"line":814},12,[816],{"type":405,"tag":464,"props":817,"children":818},{"emptyLinePlaceholder":397},[819],{"type":411,"value":595},{"type":405,"tag":464,"props":821,"children":823},{"class":466,"line":822},13,[824],{"type":405,"tag":464,"props":825,"children":826},{"style":655},[827],{"type":411,"value":828},"        // Run the dns lowlevel lookup\n",{"type":405,"tag":464,"props":830,"children":832},{"class":466,"line":831},14,[833],{"type":405,"tag":464,"props":834,"children":835},{"style":655},[836],{"type":411,"value":837},"        // 默认 DNS 服务器地址是 8.8.8.8，请求 google.com\n",{"type":405,"tag":464,"props":839,"children":841},{"class":466,"line":840},15,[842],{"type":405,"tag":464,"props":843,"children":844},{"style":655},[845],{"type":411,"value":846},"        // 国内需要换成 114.114.114.114 & baidu.com，原因你懂\n",{"type":405,"tag":464,"props":848,"children":850},{"class":466,"line":849},16,[851,856,860,865,869],{"type":405,"tag":464,"props":852,"children":853},{"style":514},[854],{"type":411,"value":855},"        socket",{"type":405,"tag":464,"props":857,"children":858},{"style":483},[859],{"type":411,"value":726},{"type":405,"tag":464,"props":861,"children":862},{"style":477},[863],{"type":411,"value":864},"query",{"type":405,"tag":464,"props":866,"children":867},{"style":531},[868],{"type":411,"value":486},{"type":405,"tag":464,"props":870,"children":871},{"style":483},[872],{"type":411,"value":698},{"type":405,"tag":464,"props":874,"children":876},{"class":466,"line":875},17,[877,882,886,891],{"type":405,"tag":464,"props":878,"children":879},{"style":531},[880],{"type":411,"value":881},"            questions",{"type":405,"tag":464,"props":883,"children":884},{"style":483},[885],{"type":411,"value":712},{"type":405,"tag":464,"props":887,"children":888},{"style":531},[889],{"type":411,"value":890}," [",{"type":405,"tag":464,"props":892,"children":893},{"style":483},[894],{"type":411,"value":698},{"type":405,"tag":464,"props":896,"children":898},{"class":466,"line":897},18,[899,904,908,913,918,922],{"type":405,"tag":464,"props":900,"children":901},{"style":531},[902],{"type":411,"value":903},"                type",{"type":405,"tag":464,"props":905,"children":906},{"style":483},[907],{"type":411,"value":712},{"type":405,"tag":464,"props":909,"children":910},{"style":536},[911],{"type":411,"value":912}," '",{"type":405,"tag":464,"props":914,"children":915},{"style":542},[916],{"type":411,"value":917},"A",{"type":405,"tag":464,"props":919,"children":920},{"style":536},[921],{"type":411,"value":539},{"type":405,"tag":464,"props":923,"children":924},{"style":483},[925],{"type":411,"value":750},{"type":405,"tag":464,"props":927,"children":929},{"class":466,"line":928},19,[930,935,939,943,947,951,956,960,965,970,975],{"type":405,"tag":464,"props":931,"children":932},{"style":531},[933],{"type":411,"value":934},"                name",{"type":405,"tag":464,"props":936,"children":937},{"style":483},[938],{"type":411,"value":712},{"type":405,"tag":464,"props":940,"children":941},{"style":531},[942],{"type":411,"value":717},{"type":405,"tag":464,"props":944,"children":945},{"style":514},[946],{"type":411,"value":492},{"type":405,"tag":464,"props":948,"children":949},{"style":483},[950],{"type":411,"value":726},{"type":405,"tag":464,"props":952,"children":953},{"style":514},[954],{"type":411,"value":955},"domainName",{"type":405,"tag":464,"props":957,"children":958},{"style":520},[959],{"type":411,"value":581},{"type":405,"tag":464,"props":961,"children":962},{"style":536},[963],{"type":411,"value":964}," \"",{"type":405,"tag":464,"props":966,"children":967},{"style":542},[968],{"type":411,"value":969},"google.com",{"type":405,"tag":464,"props":971,"children":972},{"style":536},[973],{"type":411,"value":974},"\"",{"type":405,"tag":464,"props":976,"children":977},{"style":531},[978],{"type":411,"value":794},{"type":405,"tag":464,"props":980,"children":982},{"class":466,"line":981},20,[983,988],{"type":405,"tag":464,"props":984,"children":985},{"style":483},[986],{"type":411,"value":987},"            }",{"type":405,"tag":464,"props":989,"children":990},{"style":531},[991],{"type":411,"value":992},"]\n",{"type":405,"tag":464,"props":994,"children":996},{"class":466,"line":995},21,[997,1002,1006,1010,1014,1019,1023,1028,1032,1036,1040,1044,1048,1053,1057,1061,1066,1070,1075],{"type":405,"tag":464,"props":998,"children":999},{"style":483},[1000],{"type":411,"value":1001},"        },",{"type":405,"tag":464,"props":1003,"children":1004},{"style":531},[1005],{"type":411,"value":717},{"type":405,"tag":464,"props":1007,"children":1008},{"style":514},[1009],{"type":411,"value":492},{"type":405,"tag":464,"props":1011,"children":1012},{"style":483},[1013],{"type":411,"value":726},{"type":405,"tag":464,"props":1015,"children":1016},{"style":514},[1017],{"type":411,"value":1018},"port",{"type":405,"tag":464,"props":1020,"children":1021},{"style":520},[1022],{"type":411,"value":581},{"type":405,"tag":464,"props":1024,"children":1025},{"style":738},[1026],{"type":411,"value":1027}," 53",{"type":405,"tag":464,"props":1029,"children":1030},{"style":531},[1031],{"type":411,"value":497},{"type":405,"tag":464,"props":1033,"children":1034},{"style":483},[1035],{"type":411,"value":638},{"type":405,"tag":464,"props":1037,"children":1038},{"style":531},[1039],{"type":411,"value":717},{"type":405,"tag":464,"props":1041,"children":1042},{"style":514},[1043],{"type":411,"value":492},{"type":405,"tag":464,"props":1045,"children":1046},{"style":483},[1047],{"type":411,"value":726},{"type":405,"tag":464,"props":1049,"children":1050},{"style":514},[1051],{"type":411,"value":1052},"host",{"type":405,"tag":464,"props":1054,"children":1055},{"style":520},[1056],{"type":411,"value":581},{"type":405,"tag":464,"props":1058,"children":1059},{"style":536},[1060],{"type":411,"value":912},{"type":405,"tag":464,"props":1062,"children":1063},{"style":542},[1064],{"type":411,"value":1065},"8.8.8.8",{"type":405,"tag":464,"props":1067,"children":1068},{"style":536},[1069],{"type":411,"value":539},{"type":405,"tag":464,"props":1071,"children":1072},{"style":531},[1073],{"type":411,"value":1074},"))",{"type":405,"tag":464,"props":1076,"children":1077},{"style":483},[1078],{"type":411,"value":558},{"type":405,"tag":464,"props":1080,"children":1082},{"class":466,"line":1081},22,[1083],{"type":405,"tag":464,"props":1084,"children":1085},{"emptyLinePlaceholder":397},[1086],{"type":411,"value":595},{"type":405,"tag":464,"props":1088,"children":1090},{"class":466,"line":1089},23,[1091],{"type":405,"tag":464,"props":1092,"children":1093},{"style":655},[1094],{"type":411,"value":1095},"        // DNS Address solved, internet available\n",{"type":405,"tag":464,"props":1097,"children":1099},{"class":466,"line":1098},24,[1100,1104,1108,1113,1117,1121,1126,1130,1134,1139,1144,1149],{"type":405,"tag":464,"props":1101,"children":1102},{"style":514},[1103],{"type":411,"value":855},{"type":405,"tag":464,"props":1105,"children":1106},{"style":483},[1107],{"type":411,"value":726},{"type":405,"tag":464,"props":1109,"children":1110},{"style":477},[1111],{"type":411,"value":1112},"on",{"type":405,"tag":464,"props":1114,"children":1115},{"style":531},[1116],{"type":411,"value":486},{"type":405,"tag":464,"props":1118,"children":1119},{"style":536},[1120],{"type":411,"value":539},{"type":405,"tag":464,"props":1122,"children":1123},{"style":542},[1124],{"type":411,"value":1125},"response",{"type":405,"tag":464,"props":1127,"children":1128},{"style":536},[1129],{"type":411,"value":539},{"type":405,"tag":464,"props":1131,"children":1132},{"style":483},[1133],{"type":411,"value":638},{"type":405,"tag":464,"props":1135,"children":1136},{"style":483},[1137],{"type":411,"value":1138}," ()",{"type":405,"tag":464,"props":1140,"children":1141},{"style":471},[1142],{"type":411,"value":1143}," =>",{"type":405,"tag":464,"props":1145,"children":1146},{"style":483},[1147],{"type":411,"value":1148}," {",{"type":405,"tag":464,"props":1150,"children":1151},{"style":531},[1152],{"type":411,"value":1153}," \n",{"type":405,"tag":464,"props":1155,"children":1157},{"class":466,"line":1156},25,[1158,1163,1167,1172,1176,1181,1185],{"type":405,"tag":464,"props":1159,"children":1160},{"style":514},[1161],{"type":411,"value":1162},"            socket",{"type":405,"tag":464,"props":1164,"children":1165},{"style":483},[1166],{"type":411,"value":726},{"type":405,"tag":464,"props":1168,"children":1169},{"style":477},[1170],{"type":411,"value":1171},"destroy",{"type":405,"tag":464,"props":1173,"children":1174},{"style":531},[1175],{"type":411,"value":486},{"type":405,"tag":464,"props":1177,"children":1178},{"style":483},[1179],{"type":411,"value":1180},"()",{"type":405,"tag":464,"props":1182,"children":1183},{"style":471},[1184],{"type":411,"value":1143},{"type":405,"tag":464,"props":1186,"children":1187},{"style":483},[1188],{"type":411,"value":502},{"type":405,"tag":464,"props":1190,"children":1192},{"class":466,"line":1191},26,[1193,1198,1202],{"type":405,"tag":464,"props":1194,"children":1195},{"style":477},[1196],{"type":411,"value":1197},"                resolve",{"type":405,"tag":464,"props":1199,"children":1200},{"style":531},[1201],{"type":411,"value":1180},{"type":405,"tag":464,"props":1203,"children":1204},{"style":483},[1205],{"type":411,"value":558},{"type":405,"tag":464,"props":1207,"children":1209},{"class":466,"line":1208},27,[1210,1214,1218],{"type":405,"tag":464,"props":1211,"children":1212},{"style":483},[1213],{"type":411,"value":987},{"type":405,"tag":464,"props":1215,"children":1216},{"style":531},[1217],{"type":411,"value":497},{"type":405,"tag":464,"props":1219,"children":1220},{"style":483},[1221],{"type":411,"value":558},{"type":405,"tag":464,"props":1223,"children":1225},{"class":466,"line":1224},28,[1226,1230,1234],{"type":405,"tag":464,"props":1227,"children":1228},{"style":483},[1229],{"type":411,"value":803},{"type":405,"tag":464,"props":1231,"children":1232},{"style":531},[1233],{"type":411,"value":497},{"type":405,"tag":464,"props":1235,"children":1236},{"style":483},[1237],{"type":411,"value":558},{"type":405,"tag":464,"props":1239,"children":1241},{"class":466,"line":1240},29,[1242],{"type":405,"tag":464,"props":1243,"children":1244},{"emptyLinePlaceholder":397},[1245],{"type":411,"value":595},{"type":405,"tag":464,"props":1247,"children":1249},{"class":466,"line":1248},30,[1250],{"type":405,"tag":464,"props":1251,"children":1252},{"style":655},[1253],{"type":411,"value":1254},"        // Verify for timeout of the request (cannot reach server)\n",{"type":405,"tag":464,"props":1256,"children":1258},{"class":466,"line":1257},31,[1259,1263,1267,1271,1275,1279,1283,1287,1291,1295,1299],{"type":405,"tag":464,"props":1260,"children":1261},{"style":514},[1262],{"type":411,"value":855},{"type":405,"tag":464,"props":1264,"children":1265},{"style":483},[1266],{"type":411,"value":726},{"type":405,"tag":464,"props":1268,"children":1269},{"style":477},[1270],{"type":411,"value":1112},{"type":405,"tag":464,"props":1272,"children":1273},{"style":531},[1274],{"type":411,"value":486},{"type":405,"tag":464,"props":1276,"children":1277},{"style":536},[1278],{"type":411,"value":539},{"type":405,"tag":464,"props":1280,"children":1281},{"style":542},[1282],{"type":411,"value":731},{"type":405,"tag":464,"props":1284,"children":1285},{"style":536},[1286],{"type":411,"value":539},{"type":405,"tag":464,"props":1288,"children":1289},{"style":483},[1290],{"type":411,"value":638},{"type":405,"tag":464,"props":1292,"children":1293},{"style":483},[1294],{"type":411,"value":1138},{"type":405,"tag":464,"props":1296,"children":1297},{"style":471},[1298],{"type":411,"value":1143},{"type":405,"tag":464,"props":1300,"children":1301},{"style":483},[1302],{"type":411,"value":502},{"type":405,"tag":464,"props":1304,"children":1306},{"class":466,"line":1305},32,[1307,1311,1315,1319,1323,1327,1331],{"type":405,"tag":464,"props":1308,"children":1309},{"style":514},[1310],{"type":411,"value":1162},{"type":405,"tag":464,"props":1312,"children":1313},{"style":483},[1314],{"type":411,"value":726},{"type":405,"tag":464,"props":1316,"children":1317},{"style":477},[1318],{"type":411,"value":1171},{"type":405,"tag":464,"props":1320,"children":1321},{"style":531},[1322],{"type":411,"value":486},{"type":405,"tag":464,"props":1324,"children":1325},{"style":483},[1326],{"type":411,"value":1180},{"type":405,"tag":464,"props":1328,"children":1329},{"style":471},[1330],{"type":411,"value":1143},{"type":405,"tag":464,"props":1332,"children":1333},{"style":483},[1334],{"type":411,"value":502},{"type":405,"tag":464,"props":1336,"children":1338},{"class":466,"line":1337},33,[1339,1344,1348],{"type":405,"tag":464,"props":1340,"children":1341},{"style":477},[1342],{"type":411,"value":1343},"                reject",{"type":405,"tag":464,"props":1345,"children":1346},{"style":531},[1347],{"type":411,"value":1180},{"type":405,"tag":464,"props":1349,"children":1350},{"style":483},[1351],{"type":411,"value":558},{"type":405,"tag":464,"props":1353,"children":1355},{"class":466,"line":1354},34,[1356,1360,1364],{"type":405,"tag":464,"props":1357,"children":1358},{"style":483},[1359],{"type":411,"value":987},{"type":405,"tag":464,"props":1361,"children":1362},{"style":531},[1363],{"type":411,"value":497},{"type":405,"tag":464,"props":1365,"children":1366},{"style":483},[1367],{"type":411,"value":558},{"type":405,"tag":464,"props":1369,"children":1371},{"class":466,"line":1370},35,[1372,1376,1380],{"type":405,"tag":464,"props":1373,"children":1374},{"style":483},[1375],{"type":411,"value":803},{"type":405,"tag":464,"props":1377,"children":1378},{"style":531},[1379],{"type":411,"value":497},{"type":405,"tag":464,"props":1381,"children":1382},{"style":483},[1383],{"type":411,"value":558},{"type":405,"tag":464,"props":1385,"children":1387},{"class":466,"line":1386},36,[1388,1393,1397],{"type":405,"tag":464,"props":1389,"children":1390},{"style":483},[1391],{"type":411,"value":1392},"    }",{"type":405,"tag":464,"props":1394,"children":1395},{"style":531},[1396],{"type":411,"value":497},{"type":405,"tag":464,"props":1398,"children":1399},{"style":483},[1400],{"type":411,"value":558},{"type":405,"tag":464,"props":1402,"children":1404},{"class":466,"line":1403},37,[1405],{"type":405,"tag":464,"props":1406,"children":1407},{"style":483},[1408],{"type":411,"value":1409},"}\n",{"type":405,"tag":413,"props":1411,"children":1412},{},[1413,1415,1421],{"type":411,"value":1414},"唯一的问题是，internet-available 引用的 ",{"type":405,"tag":433,"props":1416,"children":1419},{"href":1417,"rel":1418},"https://github.com/mafintosh/dns-socket/blob/master/index.js",[437],[1420],{"type":411,"value":545},{"type":411,"value":1422}," 这个库解决了什么问题。dns-socket 主页上说，它是一个带有超时和重试功能的接近底层的 DNS 请求库，那可以想象 NodeJS 的 DNS 模块应该就缺失了超时功能。关于 DNS 超时这个问题，AlienZHOU 大的博客有提到。可以从文末引用中查看更多详细信息。",{"type":405,"tag":413,"props":1424,"children":1425},{},[1426,1428,1435],{"type":411,"value":1427},"从源码来看，dns-socket 是一个使用 UDP 封装的 DNS 请求库，其中，DNS 报文的解析使用了同作者的 ",{"type":405,"tag":433,"props":1429,"children":1432},{"href":1430,"rel":1431},"https://github.com/mafintosh/dns-packet",[437],[1433],{"type":411,"value":1434},"dns-packet",{"type":411,"value":1436}," 这个库（这个作者还真是为了改善 NodeJS 的 DNS 尽心尽力哈...）。",{"type":405,"tag":418,"props":1438,"children":1440},{"id":1439},"阅读更多",[1441],{"type":411,"value":1439},{"type":405,"tag":1443,"props":1444,"children":1445},"ul",{},[1446],{"type":405,"tag":1447,"props":1448,"children":1449},"li",{},[1450],{"type":405,"tag":433,"props":1451,"children":1454},{"href":1452,"rel":1453},"https://www.jianshu.com/p/693a5d378a2c",[437],[1455],{"type":411,"value":1456},"AlienZHOU：NodeJS 中 DNS 查询的坑 & DNS cache 分析",{"type":405,"tag":1458,"props":1459,"children":1460},"style",{},[1461],{"type":411,"value":1462},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":398,"searchDepth":505,"depth":505,"links":1464},[1465,1469],{"id":420,"depth":505,"text":420,"children":1466},[1467,1468],{"id":426,"depth":561,"text":426},{"id":444,"depth":561,"text":444},{"id":1439,"depth":505,"text":1439},"markdown","content:8.source-code:_module:is-online.md","content","8.source-code/_module/is-online.md","8.source-code/_module/is-online","md",[1477,1480],{"_path":1478,"title":1479,"description":398},"/source-code/_module/html5shiv","🛠 低版本浏览器兼容HTML5标签原理",{"_path":1481,"title":1482,"description":1483},"/source-code/_node/node-watch","node-watch","node-watch 是在 fs.watch 的基础上封装而来的库，能监听文件变化",1741604971178]