[{"data":1,"prerenderedAt":1918},["ShallowReactive",2],{"navigation":3,"/source-code/_js/vue2-source/global-api":393,"/source-code/_js/vue2-source/global-api-surround":1911},[4,35,86,105,132,138,144,150,387],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":45,"_path":46},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":48,"_path":49},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":51,"_path":52},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":54,"_path":55},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":57,"_path":58},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":60,"_path":61},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":63,"_path":64},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":66,"_path":67},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":69,"_path":70},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":72,"_path":73},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":75,"_path":76},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":78,"_path":79},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":81,"_path":82},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":84,"_path":85},"📝 技术博客归档","/articles/archive",{"title":87,"_path":88,"children":89},"造物 / Make","/tools",[90,93,96,99,102],{"title":91,"_path":92},"🥥 Coconut","/tools/coconut",{"title":94,"_path":95},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":97,"_path":98},"🌐 AnySort","/tools/anysort",{"title":100,"_path":101},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":103,"_path":104},"👓 Crapto","/tools/crypto-inline",{"title":106,"_path":107,"children":108},"吉他剧场 / Music","/music",[109,111,114,117,120,123,126,129],{"title":110,"_path":107},"🎸 FingerStyle！",{"title":112,"_path":113},"🌬️ 等待的风","/music/wind",{"title":115,"_path":116},"💕 约定的海洋","/music/ocean",{"title":118,"_path":119},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":121,"_path":122},"🌏 残酷天使的行动纲领","/music/eva",{"title":124,"_path":125},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":127,"_path":128},"🍷 Wu Wei","/music/wu-wei",{"title":130,"_path":131},"🌅 无题","/music/untitled",{"title":133,"_path":134,"children":135},"画点什么 / Paint","/paint",[136],{"title":137,"_path":134},"🚧 正在施工",{"title":139,"_path":140,"children":141},"读书笔记 / Notes","/books",[142],{"title":143,"_path":140},"📕 读书笔记",{"title":145,"_path":146,"children":147},"知识地图 / Maps","/maps",[148],{"title":149,"_path":146},"🏁 知识地图",{"title":151,"_path":152,"children":153},"零散的笔记 / Gists","/gists",[154,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375,378,381,384],{"title":155,"_path":152},"🧊 Gists",{"title":157,"_path":158},"网站的可访问性","/gists/accessibility",{"title":160,"_path":161},"Bit","/gists/bit",{"title":163,"_path":164},"图片模糊","/gists/blur",{"title":166,"_path":167},"渲染相关笔记","/gists/c4d",{"title":169,"_path":170},"CDN 问题记录","/gists/cdn",{"title":172,"_path":173},"消毒剂","/gists/cleaner",{"title":175,"_path":176},"Windows Command","/gists/cmd",{"title":178,"_path":179},"Command","/gists/command",{"title":181,"_path":182},"复杂科学","/gists/complexity-science",{"title":184,"_path":185},"GitHub Copilot","/gists/copilot",{"title":187,"_path":188},"宇宙","/gists/cosmos",{"title":190,"_path":191},"C++","/gists/cpp",{"title":193,"_path":194},"DEPRESSION","/gists/depression",{"title":196,"_path":197},"Developer Experience","/gists/developer-experience",{"title":199,"_path":200},"Device Metrics","/gists/device-metrix",{"title":202,"_path":203},"数字化转型","/gists/digital-transformation",{"title":205,"_path":206},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":208,"_path":209},"正则表达式","/gists/eegex",{"title":211,"_path":212},"Emoji","/gists/emoji",{"title":214,"_path":215},"工程","/gists/engineering",{"title":217,"_path":218},"熵","/gists/entropy",{"title":220,"_path":221},"Environment","/gists/environment",{"title":223,"_path":224},"Erlang","/gists/erlang",{"title":226,"_path":227},"逃离塔克夫","/gists/escape-from-tarkov",{"title":229,"_path":230},"ESNext (ES6-ES11)","/gists/esnext",{"title":232,"_path":233},"Eval！","/gists/eval",{"title":235,"_path":236},"Flutter","/gists/flutter",{"title":238,"_path":239},"字体","/gists/font",{"title":241,"_path":242},"JS 函数式编程","/gists/functional",{"title":244,"_path":245},"游戏化","/gists/gamification",{"title":247,"_path":248},"Google C++ Standard","/gists/google-cpp-standard",{"title":250,"_path":251},"双向链接完全体","/gists/graph",{"title":253,"_path":254},"Hardwares","/gists/hardwares",{"title":256,"_path":257},"哈希冲突","/gists/hash-collision",{"title":259,"_path":260},"信息设计","/gists/information-design",{"title":262,"_path":263},"InstantPage","/gists/instant.page",{"title":265,"_path":266},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":268,"_path":269},"KVStore","/gists/key-value-db",{"title":271,"_path":272},"Kubernetes","/gists/kubernetes",{"title":274,"_path":275},"Makefile","/gists/makefile",{"title":277,"_path":278},"Markdown Inline Style","/gists/markdown-nice",{"title":280,"_path":281},"小程序","/gists/miniapp",{"title":283,"_path":284},"减小页面快照体积","/gists/minify-html",{"title":286,"_path":287},"mklink","/gists/mklink",{"title":289,"_path":290},"Mock","/gists/mock",{"title":292,"_path":293},"多人协作系统","/gists/multiplayer",{"title":295,"_path":296},"多端应用","/gists/multy-end-app",{"title":298,"_path":299},"神经科学","/gists/neuroscience",{"title":301,"_path":302},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":304,"_path":305},"PInvoke","/gists/pinvoke",{"title":307,"_path":308},"像素","/gists/pixel",{"title":310,"_path":311},"PowerShell","/gists/powershell",{"title":313,"_path":314},"量子","/gists/quantum",{"title":316,"_path":317},"保持好奇心","/gists/questions",{"title":319,"_path":320},"React Native","/gists/react-native",{"title":322,"_path":323},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":325,"_path":326},"SEO","/gists/seo",{"title":328,"_path":329},"Shader","/gists/shader",{"title":331,"_path":332},"Shape Up","/gists/shape-up",{"title":334,"_path":335},"睡觉","/gists/sleep",{"title":337,"_path":338},"记录奇怪的问题","/gists/solved",{"title":340,"_path":341},"States","/gists/states",{"title":343,"_path":344},"Storage","/gists/storage",{"title":346,"_path":347},"音视频流处理","/gists/stream-cli",{"title":349,"_path":350},"Symbol","/gists/symbol",{"title":352,"_path":353},"系统论","/gists/systems-theory",{"title":355,"_path":356},"Taro","/gists/taro",{"title":358,"_path":359},"任务切片","/gists/task-slice",{"title":361,"_path":362},"技术偏好","/gists/tech-dudge",{"title":364,"_path":365},"Untitled","/gists/untitled",{"title":367,"_path":368},"可变字体","/gists/variable-font",{"title":370,"_path":371},"视觉错觉","/gists/visual-illusion",{"title":373,"_path":374},"SS(SSR)","/gists/vpn",{"title":376,"_path":377},"VS Code 插件开发","/gists/vscode-plugin",{"title":379,"_path":380},"Web Components","/gists/web-components",{"title":382,"_path":383},"Windows","/gists/windows",{"title":385,"_path":386},"查缺补漏","/gists/wrong",{"title":388,"_path":389,"children":390},"我 / About","/hire",[391],{"title":392,"_path":389},"📬 技术简历",{"_path":394,"_dir":395,"_draft":396,"_partial":397,"_locale":398,"title":399,"description":400,"body":401,"_type":1905,"_id":1906,"_source":1907,"_file":1908,"_stem":1909,"_extension":1910},"/source-code/_js/vue2-source/global-api","vue2-source",false,true,"","Vue2 Global API","deprecated warning",{"type":402,"children":403,"toc":1901},"root",[404,413,419,424,802,807,1816,1821,1826,1873,1878,1895],{"type":405,"tag":406,"props":407,"children":409},"element","h2",{"id":408},"nexttick",[410],{"type":411,"value":412},"text","$nextTick",{"type":405,"tag":414,"props":415,"children":416},"p",{},[417],{"type":411,"value":418},"阅读这个 API 首先要先熟悉浏览器的任务循环机制。",{"type":405,"tag":414,"props":420,"children":421},{},[422],{"type":411,"value":423},"Vue.$nextTick 是在实例渲染时被挂载的辅助函数。",{"type":405,"tag":425,"props":426,"children":430},"pre",{"className":427,"code":428,"language":429,"meta":398,"style":398},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","// /src/core/instance/render\nexport function renderMixin(Vue) {\n  Vue.prototype.$nextTick = function (fn) {\n    // 绑定上下文为 Vue 实例\n    return nextTick(fn, this);\n  };\n}\n\n// 使用的时候，只需要传入回调即可\nnew Vue({\n  mounted() {\n    this.$nextTick(() => {\n      console.log(\"callback executed\");\n    });\n  },\n});\n","js",[431],{"type":405,"tag":432,"props":433,"children":434},"code",{"__ignoreMap":398},[435,447,491,548,557,601,610,619,628,637,660,679,713,759,776,785],{"type":405,"tag":436,"props":437,"children":440},"span",{"class":438,"line":439},"line",1,[441],{"type":405,"tag":436,"props":442,"children":444},{"style":443},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[445],{"type":411,"value":446},"// /src/core/instance/render\n",{"type":405,"tag":436,"props":448,"children":450},{"class":438,"line":449},2,[451,457,463,469,475,481,486],{"type":405,"tag":436,"props":452,"children":454},{"style":453},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[455],{"type":411,"value":456},"export",{"type":405,"tag":436,"props":458,"children":460},{"style":459},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[461],{"type":411,"value":462}," function",{"type":405,"tag":436,"props":464,"children":466},{"style":465},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[467],{"type":411,"value":468}," renderMixin",{"type":405,"tag":436,"props":470,"children":472},{"style":471},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[473],{"type":411,"value":474},"(",{"type":405,"tag":436,"props":476,"children":478},{"style":477},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[479],{"type":411,"value":480},"Vue",{"type":405,"tag":436,"props":482,"children":483},{"style":471},[484],{"type":411,"value":485},")",{"type":405,"tag":436,"props":487,"children":488},{"style":471},[489],{"type":411,"value":490}," {\n",{"type":405,"tag":436,"props":492,"children":494},{"class":438,"line":493},3,[495,501,506,512,516,520,526,530,535,540,544],{"type":405,"tag":436,"props":496,"children":498},{"style":497},"--shiki-light:#E2931D;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[499],{"type":411,"value":500},"  Vue",{"type":405,"tag":436,"props":502,"children":503},{"style":471},[504],{"type":411,"value":505},".",{"type":405,"tag":436,"props":507,"children":509},{"style":508},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[510],{"type":411,"value":511},"prototype",{"type":405,"tag":436,"props":513,"children":514},{"style":471},[515],{"type":411,"value":505},{"type":405,"tag":436,"props":517,"children":518},{"style":465},[519],{"type":411,"value":412},{"type":405,"tag":436,"props":521,"children":523},{"style":522},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[524],{"type":411,"value":525}," =",{"type":405,"tag":436,"props":527,"children":528},{"style":459},[529],{"type":411,"value":462},{"type":405,"tag":436,"props":531,"children":532},{"style":471},[533],{"type":411,"value":534}," (",{"type":405,"tag":436,"props":536,"children":537},{"style":477},[538],{"type":411,"value":539},"fn",{"type":405,"tag":436,"props":541,"children":542},{"style":471},[543],{"type":411,"value":485},{"type":405,"tag":436,"props":545,"children":546},{"style":471},[547],{"type":411,"value":490},{"type":405,"tag":436,"props":549,"children":551},{"class":438,"line":550},4,[552],{"type":405,"tag":436,"props":553,"children":554},{"style":443},[555],{"type":411,"value":556},"    // 绑定上下文为 Vue 实例\n",{"type":405,"tag":436,"props":558,"children":560},{"class":438,"line":559},5,[561,566,571,576,581,586,592,596],{"type":405,"tag":436,"props":562,"children":563},{"style":453},[564],{"type":411,"value":565},"    return",{"type":405,"tag":436,"props":567,"children":568},{"style":465},[569],{"type":411,"value":570}," nextTick",{"type":405,"tag":436,"props":572,"children":574},{"style":573},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[575],{"type":411,"value":474},{"type":405,"tag":436,"props":577,"children":579},{"style":578},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[580],{"type":411,"value":539},{"type":405,"tag":436,"props":582,"children":583},{"style":471},[584],{"type":411,"value":585},",",{"type":405,"tag":436,"props":587,"children":589},{"style":588},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[590],{"type":411,"value":591}," this",{"type":405,"tag":436,"props":593,"children":594},{"style":573},[595],{"type":411,"value":485},{"type":405,"tag":436,"props":597,"children":598},{"style":471},[599],{"type":411,"value":600},";\n",{"type":405,"tag":436,"props":602,"children":604},{"class":438,"line":603},6,[605],{"type":405,"tag":436,"props":606,"children":607},{"style":471},[608],{"type":411,"value":609},"  };\n",{"type":405,"tag":436,"props":611,"children":613},{"class":438,"line":612},7,[614],{"type":405,"tag":436,"props":615,"children":616},{"style":471},[617],{"type":411,"value":618},"}\n",{"type":405,"tag":436,"props":620,"children":622},{"class":438,"line":621},8,[623],{"type":405,"tag":436,"props":624,"children":625},{"emptyLinePlaceholder":397},[626],{"type":411,"value":627},"\n",{"type":405,"tag":436,"props":629,"children":631},{"class":438,"line":630},9,[632],{"type":405,"tag":436,"props":633,"children":634},{"style":443},[635],{"type":411,"value":636},"// 使用的时候，只需要传入回调即可\n",{"type":405,"tag":436,"props":638,"children":640},{"class":438,"line":639},10,[641,646,651,655],{"type":405,"tag":436,"props":642,"children":643},{"style":522},[644],{"type":411,"value":645},"new",{"type":405,"tag":436,"props":647,"children":648},{"style":465},[649],{"type":411,"value":650}," Vue",{"type":405,"tag":436,"props":652,"children":653},{"style":578},[654],{"type":411,"value":474},{"type":405,"tag":436,"props":656,"children":657},{"style":471},[658],{"type":411,"value":659},"{\n",{"type":405,"tag":436,"props":661,"children":663},{"class":438,"line":662},11,[664,670,675],{"type":405,"tag":436,"props":665,"children":667},{"style":666},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[668],{"type":411,"value":669},"  mounted",{"type":405,"tag":436,"props":671,"children":672},{"style":471},[673],{"type":411,"value":674},"()",{"type":405,"tag":436,"props":676,"children":677},{"style":471},[678],{"type":411,"value":490},{"type":405,"tag":436,"props":680,"children":682},{"class":438,"line":681},12,[683,688,692,696,700,704,709],{"type":405,"tag":436,"props":684,"children":685},{"style":588},[686],{"type":411,"value":687},"    this",{"type":405,"tag":436,"props":689,"children":690},{"style":471},[691],{"type":411,"value":505},{"type":405,"tag":436,"props":693,"children":694},{"style":465},[695],{"type":411,"value":412},{"type":405,"tag":436,"props":697,"children":698},{"style":573},[699],{"type":411,"value":474},{"type":405,"tag":436,"props":701,"children":702},{"style":471},[703],{"type":411,"value":674},{"type":405,"tag":436,"props":705,"children":706},{"style":459},[707],{"type":411,"value":708}," =>",{"type":405,"tag":436,"props":710,"children":711},{"style":471},[712],{"type":411,"value":490},{"type":405,"tag":436,"props":714,"children":716},{"class":438,"line":715},13,[717,722,726,731,735,741,747,751,755],{"type":405,"tag":436,"props":718,"children":719},{"style":578},[720],{"type":411,"value":721},"      console",{"type":405,"tag":436,"props":723,"children":724},{"style":471},[725],{"type":411,"value":505},{"type":405,"tag":436,"props":727,"children":728},{"style":465},[729],{"type":411,"value":730},"log",{"type":405,"tag":436,"props":732,"children":733},{"style":573},[734],{"type":411,"value":474},{"type":405,"tag":436,"props":736,"children":738},{"style":737},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[739],{"type":411,"value":740},"\"",{"type":405,"tag":436,"props":742,"children":744},{"style":743},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[745],{"type":411,"value":746},"callback executed",{"type":405,"tag":436,"props":748,"children":749},{"style":737},[750],{"type":411,"value":740},{"type":405,"tag":436,"props":752,"children":753},{"style":573},[754],{"type":411,"value":485},{"type":405,"tag":436,"props":756,"children":757},{"style":471},[758],{"type":411,"value":600},{"type":405,"tag":436,"props":760,"children":762},{"class":438,"line":761},14,[763,768,772],{"type":405,"tag":436,"props":764,"children":765},{"style":471},[766],{"type":411,"value":767},"    }",{"type":405,"tag":436,"props":769,"children":770},{"style":573},[771],{"type":411,"value":485},{"type":405,"tag":436,"props":773,"children":774},{"style":471},[775],{"type":411,"value":600},{"type":405,"tag":436,"props":777,"children":779},{"class":438,"line":778},15,[780],{"type":405,"tag":436,"props":781,"children":782},{"style":471},[783],{"type":411,"value":784},"  },\n",{"type":405,"tag":436,"props":786,"children":788},{"class":438,"line":787},16,[789,794,798],{"type":405,"tag":436,"props":790,"children":791},{"style":471},[792],{"type":411,"value":793},"}",{"type":405,"tag":436,"props":795,"children":796},{"style":578},[797],{"type":411,"value":485},{"type":405,"tag":436,"props":799,"children":800},{"style":471},[801],{"type":411,"value":600},{"type":405,"tag":414,"props":803,"children":804},{},[805],{"type":411,"value":806},"$nextTick 的本质是，把传入的回调推到当前微任务队列中（queueMicroTask），使其在当前任务队列 DOM 渲染（宏任务）完毕之后执行。它使用一些 HACK 技巧来模拟 queueMicroTask API。",{"type":405,"tag":425,"props":808,"children":810},{"className":427,"code":809,"language":429,"meta":398,"style":398},"// 执行所有回调\nfunction flushCallbacks() {\n  /* ... */\n}\n// timerFunc 用来存储 hackedQueueMicroTask API\nlet timerFunc;\n// 如果运行环境支持 Promise，则使用 Promise.then\nif (typeof Promise !== \"undefined\" && isNative(Promise)) {\n  const p = Promise.resolve();\n  timerFunc = () => {\n    p.then(flushCallbacks);\n  };\n}\n// 否则回退到 MutationObserver API（它的回调也会添加到当前微任务队列）\nelse if (\n  !isIE &&\n  typeof MutationObserver !== \"undefined\" &&\n  (isNative(MutationObserver) ||\n    MutationObserver.toString() === \"[object MutationObserverConstructor]\")\n) {\n  let counter = 1;\n  const observer = new MutationObserver(flushCallbacks);\n  const textNode = document.createTextNode(String(counter));\n  observer.observe(textNode, {\n    characterData: true,\n  });\n  timerFunc = () => {\n    counter = (counter + 1) % 2;\n    textNode.data = String(counter);\n  };\n}\n// 否则回退到 setImmediate（其回调被添加到当前宏任务队列）\nelse if (typeof setImmediate !== \"undefined\" && isNative(setImmediate)) {\n  // Technically it leverages the (macro) task queue,\n  // but it is still a better choice than setTimeout.\n  timerFunc = () => {\n    setImmediate(flushCallbacks);\n  };\n}\n// 最次的情况则选择 setTimeout\nelse {\n  timerFunc = () => {\n    setTimeout(flushCallbacks, 0);\n  };\n}\n",[811],{"type":405,"tag":432,"props":812,"children":813},{"__ignoreMap":398},[814,822,843,851,858,866,883,891,960,998,1023,1057,1064,1071,1079,1097,1115,1151,1175,1221,1234,1262,1305,1363,1398,1423,1440,1464,1512,1555,1563,1571,1580,1638,1647,1656,1680,1705,1713,1721,1730,1742,1766,1800,1808],{"type":405,"tag":436,"props":815,"children":816},{"class":438,"line":439},[817],{"type":405,"tag":436,"props":818,"children":819},{"style":443},[820],{"type":411,"value":821},"// 执行所有回调\n",{"type":405,"tag":436,"props":823,"children":824},{"class":438,"line":449},[825,830,835,839],{"type":405,"tag":436,"props":826,"children":827},{"style":459},[828],{"type":411,"value":829},"function",{"type":405,"tag":436,"props":831,"children":832},{"style":465},[833],{"type":411,"value":834}," flushCallbacks",{"type":405,"tag":436,"props":836,"children":837},{"style":471},[838],{"type":411,"value":674},{"type":405,"tag":436,"props":840,"children":841},{"style":471},[842],{"type":411,"value":490},{"type":405,"tag":436,"props":844,"children":845},{"class":438,"line":493},[846],{"type":405,"tag":436,"props":847,"children":848},{"style":443},[849],{"type":411,"value":850},"  /* ... */\n",{"type":405,"tag":436,"props":852,"children":853},{"class":438,"line":550},[854],{"type":405,"tag":436,"props":855,"children":856},{"style":471},[857],{"type":411,"value":618},{"type":405,"tag":436,"props":859,"children":860},{"class":438,"line":559},[861],{"type":405,"tag":436,"props":862,"children":863},{"style":443},[864],{"type":411,"value":865},"// timerFunc 用来存储 hackedQueueMicroTask API\n",{"type":405,"tag":436,"props":867,"children":868},{"class":438,"line":603},[869,874,879],{"type":405,"tag":436,"props":870,"children":871},{"style":459},[872],{"type":411,"value":873},"let",{"type":405,"tag":436,"props":875,"children":876},{"style":578},[877],{"type":411,"value":878}," timerFunc",{"type":405,"tag":436,"props":880,"children":881},{"style":471},[882],{"type":411,"value":600},{"type":405,"tag":436,"props":884,"children":885},{"class":438,"line":612},[886],{"type":405,"tag":436,"props":887,"children":888},{"style":443},[889],{"type":411,"value":890},"// 如果运行环境支持 Promise，则使用 Promise.then\n",{"type":405,"tag":436,"props":892,"children":893},{"class":438,"line":621},[894,899,903,908,913,918,923,928,932,937,942,946,951,956],{"type":405,"tag":436,"props":895,"children":896},{"style":453},[897],{"type":411,"value":898},"if",{"type":405,"tag":436,"props":900,"children":901},{"style":578},[902],{"type":411,"value":534},{"type":405,"tag":436,"props":904,"children":905},{"style":522},[906],{"type":411,"value":907},"typeof",{"type":405,"tag":436,"props":909,"children":910},{"style":497},[911],{"type":411,"value":912}," Promise",{"type":405,"tag":436,"props":914,"children":915},{"style":522},[916],{"type":411,"value":917}," !==",{"type":405,"tag":436,"props":919,"children":920},{"style":737},[921],{"type":411,"value":922}," \"",{"type":405,"tag":436,"props":924,"children":925},{"style":743},[926],{"type":411,"value":927},"undefined",{"type":405,"tag":436,"props":929,"children":930},{"style":737},[931],{"type":411,"value":740},{"type":405,"tag":436,"props":933,"children":934},{"style":522},[935],{"type":411,"value":936}," &&",{"type":405,"tag":436,"props":938,"children":939},{"style":465},[940],{"type":411,"value":941}," isNative",{"type":405,"tag":436,"props":943,"children":944},{"style":578},[945],{"type":411,"value":474},{"type":405,"tag":436,"props":947,"children":948},{"style":497},[949],{"type":411,"value":950},"Promise",{"type":405,"tag":436,"props":952,"children":953},{"style":578},[954],{"type":411,"value":955},")) ",{"type":405,"tag":436,"props":957,"children":958},{"style":471},[959],{"type":411,"value":659},{"type":405,"tag":436,"props":961,"children":962},{"class":438,"line":630},[963,968,973,977,981,985,990,994],{"type":405,"tag":436,"props":964,"children":965},{"style":459},[966],{"type":411,"value":967},"  const",{"type":405,"tag":436,"props":969,"children":970},{"style":508},[971],{"type":411,"value":972}," p",{"type":405,"tag":436,"props":974,"children":975},{"style":522},[976],{"type":411,"value":525},{"type":405,"tag":436,"props":978,"children":979},{"style":497},[980],{"type":411,"value":912},{"type":405,"tag":436,"props":982,"children":983},{"style":471},[984],{"type":411,"value":505},{"type":405,"tag":436,"props":986,"children":987},{"style":465},[988],{"type":411,"value":989},"resolve",{"type":405,"tag":436,"props":991,"children":992},{"style":573},[993],{"type":411,"value":674},{"type":405,"tag":436,"props":995,"children":996},{"style":471},[997],{"type":411,"value":600},{"type":405,"tag":436,"props":999,"children":1000},{"class":438,"line":639},[1001,1006,1010,1015,1019],{"type":405,"tag":436,"props":1002,"children":1003},{"style":465},[1004],{"type":411,"value":1005},"  timerFunc",{"type":405,"tag":436,"props":1007,"children":1008},{"style":522},[1009],{"type":411,"value":525},{"type":405,"tag":436,"props":1011,"children":1012},{"style":471},[1013],{"type":411,"value":1014}," ()",{"type":405,"tag":436,"props":1016,"children":1017},{"style":459},[1018],{"type":411,"value":708},{"type":405,"tag":436,"props":1020,"children":1021},{"style":471},[1022],{"type":411,"value":490},{"type":405,"tag":436,"props":1024,"children":1025},{"class":438,"line":662},[1026,1031,1035,1040,1044,1049,1053],{"type":405,"tag":436,"props":1027,"children":1028},{"style":578},[1029],{"type":411,"value":1030},"    p",{"type":405,"tag":436,"props":1032,"children":1033},{"style":471},[1034],{"type":411,"value":505},{"type":405,"tag":436,"props":1036,"children":1037},{"style":465},[1038],{"type":411,"value":1039},"then",{"type":405,"tag":436,"props":1041,"children":1042},{"style":573},[1043],{"type":411,"value":474},{"type":405,"tag":436,"props":1045,"children":1046},{"style":578},[1047],{"type":411,"value":1048},"flushCallbacks",{"type":405,"tag":436,"props":1050,"children":1051},{"style":573},[1052],{"type":411,"value":485},{"type":405,"tag":436,"props":1054,"children":1055},{"style":471},[1056],{"type":411,"value":600},{"type":405,"tag":436,"props":1058,"children":1059},{"class":438,"line":681},[1060],{"type":405,"tag":436,"props":1061,"children":1062},{"style":471},[1063],{"type":411,"value":609},{"type":405,"tag":436,"props":1065,"children":1066},{"class":438,"line":715},[1067],{"type":405,"tag":436,"props":1068,"children":1069},{"style":471},[1070],{"type":411,"value":618},{"type":405,"tag":436,"props":1072,"children":1073},{"class":438,"line":761},[1074],{"type":405,"tag":436,"props":1075,"children":1076},{"style":443},[1077],{"type":411,"value":1078},"// 否则回退到 MutationObserver API（它的回调也会添加到当前微任务队列）\n",{"type":405,"tag":436,"props":1080,"children":1081},{"class":438,"line":778},[1082,1087,1092],{"type":405,"tag":436,"props":1083,"children":1084},{"style":453},[1085],{"type":411,"value":1086},"else",{"type":405,"tag":436,"props":1088,"children":1089},{"style":453},[1090],{"type":411,"value":1091}," if",{"type":405,"tag":436,"props":1093,"children":1094},{"style":578},[1095],{"type":411,"value":1096}," (\n",{"type":405,"tag":436,"props":1098,"children":1099},{"class":438,"line":787},[1100,1105,1110],{"type":405,"tag":436,"props":1101,"children":1102},{"style":522},[1103],{"type":411,"value":1104},"  !",{"type":405,"tag":436,"props":1106,"children":1107},{"style":578},[1108],{"type":411,"value":1109},"isIE ",{"type":405,"tag":436,"props":1111,"children":1112},{"style":522},[1113],{"type":411,"value":1114},"&&\n",{"type":405,"tag":436,"props":1116,"children":1118},{"class":438,"line":1117},17,[1119,1124,1129,1134,1138,1142,1146],{"type":405,"tag":436,"props":1120,"children":1121},{"style":522},[1122],{"type":411,"value":1123},"  typeof",{"type":405,"tag":436,"props":1125,"children":1126},{"style":578},[1127],{"type":411,"value":1128}," MutationObserver ",{"type":405,"tag":436,"props":1130,"children":1131},{"style":522},[1132],{"type":411,"value":1133},"!==",{"type":405,"tag":436,"props":1135,"children":1136},{"style":737},[1137],{"type":411,"value":922},{"type":405,"tag":436,"props":1139,"children":1140},{"style":743},[1141],{"type":411,"value":927},{"type":405,"tag":436,"props":1143,"children":1144},{"style":737},[1145],{"type":411,"value":740},{"type":405,"tag":436,"props":1147,"children":1148},{"style":522},[1149],{"type":411,"value":1150}," &&\n",{"type":405,"tag":436,"props":1152,"children":1154},{"class":438,"line":1153},18,[1155,1160,1165,1170],{"type":405,"tag":436,"props":1156,"children":1157},{"style":578},[1158],{"type":411,"value":1159},"  (",{"type":405,"tag":436,"props":1161,"children":1162},{"style":465},[1163],{"type":411,"value":1164},"isNative",{"type":405,"tag":436,"props":1166,"children":1167},{"style":578},[1168],{"type":411,"value":1169},"(MutationObserver) ",{"type":405,"tag":436,"props":1171,"children":1172},{"style":522},[1173],{"type":411,"value":1174},"||\n",{"type":405,"tag":436,"props":1176,"children":1178},{"class":438,"line":1177},19,[1179,1184,1188,1193,1198,1203,1207,1212,1216],{"type":405,"tag":436,"props":1180,"children":1181},{"style":578},[1182],{"type":411,"value":1183},"    MutationObserver",{"type":405,"tag":436,"props":1185,"children":1186},{"style":471},[1187],{"type":411,"value":505},{"type":405,"tag":436,"props":1189,"children":1190},{"style":465},[1191],{"type":411,"value":1192},"toString",{"type":405,"tag":436,"props":1194,"children":1195},{"style":578},[1196],{"type":411,"value":1197},"() ",{"type":405,"tag":436,"props":1199,"children":1200},{"style":522},[1201],{"type":411,"value":1202},"===",{"type":405,"tag":436,"props":1204,"children":1205},{"style":737},[1206],{"type":411,"value":922},{"type":405,"tag":436,"props":1208,"children":1209},{"style":743},[1210],{"type":411,"value":1211},"[object MutationObserverConstructor]",{"type":405,"tag":436,"props":1213,"children":1214},{"style":737},[1215],{"type":411,"value":740},{"type":405,"tag":436,"props":1217,"children":1218},{"style":578},[1219],{"type":411,"value":1220},")\n",{"type":405,"tag":436,"props":1222,"children":1224},{"class":438,"line":1223},20,[1225,1230],{"type":405,"tag":436,"props":1226,"children":1227},{"style":578},[1228],{"type":411,"value":1229},") ",{"type":405,"tag":436,"props":1231,"children":1232},{"style":471},[1233],{"type":411,"value":659},{"type":405,"tag":436,"props":1235,"children":1237},{"class":438,"line":1236},21,[1238,1243,1248,1252,1258],{"type":405,"tag":436,"props":1239,"children":1240},{"style":459},[1241],{"type":411,"value":1242},"  let",{"type":405,"tag":436,"props":1244,"children":1245},{"style":578},[1246],{"type":411,"value":1247}," counter",{"type":405,"tag":436,"props":1249,"children":1250},{"style":522},[1251],{"type":411,"value":525},{"type":405,"tag":436,"props":1253,"children":1255},{"style":1254},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1256],{"type":411,"value":1257}," 1",{"type":405,"tag":436,"props":1259,"children":1260},{"style":471},[1261],{"type":411,"value":600},{"type":405,"tag":436,"props":1263,"children":1265},{"class":438,"line":1264},22,[1266,1270,1275,1279,1284,1289,1293,1297,1301],{"type":405,"tag":436,"props":1267,"children":1268},{"style":459},[1269],{"type":411,"value":967},{"type":405,"tag":436,"props":1271,"children":1272},{"style":508},[1273],{"type":411,"value":1274}," observer",{"type":405,"tag":436,"props":1276,"children":1277},{"style":522},[1278],{"type":411,"value":525},{"type":405,"tag":436,"props":1280,"children":1281},{"style":522},[1282],{"type":411,"value":1283}," new",{"type":405,"tag":436,"props":1285,"children":1286},{"style":465},[1287],{"type":411,"value":1288}," MutationObserver",{"type":405,"tag":436,"props":1290,"children":1291},{"style":573},[1292],{"type":411,"value":474},{"type":405,"tag":436,"props":1294,"children":1295},{"style":578},[1296],{"type":411,"value":1048},{"type":405,"tag":436,"props":1298,"children":1299},{"style":573},[1300],{"type":411,"value":485},{"type":405,"tag":436,"props":1302,"children":1303},{"style":471},[1304],{"type":411,"value":600},{"type":405,"tag":436,"props":1306,"children":1308},{"class":438,"line":1307},23,[1309,1313,1318,1322,1327,1331,1336,1340,1345,1349,1354,1359],{"type":405,"tag":436,"props":1310,"children":1311},{"style":459},[1312],{"type":411,"value":967},{"type":405,"tag":436,"props":1314,"children":1315},{"style":508},[1316],{"type":411,"value":1317}," textNode",{"type":405,"tag":436,"props":1319,"children":1320},{"style":522},[1321],{"type":411,"value":525},{"type":405,"tag":436,"props":1323,"children":1324},{"style":578},[1325],{"type":411,"value":1326}," document",{"type":405,"tag":436,"props":1328,"children":1329},{"style":471},[1330],{"type":411,"value":505},{"type":405,"tag":436,"props":1332,"children":1333},{"style":465},[1334],{"type":411,"value":1335},"createTextNode",{"type":405,"tag":436,"props":1337,"children":1338},{"style":573},[1339],{"type":411,"value":474},{"type":405,"tag":436,"props":1341,"children":1342},{"style":465},[1343],{"type":411,"value":1344},"String",{"type":405,"tag":436,"props":1346,"children":1347},{"style":573},[1348],{"type":411,"value":474},{"type":405,"tag":436,"props":1350,"children":1351},{"style":578},[1352],{"type":411,"value":1353},"counter",{"type":405,"tag":436,"props":1355,"children":1356},{"style":573},[1357],{"type":411,"value":1358},"))",{"type":405,"tag":436,"props":1360,"children":1361},{"style":471},[1362],{"type":411,"value":600},{"type":405,"tag":436,"props":1364,"children":1366},{"class":438,"line":1365},24,[1367,1372,1376,1381,1385,1390,1394],{"type":405,"tag":436,"props":1368,"children":1369},{"style":578},[1370],{"type":411,"value":1371},"  observer",{"type":405,"tag":436,"props":1373,"children":1374},{"style":471},[1375],{"type":411,"value":505},{"type":405,"tag":436,"props":1377,"children":1378},{"style":465},[1379],{"type":411,"value":1380},"observe",{"type":405,"tag":436,"props":1382,"children":1383},{"style":573},[1384],{"type":411,"value":474},{"type":405,"tag":436,"props":1386,"children":1387},{"style":578},[1388],{"type":411,"value":1389},"textNode",{"type":405,"tag":436,"props":1391,"children":1392},{"style":471},[1393],{"type":411,"value":585},{"type":405,"tag":436,"props":1395,"children":1396},{"style":471},[1397],{"type":411,"value":490},{"type":405,"tag":436,"props":1399,"children":1401},{"class":438,"line":1400},25,[1402,1407,1412,1418],{"type":405,"tag":436,"props":1403,"children":1404},{"style":573},[1405],{"type":411,"value":1406},"    characterData",{"type":405,"tag":436,"props":1408,"children":1409},{"style":471},[1410],{"type":411,"value":1411},":",{"type":405,"tag":436,"props":1413,"children":1415},{"style":1414},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1416],{"type":411,"value":1417}," true",{"type":405,"tag":436,"props":1419,"children":1420},{"style":471},[1421],{"type":411,"value":1422},",\n",{"type":405,"tag":436,"props":1424,"children":1426},{"class":438,"line":1425},26,[1427,1432,1436],{"type":405,"tag":436,"props":1428,"children":1429},{"style":471},[1430],{"type":411,"value":1431},"  }",{"type":405,"tag":436,"props":1433,"children":1434},{"style":573},[1435],{"type":411,"value":485},{"type":405,"tag":436,"props":1437,"children":1438},{"style":471},[1439],{"type":411,"value":600},{"type":405,"tag":436,"props":1441,"children":1443},{"class":438,"line":1442},27,[1444,1448,1452,1456,1460],{"type":405,"tag":436,"props":1445,"children":1446},{"style":465},[1447],{"type":411,"value":1005},{"type":405,"tag":436,"props":1449,"children":1450},{"style":522},[1451],{"type":411,"value":525},{"type":405,"tag":436,"props":1453,"children":1454},{"style":471},[1455],{"type":411,"value":1014},{"type":405,"tag":436,"props":1457,"children":1458},{"style":459},[1459],{"type":411,"value":708},{"type":405,"tag":436,"props":1461,"children":1462},{"style":471},[1463],{"type":411,"value":490},{"type":405,"tag":436,"props":1465,"children":1467},{"class":438,"line":1466},28,[1468,1473,1477,1481,1485,1490,1494,1498,1503,1508],{"type":405,"tag":436,"props":1469,"children":1470},{"style":578},[1471],{"type":411,"value":1472},"    counter",{"type":405,"tag":436,"props":1474,"children":1475},{"style":522},[1476],{"type":411,"value":525},{"type":405,"tag":436,"props":1478,"children":1479},{"style":573},[1480],{"type":411,"value":534},{"type":405,"tag":436,"props":1482,"children":1483},{"style":578},[1484],{"type":411,"value":1353},{"type":405,"tag":436,"props":1486,"children":1487},{"style":522},[1488],{"type":411,"value":1489}," +",{"type":405,"tag":436,"props":1491,"children":1492},{"style":1254},[1493],{"type":411,"value":1257},{"type":405,"tag":436,"props":1495,"children":1496},{"style":573},[1497],{"type":411,"value":1229},{"type":405,"tag":436,"props":1499,"children":1500},{"style":522},[1501],{"type":411,"value":1502},"%",{"type":405,"tag":436,"props":1504,"children":1505},{"style":1254},[1506],{"type":411,"value":1507}," 2",{"type":405,"tag":436,"props":1509,"children":1510},{"style":471},[1511],{"type":411,"value":600},{"type":405,"tag":436,"props":1513,"children":1515},{"class":438,"line":1514},29,[1516,1521,1525,1530,1534,1539,1543,1547,1551],{"type":405,"tag":436,"props":1517,"children":1518},{"style":578},[1519],{"type":411,"value":1520},"    textNode",{"type":405,"tag":436,"props":1522,"children":1523},{"style":471},[1524],{"type":411,"value":505},{"type":405,"tag":436,"props":1526,"children":1527},{"style":578},[1528],{"type":411,"value":1529},"data",{"type":405,"tag":436,"props":1531,"children":1532},{"style":522},[1533],{"type":411,"value":525},{"type":405,"tag":436,"props":1535,"children":1536},{"style":465},[1537],{"type":411,"value":1538}," String",{"type":405,"tag":436,"props":1540,"children":1541},{"style":573},[1542],{"type":411,"value":474},{"type":405,"tag":436,"props":1544,"children":1545},{"style":578},[1546],{"type":411,"value":1353},{"type":405,"tag":436,"props":1548,"children":1549},{"style":573},[1550],{"type":411,"value":485},{"type":405,"tag":436,"props":1552,"children":1553},{"style":471},[1554],{"type":411,"value":600},{"type":405,"tag":436,"props":1556,"children":1558},{"class":438,"line":1557},30,[1559],{"type":405,"tag":436,"props":1560,"children":1561},{"style":471},[1562],{"type":411,"value":609},{"type":405,"tag":436,"props":1564,"children":1566},{"class":438,"line":1565},31,[1567],{"type":405,"tag":436,"props":1568,"children":1569},{"style":471},[1570],{"type":411,"value":618},{"type":405,"tag":436,"props":1572,"children":1574},{"class":438,"line":1573},32,[1575],{"type":405,"tag":436,"props":1576,"children":1577},{"style":443},[1578],{"type":411,"value":1579},"// 否则回退到 setImmediate（其回调被添加到当前宏任务队列）\n",{"type":405,"tag":436,"props":1581,"children":1583},{"class":438,"line":1582},33,[1584,1588,1592,1596,1600,1605,1609,1613,1617,1621,1625,1629,1634],{"type":405,"tag":436,"props":1585,"children":1586},{"style":453},[1587],{"type":411,"value":1086},{"type":405,"tag":436,"props":1589,"children":1590},{"style":453},[1591],{"type":411,"value":1091},{"type":405,"tag":436,"props":1593,"children":1594},{"style":578},[1595],{"type":411,"value":534},{"type":405,"tag":436,"props":1597,"children":1598},{"style":522},[1599],{"type":411,"value":907},{"type":405,"tag":436,"props":1601,"children":1602},{"style":578},[1603],{"type":411,"value":1604}," setImmediate ",{"type":405,"tag":436,"props":1606,"children":1607},{"style":522},[1608],{"type":411,"value":1133},{"type":405,"tag":436,"props":1610,"children":1611},{"style":737},[1612],{"type":411,"value":922},{"type":405,"tag":436,"props":1614,"children":1615},{"style":743},[1616],{"type":411,"value":927},{"type":405,"tag":436,"props":1618,"children":1619},{"style":737},[1620],{"type":411,"value":740},{"type":405,"tag":436,"props":1622,"children":1623},{"style":522},[1624],{"type":411,"value":936},{"type":405,"tag":436,"props":1626,"children":1627},{"style":465},[1628],{"type":411,"value":941},{"type":405,"tag":436,"props":1630,"children":1631},{"style":578},[1632],{"type":411,"value":1633},"(setImmediate)) ",{"type":405,"tag":436,"props":1635,"children":1636},{"style":471},[1637],{"type":411,"value":659},{"type":405,"tag":436,"props":1639,"children":1641},{"class":438,"line":1640},34,[1642],{"type":405,"tag":436,"props":1643,"children":1644},{"style":443},[1645],{"type":411,"value":1646},"  // Technically it leverages the (macro) task queue,\n",{"type":405,"tag":436,"props":1648,"children":1650},{"class":438,"line":1649},35,[1651],{"type":405,"tag":436,"props":1652,"children":1653},{"style":443},[1654],{"type":411,"value":1655},"  // but it is still a better choice than setTimeout.\n",{"type":405,"tag":436,"props":1657,"children":1659},{"class":438,"line":1658},36,[1660,1664,1668,1672,1676],{"type":405,"tag":436,"props":1661,"children":1662},{"style":465},[1663],{"type":411,"value":1005},{"type":405,"tag":436,"props":1665,"children":1666},{"style":522},[1667],{"type":411,"value":525},{"type":405,"tag":436,"props":1669,"children":1670},{"style":471},[1671],{"type":411,"value":1014},{"type":405,"tag":436,"props":1673,"children":1674},{"style":459},[1675],{"type":411,"value":708},{"type":405,"tag":436,"props":1677,"children":1678},{"style":471},[1679],{"type":411,"value":490},{"type":405,"tag":436,"props":1681,"children":1683},{"class":438,"line":1682},37,[1684,1689,1693,1697,1701],{"type":405,"tag":436,"props":1685,"children":1686},{"style":465},[1687],{"type":411,"value":1688},"    setImmediate",{"type":405,"tag":436,"props":1690,"children":1691},{"style":573},[1692],{"type":411,"value":474},{"type":405,"tag":436,"props":1694,"children":1695},{"style":578},[1696],{"type":411,"value":1048},{"type":405,"tag":436,"props":1698,"children":1699},{"style":573},[1700],{"type":411,"value":485},{"type":405,"tag":436,"props":1702,"children":1703},{"style":471},[1704],{"type":411,"value":600},{"type":405,"tag":436,"props":1706,"children":1708},{"class":438,"line":1707},38,[1709],{"type":405,"tag":436,"props":1710,"children":1711},{"style":471},[1712],{"type":411,"value":609},{"type":405,"tag":436,"props":1714,"children":1716},{"class":438,"line":1715},39,[1717],{"type":405,"tag":436,"props":1718,"children":1719},{"style":471},[1720],{"type":411,"value":618},{"type":405,"tag":436,"props":1722,"children":1724},{"class":438,"line":1723},40,[1725],{"type":405,"tag":436,"props":1726,"children":1727},{"style":443},[1728],{"type":411,"value":1729},"// 最次的情况则选择 setTimeout\n",{"type":405,"tag":436,"props":1731,"children":1733},{"class":438,"line":1732},41,[1734,1738],{"type":405,"tag":436,"props":1735,"children":1736},{"style":453},[1737],{"type":411,"value":1086},{"type":405,"tag":436,"props":1739,"children":1740},{"style":471},[1741],{"type":411,"value":490},{"type":405,"tag":436,"props":1743,"children":1745},{"class":438,"line":1744},42,[1746,1750,1754,1758,1762],{"type":405,"tag":436,"props":1747,"children":1748},{"style":465},[1749],{"type":411,"value":1005},{"type":405,"tag":436,"props":1751,"children":1752},{"style":522},[1753],{"type":411,"value":525},{"type":405,"tag":436,"props":1755,"children":1756},{"style":471},[1757],{"type":411,"value":1014},{"type":405,"tag":436,"props":1759,"children":1760},{"style":459},[1761],{"type":411,"value":708},{"type":405,"tag":436,"props":1763,"children":1764},{"style":471},[1765],{"type":411,"value":490},{"type":405,"tag":436,"props":1767,"children":1769},{"class":438,"line":1768},43,[1770,1775,1779,1783,1787,1792,1796],{"type":405,"tag":436,"props":1771,"children":1772},{"style":465},[1773],{"type":411,"value":1774},"    setTimeout",{"type":405,"tag":436,"props":1776,"children":1777},{"style":573},[1778],{"type":411,"value":474},{"type":405,"tag":436,"props":1780,"children":1781},{"style":578},[1782],{"type":411,"value":1048},{"type":405,"tag":436,"props":1784,"children":1785},{"style":471},[1786],{"type":411,"value":585},{"type":405,"tag":436,"props":1788,"children":1789},{"style":1254},[1790],{"type":411,"value":1791}," 0",{"type":405,"tag":436,"props":1793,"children":1794},{"style":573},[1795],{"type":411,"value":485},{"type":405,"tag":436,"props":1797,"children":1798},{"style":471},[1799],{"type":411,"value":600},{"type":405,"tag":436,"props":1801,"children":1803},{"class":438,"line":1802},44,[1804],{"type":405,"tag":436,"props":1805,"children":1806},{"style":471},[1807],{"type":411,"value":609},{"type":405,"tag":436,"props":1809,"children":1811},{"class":438,"line":1810},45,[1812],{"type":405,"tag":436,"props":1813,"children":1814},{"style":471},[1815],{"type":411,"value":618},{"type":405,"tag":414,"props":1817,"children":1818},{},[1819],{"type":411,"value":1820},"为什么会优先选择 setImmediate 而不是 setTimeout 呢？因为根据 HTML 规范，setTimeout 嵌套层数超过 5 级时，其回调的延迟会被限制为至少 4ms，而 setImmediate 则不受约束。",{"type":405,"tag":414,"props":1822,"children":1823},{},[1824],{"type":411,"value":1825},"有一段时期的 Vue，暴露了 withMacroTask，可将一些回调强制存放至当前宏任务队列。但是由于宏任务有各种无法规避的问题，此方案被废弃了。源注释是这么说的：",{"type":405,"tag":425,"props":1827,"children":1829},{"className":427,"code":1828,"language":429,"meta":398,"style":398},"// In 2.5 we used (macro) tasks (in combination with microtasks).\n// However, it has subtle problems when state is changed right before repaint\n// Also, using (macro) tasks in event handler would cause some weird behaviors,\n// that cannot be circumvented (e.g. #7109, #7153, #7546, #7834, #8109).\n// So we now use microtasks everywhere, again.\n",[1830],{"type":405,"tag":432,"props":1831,"children":1832},{"__ignoreMap":398},[1833,1841,1849,1857,1865],{"type":405,"tag":436,"props":1834,"children":1835},{"class":438,"line":439},[1836],{"type":405,"tag":436,"props":1837,"children":1838},{"style":443},[1839],{"type":411,"value":1840},"// In 2.5 we used (macro) tasks (in combination with microtasks).\n",{"type":405,"tag":436,"props":1842,"children":1843},{"class":438,"line":449},[1844],{"type":405,"tag":436,"props":1845,"children":1846},{"style":443},[1847],{"type":411,"value":1848},"// However, it has subtle problems when state is changed right before repaint\n",{"type":405,"tag":436,"props":1850,"children":1851},{"class":438,"line":493},[1852],{"type":405,"tag":436,"props":1853,"children":1854},{"style":443},[1855],{"type":411,"value":1856},"// Also, using (macro) tasks in event handler would cause some weird behaviors,\n",{"type":405,"tag":436,"props":1858,"children":1859},{"class":438,"line":550},[1860],{"type":405,"tag":436,"props":1861,"children":1862},{"style":443},[1863],{"type":411,"value":1864},"// that cannot be circumvented (e.g. #7109, #7153, #7546, #7834, #8109).\n",{"type":405,"tag":436,"props":1866,"children":1867},{"class":438,"line":559},[1868],{"type":405,"tag":436,"props":1869,"children":1870},{"style":443},[1871],{"type":411,"value":1872},"// So we now use microtasks everywhere, again.\n",{"type":405,"tag":406,"props":1874,"children":1876},{"id":1875},"阅读更多",[1877],{"type":411,"value":1875},{"type":405,"tag":1879,"props":1880,"children":1881},"ul",{},[1882],{"type":405,"tag":1883,"props":1884,"children":1885},"li",{},[1886],{"type":405,"tag":1887,"props":1888,"children":1892},"a",{"href":1889,"rel":1890},"https://mp.weixin.qq.com/s/71039rWm9W15IsrMOaGwZQ",[1891],"nofollow",[1893],{"type":411,"value":1894},"为什么 setTimeout 有最小时延 4ms",{"type":405,"tag":1896,"props":1897,"children":1898},"style",{},[1899],{"type":411,"value":1900},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":398,"searchDepth":449,"depth":449,"links":1902},[1903,1904],{"id":408,"depth":449,"text":412},{"id":1875,"depth":449,"text":1875},"markdown","content:8.source-code:_js:vue2-source:3.global-api.md","content","8.source-code/_js/vue2-source/3.global-api.md","8.source-code/_js/vue2-source/3.global-api","md",[1912,1915],{"_path":1913,"title":1914,"description":400},"/source-code/_js/vue2-source/parser","Vue2 Parser",{"_path":1916,"title":1917,"description":400},"/source-code/_js/vue2-source/scoped-css","Vue2 Scoped CSS",1741604970385]