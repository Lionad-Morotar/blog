[{"data":1,"prerenderedAt":2157},["Reactive",2],{"navigation":3,"/source-code/_js/vue2-source/scoped-css":383,"/source-code/_js/vue2-source/scoped-css-surround":2150},[4,32,80,96,123,129,135,366,372,378],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":42,"_path":43},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":45,"_path":46},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":48,"_path":49},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":51,"_path":52},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":54,"_path":55},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":57,"_path":58},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":60,"_path":61},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":63,"_path":64},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":66,"_path":67},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":69,"_path":70},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":72,"_path":73},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":75,"_path":76},"🚝 四十二篇系列","/articles/fourty-two",{"title":78,"_path":79},"📝 技术博客归档","/articles/fold",{"title":81,"_path":82,"children":83},"造物 / Make","/tools",[84,87,90,93],{"title":85,"_path":86},"🌐 AnySort","/tools/anysort",{"title":88,"_path":89},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":91,"_path":92},"👓 Crapto","/tools/crypto-inline",{"title":94,"_path":95},"🖨️ any-to-base64","/tools/any-to-base64",{"title":97,"_path":98,"children":99},"吉他剧场 / Music","/music",[100,102,105,108,111,114,117,120],{"title":101,"_path":98},"🎸 FingerStyle！",{"title":103,"_path":104},"🌬️ 等待的风","/music/wind",{"title":106,"_path":107},"💕 约定的海洋","/music/ocean",{"title":109,"_path":110},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":112,"_path":113},"🌏 残酷天使的行动纲领","/music/eva",{"title":115,"_path":116},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":118,"_path":119},"🍷 Wu Wei","/music/wu-wei",{"title":121,"_path":122},"🌅 无题","/music/untitled",{"title":124,"_path":125,"children":126},"画点什么 / Paint","/paint",[127],{"title":128,"_path":125},"🚧 正在施工",{"title":130,"_path":131,"children":132},"知识地图 / Maps","/maps",[133],{"title":134,"_path":131},"🏁 知识地图",{"title":136,"_path":137,"children":138},"零散的笔记 / Gists","/gists",[139,141,144,147,150,153,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363],{"title":140,"_path":137},"🧊 Gists",{"title":142,"_path":143},"网站的可访问性","/gists/accessibility",{"title":145,"_path":146},"图片模糊","/gists/blur",{"title":148,"_path":149},"渲染相关笔记","/gists/c4d",{"title":151,"_path":152},"CDN 问题记录","/gists/cdn",{"title":154,"_path":155},"消毒剂","/gists/cleaner",{"title":157,"_path":158},"Windows Command","/gists/cmd",{"title":160,"_path":161},"Command","/gists/command",{"title":163,"_path":164},"复杂科学","/gists/complexity-science",{"title":166,"_path":167},"宇宙","/gists/cosmos",{"title":169,"_path":170},"C++","/gists/cpp",{"title":172,"_path":173},"Data Structure","/gists/data-structure",{"title":175,"_path":176},"DEPRESSION","/gists/depression",{"title":178,"_path":179},"设计模式","/gists/design-patterns",{"title":181,"_path":182},"Developer Experience","/gists/developer-experience",{"title":184,"_path":185},"Device Metrics","/gists/device-metrix",{"title":187,"_path":188},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":190,"_path":191},"正则表达式","/gists/eegex",{"title":193,"_path":194},"Emoji","/gists/emoji",{"title":196,"_path":197},"工程","/gists/engineering",{"title":199,"_path":200},"熵","/gists/entropy",{"title":202,"_path":203},"Environment","/gists/environment",{"title":205,"_path":206},"Erlang","/gists/erlang",{"title":208,"_path":209},"逃离塔克夫","/gists/escape-from-tarkov",{"title":211,"_path":212},"ESNext (ES6-ES11)","/gists/esnext",{"title":214,"_path":215},"Eval！","/gists/eval",{"title":217,"_path":218},"Flutter","/gists/flutter",{"title":220,"_path":221},"字体","/gists/font",{"title":223,"_path":224},"JS 函数式编程","/gists/functional",{"title":226,"_path":227},"Google C++ Standard","/gists/google-cpp-standard",{"title":229,"_path":230},"双向链接完全体","/gists/graph",{"title":232,"_path":233},"Hardwares","/gists/hardwares",{"title":235,"_path":236},"哈希冲突","/gists/hash-collision",{"title":238,"_path":239},"信息设计","/gists/information-design",{"title":241,"_path":242},"InstantPage","/gists/instant.page",{"title":244,"_path":245},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":247,"_path":248},"KVStore","/gists/key-value-db",{"title":250,"_path":251},"Kubernetes","/gists/kubernetes",{"title":253,"_path":254},"Makefile","/gists/makefile",{"title":256,"_path":257},"Markdown Inline Style","/gists/markdown-nice",{"title":259,"_path":260},"小程序","/gists/miniapp",{"title":262,"_path":263},"减小页面快照体积","/gists/minify-html",{"title":265,"_path":266},"mklink","/gists/mklink",{"title":268,"_path":269},"Mock","/gists/mock",{"title":271,"_path":272},"多端应用","/gists/multy-end-app",{"title":274,"_path":275},"神经科学","/gists/neuroscience",{"title":277,"_path":278},"OO","/gists/oo",{"title":280,"_path":281},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":283,"_path":284},"人物","/gists/person",{"title":286,"_path":287},"PInvoke","/gists/pinvoke",{"title":289,"_path":290},"像素","/gists/pixel",{"title":292,"_path":293},"PowerShell","/gists/powershell",{"title":295,"_path":296},"量子","/gists/quantum",{"title":298,"_path":299},"保持好奇心","/gists/questions",{"title":301,"_path":302},"React Native","/gists/react-native",{"title":304,"_path":305},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":307,"_path":308},"SEO","/gists/seo",{"title":310,"_path":311},"Shader","/gists/shader",{"title":313,"_path":314},"Shape Up","/gists/shape-up",{"title":316,"_path":317},"睡觉","/gists/sleep",{"title":319,"_path":320},"States","/gists/states",{"title":322,"_path":323},"Storage","/gists/storage",{"title":325,"_path":326},"音视频流处理","/gists/stream-cli",{"title":328,"_path":329},"Symbol","/gists/symbol",{"title":331,"_path":332},"系统论","/gists/systems-theory",{"title":334,"_path":335},"Taro","/gists/taro",{"title":337,"_path":338},"任务切片","/gists/task-slice",{"title":340,"_path":341},"技术偏好","/gists/tech-dudge",{"title":343,"_path":344},"Untitled","/gists/untitled",{"title":346,"_path":347},"可变字体","/gists/variable-font",{"title":349,"_path":350},"视觉错觉","/gists/visual-illusion",{"title":352,"_path":353},"SS(SSR)","/gists/vpn",{"title":355,"_path":356},"VS Code 插件开发","/gists/vscode-plugin",{"title":358,"_path":359},"Web Components","/gists/web-components",{"title":361,"_path":362},"Windows","/gists/windows",{"title":364,"_path":365},"查缺补漏","/gists/wrong",{"title":367,"_path":368,"children":369},"代码笔记 / Gists","/source-code",[370],{"title":371,"_path":368},"🚄 代码笔记",{"title":373,"_path":374,"children":375},"我 / Abount","/hire",[376],{"title":377,"_path":374},"📬 技术简历",{"title":379,"_path":380,"children":381},"todo","/todo",[382],{"title":379,"_path":380},{"_path":384,"_dir":385,"_draft":386,"_partial":387,"_locale":388,"title":389,"description":390,"body":391,"_type":2146,"_id":2147,"_source":1001,"_file":2148,"_extension":2149},"/source-code/_js/vue2-source/scoped-css","vue2-source",false,true,"","Vue2 Scoped CSS","deprecated warning",{"type":392,"children":393,"toc":2138},"root",[394,427,433,469,553,574,583,588,594,615,1177,1189,1243,1256,1261,1268,1289,1345,1350,1378,1456,1476,1530,1537,1565,1627,1648,1667,1672,1711,1716,1794,1807,1862,1867,1904,1965,1986,2080,2093,2128,2133],{"type":395,"tag":396,"props":397,"children":398},"element","p",{},[399,402,409,411,417,419,425],{"type":400,"value":401},"text","使用 VueJS 开发应用离不开模块拆分，即将大块界面拆解为组件的过程。我们可以很方便的在单文件中使用",{"type":395,"tag":403,"props":404,"children":406},"code",{"className":405},[],[407],{"type":400,"value":408},"\u003Ctemplate>",{"type":400,"value":410},"块维护组件的视图，使用",{"type":395,"tag":403,"props":412,"children":414},{"className":413},[],[415],{"type":400,"value":416},"\u003Cscript>",{"type":400,"value":418},"维护组件的逻辑部分，使用",{"type":395,"tag":403,"props":420,"children":422},{"className":421},[],[423],{"type":400,"value":424},"\u003Cstyle>",{"type":400,"value":426},"维护组件的样式。在我们编写 VueJS 组件样式时，不得忽略的一点就是如何防止以及反制样式污染。",{"type":395,"tag":428,"props":429,"children":431},"h2",{"id":430},"样式污染产生原因",[432],{"type":400,"value":430},{"type":395,"tag":396,"props":434,"children":435},{},[436,438,444,446,452,454,467],{"type":400,"value":437},"提及样式污染，主要要追溯到",{"type":395,"tag":403,"props":439,"children":441},{"className":440},[],[442],{"type":400,"value":443},"webpack",{"type":400,"value":445},"对",{"type":395,"tag":403,"props":447,"children":449},{"className":448},[],[450],{"type":400,"value":451},"CSS",{"type":400,"value":453},"文件的打包过程，这里我们以",{"type":395,"tag":455,"props":456,"children":460},"a",{"href":457,"rel":458},"https://github.com/PanJiaChen/vue-element-admin",[459],"nofollow",[461],{"type":395,"tag":403,"props":462,"children":464},{"className":463},[],[465],{"type":400,"value":466},"Vue-Element-Admin",{"type":400,"value":468},"中的 webpack 配置项举例：",{"type":395,"tag":470,"props":471,"children":475},"pre",{"className":472,"code":473,"language":474,"meta":388,"style":388},"language-JS shiki shiki-themes material-theme-lighter github-light github-dark monokai","const webpackConfig = merge(baseWebpackConfig, {\n    plugins: [\n        new MiniCssExtractPlugin({\n          filename: utils.assetsPath('css/[name].[contenthash:8].css'),\n          chunkFilename: utils.assetsPath('css/[name].[contenthash:8].css')\n        }),\n    ]\n})\n","JS",[476],{"type":395,"tag":403,"props":477,"children":478},{"__ignoreMap":388},[479,490,499,508,517,526,535,544],{"type":395,"tag":480,"props":481,"children":484},"span",{"class":482,"line":483},"line",1,[485],{"type":395,"tag":480,"props":486,"children":487},{},[488],{"type":400,"value":489},"const webpackConfig = merge(baseWebpackConfig, {\n",{"type":395,"tag":480,"props":491,"children":493},{"class":482,"line":492},2,[494],{"type":395,"tag":480,"props":495,"children":496},{},[497],{"type":400,"value":498},"    plugins: [\n",{"type":395,"tag":480,"props":500,"children":502},{"class":482,"line":501},3,[503],{"type":395,"tag":480,"props":504,"children":505},{},[506],{"type":400,"value":507},"        new MiniCssExtractPlugin({\n",{"type":395,"tag":480,"props":509,"children":511},{"class":482,"line":510},4,[512],{"type":395,"tag":480,"props":513,"children":514},{},[515],{"type":400,"value":516},"          filename: utils.assetsPath('css/[name].[contenthash:8].css'),\n",{"type":395,"tag":480,"props":518,"children":520},{"class":482,"line":519},5,[521],{"type":395,"tag":480,"props":522,"children":523},{},[524],{"type":400,"value":525},"          chunkFilename: utils.assetsPath('css/[name].[contenthash:8].css')\n",{"type":395,"tag":480,"props":527,"children":529},{"class":482,"line":528},6,[530],{"type":395,"tag":480,"props":531,"children":532},{},[533],{"type":400,"value":534},"        }),\n",{"type":395,"tag":480,"props":536,"children":538},{"class":482,"line":537},7,[539],{"type":395,"tag":480,"props":540,"children":541},{},[542],{"type":400,"value":543},"    ]\n",{"type":395,"tag":480,"props":545,"children":547},{"class":482,"line":546},8,[548],{"type":395,"tag":480,"props":549,"children":550},{},[551],{"type":400,"value":552},"})\n",{"type":395,"tag":396,"props":554,"children":555},{},[556,558,564,566,572],{"type":400,"value":557},"webpack 使用 ",{"type":395,"tag":403,"props":559,"children":561},{"className":560},[],[562],{"type":400,"value":563},"MiniCssExtractPlugin",{"type":400,"value":565}," 插件，将文件(如 Vue 单文件组件)中的 CSS 代码，经过处理后，分离到形如",{"type":395,"tag":403,"props":567,"children":569},{"className":568},[],[570],{"type":400,"value":571},"app.hash1234.css",{"type":400,"value":573},"的单独的 CSS 文件：",{"type":395,"tag":396,"props":575,"children":576},{},[577],{"type":395,"tag":578,"props":579,"children":582},"img",{"alt":580,"src":581},"单独的CSS文件","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/scoped-css/browser_fYMdZDAMsI.png",[],{"type":395,"tag":396,"props":584,"children":585},{},[586],{"type":400,"value":587},"如果没有加入防止样式污染的措施的同时，项目中存在了大量的同名 ClassName，那么可能会产生意想不到的 CSS 选择器权重覆盖。这可能使后文件中某部分选择器权重更高的类影响整个应用，而此过程通常发生在组件的编写中，所以一般称之为组件样式污染。",{"type":395,"tag":428,"props":589,"children":591},{"id":590},"webpack-vue-sfc-object",[592],{"type":400,"value":593},"webpack & Vue SFC Object",{"type":395,"tag":396,"props":595,"children":596},{},[597,599,605,607,613],{"type":400,"value":598},"对于 Vue 项目而言，使用 webpack 将极大的优化了工作流程，因为通过",{"type":395,"tag":403,"props":600,"children":602},{"className":601},[],[603],{"type":400,"value":604},"Vue Loader",{"type":400,"value":606},"，Vue 单文件组件能很好的融合进 webpack 工作流中。我们写的单文件组件都被处理为了",{"type":395,"tag":403,"props":608,"children":610},{"className":609},[],[611],{"type":400,"value":612},"SFC对象",{"type":400,"value":614},"，即包含了单个 HTML 模块，单个脚本模块，一个或多个样式模块，一个或多个自定义模块的对象：",{"type":395,"tag":470,"props":616,"children":620},{"className":617,"code":618,"language":619,"meta":388,"style":388},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","// vue-loader/index.js\nconst descriptor = parse({\n  source,\n  compiler: options.compiler || loadTemplateCompiler(),\n  filename,\n  sourceRoot,\n  needMap: sourceMap,\n});\n\n// vuejs/component-compiler-utils/index.js\nfunction parse(options) {\n  const { compiler } = options;\n  output = compiler.parseComponent(source, compilerParseOptions);\n  return output;\n}\n\n// vue.js\nfunction parseComponent(content, options) {\n  // ...\n  var sfc = {\n    template: null,\n    script: null,\n    styles: [],\n    customBlocks: [],\n  };\n  // ...\n  return sfc;\n}\n","js",[621],{"type":395,"tag":403,"props":622,"children":623},{"__ignoreMap":388},[624,633,672,685,733,745,757,778,796,805,814,846,882,935,954,963,971,980,1018,1027,1049,1072,1093,1115,1136,1145,1153,1169],{"type":395,"tag":480,"props":625,"children":626},{"class":482,"line":483},[627],{"type":395,"tag":480,"props":628,"children":630},{"style":629},"--shiki-light:#90A4AE;--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[631],{"type":400,"value":632},"// vue-loader/index.js\n",{"type":395,"tag":480,"props":634,"children":635},{"class":482,"line":492},[636,642,648,654,660,666],{"type":395,"tag":480,"props":637,"children":639},{"style":638},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-light-font-style:inherit;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[640],{"type":400,"value":641},"const",{"type":395,"tag":480,"props":643,"children":645},{"style":644},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[646],{"type":400,"value":647}," descriptor",{"type":395,"tag":480,"props":649,"children":651},{"style":650},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[652],{"type":400,"value":653}," =",{"type":395,"tag":480,"props":655,"children":657},{"style":656},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[658],{"type":400,"value":659}," parse",{"type":395,"tag":480,"props":661,"children":663},{"style":662},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[664],{"type":400,"value":665},"(",{"type":395,"tag":480,"props":667,"children":669},{"style":668},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[670],{"type":400,"value":671},"{\n",{"type":395,"tag":480,"props":673,"children":674},{"class":482,"line":501},[675,680],{"type":395,"tag":480,"props":676,"children":677},{"style":662},[678],{"type":400,"value":679},"  source",{"type":395,"tag":480,"props":681,"children":682},{"style":668},[683],{"type":400,"value":684},",\n",{"type":395,"tag":480,"props":686,"children":687},{"class":482,"line":510},[688,694,699,704,709,714,719,724,729],{"type":395,"tag":480,"props":689,"children":691},{"style":690},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[692],{"type":400,"value":693},"  compiler",{"type":395,"tag":480,"props":695,"children":696},{"style":668},[697],{"type":400,"value":698},":",{"type":395,"tag":480,"props":700,"children":701},{"style":662},[702],{"type":400,"value":703}," options",{"type":395,"tag":480,"props":705,"children":706},{"style":668},[707],{"type":400,"value":708},".",{"type":395,"tag":480,"props":710,"children":711},{"style":662},[712],{"type":400,"value":713},"compiler ",{"type":395,"tag":480,"props":715,"children":716},{"style":650},[717],{"type":400,"value":718},"||",{"type":395,"tag":480,"props":720,"children":721},{"style":656},[722],{"type":400,"value":723}," loadTemplateCompiler",{"type":395,"tag":480,"props":725,"children":726},{"style":662},[727],{"type":400,"value":728},"()",{"type":395,"tag":480,"props":730,"children":731},{"style":668},[732],{"type":400,"value":684},{"type":395,"tag":480,"props":734,"children":735},{"class":482,"line":519},[736,741],{"type":395,"tag":480,"props":737,"children":738},{"style":662},[739],{"type":400,"value":740},"  filename",{"type":395,"tag":480,"props":742,"children":743},{"style":668},[744],{"type":400,"value":684},{"type":395,"tag":480,"props":746,"children":747},{"class":482,"line":528},[748,753],{"type":395,"tag":480,"props":749,"children":750},{"style":662},[751],{"type":400,"value":752},"  sourceRoot",{"type":395,"tag":480,"props":754,"children":755},{"style":668},[756],{"type":400,"value":684},{"type":395,"tag":480,"props":758,"children":759},{"class":482,"line":537},[760,765,769,774],{"type":395,"tag":480,"props":761,"children":762},{"style":690},[763],{"type":400,"value":764},"  needMap",{"type":395,"tag":480,"props":766,"children":767},{"style":668},[768],{"type":400,"value":698},{"type":395,"tag":480,"props":770,"children":771},{"style":662},[772],{"type":400,"value":773}," sourceMap",{"type":395,"tag":480,"props":775,"children":776},{"style":668},[777],{"type":400,"value":684},{"type":395,"tag":480,"props":779,"children":780},{"class":482,"line":546},[781,786,791],{"type":395,"tag":480,"props":782,"children":783},{"style":668},[784],{"type":400,"value":785},"}",{"type":395,"tag":480,"props":787,"children":788},{"style":662},[789],{"type":400,"value":790},")",{"type":395,"tag":480,"props":792,"children":793},{"style":668},[794],{"type":400,"value":795},";\n",{"type":395,"tag":480,"props":797,"children":799},{"class":482,"line":798},9,[800],{"type":395,"tag":480,"props":801,"children":802},{"emptyLinePlaceholder":387},[803],{"type":400,"value":804},"\n",{"type":395,"tag":480,"props":806,"children":808},{"class":482,"line":807},10,[809],{"type":395,"tag":480,"props":810,"children":811},{"style":629},[812],{"type":400,"value":813},"// vuejs/component-compiler-utils/index.js\n",{"type":395,"tag":480,"props":815,"children":817},{"class":482,"line":816},11,[818,823,827,831,837,841],{"type":395,"tag":480,"props":819,"children":820},{"style":638},[821],{"type":400,"value":822},"function",{"type":395,"tag":480,"props":824,"children":825},{"style":656},[826],{"type":400,"value":659},{"type":395,"tag":480,"props":828,"children":829},{"style":668},[830],{"type":400,"value":665},{"type":395,"tag":480,"props":832,"children":834},{"style":833},"--shiki-light:#90A4AE;--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[835],{"type":400,"value":836},"options",{"type":395,"tag":480,"props":838,"children":839},{"style":668},[840],{"type":400,"value":790},{"type":395,"tag":480,"props":842,"children":843},{"style":668},[844],{"type":400,"value":845}," {\n",{"type":395,"tag":480,"props":847,"children":849},{"class":482,"line":848},12,[850,855,860,865,870,874,878],{"type":395,"tag":480,"props":851,"children":852},{"style":638},[853],{"type":400,"value":854},"  const",{"type":395,"tag":480,"props":856,"children":857},{"style":668},[858],{"type":400,"value":859}," {",{"type":395,"tag":480,"props":861,"children":862},{"style":644},[863],{"type":400,"value":864}," compiler",{"type":395,"tag":480,"props":866,"children":867},{"style":668},[868],{"type":400,"value":869}," }",{"type":395,"tag":480,"props":871,"children":872},{"style":650},[873],{"type":400,"value":653},{"type":395,"tag":480,"props":875,"children":876},{"style":662},[877],{"type":400,"value":703},{"type":395,"tag":480,"props":879,"children":880},{"style":668},[881],{"type":400,"value":795},{"type":395,"tag":480,"props":883,"children":885},{"class":482,"line":884},13,[886,891,895,899,903,908,912,917,922,927,931],{"type":395,"tag":480,"props":887,"children":888},{"style":662},[889],{"type":400,"value":890},"  output",{"type":395,"tag":480,"props":892,"children":893},{"style":650},[894],{"type":400,"value":653},{"type":395,"tag":480,"props":896,"children":897},{"style":662},[898],{"type":400,"value":864},{"type":395,"tag":480,"props":900,"children":901},{"style":668},[902],{"type":400,"value":708},{"type":395,"tag":480,"props":904,"children":905},{"style":656},[906],{"type":400,"value":907},"parseComponent",{"type":395,"tag":480,"props":909,"children":910},{"style":690},[911],{"type":400,"value":665},{"type":395,"tag":480,"props":913,"children":914},{"style":662},[915],{"type":400,"value":916},"source",{"type":395,"tag":480,"props":918,"children":919},{"style":668},[920],{"type":400,"value":921},",",{"type":395,"tag":480,"props":923,"children":924},{"style":662},[925],{"type":400,"value":926}," compilerParseOptions",{"type":395,"tag":480,"props":928,"children":929},{"style":690},[930],{"type":400,"value":790},{"type":395,"tag":480,"props":932,"children":933},{"style":668},[934],{"type":400,"value":795},{"type":395,"tag":480,"props":936,"children":938},{"class":482,"line":937},14,[939,945,950],{"type":395,"tag":480,"props":940,"children":942},{"style":941},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[943],{"type":400,"value":944},"  return",{"type":395,"tag":480,"props":946,"children":947},{"style":662},[948],{"type":400,"value":949}," output",{"type":395,"tag":480,"props":951,"children":952},{"style":668},[953],{"type":400,"value":795},{"type":395,"tag":480,"props":955,"children":957},{"class":482,"line":956},15,[958],{"type":395,"tag":480,"props":959,"children":960},{"style":668},[961],{"type":400,"value":962},"}\n",{"type":395,"tag":480,"props":964,"children":966},{"class":482,"line":965},16,[967],{"type":395,"tag":480,"props":968,"children":969},{"emptyLinePlaceholder":387},[970],{"type":400,"value":804},{"type":395,"tag":480,"props":972,"children":974},{"class":482,"line":973},17,[975],{"type":395,"tag":480,"props":976,"children":977},{"style":629},[978],{"type":400,"value":979},"// vue.js\n",{"type":395,"tag":480,"props":981,"children":983},{"class":482,"line":982},18,[984,988,993,997,1002,1006,1010,1014],{"type":395,"tag":480,"props":985,"children":986},{"style":638},[987],{"type":400,"value":822},{"type":395,"tag":480,"props":989,"children":990},{"style":656},[991],{"type":400,"value":992}," parseComponent",{"type":395,"tag":480,"props":994,"children":995},{"style":668},[996],{"type":400,"value":665},{"type":395,"tag":480,"props":998,"children":999},{"style":833},[1000],{"type":400,"value":1001},"content",{"type":395,"tag":480,"props":1003,"children":1004},{"style":668},[1005],{"type":400,"value":921},{"type":395,"tag":480,"props":1007,"children":1008},{"style":833},[1009],{"type":400,"value":703},{"type":395,"tag":480,"props":1011,"children":1012},{"style":668},[1013],{"type":400,"value":790},{"type":395,"tag":480,"props":1015,"children":1016},{"style":668},[1017],{"type":400,"value":845},{"type":395,"tag":480,"props":1019,"children":1021},{"class":482,"line":1020},19,[1022],{"type":395,"tag":480,"props":1023,"children":1024},{"style":629},[1025],{"type":400,"value":1026},"  // ...\n",{"type":395,"tag":480,"props":1028,"children":1030},{"class":482,"line":1029},20,[1031,1036,1041,1045],{"type":395,"tag":480,"props":1032,"children":1033},{"style":638},[1034],{"type":400,"value":1035},"  var",{"type":395,"tag":480,"props":1037,"children":1038},{"style":662},[1039],{"type":400,"value":1040}," sfc",{"type":395,"tag":480,"props":1042,"children":1043},{"style":650},[1044],{"type":400,"value":653},{"type":395,"tag":480,"props":1046,"children":1047},{"style":668},[1048],{"type":400,"value":845},{"type":395,"tag":480,"props":1050,"children":1052},{"class":482,"line":1051},21,[1053,1058,1062,1068],{"type":395,"tag":480,"props":1054,"children":1055},{"style":690},[1056],{"type":400,"value":1057},"    template",{"type":395,"tag":480,"props":1059,"children":1060},{"style":668},[1061],{"type":400,"value":698},{"type":395,"tag":480,"props":1063,"children":1065},{"style":1064},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1066],{"type":400,"value":1067}," null",{"type":395,"tag":480,"props":1069,"children":1070},{"style":668},[1071],{"type":400,"value":684},{"type":395,"tag":480,"props":1073,"children":1075},{"class":482,"line":1074},22,[1076,1081,1085,1089],{"type":395,"tag":480,"props":1077,"children":1078},{"style":690},[1079],{"type":400,"value":1080},"    script",{"type":395,"tag":480,"props":1082,"children":1083},{"style":668},[1084],{"type":400,"value":698},{"type":395,"tag":480,"props":1086,"children":1087},{"style":1064},[1088],{"type":400,"value":1067},{"type":395,"tag":480,"props":1090,"children":1091},{"style":668},[1092],{"type":400,"value":684},{"type":395,"tag":480,"props":1094,"children":1096},{"class":482,"line":1095},23,[1097,1102,1106,1111],{"type":395,"tag":480,"props":1098,"children":1099},{"style":690},[1100],{"type":400,"value":1101},"    styles",{"type":395,"tag":480,"props":1103,"children":1104},{"style":668},[1105],{"type":400,"value":698},{"type":395,"tag":480,"props":1107,"children":1108},{"style":690},[1109],{"type":400,"value":1110}," []",{"type":395,"tag":480,"props":1112,"children":1113},{"style":668},[1114],{"type":400,"value":684},{"type":395,"tag":480,"props":1116,"children":1118},{"class":482,"line":1117},24,[1119,1124,1128,1132],{"type":395,"tag":480,"props":1120,"children":1121},{"style":690},[1122],{"type":400,"value":1123},"    customBlocks",{"type":395,"tag":480,"props":1125,"children":1126},{"style":668},[1127],{"type":400,"value":698},{"type":395,"tag":480,"props":1129,"children":1130},{"style":690},[1131],{"type":400,"value":1110},{"type":395,"tag":480,"props":1133,"children":1134},{"style":668},[1135],{"type":400,"value":684},{"type":395,"tag":480,"props":1137,"children":1139},{"class":482,"line":1138},25,[1140],{"type":395,"tag":480,"props":1141,"children":1142},{"style":668},[1143],{"type":400,"value":1144},"  };\n",{"type":395,"tag":480,"props":1146,"children":1148},{"class":482,"line":1147},26,[1149],{"type":395,"tag":480,"props":1150,"children":1151},{"style":629},[1152],{"type":400,"value":1026},{"type":395,"tag":480,"props":1154,"children":1156},{"class":482,"line":1155},27,[1157,1161,1165],{"type":395,"tag":480,"props":1158,"children":1159},{"style":941},[1160],{"type":400,"value":944},{"type":395,"tag":480,"props":1162,"children":1163},{"style":662},[1164],{"type":400,"value":1040},{"type":395,"tag":480,"props":1166,"children":1167},{"style":668},[1168],{"type":400,"value":795},{"type":395,"tag":480,"props":1170,"children":1172},{"class":482,"line":1171},28,[1173],{"type":395,"tag":480,"props":1174,"children":1175},{"style":668},[1176],{"type":400,"value":962},{"type":395,"tag":396,"props":1178,"children":1179},{},[1180,1182,1187],{"type":400,"value":1181},"我们可以将 SFC 结构融合到",{"type":395,"tag":403,"props":1183,"children":1185},{"className":1184},[],[1186],{"type":400,"value":443},{"type":400,"value":1188},"进行开发的过程成中，主要有这几点影响：",{"type":395,"tag":1190,"props":1191,"children":1192},"ul",{},[1193,1214,1233,1238],{"type":395,"tag":1194,"props":1195,"children":1196},"li",{},[1197,1199,1204,1206,1212],{"type":400,"value":1198},"允许为 Vue 组件的每个部分使用其它的 webpack loader，例如在",{"type":395,"tag":403,"props":1200,"children":1202},{"className":1201},[],[1203],{"type":400,"value":424},{"type":400,"value":1205},"的部分使用 Sass Loader ，在 ",{"type":395,"tag":403,"props":1207,"children":1209},{"className":1208},[],[1210],{"type":400,"value":1211},"\u003CcustomBlocks>",{"type":400,"value":1213},"的部分使用自定义 Loader",{"type":395,"tag":1194,"props":1215,"children":1216},{},[1217,1219,1224,1226,1231],{"type":400,"value":1218},"使用 webpack loader 将 ",{"type":395,"tag":403,"props":1220,"children":1222},{"className":1221},[],[1223],{"type":400,"value":424},{"type":400,"value":1225},"和 ",{"type":395,"tag":403,"props":1227,"children":1229},{"className":1228},[],[1230],{"type":400,"value":408},{"type":400,"value":1232}," 中引用的资源当作模块依赖来处理",{"type":395,"tag":1194,"props":1234,"children":1235},{},[1236],{"type":400,"value":1237},"模拟 Scoped CSS",{"type":395,"tag":1194,"props":1239,"children":1240},{},[1241],{"type":400,"value":1242},"在开发过程中使用热重载来保持状态",{"type":395,"tag":396,"props":1244,"children":1245},{},[1246,1248,1254],{"type":400,"value":1247},"以下主要介绍",{"type":395,"tag":403,"props":1249,"children":1251},{"className":1250},[],[1252],{"type":400,"value":1253},"Scoped CSS",{"type":400,"value":1255},"的原理。",{"type":395,"tag":428,"props":1257,"children":1259},{"id":1258},"scoped-css",[1260],{"type":400,"value":1253},{"type":395,"tag":1262,"props":1263,"children":1265},"h3",{"id":1264},"大白话版本之-scoped-css-原理",[1266],{"type":400,"value":1267},"大白话版本之 Scoped CSS 原理",{"type":395,"tag":396,"props":1269,"children":1270},{},[1271,1273,1279,1281,1287],{"type":400,"value":1272},"通过 webpack 调用 VueJS 中相应 Loader，给组件 HTML 模板添加自定义属性 (Attribute) ",{"type":395,"tag":403,"props":1274,"children":1276},{"className":1275},[],[1277],{"type":400,"value":1278},"data-v-x",{"type":400,"value":1280},"，以及给组件内 CSS 选择器添加对应的属性选择器 (Attribute Selector) ",{"type":395,"tag":403,"props":1282,"children":1284},{"className":1283},[],[1285],{"type":400,"value":1286},"[data-v-x]",{"type":400,"value":1288},"，达到组件内样式只能生效与组件内 HTML 的效果，代码效果如下：",{"type":395,"tag":470,"props":1290,"children":1294},{"className":1291,"code":1292,"language":1293,"meta":388,"style":388},"language-HTML shiki shiki-themes material-theme-lighter github-light github-dark monokai","\u003Cdiv class='lionad' data-v-lionad>\u003C/div>\n\u003Cstyle>\n.lionad[data-v-lionad] {\n  background: @tiger-orange;\n}\n\u003C/style>\n","HTML",[1295],{"type":395,"tag":403,"props":1296,"children":1297},{"__ignoreMap":388},[1298,1306,1314,1322,1330,1337],{"type":395,"tag":480,"props":1299,"children":1300},{"class":482,"line":483},[1301],{"type":395,"tag":480,"props":1302,"children":1303},{},[1304],{"type":400,"value":1305},"\u003Cdiv class='lionad' data-v-lionad>\u003C/div>\n",{"type":395,"tag":480,"props":1307,"children":1308},{"class":482,"line":492},[1309],{"type":395,"tag":480,"props":1310,"children":1311},{},[1312],{"type":400,"value":1313},"\u003Cstyle>\n",{"type":395,"tag":480,"props":1315,"children":1316},{"class":482,"line":501},[1317],{"type":395,"tag":480,"props":1318,"children":1319},{},[1320],{"type":400,"value":1321},".lionad[data-v-lionad] {\n",{"type":395,"tag":480,"props":1323,"children":1324},{"class":482,"line":510},[1325],{"type":395,"tag":480,"props":1326,"children":1327},{},[1328],{"type":400,"value":1329},"  background: @tiger-orange;\n",{"type":395,"tag":480,"props":1331,"children":1332},{"class":482,"line":519},[1333],{"type":395,"tag":480,"props":1334,"children":1335},{},[1336],{"type":400,"value":962},{"type":395,"tag":480,"props":1338,"children":1339},{"class":482,"line":528},[1340],{"type":395,"tag":480,"props":1341,"children":1342},{},[1343],{"type":400,"value":1344},"\u003C/style>\n",{"type":395,"tag":1262,"props":1346,"children":1348},{"id":1347},"源码跟踪",[1349],{"type":400,"value":1347},{"type":395,"tag":396,"props":1351,"children":1352},{},[1353,1355,1360,1362,1368,1370,1376],{"type":400,"value":1354},"webpack 使用其它 CSS Loader 处理 VueJS 中对应 CSS 代码之前，",{"type":395,"tag":403,"props":1356,"children":1358},{"className":1357},[],[1359],{"type":400,"value":604},{"type":400,"value":1361}," 已经替我们做了一层简单的处理，如果组件中 ",{"type":395,"tag":403,"props":1363,"children":1365},{"className":1364},[],[1366],{"type":400,"value":1367},"style",{"type":400,"value":1369}," 块包含了 ",{"type":395,"tag":403,"props":1371,"children":1373},{"className":1372},[],[1374],{"type":400,"value":1375},"scoped",{"type":400,"value":1377}," 属性：",{"type":395,"tag":470,"props":1379,"children":1381},{"className":1291,"code":1380,"language":1293,"meta":388,"style":388},"\u003C!-- 某个VueJS组件中 -->\n\u003Ctemplate>\n    \u003Cdiv class='lionad'>\u003C/div>\n\u003C/template>\n\u003Cstyle lang=\"scss\" scoped>\n    .lionad {\n        background: @tiger-orange;\n    }\n\u003C/style>\n",[1382],{"type":395,"tag":403,"props":1383,"children":1384},{"__ignoreMap":388},[1385,1393,1401,1409,1417,1425,1433,1441,1449],{"type":395,"tag":480,"props":1386,"children":1387},{"class":482,"line":483},[1388],{"type":395,"tag":480,"props":1389,"children":1390},{},[1391],{"type":400,"value":1392},"\u003C!-- 某个VueJS组件中 -->\n",{"type":395,"tag":480,"props":1394,"children":1395},{"class":482,"line":492},[1396],{"type":395,"tag":480,"props":1397,"children":1398},{},[1399],{"type":400,"value":1400},"\u003Ctemplate>\n",{"type":395,"tag":480,"props":1402,"children":1403},{"class":482,"line":501},[1404],{"type":395,"tag":480,"props":1405,"children":1406},{},[1407],{"type":400,"value":1408},"    \u003Cdiv class='lionad'>\u003C/div>\n",{"type":395,"tag":480,"props":1410,"children":1411},{"class":482,"line":510},[1412],{"type":395,"tag":480,"props":1413,"children":1414},{},[1415],{"type":400,"value":1416},"\u003C/template>\n",{"type":395,"tag":480,"props":1418,"children":1419},{"class":482,"line":519},[1420],{"type":395,"tag":480,"props":1421,"children":1422},{},[1423],{"type":400,"value":1424},"\u003Cstyle lang=\"scss\" scoped>\n",{"type":395,"tag":480,"props":1426,"children":1427},{"class":482,"line":528},[1428],{"type":395,"tag":480,"props":1429,"children":1430},{},[1431],{"type":400,"value":1432},"    .lionad {\n",{"type":395,"tag":480,"props":1434,"children":1435},{"class":482,"line":537},[1436],{"type":395,"tag":480,"props":1437,"children":1438},{},[1439],{"type":400,"value":1440},"        background: @tiger-orange;\n",{"type":395,"tag":480,"props":1442,"children":1443},{"class":482,"line":546},[1444],{"type":395,"tag":480,"props":1445,"children":1446},{},[1447],{"type":400,"value":1448},"    }\n",{"type":395,"tag":480,"props":1450,"children":1451},{"class":482,"line":798},[1452],{"type":395,"tag":480,"props":1453,"children":1454},{},[1455],{"type":400,"value":1344},{"type":395,"tag":396,"props":1457,"children":1458},{},[1459,1461,1467,1469,1474],{"type":400,"value":1460},"下代码即判断当前",{"type":395,"tag":403,"props":1462,"children":1464},{"className":1463},[],[1465],{"type":400,"value":1466},"SFC",{"type":400,"value":1468},"对象样式块中是否有",{"type":395,"tag":403,"props":1470,"children":1472},{"className":1471},[],[1473],{"type":400,"value":1375},{"type":400,"value":1475},"属性，并插入用于 query 中，顺带一提，每个单文件组件被解析后，都会生成对应组件 ID，ID 主要以生产/开发环境做区分，通过文件路径+源码或是文件路径的值作为哈希特征值的形式生成，如下：",{"type":395,"tag":470,"props":1477,"children":1479},{"className":472,"code":1478,"language":474,"meta":388,"style":388},"// vue-loader/index.js\nconst id = hash(isProduction  (shortFilePath + '\\n' + source) : shortFilePath)\nconst hasScoped = descriptor.styles.some(s => s.scoped)\nconst query = `? vue&type=template${idQuery}${scopedQuery}`\nconst request = templateRequest = stringifyRequest(src + query)\ntemplateImport = `import { render, staticRenderFns } from ${request}`\n",[1480],{"type":395,"tag":403,"props":1481,"children":1482},{"__ignoreMap":388},[1483,1490,1498,1506,1514,1522],{"type":395,"tag":480,"props":1484,"children":1485},{"class":482,"line":483},[1486],{"type":395,"tag":480,"props":1487,"children":1488},{},[1489],{"type":400,"value":632},{"type":395,"tag":480,"props":1491,"children":1492},{"class":482,"line":492},[1493],{"type":395,"tag":480,"props":1494,"children":1495},{},[1496],{"type":400,"value":1497},"const id = hash(isProduction  (shortFilePath + '\\n' + source) : shortFilePath)\n",{"type":395,"tag":480,"props":1499,"children":1500},{"class":482,"line":501},[1501],{"type":395,"tag":480,"props":1502,"children":1503},{},[1504],{"type":400,"value":1505},"const hasScoped = descriptor.styles.some(s => s.scoped)\n",{"type":395,"tag":480,"props":1507,"children":1508},{"class":482,"line":510},[1509],{"type":395,"tag":480,"props":1510,"children":1511},{},[1512],{"type":400,"value":1513},"const query = `? vue&type=template${idQuery}${scopedQuery}`\n",{"type":395,"tag":480,"props":1515,"children":1516},{"class":482,"line":519},[1517],{"type":395,"tag":480,"props":1518,"children":1519},{},[1520],{"type":400,"value":1521},"const request = templateRequest = stringifyRequest(src + query)\n",{"type":395,"tag":480,"props":1523,"children":1524},{"class":482,"line":528},[1525],{"type":395,"tag":480,"props":1526,"children":1527},{},[1528],{"type":400,"value":1529},"templateImport = `import { render, staticRenderFns } from ${request}`\n",{"type":395,"tag":1531,"props":1532,"children":1534},"h4",{"id":1533},"html-模板处理",[1535],{"type":400,"value":1536},"HTML 模板处理",{"type":395,"tag":396,"props":1538,"children":1539},{},[1540,1542,1548,1550,1555,1557,1563],{"type":400,"value":1541},"在用于处理 SFC 结构中 HTML 模板的 ",{"type":395,"tag":403,"props":1543,"children":1545},{"className":1544},[],[1546],{"type":400,"value":1547},"templateLoader",{"type":400,"value":1549}," 中，我们可以得知，query 中所设置的参数将合并为 loader options 经由 webpack 转交 ",{"type":395,"tag":403,"props":1551,"children":1553},{"className":1552},[],[1554],{"type":400,"value":1547},{"type":400,"value":1556}," 再转交 ",{"type":395,"tag":403,"props":1558,"children":1560},{"className":1559},[],[1561],{"type":400,"value":1562},"@vue/component-compiler-utils.compileTemplate",{"type":400,"value":1564}," 处理：",{"type":395,"tag":470,"props":1566,"children":1568},{"className":472,"code":1567,"language":474,"meta":388,"style":388},"// vue-loader/templateLoader.js\nconst query = qs.parse(this.resourceQuery)\nconst { id } = query\nconst compilerOptions = Object.assign({}, options.compilerOptions, {\n    scopeId: query.scoped ? `data-v-${id}` : null\n})\nconst compiled = compileTemplate({ compilerOptions })\n",[1569],{"type":395,"tag":403,"props":1570,"children":1571},{"__ignoreMap":388},[1572,1580,1588,1596,1604,1612,1619],{"type":395,"tag":480,"props":1573,"children":1574},{"class":482,"line":483},[1575],{"type":395,"tag":480,"props":1576,"children":1577},{},[1578],{"type":400,"value":1579},"// vue-loader/templateLoader.js\n",{"type":395,"tag":480,"props":1581,"children":1582},{"class":482,"line":492},[1583],{"type":395,"tag":480,"props":1584,"children":1585},{},[1586],{"type":400,"value":1587},"const query = qs.parse(this.resourceQuery)\n",{"type":395,"tag":480,"props":1589,"children":1590},{"class":482,"line":501},[1591],{"type":395,"tag":480,"props":1592,"children":1593},{},[1594],{"type":400,"value":1595},"const { id } = query\n",{"type":395,"tag":480,"props":1597,"children":1598},{"class":482,"line":510},[1599],{"type":395,"tag":480,"props":1600,"children":1601},{},[1602],{"type":400,"value":1603},"const compilerOptions = Object.assign({}, options.compilerOptions, {\n",{"type":395,"tag":480,"props":1605,"children":1606},{"class":482,"line":519},[1607],{"type":395,"tag":480,"props":1608,"children":1609},{},[1610],{"type":400,"value":1611},"    scopeId: query.scoped ? `data-v-${id}` : null\n",{"type":395,"tag":480,"props":1613,"children":1614},{"class":482,"line":528},[1615],{"type":395,"tag":480,"props":1616,"children":1617},{},[1618],{"type":400,"value":552},{"type":395,"tag":480,"props":1620,"children":1621},{"class":482,"line":537},[1622],{"type":395,"tag":480,"props":1623,"children":1624},{},[1625],{"type":400,"value":1626},"const compiled = compileTemplate({ compilerOptions })\n",{"type":395,"tag":396,"props":1628,"children":1629},{},[1630,1632,1638,1640,1646],{"type":400,"value":1631},"实际 ",{"type":395,"tag":403,"props":1633,"children":1635},{"className":1634},[],[1636],{"type":400,"value":1637},"compileTemplate",{"type":400,"value":1639}," 函数在处理内容时，编译函数使用的是 query 中的 compiler 或 ",{"type":395,"tag":403,"props":1641,"children":1643},{"className":1642},[],[1644],{"type":400,"value":1645},"vue-template-compiler",{"type":400,"value":1647},"，后者会将模板文本转换成为 JavaScript 渲染函数，大致如下：",{"type":395,"tag":1649,"props":1650,"children":1651},"ol",{},[1652,1657,1662],{"type":395,"tag":1194,"props":1653,"children":1654},{},[1655],{"type":400,"value":1656},"从 HTML 模版转换为 AST(虚拟语法树)",{"type":395,"tag":1194,"props":1658,"children":1659},{},[1660],{"type":400,"value":1661},"AST 优化，处理静态模版与动态模板",{"type":395,"tag":1194,"props":1663,"children":1664},{},[1665],{"type":400,"value":1666},"生成 JS 函数，用于在运行时运行时生成纯 HTML",{"type":395,"tag":396,"props":1668,"children":1669},{},[1670],{"type":400,"value":1671},"代码分别对应：",{"type":395,"tag":470,"props":1673,"children":1675},{"className":472,"code":1674,"language":474,"meta":388,"style":388},"// vue-template-compiler/build.js/createCompilerCreator\nvar ast = parse(template.trim(), options)\noptimize(ast, options)\nvar code = generate(ast, options)\n",[1676],{"type":395,"tag":403,"props":1677,"children":1678},{"__ignoreMap":388},[1679,1687,1695,1703],{"type":395,"tag":480,"props":1680,"children":1681},{"class":482,"line":483},[1682],{"type":395,"tag":480,"props":1683,"children":1684},{},[1685],{"type":400,"value":1686},"// vue-template-compiler/build.js/createCompilerCreator\n",{"type":395,"tag":480,"props":1688,"children":1689},{"class":482,"line":492},[1690],{"type":395,"tag":480,"props":1691,"children":1692},{},[1693],{"type":400,"value":1694},"var ast = parse(template.trim(), options)\n",{"type":395,"tag":480,"props":1696,"children":1697},{"class":482,"line":501},[1698],{"type":395,"tag":480,"props":1699,"children":1700},{},[1701],{"type":400,"value":1702},"optimize(ast, options)\n",{"type":395,"tag":480,"props":1704,"children":1705},{"class":482,"line":510},[1706],{"type":395,"tag":480,"props":1707,"children":1708},{},[1709],{"type":400,"value":1710},"var code = generate(ast, options)\n",{"type":395,"tag":396,"props":1712,"children":1713},{},[1714],{"type":400,"value":1715},"先前我们的组件 ID 在 parse 阶段解析开始标签时就会被推入内部储存的数据结构中：",{"type":395,"tag":470,"props":1717,"children":1719},{"className":472,"code":1718,"language":474,"meta":388,"style":388},"function elementToOpenTagSegments (el, state) {\n  var segments = [{ type: RAW, value: (\"\u003C\" + (el.tag)) }]\n  // _scopedId\n  if (state.options.scopeId) {\n    segments.push({ type: RAW, value: (\" \" + (state.options.scopeId)) })\n  }\n  segments.push({ type: RAW, value: \">\" })\n  return segments\n}\n",[1720],{"type":395,"tag":403,"props":1721,"children":1722},{"__ignoreMap":388},[1723,1731,1739,1747,1755,1763,1771,1779,1787],{"type":395,"tag":480,"props":1724,"children":1725},{"class":482,"line":483},[1726],{"type":395,"tag":480,"props":1727,"children":1728},{},[1729],{"type":400,"value":1730},"function elementToOpenTagSegments (el, state) {\n",{"type":395,"tag":480,"props":1732,"children":1733},{"class":482,"line":492},[1734],{"type":395,"tag":480,"props":1735,"children":1736},{},[1737],{"type":400,"value":1738},"  var segments = [{ type: RAW, value: (\"\u003C\" + (el.tag)) }]\n",{"type":395,"tag":480,"props":1740,"children":1741},{"class":482,"line":501},[1742],{"type":395,"tag":480,"props":1743,"children":1744},{},[1745],{"type":400,"value":1746},"  // _scopedId\n",{"type":395,"tag":480,"props":1748,"children":1749},{"class":482,"line":510},[1750],{"type":395,"tag":480,"props":1751,"children":1752},{},[1753],{"type":400,"value":1754},"  if (state.options.scopeId) {\n",{"type":395,"tag":480,"props":1756,"children":1757},{"class":482,"line":519},[1758],{"type":395,"tag":480,"props":1759,"children":1760},{},[1761],{"type":400,"value":1762},"    segments.push({ type: RAW, value: (\" \" + (state.options.scopeId)) })\n",{"type":395,"tag":480,"props":1764,"children":1765},{"class":482,"line":528},[1766],{"type":395,"tag":480,"props":1767,"children":1768},{},[1769],{"type":400,"value":1770},"  }\n",{"type":395,"tag":480,"props":1772,"children":1773},{"class":482,"line":537},[1774],{"type":395,"tag":480,"props":1775,"children":1776},{},[1777],{"type":400,"value":1778},"  segments.push({ type: RAW, value: \">\" })\n",{"type":395,"tag":480,"props":1780,"children":1781},{"class":482,"line":546},[1782],{"type":395,"tag":480,"props":1783,"children":1784},{},[1785],{"type":400,"value":1786},"  return segments\n",{"type":395,"tag":480,"props":1788,"children":1789},{"class":482,"line":798},[1790],{"type":395,"tag":480,"props":1791,"children":1792},{},[1793],{"type":400,"value":962},{"type":395,"tag":396,"props":1795,"children":1796},{},[1797,1799,1805],{"type":400,"value":1798},"先前我们的 HTML 模板 ",{"type":395,"tag":403,"props":1800,"children":1802},{"className":1801},[],[1803],{"type":400,"value":1804},"\u003Cdiv class='lionad'>\u003C/div>",{"type":400,"value":1806}," 中开始标签会被转换成如下数据结构：",{"type":395,"tag":470,"props":1808,"children":1810},{"className":472,"code":1809,"language":474,"meta":388,"style":388},"[\n    { type: RAW, value: '\u003Cdiv' },\n    { type: RAW, value: 'class=lionad' },\n    { type: RAW, value: 'data-v-xxxxxx' },\n    { type: RAW, value: '>' },\n]\n",[1811],{"type":395,"tag":403,"props":1812,"children":1813},{"__ignoreMap":388},[1814,1822,1830,1838,1846,1854],{"type":395,"tag":480,"props":1815,"children":1816},{"class":482,"line":483},[1817],{"type":395,"tag":480,"props":1818,"children":1819},{},[1820],{"type":400,"value":1821},"[\n",{"type":395,"tag":480,"props":1823,"children":1824},{"class":482,"line":492},[1825],{"type":395,"tag":480,"props":1826,"children":1827},{},[1828],{"type":400,"value":1829},"    { type: RAW, value: '\u003Cdiv' },\n",{"type":395,"tag":480,"props":1831,"children":1832},{"class":482,"line":501},[1833],{"type":395,"tag":480,"props":1834,"children":1835},{},[1836],{"type":400,"value":1837},"    { type: RAW, value: 'class=lionad' },\n",{"type":395,"tag":480,"props":1839,"children":1840},{"class":482,"line":510},[1841],{"type":395,"tag":480,"props":1842,"children":1843},{},[1844],{"type":400,"value":1845},"    { type: RAW, value: 'data-v-xxxxxx' },\n",{"type":395,"tag":480,"props":1847,"children":1848},{"class":482,"line":519},[1849],{"type":395,"tag":480,"props":1850,"children":1851},{},[1852],{"type":400,"value":1853},"    { type: RAW, value: '>' },\n",{"type":395,"tag":480,"props":1855,"children":1856},{"class":482,"line":528},[1857],{"type":395,"tag":480,"props":1858,"children":1859},{},[1860],{"type":400,"value":1861},"]\n",{"type":395,"tag":1531,"props":1863,"children":1865},{"id":1864},"样式模板处理",[1866],{"type":400,"value":1864},{"type":395,"tag":396,"props":1868,"children":1869},{},[1870,1872,1878,1880,1886,1888,1894,1896,1902],{"type":400,"value":1871},"与 HTML Template 解析的过程类似，通过 webpack 将样式模板转交 ",{"type":395,"tag":403,"props":1873,"children":1875},{"className":1874},[],[1876],{"type":400,"value":1877},"stylePostLoader",{"type":400,"value":1879}," 进行处理，处理逻辑主要引用了 ",{"type":395,"tag":403,"props":1881,"children":1883},{"className":1882},[],[1884],{"type":400,"value":1885},"@vue/component-compiler-utils",{"type":400,"value":1887}," 中的 ",{"type":395,"tag":403,"props":1889,"children":1891},{"className":1890},[],[1892],{"type":400,"value":1893},"compileStyle",{"type":400,"value":1895}," 部分，后者对样式模板进行解析的过程中，将会对含 scoped 标记的模板引入插件 ",{"type":395,"tag":403,"props":1897,"children":1899},{"className":1898},[],[1900],{"type":400,"value":1901},"stylePlugins/scoped.js",{"type":400,"value":1903},"：",{"type":395,"tag":470,"props":1905,"children":1907},{"className":472,"code":1906,"language":474,"meta":388,"style":388},"// component-compiler-utils/compileStyle.js\nfunction doCompileStyle (options) {\n    if (scoped) {\n        plugins.push(scoped_1.default(id));\n    }\n    return { result: postcss(plugins).process(source, postCSSOptions) }\n}\n",[1908],{"type":395,"tag":403,"props":1909,"children":1910},{"__ignoreMap":388},[1911,1919,1927,1935,1943,1950,1958],{"type":395,"tag":480,"props":1912,"children":1913},{"class":482,"line":483},[1914],{"type":395,"tag":480,"props":1915,"children":1916},{},[1917],{"type":400,"value":1918},"// component-compiler-utils/compileStyle.js\n",{"type":395,"tag":480,"props":1920,"children":1921},{"class":482,"line":492},[1922],{"type":395,"tag":480,"props":1923,"children":1924},{},[1925],{"type":400,"value":1926},"function doCompileStyle (options) {\n",{"type":395,"tag":480,"props":1928,"children":1929},{"class":482,"line":501},[1930],{"type":395,"tag":480,"props":1931,"children":1932},{},[1933],{"type":400,"value":1934},"    if (scoped) {\n",{"type":395,"tag":480,"props":1936,"children":1937},{"class":482,"line":510},[1938],{"type":395,"tag":480,"props":1939,"children":1940},{},[1941],{"type":400,"value":1942},"        plugins.push(scoped_1.default(id));\n",{"type":395,"tag":480,"props":1944,"children":1945},{"class":482,"line":519},[1946],{"type":395,"tag":480,"props":1947,"children":1948},{},[1949],{"type":400,"value":1448},{"type":395,"tag":480,"props":1951,"children":1952},{"class":482,"line":528},[1953],{"type":395,"tag":480,"props":1954,"children":1955},{},[1956],{"type":400,"value":1957},"    return { result: postcss(plugins).process(source, postCSSOptions) }\n",{"type":395,"tag":480,"props":1959,"children":1960},{"class":482,"line":537},[1961],{"type":395,"tag":480,"props":1962,"children":1963},{},[1964],{"type":400,"value":962},{"type":395,"tag":396,"props":1966,"children":1967},{},[1968,1970,1976,1978,1984],{"type":400,"value":1969},"插件 ",{"type":395,"tag":403,"props":1971,"children":1973},{"className":1972},[],[1974],{"type":400,"value":1975},"scoped.js",{"type":400,"value":1977}," 将 ",{"type":395,"tag":403,"props":1979,"children":1981},{"className":1980},[],[1982],{"type":400,"value":1983},"data-v-xxxxxx",{"type":400,"value":1985}," 添加到选择器末尾的具体逻辑如下，遍历每一个选择器组合下的选择器，选择给每个组合下最后一个选择器的末尾插入：",{"type":395,"tag":470,"props":1987,"children":1989},{"className":472,"code":1988,"language":474,"meta":388,"style":388},"// component-compiler-utils/stylePlugins/scoped.js\nselectors.each((selector) => {\n    selector.each((n) => {\n        if (n.value === '::v-deep' || n.value === '>>>' || n.value === '/deep/') {\n            return false;\n        }\n    });\n    selector.insertAfter(node, selectorParser.attribute({\n        attribute: id\n    }))\n})\n",[1990],{"type":395,"tag":403,"props":1991,"children":1992},{"__ignoreMap":388},[1993,2001,2009,2017,2025,2033,2041,2049,2057,2065,2073],{"type":395,"tag":480,"props":1994,"children":1995},{"class":482,"line":483},[1996],{"type":395,"tag":480,"props":1997,"children":1998},{},[1999],{"type":400,"value":2000},"// component-compiler-utils/stylePlugins/scoped.js\n",{"type":395,"tag":480,"props":2002,"children":2003},{"class":482,"line":492},[2004],{"type":395,"tag":480,"props":2005,"children":2006},{},[2007],{"type":400,"value":2008},"selectors.each((selector) => {\n",{"type":395,"tag":480,"props":2010,"children":2011},{"class":482,"line":501},[2012],{"type":395,"tag":480,"props":2013,"children":2014},{},[2015],{"type":400,"value":2016},"    selector.each((n) => {\n",{"type":395,"tag":480,"props":2018,"children":2019},{"class":482,"line":510},[2020],{"type":395,"tag":480,"props":2021,"children":2022},{},[2023],{"type":400,"value":2024},"        if (n.value === '::v-deep' || n.value === '>>>' || n.value === '/deep/') {\n",{"type":395,"tag":480,"props":2026,"children":2027},{"class":482,"line":519},[2028],{"type":395,"tag":480,"props":2029,"children":2030},{},[2031],{"type":400,"value":2032},"            return false;\n",{"type":395,"tag":480,"props":2034,"children":2035},{"class":482,"line":528},[2036],{"type":395,"tag":480,"props":2037,"children":2038},{},[2039],{"type":400,"value":2040},"        }\n",{"type":395,"tag":480,"props":2042,"children":2043},{"class":482,"line":537},[2044],{"type":395,"tag":480,"props":2045,"children":2046},{},[2047],{"type":400,"value":2048},"    });\n",{"type":395,"tag":480,"props":2050,"children":2051},{"class":482,"line":546},[2052],{"type":395,"tag":480,"props":2053,"children":2054},{},[2055],{"type":400,"value":2056},"    selector.insertAfter(node, selectorParser.attribute({\n",{"type":395,"tag":480,"props":2058,"children":2059},{"class":482,"line":798},[2060],{"type":395,"tag":480,"props":2061,"children":2062},{},[2063],{"type":400,"value":2064},"        attribute: id\n",{"type":395,"tag":480,"props":2066,"children":2067},{"class":482,"line":807},[2068],{"type":395,"tag":480,"props":2069,"children":2070},{},[2071],{"type":400,"value":2072},"    }))\n",{"type":395,"tag":480,"props":2074,"children":2075},{"class":482,"line":816},[2076],{"type":395,"tag":480,"props":2077,"children":2078},{},[2079],{"type":400,"value":552},{"type":395,"tag":396,"props":2081,"children":2082},{},[2083,2085,2091],{"type":400,"value":2084},"题外话，通过以上代码，我们发现当循环处理到三种特定类型选择器便会终止，停止将 ",{"type":395,"tag":403,"props":2086,"children":2088},{"className":2087},[],[2089],{"type":400,"value":2090},"data-v-xxx",{"type":400,"value":2092}," 添加到选择器末尾：",{"type":395,"tag":1649,"props":2094,"children":2095},{},[2096,2107,2118],{"type":395,"tag":1194,"props":2097,"children":2098},{},[2099,2101],{"type":400,"value":2100},"伪类 ",{"type":395,"tag":403,"props":2102,"children":2104},{"className":2103},[],[2105],{"type":400,"value":2106},"::v-deep",{"type":395,"tag":1194,"props":2108,"children":2109},{},[2110,2112],{"type":400,"value":2111},"选择器 ",{"type":395,"tag":403,"props":2113,"children":2115},{"className":2114},[],[2116],{"type":400,"value":2117},">>>",{"type":395,"tag":1194,"props":2119,"children":2120},{},[2121,2122],{"type":400,"value":2111},{"type":395,"tag":403,"props":2123,"children":2125},{"className":2124},[],[2126],{"type":400,"value":2127},"/deep/",{"type":395,"tag":396,"props":2129,"children":2130},{},[2131],{"type":400,"value":2132},"我们可以利用这个特征，在组件中写样式穿透，即内部组件影响外部组件样式 (ε=ε=ε=┏(゜ロ゜;)┛ 主动样式污染)，当然这在特定的情境下是有用的，比如当我们想主动覆盖第三方 UI 组件框架的样式，却不想引入新的 CSS 文件，或不想写非 Scoped CSS 模板的时候。",{"type":395,"tag":1367,"props":2134,"children":2135},{},[2136],{"type":400,"value":2137},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":388,"searchDepth":492,"depth":492,"links":2139},[2140,2141,2142],{"id":430,"depth":492,"text":430},{"id":590,"depth":492,"text":593},{"id":1258,"depth":492,"text":1253,"children":2143},[2144,2145],{"id":1264,"depth":501,"text":1267},{"id":1347,"depth":501,"text":1347},"markdown","content:8.source-code:_js:vue2-source:4.scoped-css.md","8.source-code/_js/vue2-source/4.scoped-css.md","md",[2151,2154],{"_path":2152,"title":2153,"description":390},"/source-code/_js/vue2-source/global-api","Vue2 Global API",{"_path":2155,"title":2156,"description":390},"/source-code/_js/vue2-source/test-kit","Vue2 Test Kit",1708107586292]