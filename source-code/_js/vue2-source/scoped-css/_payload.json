[{"data":1,"prerenderedAt":2160},["Reactive",2],{"navigation":3,"/source-code/_js/vue2-source/scoped-css":386,"/source-code/_js/vue2-source/scoped-css-surround":2153},[4,32,80,96,123,129,135,369,375,381],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":42,"_path":43},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":45,"_path":46},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":48,"_path":49},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":51,"_path":52},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":54,"_path":55},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":57,"_path":58},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":60,"_path":61},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":63,"_path":64},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":66,"_path":67},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":69,"_path":70},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":72,"_path":73},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":75,"_path":76},"🚝 四十二篇系列","/articles/fourty-two",{"title":78,"_path":79},"📝 技术博客归档","/articles/fold",{"title":81,"_path":82,"children":83},"造物 / Make","/tools",[84,87,90,93],{"title":85,"_path":86},"🌐 AnySort","/tools/anysort",{"title":88,"_path":89},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":91,"_path":92},"👓 Crapto","/tools/crypto-inline",{"title":94,"_path":95},"🖨️ any-to-base64","/tools/any-to-base64",{"title":97,"_path":98,"children":99},"吉他剧场 / Music","/music",[100,102,105,108,111,114,117,120],{"title":101,"_path":98},"🎸 FingerStyle！",{"title":103,"_path":104},"🌬️ 等待的风","/music/wind",{"title":106,"_path":107},"💕 约定的海洋","/music/ocean",{"title":109,"_path":110},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":112,"_path":113},"🌏 残酷天使的行动纲领","/music/eva",{"title":115,"_path":116},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":118,"_path":119},"🍷 Wu Wei","/music/wu-wei",{"title":121,"_path":122},"🌅 无题","/music/untitled",{"title":124,"_path":125,"children":126},"画点什么 / Paint","/paint",[127],{"title":128,"_path":125},"🚧 正在施工",{"title":130,"_path":131,"children":132},"知识地图 / Maps","/maps",[133],{"title":134,"_path":131},"🏁 知识地图",{"title":136,"_path":137,"children":138},"零散的笔记 / Gists","/gists",[139,141,144,147,150,153,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366],{"title":140,"_path":137},"🧊 Gists",{"title":142,"_path":143},"网站的可访问性","/gists/accessibility",{"title":145,"_path":146},"Bit","/gists/bit",{"title":148,"_path":149},"图片模糊","/gists/blur",{"title":151,"_path":152},"渲染相关笔记","/gists/c4d",{"title":154,"_path":155},"CDN 问题记录","/gists/cdn",{"title":157,"_path":158},"消毒剂","/gists/cleaner",{"title":160,"_path":161},"Windows Command","/gists/cmd",{"title":163,"_path":164},"Command","/gists/command",{"title":166,"_path":167},"复杂科学","/gists/complexity-science",{"title":169,"_path":170},"宇宙","/gists/cosmos",{"title":172,"_path":173},"C++","/gists/cpp",{"title":175,"_path":176},"Data Structure","/gists/data-structure",{"title":178,"_path":179},"DEPRESSION","/gists/depression",{"title":181,"_path":182},"设计模式","/gists/design-patterns",{"title":184,"_path":185},"Developer Experience","/gists/developer-experience",{"title":187,"_path":188},"Device Metrics","/gists/device-metrix",{"title":190,"_path":191},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":193,"_path":194},"正则表达式","/gists/eegex",{"title":196,"_path":197},"Emoji","/gists/emoji",{"title":199,"_path":200},"工程","/gists/engineering",{"title":202,"_path":203},"熵","/gists/entropy",{"title":205,"_path":206},"Environment","/gists/environment",{"title":208,"_path":209},"Erlang","/gists/erlang",{"title":211,"_path":212},"逃离塔克夫","/gists/escape-from-tarkov",{"title":214,"_path":215},"ESNext (ES6-ES11)","/gists/esnext",{"title":217,"_path":218},"Eval！","/gists/eval",{"title":220,"_path":221},"Flutter","/gists/flutter",{"title":223,"_path":224},"字体","/gists/font",{"title":226,"_path":227},"JS 函数式编程","/gists/functional",{"title":229,"_path":230},"Google C++ Standard","/gists/google-cpp-standard",{"title":232,"_path":233},"双向链接完全体","/gists/graph",{"title":235,"_path":236},"Hardwares","/gists/hardwares",{"title":238,"_path":239},"哈希冲突","/gists/hash-collision",{"title":241,"_path":242},"信息设计","/gists/information-design",{"title":244,"_path":245},"InstantPage","/gists/instant.page",{"title":247,"_path":248},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":250,"_path":251},"KVStore","/gists/key-value-db",{"title":253,"_path":254},"Kubernetes","/gists/kubernetes",{"title":256,"_path":257},"Makefile","/gists/makefile",{"title":259,"_path":260},"Markdown Inline Style","/gists/markdown-nice",{"title":262,"_path":263},"小程序","/gists/miniapp",{"title":265,"_path":266},"减小页面快照体积","/gists/minify-html",{"title":268,"_path":269},"mklink","/gists/mklink",{"title":271,"_path":272},"Mock","/gists/mock",{"title":274,"_path":275},"多端应用","/gists/multy-end-app",{"title":277,"_path":278},"神经科学","/gists/neuroscience",{"title":280,"_path":281},"OO","/gists/oo",{"title":283,"_path":284},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":286,"_path":287},"人物","/gists/person",{"title":289,"_path":290},"PInvoke","/gists/pinvoke",{"title":292,"_path":293},"像素","/gists/pixel",{"title":295,"_path":296},"PowerShell","/gists/powershell",{"title":298,"_path":299},"量子","/gists/quantum",{"title":301,"_path":302},"保持好奇心","/gists/questions",{"title":304,"_path":305},"React Native","/gists/react-native",{"title":307,"_path":308},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":310,"_path":311},"SEO","/gists/seo",{"title":313,"_path":314},"Shader","/gists/shader",{"title":316,"_path":317},"Shape Up","/gists/shape-up",{"title":319,"_path":320},"睡觉","/gists/sleep",{"title":322,"_path":323},"States","/gists/states",{"title":325,"_path":326},"Storage","/gists/storage",{"title":328,"_path":329},"音视频流处理","/gists/stream-cli",{"title":331,"_path":332},"Symbol","/gists/symbol",{"title":334,"_path":335},"系统论","/gists/systems-theory",{"title":337,"_path":338},"Taro","/gists/taro",{"title":340,"_path":341},"任务切片","/gists/task-slice",{"title":343,"_path":344},"技术偏好","/gists/tech-dudge",{"title":346,"_path":347},"Untitled","/gists/untitled",{"title":349,"_path":350},"可变字体","/gists/variable-font",{"title":352,"_path":353},"视觉错觉","/gists/visual-illusion",{"title":355,"_path":356},"SS(SSR)","/gists/vpn",{"title":358,"_path":359},"VS Code 插件开发","/gists/vscode-plugin",{"title":361,"_path":362},"Web Components","/gists/web-components",{"title":364,"_path":365},"Windows","/gists/windows",{"title":367,"_path":368},"查缺补漏","/gists/wrong",{"title":370,"_path":371,"children":372},"代码笔记 / Gists","/source-code",[373],{"title":374,"_path":371},"🚄 代码笔记",{"title":376,"_path":377,"children":378},"我 / Abount","/hire",[379],{"title":380,"_path":377},"📬 技术简历",{"title":382,"_path":383,"children":384},"todo","/todo",[385],{"title":382,"_path":383},{"_path":387,"_dir":388,"_draft":389,"_partial":390,"_locale":391,"title":392,"description":393,"body":394,"_type":2149,"_id":2150,"_source":1004,"_file":2151,"_extension":2152},"/source-code/_js/vue2-source/scoped-css","vue2-source",false,true,"","Vue2 Scoped CSS","deprecated warning",{"type":395,"children":396,"toc":2141},"root",[397,430,436,472,556,577,586,591,597,618,1180,1192,1246,1259,1264,1271,1292,1348,1353,1381,1459,1479,1533,1540,1568,1630,1651,1670,1675,1714,1719,1797,1810,1865,1870,1907,1968,1989,2083,2096,2131,2136],{"type":398,"tag":399,"props":400,"children":401},"element","p",{},[402,405,412,414,420,422,428],{"type":403,"value":404},"text","使用 VueJS 开发应用离不开模块拆分，即将大块界面拆解为组件的过程。我们可以很方便的在单文件中使用",{"type":398,"tag":406,"props":407,"children":409},"code",{"className":408},[],[410],{"type":403,"value":411},"\u003Ctemplate>",{"type":403,"value":413},"块维护组件的视图，使用",{"type":398,"tag":406,"props":415,"children":417},{"className":416},[],[418],{"type":403,"value":419},"\u003Cscript>",{"type":403,"value":421},"维护组件的逻辑部分，使用",{"type":398,"tag":406,"props":423,"children":425},{"className":424},[],[426],{"type":403,"value":427},"\u003Cstyle>",{"type":403,"value":429},"维护组件的样式。在我们编写 VueJS 组件样式时，不得忽略的一点就是如何防止以及反制样式污染。",{"type":398,"tag":431,"props":432,"children":434},"h2",{"id":433},"样式污染产生原因",[435],{"type":403,"value":433},{"type":398,"tag":399,"props":437,"children":438},{},[439,441,447,449,455,457,470],{"type":403,"value":440},"提及样式污染，主要要追溯到",{"type":398,"tag":406,"props":442,"children":444},{"className":443},[],[445],{"type":403,"value":446},"webpack",{"type":403,"value":448},"对",{"type":398,"tag":406,"props":450,"children":452},{"className":451},[],[453],{"type":403,"value":454},"CSS",{"type":403,"value":456},"文件的打包过程，这里我们以",{"type":398,"tag":458,"props":459,"children":463},"a",{"href":460,"rel":461},"https://github.com/PanJiaChen/vue-element-admin",[462],"nofollow",[464],{"type":398,"tag":406,"props":465,"children":467},{"className":466},[],[468],{"type":403,"value":469},"Vue-Element-Admin",{"type":403,"value":471},"中的 webpack 配置项举例：",{"type":398,"tag":473,"props":474,"children":478},"pre",{"className":475,"code":476,"language":477,"meta":391,"style":391},"language-JS shiki shiki-themes material-theme-lighter github-light github-dark monokai","const webpackConfig = merge(baseWebpackConfig, {\n    plugins: [\n        new MiniCssExtractPlugin({\n          filename: utils.assetsPath('css/[name].[contenthash:8].css'),\n          chunkFilename: utils.assetsPath('css/[name].[contenthash:8].css')\n        }),\n    ]\n})\n","JS",[479],{"type":398,"tag":406,"props":480,"children":481},{"__ignoreMap":391},[482,493,502,511,520,529,538,547],{"type":398,"tag":483,"props":484,"children":487},"span",{"class":485,"line":486},"line",1,[488],{"type":398,"tag":483,"props":489,"children":490},{},[491],{"type":403,"value":492},"const webpackConfig = merge(baseWebpackConfig, {\n",{"type":398,"tag":483,"props":494,"children":496},{"class":485,"line":495},2,[497],{"type":398,"tag":483,"props":498,"children":499},{},[500],{"type":403,"value":501},"    plugins: [\n",{"type":398,"tag":483,"props":503,"children":505},{"class":485,"line":504},3,[506],{"type":398,"tag":483,"props":507,"children":508},{},[509],{"type":403,"value":510},"        new MiniCssExtractPlugin({\n",{"type":398,"tag":483,"props":512,"children":514},{"class":485,"line":513},4,[515],{"type":398,"tag":483,"props":516,"children":517},{},[518],{"type":403,"value":519},"          filename: utils.assetsPath('css/[name].[contenthash:8].css'),\n",{"type":398,"tag":483,"props":521,"children":523},{"class":485,"line":522},5,[524],{"type":398,"tag":483,"props":525,"children":526},{},[527],{"type":403,"value":528},"          chunkFilename: utils.assetsPath('css/[name].[contenthash:8].css')\n",{"type":398,"tag":483,"props":530,"children":532},{"class":485,"line":531},6,[533],{"type":398,"tag":483,"props":534,"children":535},{},[536],{"type":403,"value":537},"        }),\n",{"type":398,"tag":483,"props":539,"children":541},{"class":485,"line":540},7,[542],{"type":398,"tag":483,"props":543,"children":544},{},[545],{"type":403,"value":546},"    ]\n",{"type":398,"tag":483,"props":548,"children":550},{"class":485,"line":549},8,[551],{"type":398,"tag":483,"props":552,"children":553},{},[554],{"type":403,"value":555},"})\n",{"type":398,"tag":399,"props":557,"children":558},{},[559,561,567,569,575],{"type":403,"value":560},"webpack 使用 ",{"type":398,"tag":406,"props":562,"children":564},{"className":563},[],[565],{"type":403,"value":566},"MiniCssExtractPlugin",{"type":403,"value":568}," 插件，将文件(如 Vue 单文件组件)中的 CSS 代码，经过处理后，分离到形如",{"type":398,"tag":406,"props":570,"children":572},{"className":571},[],[573],{"type":403,"value":574},"app.hash1234.css",{"type":403,"value":576},"的单独的 CSS 文件：",{"type":398,"tag":399,"props":578,"children":579},{},[580],{"type":398,"tag":581,"props":582,"children":585},"img",{"alt":583,"src":584},"单独的CSS文件","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/scoped-css/browser_fYMdZDAMsI.png",[],{"type":398,"tag":399,"props":587,"children":588},{},[589],{"type":403,"value":590},"如果没有加入防止样式污染的措施的同时，项目中存在了大量的同名 ClassName，那么可能会产生意想不到的 CSS 选择器权重覆盖。这可能使后文件中某部分选择器权重更高的类影响整个应用，而此过程通常发生在组件的编写中，所以一般称之为组件样式污染。",{"type":398,"tag":431,"props":592,"children":594},{"id":593},"webpack-vue-sfc-object",[595],{"type":403,"value":596},"webpack & Vue SFC Object",{"type":398,"tag":399,"props":598,"children":599},{},[600,602,608,610,616],{"type":403,"value":601},"对于 Vue 项目而言，使用 webpack 将极大的优化了工作流程，因为通过",{"type":398,"tag":406,"props":603,"children":605},{"className":604},[],[606],{"type":403,"value":607},"Vue Loader",{"type":403,"value":609},"，Vue 单文件组件能很好的融合进 webpack 工作流中。我们写的单文件组件都被处理为了",{"type":398,"tag":406,"props":611,"children":613},{"className":612},[],[614],{"type":403,"value":615},"SFC对象",{"type":403,"value":617},"，即包含了单个 HTML 模块，单个脚本模块，一个或多个样式模块，一个或多个自定义模块的对象：",{"type":398,"tag":473,"props":619,"children":623},{"className":620,"code":621,"language":622,"meta":391,"style":391},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","// vue-loader/index.js\nconst descriptor = parse({\n  source,\n  compiler: options.compiler || loadTemplateCompiler(),\n  filename,\n  sourceRoot,\n  needMap: sourceMap,\n});\n\n// vuejs/component-compiler-utils/index.js\nfunction parse(options) {\n  const { compiler } = options;\n  output = compiler.parseComponent(source, compilerParseOptions);\n  return output;\n}\n\n// vue.js\nfunction parseComponent(content, options) {\n  // ...\n  var sfc = {\n    template: null,\n    script: null,\n    styles: [],\n    customBlocks: [],\n  };\n  // ...\n  return sfc;\n}\n","js",[624],{"type":398,"tag":406,"props":625,"children":626},{"__ignoreMap":391},[627,636,675,688,736,748,760,781,799,808,817,849,885,938,957,966,974,983,1021,1030,1052,1075,1096,1118,1139,1148,1156,1172],{"type":398,"tag":483,"props":628,"children":629},{"class":485,"line":486},[630],{"type":398,"tag":483,"props":631,"children":633},{"style":632},"--shiki-light:#90A4AE;--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[634],{"type":403,"value":635},"// vue-loader/index.js\n",{"type":398,"tag":483,"props":637,"children":638},{"class":485,"line":495},[639,645,651,657,663,669],{"type":398,"tag":483,"props":640,"children":642},{"style":641},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-light-font-style:inherit;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[643],{"type":403,"value":644},"const",{"type":398,"tag":483,"props":646,"children":648},{"style":647},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[649],{"type":403,"value":650}," descriptor",{"type":398,"tag":483,"props":652,"children":654},{"style":653},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[655],{"type":403,"value":656}," =",{"type":398,"tag":483,"props":658,"children":660},{"style":659},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[661],{"type":403,"value":662}," parse",{"type":398,"tag":483,"props":664,"children":666},{"style":665},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[667],{"type":403,"value":668},"(",{"type":398,"tag":483,"props":670,"children":672},{"style":671},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[673],{"type":403,"value":674},"{\n",{"type":398,"tag":483,"props":676,"children":677},{"class":485,"line":504},[678,683],{"type":398,"tag":483,"props":679,"children":680},{"style":665},[681],{"type":403,"value":682},"  source",{"type":398,"tag":483,"props":684,"children":685},{"style":671},[686],{"type":403,"value":687},",\n",{"type":398,"tag":483,"props":689,"children":690},{"class":485,"line":513},[691,697,702,707,712,717,722,727,732],{"type":398,"tag":483,"props":692,"children":694},{"style":693},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[695],{"type":403,"value":696},"  compiler",{"type":398,"tag":483,"props":698,"children":699},{"style":671},[700],{"type":403,"value":701},":",{"type":398,"tag":483,"props":703,"children":704},{"style":665},[705],{"type":403,"value":706}," options",{"type":398,"tag":483,"props":708,"children":709},{"style":671},[710],{"type":403,"value":711},".",{"type":398,"tag":483,"props":713,"children":714},{"style":665},[715],{"type":403,"value":716},"compiler ",{"type":398,"tag":483,"props":718,"children":719},{"style":653},[720],{"type":403,"value":721},"||",{"type":398,"tag":483,"props":723,"children":724},{"style":659},[725],{"type":403,"value":726}," loadTemplateCompiler",{"type":398,"tag":483,"props":728,"children":729},{"style":665},[730],{"type":403,"value":731},"()",{"type":398,"tag":483,"props":733,"children":734},{"style":671},[735],{"type":403,"value":687},{"type":398,"tag":483,"props":737,"children":738},{"class":485,"line":522},[739,744],{"type":398,"tag":483,"props":740,"children":741},{"style":665},[742],{"type":403,"value":743},"  filename",{"type":398,"tag":483,"props":745,"children":746},{"style":671},[747],{"type":403,"value":687},{"type":398,"tag":483,"props":749,"children":750},{"class":485,"line":531},[751,756],{"type":398,"tag":483,"props":752,"children":753},{"style":665},[754],{"type":403,"value":755},"  sourceRoot",{"type":398,"tag":483,"props":757,"children":758},{"style":671},[759],{"type":403,"value":687},{"type":398,"tag":483,"props":761,"children":762},{"class":485,"line":540},[763,768,772,777],{"type":398,"tag":483,"props":764,"children":765},{"style":693},[766],{"type":403,"value":767},"  needMap",{"type":398,"tag":483,"props":769,"children":770},{"style":671},[771],{"type":403,"value":701},{"type":398,"tag":483,"props":773,"children":774},{"style":665},[775],{"type":403,"value":776}," sourceMap",{"type":398,"tag":483,"props":778,"children":779},{"style":671},[780],{"type":403,"value":687},{"type":398,"tag":483,"props":782,"children":783},{"class":485,"line":549},[784,789,794],{"type":398,"tag":483,"props":785,"children":786},{"style":671},[787],{"type":403,"value":788},"}",{"type":398,"tag":483,"props":790,"children":791},{"style":665},[792],{"type":403,"value":793},")",{"type":398,"tag":483,"props":795,"children":796},{"style":671},[797],{"type":403,"value":798},";\n",{"type":398,"tag":483,"props":800,"children":802},{"class":485,"line":801},9,[803],{"type":398,"tag":483,"props":804,"children":805},{"emptyLinePlaceholder":390},[806],{"type":403,"value":807},"\n",{"type":398,"tag":483,"props":809,"children":811},{"class":485,"line":810},10,[812],{"type":398,"tag":483,"props":813,"children":814},{"style":632},[815],{"type":403,"value":816},"// vuejs/component-compiler-utils/index.js\n",{"type":398,"tag":483,"props":818,"children":820},{"class":485,"line":819},11,[821,826,830,834,840,844],{"type":398,"tag":483,"props":822,"children":823},{"style":641},[824],{"type":403,"value":825},"function",{"type":398,"tag":483,"props":827,"children":828},{"style":659},[829],{"type":403,"value":662},{"type":398,"tag":483,"props":831,"children":832},{"style":671},[833],{"type":403,"value":668},{"type":398,"tag":483,"props":835,"children":837},{"style":836},"--shiki-light:#90A4AE;--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[838],{"type":403,"value":839},"options",{"type":398,"tag":483,"props":841,"children":842},{"style":671},[843],{"type":403,"value":793},{"type":398,"tag":483,"props":845,"children":846},{"style":671},[847],{"type":403,"value":848}," {\n",{"type":398,"tag":483,"props":850,"children":852},{"class":485,"line":851},12,[853,858,863,868,873,877,881],{"type":398,"tag":483,"props":854,"children":855},{"style":641},[856],{"type":403,"value":857},"  const",{"type":398,"tag":483,"props":859,"children":860},{"style":671},[861],{"type":403,"value":862}," {",{"type":398,"tag":483,"props":864,"children":865},{"style":647},[866],{"type":403,"value":867}," compiler",{"type":398,"tag":483,"props":869,"children":870},{"style":671},[871],{"type":403,"value":872}," }",{"type":398,"tag":483,"props":874,"children":875},{"style":653},[876],{"type":403,"value":656},{"type":398,"tag":483,"props":878,"children":879},{"style":665},[880],{"type":403,"value":706},{"type":398,"tag":483,"props":882,"children":883},{"style":671},[884],{"type":403,"value":798},{"type":398,"tag":483,"props":886,"children":888},{"class":485,"line":887},13,[889,894,898,902,906,911,915,920,925,930,934],{"type":398,"tag":483,"props":890,"children":891},{"style":665},[892],{"type":403,"value":893},"  output",{"type":398,"tag":483,"props":895,"children":896},{"style":653},[897],{"type":403,"value":656},{"type":398,"tag":483,"props":899,"children":900},{"style":665},[901],{"type":403,"value":867},{"type":398,"tag":483,"props":903,"children":904},{"style":671},[905],{"type":403,"value":711},{"type":398,"tag":483,"props":907,"children":908},{"style":659},[909],{"type":403,"value":910},"parseComponent",{"type":398,"tag":483,"props":912,"children":913},{"style":693},[914],{"type":403,"value":668},{"type":398,"tag":483,"props":916,"children":917},{"style":665},[918],{"type":403,"value":919},"source",{"type":398,"tag":483,"props":921,"children":922},{"style":671},[923],{"type":403,"value":924},",",{"type":398,"tag":483,"props":926,"children":927},{"style":665},[928],{"type":403,"value":929}," compilerParseOptions",{"type":398,"tag":483,"props":931,"children":932},{"style":693},[933],{"type":403,"value":793},{"type":398,"tag":483,"props":935,"children":936},{"style":671},[937],{"type":403,"value":798},{"type":398,"tag":483,"props":939,"children":941},{"class":485,"line":940},14,[942,948,953],{"type":398,"tag":483,"props":943,"children":945},{"style":944},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[946],{"type":403,"value":947},"  return",{"type":398,"tag":483,"props":949,"children":950},{"style":665},[951],{"type":403,"value":952}," output",{"type":398,"tag":483,"props":954,"children":955},{"style":671},[956],{"type":403,"value":798},{"type":398,"tag":483,"props":958,"children":960},{"class":485,"line":959},15,[961],{"type":398,"tag":483,"props":962,"children":963},{"style":671},[964],{"type":403,"value":965},"}\n",{"type":398,"tag":483,"props":967,"children":969},{"class":485,"line":968},16,[970],{"type":398,"tag":483,"props":971,"children":972},{"emptyLinePlaceholder":390},[973],{"type":403,"value":807},{"type":398,"tag":483,"props":975,"children":977},{"class":485,"line":976},17,[978],{"type":398,"tag":483,"props":979,"children":980},{"style":632},[981],{"type":403,"value":982},"// vue.js\n",{"type":398,"tag":483,"props":984,"children":986},{"class":485,"line":985},18,[987,991,996,1000,1005,1009,1013,1017],{"type":398,"tag":483,"props":988,"children":989},{"style":641},[990],{"type":403,"value":825},{"type":398,"tag":483,"props":992,"children":993},{"style":659},[994],{"type":403,"value":995}," parseComponent",{"type":398,"tag":483,"props":997,"children":998},{"style":671},[999],{"type":403,"value":668},{"type":398,"tag":483,"props":1001,"children":1002},{"style":836},[1003],{"type":403,"value":1004},"content",{"type":398,"tag":483,"props":1006,"children":1007},{"style":671},[1008],{"type":403,"value":924},{"type":398,"tag":483,"props":1010,"children":1011},{"style":836},[1012],{"type":403,"value":706},{"type":398,"tag":483,"props":1014,"children":1015},{"style":671},[1016],{"type":403,"value":793},{"type":398,"tag":483,"props":1018,"children":1019},{"style":671},[1020],{"type":403,"value":848},{"type":398,"tag":483,"props":1022,"children":1024},{"class":485,"line":1023},19,[1025],{"type":398,"tag":483,"props":1026,"children":1027},{"style":632},[1028],{"type":403,"value":1029},"  // ...\n",{"type":398,"tag":483,"props":1031,"children":1033},{"class":485,"line":1032},20,[1034,1039,1044,1048],{"type":398,"tag":483,"props":1035,"children":1036},{"style":641},[1037],{"type":403,"value":1038},"  var",{"type":398,"tag":483,"props":1040,"children":1041},{"style":665},[1042],{"type":403,"value":1043}," sfc",{"type":398,"tag":483,"props":1045,"children":1046},{"style":653},[1047],{"type":403,"value":656},{"type":398,"tag":483,"props":1049,"children":1050},{"style":671},[1051],{"type":403,"value":848},{"type":398,"tag":483,"props":1053,"children":1055},{"class":485,"line":1054},21,[1056,1061,1065,1071],{"type":398,"tag":483,"props":1057,"children":1058},{"style":693},[1059],{"type":403,"value":1060},"    template",{"type":398,"tag":483,"props":1062,"children":1063},{"style":671},[1064],{"type":403,"value":701},{"type":398,"tag":483,"props":1066,"children":1068},{"style":1067},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1069],{"type":403,"value":1070}," null",{"type":398,"tag":483,"props":1072,"children":1073},{"style":671},[1074],{"type":403,"value":687},{"type":398,"tag":483,"props":1076,"children":1078},{"class":485,"line":1077},22,[1079,1084,1088,1092],{"type":398,"tag":483,"props":1080,"children":1081},{"style":693},[1082],{"type":403,"value":1083},"    script",{"type":398,"tag":483,"props":1085,"children":1086},{"style":671},[1087],{"type":403,"value":701},{"type":398,"tag":483,"props":1089,"children":1090},{"style":1067},[1091],{"type":403,"value":1070},{"type":398,"tag":483,"props":1093,"children":1094},{"style":671},[1095],{"type":403,"value":687},{"type":398,"tag":483,"props":1097,"children":1099},{"class":485,"line":1098},23,[1100,1105,1109,1114],{"type":398,"tag":483,"props":1101,"children":1102},{"style":693},[1103],{"type":403,"value":1104},"    styles",{"type":398,"tag":483,"props":1106,"children":1107},{"style":671},[1108],{"type":403,"value":701},{"type":398,"tag":483,"props":1110,"children":1111},{"style":693},[1112],{"type":403,"value":1113}," []",{"type":398,"tag":483,"props":1115,"children":1116},{"style":671},[1117],{"type":403,"value":687},{"type":398,"tag":483,"props":1119,"children":1121},{"class":485,"line":1120},24,[1122,1127,1131,1135],{"type":398,"tag":483,"props":1123,"children":1124},{"style":693},[1125],{"type":403,"value":1126},"    customBlocks",{"type":398,"tag":483,"props":1128,"children":1129},{"style":671},[1130],{"type":403,"value":701},{"type":398,"tag":483,"props":1132,"children":1133},{"style":693},[1134],{"type":403,"value":1113},{"type":398,"tag":483,"props":1136,"children":1137},{"style":671},[1138],{"type":403,"value":687},{"type":398,"tag":483,"props":1140,"children":1142},{"class":485,"line":1141},25,[1143],{"type":398,"tag":483,"props":1144,"children":1145},{"style":671},[1146],{"type":403,"value":1147},"  };\n",{"type":398,"tag":483,"props":1149,"children":1151},{"class":485,"line":1150},26,[1152],{"type":398,"tag":483,"props":1153,"children":1154},{"style":632},[1155],{"type":403,"value":1029},{"type":398,"tag":483,"props":1157,"children":1159},{"class":485,"line":1158},27,[1160,1164,1168],{"type":398,"tag":483,"props":1161,"children":1162},{"style":944},[1163],{"type":403,"value":947},{"type":398,"tag":483,"props":1165,"children":1166},{"style":665},[1167],{"type":403,"value":1043},{"type":398,"tag":483,"props":1169,"children":1170},{"style":671},[1171],{"type":403,"value":798},{"type":398,"tag":483,"props":1173,"children":1175},{"class":485,"line":1174},28,[1176],{"type":398,"tag":483,"props":1177,"children":1178},{"style":671},[1179],{"type":403,"value":965},{"type":398,"tag":399,"props":1181,"children":1182},{},[1183,1185,1190],{"type":403,"value":1184},"我们可以将 SFC 结构融合到",{"type":398,"tag":406,"props":1186,"children":1188},{"className":1187},[],[1189],{"type":403,"value":446},{"type":403,"value":1191},"进行开发的过程成中，主要有这几点影响：",{"type":398,"tag":1193,"props":1194,"children":1195},"ul",{},[1196,1217,1236,1241],{"type":398,"tag":1197,"props":1198,"children":1199},"li",{},[1200,1202,1207,1209,1215],{"type":403,"value":1201},"允许为 Vue 组件的每个部分使用其它的 webpack loader，例如在",{"type":398,"tag":406,"props":1203,"children":1205},{"className":1204},[],[1206],{"type":403,"value":427},{"type":403,"value":1208},"的部分使用 Sass Loader ，在 ",{"type":398,"tag":406,"props":1210,"children":1212},{"className":1211},[],[1213],{"type":403,"value":1214},"\u003CcustomBlocks>",{"type":403,"value":1216},"的部分使用自定义 Loader",{"type":398,"tag":1197,"props":1218,"children":1219},{},[1220,1222,1227,1229,1234],{"type":403,"value":1221},"使用 webpack loader 将 ",{"type":398,"tag":406,"props":1223,"children":1225},{"className":1224},[],[1226],{"type":403,"value":427},{"type":403,"value":1228},"和 ",{"type":398,"tag":406,"props":1230,"children":1232},{"className":1231},[],[1233],{"type":403,"value":411},{"type":403,"value":1235}," 中引用的资源当作模块依赖来处理",{"type":398,"tag":1197,"props":1237,"children":1238},{},[1239],{"type":403,"value":1240},"模拟 Scoped CSS",{"type":398,"tag":1197,"props":1242,"children":1243},{},[1244],{"type":403,"value":1245},"在开发过程中使用热重载来保持状态",{"type":398,"tag":399,"props":1247,"children":1248},{},[1249,1251,1257],{"type":403,"value":1250},"以下主要介绍",{"type":398,"tag":406,"props":1252,"children":1254},{"className":1253},[],[1255],{"type":403,"value":1256},"Scoped CSS",{"type":403,"value":1258},"的原理。",{"type":398,"tag":431,"props":1260,"children":1262},{"id":1261},"scoped-css",[1263],{"type":403,"value":1256},{"type":398,"tag":1265,"props":1266,"children":1268},"h3",{"id":1267},"大白话版本之-scoped-css-原理",[1269],{"type":403,"value":1270},"大白话版本之 Scoped CSS 原理",{"type":398,"tag":399,"props":1272,"children":1273},{},[1274,1276,1282,1284,1290],{"type":403,"value":1275},"通过 webpack 调用 VueJS 中相应 Loader，给组件 HTML 模板添加自定义属性 (Attribute) ",{"type":398,"tag":406,"props":1277,"children":1279},{"className":1278},[],[1280],{"type":403,"value":1281},"data-v-x",{"type":403,"value":1283},"，以及给组件内 CSS 选择器添加对应的属性选择器 (Attribute Selector) ",{"type":398,"tag":406,"props":1285,"children":1287},{"className":1286},[],[1288],{"type":403,"value":1289},"[data-v-x]",{"type":403,"value":1291},"，达到组件内样式只能生效与组件内 HTML 的效果，代码效果如下：",{"type":398,"tag":473,"props":1293,"children":1297},{"className":1294,"code":1295,"language":1296,"meta":391,"style":391},"language-HTML shiki shiki-themes material-theme-lighter github-light github-dark monokai","\u003Cdiv class='lionad' data-v-lionad>\u003C/div>\n\u003Cstyle>\n.lionad[data-v-lionad] {\n  background: @tiger-orange;\n}\n\u003C/style>\n","HTML",[1298],{"type":398,"tag":406,"props":1299,"children":1300},{"__ignoreMap":391},[1301,1309,1317,1325,1333,1340],{"type":398,"tag":483,"props":1302,"children":1303},{"class":485,"line":486},[1304],{"type":398,"tag":483,"props":1305,"children":1306},{},[1307],{"type":403,"value":1308},"\u003Cdiv class='lionad' data-v-lionad>\u003C/div>\n",{"type":398,"tag":483,"props":1310,"children":1311},{"class":485,"line":495},[1312],{"type":398,"tag":483,"props":1313,"children":1314},{},[1315],{"type":403,"value":1316},"\u003Cstyle>\n",{"type":398,"tag":483,"props":1318,"children":1319},{"class":485,"line":504},[1320],{"type":398,"tag":483,"props":1321,"children":1322},{},[1323],{"type":403,"value":1324},".lionad[data-v-lionad] {\n",{"type":398,"tag":483,"props":1326,"children":1327},{"class":485,"line":513},[1328],{"type":398,"tag":483,"props":1329,"children":1330},{},[1331],{"type":403,"value":1332},"  background: @tiger-orange;\n",{"type":398,"tag":483,"props":1334,"children":1335},{"class":485,"line":522},[1336],{"type":398,"tag":483,"props":1337,"children":1338},{},[1339],{"type":403,"value":965},{"type":398,"tag":483,"props":1341,"children":1342},{"class":485,"line":531},[1343],{"type":398,"tag":483,"props":1344,"children":1345},{},[1346],{"type":403,"value":1347},"\u003C/style>\n",{"type":398,"tag":1265,"props":1349,"children":1351},{"id":1350},"源码跟踪",[1352],{"type":403,"value":1350},{"type":398,"tag":399,"props":1354,"children":1355},{},[1356,1358,1363,1365,1371,1373,1379],{"type":403,"value":1357},"webpack 使用其它 CSS Loader 处理 VueJS 中对应 CSS 代码之前，",{"type":398,"tag":406,"props":1359,"children":1361},{"className":1360},[],[1362],{"type":403,"value":607},{"type":403,"value":1364}," 已经替我们做了一层简单的处理，如果组件中 ",{"type":398,"tag":406,"props":1366,"children":1368},{"className":1367},[],[1369],{"type":403,"value":1370},"style",{"type":403,"value":1372}," 块包含了 ",{"type":398,"tag":406,"props":1374,"children":1376},{"className":1375},[],[1377],{"type":403,"value":1378},"scoped",{"type":403,"value":1380}," 属性：",{"type":398,"tag":473,"props":1382,"children":1384},{"className":1294,"code":1383,"language":1296,"meta":391,"style":391},"\u003C!-- 某个VueJS组件中 -->\n\u003Ctemplate>\n    \u003Cdiv class='lionad'>\u003C/div>\n\u003C/template>\n\u003Cstyle lang=\"scss\" scoped>\n    .lionad {\n        background: @tiger-orange;\n    }\n\u003C/style>\n",[1385],{"type":398,"tag":406,"props":1386,"children":1387},{"__ignoreMap":391},[1388,1396,1404,1412,1420,1428,1436,1444,1452],{"type":398,"tag":483,"props":1389,"children":1390},{"class":485,"line":486},[1391],{"type":398,"tag":483,"props":1392,"children":1393},{},[1394],{"type":403,"value":1395},"\u003C!-- 某个VueJS组件中 -->\n",{"type":398,"tag":483,"props":1397,"children":1398},{"class":485,"line":495},[1399],{"type":398,"tag":483,"props":1400,"children":1401},{},[1402],{"type":403,"value":1403},"\u003Ctemplate>\n",{"type":398,"tag":483,"props":1405,"children":1406},{"class":485,"line":504},[1407],{"type":398,"tag":483,"props":1408,"children":1409},{},[1410],{"type":403,"value":1411},"    \u003Cdiv class='lionad'>\u003C/div>\n",{"type":398,"tag":483,"props":1413,"children":1414},{"class":485,"line":513},[1415],{"type":398,"tag":483,"props":1416,"children":1417},{},[1418],{"type":403,"value":1419},"\u003C/template>\n",{"type":398,"tag":483,"props":1421,"children":1422},{"class":485,"line":522},[1423],{"type":398,"tag":483,"props":1424,"children":1425},{},[1426],{"type":403,"value":1427},"\u003Cstyle lang=\"scss\" scoped>\n",{"type":398,"tag":483,"props":1429,"children":1430},{"class":485,"line":531},[1431],{"type":398,"tag":483,"props":1432,"children":1433},{},[1434],{"type":403,"value":1435},"    .lionad {\n",{"type":398,"tag":483,"props":1437,"children":1438},{"class":485,"line":540},[1439],{"type":398,"tag":483,"props":1440,"children":1441},{},[1442],{"type":403,"value":1443},"        background: @tiger-orange;\n",{"type":398,"tag":483,"props":1445,"children":1446},{"class":485,"line":549},[1447],{"type":398,"tag":483,"props":1448,"children":1449},{},[1450],{"type":403,"value":1451},"    }\n",{"type":398,"tag":483,"props":1453,"children":1454},{"class":485,"line":801},[1455],{"type":398,"tag":483,"props":1456,"children":1457},{},[1458],{"type":403,"value":1347},{"type":398,"tag":399,"props":1460,"children":1461},{},[1462,1464,1470,1472,1477],{"type":403,"value":1463},"下代码即判断当前",{"type":398,"tag":406,"props":1465,"children":1467},{"className":1466},[],[1468],{"type":403,"value":1469},"SFC",{"type":403,"value":1471},"对象样式块中是否有",{"type":398,"tag":406,"props":1473,"children":1475},{"className":1474},[],[1476],{"type":403,"value":1378},{"type":403,"value":1478},"属性，并插入用于 query 中，顺带一提，每个单文件组件被解析后，都会生成对应组件 ID，ID 主要以生产/开发环境做区分，通过文件路径+源码或是文件路径的值作为哈希特征值的形式生成，如下：",{"type":398,"tag":473,"props":1480,"children":1482},{"className":475,"code":1481,"language":477,"meta":391,"style":391},"// vue-loader/index.js\nconst id = hash(isProduction  (shortFilePath + '\\n' + source) : shortFilePath)\nconst hasScoped = descriptor.styles.some(s => s.scoped)\nconst query = `? vue&type=template${idQuery}${scopedQuery}`\nconst request = templateRequest = stringifyRequest(src + query)\ntemplateImport = `import { render, staticRenderFns } from ${request}`\n",[1483],{"type":398,"tag":406,"props":1484,"children":1485},{"__ignoreMap":391},[1486,1493,1501,1509,1517,1525],{"type":398,"tag":483,"props":1487,"children":1488},{"class":485,"line":486},[1489],{"type":398,"tag":483,"props":1490,"children":1491},{},[1492],{"type":403,"value":635},{"type":398,"tag":483,"props":1494,"children":1495},{"class":485,"line":495},[1496],{"type":398,"tag":483,"props":1497,"children":1498},{},[1499],{"type":403,"value":1500},"const id = hash(isProduction  (shortFilePath + '\\n' + source) : shortFilePath)\n",{"type":398,"tag":483,"props":1502,"children":1503},{"class":485,"line":504},[1504],{"type":398,"tag":483,"props":1505,"children":1506},{},[1507],{"type":403,"value":1508},"const hasScoped = descriptor.styles.some(s => s.scoped)\n",{"type":398,"tag":483,"props":1510,"children":1511},{"class":485,"line":513},[1512],{"type":398,"tag":483,"props":1513,"children":1514},{},[1515],{"type":403,"value":1516},"const query = `? vue&type=template${idQuery}${scopedQuery}`\n",{"type":398,"tag":483,"props":1518,"children":1519},{"class":485,"line":522},[1520],{"type":398,"tag":483,"props":1521,"children":1522},{},[1523],{"type":403,"value":1524},"const request = templateRequest = stringifyRequest(src + query)\n",{"type":398,"tag":483,"props":1526,"children":1527},{"class":485,"line":531},[1528],{"type":398,"tag":483,"props":1529,"children":1530},{},[1531],{"type":403,"value":1532},"templateImport = `import { render, staticRenderFns } from ${request}`\n",{"type":398,"tag":1534,"props":1535,"children":1537},"h4",{"id":1536},"html-模板处理",[1538],{"type":403,"value":1539},"HTML 模板处理",{"type":398,"tag":399,"props":1541,"children":1542},{},[1543,1545,1551,1553,1558,1560,1566],{"type":403,"value":1544},"在用于处理 SFC 结构中 HTML 模板的 ",{"type":398,"tag":406,"props":1546,"children":1548},{"className":1547},[],[1549],{"type":403,"value":1550},"templateLoader",{"type":403,"value":1552}," 中，我们可以得知，query 中所设置的参数将合并为 loader options 经由 webpack 转交 ",{"type":398,"tag":406,"props":1554,"children":1556},{"className":1555},[],[1557],{"type":403,"value":1550},{"type":403,"value":1559}," 再转交 ",{"type":398,"tag":406,"props":1561,"children":1563},{"className":1562},[],[1564],{"type":403,"value":1565},"@vue/component-compiler-utils.compileTemplate",{"type":403,"value":1567}," 处理：",{"type":398,"tag":473,"props":1569,"children":1571},{"className":475,"code":1570,"language":477,"meta":391,"style":391},"// vue-loader/templateLoader.js\nconst query = qs.parse(this.resourceQuery)\nconst { id } = query\nconst compilerOptions = Object.assign({}, options.compilerOptions, {\n    scopeId: query.scoped ? `data-v-${id}` : null\n})\nconst compiled = compileTemplate({ compilerOptions })\n",[1572],{"type":398,"tag":406,"props":1573,"children":1574},{"__ignoreMap":391},[1575,1583,1591,1599,1607,1615,1622],{"type":398,"tag":483,"props":1576,"children":1577},{"class":485,"line":486},[1578],{"type":398,"tag":483,"props":1579,"children":1580},{},[1581],{"type":403,"value":1582},"// vue-loader/templateLoader.js\n",{"type":398,"tag":483,"props":1584,"children":1585},{"class":485,"line":495},[1586],{"type":398,"tag":483,"props":1587,"children":1588},{},[1589],{"type":403,"value":1590},"const query = qs.parse(this.resourceQuery)\n",{"type":398,"tag":483,"props":1592,"children":1593},{"class":485,"line":504},[1594],{"type":398,"tag":483,"props":1595,"children":1596},{},[1597],{"type":403,"value":1598},"const { id } = query\n",{"type":398,"tag":483,"props":1600,"children":1601},{"class":485,"line":513},[1602],{"type":398,"tag":483,"props":1603,"children":1604},{},[1605],{"type":403,"value":1606},"const compilerOptions = Object.assign({}, options.compilerOptions, {\n",{"type":398,"tag":483,"props":1608,"children":1609},{"class":485,"line":522},[1610],{"type":398,"tag":483,"props":1611,"children":1612},{},[1613],{"type":403,"value":1614},"    scopeId: query.scoped ? `data-v-${id}` : null\n",{"type":398,"tag":483,"props":1616,"children":1617},{"class":485,"line":531},[1618],{"type":398,"tag":483,"props":1619,"children":1620},{},[1621],{"type":403,"value":555},{"type":398,"tag":483,"props":1623,"children":1624},{"class":485,"line":540},[1625],{"type":398,"tag":483,"props":1626,"children":1627},{},[1628],{"type":403,"value":1629},"const compiled = compileTemplate({ compilerOptions })\n",{"type":398,"tag":399,"props":1631,"children":1632},{},[1633,1635,1641,1643,1649],{"type":403,"value":1634},"实际 ",{"type":398,"tag":406,"props":1636,"children":1638},{"className":1637},[],[1639],{"type":403,"value":1640},"compileTemplate",{"type":403,"value":1642}," 函数在处理内容时，编译函数使用的是 query 中的 compiler 或 ",{"type":398,"tag":406,"props":1644,"children":1646},{"className":1645},[],[1647],{"type":403,"value":1648},"vue-template-compiler",{"type":403,"value":1650},"，后者会将模板文本转换成为 JavaScript 渲染函数，大致如下：",{"type":398,"tag":1652,"props":1653,"children":1654},"ol",{},[1655,1660,1665],{"type":398,"tag":1197,"props":1656,"children":1657},{},[1658],{"type":403,"value":1659},"从 HTML 模版转换为 AST(虚拟语法树)",{"type":398,"tag":1197,"props":1661,"children":1662},{},[1663],{"type":403,"value":1664},"AST 优化，处理静态模版与动态模板",{"type":398,"tag":1197,"props":1666,"children":1667},{},[1668],{"type":403,"value":1669},"生成 JS 函数，用于在运行时运行时生成纯 HTML",{"type":398,"tag":399,"props":1671,"children":1672},{},[1673],{"type":403,"value":1674},"代码分别对应：",{"type":398,"tag":473,"props":1676,"children":1678},{"className":475,"code":1677,"language":477,"meta":391,"style":391},"// vue-template-compiler/build.js/createCompilerCreator\nvar ast = parse(template.trim(), options)\noptimize(ast, options)\nvar code = generate(ast, options)\n",[1679],{"type":398,"tag":406,"props":1680,"children":1681},{"__ignoreMap":391},[1682,1690,1698,1706],{"type":398,"tag":483,"props":1683,"children":1684},{"class":485,"line":486},[1685],{"type":398,"tag":483,"props":1686,"children":1687},{},[1688],{"type":403,"value":1689},"// vue-template-compiler/build.js/createCompilerCreator\n",{"type":398,"tag":483,"props":1691,"children":1692},{"class":485,"line":495},[1693],{"type":398,"tag":483,"props":1694,"children":1695},{},[1696],{"type":403,"value":1697},"var ast = parse(template.trim(), options)\n",{"type":398,"tag":483,"props":1699,"children":1700},{"class":485,"line":504},[1701],{"type":398,"tag":483,"props":1702,"children":1703},{},[1704],{"type":403,"value":1705},"optimize(ast, options)\n",{"type":398,"tag":483,"props":1707,"children":1708},{"class":485,"line":513},[1709],{"type":398,"tag":483,"props":1710,"children":1711},{},[1712],{"type":403,"value":1713},"var code = generate(ast, options)\n",{"type":398,"tag":399,"props":1715,"children":1716},{},[1717],{"type":403,"value":1718},"先前我们的组件 ID 在 parse 阶段解析开始标签时就会被推入内部储存的数据结构中：",{"type":398,"tag":473,"props":1720,"children":1722},{"className":475,"code":1721,"language":477,"meta":391,"style":391},"function elementToOpenTagSegments (el, state) {\n  var segments = [{ type: RAW, value: (\"\u003C\" + (el.tag)) }]\n  // _scopedId\n  if (state.options.scopeId) {\n    segments.push({ type: RAW, value: (\" \" + (state.options.scopeId)) })\n  }\n  segments.push({ type: RAW, value: \">\" })\n  return segments\n}\n",[1723],{"type":398,"tag":406,"props":1724,"children":1725},{"__ignoreMap":391},[1726,1734,1742,1750,1758,1766,1774,1782,1790],{"type":398,"tag":483,"props":1727,"children":1728},{"class":485,"line":486},[1729],{"type":398,"tag":483,"props":1730,"children":1731},{},[1732],{"type":403,"value":1733},"function elementToOpenTagSegments (el, state) {\n",{"type":398,"tag":483,"props":1735,"children":1736},{"class":485,"line":495},[1737],{"type":398,"tag":483,"props":1738,"children":1739},{},[1740],{"type":403,"value":1741},"  var segments = [{ type: RAW, value: (\"\u003C\" + (el.tag)) }]\n",{"type":398,"tag":483,"props":1743,"children":1744},{"class":485,"line":504},[1745],{"type":398,"tag":483,"props":1746,"children":1747},{},[1748],{"type":403,"value":1749},"  // _scopedId\n",{"type":398,"tag":483,"props":1751,"children":1752},{"class":485,"line":513},[1753],{"type":398,"tag":483,"props":1754,"children":1755},{},[1756],{"type":403,"value":1757},"  if (state.options.scopeId) {\n",{"type":398,"tag":483,"props":1759,"children":1760},{"class":485,"line":522},[1761],{"type":398,"tag":483,"props":1762,"children":1763},{},[1764],{"type":403,"value":1765},"    segments.push({ type: RAW, value: (\" \" + (state.options.scopeId)) })\n",{"type":398,"tag":483,"props":1767,"children":1768},{"class":485,"line":531},[1769],{"type":398,"tag":483,"props":1770,"children":1771},{},[1772],{"type":403,"value":1773},"  }\n",{"type":398,"tag":483,"props":1775,"children":1776},{"class":485,"line":540},[1777],{"type":398,"tag":483,"props":1778,"children":1779},{},[1780],{"type":403,"value":1781},"  segments.push({ type: RAW, value: \">\" })\n",{"type":398,"tag":483,"props":1783,"children":1784},{"class":485,"line":549},[1785],{"type":398,"tag":483,"props":1786,"children":1787},{},[1788],{"type":403,"value":1789},"  return segments\n",{"type":398,"tag":483,"props":1791,"children":1792},{"class":485,"line":801},[1793],{"type":398,"tag":483,"props":1794,"children":1795},{},[1796],{"type":403,"value":965},{"type":398,"tag":399,"props":1798,"children":1799},{},[1800,1802,1808],{"type":403,"value":1801},"先前我们的 HTML 模板 ",{"type":398,"tag":406,"props":1803,"children":1805},{"className":1804},[],[1806],{"type":403,"value":1807},"\u003Cdiv class='lionad'>\u003C/div>",{"type":403,"value":1809}," 中开始标签会被转换成如下数据结构：",{"type":398,"tag":473,"props":1811,"children":1813},{"className":475,"code":1812,"language":477,"meta":391,"style":391},"[\n    { type: RAW, value: '\u003Cdiv' },\n    { type: RAW, value: 'class=lionad' },\n    { type: RAW, value: 'data-v-xxxxxx' },\n    { type: RAW, value: '>' },\n]\n",[1814],{"type":398,"tag":406,"props":1815,"children":1816},{"__ignoreMap":391},[1817,1825,1833,1841,1849,1857],{"type":398,"tag":483,"props":1818,"children":1819},{"class":485,"line":486},[1820],{"type":398,"tag":483,"props":1821,"children":1822},{},[1823],{"type":403,"value":1824},"[\n",{"type":398,"tag":483,"props":1826,"children":1827},{"class":485,"line":495},[1828],{"type":398,"tag":483,"props":1829,"children":1830},{},[1831],{"type":403,"value":1832},"    { type: RAW, value: '\u003Cdiv' },\n",{"type":398,"tag":483,"props":1834,"children":1835},{"class":485,"line":504},[1836],{"type":398,"tag":483,"props":1837,"children":1838},{},[1839],{"type":403,"value":1840},"    { type: RAW, value: 'class=lionad' },\n",{"type":398,"tag":483,"props":1842,"children":1843},{"class":485,"line":513},[1844],{"type":398,"tag":483,"props":1845,"children":1846},{},[1847],{"type":403,"value":1848},"    { type: RAW, value: 'data-v-xxxxxx' },\n",{"type":398,"tag":483,"props":1850,"children":1851},{"class":485,"line":522},[1852],{"type":398,"tag":483,"props":1853,"children":1854},{},[1855],{"type":403,"value":1856},"    { type: RAW, value: '>' },\n",{"type":398,"tag":483,"props":1858,"children":1859},{"class":485,"line":531},[1860],{"type":398,"tag":483,"props":1861,"children":1862},{},[1863],{"type":403,"value":1864},"]\n",{"type":398,"tag":1534,"props":1866,"children":1868},{"id":1867},"样式模板处理",[1869],{"type":403,"value":1867},{"type":398,"tag":399,"props":1871,"children":1872},{},[1873,1875,1881,1883,1889,1891,1897,1899,1905],{"type":403,"value":1874},"与 HTML Template 解析的过程类似，通过 webpack 将样式模板转交 ",{"type":398,"tag":406,"props":1876,"children":1878},{"className":1877},[],[1879],{"type":403,"value":1880},"stylePostLoader",{"type":403,"value":1882}," 进行处理，处理逻辑主要引用了 ",{"type":398,"tag":406,"props":1884,"children":1886},{"className":1885},[],[1887],{"type":403,"value":1888},"@vue/component-compiler-utils",{"type":403,"value":1890}," 中的 ",{"type":398,"tag":406,"props":1892,"children":1894},{"className":1893},[],[1895],{"type":403,"value":1896},"compileStyle",{"type":403,"value":1898}," 部分，后者对样式模板进行解析的过程中，将会对含 scoped 标记的模板引入插件 ",{"type":398,"tag":406,"props":1900,"children":1902},{"className":1901},[],[1903],{"type":403,"value":1904},"stylePlugins/scoped.js",{"type":403,"value":1906},"：",{"type":398,"tag":473,"props":1908,"children":1910},{"className":475,"code":1909,"language":477,"meta":391,"style":391},"// component-compiler-utils/compileStyle.js\nfunction doCompileStyle (options) {\n    if (scoped) {\n        plugins.push(scoped_1.default(id));\n    }\n    return { result: postcss(plugins).process(source, postCSSOptions) }\n}\n",[1911],{"type":398,"tag":406,"props":1912,"children":1913},{"__ignoreMap":391},[1914,1922,1930,1938,1946,1953,1961],{"type":398,"tag":483,"props":1915,"children":1916},{"class":485,"line":486},[1917],{"type":398,"tag":483,"props":1918,"children":1919},{},[1920],{"type":403,"value":1921},"// component-compiler-utils/compileStyle.js\n",{"type":398,"tag":483,"props":1923,"children":1924},{"class":485,"line":495},[1925],{"type":398,"tag":483,"props":1926,"children":1927},{},[1928],{"type":403,"value":1929},"function doCompileStyle (options) {\n",{"type":398,"tag":483,"props":1931,"children":1932},{"class":485,"line":504},[1933],{"type":398,"tag":483,"props":1934,"children":1935},{},[1936],{"type":403,"value":1937},"    if (scoped) {\n",{"type":398,"tag":483,"props":1939,"children":1940},{"class":485,"line":513},[1941],{"type":398,"tag":483,"props":1942,"children":1943},{},[1944],{"type":403,"value":1945},"        plugins.push(scoped_1.default(id));\n",{"type":398,"tag":483,"props":1947,"children":1948},{"class":485,"line":522},[1949],{"type":398,"tag":483,"props":1950,"children":1951},{},[1952],{"type":403,"value":1451},{"type":398,"tag":483,"props":1954,"children":1955},{"class":485,"line":531},[1956],{"type":398,"tag":483,"props":1957,"children":1958},{},[1959],{"type":403,"value":1960},"    return { result: postcss(plugins).process(source, postCSSOptions) }\n",{"type":398,"tag":483,"props":1962,"children":1963},{"class":485,"line":540},[1964],{"type":398,"tag":483,"props":1965,"children":1966},{},[1967],{"type":403,"value":965},{"type":398,"tag":399,"props":1969,"children":1970},{},[1971,1973,1979,1981,1987],{"type":403,"value":1972},"插件 ",{"type":398,"tag":406,"props":1974,"children":1976},{"className":1975},[],[1977],{"type":403,"value":1978},"scoped.js",{"type":403,"value":1980}," 将 ",{"type":398,"tag":406,"props":1982,"children":1984},{"className":1983},[],[1985],{"type":403,"value":1986},"data-v-xxxxxx",{"type":403,"value":1988}," 添加到选择器末尾的具体逻辑如下，遍历每一个选择器组合下的选择器，选择给每个组合下最后一个选择器的末尾插入：",{"type":398,"tag":473,"props":1990,"children":1992},{"className":475,"code":1991,"language":477,"meta":391,"style":391},"// component-compiler-utils/stylePlugins/scoped.js\nselectors.each((selector) => {\n    selector.each((n) => {\n        if (n.value === '::v-deep' || n.value === '>>>' || n.value === '/deep/') {\n            return false;\n        }\n    });\n    selector.insertAfter(node, selectorParser.attribute({\n        attribute: id\n    }))\n})\n",[1993],{"type":398,"tag":406,"props":1994,"children":1995},{"__ignoreMap":391},[1996,2004,2012,2020,2028,2036,2044,2052,2060,2068,2076],{"type":398,"tag":483,"props":1997,"children":1998},{"class":485,"line":486},[1999],{"type":398,"tag":483,"props":2000,"children":2001},{},[2002],{"type":403,"value":2003},"// component-compiler-utils/stylePlugins/scoped.js\n",{"type":398,"tag":483,"props":2005,"children":2006},{"class":485,"line":495},[2007],{"type":398,"tag":483,"props":2008,"children":2009},{},[2010],{"type":403,"value":2011},"selectors.each((selector) => {\n",{"type":398,"tag":483,"props":2013,"children":2014},{"class":485,"line":504},[2015],{"type":398,"tag":483,"props":2016,"children":2017},{},[2018],{"type":403,"value":2019},"    selector.each((n) => {\n",{"type":398,"tag":483,"props":2021,"children":2022},{"class":485,"line":513},[2023],{"type":398,"tag":483,"props":2024,"children":2025},{},[2026],{"type":403,"value":2027},"        if (n.value === '::v-deep' || n.value === '>>>' || n.value === '/deep/') {\n",{"type":398,"tag":483,"props":2029,"children":2030},{"class":485,"line":522},[2031],{"type":398,"tag":483,"props":2032,"children":2033},{},[2034],{"type":403,"value":2035},"            return false;\n",{"type":398,"tag":483,"props":2037,"children":2038},{"class":485,"line":531},[2039],{"type":398,"tag":483,"props":2040,"children":2041},{},[2042],{"type":403,"value":2043},"        }\n",{"type":398,"tag":483,"props":2045,"children":2046},{"class":485,"line":540},[2047],{"type":398,"tag":483,"props":2048,"children":2049},{},[2050],{"type":403,"value":2051},"    });\n",{"type":398,"tag":483,"props":2053,"children":2054},{"class":485,"line":549},[2055],{"type":398,"tag":483,"props":2056,"children":2057},{},[2058],{"type":403,"value":2059},"    selector.insertAfter(node, selectorParser.attribute({\n",{"type":398,"tag":483,"props":2061,"children":2062},{"class":485,"line":801},[2063],{"type":398,"tag":483,"props":2064,"children":2065},{},[2066],{"type":403,"value":2067},"        attribute: id\n",{"type":398,"tag":483,"props":2069,"children":2070},{"class":485,"line":810},[2071],{"type":398,"tag":483,"props":2072,"children":2073},{},[2074],{"type":403,"value":2075},"    }))\n",{"type":398,"tag":483,"props":2077,"children":2078},{"class":485,"line":819},[2079],{"type":398,"tag":483,"props":2080,"children":2081},{},[2082],{"type":403,"value":555},{"type":398,"tag":399,"props":2084,"children":2085},{},[2086,2088,2094],{"type":403,"value":2087},"题外话，通过以上代码，我们发现当循环处理到三种特定类型选择器便会终止，停止将 ",{"type":398,"tag":406,"props":2089,"children":2091},{"className":2090},[],[2092],{"type":403,"value":2093},"data-v-xxx",{"type":403,"value":2095}," 添加到选择器末尾：",{"type":398,"tag":1652,"props":2097,"children":2098},{},[2099,2110,2121],{"type":398,"tag":1197,"props":2100,"children":2101},{},[2102,2104],{"type":403,"value":2103},"伪类 ",{"type":398,"tag":406,"props":2105,"children":2107},{"className":2106},[],[2108],{"type":403,"value":2109},"::v-deep",{"type":398,"tag":1197,"props":2111,"children":2112},{},[2113,2115],{"type":403,"value":2114},"选择器 ",{"type":398,"tag":406,"props":2116,"children":2118},{"className":2117},[],[2119],{"type":403,"value":2120},">>>",{"type":398,"tag":1197,"props":2122,"children":2123},{},[2124,2125],{"type":403,"value":2114},{"type":398,"tag":406,"props":2126,"children":2128},{"className":2127},[],[2129],{"type":403,"value":2130},"/deep/",{"type":398,"tag":399,"props":2132,"children":2133},{},[2134],{"type":403,"value":2135},"我们可以利用这个特征，在组件中写样式穿透，即内部组件影响外部组件样式 (ε=ε=ε=┏(゜ロ゜;)┛ 主动样式污染)，当然这在特定的情境下是有用的，比如当我们想主动覆盖第三方 UI 组件框架的样式，却不想引入新的 CSS 文件，或不想写非 Scoped CSS 模板的时候。",{"type":398,"tag":1370,"props":2137,"children":2138},{},[2139],{"type":403,"value":2140},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":391,"searchDepth":495,"depth":495,"links":2142},[2143,2144,2145],{"id":433,"depth":495,"text":433},{"id":593,"depth":495,"text":596},{"id":1261,"depth":495,"text":1256,"children":2146},[2147,2148],{"id":1267,"depth":504,"text":1270},{"id":1350,"depth":504,"text":1350},"markdown","content:8.source-code:_js:vue2-source:4.scoped-css.md","8.source-code/_js/vue2-source/4.scoped-css.md","md",[2154,2157],{"_path":2155,"title":2156,"description":393},"/source-code/_js/vue2-source/global-api","Vue2 Global API",{"_path":2158,"title":2159,"description":393},"/source-code/_js/vue2-source/test-kit","Vue2 Test Kit",1710257734479]