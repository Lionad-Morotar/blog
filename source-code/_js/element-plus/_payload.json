[{"data":1,"prerenderedAt":2481},["ShallowReactive",2],{"navigation":3,"/source-code/_js/element-plus":161,"/source-code/_js/element-plus-surround":2473},[4,35,92,98,125,131,155],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83,86,89],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🖌️ Blockies Animation","/maps/_fe-framework/motion/blockies-animation",{"title":45,"_path":46},"🌪️ Tailwind v4 如何兼容预处理器","/articles/tailwind4-with-sass",{"title":48,"_path":49},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":51,"_path":52},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":54,"_path":55},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":57,"_path":58},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":60,"_path":61},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":63,"_path":64},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":66,"_path":67},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":69,"_path":70},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":72,"_path":73},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":75,"_path":76},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":78,"_path":79},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":81,"_path":82},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":84,"_path":85},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":87,"_path":88},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":90,"_path":91},"📝 技术博客归档","/articles/archive",{"title":93,"_path":94,"children":95},"读书笔记 / Notes","/books",[96],{"title":97,"_path":94},"📕 读书笔记",{"title":99,"_path":100,"children":101},"吉他剧场 / Music","/music",[102,104,107,110,113,116,119,122],{"title":103,"_path":100},"🎸 FingerStyle！",{"title":105,"_path":106},"🌬️ 等待的风","/music/wind",{"title":108,"_path":109},"💕 约定的海洋","/music/ocean",{"title":111,"_path":112},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":114,"_path":115},"🌏 残酷天使的行动纲领","/music/eva",{"title":117,"_path":118},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":120,"_path":121},"🍷 Wu Wei","/music/wu-wei",{"title":123,"_path":124},"🌅 无题","/music/untitled",{"title":126,"_path":127,"children":128},"知识地图 / Maps","/maps",[129],{"title":130,"_path":127},"🏁 知识地图",{"title":132,"_path":133,"children":134},"造物 / Make","/tools",[135,137,140,143,146,149,152],{"title":136,"_path":133},"🧰 工具收集",{"title":138,"_path":139},"📕 博客","/tools/blog",{"title":141,"_path":142},"🥥 Coconut","/tools/coconut",{"title":144,"_path":145},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":147,"_path":148},"🌐 AnySort","/tools/anysort",{"title":150,"_path":151},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":153,"_path":154},"👓 Crapto","/tools/crypto-inline",{"title":156,"_path":157,"children":158},"我 / About","/hire",[159],{"title":160,"_path":157},"📬 技术简历",{"_path":162,"_dir":163,"_draft":164,"_partial":165,"_locale":166,"title":167,"description":168,"body":169,"_type":2468,"_id":2469,"_source":2470,"_file":2471,"_stem":2472,"_extension":743},"/source-code/_js/element-plus","_js",false,true,"","Element Plus","A Vue.js 3 UI Library made by Element team",{"type":170,"children":171,"toc":2460},"root",[172,199,204,209,215,222,227,232,237,242,262,268,273,278,289,294,300,305,310,315,699,735,740,747,752,758,771,911,925,939,1437,1443,1457,1462,1475,1489,1693,1698,1928,1941,1963,1968,1974,1980,1986,1991,1997,2002,2007,2013,2018,2156,2170,2175,2407,2420,2426,2431,2454],{"type":173,"tag":174,"props":175,"children":176},"element","p",{},[177,180,189,191,197],{"type":178,"value":179},"text","Element Plus 是在 Element UI 的基础上的",{"type":173,"tag":181,"props":182,"children":186},"a",{"href":183,"rel":184},"https://github.com/element-plus/element-plus/discussions/3065",[185],"nofollow",[187],{"type":178,"value":188},"重构",{"type":178,"value":190},"，所以也可以参考 ",{"type":173,"tag":181,"props":192,"children":194},{"href":193},"/source-code/_js/element-ui",[195],{"type":178,"value":196},"Element UI 的笔记",{"type":178,"value":198},"。",{"type":173,"tag":174,"props":200,"children":201},{},[202],{"type":178,"value":203},"ElementPlus（以下简称 EP）是一个基于 Vue 3 的 UI 组件库，其立项初期就明确了要在保留 Element UI 的易用性等基础上，摆脱 Element UI 的历史遗留包袱。除了更多功能和更好的性能，我们还能在 EP 项目代码中看到许多现代的前端项目架构和技术实践。",{"type":173,"tag":174,"props":205,"children":206},{},[207],{"type":178,"value":208},"尽管已经来到 2025 年，前端技术日新月异，但 EP 作为可能是国人最熟悉也最易上手的项目，其代码依然具有很高的参考价值。本文尝试从项目工程的角度入手，用问题的形式，引出近年来前端项目的常见实践和技术。由于 EP 代码量较大，本文可能会跳过对一些基础知识的讲解，并假设读者对 Vue3、TS 和 Element Plus 有基本了解，并对前端工程化有兴趣。本文基于 Element Plus v2.10.2，如有错误之处，欢迎指正。",{"type":173,"tag":210,"props":211,"children":213},"h2",{"id":212},"杂谈",[214],{"type":178,"value":212},{"type":173,"tag":216,"props":217,"children":219},"h4",{"id":218},"如何从零开始阅读-ep-的代码",[220],{"type":178,"value":221},"如何从零开始阅读 EP 的代码？",{"type":173,"tag":174,"props":223,"children":224},{},[225],{"type":178,"value":226},"看 Element Plus 的项目源码大致就两个作用，一是了解现代前端工程化是怎么在开源组件库实践的，二是了解通用组件的实现方式。可以从这两个角度，取一个着重点入手。",{"type":173,"tag":174,"props":228,"children":229},{},[230],{"type":178,"value":231},"首先肯定要熟悉 Element Plus 的使用，如果平时没用过，那么通读代码也没作用。其次是从点及面能更快地理解和掌握。具体而言，如果从组件实现的入手，最好从平常碰到问题的组件开始看起，先看具体组件实现，然后推广到相关工具函数，其次看大范围的组件组织，最后是构建、测试和其他项目流程。",{"type":173,"tag":174,"props":233,"children":234},{},[235],{"type":178,"value":236},"从工程化入手则是先了解项目的整体结构和依赖关系，然后再深入到具体的实现细节。",{"type":173,"tag":174,"props":238,"children":239},{},[240],{"type":178,"value":241},"目的不同也会影响阅读顺序，比如抱着开源贡献的目的去看代码，可能会先从贡献指南、代码规范等入手，然后再看具体的实现。不过，无论怎么开始，也有一些通用技巧可以遵守：",{"type":173,"tag":243,"props":244,"children":245},"ul",{},[246,252,257],{"type":173,"tag":247,"props":248,"children":249},"li",{},[250],{"type":178,"value":251},"从通用测试用例开始，了解代码功能，到边缘测试用例结束，逐步深入",{"type":173,"tag":247,"props":253,"children":254},{},[255],{"type":178,"value":256},"灵活使用 Git Graph，从代码变更历史、提交信息和 PR 中了解演变过程",{"type":173,"tag":247,"props":258,"children":259},{},[260],{"type":178,"value":261},"复杂代码可以画图，比如用 XState 工具画状态图，同 Madge 分析依赖关系等",{"type":173,"tag":216,"props":263,"children":265},{"id":264},"前端工程化的千人千面",[266],{"type":178,"value":267},"“前端工程化”的千人千面",{"type":173,"tag":174,"props":269,"children":270},{},[271],{"type":178,"value":272},"前端工程化是一个广泛的概念，其涵盖的内容可以追溯到软件工程的定义和实践在前端领域的特化。但由于没有统一的标准，再加上各个团队、项目的主要目标不同，侧重的内容和实现方式也各不相同，所以实践上有很大差异。举例来说，开源项目可能更注重文档和社区建设，提供一定的开发流程保证代码质量，也通过门户和公共文档方便新手入门，而商业项目则可能更多关注稳定性与开发速度，所以会做数据监控，使用老旧但稳定的技术栈等。",{"type":173,"tag":174,"props":274,"children":275},{},[276],{"type":178,"value":277},"这里尝试给出我的一些看法和总结。前端工程化泛指将自动化、标准化、流程化等工程领域思想应用于前端开发全过程，以达到提升开发效率、提高代码质量与可维护性、协同团队合作的目的。",{"type":173,"tag":174,"props":279,"children":280},{},[281,283],{"type":178,"value":282},"见：",{"type":173,"tag":181,"props":284,"children":286},{"href":285},"/maps/_workflow/fe-engineering",[287],{"type":178,"value":288},"什么是前端工程化？",{"type":173,"tag":210,"props":290,"children":292},{"id":291},"项目结构",[293],{"type":178,"value":291},{"type":173,"tag":216,"props":295,"children":297},{"id":296},"各子包的依赖关系是怎样的",[298],{"type":178,"value":299},"各子包的依赖关系是怎样的？",{"type":173,"tag":174,"props":301,"children":302},{},[303],{"type":178,"value":304},"单仓多包的管理方式，通常叫做 monorepo。要先明确为什么使用 monorepo。假设我们在公司有营销前台项目、用户管理后台项目，这两个项目关系不大，那么放到一个仓库不仅不会带来共享配置和代码的便利，反而会引起权限等方面的问题。适合 monorepo 的项目，其子包一定要保证高度相关，最好能通过共享代码、工具和配置来提高开发效率。",{"type":173,"tag":174,"props":306,"children":307},{},[308],{"type":178,"value":309},"子包的定义可以从 pnpm 工作区间声明中找到，也就是 pnpm-workspace.yaml 文件。",{"type":173,"tag":174,"props":311,"children":312},{},[313],{"type":178,"value":314},"EP 子包详细分为以下几种：",{"type":173,"tag":316,"props":317,"children":321},"pre",{"className":318,"code":319,"language":320,"meta":166,"style":166},"language-yaml shiki shiki-themes material-theme-lighter github-light github-dark monokai","packages:\n  # 各组件代码，如 alert、button\n  - packages/components\n  # 项目常量定义，如组件尺寸枚举（default、large、small）、WEEK_DAYS 枚举等\n  - packages/constants\n  # 组件指令工具，如 trap-focus 焦点管理器、click-outside 点击区域外部检测指令等\n  - packages/directives\n  # 编译入口，导出了源码的各部分，作为组件代码和编译结果的桥梁\n  - packages/element-plus\n  # 工具函数，有 use-namespace、use-z-index\n  - packages/hooks\n  # 多语言文件及入口\n  - packages/locale\n  # 测试工具\n  - packages/test-utils\n  # Chalk 主题相关代码，如主题变量等\n  - packages/theme-chalk\n  # 工具函数，如 raf、rand\n  - packages/utils\n  # 文档站点\n  - docs\n  # 本地开发环境\n  - play\n  # 编译工具\n  - internal/build\n  # 编译时常量\n  - internal/build-constants\n  # 编译时工具函数\n  - internal/build-utils\n  # 项目代码规范\n  - internal/eslint-config\n  # 项目元信息，目前包含贡献者计算脚本\n  - internal/metadata\n","yaml",[322],{"type":173,"tag":323,"props":324,"children":325},"code",{"__ignoreMap":166},[326,344,354,369,378,391,400,413,422,435,444,457,466,479,488,501,510,523,532,545,554,567,576,589,598,611,620,633,642,655,664,677,686],{"type":173,"tag":327,"props":328,"children":331},"span",{"class":329,"line":330},"line",1,[332,338],{"type":173,"tag":327,"props":333,"children":335},{"style":334},"--shiki-light:#E53935;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[336],{"type":178,"value":337},"packages",{"type":173,"tag":327,"props":339,"children":341},{"style":340},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[342],{"type":178,"value":343},":\n",{"type":173,"tag":327,"props":345,"children":347},{"class":329,"line":346},2,[348],{"type":173,"tag":327,"props":349,"children":351},{"style":350},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[352],{"type":178,"value":353},"  # 各组件代码，如 alert、button\n",{"type":173,"tag":327,"props":355,"children":357},{"class":329,"line":356},3,[358,363],{"type":173,"tag":327,"props":359,"children":360},{"style":340},[361],{"type":178,"value":362},"  -",{"type":173,"tag":327,"props":364,"children":366},{"style":365},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[367],{"type":178,"value":368}," packages/components\n",{"type":173,"tag":327,"props":370,"children":372},{"class":329,"line":371},4,[373],{"type":173,"tag":327,"props":374,"children":375},{"style":350},[376],{"type":178,"value":377},"  # 项目常量定义，如组件尺寸枚举（default、large、small）、WEEK_DAYS 枚举等\n",{"type":173,"tag":327,"props":379,"children":381},{"class":329,"line":380},5,[382,386],{"type":173,"tag":327,"props":383,"children":384},{"style":340},[385],{"type":178,"value":362},{"type":173,"tag":327,"props":387,"children":388},{"style":365},[389],{"type":178,"value":390}," packages/constants\n",{"type":173,"tag":327,"props":392,"children":394},{"class":329,"line":393},6,[395],{"type":173,"tag":327,"props":396,"children":397},{"style":350},[398],{"type":178,"value":399},"  # 组件指令工具，如 trap-focus 焦点管理器、click-outside 点击区域外部检测指令等\n",{"type":173,"tag":327,"props":401,"children":403},{"class":329,"line":402},7,[404,408],{"type":173,"tag":327,"props":405,"children":406},{"style":340},[407],{"type":178,"value":362},{"type":173,"tag":327,"props":409,"children":410},{"style":365},[411],{"type":178,"value":412}," packages/directives\n",{"type":173,"tag":327,"props":414,"children":416},{"class":329,"line":415},8,[417],{"type":173,"tag":327,"props":418,"children":419},{"style":350},[420],{"type":178,"value":421},"  # 编译入口，导出了源码的各部分，作为组件代码和编译结果的桥梁\n",{"type":173,"tag":327,"props":423,"children":425},{"class":329,"line":424},9,[426,430],{"type":173,"tag":327,"props":427,"children":428},{"style":340},[429],{"type":178,"value":362},{"type":173,"tag":327,"props":431,"children":432},{"style":365},[433],{"type":178,"value":434}," packages/element-plus\n",{"type":173,"tag":327,"props":436,"children":438},{"class":329,"line":437},10,[439],{"type":173,"tag":327,"props":440,"children":441},{"style":350},[442],{"type":178,"value":443},"  # 工具函数，有 use-namespace、use-z-index\n",{"type":173,"tag":327,"props":445,"children":447},{"class":329,"line":446},11,[448,452],{"type":173,"tag":327,"props":449,"children":450},{"style":340},[451],{"type":178,"value":362},{"type":173,"tag":327,"props":453,"children":454},{"style":365},[455],{"type":178,"value":456}," packages/hooks\n",{"type":173,"tag":327,"props":458,"children":460},{"class":329,"line":459},12,[461],{"type":173,"tag":327,"props":462,"children":463},{"style":350},[464],{"type":178,"value":465},"  # 多语言文件及入口\n",{"type":173,"tag":327,"props":467,"children":469},{"class":329,"line":468},13,[470,474],{"type":173,"tag":327,"props":471,"children":472},{"style":340},[473],{"type":178,"value":362},{"type":173,"tag":327,"props":475,"children":476},{"style":365},[477],{"type":178,"value":478}," packages/locale\n",{"type":173,"tag":327,"props":480,"children":482},{"class":329,"line":481},14,[483],{"type":173,"tag":327,"props":484,"children":485},{"style":350},[486],{"type":178,"value":487},"  # 测试工具\n",{"type":173,"tag":327,"props":489,"children":491},{"class":329,"line":490},15,[492,496],{"type":173,"tag":327,"props":493,"children":494},{"style":340},[495],{"type":178,"value":362},{"type":173,"tag":327,"props":497,"children":498},{"style":365},[499],{"type":178,"value":500}," packages/test-utils\n",{"type":173,"tag":327,"props":502,"children":504},{"class":329,"line":503},16,[505],{"type":173,"tag":327,"props":506,"children":507},{"style":350},[508],{"type":178,"value":509},"  # Chalk 主题相关代码，如主题变量等\n",{"type":173,"tag":327,"props":511,"children":513},{"class":329,"line":512},17,[514,518],{"type":173,"tag":327,"props":515,"children":516},{"style":340},[517],{"type":178,"value":362},{"type":173,"tag":327,"props":519,"children":520},{"style":365},[521],{"type":178,"value":522}," packages/theme-chalk\n",{"type":173,"tag":327,"props":524,"children":526},{"class":329,"line":525},18,[527],{"type":173,"tag":327,"props":528,"children":529},{"style":350},[530],{"type":178,"value":531},"  # 工具函数，如 raf、rand\n",{"type":173,"tag":327,"props":533,"children":535},{"class":329,"line":534},19,[536,540],{"type":173,"tag":327,"props":537,"children":538},{"style":340},[539],{"type":178,"value":362},{"type":173,"tag":327,"props":541,"children":542},{"style":365},[543],{"type":178,"value":544}," packages/utils\n",{"type":173,"tag":327,"props":546,"children":548},{"class":329,"line":547},20,[549],{"type":173,"tag":327,"props":550,"children":551},{"style":350},[552],{"type":178,"value":553},"  # 文档站点\n",{"type":173,"tag":327,"props":555,"children":557},{"class":329,"line":556},21,[558,562],{"type":173,"tag":327,"props":559,"children":560},{"style":340},[561],{"type":178,"value":362},{"type":173,"tag":327,"props":563,"children":564},{"style":365},[565],{"type":178,"value":566}," docs\n",{"type":173,"tag":327,"props":568,"children":570},{"class":329,"line":569},22,[571],{"type":173,"tag":327,"props":572,"children":573},{"style":350},[574],{"type":178,"value":575},"  # 本地开发环境\n",{"type":173,"tag":327,"props":577,"children":579},{"class":329,"line":578},23,[580,584],{"type":173,"tag":327,"props":581,"children":582},{"style":340},[583],{"type":178,"value":362},{"type":173,"tag":327,"props":585,"children":586},{"style":365},[587],{"type":178,"value":588}," play\n",{"type":173,"tag":327,"props":590,"children":592},{"class":329,"line":591},24,[593],{"type":173,"tag":327,"props":594,"children":595},{"style":350},[596],{"type":178,"value":597},"  # 编译工具\n",{"type":173,"tag":327,"props":599,"children":601},{"class":329,"line":600},25,[602,606],{"type":173,"tag":327,"props":603,"children":604},{"style":340},[605],{"type":178,"value":362},{"type":173,"tag":327,"props":607,"children":608},{"style":365},[609],{"type":178,"value":610}," internal/build\n",{"type":173,"tag":327,"props":612,"children":614},{"class":329,"line":613},26,[615],{"type":173,"tag":327,"props":616,"children":617},{"style":350},[618],{"type":178,"value":619},"  # 编译时常量\n",{"type":173,"tag":327,"props":621,"children":623},{"class":329,"line":622},27,[624,628],{"type":173,"tag":327,"props":625,"children":626},{"style":340},[627],{"type":178,"value":362},{"type":173,"tag":327,"props":629,"children":630},{"style":365},[631],{"type":178,"value":632}," internal/build-constants\n",{"type":173,"tag":327,"props":634,"children":636},{"class":329,"line":635},28,[637],{"type":173,"tag":327,"props":638,"children":639},{"style":350},[640],{"type":178,"value":641},"  # 编译时工具函数\n",{"type":173,"tag":327,"props":643,"children":645},{"class":329,"line":644},29,[646,650],{"type":173,"tag":327,"props":647,"children":648},{"style":340},[649],{"type":178,"value":362},{"type":173,"tag":327,"props":651,"children":652},{"style":365},[653],{"type":178,"value":654}," internal/build-utils\n",{"type":173,"tag":327,"props":656,"children":658},{"class":329,"line":657},30,[659],{"type":173,"tag":327,"props":660,"children":661},{"style":350},[662],{"type":178,"value":663},"  # 项目代码规范\n",{"type":173,"tag":327,"props":665,"children":667},{"class":329,"line":666},31,[668,672],{"type":173,"tag":327,"props":669,"children":670},{"style":340},[671],{"type":178,"value":362},{"type":173,"tag":327,"props":673,"children":674},{"style":365},[675],{"type":178,"value":676}," internal/eslint-config\n",{"type":173,"tag":327,"props":678,"children":680},{"class":329,"line":679},32,[681],{"type":173,"tag":327,"props":682,"children":683},{"style":350},[684],{"type":178,"value":685},"  # 项目元信息，目前包含贡献者计算脚本\n",{"type":173,"tag":327,"props":687,"children":689},{"class":329,"line":688},33,[690,694],{"type":173,"tag":327,"props":691,"children":692},{"style":340},[693],{"type":178,"value":362},{"type":173,"tag":327,"props":695,"children":696},{"style":365},[697],{"type":178,"value":698}," internal/metadata\n",{"type":173,"tag":174,"props":700,"children":701},{},[702,704,710,712,718,719,725,727,733],{"type":178,"value":703},"这些包分为 ",{"type":173,"tag":323,"props":705,"children":707},{"className":706},[],[708],{"type":178,"value":709},"packages/*",{"type":178,"value":711},"、",{"type":173,"tag":323,"props":713,"children":715},{"className":714},[],[716],{"type":178,"value":717},"internal/*",{"type":178,"value":711},{"type":173,"tag":323,"props":720,"children":722},{"className":721},[],[723],{"type":178,"value":724},"playground",{"type":178,"value":726}," 和 ",{"type":173,"tag":323,"props":728,"children":730},{"className":729},[],[731],{"type":178,"value":732},"docs",{"type":178,"value":734}," 四个大类，packages 主要包含组件源码，internal 则是工程化子包源码，playground 和 dev 分别对应开发时的本地环境和文档站点。",{"type":173,"tag":174,"props":736,"children":737},{},[738],{"type":178,"value":739},"可以从 packages.json 找到这些子包间的互相依赖的关系，但是这种依赖关系仅仅意味着代码的直接引用。比如，packages/components 需要使用 packages/hooks 中的工具函数，这就算一种直接引用。如果用图绘制这种引用关系，会形成如下关系图：",{"type":173,"tag":741,"props":742,"children":744},"mermaid",{"size":743},"md",[745],{"type":178,"value":746},"\nflowchart TD\n  subgraph packages\n    A(packages/components)\n    B(packages/constants)\n    C(packages/directives)\n    D(packages/element-plus)\n    E(packages/hooks)\n    F(packages/locale)\n    G(packages/test-utils)\n    H(packages/theme-chalk)\n    I(packages/utils)\n  end\n  subgraph internal\n    L(internal/build)\n    M(internal/build-constants)\n    N(internal/build-utils)\n    O(internal/eslint-config)\n    P(internal/metadata)\n  end\n  J(docs)\n  K(play)\n  E --> A\n  A --> B\n  C --> B\n  D --> B\n  E --> B\n  I --> B\n  A --> C\n  D --> C\n  A --> E\n  D --> E\n  A --> F\n  D --> F\n  E --> F\n  A --> G\n  E --> G\n  A --> H\n  A --> I\n  C --> I\n  E --> I\n  packages --> L\n  packages --> N\n  packages --> O\n  L --> M\n  P --> L\n  P --> M\n  P --> N\n  H --> L\n",{"type":173,"tag":174,"props":748,"children":749},{},[750],{"type":178,"value":751},"这份关系图有许多不完善的地方，我们接下来会继续讨论。",{"type":173,"tag":216,"props":753,"children":755},{"id":754},"项目代码如何消费子包",[756],{"type":178,"value":757},"项目代码如何消费子包？",{"type":173,"tag":174,"props":759,"children":760},{},[761,763,770],{"type":178,"value":762},"打开 packages.json 可以看到如下定义，这代表着 packages/* 内的包对 internal/build 有着依赖。这种形似“workspace:^0.0.1”的依赖关系，由 pnpm 解析管理，详见 ",{"type":173,"tag":181,"props":764,"children":767},{"href":765,"rel":766},"https://pnpm.io/zh/workspaces",[185],[768],{"type":178,"value":769},"pnpm workspace",{"type":178,"value":198},{"type":173,"tag":316,"props":772,"children":776},{"className":773,"code":774,"language":775,"meta":166,"style":166},"language-json shiki shiki-themes material-theme-lighter github-light github-dark monokai","{\n  \"name\": \"element-plus\",\n  \"devDependencies\": {\n    \"@element-plus/build\": \"workspace:^0.0.1\"\n  }\n}\n","json",[777],{"type":173,"tag":323,"props":778,"children":779},{"__ignoreMap":166},[780,788,834,859,895,903],{"type":173,"tag":327,"props":781,"children":782},{"class":329,"line":330},[783],{"type":173,"tag":327,"props":784,"children":785},{"style":340},[786],{"type":178,"value":787},"{\n",{"type":173,"tag":327,"props":789,"children":790},{"class":329,"line":346},[791,797,803,808,813,819,825,829],{"type":173,"tag":327,"props":792,"children":794},{"style":793},"--shiki-light:#39ADB5;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[795],{"type":178,"value":796},"  \"",{"type":173,"tag":327,"props":798,"children":800},{"style":799},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[801],{"type":178,"value":802},"name",{"type":173,"tag":327,"props":804,"children":805},{"style":793},[806],{"type":178,"value":807},"\"",{"type":173,"tag":327,"props":809,"children":810},{"style":340},[811],{"type":178,"value":812},":",{"type":173,"tag":327,"props":814,"children":816},{"style":815},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2",[817],{"type":178,"value":818}," \"",{"type":173,"tag":327,"props":820,"children":822},{"style":821},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2",[823],{"type":178,"value":824},"element-plus",{"type":173,"tag":327,"props":826,"children":827},{"style":815},[828],{"type":178,"value":807},{"type":173,"tag":327,"props":830,"children":831},{"style":340},[832],{"type":178,"value":833},",\n",{"type":173,"tag":327,"props":835,"children":836},{"class":329,"line":356},[837,841,846,850,854],{"type":173,"tag":327,"props":838,"children":839},{"style":793},[840],{"type":178,"value":796},{"type":173,"tag":327,"props":842,"children":843},{"style":799},[844],{"type":178,"value":845},"devDependencies",{"type":173,"tag":327,"props":847,"children":848},{"style":793},[849],{"type":178,"value":807},{"type":173,"tag":327,"props":851,"children":852},{"style":340},[853],{"type":178,"value":812},{"type":173,"tag":327,"props":855,"children":856},{"style":340},[857],{"type":178,"value":858}," {\n",{"type":173,"tag":327,"props":860,"children":861},{"class":329,"line":371},[862,867,873,877,881,885,890],{"type":173,"tag":327,"props":863,"children":864},{"style":793},[865],{"type":178,"value":866},"    \"",{"type":173,"tag":327,"props":868,"children":870},{"style":869},"--shiki-light:#E2931D;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[871],{"type":178,"value":872},"@element-plus/build",{"type":173,"tag":327,"props":874,"children":875},{"style":793},[876],{"type":178,"value":807},{"type":173,"tag":327,"props":878,"children":879},{"style":340},[880],{"type":178,"value":812},{"type":173,"tag":327,"props":882,"children":883},{"style":815},[884],{"type":178,"value":818},{"type":173,"tag":327,"props":886,"children":887},{"style":821},[888],{"type":178,"value":889},"workspace:^0.0.1",{"type":173,"tag":327,"props":891,"children":892},{"style":815},[893],{"type":178,"value":894},"\"\n",{"type":173,"tag":327,"props":896,"children":897},{"class":329,"line":380},[898],{"type":173,"tag":327,"props":899,"children":900},{"style":340},[901],{"type":178,"value":902},"  }\n",{"type":173,"tag":327,"props":904,"children":905},{"class":329,"line":393},[906],{"type":173,"tag":327,"props":907,"children":908},{"style":340},[909],{"type":178,"value":910},"}\n",{"type":173,"tag":174,"props":912,"children":913},{},[914,916,923],{"type":178,"value":915},"声明好 package.json 中的子包依赖，再 pnpm install，会在相应目录创建 symlink，指向子包的实际位置，这样一来 node 的",{"type":173,"tag":181,"props":917,"children":920},{"href":918,"rel":919},"https://nodejs.org/api/modules.html#all-together",[185],[921],{"type":178,"value":922},"模块查找算法",{"type":178,"value":924},"就能找到对应子包的代码。",{"type":173,"tag":174,"props":926,"children":927},{},[928,930,937],{"type":178,"value":929},"但是单配置子包为 package.json 的依赖是不够的，因为 Node 模块查找算法只对 webpack 等依赖 node 的工具生效，而 ",{"type":173,"tag":181,"props":931,"children":934},{"href":932,"rel":933},"https://github.com/microsoft/TypeScript/blob/3ba257fface990ec5ec59fa2bb8edd7a721e1013/src/compiler/moduleNameResolver.ts",[185],[935],{"type":178,"value":936},"TypeScript 编译器",{"type":178,"value":938},"及其他工具依赖在 tsconfig.json 中配置 paths 才能正确解析子包。所以打开 tsconfig.base.json 可以看到如下配置：",{"type":173,"tag":316,"props":940,"children":942},{"className":773,"code":941,"language":775,"meta":166,"style":166},"{\n  \"compilerOptions\": {\n    \"paths\": {\n      \"@element-plus/components\": [\"packages/components\"],\n      \"@element-plus/components/*\": [\"packages/components/*\"],\n      \"@element-plus/utils\": [\"packages/utils\"],\n      \"@element-plus/utils/*\": [\"packages/utils/*\"],\n      \"@element-plus/hooks\": [\"packages/hooks\"],\n      \"@element-plus/directives\": [\"packages/directives\"],\n      \"@element-plus/constants\": [\"packages/constants\"],\n      \"@element-plus/locale\": [\"packages/locale\"],\n      \"@element-plus/locale/*\": [\"packages/locale/*\"],\n      \"element-plus\": [\"packages/element-plus\"]\n    }\n  }\n}\n",[943],{"type":173,"tag":323,"props":944,"children":945},{"__ignoreMap":166},[946,953,977,1001,1046,1087,1128,1169,1210,1251,1292,1333,1374,1415,1423,1430],{"type":173,"tag":327,"props":947,"children":948},{"class":329,"line":330},[949],{"type":173,"tag":327,"props":950,"children":951},{"style":340},[952],{"type":178,"value":787},{"type":173,"tag":327,"props":954,"children":955},{"class":329,"line":346},[956,960,965,969,973],{"type":173,"tag":327,"props":957,"children":958},{"style":793},[959],{"type":178,"value":796},{"type":173,"tag":327,"props":961,"children":962},{"style":799},[963],{"type":178,"value":964},"compilerOptions",{"type":173,"tag":327,"props":966,"children":967},{"style":793},[968],{"type":178,"value":807},{"type":173,"tag":327,"props":970,"children":971},{"style":340},[972],{"type":178,"value":812},{"type":173,"tag":327,"props":974,"children":975},{"style":340},[976],{"type":178,"value":858},{"type":173,"tag":327,"props":978,"children":979},{"class":329,"line":356},[980,984,989,993,997],{"type":173,"tag":327,"props":981,"children":982},{"style":793},[983],{"type":178,"value":866},{"type":173,"tag":327,"props":985,"children":986},{"style":869},[987],{"type":178,"value":988},"paths",{"type":173,"tag":327,"props":990,"children":991},{"style":793},[992],{"type":178,"value":807},{"type":173,"tag":327,"props":994,"children":995},{"style":340},[996],{"type":178,"value":812},{"type":173,"tag":327,"props":998,"children":999},{"style":340},[1000],{"type":178,"value":858},{"type":173,"tag":327,"props":1002,"children":1003},{"class":329,"line":371},[1004,1009,1015,1019,1023,1028,1032,1037,1041],{"type":173,"tag":327,"props":1005,"children":1006},{"style":793},[1007],{"type":178,"value":1008},"      \"",{"type":173,"tag":327,"props":1010,"children":1012},{"style":1011},"--shiki-light:#F76D47;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[1013],{"type":178,"value":1014},"@element-plus/components",{"type":173,"tag":327,"props":1016,"children":1017},{"style":793},[1018],{"type":178,"value":807},{"type":173,"tag":327,"props":1020,"children":1021},{"style":340},[1022],{"type":178,"value":812},{"type":173,"tag":327,"props":1024,"children":1025},{"style":340},[1026],{"type":178,"value":1027}," [",{"type":173,"tag":327,"props":1029,"children":1030},{"style":815},[1031],{"type":178,"value":807},{"type":173,"tag":327,"props":1033,"children":1034},{"style":821},[1035],{"type":178,"value":1036},"packages/components",{"type":173,"tag":327,"props":1038,"children":1039},{"style":815},[1040],{"type":178,"value":807},{"type":173,"tag":327,"props":1042,"children":1043},{"style":340},[1044],{"type":178,"value":1045},"],\n",{"type":173,"tag":327,"props":1047,"children":1048},{"class":329,"line":380},[1049,1053,1058,1062,1066,1070,1074,1079,1083],{"type":173,"tag":327,"props":1050,"children":1051},{"style":793},[1052],{"type":178,"value":1008},{"type":173,"tag":327,"props":1054,"children":1055},{"style":1011},[1056],{"type":178,"value":1057},"@element-plus/components/*",{"type":173,"tag":327,"props":1059,"children":1060},{"style":793},[1061],{"type":178,"value":807},{"type":173,"tag":327,"props":1063,"children":1064},{"style":340},[1065],{"type":178,"value":812},{"type":173,"tag":327,"props":1067,"children":1068},{"style":340},[1069],{"type":178,"value":1027},{"type":173,"tag":327,"props":1071,"children":1072},{"style":815},[1073],{"type":178,"value":807},{"type":173,"tag":327,"props":1075,"children":1076},{"style":821},[1077],{"type":178,"value":1078},"packages/components/*",{"type":173,"tag":327,"props":1080,"children":1081},{"style":815},[1082],{"type":178,"value":807},{"type":173,"tag":327,"props":1084,"children":1085},{"style":340},[1086],{"type":178,"value":1045},{"type":173,"tag":327,"props":1088,"children":1089},{"class":329,"line":393},[1090,1094,1099,1103,1107,1111,1115,1120,1124],{"type":173,"tag":327,"props":1091,"children":1092},{"style":793},[1093],{"type":178,"value":1008},{"type":173,"tag":327,"props":1095,"children":1096},{"style":1011},[1097],{"type":178,"value":1098},"@element-plus/utils",{"type":173,"tag":327,"props":1100,"children":1101},{"style":793},[1102],{"type":178,"value":807},{"type":173,"tag":327,"props":1104,"children":1105},{"style":340},[1106],{"type":178,"value":812},{"type":173,"tag":327,"props":1108,"children":1109},{"style":340},[1110],{"type":178,"value":1027},{"type":173,"tag":327,"props":1112,"children":1113},{"style":815},[1114],{"type":178,"value":807},{"type":173,"tag":327,"props":1116,"children":1117},{"style":821},[1118],{"type":178,"value":1119},"packages/utils",{"type":173,"tag":327,"props":1121,"children":1122},{"style":815},[1123],{"type":178,"value":807},{"type":173,"tag":327,"props":1125,"children":1126},{"style":340},[1127],{"type":178,"value":1045},{"type":173,"tag":327,"props":1129,"children":1130},{"class":329,"line":402},[1131,1135,1140,1144,1148,1152,1156,1161,1165],{"type":173,"tag":327,"props":1132,"children":1133},{"style":793},[1134],{"type":178,"value":1008},{"type":173,"tag":327,"props":1136,"children":1137},{"style":1011},[1138],{"type":178,"value":1139},"@element-plus/utils/*",{"type":173,"tag":327,"props":1141,"children":1142},{"style":793},[1143],{"type":178,"value":807},{"type":173,"tag":327,"props":1145,"children":1146},{"style":340},[1147],{"type":178,"value":812},{"type":173,"tag":327,"props":1149,"children":1150},{"style":340},[1151],{"type":178,"value":1027},{"type":173,"tag":327,"props":1153,"children":1154},{"style":815},[1155],{"type":178,"value":807},{"type":173,"tag":327,"props":1157,"children":1158},{"style":821},[1159],{"type":178,"value":1160},"packages/utils/*",{"type":173,"tag":327,"props":1162,"children":1163},{"style":815},[1164],{"type":178,"value":807},{"type":173,"tag":327,"props":1166,"children":1167},{"style":340},[1168],{"type":178,"value":1045},{"type":173,"tag":327,"props":1170,"children":1171},{"class":329,"line":415},[1172,1176,1181,1185,1189,1193,1197,1202,1206],{"type":173,"tag":327,"props":1173,"children":1174},{"style":793},[1175],{"type":178,"value":1008},{"type":173,"tag":327,"props":1177,"children":1178},{"style":1011},[1179],{"type":178,"value":1180},"@element-plus/hooks",{"type":173,"tag":327,"props":1182,"children":1183},{"style":793},[1184],{"type":178,"value":807},{"type":173,"tag":327,"props":1186,"children":1187},{"style":340},[1188],{"type":178,"value":812},{"type":173,"tag":327,"props":1190,"children":1191},{"style":340},[1192],{"type":178,"value":1027},{"type":173,"tag":327,"props":1194,"children":1195},{"style":815},[1196],{"type":178,"value":807},{"type":173,"tag":327,"props":1198,"children":1199},{"style":821},[1200],{"type":178,"value":1201},"packages/hooks",{"type":173,"tag":327,"props":1203,"children":1204},{"style":815},[1205],{"type":178,"value":807},{"type":173,"tag":327,"props":1207,"children":1208},{"style":340},[1209],{"type":178,"value":1045},{"type":173,"tag":327,"props":1211,"children":1212},{"class":329,"line":424},[1213,1217,1222,1226,1230,1234,1238,1243,1247],{"type":173,"tag":327,"props":1214,"children":1215},{"style":793},[1216],{"type":178,"value":1008},{"type":173,"tag":327,"props":1218,"children":1219},{"style":1011},[1220],{"type":178,"value":1221},"@element-plus/directives",{"type":173,"tag":327,"props":1223,"children":1224},{"style":793},[1225],{"type":178,"value":807},{"type":173,"tag":327,"props":1227,"children":1228},{"style":340},[1229],{"type":178,"value":812},{"type":173,"tag":327,"props":1231,"children":1232},{"style":340},[1233],{"type":178,"value":1027},{"type":173,"tag":327,"props":1235,"children":1236},{"style":815},[1237],{"type":178,"value":807},{"type":173,"tag":327,"props":1239,"children":1240},{"style":821},[1241],{"type":178,"value":1242},"packages/directives",{"type":173,"tag":327,"props":1244,"children":1245},{"style":815},[1246],{"type":178,"value":807},{"type":173,"tag":327,"props":1248,"children":1249},{"style":340},[1250],{"type":178,"value":1045},{"type":173,"tag":327,"props":1252,"children":1253},{"class":329,"line":437},[1254,1258,1263,1267,1271,1275,1279,1284,1288],{"type":173,"tag":327,"props":1255,"children":1256},{"style":793},[1257],{"type":178,"value":1008},{"type":173,"tag":327,"props":1259,"children":1260},{"style":1011},[1261],{"type":178,"value":1262},"@element-plus/constants",{"type":173,"tag":327,"props":1264,"children":1265},{"style":793},[1266],{"type":178,"value":807},{"type":173,"tag":327,"props":1268,"children":1269},{"style":340},[1270],{"type":178,"value":812},{"type":173,"tag":327,"props":1272,"children":1273},{"style":340},[1274],{"type":178,"value":1027},{"type":173,"tag":327,"props":1276,"children":1277},{"style":815},[1278],{"type":178,"value":807},{"type":173,"tag":327,"props":1280,"children":1281},{"style":821},[1282],{"type":178,"value":1283},"packages/constants",{"type":173,"tag":327,"props":1285,"children":1286},{"style":815},[1287],{"type":178,"value":807},{"type":173,"tag":327,"props":1289,"children":1290},{"style":340},[1291],{"type":178,"value":1045},{"type":173,"tag":327,"props":1293,"children":1294},{"class":329,"line":446},[1295,1299,1304,1308,1312,1316,1320,1325,1329],{"type":173,"tag":327,"props":1296,"children":1297},{"style":793},[1298],{"type":178,"value":1008},{"type":173,"tag":327,"props":1300,"children":1301},{"style":1011},[1302],{"type":178,"value":1303},"@element-plus/locale",{"type":173,"tag":327,"props":1305,"children":1306},{"style":793},[1307],{"type":178,"value":807},{"type":173,"tag":327,"props":1309,"children":1310},{"style":340},[1311],{"type":178,"value":812},{"type":173,"tag":327,"props":1313,"children":1314},{"style":340},[1315],{"type":178,"value":1027},{"type":173,"tag":327,"props":1317,"children":1318},{"style":815},[1319],{"type":178,"value":807},{"type":173,"tag":327,"props":1321,"children":1322},{"style":821},[1323],{"type":178,"value":1324},"packages/locale",{"type":173,"tag":327,"props":1326,"children":1327},{"style":815},[1328],{"type":178,"value":807},{"type":173,"tag":327,"props":1330,"children":1331},{"style":340},[1332],{"type":178,"value":1045},{"type":173,"tag":327,"props":1334,"children":1335},{"class":329,"line":459},[1336,1340,1345,1349,1353,1357,1361,1366,1370],{"type":173,"tag":327,"props":1337,"children":1338},{"style":793},[1339],{"type":178,"value":1008},{"type":173,"tag":327,"props":1341,"children":1342},{"style":1011},[1343],{"type":178,"value":1344},"@element-plus/locale/*",{"type":173,"tag":327,"props":1346,"children":1347},{"style":793},[1348],{"type":178,"value":807},{"type":173,"tag":327,"props":1350,"children":1351},{"style":340},[1352],{"type":178,"value":812},{"type":173,"tag":327,"props":1354,"children":1355},{"style":340},[1356],{"type":178,"value":1027},{"type":173,"tag":327,"props":1358,"children":1359},{"style":815},[1360],{"type":178,"value":807},{"type":173,"tag":327,"props":1362,"children":1363},{"style":821},[1364],{"type":178,"value":1365},"packages/locale/*",{"type":173,"tag":327,"props":1367,"children":1368},{"style":815},[1369],{"type":178,"value":807},{"type":173,"tag":327,"props":1371,"children":1372},{"style":340},[1373],{"type":178,"value":1045},{"type":173,"tag":327,"props":1375,"children":1376},{"class":329,"line":468},[1377,1381,1385,1389,1393,1397,1401,1406,1410],{"type":173,"tag":327,"props":1378,"children":1379},{"style":793},[1380],{"type":178,"value":1008},{"type":173,"tag":327,"props":1382,"children":1383},{"style":1011},[1384],{"type":178,"value":824},{"type":173,"tag":327,"props":1386,"children":1387},{"style":793},[1388],{"type":178,"value":807},{"type":173,"tag":327,"props":1390,"children":1391},{"style":340},[1392],{"type":178,"value":812},{"type":173,"tag":327,"props":1394,"children":1395},{"style":340},[1396],{"type":178,"value":1027},{"type":173,"tag":327,"props":1398,"children":1399},{"style":815},[1400],{"type":178,"value":807},{"type":173,"tag":327,"props":1402,"children":1403},{"style":821},[1404],{"type":178,"value":1405},"packages/element-plus",{"type":173,"tag":327,"props":1407,"children":1408},{"style":815},[1409],{"type":178,"value":807},{"type":173,"tag":327,"props":1411,"children":1412},{"style":340},[1413],{"type":178,"value":1414},"]\n",{"type":173,"tag":327,"props":1416,"children":1417},{"class":329,"line":481},[1418],{"type":173,"tag":327,"props":1419,"children":1420},{"style":340},[1421],{"type":178,"value":1422},"    }\n",{"type":173,"tag":327,"props":1424,"children":1425},{"class":329,"line":490},[1426],{"type":173,"tag":327,"props":1427,"children":1428},{"style":340},[1429],{"type":178,"value":902},{"type":173,"tag":327,"props":1431,"children":1432},{"class":329,"line":503},[1433],{"type":173,"tag":327,"props":1434,"children":1435},{"style":340},[1436],{"type":178,"value":910},{"type":173,"tag":216,"props":1438,"children":1440},{"id":1439},"子包的另一种消费方式bundless-stub-模式",[1441],{"type":178,"value":1442},"子包的另一种消费方式：bundless stub 模式",{"type":173,"tag":174,"props":1444,"children":1445},{},[1446,1448,1455],{"type":178,"value":1447},"除了使用 TypeScript 将 TS 代码编译成 JS 供 NodeJS 执行，子包代码还可能通过“源码 -> 编译产物 -> 其他子包”这种方式被消费。比如，internal 目录下如 internal/build 等子包也打算用作公开发布，所以使用了 unbuild 这个打包工具打包（只是后来相关计划被推迟或放弃，见 ",{"type":173,"tag":181,"props":1449,"children":1452},{"href":1450,"rel":1451},"https://github.com/element-plus/element-plus/discussions/8288",[185],[1453],{"type":178,"value":1454},"Next Step of Element Plus",{"type":178,"value":1456},"）。",{"type":173,"tag":174,"props":1458,"children":1459},{},[1460],{"type":178,"value":1461},"internal/build 子包的打包指令是 “unbuild --stub”，这是个啥？对于 TypeScript 项目，我需要在打包时生成 CJS、EMS 模块和类型声明文件，unbuild 就是用于此类用途的开箱即用工具。unbuild 基于 rollup 和 mkdist，将 TS、CSS 等代码转换为 Bundless 产物，此理念先进且符合开发趋势，尽管在 unbuild 引入 EP 的 2022 之后，我们见到了更多支持库打包且完成度更高的打包器如 Vite。",{"type":173,"tag":174,"props":1463,"children":1464},{},[1465,1467,1474],{"type":178,"value":1466},"关于 bundless 的介绍见：",{"type":173,"tag":181,"props":1468,"children":1471},{"href":1469,"rel":1470},"https://zhuanlan.zhihu.com/p/553859426",[185],[1472],{"type":178,"value":1473},"Bundle-less 深入理解与实践",{"type":178,"value":198},{"type":173,"tag":174,"props":1476,"children":1477},{},[1478,1480,1487],{"type":178,"value":1479},"至于 stub，没有找到一个惯用的翻译，单词直译叫“插桩”。stub 模式依赖 ",{"type":173,"tag":181,"props":1481,"children":1484},{"href":1482,"rel":1483},"https://github.com/unjs/jiti",[185],[1485],{"type":178,"value":1486},"jiti",{"type":178,"value":1488}," 这个 NodeJS 模块加载器，以便在运行时支持 ESM 和 CJS 模块以及 TypeScript 源码的动态加载。插桩的意思很直白，unbuild 实际上并没有把 internal/build 的源码编译成 JS，而是在子包的 dist 目录生成了子包源码的入口文件，见 package.json：",{"type":173,"tag":316,"props":1490,"children":1492},{"className":773,"code":1491,"language":775,"meta":166,"style":166},"{\n  \"name\": \"@element-plus/build\",\n  \"description\": \"Build Toolchain for Element Plus\",\n  \"main\": \"./dist/index.cjs\",\n  \"module\": \"./dist/index.mjs\",\n  \"types\": \"./dist/index.d.ts\",\n}\n",[1493],{"type":173,"tag":323,"props":1494,"children":1495},{"__ignoreMap":166},[1496,1503,1538,1575,1612,1649,1686],{"type":173,"tag":327,"props":1497,"children":1498},{"class":329,"line":330},[1499],{"type":173,"tag":327,"props":1500,"children":1501},{"style":340},[1502],{"type":178,"value":787},{"type":173,"tag":327,"props":1504,"children":1505},{"class":329,"line":346},[1506,1510,1514,1518,1522,1526,1530,1534],{"type":173,"tag":327,"props":1507,"children":1508},{"style":793},[1509],{"type":178,"value":796},{"type":173,"tag":327,"props":1511,"children":1512},{"style":799},[1513],{"type":178,"value":802},{"type":173,"tag":327,"props":1515,"children":1516},{"style":793},[1517],{"type":178,"value":807},{"type":173,"tag":327,"props":1519,"children":1520},{"style":340},[1521],{"type":178,"value":812},{"type":173,"tag":327,"props":1523,"children":1524},{"style":815},[1525],{"type":178,"value":818},{"type":173,"tag":327,"props":1527,"children":1528},{"style":821},[1529],{"type":178,"value":872},{"type":173,"tag":327,"props":1531,"children":1532},{"style":815},[1533],{"type":178,"value":807},{"type":173,"tag":327,"props":1535,"children":1536},{"style":340},[1537],{"type":178,"value":833},{"type":173,"tag":327,"props":1539,"children":1540},{"class":329,"line":356},[1541,1545,1550,1554,1558,1562,1567,1571],{"type":173,"tag":327,"props":1542,"children":1543},{"style":793},[1544],{"type":178,"value":796},{"type":173,"tag":327,"props":1546,"children":1547},{"style":799},[1548],{"type":178,"value":1549},"description",{"type":173,"tag":327,"props":1551,"children":1552},{"style":793},[1553],{"type":178,"value":807},{"type":173,"tag":327,"props":1555,"children":1556},{"style":340},[1557],{"type":178,"value":812},{"type":173,"tag":327,"props":1559,"children":1560},{"style":815},[1561],{"type":178,"value":818},{"type":173,"tag":327,"props":1563,"children":1564},{"style":821},[1565],{"type":178,"value":1566},"Build Toolchain for Element Plus",{"type":173,"tag":327,"props":1568,"children":1569},{"style":815},[1570],{"type":178,"value":807},{"type":173,"tag":327,"props":1572,"children":1573},{"style":340},[1574],{"type":178,"value":833},{"type":173,"tag":327,"props":1576,"children":1577},{"class":329,"line":371},[1578,1582,1587,1591,1595,1599,1604,1608],{"type":173,"tag":327,"props":1579,"children":1580},{"style":793},[1581],{"type":178,"value":796},{"type":173,"tag":327,"props":1583,"children":1584},{"style":799},[1585],{"type":178,"value":1586},"main",{"type":173,"tag":327,"props":1588,"children":1589},{"style":793},[1590],{"type":178,"value":807},{"type":173,"tag":327,"props":1592,"children":1593},{"style":340},[1594],{"type":178,"value":812},{"type":173,"tag":327,"props":1596,"children":1597},{"style":815},[1598],{"type":178,"value":818},{"type":173,"tag":327,"props":1600,"children":1601},{"style":821},[1602],{"type":178,"value":1603},"./dist/index.cjs",{"type":173,"tag":327,"props":1605,"children":1606},{"style":815},[1607],{"type":178,"value":807},{"type":173,"tag":327,"props":1609,"children":1610},{"style":340},[1611],{"type":178,"value":833},{"type":173,"tag":327,"props":1613,"children":1614},{"class":329,"line":380},[1615,1619,1624,1628,1632,1636,1641,1645],{"type":173,"tag":327,"props":1616,"children":1617},{"style":793},[1618],{"type":178,"value":796},{"type":173,"tag":327,"props":1620,"children":1621},{"style":799},[1622],{"type":178,"value":1623},"module",{"type":173,"tag":327,"props":1625,"children":1626},{"style":793},[1627],{"type":178,"value":807},{"type":173,"tag":327,"props":1629,"children":1630},{"style":340},[1631],{"type":178,"value":812},{"type":173,"tag":327,"props":1633,"children":1634},{"style":815},[1635],{"type":178,"value":818},{"type":173,"tag":327,"props":1637,"children":1638},{"style":821},[1639],{"type":178,"value":1640},"./dist/index.mjs",{"type":173,"tag":327,"props":1642,"children":1643},{"style":815},[1644],{"type":178,"value":807},{"type":173,"tag":327,"props":1646,"children":1647},{"style":340},[1648],{"type":178,"value":833},{"type":173,"tag":327,"props":1650,"children":1651},{"class":329,"line":393},[1652,1656,1661,1665,1669,1673,1678,1682],{"type":173,"tag":327,"props":1653,"children":1654},{"style":793},[1655],{"type":178,"value":796},{"type":173,"tag":327,"props":1657,"children":1658},{"style":799},[1659],{"type":178,"value":1660},"types",{"type":173,"tag":327,"props":1662,"children":1663},{"style":793},[1664],{"type":178,"value":807},{"type":173,"tag":327,"props":1666,"children":1667},{"style":340},[1668],{"type":178,"value":812},{"type":173,"tag":327,"props":1670,"children":1671},{"style":815},[1672],{"type":178,"value":818},{"type":173,"tag":327,"props":1674,"children":1675},{"style":821},[1676],{"type":178,"value":1677},"./dist/index.d.ts",{"type":173,"tag":327,"props":1679,"children":1680},{"style":815},[1681],{"type":178,"value":807},{"type":173,"tag":327,"props":1683,"children":1684},{"style":340},[1685],{"type":178,"value":833},{"type":173,"tag":327,"props":1687,"children":1688},{"class":329,"line":402},[1689],{"type":173,"tag":327,"props":1690,"children":1691},{"style":340},[1692],{"type":178,"value":910},{"type":173,"tag":174,"props":1694,"children":1695},{},[1696],{"type":178,"value":1697},"入口文件的结构很简单，以 index.cjs 为例。当 NodeJS 解释执行 index.cjs 时，会根据 esmResolve、alias 等参数加载 element-plus 依赖目录中的 jiti 模块，重写了 NodeJS 加载函数（jiti 的功能），再根据最后一个参数读取到入口文件对应的真实源文件地址执行。不编译而是动态加载带来的好处也很明显，实时修改源码就可以重新执行，节约了“watch+compile”的时间。",{"type":173,"tag":316,"props":1699,"children":1703},{"className":1700,"code":1701,"language":1702,"meta":166,"style":166},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","module.exports = require(\"/your-element-plus-in-computer/element-plus/node_modules/.pnpm/jiti@1.21.6/node_modules/jiti/lib/index.js\")(null, {\n  \"esmResolve\": true,\n  \"interopDefault\": true,\n  \"alias\": {\n    \"@element-plus/build\": \"/your-element-plus-in-computer/element-plus/internal/build\"\n  }\n})(\"/your-element-plus-in-computer/element-plus/internal/build/src/index.ts\")\n","js",[1704],{"type":173,"tag":323,"props":1705,"children":1706},{"__ignoreMap":166},[1707,1776,1807,1835,1859,1891,1898],{"type":173,"tag":327,"props":1708,"children":1709},{"class":329,"line":330},[1710,1714,1719,1724,1730,1736,1742,1747,1752,1756,1761,1767,1772],{"type":173,"tag":327,"props":1711,"children":1712},{"style":793},[1713],{"type":178,"value":1623},{"type":173,"tag":327,"props":1715,"children":1716},{"style":340},[1717],{"type":178,"value":1718},".",{"type":173,"tag":327,"props":1720,"children":1721},{"style":793},[1722],{"type":178,"value":1723},"exports",{"type":173,"tag":327,"props":1725,"children":1727},{"style":1726},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1728],{"type":178,"value":1729}," =",{"type":173,"tag":327,"props":1731,"children":1733},{"style":1732},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1734],{"type":178,"value":1735}," require",{"type":173,"tag":327,"props":1737,"children":1739},{"style":1738},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[1740],{"type":178,"value":1741},"(",{"type":173,"tag":327,"props":1743,"children":1745},{"style":1744},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[1746],{"type":178,"value":807},{"type":173,"tag":327,"props":1748,"children":1749},{"style":365},[1750],{"type":178,"value":1751},"/your-element-plus-in-computer/element-plus/node_modules/.pnpm/jiti@1.21.6/node_modules/jiti/lib/index.js",{"type":173,"tag":327,"props":1753,"children":1754},{"style":1744},[1755],{"type":178,"value":807},{"type":173,"tag":327,"props":1757,"children":1758},{"style":1738},[1759],{"type":178,"value":1760},")(",{"type":173,"tag":327,"props":1762,"children":1764},{"style":1763},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1765],{"type":178,"value":1766},"null",{"type":173,"tag":327,"props":1768,"children":1769},{"style":340},[1770],{"type":178,"value":1771},",",{"type":173,"tag":327,"props":1773,"children":1774},{"style":340},[1775],{"type":178,"value":858},{"type":173,"tag":327,"props":1777,"children":1778},{"class":329,"line":346},[1779,1783,1789,1793,1797,1803],{"type":173,"tag":327,"props":1780,"children":1781},{"style":1744},[1782],{"type":178,"value":796},{"type":173,"tag":327,"props":1784,"children":1786},{"style":1785},"--shiki-light:#E53935;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[1787],{"type":178,"value":1788},"esmResolve",{"type":173,"tag":327,"props":1790,"children":1791},{"style":1744},[1792],{"type":178,"value":807},{"type":173,"tag":327,"props":1794,"children":1795},{"style":340},[1796],{"type":178,"value":812},{"type":173,"tag":327,"props":1798,"children":1800},{"style":1799},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1801],{"type":178,"value":1802}," true",{"type":173,"tag":327,"props":1804,"children":1805},{"style":340},[1806],{"type":178,"value":833},{"type":173,"tag":327,"props":1808,"children":1809},{"class":329,"line":356},[1810,1814,1819,1823,1827,1831],{"type":173,"tag":327,"props":1811,"children":1812},{"style":1744},[1813],{"type":178,"value":796},{"type":173,"tag":327,"props":1815,"children":1816},{"style":1785},[1817],{"type":178,"value":1818},"interopDefault",{"type":173,"tag":327,"props":1820,"children":1821},{"style":1744},[1822],{"type":178,"value":807},{"type":173,"tag":327,"props":1824,"children":1825},{"style":340},[1826],{"type":178,"value":812},{"type":173,"tag":327,"props":1828,"children":1829},{"style":1799},[1830],{"type":178,"value":1802},{"type":173,"tag":327,"props":1832,"children":1833},{"style":340},[1834],{"type":178,"value":833},{"type":173,"tag":327,"props":1836,"children":1837},{"class":329,"line":371},[1838,1842,1847,1851,1855],{"type":173,"tag":327,"props":1839,"children":1840},{"style":1744},[1841],{"type":178,"value":796},{"type":173,"tag":327,"props":1843,"children":1844},{"style":1785},[1845],{"type":178,"value":1846},"alias",{"type":173,"tag":327,"props":1848,"children":1849},{"style":1744},[1850],{"type":178,"value":807},{"type":173,"tag":327,"props":1852,"children":1853},{"style":340},[1854],{"type":178,"value":812},{"type":173,"tag":327,"props":1856,"children":1857},{"style":340},[1858],{"type":178,"value":858},{"type":173,"tag":327,"props":1860,"children":1861},{"class":329,"line":380},[1862,1866,1870,1874,1878,1882,1887],{"type":173,"tag":327,"props":1863,"children":1864},{"style":1744},[1865],{"type":178,"value":866},{"type":173,"tag":327,"props":1867,"children":1868},{"style":1785},[1869],{"type":178,"value":872},{"type":173,"tag":327,"props":1871,"children":1872},{"style":1744},[1873],{"type":178,"value":807},{"type":173,"tag":327,"props":1875,"children":1876},{"style":340},[1877],{"type":178,"value":812},{"type":173,"tag":327,"props":1879,"children":1880},{"style":1744},[1881],{"type":178,"value":818},{"type":173,"tag":327,"props":1883,"children":1884},{"style":365},[1885],{"type":178,"value":1886},"/your-element-plus-in-computer/element-plus/internal/build",{"type":173,"tag":327,"props":1888,"children":1889},{"style":1744},[1890],{"type":178,"value":894},{"type":173,"tag":327,"props":1892,"children":1893},{"class":329,"line":393},[1894],{"type":173,"tag":327,"props":1895,"children":1896},{"style":340},[1897],{"type":178,"value":902},{"type":173,"tag":327,"props":1899,"children":1900},{"class":329,"line":402},[1901,1906,1910,1914,1919,1923],{"type":173,"tag":327,"props":1902,"children":1903},{"style":340},[1904],{"type":178,"value":1905},"}",{"type":173,"tag":327,"props":1907,"children":1908},{"style":1738},[1909],{"type":178,"value":1760},{"type":173,"tag":327,"props":1911,"children":1912},{"style":1744},[1913],{"type":178,"value":807},{"type":173,"tag":327,"props":1915,"children":1916},{"style":365},[1917],{"type":178,"value":1918},"/your-element-plus-in-computer/element-plus/internal/build/src/index.ts",{"type":173,"tag":327,"props":1920,"children":1921},{"style":1744},[1922],{"type":178,"value":807},{"type":173,"tag":327,"props":1924,"children":1925},{"style":1738},[1926],{"type":178,"value":1927},")\n",{"type":173,"tag":174,"props":1929,"children":1930},{},[1931,1933,1940],{"type":178,"value":1932},"所以，stub 模式（插桩模式）就是指在不编译源码的情景中，通过创建 dist 目录下的入口文件，并使用 jiti 动态加载源码的方式来消费子包代码。stub 模式是一种临时的解决办法，如果 EP 的工程化工具链还会更新的话，还需要完善一下生产环境下的打包，见 ",{"type":173,"tag":181,"props":1934,"children":1937},{"href":1935,"rel":1936},"https://github.com/sxzz/element-plus-next",[185],[1938],{"type":178,"value":1939},"element-plus-next",{"type":178,"value":198},{"type":173,"tag":174,"props":1942,"children":1943},{},[1944,1946,1953,1955,1962],{"type":178,"value":1945},"最后，jiti 是 unjs 下的项目，掘金有文章介绍了 unjs 下其他好用的工具，可以围观一下：",{"type":173,"tag":181,"props":1947,"children":1950},{"href":1948,"rel":1949},"https://juejin.cn/post/7448464856619843619",[185],[1951],{"type":178,"value":1952},"unjs工具介绍",{"type":178,"value":1954},"。关于 unbuild，项目作者似乎将精力放在了基于 oxc + rolldown 的新打包工具 obuild 上，见 ",{"type":173,"tag":181,"props":1956,"children":1959},{"href":1957,"rel":1958},"https://github.com/unjs/obuild",[185],[1960],{"type":178,"value":1961},"obuild",{"type":178,"value":198},{"type":173,"tag":210,"props":1964,"children":1966},{"id":1965},"工程环境",[1967],{"type":178,"value":1965},{"type":173,"tag":216,"props":1969,"children":1971},{"id":1970},"packagejson-的各个配置作用",[1972],{"type":178,"value":1973},"package.json 的各个配置作用",{"type":173,"tag":216,"props":1975,"children":1977},{"id":1976},"鲜为人知的-ide-配置",[1978],{"type":178,"value":1979},"鲜为人知的 IDE 配置",{"type":173,"tag":216,"props":1981,"children":1983},{"id":1982},"pnpm-相关知识",[1984],{"type":178,"value":1985},"pnpm 相关知识",{"type":173,"tag":210,"props":1987,"children":1989},{"id":1988},"开发模式",[1990],{"type":178,"value":1988},{"type":173,"tag":216,"props":1992,"children":1994},{"id":1993},"模块化是如何代码结构体现的",[1995],{"type":178,"value":1996},"“模块化”是如何代码结构体现的？",{"type":173,"tag":216,"props":1998,"children":2000},{"id":1999},"创建新组件不必手动复制粘贴",[2001],{"type":178,"value":1999},{"type":173,"tag":210,"props":2003,"children":2005},{"id":2004},"项目生态",[2006],{"type":178,"value":2004},{"type":173,"tag":216,"props":2008,"children":2010},{"id":2009},"按需引入插件的工作原理",[2011],{"type":178,"value":2012},"按需引入插件的工作原理？",{"type":173,"tag":174,"props":2014,"children":2015},{},[2016],{"type":178,"value":2017},"在 element-ui 时代，项目一般使用 babel-plugin-component 这个插件来实现按需引入。简单来说，babel-plugin-component 会自动把引入的内容作语法转换，以便正确处理引入的内容。",{"type":173,"tag":316,"props":2019,"children":2021},{"className":1700,"code":2020,"language":1702,"meta":166,"style":166},"// 如下面这行代码：\nimport { Button } from \"[libraryName]\"\n// 最终转化成为以下两行新代码：\nconst button = require(\"[libraryName]/lib/button\")\nrequire(\"[libraryName]/lib/[styleLibraryName]/button.css\")\n",[2022],{"type":173,"tag":323,"props":2023,"children":2024},{"__ignoreMap":166},[2025,2033,2075,2083,2127],{"type":173,"tag":327,"props":2026,"children":2027},{"class":329,"line":330},[2028],{"type":173,"tag":327,"props":2029,"children":2030},{"style":350},[2031],{"type":178,"value":2032},"// 如下面这行代码：\n",{"type":173,"tag":327,"props":2034,"children":2035},{"class":329,"line":346},[2036,2042,2047,2052,2057,2062,2066,2071],{"type":173,"tag":327,"props":2037,"children":2039},{"style":2038},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[2040],{"type":178,"value":2041},"import",{"type":173,"tag":327,"props":2043,"children":2044},{"style":340},[2045],{"type":178,"value":2046}," {",{"type":173,"tag":327,"props":2048,"children":2049},{"style":1738},[2050],{"type":178,"value":2051}," Button",{"type":173,"tag":327,"props":2053,"children":2054},{"style":340},[2055],{"type":178,"value":2056}," }",{"type":173,"tag":327,"props":2058,"children":2059},{"style":2038},[2060],{"type":178,"value":2061}," from",{"type":173,"tag":327,"props":2063,"children":2064},{"style":1744},[2065],{"type":178,"value":818},{"type":173,"tag":327,"props":2067,"children":2068},{"style":365},[2069],{"type":178,"value":2070},"[libraryName]",{"type":173,"tag":327,"props":2072,"children":2073},{"style":1744},[2074],{"type":178,"value":894},{"type":173,"tag":327,"props":2076,"children":2077},{"class":329,"line":356},[2078],{"type":173,"tag":327,"props":2079,"children":2080},{"style":350},[2081],{"type":178,"value":2082},"// 最终转化成为以下两行新代码：\n",{"type":173,"tag":327,"props":2084,"children":2085},{"class":329,"line":371},[2086,2092,2098,2102,2106,2110,2114,2119,2123],{"type":173,"tag":327,"props":2087,"children":2089},{"style":2088},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[2090],{"type":178,"value":2091},"const",{"type":173,"tag":327,"props":2093,"children":2095},{"style":2094},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[2096],{"type":178,"value":2097}," button",{"type":173,"tag":327,"props":2099,"children":2100},{"style":1726},[2101],{"type":178,"value":1729},{"type":173,"tag":327,"props":2103,"children":2104},{"style":1732},[2105],{"type":178,"value":1735},{"type":173,"tag":327,"props":2107,"children":2108},{"style":1738},[2109],{"type":178,"value":1741},{"type":173,"tag":327,"props":2111,"children":2112},{"style":1744},[2113],{"type":178,"value":807},{"type":173,"tag":327,"props":2115,"children":2116},{"style":365},[2117],{"type":178,"value":2118},"[libraryName]/lib/button",{"type":173,"tag":327,"props":2120,"children":2121},{"style":1744},[2122],{"type":178,"value":807},{"type":173,"tag":327,"props":2124,"children":2125},{"style":1738},[2126],{"type":178,"value":1927},{"type":173,"tag":327,"props":2128,"children":2129},{"class":329,"line":380},[2130,2135,2139,2143,2148,2152],{"type":173,"tag":327,"props":2131,"children":2132},{"style":1732},[2133],{"type":178,"value":2134},"require",{"type":173,"tag":327,"props":2136,"children":2137},{"style":1738},[2138],{"type":178,"value":1741},{"type":173,"tag":327,"props":2140,"children":2141},{"style":1744},[2142],{"type":178,"value":807},{"type":173,"tag":327,"props":2144,"children":2145},{"style":365},[2146],{"type":178,"value":2147},"[libraryName]/lib/[styleLibraryName]/button.css",{"type":173,"tag":327,"props":2149,"children":2150},{"style":1744},[2151],{"type":178,"value":807},{"type":173,"tag":327,"props":2153,"children":2154},{"style":1738},[2155],{"type":178,"value":1927},{"type":173,"tag":174,"props":2157,"children":2158},{},[2159,2161,2168],{"type":178,"value":2160},"在 Vue3 时代则使用 ",{"type":173,"tag":181,"props":2162,"children":2165},{"href":2163,"rel":2164},"https://github.com/unplugin/unplugin-vue-components",[185],[2166],{"type":178,"value":2167},"unplugin-vue-components",{"type":178,"value":2169},"，在自动导入的基础上，实现了按需引入的功能。",{"type":173,"tag":174,"props":2171,"children":2172},{},[2173],{"type":178,"value":2174},"unplugin-vue-components 的工作原理和 babel-plugin-component 类似。功能上而言，他会把 vue 模版编译结果中的 resolveComponent 函数替换：",{"type":173,"tag":316,"props":2176,"children":2178},{"className":1700,"code":2177,"language":1702,"meta":166,"style":166},"// 如下面结构代码：\nfunction _sfc_render() {\n  const _component_button = resolveComponent(\"el-button\")\n  return xxx\n}\n// 最终转化成为以下结构新代码：\nimport { ElButton as __unplugin_components_0 } from \"element-plus\"\nimport \"element-plus/lib/theme-chalk/button.css\"\nfunction _sfc_render() {\n  const _component_button = __unplugin_components_0\n  return xxx\n}\n",[2179],{"type":173,"tag":323,"props":2180,"children":2181},{"__ignoreMap":166},[2182,2190,2212,2256,2269,2276,2284,2330,2350,2369,2389,2400],{"type":173,"tag":327,"props":2183,"children":2184},{"class":329,"line":330},[2185],{"type":173,"tag":327,"props":2186,"children":2187},{"style":350},[2188],{"type":178,"value":2189},"// 如下面结构代码：\n",{"type":173,"tag":327,"props":2191,"children":2192},{"class":329,"line":346},[2193,2198,2203,2208],{"type":173,"tag":327,"props":2194,"children":2195},{"style":2088},[2196],{"type":178,"value":2197},"function",{"type":173,"tag":327,"props":2199,"children":2200},{"style":1732},[2201],{"type":178,"value":2202}," _sfc_render",{"type":173,"tag":327,"props":2204,"children":2205},{"style":340},[2206],{"type":178,"value":2207},"()",{"type":173,"tag":327,"props":2209,"children":2210},{"style":340},[2211],{"type":178,"value":858},{"type":173,"tag":327,"props":2213,"children":2214},{"class":329,"line":356},[2215,2220,2225,2229,2234,2239,2243,2248,2252],{"type":173,"tag":327,"props":2216,"children":2217},{"style":2088},[2218],{"type":178,"value":2219},"  const",{"type":173,"tag":327,"props":2221,"children":2222},{"style":2094},[2223],{"type":178,"value":2224}," _component_button",{"type":173,"tag":327,"props":2226,"children":2227},{"style":1726},[2228],{"type":178,"value":1729},{"type":173,"tag":327,"props":2230,"children":2231},{"style":1732},[2232],{"type":178,"value":2233}," resolveComponent",{"type":173,"tag":327,"props":2235,"children":2237},{"style":2236},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[2238],{"type":178,"value":1741},{"type":173,"tag":327,"props":2240,"children":2241},{"style":1744},[2242],{"type":178,"value":807},{"type":173,"tag":327,"props":2244,"children":2245},{"style":365},[2246],{"type":178,"value":2247},"el-button",{"type":173,"tag":327,"props":2249,"children":2250},{"style":1744},[2251],{"type":178,"value":807},{"type":173,"tag":327,"props":2253,"children":2254},{"style":2236},[2255],{"type":178,"value":1927},{"type":173,"tag":327,"props":2257,"children":2258},{"class":329,"line":371},[2259,2264],{"type":173,"tag":327,"props":2260,"children":2261},{"style":2038},[2262],{"type":178,"value":2263},"  return",{"type":173,"tag":327,"props":2265,"children":2266},{"style":1738},[2267],{"type":178,"value":2268}," xxx\n",{"type":173,"tag":327,"props":2270,"children":2271},{"class":329,"line":380},[2272],{"type":173,"tag":327,"props":2273,"children":2274},{"style":340},[2275],{"type":178,"value":910},{"type":173,"tag":327,"props":2277,"children":2278},{"class":329,"line":393},[2279],{"type":173,"tag":327,"props":2280,"children":2281},{"style":350},[2282],{"type":178,"value":2283},"// 最终转化成为以下结构新代码：\n",{"type":173,"tag":327,"props":2285,"children":2286},{"class":329,"line":402},[2287,2291,2295,2300,2305,2310,2314,2318,2322,2326],{"type":173,"tag":327,"props":2288,"children":2289},{"style":2038},[2290],{"type":178,"value":2041},{"type":173,"tag":327,"props":2292,"children":2293},{"style":340},[2294],{"type":178,"value":2046},{"type":173,"tag":327,"props":2296,"children":2297},{"style":1738},[2298],{"type":178,"value":2299}," ElButton",{"type":173,"tag":327,"props":2301,"children":2302},{"style":2038},[2303],{"type":178,"value":2304}," as",{"type":173,"tag":327,"props":2306,"children":2307},{"style":1738},[2308],{"type":178,"value":2309}," __unplugin_components_0",{"type":173,"tag":327,"props":2311,"children":2312},{"style":340},[2313],{"type":178,"value":2056},{"type":173,"tag":327,"props":2315,"children":2316},{"style":2038},[2317],{"type":178,"value":2061},{"type":173,"tag":327,"props":2319,"children":2320},{"style":1744},[2321],{"type":178,"value":818},{"type":173,"tag":327,"props":2323,"children":2324},{"style":365},[2325],{"type":178,"value":824},{"type":173,"tag":327,"props":2327,"children":2328},{"style":1744},[2329],{"type":178,"value":894},{"type":173,"tag":327,"props":2331,"children":2332},{"class":329,"line":415},[2333,2337,2341,2346],{"type":173,"tag":327,"props":2334,"children":2335},{"style":2038},[2336],{"type":178,"value":2041},{"type":173,"tag":327,"props":2338,"children":2339},{"style":1744},[2340],{"type":178,"value":818},{"type":173,"tag":327,"props":2342,"children":2343},{"style":365},[2344],{"type":178,"value":2345},"element-plus/lib/theme-chalk/button.css",{"type":173,"tag":327,"props":2347,"children":2348},{"style":1744},[2349],{"type":178,"value":894},{"type":173,"tag":327,"props":2351,"children":2352},{"class":329,"line":424},[2353,2357,2361,2365],{"type":173,"tag":327,"props":2354,"children":2355},{"style":2088},[2356],{"type":178,"value":2197},{"type":173,"tag":327,"props":2358,"children":2359},{"style":1732},[2360],{"type":178,"value":2202},{"type":173,"tag":327,"props":2362,"children":2363},{"style":340},[2364],{"type":178,"value":2207},{"type":173,"tag":327,"props":2366,"children":2367},{"style":340},[2368],{"type":178,"value":858},{"type":173,"tag":327,"props":2370,"children":2371},{"class":329,"line":437},[2372,2376,2380,2384],{"type":173,"tag":327,"props":2373,"children":2374},{"style":2088},[2375],{"type":178,"value":2219},{"type":173,"tag":327,"props":2377,"children":2378},{"style":2094},[2379],{"type":178,"value":2224},{"type":173,"tag":327,"props":2381,"children":2382},{"style":1726},[2383],{"type":178,"value":1729},{"type":173,"tag":327,"props":2385,"children":2386},{"style":1738},[2387],{"type":178,"value":2388}," __unplugin_components_0\n",{"type":173,"tag":327,"props":2390,"children":2391},{"class":329,"line":446},[2392,2396],{"type":173,"tag":327,"props":2393,"children":2394},{"style":2038},[2395],{"type":178,"value":2263},{"type":173,"tag":327,"props":2397,"children":2398},{"style":1738},[2399],{"type":178,"value":2268},{"type":173,"tag":327,"props":2401,"children":2402},{"class":329,"line":459},[2403],{"type":173,"tag":327,"props":2404,"children":2405},{"style":340},[2406],{"type":178,"value":910},{"type":173,"tag":174,"props":2408,"children":2409},{},[2410,2412,2419],{"type":178,"value":2411},"考虑到不同组件库结构、功能特性、历史版本兼容性等不一致因素，不同组件库的 unplugin-vue-components 插件的技术实现细节不一样。代码详见：",{"type":173,"tag":181,"props":2413,"children":2416},{"href":2414,"rel":2415},"https://github.com/unplugin/unplugin-vue-components/blob/main/src/core/resolvers/element-plus.ts",[185],[2417],{"type":178,"value":2418},"unplugin-vue-components/element-plus",{"type":178,"value":198},{"type":173,"tag":216,"props":2421,"children":2423},{"id":2422},"如何参与开源建设",[2424],{"type":178,"value":2425},"如何参与开源建设？",{"type":173,"tag":210,"props":2427,"children":2429},{"id":2428},"推荐阅读",[2430],{"type":178,"value":2428},{"type":173,"tag":243,"props":2432,"children":2433},{},[2434,2444],{"type":173,"tag":247,"props":2435,"children":2436},{},[2437],{"type":173,"tag":181,"props":2438,"children":2441},{"href":2439,"rel":2440},"https://github.com/element-plus/element-plus/discussions/6715",[185],[2442],{"type":178,"value":2443},"Element Plus 源码分析",{"type":173,"tag":247,"props":2445,"children":2446},{},[2447],{"type":173,"tag":181,"props":2448,"children":2451},{"href":2449,"rel":2450},"https://juejin.cn/column/7140176895999475725",[185],[2452],{"type":178,"value":2453},"Element Plus 组件库相关技术揭秘",{"type":173,"tag":2455,"props":2456,"children":2457},"style",{},[2458],{"type":178,"value":2459},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":166,"searchDepth":346,"depth":346,"links":2461},[2462,2463,2464,2465,2466,2467],{"id":212,"depth":346,"text":212},{"id":291,"depth":346,"text":291},{"id":1965,"depth":346,"text":1965},{"id":1988,"depth":346,"text":1988},{"id":2004,"depth":346,"text":2004},{"id":2428,"depth":346,"text":2428},"markdown","content:8.source-code:_js:element-plus.md","content","8.source-code/_js/element-plus.md","8.source-code/_js/element-plus",[2474,2478],{"_path":2475,"title":2476,"description":2477},"/source-code/_js/browser-extension/canvas-blocker","Canvas Blocker","Canvas Blocker 是一个浏览器扩展，能够拦截多种类型的指纹追踪。",{"_path":193,"title":2479,"description":2480},"Element UI","Element，一套为开发者、设计师和产品经理准备的基于Vue 2.0 的桌面端组件库.",1761757115793]