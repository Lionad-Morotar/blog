(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{963:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"linux"}},[s._v("Linux")]),s._v(" "),t("nav",{staticClass:"table-of-contents"},[t("ol",[t("li",[t("a",{attrs:{href:"#linux"}},[s._v("Linux")]),t("ol",[t("li",[t("a",{attrs:{href:"#系统原理"}},[s._v("系统原理")]),t("ol",[t("li",[t("a",{attrs:{href:"#什么是零拷贝技术"}},[s._v("什么是零拷贝技术？")])])])]),t("li",[t("a",{attrs:{href:"#系统编程"}},[s._v("系统编程")]),t("ol",[t("li",[t("a",{attrs:{href:"#signal-h-中常见系统信号有哪些"}},[s._v("signal.h 中常见系统信号有哪些？")])])])]),t("li",[t("a",{attrs:{href:"#脚本"}},[s._v("脚本")]),t("ol",[t("li",[t("a",{attrs:{href:"#文件的权限怎么设定"}},[s._v("文件的权限怎么设定？")])]),t("li",[t("a",{attrs:{href:"#怎么给文件重命名"}},[s._v("怎么给文件重命名？")])])])]),t("li",[t("a",{attrs:{href:"#应用"}},[s._v("应用")]),t("ol",[t("li",[t("a",{attrs:{href:"#怎么给用户添加管理员权限"}},[s._v("怎么给用户添加管理员权限？")])]),t("li",[t("a",{attrs:{href:"#如何添加快捷键"}},[s._v("如何添加快捷键？")])]),t("li",[t("a",{attrs:{href:"#文件的增删改查怎么做"}},[s._v("文件的增删改查怎么做？")])]),t("li",[t("a",{attrs:{href:"#如何使用-sftp-传输文件"}},[s._v("如何使用 SFTP 传输文件？")])])])]),t("li",[t("a",{attrs:{href:"#软件"}},[s._v("软件")]),t("ol",[t("li",[t("a",{attrs:{href:"#如何安装-nodejs"}},[s._v("如何安装 NodeJS？")])]),t("li",[t("a",{attrs:{href:"#怎样配置-nginx"}},[s._v("怎样配置 Nginx？")])]),t("li",[t("a",{attrs:{href:"#如何安装-imagemagick"}},[s._v("如何安装 ImageMagick？")])])])]),t("li",[t("a",{attrs:{href:"#links"}},[s._v("Links")]),t("ol",[t("li",[t("a",{attrs:{href:"#emfile-error-when-using-fs-watch-on-many-items"}},[s._v("《EMFILE error when using fs.watch on many items》")])])])])])])])]),t("h2",{attrs:{id:"系统原理"}},[s._v("系统原理")]),s._v(" "),t("h4",{attrs:{id:"什么是零拷贝技术"}},[s._v("什么是零拷贝技术？")]),s._v(" "),t("p",[s._v("TODO review")]),s._v(" "),t("p",[s._v("传统的文件传输需要经历四次拷贝以及四次内核态用户态切换：磁盘数据 -> dmacopy() -> 内核缓存区 -> read() -> 用户缓存区 -> write() -> 套接字缓存区 -> dmacopy() -> 网卡。read 或 write 时，系统先从用户态切换到内核态，等内核完成任务再切换回去。由于每次切换都需要消耗 50ns~100ns 的时间，所以在并发量大的情况下，会多很多不必要的开销。")]),s._v(" "),t("p",[s._v("使用 mmap 替代 read 可以把内核区中的文件直接映射到用户缓冲区，这可以减少一次 CPU 拷贝带来的消耗。")]),s._v(" "),t("p",[s._v("从 Linux 2.1 可以使用 sendFile 替代 read，数据根本不经过用户态，可以在调用 write 时，直接把数据从内核缓冲区进入到 Socket 缓存区，减少了一次 CPU 拷贝和上下文切换。")]),s._v(" "),t("p",[s._v("Linux 2.4 又进行了一些修改。在 sendFile 的基础上，如果网卡支持 SG-DMA 技术，在从用 DMA 拷贝把磁盘数据拷贝到内核缓冲区后，可以直接把内核缓存区的数据拷贝到网卡。这样一来就只有 3 次上下文切换和 2 次拷贝。为什么还有两次拷贝也能叫零拷贝呢？实际上，零拷贝应该叫零冗余拷贝，因为磁盘到内核，内核到网卡这两次拷贝并没有像 Linux 2.1 的 sendFile 一样在内核与内核之间多一次冗余拷贝（内核缓存区到 Socket 缓存区），内核只保有一份数据。")]),s._v(" "),t("p",[s._v("见："),t("a",{attrs:{href:"https://trashcode.io/post/d/Zero-copy-mmap-and-sendfile-in-detail",target:"_blank",rel:"noopener noreferrer"}},[t("i",[s._v("Zero copy : mmap and sendfile in detail")])])]),s._v(" "),t("h2",{attrs:{id:"系统编程"}},[s._v("系统编程")]),s._v(" "),t("h4",{attrs:{id:"signal-h-中常见系统信号有哪些"}},[s._v("signal.h 中常见系统信号有哪些？")]),s._v(" "),t("ul",[t("li",[s._v("SIGTERM：终止请求，发送到程序")]),s._v(" "),t("li",[s._v("SIGSEGV：无效的内存访问（分段故障）")]),s._v(" "),t("li",[s._v("SIGINT：外部中断，通常由用户发起")]),s._v(" "),t("li",[s._v("SIGILL：无效的程序映像，如无效指令")]),s._v(" "),t("li",[s._v("SIGABRT：异常终止条件，如例如由 abort() 触发")]),s._v(" "),t("li",[s._v("SIGFPE：错误的算术运算，如除以零")])]),s._v(" "),t("h2",{attrs:{id:"脚本"}},[s._v("脚本")]),s._v(" "),t("h4",{attrs:{id:"文件的权限怎么设定"}},[s._v("文件的权限怎么设定？")]),s._v(" "),t("p",[s._v("使用 chmod xxx 分别给文件所有者、所属组和其他人设定权限，x 对应 rwx 三位二进制的十进制值。如 chmod 777 中的 7 表示 rwx，有 read、write、execute 的权限。")]),s._v(" "),t("h4",{attrs:{id:"怎么给文件重命名"}},[s._v("怎么给文件重命名？")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rename")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'oldname'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'newname'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n")])])]),t("p",[s._v("今天装了 WLS，用的 Debian，但是它居然没有自带的 rename 工具，所以只好使用 apt install rename 重新安装了一个。令我诧异的是，这个 rename 的用法和上面提到的完全不一样。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rename")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"s/oldstr/newstr"')]),s._v("\n")])])]),t("h2",{attrs:{id:"应用"}},[s._v("应用")]),s._v(" "),t("h4",{attrs:{id:"怎么给用户添加管理员权限"}},[s._v("怎么给用户添加管理员权限？")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("# 打开权限文件\nsudo vim "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sudoers\n# 在 "),t("span",{pre:!0,attrs:{class:"token template-string"}},[t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("# User privilege specification")]),t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),s._v(" 下面添加权限\nuserxxx "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ALL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ALL")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ALL")]),s._v("\n# 保存退出就好了\n")])])]),t("h4",{attrs:{id:"如何添加快捷键"}},[s._v("如何添加快捷键？")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("alias")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'cd ..'")]),s._v("\n")])])]),t("h4",{attrs:{id:"文件的增删改查怎么做"}},[s._v("文件的增删改查怎么做？")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建文件夹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" xxx\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除文件/文件夹")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" xxx\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查找指令所在的目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("whereis")]),s._v(" xxx\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定位当前位置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),s._v("\n")])])]),t("h4",{attrs:{id:"如何使用-sftp-传输文件"}},[s._v("如何使用 SFTP 传输文件？")]),s._v(" "),t("p",[s._v("在 VS Code 中添加 "),t("a",{attrs:{href:"https://marketplace.visualstudio.com/items?itemName=liximomo.sftp",target:"_blank",rel:"noopener noreferrer"}},[s._v("SFTP 插件")]),s._v("，用来和服务器同步文件。配置可参考：")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Upload Blog"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"host"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xx.xxx.xx.xxx"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"protocol"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sftp"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"port"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"remotePath"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/home/lionad/blog"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"uploadOnSave"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h2",{attrs:{id:"软件"}},[s._v("软件")]),s._v(" "),t("h4",{attrs:{id:"如何安装-nodejs"}},[s._v("如何安装 NodeJS？")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除本机自带的 NodeJS")]),s._v("\nyum remove nodejs "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" npx "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除软连接")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /usr/local/bin/node\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /usr/local/bin/npm \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /usr/local/bin/npx\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载指定版本的 NodeJS 包")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://nodejs.org/dist/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Ubuntu 安装 NodeJS 见：https://github.com/nodesource/distributions")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://nodejs.org/dist/v10.15.3/node-v10.15.3-linux-x64.tar.gz\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压下载的包")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-xf")]),s._v(" node-v10.15.3-linux-x64.tar.gz\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建软连接")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /home/data/lionad/apps/node-v10.15.3-linux-x64/bin/node /usr/local/bin/node\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /home/data/lionad/apps/node-v10.15.3-linux-x64/bin/npm /usr/local/bin/npm\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" /home/data/lionad/apps/node-v10.15.3-linux-x64/bin/npx /usr/local/bin/npx\n")])])]),t("h4",{attrs:{id:"怎样配置-nginx"}},[s._v("怎样配置 Nginx？")]),s._v(" "),t("p",[s._v("以下是使用 Nginx 部署网站的基本步骤。")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改 nginx 配置文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/nginx/nginx.conf\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最后重启 nginx")]),s._v("\nnginx "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" reload\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果遇到权限问题，可以尝试按照以下方法调试")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 nginx 错误日志，在 configure file 中有错误日志的地址")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/nginx/nginx.conf\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 nginx 的程序启动者")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" aux "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更改文件夹权限")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" xxx\n")])])]),t("p",[s._v("见："),t("RouterLink",{attrs:{to:"/maps/linux/nginx/config-example.html"}},[s._v("Nginx 配置文件示例")])],1),s._v(" "),t("h4",{attrs:{id:"如何安装-imagemagick"}},[s._v("如何安装 ImageMagick？")]),s._v(" "),t("ol",[t("li",[s._v("准备开发环境")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum groupinstall "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Development Tools'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" bzip2-devel freetype-devel libjpeg-devel libpng-devel libtiff-devel giflib-devel zlib-devel ghostscript-devel djvulibre-devel libwmf-devel jasper-devel libtool-ltdl-devel libX11-devel libXext-devel libXt-devel lcms-devel libxml2-devel librsvg2-devel OpenEXR-devel php-devel\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("下载源码，解压安装")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://www.imagemagick.org/download/ImageMagick.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xvzf ImageMagick.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" ImageMagick*\n./configure\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("验证是否安装完成")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("magick "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-version")]),s._v("\n")])])]),t("h2",{attrs:{id:"links"}},[s._v("Links")]),s._v(" "),t("p",[s._v("TODO review")]),s._v(" "),t("h5",{attrs:{id:"《emfile-error-when-using-fs-watch-on-many-items》"}},[t("Link",{attrs:{type:"h5",to:"https://mgear-file.oss-cn-shanghai.aliyuncs.com/The%20History%20of%20Pandemics%2C%20by%20Death%20Toll%20-%20%E5%A4%A7%E6%B5%81%E8%A1%8C%E7%97%85%E5%8E%86%E5%8F%B2.html",source:"https://github.com/nodejs/node-v0.x-archive/issues/2479"}},[s._v("《EMFILE error when using fs.watch on many items》")])],1),s._v(" "),t("p",[s._v("Linux 单个进程只能操作有限个文件数量。可以使用 ulimit -n xxxx 突破这个限制。")])])}),[],!1,null,null,null);t.default=e.exports}}]);