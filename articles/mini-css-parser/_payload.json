[{"data":1,"prerenderedAt":4707},["Reactive",2],{"navigation":3,"/articles/mini-css-parser":389,"/articles/mini-css-parser-surround":4702},[4,32,83,99,126,132,138,372,378,384],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77,80],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":42,"_path":43},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":45,"_path":46},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":48,"_path":49},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":51,"_path":52},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":54,"_path":55},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":57,"_path":58},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":60,"_path":61},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":63,"_path":64},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":66,"_path":67},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":69,"_path":70},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":72,"_path":73},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":75,"_path":76},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":78,"_path":79},"🚝 四十二篇系列","/articles/fourty-two",{"title":81,"_path":82},"📝 技术博客归档","/articles/fold",{"title":84,"_path":85,"children":86},"造物 / Make","/tools",[87,90,93,96],{"title":88,"_path":89},"🌐 AnySort","/tools/anysort",{"title":91,"_path":92},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":94,"_path":95},"👓 Crapto","/tools/crypto-inline",{"title":97,"_path":98},"🖨️ any-to-base64","/tools/any-to-base64",{"title":100,"_path":101,"children":102},"吉他剧场 / Music","/music",[103,105,108,111,114,117,120,123],{"title":104,"_path":101},"🎸 FingerStyle！",{"title":106,"_path":107},"🌬️ 等待的风","/music/wind",{"title":109,"_path":110},"💕 约定的海洋","/music/ocean",{"title":112,"_path":113},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":115,"_path":116},"🌏 残酷天使的行动纲领","/music/eva",{"title":118,"_path":119},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":121,"_path":122},"🍷 Wu Wei","/music/wu-wei",{"title":124,"_path":125},"🌅 无题","/music/untitled",{"title":127,"_path":128,"children":129},"画点什么 / Paint","/paint",[130],{"title":131,"_path":128},"🚧 正在施工",{"title":133,"_path":134,"children":135},"知识地图 / Maps","/maps",[136],{"title":137,"_path":134},"🏁 知识地图",{"title":139,"_path":140,"children":141},"零散的笔记 / Gists","/gists",[142,144,147,150,153,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369],{"title":143,"_path":140},"🧊 Gists",{"title":145,"_path":146},"网站的可访问性","/gists/accessibility",{"title":148,"_path":149},"Bit","/gists/bit",{"title":151,"_path":152},"图片模糊","/gists/blur",{"title":154,"_path":155},"渲染相关笔记","/gists/c4d",{"title":157,"_path":158},"CDN 问题记录","/gists/cdn",{"title":160,"_path":161},"消毒剂","/gists/cleaner",{"title":163,"_path":164},"Windows Command","/gists/cmd",{"title":166,"_path":167},"Command","/gists/command",{"title":169,"_path":170},"复杂科学","/gists/complexity-science",{"title":172,"_path":173},"宇宙","/gists/cosmos",{"title":175,"_path":176},"C++","/gists/cpp",{"title":178,"_path":179},"Data Structure","/gists/data-structure",{"title":181,"_path":182},"DEPRESSION","/gists/depression",{"title":184,"_path":185},"设计模式","/gists/design-patterns",{"title":187,"_path":188},"Developer Experience","/gists/developer-experience",{"title":190,"_path":191},"Device Metrics","/gists/device-metrix",{"title":193,"_path":194},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":196,"_path":197},"正则表达式","/gists/eegex",{"title":199,"_path":200},"Emoji","/gists/emoji",{"title":202,"_path":203},"工程","/gists/engineering",{"title":205,"_path":206},"熵","/gists/entropy",{"title":208,"_path":209},"Environment","/gists/environment",{"title":211,"_path":212},"Erlang","/gists/erlang",{"title":214,"_path":215},"逃离塔克夫","/gists/escape-from-tarkov",{"title":217,"_path":218},"ESNext (ES6-ES11)","/gists/esnext",{"title":220,"_path":221},"Eval！","/gists/eval",{"title":223,"_path":224},"Flutter","/gists/flutter",{"title":226,"_path":227},"字体","/gists/font",{"title":229,"_path":230},"JS 函数式编程","/gists/functional",{"title":232,"_path":233},"Google C++ Standard","/gists/google-cpp-standard",{"title":235,"_path":236},"双向链接完全体","/gists/graph",{"title":238,"_path":239},"Hardwares","/gists/hardwares",{"title":241,"_path":242},"哈希冲突","/gists/hash-collision",{"title":244,"_path":245},"信息设计","/gists/information-design",{"title":247,"_path":248},"InstantPage","/gists/instant.page",{"title":250,"_path":251},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":253,"_path":254},"KVStore","/gists/key-value-db",{"title":256,"_path":257},"Kubernetes","/gists/kubernetes",{"title":259,"_path":260},"Makefile","/gists/makefile",{"title":262,"_path":263},"Markdown Inline Style","/gists/markdown-nice",{"title":265,"_path":266},"小程序","/gists/miniapp",{"title":268,"_path":269},"减小页面快照体积","/gists/minify-html",{"title":271,"_path":272},"mklink","/gists/mklink",{"title":274,"_path":275},"Mock","/gists/mock",{"title":277,"_path":278},"多端应用","/gists/multy-end-app",{"title":280,"_path":281},"神经科学","/gists/neuroscience",{"title":283,"_path":284},"OO","/gists/oo",{"title":286,"_path":287},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":289,"_path":290},"人物","/gists/person",{"title":292,"_path":293},"PInvoke","/gists/pinvoke",{"title":295,"_path":296},"像素","/gists/pixel",{"title":298,"_path":299},"PowerShell","/gists/powershell",{"title":301,"_path":302},"量子","/gists/quantum",{"title":304,"_path":305},"保持好奇心","/gists/questions",{"title":307,"_path":308},"React Native","/gists/react-native",{"title":310,"_path":311},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":313,"_path":314},"SEO","/gists/seo",{"title":316,"_path":317},"Shader","/gists/shader",{"title":319,"_path":320},"Shape Up","/gists/shape-up",{"title":322,"_path":323},"睡觉","/gists/sleep",{"title":325,"_path":326},"States","/gists/states",{"title":328,"_path":329},"Storage","/gists/storage",{"title":331,"_path":332},"音视频流处理","/gists/stream-cli",{"title":334,"_path":335},"Symbol","/gists/symbol",{"title":337,"_path":338},"系统论","/gists/systems-theory",{"title":340,"_path":341},"Taro","/gists/taro",{"title":343,"_path":344},"任务切片","/gists/task-slice",{"title":346,"_path":347},"技术偏好","/gists/tech-dudge",{"title":349,"_path":350},"Untitled","/gists/untitled",{"title":352,"_path":353},"可变字体","/gists/variable-font",{"title":355,"_path":356},"视觉错觉","/gists/visual-illusion",{"title":358,"_path":359},"SS(SSR)","/gists/vpn",{"title":361,"_path":362},"VS Code 插件开发","/gists/vscode-plugin",{"title":364,"_path":365},"Web Components","/gists/web-components",{"title":367,"_path":368},"Windows","/gists/windows",{"title":370,"_path":371},"查缺补漏","/gists/wrong",{"title":373,"_path":374,"children":375},"代码笔记 / Gists","/source-code",[376],{"title":377,"_path":374},"🚄 代码笔记",{"title":379,"_path":380,"children":381},"我 / Abount","/hire",[382],{"title":383,"_path":380},"📬 技术简历",{"title":385,"_path":386,"children":387},"todo","/todo",[388],{"title":385,"_path":386},{"_path":46,"_dir":390,"_draft":391,"_partial":391,"_locale":392,"title":45,"description":393,"body":394,"_type":4697,"_id":4698,"_source":4699,"_file":4700,"_extension":4701},"articles",false,"","我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。我碰到的问题是，如果 CSS 源码中带嵌套语法那么解析就会失败。今天借这个问题给大家简单介绍一下 CSS Parser 的基本流程。",{"type":395,"children":396,"toc":4688},"root",[397,405,411,427,844,850,925,934,947,952,958,981,986,1310,1315,1707,1735,1806,1811,1831,1856,1932,1937,1942,2228,2240,2332,2371,2388,2673,2717,3191,3232,3783,3794,3834,3839,3851,3952,3987,4007,4027,4032,4037,4331,4336,4343,4348,4353,4361,4369,4377,4385,4420,4519,4527,4540,4545,4602,4607,4620,4625,4631,4643,4682],{"type":398,"tag":399,"props":400,"children":402},"element","h2",{"id":401},"前言",[403],{"type":404,"value":401},"text",{"type":398,"tag":406,"props":407,"children":408},"p",{},[409],{"type":404,"value":410},"Vue 源码中包含 HTML Parser，随着大家在框架方向的深入学习（卷），不免要开始接触一些编译解析相关的东西。社区很多看 Vue 源码时总结的 HTML Parser 的文章，但是很少有介绍 CSS Parser 的文章。今天借着在开发时碰到的一个问题，给大家简单介绍一下 CSS Parser 的基本流程。",{"type":398,"tag":406,"props":412,"children":413},{},[414,416,425],{"type":404,"value":415},"我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。代码示例见下。我碰到的问题是，如果 CSS 源码中带",{"type":398,"tag":417,"props":418,"children":422},"a",{"href":419,"rel":420},"https://caniuse.com/?search=css%20nesting",[421],"nofollow",[423],{"type":404,"value":424},"嵌套语法",{"type":404,"value":426},"，那么解析就会失败。",{"type":398,"tag":428,"props":429,"children":433},"pre",{"className":430,"code":431,"language":432,"meta":392,"style":392},"language-css shiki shiki-themes material-theme-lighter github-light github-dark monokai","/* css 源代码 */\n.a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  }\n}\n\n/* 期待转化得到的代码 */\nmicro-app[name=\"test-app\"] .a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  }\n}\n\n/* 实际得到的代码 */\nmicro-app[name=\"test-app\"] .a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  } /* -> 到这里就停了 */\n","css",[434],{"type":398,"tag":435,"props":436,"children":437},"code",{"__ignoreMap":392},[438,450,471,497,517,539,548,557,567,576,637,657,673,693,701,709,717,726,774,794,810,830],{"type":398,"tag":439,"props":440,"children":443},"span",{"class":441,"line":442},"line",1,[444],{"type":398,"tag":439,"props":445,"children":447},{"style":446},"--shiki-light:#90A4AE;--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[448],{"type":404,"value":449},"/* css 源代码 */\n",{"type":398,"tag":439,"props":451,"children":453},{"class":441,"line":452},2,[454,460,465],{"type":398,"tag":439,"props":455,"children":457},{"style":456},"--shiki-light:#39ADB5;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[458],{"type":404,"value":459},".",{"type":398,"tag":439,"props":461,"children":463},{"style":462},"--shiki-light:#E2931D;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[464],{"type":404,"value":417},{"type":398,"tag":439,"props":466,"children":468},{"style":467},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[469],{"type":404,"value":470}," {\n",{"type":398,"tag":439,"props":472,"children":474},{"class":441,"line":473},3,[475,481,486,492],{"type":398,"tag":439,"props":476,"children":478},{"style":477},"--shiki-light:#8796B0;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-light-font-style:inherit;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[479],{"type":404,"value":480},"  z-index",{"type":398,"tag":439,"props":482,"children":483},{"style":467},[484],{"type":404,"value":485},":",{"type":398,"tag":439,"props":487,"children":489},{"style":488},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[490],{"type":404,"value":491}," 1",{"type":398,"tag":439,"props":493,"children":494},{"style":467},[495],{"type":404,"value":496},";\n",{"type":398,"tag":439,"props":498,"children":500},{"class":441,"line":499},4,[501,507,513],{"type":398,"tag":439,"props":502,"children":504},{"style":503},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[505],{"type":404,"value":506},"  .",{"type":398,"tag":439,"props":508,"children":510},{"style":509},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[511],{"type":404,"value":512},"b",{"type":398,"tag":439,"props":514,"children":515},{"style":503},[516],{"type":404,"value":470},{"type":398,"tag":439,"props":518,"children":520},{"class":441,"line":519},5,[521,526,530,535],{"type":398,"tag":439,"props":522,"children":523},{"style":477},[524],{"type":404,"value":525},"    z-index",{"type":398,"tag":439,"props":527,"children":528},{"style":467},[529],{"type":404,"value":485},{"type":398,"tag":439,"props":531,"children":532},{"style":488},[533],{"type":404,"value":534}," 2",{"type":398,"tag":439,"props":536,"children":537},{"style":467},[538],{"type":404,"value":496},{"type":398,"tag":439,"props":540,"children":542},{"class":441,"line":541},6,[543],{"type":398,"tag":439,"props":544,"children":545},{"style":467},[546],{"type":404,"value":547},"  }\n",{"type":398,"tag":439,"props":549,"children":551},{"class":441,"line":550},7,[552],{"type":398,"tag":439,"props":553,"children":554},{"style":503},[555],{"type":404,"value":556},"}\n",{"type":398,"tag":439,"props":558,"children":560},{"class":441,"line":559},8,[561],{"type":398,"tag":439,"props":562,"children":564},{"emptyLinePlaceholder":563},true,[565],{"type":404,"value":566},"\n",{"type":398,"tag":439,"props":568,"children":570},{"class":441,"line":569},9,[571],{"type":398,"tag":439,"props":572,"children":573},{"style":446},[574],{"type":404,"value":575},"/* 期待转化得到的代码 */\n",{"type":398,"tag":439,"props":577,"children":579},{"class":441,"line":578},10,[580,586,591,597,603,609,615,619,624,629,633],{"type":398,"tag":439,"props":581,"children":583},{"style":582},"--shiki-light:#E2931D;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[584],{"type":404,"value":585},"micro-app",{"type":398,"tag":439,"props":587,"children":588},{"style":467},[589],{"type":404,"value":590},"[",{"type":398,"tag":439,"props":592,"children":594},{"style":593},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[595],{"type":404,"value":596},"name",{"type":398,"tag":439,"props":598,"children":600},{"style":599},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[601],{"type":404,"value":602},"=",{"type":398,"tag":439,"props":604,"children":606},{"style":605},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[607],{"type":404,"value":608},"\"",{"type":398,"tag":439,"props":610,"children":612},{"style":611},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[613],{"type":404,"value":614},"test-app",{"type":398,"tag":439,"props":616,"children":617},{"style":605},[618],{"type":404,"value":608},{"type":398,"tag":439,"props":620,"children":621},{"style":467},[622],{"type":404,"value":623},"]",{"type":398,"tag":439,"props":625,"children":626},{"style":456},[627],{"type":404,"value":628}," .",{"type":398,"tag":439,"props":630,"children":631},{"style":462},[632],{"type":404,"value":417},{"type":398,"tag":439,"props":634,"children":635},{"style":467},[636],{"type":404,"value":470},{"type":398,"tag":439,"props":638,"children":640},{"class":441,"line":639},11,[641,645,649,653],{"type":398,"tag":439,"props":642,"children":643},{"style":477},[644],{"type":404,"value":480},{"type":398,"tag":439,"props":646,"children":647},{"style":467},[648],{"type":404,"value":485},{"type":398,"tag":439,"props":650,"children":651},{"style":488},[652],{"type":404,"value":491},{"type":398,"tag":439,"props":654,"children":655},{"style":467},[656],{"type":404,"value":496},{"type":398,"tag":439,"props":658,"children":660},{"class":441,"line":659},12,[661,665,669],{"type":398,"tag":439,"props":662,"children":663},{"style":503},[664],{"type":404,"value":506},{"type":398,"tag":439,"props":666,"children":667},{"style":509},[668],{"type":404,"value":512},{"type":398,"tag":439,"props":670,"children":671},{"style":503},[672],{"type":404,"value":470},{"type":398,"tag":439,"props":674,"children":676},{"class":441,"line":675},13,[677,681,685,689],{"type":398,"tag":439,"props":678,"children":679},{"style":477},[680],{"type":404,"value":525},{"type":398,"tag":439,"props":682,"children":683},{"style":467},[684],{"type":404,"value":485},{"type":398,"tag":439,"props":686,"children":687},{"style":488},[688],{"type":404,"value":534},{"type":398,"tag":439,"props":690,"children":691},{"style":467},[692],{"type":404,"value":496},{"type":398,"tag":439,"props":694,"children":696},{"class":441,"line":695},14,[697],{"type":398,"tag":439,"props":698,"children":699},{"style":467},[700],{"type":404,"value":547},{"type":398,"tag":439,"props":702,"children":704},{"class":441,"line":703},15,[705],{"type":398,"tag":439,"props":706,"children":707},{"style":503},[708],{"type":404,"value":556},{"type":398,"tag":439,"props":710,"children":712},{"class":441,"line":711},16,[713],{"type":398,"tag":439,"props":714,"children":715},{"emptyLinePlaceholder":563},[716],{"type":404,"value":566},{"type":398,"tag":439,"props":718,"children":720},{"class":441,"line":719},17,[721],{"type":398,"tag":439,"props":722,"children":723},{"style":446},[724],{"type":404,"value":725},"/* 实际得到的代码 */\n",{"type":398,"tag":439,"props":727,"children":729},{"class":441,"line":728},18,[730,734,738,742,746,750,754,758,762,766,770],{"type":398,"tag":439,"props":731,"children":732},{"style":582},[733],{"type":404,"value":585},{"type":398,"tag":439,"props":735,"children":736},{"style":467},[737],{"type":404,"value":590},{"type":398,"tag":439,"props":739,"children":740},{"style":593},[741],{"type":404,"value":596},{"type":398,"tag":439,"props":743,"children":744},{"style":599},[745],{"type":404,"value":602},{"type":398,"tag":439,"props":747,"children":748},{"style":605},[749],{"type":404,"value":608},{"type":398,"tag":439,"props":751,"children":752},{"style":611},[753],{"type":404,"value":614},{"type":398,"tag":439,"props":755,"children":756},{"style":605},[757],{"type":404,"value":608},{"type":398,"tag":439,"props":759,"children":760},{"style":467},[761],{"type":404,"value":623},{"type":398,"tag":439,"props":763,"children":764},{"style":456},[765],{"type":404,"value":628},{"type":398,"tag":439,"props":767,"children":768},{"style":462},[769],{"type":404,"value":417},{"type":398,"tag":439,"props":771,"children":772},{"style":467},[773],{"type":404,"value":470},{"type":398,"tag":439,"props":775,"children":777},{"class":441,"line":776},19,[778,782,786,790],{"type":398,"tag":439,"props":779,"children":780},{"style":477},[781],{"type":404,"value":480},{"type":398,"tag":439,"props":783,"children":784},{"style":467},[785],{"type":404,"value":485},{"type":398,"tag":439,"props":787,"children":788},{"style":488},[789],{"type":404,"value":491},{"type":398,"tag":439,"props":791,"children":792},{"style":467},[793],{"type":404,"value":496},{"type":398,"tag":439,"props":795,"children":797},{"class":441,"line":796},20,[798,802,806],{"type":398,"tag":439,"props":799,"children":800},{"style":503},[801],{"type":404,"value":506},{"type":398,"tag":439,"props":803,"children":804},{"style":509},[805],{"type":404,"value":512},{"type":398,"tag":439,"props":807,"children":808},{"style":503},[809],{"type":404,"value":470},{"type":398,"tag":439,"props":811,"children":813},{"class":441,"line":812},21,[814,818,822,826],{"type":398,"tag":439,"props":815,"children":816},{"style":477},[817],{"type":404,"value":525},{"type":398,"tag":439,"props":819,"children":820},{"style":467},[821],{"type":404,"value":485},{"type":398,"tag":439,"props":823,"children":824},{"style":488},[825],{"type":404,"value":534},{"type":398,"tag":439,"props":827,"children":828},{"style":467},[829],{"type":404,"value":496},{"type":398,"tag":439,"props":831,"children":833},{"class":441,"line":832},22,[834,839],{"type":398,"tag":439,"props":835,"children":836},{"style":467},[837],{"type":404,"value":838},"  }",{"type":398,"tag":439,"props":840,"children":841},{"style":446},[842],{"type":404,"value":843}," /* -> 到这里就停了 */\n",{"type":398,"tag":399,"props":845,"children":847},{"id":846},"css-的组成部分",[848],{"type":404,"value":849},"CSS 的组成部分",{"type":398,"tag":406,"props":851,"children":852},{},[853,855,862,864,870,872,878,880,886,888,894,896,902,904,910,923],{"type":404,"value":854},"要理解 CSS 是怎么解析的，就要先清楚 CSS 是由哪几部分组成的。由我们平常见得最多的普通 CSS 代码开始说起，见下图，基本的 CSS 代码的组成部分包含规则集（rules）、选择器（selector）、选择器（declares）、属性（property）、值（value）这五个部分。",{"type":398,"tag":856,"props":857,"children":859},"abbr",{"title":858},"rule",[860],{"type":404,"value":861},"规则",{"type":404,"value":863},"是由",{"type":398,"tag":856,"props":865,"children":867},{"title":866},"property",[868],{"type":404,"value":869},"属性",{"type":404,"value":871},"和",{"type":398,"tag":856,"props":873,"children":875},{"title":874},"value",[876],{"type":404,"value":877},"值",{"type":404,"value":879},"组成的",{"type":398,"tag":856,"props":881,"children":883},{"title":882},"declaration",[884],{"type":404,"value":885},"声明",{"type":404,"value":887},"、声明与括号形成的",{"type":398,"tag":856,"props":889,"children":891},{"title":890},"declaration block",[892],{"type":404,"value":893},"声明块",{"type":404,"value":895},"再加上",{"type":398,"tag":856,"props":897,"children":899},{"title":898},"selector",[900],{"type":404,"value":901},"选择器",{"type":404,"value":903},"组成，而一条或多条规则组合成了",{"type":398,"tag":856,"props":905,"children":907},{"title":906},"rule sets",[908],{"type":404,"value":909},"规则集",{"type":398,"tag":911,"props":912,"children":913},"sup",{},[914],{"type":398,"tag":417,"props":915,"children":920},{"href":916,"ariaDescribedBy":917,"dataFootnoteRef":392,"id":919},"#user-content-fn-css-syntax",[918],"footnote-label","user-content-fnref-css-syntax",[921],{"type":404,"value":922},"1",{"type":404,"value":924},"。",{"type":398,"tag":406,"props":926,"children":927},{},[928],{"type":398,"tag":929,"props":930,"children":933},"img",{"alt":931,"src":932},"规则&规则集","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/200621/20200625022018.png",[],{"type":398,"tag":406,"props":935,"children":936},{},[937,939,945],{"type":404,"value":938},"图中没有包含 ",{"type":398,"tag":435,"props":940,"children":942},{"className":941},[],[943],{"type":404,"value":944},"at-rule",{"type":404,"value":946}," 的部分，哦，还少了注释部分~ 由于注释是 CSS 中语法最简单的部分，我们从解析注释开始代码部分的解读吧。",{"type":398,"tag":399,"props":948,"children":950},{"id":949},"流程速览",[951],{"type":404,"value":949},{"type":398,"tag":953,"props":954,"children":956},"h4",{"id":955},"解析注释",[957],{"type":404,"value":955},{"type":398,"tag":406,"props":959,"children":960},{},[961,963,970,972,979],{"type":404,"value":962},"可能许多人不了解 CSS 的注释风格，这里先说明一下，原生 CSS 仅支持",{"type":398,"tag":417,"props":964,"children":967},{"href":965,"rel":966},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/Comments",[421],[968],{"type":404,"value":969},"斜杠星号风格注释",{"type":404,"value":971},"，不支持",{"type":398,"tag":417,"props":973,"children":976},{"href":974,"rel":975},"https://segmentfault.com/a/1190000043885414",[421],[977],{"type":404,"value":978},"双斜杠注释",{"type":404,"value":980},"，所以解析器并未处理双斜杠的情况。",{"type":398,"tag":406,"props":982,"children":983},{},[984],{"type":404,"value":985},"解析注释的函数是一个 while 循环，从代码开头开始匹配，每次循环解析一条注释，直到代码开头没有注释为止。",{"type":398,"tag":428,"props":987,"children":991},{"className":988,"code":989,"language":990,"meta":392,"style":392},"language-ts shiki shiki-themes material-theme-lighter github-light github-dark monokai","class CSSParser {\n  private matchComments() {\n    while (this.matchComment());\n  }\n  private matchComment() {\n    // 快速跳过非注释部分代码\n    if (this.cssText.charAt(0) !== \"/\" || this.cssText.charAt(1) !== \"*\") {\n      return false;\n    }\n    // ...\n    return true;\n  }\n}\n","ts",[992],{"type":398,"tag":435,"props":993,"children":994},{"__ignoreMap":392},[995,1014,1038,1078,1085,1105,1113,1245,1263,1271,1279,1296,1303],{"type":398,"tag":439,"props":996,"children":997},{"class":441,"line":442},[998,1004,1010],{"type":398,"tag":439,"props":999,"children":1001},{"style":1000},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-light-font-style:inherit;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[1002],{"type":404,"value":1003},"class",{"type":398,"tag":439,"props":1005,"children":1007},{"style":1006},"--shiki-light:#E2931D;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-light-text-decoration:inherit;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline",[1008],{"type":404,"value":1009}," CSSParser",{"type":398,"tag":439,"props":1011,"children":1012},{"style":467},[1013],{"type":404,"value":470},{"type":398,"tag":439,"props":1015,"children":1016},{"class":441,"line":452},[1017,1023,1029,1034],{"type":398,"tag":439,"props":1018,"children":1020},{"style":1019},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1021],{"type":404,"value":1022},"  private",{"type":398,"tag":439,"props":1024,"children":1026},{"style":1025},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1027],{"type":404,"value":1028}," matchComments",{"type":398,"tag":439,"props":1030,"children":1031},{"style":467},[1032],{"type":404,"value":1033},"()",{"type":398,"tag":439,"props":1035,"children":1036},{"style":467},[1037],{"type":404,"value":470},{"type":398,"tag":439,"props":1039,"children":1040},{"class":441,"line":473},[1041,1047,1053,1059,1063,1069,1074],{"type":398,"tag":439,"props":1042,"children":1044},{"style":1043},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[1045],{"type":404,"value":1046},"    while",{"type":398,"tag":439,"props":1048,"children":1050},{"style":1049},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[1051],{"type":404,"value":1052}," (",{"type":398,"tag":439,"props":1054,"children":1056},{"style":1055},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[1057],{"type":404,"value":1058},"this",{"type":398,"tag":439,"props":1060,"children":1061},{"style":467},[1062],{"type":404,"value":459},{"type":398,"tag":439,"props":1064,"children":1066},{"style":1065},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1067],{"type":404,"value":1068},"matchComment",{"type":398,"tag":439,"props":1070,"children":1071},{"style":1049},[1072],{"type":404,"value":1073},"())",{"type":398,"tag":439,"props":1075,"children":1076},{"style":467},[1077],{"type":404,"value":496},{"type":398,"tag":439,"props":1079,"children":1080},{"class":441,"line":499},[1081],{"type":398,"tag":439,"props":1082,"children":1083},{"style":467},[1084],{"type":404,"value":547},{"type":398,"tag":439,"props":1086,"children":1087},{"class":441,"line":519},[1088,1092,1097,1101],{"type":398,"tag":439,"props":1089,"children":1090},{"style":1019},[1091],{"type":404,"value":1022},{"type":398,"tag":439,"props":1093,"children":1094},{"style":1025},[1095],{"type":404,"value":1096}," matchComment",{"type":398,"tag":439,"props":1098,"children":1099},{"style":467},[1100],{"type":404,"value":1033},{"type":398,"tag":439,"props":1102,"children":1103},{"style":467},[1104],{"type":404,"value":470},{"type":398,"tag":439,"props":1106,"children":1107},{"class":441,"line":541},[1108],{"type":398,"tag":439,"props":1109,"children":1110},{"style":446},[1111],{"type":404,"value":1112},"    // 快速跳过非注释部分代码\n",{"type":398,"tag":439,"props":1114,"children":1115},{"class":441,"line":550},[1116,1121,1125,1129,1133,1138,1142,1147,1152,1157,1162,1167,1172,1177,1181,1186,1191,1195,1199,1203,1207,1211,1215,1219,1223,1227,1232,1236,1240],{"type":398,"tag":439,"props":1117,"children":1118},{"style":1043},[1119],{"type":404,"value":1120},"    if",{"type":398,"tag":439,"props":1122,"children":1123},{"style":1049},[1124],{"type":404,"value":1052},{"type":398,"tag":439,"props":1126,"children":1127},{"style":1055},[1128],{"type":404,"value":1058},{"type":398,"tag":439,"props":1130,"children":1131},{"style":467},[1132],{"type":404,"value":459},{"type":398,"tag":439,"props":1134,"children":1135},{"style":503},[1136],{"type":404,"value":1137},"cssText",{"type":398,"tag":439,"props":1139,"children":1140},{"style":467},[1141],{"type":404,"value":459},{"type":398,"tag":439,"props":1143,"children":1144},{"style":1065},[1145],{"type":404,"value":1146},"charAt",{"type":398,"tag":439,"props":1148,"children":1149},{"style":1049},[1150],{"type":404,"value":1151},"(",{"type":398,"tag":439,"props":1153,"children":1154},{"style":488},[1155],{"type":404,"value":1156},"0",{"type":398,"tag":439,"props":1158,"children":1159},{"style":1049},[1160],{"type":404,"value":1161},") ",{"type":398,"tag":439,"props":1163,"children":1164},{"style":599},[1165],{"type":404,"value":1166},"!==",{"type":398,"tag":439,"props":1168,"children":1169},{"style":605},[1170],{"type":404,"value":1171}," \"",{"type":398,"tag":439,"props":1173,"children":1174},{"style":611},[1175],{"type":404,"value":1176},"/",{"type":398,"tag":439,"props":1178,"children":1179},{"style":605},[1180],{"type":404,"value":608},{"type":398,"tag":439,"props":1182,"children":1183},{"style":599},[1184],{"type":404,"value":1185}," ||",{"type":398,"tag":439,"props":1187,"children":1188},{"style":1055},[1189],{"type":404,"value":1190}," this",{"type":398,"tag":439,"props":1192,"children":1193},{"style":467},[1194],{"type":404,"value":459},{"type":398,"tag":439,"props":1196,"children":1197},{"style":503},[1198],{"type":404,"value":1137},{"type":398,"tag":439,"props":1200,"children":1201},{"style":467},[1202],{"type":404,"value":459},{"type":398,"tag":439,"props":1204,"children":1205},{"style":1065},[1206],{"type":404,"value":1146},{"type":398,"tag":439,"props":1208,"children":1209},{"style":1049},[1210],{"type":404,"value":1151},{"type":398,"tag":439,"props":1212,"children":1213},{"style":488},[1214],{"type":404,"value":922},{"type":398,"tag":439,"props":1216,"children":1217},{"style":1049},[1218],{"type":404,"value":1161},{"type":398,"tag":439,"props":1220,"children":1221},{"style":599},[1222],{"type":404,"value":1166},{"type":398,"tag":439,"props":1224,"children":1225},{"style":605},[1226],{"type":404,"value":1171},{"type":398,"tag":439,"props":1228,"children":1229},{"style":611},[1230],{"type":404,"value":1231},"*",{"type":398,"tag":439,"props":1233,"children":1234},{"style":605},[1235],{"type":404,"value":608},{"type":398,"tag":439,"props":1237,"children":1238},{"style":1049},[1239],{"type":404,"value":1161},{"type":398,"tag":439,"props":1241,"children":1242},{"style":467},[1243],{"type":404,"value":1244},"{\n",{"type":398,"tag":439,"props":1246,"children":1247},{"class":441,"line":559},[1248,1253,1259],{"type":398,"tag":439,"props":1249,"children":1250},{"style":1043},[1251],{"type":404,"value":1252},"      return",{"type":398,"tag":439,"props":1254,"children":1256},{"style":1255},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1257],{"type":404,"value":1258}," false",{"type":398,"tag":439,"props":1260,"children":1261},{"style":467},[1262],{"type":404,"value":496},{"type":398,"tag":439,"props":1264,"children":1265},{"class":441,"line":569},[1266],{"type":398,"tag":439,"props":1267,"children":1268},{"style":467},[1269],{"type":404,"value":1270},"    }\n",{"type":398,"tag":439,"props":1272,"children":1273},{"class":441,"line":578},[1274],{"type":398,"tag":439,"props":1275,"children":1276},{"style":446},[1277],{"type":404,"value":1278},"    // ...\n",{"type":398,"tag":439,"props":1280,"children":1281},{"class":441,"line":639},[1282,1287,1292],{"type":398,"tag":439,"props":1283,"children":1284},{"style":1043},[1285],{"type":404,"value":1286},"    return",{"type":398,"tag":439,"props":1288,"children":1289},{"style":1255},[1290],{"type":404,"value":1291}," true",{"type":398,"tag":439,"props":1293,"children":1294},{"style":467},[1295],{"type":404,"value":496},{"type":398,"tag":439,"props":1297,"children":1298},{"class":441,"line":659},[1299],{"type":398,"tag":439,"props":1300,"children":1301},{"style":467},[1302],{"type":404,"value":547},{"type":398,"tag":439,"props":1304,"children":1305},{"class":441,"line":675},[1306],{"type":398,"tag":439,"props":1307,"children":1308},{"style":467},[1309],{"type":404,"value":556},{"type":398,"tag":406,"props":1311,"children":1312},{},[1313],{"type":404,"value":1314},"在选择解析注释内容的方法上，micro-app 没有使用正则，而是用了下标递增的办法。暂不清楚原因，感兴趣的小伙伴可以试试几种相关办法的性能对比。",{"type":398,"tag":428,"props":1316,"children":1318},{"className":988,"code":1317,"language":990,"meta":392,"style":392},"let i = 2;\nwhile (\n  this.cssText.charAt(i) !== \"\" &&\n  (this.cssText.charAt(i) !== \"*\" || this.cssText.charAt(i + 1) !== \"/\")\n) {\n  ++i;\n}\ni += 2;\n\nlet commentText = this.cssText.slice(2, i - 2);\n/* ... */\nthis.cssText = this.cssText.slice(i);\n",[1319],{"type":398,"tag":435,"props":1320,"children":1321},{"__ignoreMap":392},[1322,1347,1360,1403,1514,1525,1542,1549,1570,1577,1650,1658],{"type":398,"tag":439,"props":1323,"children":1324},{"class":441,"line":442},[1325,1330,1335,1339,1343],{"type":398,"tag":439,"props":1326,"children":1327},{"style":1000},[1328],{"type":404,"value":1329},"let",{"type":398,"tag":439,"props":1331,"children":1332},{"style":503},[1333],{"type":404,"value":1334}," i ",{"type":398,"tag":439,"props":1336,"children":1337},{"style":599},[1338],{"type":404,"value":602},{"type":398,"tag":439,"props":1340,"children":1341},{"style":488},[1342],{"type":404,"value":534},{"type":398,"tag":439,"props":1344,"children":1345},{"style":467},[1346],{"type":404,"value":496},{"type":398,"tag":439,"props":1348,"children":1349},{"class":441,"line":452},[1350,1355],{"type":398,"tag":439,"props":1351,"children":1352},{"style":1043},[1353],{"type":404,"value":1354},"while",{"type":398,"tag":439,"props":1356,"children":1357},{"style":503},[1358],{"type":404,"value":1359}," (\n",{"type":398,"tag":439,"props":1361,"children":1362},{"class":441,"line":473},[1363,1368,1372,1376,1380,1384,1389,1393,1398],{"type":398,"tag":439,"props":1364,"children":1365},{"style":1055},[1366],{"type":404,"value":1367},"  this",{"type":398,"tag":439,"props":1369,"children":1370},{"style":467},[1371],{"type":404,"value":459},{"type":398,"tag":439,"props":1373,"children":1374},{"style":503},[1375],{"type":404,"value":1137},{"type":398,"tag":439,"props":1377,"children":1378},{"style":467},[1379],{"type":404,"value":459},{"type":398,"tag":439,"props":1381,"children":1382},{"style":1065},[1383],{"type":404,"value":1146},{"type":398,"tag":439,"props":1385,"children":1386},{"style":503},[1387],{"type":404,"value":1388},"(i) ",{"type":398,"tag":439,"props":1390,"children":1391},{"style":599},[1392],{"type":404,"value":1166},{"type":398,"tag":439,"props":1394,"children":1395},{"style":605},[1396],{"type":404,"value":1397}," \"\"",{"type":398,"tag":439,"props":1399,"children":1400},{"style":599},[1401],{"type":404,"value":1402}," &&\n",{"type":398,"tag":439,"props":1404,"children":1405},{"class":441,"line":499},[1406,1411,1415,1419,1423,1427,1431,1435,1439,1443,1447,1451,1455,1459,1463,1467,1471,1475,1480,1485,1489,1493,1497,1501,1505,1509],{"type":398,"tag":439,"props":1407,"children":1408},{"style":503},[1409],{"type":404,"value":1410},"  (",{"type":398,"tag":439,"props":1412,"children":1413},{"style":1055},[1414],{"type":404,"value":1058},{"type":398,"tag":439,"props":1416,"children":1417},{"style":467},[1418],{"type":404,"value":459},{"type":398,"tag":439,"props":1420,"children":1421},{"style":503},[1422],{"type":404,"value":1137},{"type":398,"tag":439,"props":1424,"children":1425},{"style":467},[1426],{"type":404,"value":459},{"type":398,"tag":439,"props":1428,"children":1429},{"style":1065},[1430],{"type":404,"value":1146},{"type":398,"tag":439,"props":1432,"children":1433},{"style":503},[1434],{"type":404,"value":1388},{"type":398,"tag":439,"props":1436,"children":1437},{"style":599},[1438],{"type":404,"value":1166},{"type":398,"tag":439,"props":1440,"children":1441},{"style":605},[1442],{"type":404,"value":1171},{"type":398,"tag":439,"props":1444,"children":1445},{"style":611},[1446],{"type":404,"value":1231},{"type":398,"tag":439,"props":1448,"children":1449},{"style":605},[1450],{"type":404,"value":608},{"type":398,"tag":439,"props":1452,"children":1453},{"style":599},[1454],{"type":404,"value":1185},{"type":398,"tag":439,"props":1456,"children":1457},{"style":1055},[1458],{"type":404,"value":1190},{"type":398,"tag":439,"props":1460,"children":1461},{"style":467},[1462],{"type":404,"value":459},{"type":398,"tag":439,"props":1464,"children":1465},{"style":503},[1466],{"type":404,"value":1137},{"type":398,"tag":439,"props":1468,"children":1469},{"style":467},[1470],{"type":404,"value":459},{"type":398,"tag":439,"props":1472,"children":1473},{"style":1065},[1474],{"type":404,"value":1146},{"type":398,"tag":439,"props":1476,"children":1477},{"style":503},[1478],{"type":404,"value":1479},"(i ",{"type":398,"tag":439,"props":1481,"children":1482},{"style":599},[1483],{"type":404,"value":1484},"+",{"type":398,"tag":439,"props":1486,"children":1487},{"style":488},[1488],{"type":404,"value":491},{"type":398,"tag":439,"props":1490,"children":1491},{"style":503},[1492],{"type":404,"value":1161},{"type":398,"tag":439,"props":1494,"children":1495},{"style":599},[1496],{"type":404,"value":1166},{"type":398,"tag":439,"props":1498,"children":1499},{"style":605},[1500],{"type":404,"value":1171},{"type":398,"tag":439,"props":1502,"children":1503},{"style":611},[1504],{"type":404,"value":1176},{"type":398,"tag":439,"props":1506,"children":1507},{"style":605},[1508],{"type":404,"value":608},{"type":398,"tag":439,"props":1510,"children":1511},{"style":503},[1512],{"type":404,"value":1513},")\n",{"type":398,"tag":439,"props":1515,"children":1516},{"class":441,"line":519},[1517,1521],{"type":398,"tag":439,"props":1518,"children":1519},{"style":503},[1520],{"type":404,"value":1161},{"type":398,"tag":439,"props":1522,"children":1523},{"style":467},[1524],{"type":404,"value":1244},{"type":398,"tag":439,"props":1526,"children":1527},{"class":441,"line":541},[1528,1533,1538],{"type":398,"tag":439,"props":1529,"children":1530},{"style":599},[1531],{"type":404,"value":1532},"  ++",{"type":398,"tag":439,"props":1534,"children":1535},{"style":503},[1536],{"type":404,"value":1537},"i",{"type":398,"tag":439,"props":1539,"children":1540},{"style":467},[1541],{"type":404,"value":496},{"type":398,"tag":439,"props":1543,"children":1544},{"class":441,"line":550},[1545],{"type":398,"tag":439,"props":1546,"children":1547},{"style":467},[1548],{"type":404,"value":556},{"type":398,"tag":439,"props":1550,"children":1551},{"class":441,"line":559},[1552,1557,1562,1566],{"type":398,"tag":439,"props":1553,"children":1554},{"style":503},[1555],{"type":404,"value":1556},"i ",{"type":398,"tag":439,"props":1558,"children":1559},{"style":599},[1560],{"type":404,"value":1561},"+=",{"type":398,"tag":439,"props":1563,"children":1564},{"style":488},[1565],{"type":404,"value":534},{"type":398,"tag":439,"props":1567,"children":1568},{"style":467},[1569],{"type":404,"value":496},{"type":398,"tag":439,"props":1571,"children":1572},{"class":441,"line":569},[1573],{"type":398,"tag":439,"props":1574,"children":1575},{"emptyLinePlaceholder":563},[1576],{"type":404,"value":566},{"type":398,"tag":439,"props":1578,"children":1579},{"class":441,"line":578},[1580,1584,1589,1593,1597,1601,1605,1609,1614,1618,1623,1628,1632,1637,1641,1646],{"type":398,"tag":439,"props":1581,"children":1582},{"style":1000},[1583],{"type":404,"value":1329},{"type":398,"tag":439,"props":1585,"children":1586},{"style":503},[1587],{"type":404,"value":1588}," commentText ",{"type":398,"tag":439,"props":1590,"children":1591},{"style":599},[1592],{"type":404,"value":602},{"type":398,"tag":439,"props":1594,"children":1595},{"style":1055},[1596],{"type":404,"value":1190},{"type":398,"tag":439,"props":1598,"children":1599},{"style":467},[1600],{"type":404,"value":459},{"type":398,"tag":439,"props":1602,"children":1603},{"style":503},[1604],{"type":404,"value":1137},{"type":398,"tag":439,"props":1606,"children":1607},{"style":467},[1608],{"type":404,"value":459},{"type":398,"tag":439,"props":1610,"children":1611},{"style":1065},[1612],{"type":404,"value":1613},"slice",{"type":398,"tag":439,"props":1615,"children":1616},{"style":503},[1617],{"type":404,"value":1151},{"type":398,"tag":439,"props":1619,"children":1620},{"style":488},[1621],{"type":404,"value":1622},"2",{"type":398,"tag":439,"props":1624,"children":1625},{"style":467},[1626],{"type":404,"value":1627},",",{"type":398,"tag":439,"props":1629,"children":1630},{"style":503},[1631],{"type":404,"value":1334},{"type":398,"tag":439,"props":1633,"children":1634},{"style":599},[1635],{"type":404,"value":1636},"-",{"type":398,"tag":439,"props":1638,"children":1639},{"style":488},[1640],{"type":404,"value":534},{"type":398,"tag":439,"props":1642,"children":1643},{"style":503},[1644],{"type":404,"value":1645},")",{"type":398,"tag":439,"props":1647,"children":1648},{"style":467},[1649],{"type":404,"value":496},{"type":398,"tag":439,"props":1651,"children":1652},{"class":441,"line":639},[1653],{"type":398,"tag":439,"props":1654,"children":1655},{"style":446},[1656],{"type":404,"value":1657},"/* ... */\n",{"type":398,"tag":439,"props":1659,"children":1660},{"class":441,"line":659},[1661,1665,1669,1674,1678,1682,1686,1690,1694,1698,1703],{"type":398,"tag":439,"props":1662,"children":1663},{"style":1055},[1664],{"type":404,"value":1058},{"type":398,"tag":439,"props":1666,"children":1667},{"style":467},[1668],{"type":404,"value":459},{"type":398,"tag":439,"props":1670,"children":1671},{"style":503},[1672],{"type":404,"value":1673},"cssText ",{"type":398,"tag":439,"props":1675,"children":1676},{"style":599},[1677],{"type":404,"value":602},{"type":398,"tag":439,"props":1679,"children":1680},{"style":1055},[1681],{"type":404,"value":1190},{"type":398,"tag":439,"props":1683,"children":1684},{"style":467},[1685],{"type":404,"value":459},{"type":398,"tag":439,"props":1687,"children":1688},{"style":503},[1689],{"type":404,"value":1137},{"type":398,"tag":439,"props":1691,"children":1692},{"style":467},[1693],{"type":404,"value":459},{"type":398,"tag":439,"props":1695,"children":1696},{"style":1065},[1697],{"type":404,"value":1613},{"type":398,"tag":439,"props":1699,"children":1700},{"style":503},[1701],{"type":404,"value":1702},"(i)",{"type":398,"tag":439,"props":1704,"children":1705},{"style":467},[1706],{"type":404,"value":496},{"type":398,"tag":406,"props":1708,"children":1709},{},[1710,1712,1718,1720,1725,1727,1733],{"type":404,"value":1711},"注释的正文结果保存在了变量 ",{"type":398,"tag":435,"props":1713,"children":1715},{"className":1714},[],[1716],{"type":404,"value":1717},"commentText",{"type":404,"value":1719}," 中，这样可以判断 ",{"type":398,"tag":435,"props":1721,"children":1723},{"className":1722},[],[1724],{"type":404,"value":1717},{"type":404,"value":1726}," 的内容来实现通过注释禁用某个选择器、禁用某行的样式隔离之类的功能。比如想让 ",{"type":398,"tag":435,"props":1728,"children":1730},{"className":1729},[],[1731],{"type":404,"value":1732},".test2",{"type":404,"value":1734}," 选择器不被 scoped 规则覆盖，我们可以在业务代码中这样写。",{"type":398,"tag":428,"props":1736,"children":1738},{"className":430,"code":1737,"language":432,"meta":392,"style":392},"/*! scopecss-disable-next-line */\n.test2 {\n  background: url(/test.png);\n}\n",[1739],{"type":398,"tag":435,"props":1740,"children":1741},{"__ignoreMap":392},[1742,1750,1766,1799],{"type":398,"tag":439,"props":1743,"children":1744},{"class":441,"line":442},[1745],{"type":398,"tag":439,"props":1746,"children":1747},{"style":446},[1748],{"type":404,"value":1749},"/*! scopecss-disable-next-line */\n",{"type":398,"tag":439,"props":1751,"children":1752},{"class":441,"line":452},[1753,1757,1762],{"type":398,"tag":439,"props":1754,"children":1755},{"style":456},[1756],{"type":404,"value":459},{"type":398,"tag":439,"props":1758,"children":1759},{"style":462},[1760],{"type":404,"value":1761},"test2",{"type":398,"tag":439,"props":1763,"children":1764},{"style":467},[1765],{"type":404,"value":470},{"type":398,"tag":439,"props":1767,"children":1768},{"class":441,"line":473},[1769,1774,1778,1784,1788,1794],{"type":398,"tag":439,"props":1770,"children":1771},{"style":477},[1772],{"type":404,"value":1773},"  background",{"type":398,"tag":439,"props":1775,"children":1776},{"style":467},[1777],{"type":404,"value":485},{"type":398,"tag":439,"props":1779,"children":1781},{"style":1780},"--shiki-light:#6182B8;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF",[1782],{"type":404,"value":1783}," url",{"type":398,"tag":439,"props":1785,"children":1786},{"style":467},[1787],{"type":404,"value":1151},{"type":398,"tag":439,"props":1789,"children":1791},{"style":1790},"--shiki-light:#90A4AE;--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[1792],{"type":404,"value":1793},"/test.png",{"type":398,"tag":439,"props":1795,"children":1796},{"style":467},[1797],{"type":404,"value":1798},");\n",{"type":398,"tag":439,"props":1800,"children":1801},{"class":441,"line":499},[1802],{"type":398,"tag":439,"props":1803,"children":1804},{"style":467},[1805],{"type":404,"value":556},{"type":398,"tag":953,"props":1807,"children":1809},{"id":1808},"输入输出",[1810],{"type":404,"value":1808},{"type":398,"tag":406,"props":1812,"children":1813},{},[1814,1816,1821,1823,1829],{"type":404,"value":1815},"“解析注释”中“解析”实际指对输入的 CSS 源文件待处理部分以及处理好的输出部分做出改变。这里引申出解析器里两个关键状态，",{"type":398,"tag":435,"props":1817,"children":1819},{"className":1818},[],[1820],{"type":404,"value":1137},{"type":404,"value":1822}," 和 ",{"type":398,"tag":435,"props":1824,"children":1826},{"className":1825},[],[1827],{"type":404,"value":1828},"result",{"type":404,"value":1830},"，分别代表待解析的内容和最终输出结果。",{"type":398,"tag":406,"props":1832,"children":1833},{},[1834,1839,1841,1846,1848,1854],{"type":398,"tag":435,"props":1835,"children":1837},{"className":1836},[],[1838],{"type":404,"value":1137},{"type":404,"value":1840}," 随着循环应当逐渐减小直到为空，此时代表解析完成。",{"type":398,"tag":435,"props":1842,"children":1844},{"className":1843},[],[1845],{"type":404,"value":1828},{"type":404,"value":1847}," 能被内部方法 ",{"type":398,"tag":435,"props":1849,"children":1851},{"className":1850},[],[1852],{"type":404,"value":1853},"recordResult",{"type":404,"value":1855}," 改变，比如如果要把注释的正文内容记录到输出结果，可以这样使用：",{"type":398,"tag":428,"props":1857,"children":1859},{"className":988,"code":1858,"language":990,"meta":392,"style":392},"this.recordResult(`/*${commentText}*/`);\n// 相当于：this.result += `/*${commentText}*/`\n",[1860],{"type":398,"tag":435,"props":1861,"children":1862},{"__ignoreMap":392},[1863,1924],{"type":398,"tag":439,"props":1864,"children":1865},{"class":441,"line":442},[1866,1870,1874,1878,1882,1887,1892,1898,1902,1907,1912,1916,1920],{"type":398,"tag":439,"props":1867,"children":1868},{"style":1055},[1869],{"type":404,"value":1058},{"type":398,"tag":439,"props":1871,"children":1872},{"style":467},[1873],{"type":404,"value":459},{"type":398,"tag":439,"props":1875,"children":1876},{"style":1065},[1877],{"type":404,"value":1853},{"type":398,"tag":439,"props":1879,"children":1880},{"style":503},[1881],{"type":404,"value":1151},{"type":398,"tag":439,"props":1883,"children":1884},{"style":605},[1885],{"type":404,"value":1886},"`",{"type":398,"tag":439,"props":1888,"children":1889},{"style":611},[1890],{"type":404,"value":1891},"/*",{"type":398,"tag":439,"props":1893,"children":1895},{"style":1894},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#F92672",[1896],{"type":404,"value":1897},"${",{"type":398,"tag":439,"props":1899,"children":1900},{"style":503},[1901],{"type":404,"value":1717},{"type":398,"tag":439,"props":1903,"children":1904},{"style":1894},[1905],{"type":404,"value":1906},"}",{"type":398,"tag":439,"props":1908,"children":1909},{"style":611},[1910],{"type":404,"value":1911},"*/",{"type":398,"tag":439,"props":1913,"children":1914},{"style":605},[1915],{"type":404,"value":1886},{"type":398,"tag":439,"props":1917,"children":1918},{"style":503},[1919],{"type":404,"value":1645},{"type":398,"tag":439,"props":1921,"children":1922},{"style":467},[1923],{"type":404,"value":496},{"type":398,"tag":439,"props":1925,"children":1926},{"class":441,"line":452},[1927],{"type":398,"tag":439,"props":1928,"children":1929},{"style":446},[1930],{"type":404,"value":1931},"// 相当于：this.result += `/*${commentText}*/`\n",{"type":398,"tag":953,"props":1933,"children":1935},{"id":1934},"解析规则集",[1936],{"type":404,"value":1934},{"type":398,"tag":406,"props":1938,"children":1939},{},[1940],{"type":404,"value":1941},"规则集的解析是整个解析的核心过程。原理与解析注释类似，也是一个 while 循环。每一轮循环都会尝试匹配一条规则，并且将多余的注释和空白字符匹配出来。",{"type":398,"tag":428,"props":1943,"children":1945},{"className":988,"code":1944,"language":990,"meta":392,"style":392},"private matchRules (): void {\n  this.matchLeadingSpaces()\n  this.matchComments()\n  while (\n    this.cssText.length &&\n    this.cssText.charAt(0) !== '}' &&\n    (this.matchAtRule() || this.matchStyleRule())\n  ) {\n    this.matchComments()\n    this.matchLeadingSpaces()\n  }\n}\n",[1946],{"type":398,"tag":435,"props":1947,"children":1948},{"__ignoreMap":392},[1949,1976,1997,2017,2029,2058,2115,2164,2176,2195,2214,2221],{"type":398,"tag":439,"props":1950,"children":1951},{"class":441,"line":442},[1952,1957,1962,1967,1972],{"type":398,"tag":439,"props":1953,"children":1954},{"style":503},[1955],{"type":404,"value":1956},"private ",{"type":398,"tag":439,"props":1958,"children":1959},{"style":1065},[1960],{"type":404,"value":1961},"matchRules",{"type":398,"tag":439,"props":1963,"children":1964},{"style":503},[1965],{"type":404,"value":1966}," (): ",{"type":398,"tag":439,"props":1968,"children":1969},{"style":599},[1970],{"type":404,"value":1971},"void",{"type":398,"tag":439,"props":1973,"children":1974},{"style":467},[1975],{"type":404,"value":470},{"type":398,"tag":439,"props":1977,"children":1978},{"class":441,"line":452},[1979,1983,1987,1992],{"type":398,"tag":439,"props":1980,"children":1981},{"style":1055},[1982],{"type":404,"value":1367},{"type":398,"tag":439,"props":1984,"children":1985},{"style":467},[1986],{"type":404,"value":459},{"type":398,"tag":439,"props":1988,"children":1989},{"style":1065},[1990],{"type":404,"value":1991},"matchLeadingSpaces",{"type":398,"tag":439,"props":1993,"children":1994},{"style":1049},[1995],{"type":404,"value":1996},"()\n",{"type":398,"tag":439,"props":1998,"children":1999},{"class":441,"line":473},[2000,2004,2008,2013],{"type":398,"tag":439,"props":2001,"children":2002},{"style":1055},[2003],{"type":404,"value":1367},{"type":398,"tag":439,"props":2005,"children":2006},{"style":467},[2007],{"type":404,"value":459},{"type":398,"tag":439,"props":2009,"children":2010},{"style":1065},[2011],{"type":404,"value":2012},"matchComments",{"type":398,"tag":439,"props":2014,"children":2015},{"style":1049},[2016],{"type":404,"value":1996},{"type":398,"tag":439,"props":2018,"children":2019},{"class":441,"line":499},[2020,2025],{"type":398,"tag":439,"props":2021,"children":2022},{"style":1043},[2023],{"type":404,"value":2024},"  while",{"type":398,"tag":439,"props":2026,"children":2027},{"style":1049},[2028],{"type":404,"value":1359},{"type":398,"tag":439,"props":2030,"children":2031},{"class":441,"line":519},[2032,2037,2041,2045,2049,2054],{"type":398,"tag":439,"props":2033,"children":2034},{"style":1055},[2035],{"type":404,"value":2036},"    this",{"type":398,"tag":439,"props":2038,"children":2039},{"style":467},[2040],{"type":404,"value":459},{"type":398,"tag":439,"props":2042,"children":2043},{"style":503},[2044],{"type":404,"value":1137},{"type":398,"tag":439,"props":2046,"children":2047},{"style":467},[2048],{"type":404,"value":459},{"type":398,"tag":439,"props":2050,"children":2051},{"style":509},[2052],{"type":404,"value":2053},"length",{"type":398,"tag":439,"props":2055,"children":2056},{"style":599},[2057],{"type":404,"value":1402},{"type":398,"tag":439,"props":2059,"children":2060},{"class":441,"line":541},[2061,2065,2069,2073,2077,2081,2085,2089,2093,2097,2102,2106,2111],{"type":398,"tag":439,"props":2062,"children":2063},{"style":1055},[2064],{"type":404,"value":2036},{"type":398,"tag":439,"props":2066,"children":2067},{"style":467},[2068],{"type":404,"value":459},{"type":398,"tag":439,"props":2070,"children":2071},{"style":503},[2072],{"type":404,"value":1137},{"type":398,"tag":439,"props":2074,"children":2075},{"style":467},[2076],{"type":404,"value":459},{"type":398,"tag":439,"props":2078,"children":2079},{"style":1065},[2080],{"type":404,"value":1146},{"type":398,"tag":439,"props":2082,"children":2083},{"style":1049},[2084],{"type":404,"value":1151},{"type":398,"tag":439,"props":2086,"children":2087},{"style":488},[2088],{"type":404,"value":1156},{"type":398,"tag":439,"props":2090,"children":2091},{"style":1049},[2092],{"type":404,"value":1161},{"type":398,"tag":439,"props":2094,"children":2095},{"style":599},[2096],{"type":404,"value":1166},{"type":398,"tag":439,"props":2098,"children":2099},{"style":605},[2100],{"type":404,"value":2101}," '",{"type":398,"tag":439,"props":2103,"children":2104},{"style":611},[2105],{"type":404,"value":1906},{"type":398,"tag":439,"props":2107,"children":2108},{"style":605},[2109],{"type":404,"value":2110},"'",{"type":398,"tag":439,"props":2112,"children":2113},{"style":599},[2114],{"type":404,"value":1402},{"type":398,"tag":439,"props":2116,"children":2117},{"class":441,"line":550},[2118,2123,2127,2131,2136,2141,2146,2150,2154,2159],{"type":398,"tag":439,"props":2119,"children":2120},{"style":1049},[2121],{"type":404,"value":2122},"    (",{"type":398,"tag":439,"props":2124,"children":2125},{"style":1055},[2126],{"type":404,"value":1058},{"type":398,"tag":439,"props":2128,"children":2129},{"style":467},[2130],{"type":404,"value":459},{"type":398,"tag":439,"props":2132,"children":2133},{"style":1065},[2134],{"type":404,"value":2135},"matchAtRule",{"type":398,"tag":439,"props":2137,"children":2138},{"style":1049},[2139],{"type":404,"value":2140},"() ",{"type":398,"tag":439,"props":2142,"children":2143},{"style":599},[2144],{"type":404,"value":2145},"||",{"type":398,"tag":439,"props":2147,"children":2148},{"style":1055},[2149],{"type":404,"value":1190},{"type":398,"tag":439,"props":2151,"children":2152},{"style":467},[2153],{"type":404,"value":459},{"type":398,"tag":439,"props":2155,"children":2156},{"style":1065},[2157],{"type":404,"value":2158},"matchStyleRule",{"type":398,"tag":439,"props":2160,"children":2161},{"style":1049},[2162],{"type":404,"value":2163},"())\n",{"type":398,"tag":439,"props":2165,"children":2166},{"class":441,"line":559},[2167,2172],{"type":398,"tag":439,"props":2168,"children":2169},{"style":1049},[2170],{"type":404,"value":2171},"  ) ",{"type":398,"tag":439,"props":2173,"children":2174},{"style":467},[2175],{"type":404,"value":1244},{"type":398,"tag":439,"props":2177,"children":2178},{"class":441,"line":569},[2179,2183,2187,2191],{"type":398,"tag":439,"props":2180,"children":2181},{"style":1055},[2182],{"type":404,"value":2036},{"type":398,"tag":439,"props":2184,"children":2185},{"style":467},[2186],{"type":404,"value":459},{"type":398,"tag":439,"props":2188,"children":2189},{"style":1065},[2190],{"type":404,"value":2012},{"type":398,"tag":439,"props":2192,"children":2193},{"style":1049},[2194],{"type":404,"value":1996},{"type":398,"tag":439,"props":2196,"children":2197},{"class":441,"line":578},[2198,2202,2206,2210],{"type":398,"tag":439,"props":2199,"children":2200},{"style":1055},[2201],{"type":404,"value":2036},{"type":398,"tag":439,"props":2203,"children":2204},{"style":467},[2205],{"type":404,"value":459},{"type":398,"tag":439,"props":2207,"children":2208},{"style":1065},[2209],{"type":404,"value":1991},{"type":398,"tag":439,"props":2211,"children":2212},{"style":1049},[2213],{"type":404,"value":1996},{"type":398,"tag":439,"props":2215,"children":2216},{"class":441,"line":639},[2217],{"type":398,"tag":439,"props":2218,"children":2219},{"style":467},[2220],{"type":404,"value":547},{"type":398,"tag":439,"props":2222,"children":2223},{"class":441,"line":659},[2224],{"type":398,"tag":439,"props":2225,"children":2226},{"style":467},[2227],{"type":404,"value":556},{"type":398,"tag":406,"props":2229,"children":2230},{},[2231,2233,2238],{"type":404,"value":2232},"匹配注释我们知道它是使用了下标递增 + Slice 的方法，匹配空白这里则是用的一个非常简单的正则。见下 ",{"type":398,"tag":435,"props":2234,"children":2236},{"className":2235},[],[2237],{"type":404,"value":1991},{"type":404,"value":2239}," 函数。",{"type":398,"tag":428,"props":2241,"children":2243},{"className":988,"code":2242,"language":990,"meta":392,"style":392},"private matchLeadingSpaces (): void {\n  this.commonMatch(/^\\s*/, false)\n}\n",[2244],{"type":398,"tag":435,"props":2245,"children":2246},{"__ignoreMap":392},[2247,2270,2325],{"type":398,"tag":439,"props":2248,"children":2249},{"class":441,"line":442},[2250,2254,2258,2262,2266],{"type":398,"tag":439,"props":2251,"children":2252},{"style":503},[2253],{"type":404,"value":1956},{"type":398,"tag":439,"props":2255,"children":2256},{"style":1065},[2257],{"type":404,"value":1991},{"type":398,"tag":439,"props":2259,"children":2260},{"style":503},[2261],{"type":404,"value":1966},{"type":398,"tag":439,"props":2263,"children":2264},{"style":599},[2265],{"type":404,"value":1971},{"type":398,"tag":439,"props":2267,"children":2268},{"style":467},[2269],{"type":404,"value":470},{"type":398,"tag":439,"props":2271,"children":2272},{"class":441,"line":452},[2273,2277,2281,2286,2290,2294,2299,2305,2309,2313,2317,2321],{"type":398,"tag":439,"props":2274,"children":2275},{"style":1055},[2276],{"type":404,"value":1367},{"type":398,"tag":439,"props":2278,"children":2279},{"style":467},[2280],{"type":404,"value":459},{"type":398,"tag":439,"props":2282,"children":2283},{"style":1065},[2284],{"type":404,"value":2285},"commonMatch",{"type":398,"tag":439,"props":2287,"children":2288},{"style":1049},[2289],{"type":404,"value":1151},{"type":398,"tag":439,"props":2291,"children":2292},{"style":605},[2293],{"type":404,"value":1176},{"type":398,"tag":439,"props":2295,"children":2296},{"style":1043},[2297],{"type":404,"value":2298},"^",{"type":398,"tag":439,"props":2300,"children":2302},{"style":2301},"--shiki-light:#91B859;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2303],{"type":404,"value":2304},"\\s",{"type":398,"tag":439,"props":2306,"children":2307},{"style":599},[2308],{"type":404,"value":1231},{"type":398,"tag":439,"props":2310,"children":2311},{"style":605},[2312],{"type":404,"value":1176},{"type":398,"tag":439,"props":2314,"children":2315},{"style":467},[2316],{"type":404,"value":1627},{"type":398,"tag":439,"props":2318,"children":2319},{"style":1255},[2320],{"type":404,"value":1258},{"type":398,"tag":439,"props":2322,"children":2323},{"style":1049},[2324],{"type":404,"value":1513},{"type":398,"tag":439,"props":2326,"children":2327},{"class":441,"line":473},[2328],{"type":398,"tag":439,"props":2329,"children":2330},{"style":467},[2331],{"type":404,"value":556},{"type":398,"tag":406,"props":2333,"children":2334},{},[2335,2337,2342,2344,2349,2350,2355,2357,2362,2364,2369],{"type":404,"value":2336},"可以想象，",{"type":398,"tag":435,"props":2338,"children":2340},{"className":2339},[],[2341],{"type":404,"value":2285},{"type":404,"value":2343}," 应当会对状态 ",{"type":398,"tag":435,"props":2345,"children":2347},{"className":2346},[],[2348],{"type":404,"value":1137},{"type":404,"value":1822},{"type":398,"tag":435,"props":2351,"children":2353},{"className":2352},[],[2354],{"type":404,"value":1828},{"type":404,"value":2356}," 做一些操作。实际上，commonMatch 两个参数分别是用于匹配 ",{"type":398,"tag":435,"props":2358,"children":2360},{"className":2359},[],[2361],{"type":404,"value":1137},{"type":404,"value":2363}," 的正则，及跳过标记。如果在待匹配内容中匹配到了字符串，便把匹配的内容从中移除；跳过标记则意味着当确认跳过时，匹配的内容将不会被记录到输出结果中。以上面的 ",{"type":398,"tag":435,"props":2365,"children":2367},{"className":2366},[],[2368],{"type":404,"value":1991},{"type":404,"value":2370}," 函数举例，如果在待匹配内容中匹配到空白字符，那么会将其丢弃不做处理。",{"type":398,"tag":406,"props":2372,"children":2373},{},[2374,2379,2381,2386],{"type":398,"tag":435,"props":2375,"children":2377},{"className":2376},[],[2378],{"type":404,"value":2285},{"type":404,"value":2380}," 可谓是解析器匹配逻辑的核心，只要理解了它，那么我们回到上面提到的样式规则匹配 ",{"type":398,"tag":435,"props":2382,"children":2384},{"className":2383},[],[2385],{"type":404,"value":2158},{"type":404,"value":2387},"，会发现其过程非常简单。简单来说只有三步，匹配选择器、记录解析后的选择器、解析（并记录）声明。结束条件只有成功解析以及选择器解析报错或声明解析报错。",{"type":398,"tag":428,"props":2389,"children":2391},{"className":988,"code":2390,"language":990,"meta":392,"style":392},"private matchStyleRule (): boolean | void {\n  const selectors = this.formatSelector(true)\n  this.scopecssDisableNextLine = false\n  if (!selectors) return parseError('selector missing', this.linkPath)\n  this.recordResult(selectors)\n  this.matchComments()\n  this.styleDeclarations()\n  this.matchLeadingSpaces()\n  return true\n}\n",[2392],{"type":398,"tag":435,"props":2393,"children":2394},{"__ignoreMap":392},[2395,2425,2469,2494,2568,2595,2614,2634,2653,2666],{"type":398,"tag":439,"props":2396,"children":2397},{"class":441,"line":442},[2398,2402,2406,2411,2416,2421],{"type":398,"tag":439,"props":2399,"children":2400},{"style":503},[2401],{"type":404,"value":1956},{"type":398,"tag":439,"props":2403,"children":2404},{"style":1065},[2405],{"type":404,"value":2158},{"type":398,"tag":439,"props":2407,"children":2408},{"style":503},[2409],{"type":404,"value":2410}," (): boolean ",{"type":398,"tag":439,"props":2412,"children":2413},{"style":599},[2414],{"type":404,"value":2415},"|",{"type":398,"tag":439,"props":2417,"children":2418},{"style":599},[2419],{"type":404,"value":2420}," void",{"type":398,"tag":439,"props":2422,"children":2423},{"style":467},[2424],{"type":404,"value":470},{"type":398,"tag":439,"props":2426,"children":2427},{"class":441,"line":452},[2428,2433,2438,2443,2447,2451,2456,2460,2465],{"type":398,"tag":439,"props":2429,"children":2430},{"style":1000},[2431],{"type":404,"value":2432},"  const",{"type":398,"tag":439,"props":2434,"children":2435},{"style":509},[2436],{"type":404,"value":2437}," selectors",{"type":398,"tag":439,"props":2439,"children":2440},{"style":599},[2441],{"type":404,"value":2442}," =",{"type":398,"tag":439,"props":2444,"children":2445},{"style":1055},[2446],{"type":404,"value":1190},{"type":398,"tag":439,"props":2448,"children":2449},{"style":467},[2450],{"type":404,"value":459},{"type":398,"tag":439,"props":2452,"children":2453},{"style":1065},[2454],{"type":404,"value":2455},"formatSelector",{"type":398,"tag":439,"props":2457,"children":2458},{"style":1049},[2459],{"type":404,"value":1151},{"type":398,"tag":439,"props":2461,"children":2462},{"style":1255},[2463],{"type":404,"value":2464},"true",{"type":398,"tag":439,"props":2466,"children":2467},{"style":1049},[2468],{"type":404,"value":1513},{"type":398,"tag":439,"props":2470,"children":2471},{"class":441,"line":473},[2472,2476,2480,2485,2489],{"type":398,"tag":439,"props":2473,"children":2474},{"style":1055},[2475],{"type":404,"value":1367},{"type":398,"tag":439,"props":2477,"children":2478},{"style":467},[2479],{"type":404,"value":459},{"type":398,"tag":439,"props":2481,"children":2482},{"style":503},[2483],{"type":404,"value":2484},"scopecssDisableNextLine",{"type":398,"tag":439,"props":2486,"children":2487},{"style":599},[2488],{"type":404,"value":2442},{"type":398,"tag":439,"props":2490,"children":2491},{"style":1255},[2492],{"type":404,"value":2493}," false\n",{"type":398,"tag":439,"props":2495,"children":2496},{"class":441,"line":499},[2497,2502,2506,2511,2516,2520,2525,2530,2534,2538,2543,2547,2551,2555,2559,2564],{"type":398,"tag":439,"props":2498,"children":2499},{"style":1043},[2500],{"type":404,"value":2501},"  if",{"type":398,"tag":439,"props":2503,"children":2504},{"style":1049},[2505],{"type":404,"value":1052},{"type":398,"tag":439,"props":2507,"children":2508},{"style":599},[2509],{"type":404,"value":2510},"!",{"type":398,"tag":439,"props":2512,"children":2513},{"style":503},[2514],{"type":404,"value":2515},"selectors",{"type":398,"tag":439,"props":2517,"children":2518},{"style":1049},[2519],{"type":404,"value":1161},{"type":398,"tag":439,"props":2521,"children":2522},{"style":1043},[2523],{"type":404,"value":2524},"return",{"type":398,"tag":439,"props":2526,"children":2527},{"style":1065},[2528],{"type":404,"value":2529}," parseError",{"type":398,"tag":439,"props":2531,"children":2532},{"style":1049},[2533],{"type":404,"value":1151},{"type":398,"tag":439,"props":2535,"children":2536},{"style":605},[2537],{"type":404,"value":2110},{"type":398,"tag":439,"props":2539,"children":2540},{"style":611},[2541],{"type":404,"value":2542},"selector missing",{"type":398,"tag":439,"props":2544,"children":2545},{"style":605},[2546],{"type":404,"value":2110},{"type":398,"tag":439,"props":2548,"children":2549},{"style":467},[2550],{"type":404,"value":1627},{"type":398,"tag":439,"props":2552,"children":2553},{"style":1055},[2554],{"type":404,"value":1190},{"type":398,"tag":439,"props":2556,"children":2557},{"style":467},[2558],{"type":404,"value":459},{"type":398,"tag":439,"props":2560,"children":2561},{"style":503},[2562],{"type":404,"value":2563},"linkPath",{"type":398,"tag":439,"props":2565,"children":2566},{"style":1049},[2567],{"type":404,"value":1513},{"type":398,"tag":439,"props":2569,"children":2570},{"class":441,"line":519},[2571,2575,2579,2583,2587,2591],{"type":398,"tag":439,"props":2572,"children":2573},{"style":1055},[2574],{"type":404,"value":1367},{"type":398,"tag":439,"props":2576,"children":2577},{"style":467},[2578],{"type":404,"value":459},{"type":398,"tag":439,"props":2580,"children":2581},{"style":1065},[2582],{"type":404,"value":1853},{"type":398,"tag":439,"props":2584,"children":2585},{"style":1049},[2586],{"type":404,"value":1151},{"type":398,"tag":439,"props":2588,"children":2589},{"style":503},[2590],{"type":404,"value":2515},{"type":398,"tag":439,"props":2592,"children":2593},{"style":1049},[2594],{"type":404,"value":1513},{"type":398,"tag":439,"props":2596,"children":2597},{"class":441,"line":541},[2598,2602,2606,2610],{"type":398,"tag":439,"props":2599,"children":2600},{"style":1055},[2601],{"type":404,"value":1367},{"type":398,"tag":439,"props":2603,"children":2604},{"style":467},[2605],{"type":404,"value":459},{"type":398,"tag":439,"props":2607,"children":2608},{"style":1065},[2609],{"type":404,"value":2012},{"type":398,"tag":439,"props":2611,"children":2612},{"style":1049},[2613],{"type":404,"value":1996},{"type":398,"tag":439,"props":2615,"children":2616},{"class":441,"line":550},[2617,2621,2625,2630],{"type":398,"tag":439,"props":2618,"children":2619},{"style":1055},[2620],{"type":404,"value":1367},{"type":398,"tag":439,"props":2622,"children":2623},{"style":467},[2624],{"type":404,"value":459},{"type":398,"tag":439,"props":2626,"children":2627},{"style":1065},[2628],{"type":404,"value":2629},"styleDeclarations",{"type":398,"tag":439,"props":2631,"children":2632},{"style":1049},[2633],{"type":404,"value":1996},{"type":398,"tag":439,"props":2635,"children":2636},{"class":441,"line":559},[2637,2641,2645,2649],{"type":398,"tag":439,"props":2638,"children":2639},{"style":1055},[2640],{"type":404,"value":1367},{"type":398,"tag":439,"props":2642,"children":2643},{"style":467},[2644],{"type":404,"value":459},{"type":398,"tag":439,"props":2646,"children":2647},{"style":1065},[2648],{"type":404,"value":1991},{"type":398,"tag":439,"props":2650,"children":2651},{"style":1049},[2652],{"type":404,"value":1996},{"type":398,"tag":439,"props":2654,"children":2655},{"class":441,"line":569},[2656,2661],{"type":398,"tag":439,"props":2657,"children":2658},{"style":1043},[2659],{"type":404,"value":2660},"  return",{"type":398,"tag":439,"props":2662,"children":2663},{"style":1255},[2664],{"type":404,"value":2665}," true\n",{"type":398,"tag":439,"props":2667,"children":2668},{"class":441,"line":578},[2669],{"type":398,"tag":439,"props":2670,"children":2671},{"style":467},[2672],{"type":404,"value":556},{"type":398,"tag":406,"props":2674,"children":2675},{},[2676,2678,2684,2686,2692,2694,2700,2702,2707,2709,2715],{"type":404,"value":2677},"首先是匹配选择器的部分。以 ",{"type":398,"tag":435,"props":2679,"children":2681},{"className":2680},[],[2682],{"type":404,"value":2683},".a,.b{color:red}",{"type":404,"value":2685}," 为例，首先匹配出",{"type":398,"tag":435,"props":2687,"children":2689},{"className":2688},[],[2690],{"type":404,"value":2691},"{",{"type":404,"value":2693},"字符前的部分即",{"type":398,"tag":435,"props":2695,"children":2697},{"className":2696},[],[2698],{"type":404,"value":2699},".a,.b",{"type":404,"value":2701},"作为选择器的正文，然后使用",{"type":398,"tag":435,"props":2703,"children":2705},{"className":2704},[],[2706],{"type":404,"value":1627},{"type":404,"value":2708},"分割选择器，并给选择器加上 prefix，最终返回",{"type":398,"tag":435,"props":2710,"children":2712},{"className":2711},[],[2713],{"type":404,"value":2714},"micro-app[name=\"subapp\"] .a, micro-app[name=\"subapp\"] .b",{"type":404,"value":2716},"。刚才提到可以在业务代码中使用注释给特定选择器禁用 prefix 前缀，相关的代码的实现也在这个函数中。",{"type":398,"tag":428,"props":2718,"children":2720},{"className":988,"code":2719,"language":990,"meta":392,"style":392},"const selectors = this.formatSelector()\n\nprivate formatSelector (skip: boolean): false | string {\n  // 匹配选择器正文\n  const m = this.commonMatch(/^[^{]+/, skip)\n  return m[0].replace(/(^|,[\\n\\s]*)([^,]+)/g, (_, separator, selector) => {\n    // 如果检测到选择器被禁用则跳过添加前缀步骤\n    if (...) {\n      const prefix = this.prefix // micro-app[name=\"subapp\"]\n      selector = prefix + ' ' + selector\n    }\n    return separator + selector\n  })\n}\n",[2721],{"type":398,"tag":435,"props":2722,"children":2723},{"__ignoreMap":392},[2724,2756,2763,2798,2806,2884,3042,3050,3074,3109,3147,3154,3173,3184],{"type":398,"tag":439,"props":2725,"children":2726},{"class":441,"line":442},[2727,2732,2736,2740,2744,2748,2752],{"type":398,"tag":439,"props":2728,"children":2729},{"style":1000},[2730],{"type":404,"value":2731},"const",{"type":398,"tag":439,"props":2733,"children":2734},{"style":509},[2735],{"type":404,"value":2437},{"type":398,"tag":439,"props":2737,"children":2738},{"style":599},[2739],{"type":404,"value":2442},{"type":398,"tag":439,"props":2741,"children":2742},{"style":1055},[2743],{"type":404,"value":1190},{"type":398,"tag":439,"props":2745,"children":2746},{"style":467},[2747],{"type":404,"value":459},{"type":398,"tag":439,"props":2749,"children":2750},{"style":1065},[2751],{"type":404,"value":2455},{"type":398,"tag":439,"props":2753,"children":2754},{"style":503},[2755],{"type":404,"value":1996},{"type":398,"tag":439,"props":2757,"children":2758},{"class":441,"line":452},[2759],{"type":398,"tag":439,"props":2760,"children":2761},{"emptyLinePlaceholder":563},[2762],{"type":404,"value":566},{"type":398,"tag":439,"props":2764,"children":2765},{"class":441,"line":473},[2766,2770,2774,2779,2784,2789,2794],{"type":398,"tag":439,"props":2767,"children":2768},{"style":503},[2769],{"type":404,"value":1956},{"type":398,"tag":439,"props":2771,"children":2772},{"style":1065},[2773],{"type":404,"value":2455},{"type":398,"tag":439,"props":2775,"children":2776},{"style":503},[2777],{"type":404,"value":2778}," (skip: boolean): ",{"type":398,"tag":439,"props":2780,"children":2781},{"style":1255},[2782],{"type":404,"value":2783},"false",{"type":398,"tag":439,"props":2785,"children":2786},{"style":599},[2787],{"type":404,"value":2788}," |",{"type":398,"tag":439,"props":2790,"children":2791},{"style":503},[2792],{"type":404,"value":2793}," string ",{"type":398,"tag":439,"props":2795,"children":2796},{"style":467},[2797],{"type":404,"value":1244},{"type":398,"tag":439,"props":2799,"children":2800},{"class":441,"line":499},[2801],{"type":398,"tag":439,"props":2802,"children":2803},{"style":446},[2804],{"type":404,"value":2805},"  // 匹配选择器正文\n",{"type":398,"tag":439,"props":2807,"children":2808},{"class":441,"line":519},[2809,2813,2818,2822,2826,2830,2834,2838,2842,2846,2851,2855,2859,2863,2867,2871,2875,2880],{"type":398,"tag":439,"props":2810,"children":2811},{"style":1000},[2812],{"type":404,"value":2432},{"type":398,"tag":439,"props":2814,"children":2815},{"style":509},[2816],{"type":404,"value":2817}," m",{"type":398,"tag":439,"props":2819,"children":2820},{"style":599},[2821],{"type":404,"value":2442},{"type":398,"tag":439,"props":2823,"children":2824},{"style":1055},[2825],{"type":404,"value":1190},{"type":398,"tag":439,"props":2827,"children":2828},{"style":467},[2829],{"type":404,"value":459},{"type":398,"tag":439,"props":2831,"children":2832},{"style":1065},[2833],{"type":404,"value":2285},{"type":398,"tag":439,"props":2835,"children":2836},{"style":1049},[2837],{"type":404,"value":1151},{"type":398,"tag":439,"props":2839,"children":2840},{"style":605},[2841],{"type":404,"value":1176},{"type":398,"tag":439,"props":2843,"children":2844},{"style":1043},[2845],{"type":404,"value":2298},{"type":398,"tag":439,"props":2847,"children":2849},{"style":2848},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2850],{"type":404,"value":590},{"type":398,"tag":439,"props":2852,"children":2853},{"style":599},[2854],{"type":404,"value":2298},{"type":398,"tag":439,"props":2856,"children":2857},{"style":2301},[2858],{"type":404,"value":2691},{"type":398,"tag":439,"props":2860,"children":2861},{"style":2848},[2862],{"type":404,"value":623},{"type":398,"tag":439,"props":2864,"children":2865},{"style":599},[2866],{"type":404,"value":1484},{"type":398,"tag":439,"props":2868,"children":2869},{"style":605},[2870],{"type":404,"value":1176},{"type":398,"tag":439,"props":2872,"children":2873},{"style":467},[2874],{"type":404,"value":1627},{"type":398,"tag":439,"props":2876,"children":2877},{"style":503},[2878],{"type":404,"value":2879}," skip",{"type":398,"tag":439,"props":2881,"children":2882},{"style":1049},[2883],{"type":404,"value":1513},{"type":398,"tag":439,"props":2885,"children":2886},{"class":441,"line":541},[2887,2891,2895,2899,2903,2907,2911,2916,2920,2924,2929,2933,2937,2942,2946,2951,2955,2959,2964,2968,2972,2976,2980,2984,2988,2992,2998,3002,3006,3011,3015,3020,3024,3029,3033,3038],{"type":398,"tag":439,"props":2888,"children":2889},{"style":1043},[2890],{"type":404,"value":2660},{"type":398,"tag":439,"props":2892,"children":2893},{"style":503},[2894],{"type":404,"value":2817},{"type":398,"tag":439,"props":2896,"children":2897},{"style":1049},[2898],{"type":404,"value":590},{"type":398,"tag":439,"props":2900,"children":2901},{"style":488},[2902],{"type":404,"value":1156},{"type":398,"tag":439,"props":2904,"children":2905},{"style":1049},[2906],{"type":404,"value":623},{"type":398,"tag":439,"props":2908,"children":2909},{"style":467},[2910],{"type":404,"value":459},{"type":398,"tag":439,"props":2912,"children":2913},{"style":1065},[2914],{"type":404,"value":2915},"replace",{"type":398,"tag":439,"props":2917,"children":2918},{"style":1049},[2919],{"type":404,"value":1151},{"type":398,"tag":439,"props":2921,"children":2922},{"style":605},[2923],{"type":404,"value":1176},{"type":398,"tag":439,"props":2925,"children":2927},{"style":2926},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[2928],{"type":404,"value":1151},{"type":398,"tag":439,"props":2930,"children":2931},{"style":1043},[2932],{"type":404,"value":2298},{"type":398,"tag":439,"props":2934,"children":2935},{"style":599},[2936],{"type":404,"value":2415},{"type":398,"tag":439,"props":2938,"children":2940},{"style":2939},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[2941],{"type":404,"value":1627},{"type":398,"tag":439,"props":2943,"children":2944},{"style":2848},[2945],{"type":404,"value":590},{"type":398,"tag":439,"props":2947,"children":2948},{"style":2301},[2949],{"type":404,"value":2950},"\\n\\s",{"type":398,"tag":439,"props":2952,"children":2953},{"style":2848},[2954],{"type":404,"value":623},{"type":398,"tag":439,"props":2956,"children":2957},{"style":599},[2958],{"type":404,"value":1231},{"type":398,"tag":439,"props":2960,"children":2961},{"style":2926},[2962],{"type":404,"value":2963},")(",{"type":398,"tag":439,"props":2965,"children":2966},{"style":2848},[2967],{"type":404,"value":590},{"type":398,"tag":439,"props":2969,"children":2970},{"style":599},[2971],{"type":404,"value":2298},{"type":398,"tag":439,"props":2973,"children":2974},{"style":2301},[2975],{"type":404,"value":1627},{"type":398,"tag":439,"props":2977,"children":2978},{"style":2848},[2979],{"type":404,"value":623},{"type":398,"tag":439,"props":2981,"children":2982},{"style":599},[2983],{"type":404,"value":1484},{"type":398,"tag":439,"props":2985,"children":2986},{"style":2926},[2987],{"type":404,"value":1645},{"type":398,"tag":439,"props":2989,"children":2990},{"style":605},[2991],{"type":404,"value":1176},{"type":398,"tag":439,"props":2993,"children":2995},{"style":2994},"--shiki-light:#F76D47;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[2996],{"type":404,"value":2997},"g",{"type":398,"tag":439,"props":2999,"children":3000},{"style":467},[3001],{"type":404,"value":1627},{"type":398,"tag":439,"props":3003,"children":3004},{"style":467},[3005],{"type":404,"value":1052},{"type":398,"tag":439,"props":3007,"children":3008},{"style":1790},[3009],{"type":404,"value":3010},"_",{"type":398,"tag":439,"props":3012,"children":3013},{"style":467},[3014],{"type":404,"value":1627},{"type":398,"tag":439,"props":3016,"children":3017},{"style":1790},[3018],{"type":404,"value":3019}," separator",{"type":398,"tag":439,"props":3021,"children":3022},{"style":467},[3023],{"type":404,"value":1627},{"type":398,"tag":439,"props":3025,"children":3026},{"style":1790},[3027],{"type":404,"value":3028}," selector",{"type":398,"tag":439,"props":3030,"children":3031},{"style":467},[3032],{"type":404,"value":1645},{"type":398,"tag":439,"props":3034,"children":3035},{"style":1000},[3036],{"type":404,"value":3037}," =>",{"type":398,"tag":439,"props":3039,"children":3040},{"style":467},[3041],{"type":404,"value":470},{"type":398,"tag":439,"props":3043,"children":3044},{"class":441,"line":550},[3045],{"type":398,"tag":439,"props":3046,"children":3047},{"style":446},[3048],{"type":404,"value":3049},"    // 如果检测到选择器被禁用则跳过添加前缀步骤\n",{"type":398,"tag":439,"props":3051,"children":3052},{"class":441,"line":559},[3053,3057,3061,3066,3070],{"type":398,"tag":439,"props":3054,"children":3055},{"style":1043},[3056],{"type":404,"value":1120},{"type":398,"tag":439,"props":3058,"children":3059},{"style":1049},[3060],{"type":404,"value":1052},{"type":398,"tag":439,"props":3062,"children":3063},{"style":599},[3064],{"type":404,"value":3065},"...",{"type":398,"tag":439,"props":3067,"children":3068},{"style":1049},[3069],{"type":404,"value":1161},{"type":398,"tag":439,"props":3071,"children":3072},{"style":467},[3073],{"type":404,"value":1244},{"type":398,"tag":439,"props":3075,"children":3076},{"class":441,"line":569},[3077,3082,3087,3091,3095,3099,3104],{"type":398,"tag":439,"props":3078,"children":3079},{"style":1000},[3080],{"type":404,"value":3081},"      const",{"type":398,"tag":439,"props":3083,"children":3084},{"style":509},[3085],{"type":404,"value":3086}," prefix",{"type":398,"tag":439,"props":3088,"children":3089},{"style":599},[3090],{"type":404,"value":2442},{"type":398,"tag":439,"props":3092,"children":3093},{"style":1055},[3094],{"type":404,"value":1190},{"type":398,"tag":439,"props":3096,"children":3097},{"style":467},[3098],{"type":404,"value":459},{"type":398,"tag":439,"props":3100,"children":3101},{"style":503},[3102],{"type":404,"value":3103},"prefix",{"type":398,"tag":439,"props":3105,"children":3106},{"style":446},[3107],{"type":404,"value":3108}," // micro-app[name=\"subapp\"]\n",{"type":398,"tag":439,"props":3110,"children":3111},{"class":441,"line":578},[3112,3117,3121,3125,3130,3134,3138,3142],{"type":398,"tag":439,"props":3113,"children":3114},{"style":503},[3115],{"type":404,"value":3116},"      selector",{"type":398,"tag":439,"props":3118,"children":3119},{"style":599},[3120],{"type":404,"value":2442},{"type":398,"tag":439,"props":3122,"children":3123},{"style":503},[3124],{"type":404,"value":3086},{"type":398,"tag":439,"props":3126,"children":3127},{"style":599},[3128],{"type":404,"value":3129}," +",{"type":398,"tag":439,"props":3131,"children":3132},{"style":605},[3133],{"type":404,"value":2101},{"type":398,"tag":439,"props":3135,"children":3136},{"style":605},[3137],{"type":404,"value":2101},{"type":398,"tag":439,"props":3139,"children":3140},{"style":599},[3141],{"type":404,"value":3129},{"type":398,"tag":439,"props":3143,"children":3144},{"style":503},[3145],{"type":404,"value":3146}," selector\n",{"type":398,"tag":439,"props":3148,"children":3149},{"class":441,"line":639},[3150],{"type":398,"tag":439,"props":3151,"children":3152},{"style":467},[3153],{"type":404,"value":1270},{"type":398,"tag":439,"props":3155,"children":3156},{"class":441,"line":659},[3157,3161,3165,3169],{"type":398,"tag":439,"props":3158,"children":3159},{"style":1043},[3160],{"type":404,"value":1286},{"type":398,"tag":439,"props":3162,"children":3163},{"style":503},[3164],{"type":404,"value":3019},{"type":398,"tag":439,"props":3166,"children":3167},{"style":599},[3168],{"type":404,"value":3129},{"type":398,"tag":439,"props":3170,"children":3171},{"style":503},[3172],{"type":404,"value":3146},{"type":398,"tag":439,"props":3174,"children":3175},{"class":441,"line":675},[3176,3180],{"type":398,"tag":439,"props":3177,"children":3178},{"style":467},[3179],{"type":404,"value":838},{"type":398,"tag":439,"props":3181,"children":3182},{"style":1049},[3183],{"type":404,"value":1513},{"type":398,"tag":439,"props":3185,"children":3186},{"class":441,"line":695},[3187],{"type":398,"tag":439,"props":3188,"children":3189},{"style":467},[3190],{"type":404,"value":556},{"type":398,"tag":406,"props":3192,"children":3193},{},[3194,3196,3201,3203,3208,3210,3215,3217,3222,3224,3231],{"type":404,"value":3195},"匹配完选择器后，声明便是剩下的包含在左右花括号的内容。匹配过程是一个递归，以遇到",{"type":398,"tag":435,"props":3197,"children":3199},{"className":3198},[],[3200],{"type":404,"value":1906},{"type":404,"value":3202},"作为结束条件。如果遇到斜杠",{"type":398,"tag":435,"props":3204,"children":3206},{"className":3205},[],[3207],{"type":404,"value":1176},{"type":404,"value":3209},"，则尝试停止声明匹配并开始注释匹配。总之，",{"type":398,"tag":435,"props":3211,"children":3213},{"className":3212},[],[3214],{"type":404,"value":1906},{"type":404,"value":3216},"之前的内容都作为当前选择器的声明，添加到",{"type":398,"tag":435,"props":3218,"children":3220},{"className":3219},[],[3221],{"type":404,"value":1137},{"type":404,"value":3223},"中。micro-app 框架会对 CSS 资源中的 URL 补全为主应用的完整路径这个功能也是在这个函数中实现，有兴趣的话可以查看其",{"type":398,"tag":417,"props":3225,"children":3228},{"href":3226,"rel":3227},"https://github.com/micro-zoe/micro-app/blob/dev/src/sandbox/scoped_css.ts",[421],[3229],{"type":404,"value":3230},"完整代码",{"type":404,"value":924},{"type":398,"tag":428,"props":3233,"children":3235},{"className":988,"code":3234,"language":990,"meta":392,"style":392},"private matchAllDeclarations (): void {\n  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n  this.recordResult(cssValue)\n\n  // 递归退出条件\n  if (!this.cssText) return\n  if (this.cssText.charAt(0) === '}') return\n\n  // extract comments in declarations\n  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n    this.matchComments()\n  } else {\n    // 如果不是注释则忽略中断，继续匹配声明\n    this.commonMatch(/\\/+/)\n  }\n\n  return this.matchAllDeclarations()\n}\n",[3236],{"type":398,"tag":435,"props":3237,"children":3238},{"__ignoreMap":392},[3239,3263,3373,3401,3408,3416,3452,3520,3527,3535,3655,3674,3690,3698,3739,3746,3753,3776],{"type":398,"tag":439,"props":3240,"children":3241},{"class":441,"line":442},[3242,3246,3251,3255,3259],{"type":398,"tag":439,"props":3243,"children":3244},{"style":503},[3245],{"type":404,"value":1956},{"type":398,"tag":439,"props":3247,"children":3248},{"style":1065},[3249],{"type":404,"value":3250},"matchAllDeclarations",{"type":398,"tag":439,"props":3252,"children":3253},{"style":503},[3254],{"type":404,"value":1966},{"type":398,"tag":439,"props":3256,"children":3257},{"style":599},[3258],{"type":404,"value":1971},{"type":398,"tag":439,"props":3260,"children":3261},{"style":467},[3262],{"type":404,"value":470},{"type":398,"tag":439,"props":3264,"children":3265},{"class":441,"line":452},[3266,3271,3276,3280,3284,3288,3292,3296,3300,3304,3308,3312,3316,3321,3325,3329,3333,3337,3341,3345,3349,3354,3359,3364,3368],{"type":398,"tag":439,"props":3267,"children":3268},{"style":1000},[3269],{"type":404,"value":3270},"  let",{"type":398,"tag":439,"props":3272,"children":3273},{"style":503},[3274],{"type":404,"value":3275}," cssValue",{"type":398,"tag":439,"props":3277,"children":3278},{"style":599},[3279],{"type":404,"value":2442},{"type":398,"tag":439,"props":3281,"children":3282},{"style":1049},[3283],{"type":404,"value":1052},{"type":398,"tag":439,"props":3285,"children":3286},{"style":1055},[3287],{"type":404,"value":1058},{"type":398,"tag":439,"props":3289,"children":3290},{"style":467},[3291],{"type":404,"value":459},{"type":398,"tag":439,"props":3293,"children":3294},{"style":1065},[3295],{"type":404,"value":2285},{"type":398,"tag":439,"props":3297,"children":3298},{"style":1049},[3299],{"type":404,"value":1151},{"type":398,"tag":439,"props":3301,"children":3302},{"style":605},[3303],{"type":404,"value":1176},{"type":398,"tag":439,"props":3305,"children":3306},{"style":1043},[3307],{"type":404,"value":2298},{"type":398,"tag":439,"props":3309,"children":3310},{"style":2848},[3311],{"type":404,"value":590},{"type":398,"tag":439,"props":3313,"children":3314},{"style":599},[3315],{"type":404,"value":2298},{"type":398,"tag":439,"props":3317,"children":3318},{"style":2301},[3319],{"type":404,"value":3320},"}/",{"type":398,"tag":439,"props":3322,"children":3323},{"style":2848},[3324],{"type":404,"value":623},{"type":398,"tag":439,"props":3326,"children":3327},{"style":2939},[3328],{"type":404,"value":1645},{"type":398,"tag":439,"props":3330,"children":3331},{"style":599},[3332],{"type":404,"value":1231},{"type":398,"tag":439,"props":3334,"children":3335},{"style":605},[3336],{"type":404,"value":1176},{"type":398,"tag":439,"props":3338,"children":3339},{"style":467},[3340],{"type":404,"value":1627},{"type":398,"tag":439,"props":3342,"children":3343},{"style":1255},[3344],{"type":404,"value":1291},{"type":398,"tag":439,"props":3346,"children":3347},{"style":1049},[3348],{"type":404,"value":1161},{"type":398,"tag":439,"props":3350,"children":3351},{"style":1043},[3352],{"type":404,"value":3353},"as",{"type":398,"tag":439,"props":3355,"children":3356},{"style":1006},[3357],{"type":404,"value":3358}," RegExpExecArray",{"type":398,"tag":439,"props":3360,"children":3361},{"style":1049},[3362],{"type":404,"value":3363},")[",{"type":398,"tag":439,"props":3365,"children":3366},{"style":488},[3367],{"type":404,"value":1156},{"type":398,"tag":439,"props":3369,"children":3370},{"style":1049},[3371],{"type":404,"value":3372},"]\n",{"type":398,"tag":439,"props":3374,"children":3375},{"class":441,"line":473},[3376,3380,3384,3388,3392,3397],{"type":398,"tag":439,"props":3377,"children":3378},{"style":1055},[3379],{"type":404,"value":1367},{"type":398,"tag":439,"props":3381,"children":3382},{"style":467},[3383],{"type":404,"value":459},{"type":398,"tag":439,"props":3385,"children":3386},{"style":1065},[3387],{"type":404,"value":1853},{"type":398,"tag":439,"props":3389,"children":3390},{"style":1049},[3391],{"type":404,"value":1151},{"type":398,"tag":439,"props":3393,"children":3394},{"style":503},[3395],{"type":404,"value":3396},"cssValue",{"type":398,"tag":439,"props":3398,"children":3399},{"style":1049},[3400],{"type":404,"value":1513},{"type":398,"tag":439,"props":3402,"children":3403},{"class":441,"line":499},[3404],{"type":398,"tag":439,"props":3405,"children":3406},{"emptyLinePlaceholder":563},[3407],{"type":404,"value":566},{"type":398,"tag":439,"props":3409,"children":3410},{"class":441,"line":519},[3411],{"type":398,"tag":439,"props":3412,"children":3413},{"style":446},[3414],{"type":404,"value":3415},"  // 递归退出条件\n",{"type":398,"tag":439,"props":3417,"children":3418},{"class":441,"line":541},[3419,3423,3427,3431,3435,3439,3443,3447],{"type":398,"tag":439,"props":3420,"children":3421},{"style":1043},[3422],{"type":404,"value":2501},{"type":398,"tag":439,"props":3424,"children":3425},{"style":1049},[3426],{"type":404,"value":1052},{"type":398,"tag":439,"props":3428,"children":3429},{"style":599},[3430],{"type":404,"value":2510},{"type":398,"tag":439,"props":3432,"children":3433},{"style":1055},[3434],{"type":404,"value":1058},{"type":398,"tag":439,"props":3436,"children":3437},{"style":467},[3438],{"type":404,"value":459},{"type":398,"tag":439,"props":3440,"children":3441},{"style":503},[3442],{"type":404,"value":1137},{"type":398,"tag":439,"props":3444,"children":3445},{"style":1049},[3446],{"type":404,"value":1161},{"type":398,"tag":439,"props":3448,"children":3449},{"style":1043},[3450],{"type":404,"value":3451},"return\n",{"type":398,"tag":439,"props":3453,"children":3454},{"class":441,"line":550},[3455,3459,3463,3467,3471,3475,3479,3483,3487,3491,3495,3500,3504,3508,3512,3516],{"type":398,"tag":439,"props":3456,"children":3457},{"style":1043},[3458],{"type":404,"value":2501},{"type":398,"tag":439,"props":3460,"children":3461},{"style":1049},[3462],{"type":404,"value":1052},{"type":398,"tag":439,"props":3464,"children":3465},{"style":1055},[3466],{"type":404,"value":1058},{"type":398,"tag":439,"props":3468,"children":3469},{"style":467},[3470],{"type":404,"value":459},{"type":398,"tag":439,"props":3472,"children":3473},{"style":503},[3474],{"type":404,"value":1137},{"type":398,"tag":439,"props":3476,"children":3477},{"style":467},[3478],{"type":404,"value":459},{"type":398,"tag":439,"props":3480,"children":3481},{"style":1065},[3482],{"type":404,"value":1146},{"type":398,"tag":439,"props":3484,"children":3485},{"style":1049},[3486],{"type":404,"value":1151},{"type":398,"tag":439,"props":3488,"children":3489},{"style":488},[3490],{"type":404,"value":1156},{"type":398,"tag":439,"props":3492,"children":3493},{"style":1049},[3494],{"type":404,"value":1161},{"type":398,"tag":439,"props":3496,"children":3497},{"style":599},[3498],{"type":404,"value":3499},"===",{"type":398,"tag":439,"props":3501,"children":3502},{"style":605},[3503],{"type":404,"value":2101},{"type":398,"tag":439,"props":3505,"children":3506},{"style":611},[3507],{"type":404,"value":1906},{"type":398,"tag":439,"props":3509,"children":3510},{"style":605},[3511],{"type":404,"value":2110},{"type":398,"tag":439,"props":3513,"children":3514},{"style":1049},[3515],{"type":404,"value":1161},{"type":398,"tag":439,"props":3517,"children":3518},{"style":1043},[3519],{"type":404,"value":3451},{"type":398,"tag":439,"props":3521,"children":3522},{"class":441,"line":559},[3523],{"type":398,"tag":439,"props":3524,"children":3525},{"emptyLinePlaceholder":563},[3526],{"type":404,"value":566},{"type":398,"tag":439,"props":3528,"children":3529},{"class":441,"line":569},[3530],{"type":398,"tag":439,"props":3531,"children":3532},{"style":446},[3533],{"type":404,"value":3534},"  // extract comments in declarations\n",{"type":398,"tag":439,"props":3536,"children":3537},{"class":441,"line":578},[3538,3542,3546,3550,3554,3558,3562,3566,3570,3574,3578,3582,3586,3590,3594,3599,3603,3607,3611,3615,3619,3623,3627,3631,3635,3639,3643,3647,3651],{"type":398,"tag":439,"props":3539,"children":3540},{"style":1043},[3541],{"type":404,"value":2501},{"type":398,"tag":439,"props":3543,"children":3544},{"style":1049},[3545],{"type":404,"value":1052},{"type":398,"tag":439,"props":3547,"children":3548},{"style":1055},[3549],{"type":404,"value":1058},{"type":398,"tag":439,"props":3551,"children":3552},{"style":467},[3553],{"type":404,"value":459},{"type":398,"tag":439,"props":3555,"children":3556},{"style":503},[3557],{"type":404,"value":1137},{"type":398,"tag":439,"props":3559,"children":3560},{"style":467},[3561],{"type":404,"value":459},{"type":398,"tag":439,"props":3563,"children":3564},{"style":1065},[3565],{"type":404,"value":1146},{"type":398,"tag":439,"props":3567,"children":3568},{"style":1049},[3569],{"type":404,"value":1151},{"type":398,"tag":439,"props":3571,"children":3572},{"style":488},[3573],{"type":404,"value":1156},{"type":398,"tag":439,"props":3575,"children":3576},{"style":1049},[3577],{"type":404,"value":1161},{"type":398,"tag":439,"props":3579,"children":3580},{"style":599},[3581],{"type":404,"value":3499},{"type":398,"tag":439,"props":3583,"children":3584},{"style":605},[3585],{"type":404,"value":2101},{"type":398,"tag":439,"props":3587,"children":3588},{"style":611},[3589],{"type":404,"value":1176},{"type":398,"tag":439,"props":3591,"children":3592},{"style":605},[3593],{"type":404,"value":2110},{"type":398,"tag":439,"props":3595,"children":3596},{"style":599},[3597],{"type":404,"value":3598}," &&",{"type":398,"tag":439,"props":3600,"children":3601},{"style":1055},[3602],{"type":404,"value":1190},{"type":398,"tag":439,"props":3604,"children":3605},{"style":467},[3606],{"type":404,"value":459},{"type":398,"tag":439,"props":3608,"children":3609},{"style":503},[3610],{"type":404,"value":1137},{"type":398,"tag":439,"props":3612,"children":3613},{"style":467},[3614],{"type":404,"value":459},{"type":398,"tag":439,"props":3616,"children":3617},{"style":1065},[3618],{"type":404,"value":1146},{"type":398,"tag":439,"props":3620,"children":3621},{"style":1049},[3622],{"type":404,"value":1151},{"type":398,"tag":439,"props":3624,"children":3625},{"style":488},[3626],{"type":404,"value":922},{"type":398,"tag":439,"props":3628,"children":3629},{"style":1049},[3630],{"type":404,"value":1161},{"type":398,"tag":439,"props":3632,"children":3633},{"style":599},[3634],{"type":404,"value":3499},{"type":398,"tag":439,"props":3636,"children":3637},{"style":605},[3638],{"type":404,"value":2101},{"type":398,"tag":439,"props":3640,"children":3641},{"style":611},[3642],{"type":404,"value":1231},{"type":398,"tag":439,"props":3644,"children":3645},{"style":605},[3646],{"type":404,"value":2110},{"type":398,"tag":439,"props":3648,"children":3649},{"style":1049},[3650],{"type":404,"value":1161},{"type":398,"tag":439,"props":3652,"children":3653},{"style":467},[3654],{"type":404,"value":1244},{"type":398,"tag":439,"props":3656,"children":3657},{"class":441,"line":639},[3658,3662,3666,3670],{"type":398,"tag":439,"props":3659,"children":3660},{"style":1055},[3661],{"type":404,"value":2036},{"type":398,"tag":439,"props":3663,"children":3664},{"style":467},[3665],{"type":404,"value":459},{"type":398,"tag":439,"props":3667,"children":3668},{"style":1065},[3669],{"type":404,"value":2012},{"type":398,"tag":439,"props":3671,"children":3672},{"style":1049},[3673],{"type":404,"value":1996},{"type":398,"tag":439,"props":3675,"children":3676},{"class":441,"line":659},[3677,3681,3686],{"type":398,"tag":439,"props":3678,"children":3679},{"style":467},[3680],{"type":404,"value":838},{"type":398,"tag":439,"props":3682,"children":3683},{"style":1043},[3684],{"type":404,"value":3685}," else",{"type":398,"tag":439,"props":3687,"children":3688},{"style":467},[3689],{"type":404,"value":470},{"type":398,"tag":439,"props":3691,"children":3692},{"class":441,"line":675},[3693],{"type":398,"tag":439,"props":3694,"children":3695},{"style":446},[3696],{"type":404,"value":3697},"    // 如果不是注释则忽略中断，继续匹配声明\n",{"type":398,"tag":439,"props":3699,"children":3700},{"class":441,"line":695},[3701,3705,3709,3713,3717,3721,3727,3731,3735],{"type":398,"tag":439,"props":3702,"children":3703},{"style":1055},[3704],{"type":404,"value":2036},{"type":398,"tag":439,"props":3706,"children":3707},{"style":467},[3708],{"type":404,"value":459},{"type":398,"tag":439,"props":3710,"children":3711},{"style":1065},[3712],{"type":404,"value":2285},{"type":398,"tag":439,"props":3714,"children":3715},{"style":1049},[3716],{"type":404,"value":1151},{"type":398,"tag":439,"props":3718,"children":3719},{"style":605},[3720],{"type":404,"value":1176},{"type":398,"tag":439,"props":3722,"children":3724},{"style":3723},"--shiki-light:#90A4AE;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#AE81FF;--shiki-light-font-weight:inherit;--shiki-default-font-weight:bold;--shiki-dark-font-weight:bold;--shiki-sepia-font-weight:inherit",[3725],{"type":404,"value":3726},"\\/",{"type":398,"tag":439,"props":3728,"children":3729},{"style":599},[3730],{"type":404,"value":1484},{"type":398,"tag":439,"props":3732,"children":3733},{"style":605},[3734],{"type":404,"value":1176},{"type":398,"tag":439,"props":3736,"children":3737},{"style":1049},[3738],{"type":404,"value":1513},{"type":398,"tag":439,"props":3740,"children":3741},{"class":441,"line":703},[3742],{"type":398,"tag":439,"props":3743,"children":3744},{"style":467},[3745],{"type":404,"value":547},{"type":398,"tag":439,"props":3747,"children":3748},{"class":441,"line":711},[3749],{"type":398,"tag":439,"props":3750,"children":3751},{"emptyLinePlaceholder":563},[3752],{"type":404,"value":566},{"type":398,"tag":439,"props":3754,"children":3755},{"class":441,"line":719},[3756,3760,3764,3768,3772],{"type":398,"tag":439,"props":3757,"children":3758},{"style":1043},[3759],{"type":404,"value":2660},{"type":398,"tag":439,"props":3761,"children":3762},{"style":1055},[3763],{"type":404,"value":1190},{"type":398,"tag":439,"props":3765,"children":3766},{"style":467},[3767],{"type":404,"value":459},{"type":398,"tag":439,"props":3769,"children":3770},{"style":1065},[3771],{"type":404,"value":3250},{"type":398,"tag":439,"props":3773,"children":3774},{"style":1049},[3775],{"type":404,"value":1996},{"type":398,"tag":439,"props":3777,"children":3778},{"class":441,"line":728},[3779],{"type":398,"tag":439,"props":3780,"children":3781},{"style":467},[3782],{"type":404,"value":556},{"type":398,"tag":953,"props":3784,"children":3786},{"id":3785},"解析at-rule",[3787,3789],{"type":404,"value":3788},"解析",{"type":398,"tag":435,"props":3790,"children":3792},{"className":3791},[],[3793],{"type":404,"value":944},{"type":398,"tag":406,"props":3795,"children":3796},{},[3797,3799,3805,3807,3813,3814,3820,3822,3833],{"type":404,"value":3798},"流程中最繁琐的部分，是匹配 ",{"type":398,"tag":435,"props":3800,"children":3802},{"className":3801},[],[3803],{"type":404,"value":3804},"@media",{"type":404,"value":3806},"、",{"type":398,"tag":435,"props":3808,"children":3810},{"className":3809},[],[3811],{"type":404,"value":3812},"@import",{"type":404,"value":3806},{"type":398,"tag":435,"props":3815,"children":3817},{"className":3816},[],[3818],{"type":404,"value":3819},"@charset",{"type":404,"value":3821}," 等 ",{"type":398,"tag":417,"props":3823,"children":3826},{"href":3824,"rel":3825},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/At-rule",[421],[3827],{"type":398,"tag":435,"props":3828,"children":3830},{"className":3829},[],[3831],{"type":404,"value":3832},"at-rules",{"type":404,"value":924},{"type":398,"tag":406,"props":3835,"children":3836},{},[3837],{"type":404,"value":3838},"每一种规则的语法都不同，要怎么处理才合适呢？",{"type":398,"tag":406,"props":3840,"children":3841},{},[3842,3844,3849],{"type":404,"value":3843},"这里，micro-app 把 ",{"type":398,"tag":435,"props":3845,"children":3847},{"className":3846},[],[3848],{"type":404,"value":944},{"type":404,"value":3850}," 分为了三组：",{"type":398,"tag":3852,"props":3853,"children":3854},"ol",{},[3855,3889,3921],{"type":398,"tag":3856,"props":3857,"children":3858},"li",{},[3859,3861,3867,3869,3874,3875,3880,3881,3887],{"type":404,"value":3860},"类似 ",{"type":398,"tag":435,"props":3862,"children":3864},{"className":3863},[],[3865],{"type":404,"value":3866},"@charset \"utf-8\";",{"type":404,"value":3868}," 为一组，包括 ",{"type":398,"tag":435,"props":3870,"children":3872},{"className":3871},[],[3873],{"type":404,"value":3812},{"type":404,"value":3806},{"type":398,"tag":435,"props":3876,"children":3878},{"className":3877},[],[3879],{"type":404,"value":3819},{"type":404,"value":3806},{"type":398,"tag":435,"props":3882,"children":3884},{"className":3883},[],[3885],{"type":404,"value":3886},"@namespace",{"type":404,"value":3888}," 等。",{"type":398,"tag":3856,"props":3890,"children":3891},{},[3892,3893,3899,3900,3906,3907,3913,3914,3920],{"type":404,"value":3860},{"type":398,"tag":435,"props":3894,"children":3896},{"className":3895},[],[3897],{"type":404,"value":3898},"@media (w \u003C 100px) { .selector { xxx: xxx } }",{"type":404,"value":3868},{"type":398,"tag":435,"props":3901,"children":3903},{"className":3902},[],[3904],{"type":404,"value":3905},"@supports",{"type":404,"value":3806},{"type":398,"tag":435,"props":3908,"children":3910},{"className":3909},[],[3911],{"type":404,"value":3912},"@font-face",{"type":404,"value":3806},{"type":398,"tag":435,"props":3915,"children":3917},{"className":3916},[],[3918],{"type":404,"value":3919},"@document",{"type":404,"value":3888},{"type":398,"tag":3856,"props":3922,"children":3923},{},[3924,3925,3931,3932,3937,3938,3944,3945,3951],{"type":404,"value":3860},{"type":398,"tag":435,"props":3926,"children":3928},{"className":3927},[],[3929],{"type":404,"value":3930},"@font-face { unicode-range: 'xxx' }",{"type":404,"value":3868},{"type":398,"tag":435,"props":3933,"children":3935},{"className":3934},[],[3936],{"type":404,"value":3912},{"type":404,"value":3806},{"type":398,"tag":435,"props":3939,"children":3941},{"className":3940},[],[3942],{"type":404,"value":3943},"@page",{"type":404,"value":3806},{"type":398,"tag":435,"props":3946,"children":3948},{"className":3947},[],[3949],{"type":404,"value":3950},"@key-frames",{"type":404,"value":3888},{"type":398,"tag":406,"props":3953,"children":3954},{},[3955,3957,3962,3964,3970,3972,3978,3980,3985],{"type":404,"value":3956},"第一组，",{"type":398,"tag":435,"props":3958,"children":3960},{"className":3959},[],[3961],{"type":404,"value":3819},{"type":404,"value":3963}," 所在的第一组规则的规则正文内容从 ",{"type":398,"tag":435,"props":3965,"children":3967},{"className":3966},[],[3968],{"type":404,"value":3969},"@",{"type":404,"value":3971}," 开始到 ",{"type":398,"tag":435,"props":3973,"children":3975},{"className":3974},[],[3976],{"type":404,"value":3977},";",{"type":404,"value":3979}," 结束，比如 ",{"type":398,"tag":435,"props":3981,"children":3983},{"className":3982},[],[3984],{"type":404,"value":3866},{"type":404,"value":3986}," 就是一条完整的声明；",{"type":398,"tag":406,"props":3988,"children":3989},{},[3990,3992,3998,4000,4005],{"type":404,"value":3991},"第二组，",{"type":398,"tag":435,"props":3993,"children":3995},{"className":3994},[],[3996],{"type":404,"value":3997},"@media () {}",{"type":404,"value":3999}," 的花括号部分可能包含选择器，所以其正文内容需要重新进入 ",{"type":398,"tag":435,"props":4001,"children":4003},{"className":4002},[],[4004],{"type":404,"value":1961},{"type":404,"value":4006}," 匹配选择器以及声明。",{"type":398,"tag":406,"props":4008,"children":4009},{},[4010,4012,4018,4020,4025],{"type":404,"value":4011},"第三组，",{"type":398,"tag":435,"props":4013,"children":4015},{"className":4014},[],[4016],{"type":404,"value":4017},"@font-face {}",{"type":404,"value":4019}," 的花括号部分仅包含声明，不包含选择器，所以只需要进入 ",{"type":398,"tag":435,"props":4021,"children":4023},{"className":4022},[],[4024],{"type":404,"value":3250},{"type":404,"value":4026}," 匹配声明即可。",{"type":398,"tag":399,"props":4028,"children":4030},{"id":4029},"解决问题",[4031],{"type":404,"value":4029},{"type":398,"tag":406,"props":4033,"children":4034},{},[4035],{"type":404,"value":4036},"回到文章开头的问题，如果要给这个 CSS Parser 增加原生的嵌套功能，见下代码，可以仅用十行简单实现。",{"type":398,"tag":428,"props":4038,"children":4042},{"className":4039,"code":4040,"language":4041,"meta":392,"style":392},"language-diff shiki shiki-themes material-theme-lighter github-light github-dark monokai","+ private matchAllDeclarations (nesting = 0): void {\n  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n  this.recordResult(cssValue)\n\n  // 递归退出条件\n  if (!this.cssText) return\n-  if (this.cssText.charAt(0) === '}') return\n+  if (this.cssText.charAt(0) === '}') {\n+    if (!nesting) return\n+    this.commonMatch(/}+\\s*/)\n+    return this.matchAllDeclarations(nesting - 1)\n+  }\n\n  // extract comments in declarations\n  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n    this.matchComments()\n  } else {\n    // 如果不是注释则忽略中断，继续匹配声明\n    this.commonMatch(/\\/+/)\n  }\n\n+ if (this.cssText.charAt(0) === '{') {\n+   this.commonMatch(/{+\\s*/)\n+   nesting++\n+ }\n\n- return this.matchAllDeclarations()\n+ return this.matchAllDeclarations(nesting)\n}\n","diff",[4043],{"type":398,"tag":435,"props":4044,"children":4045},{"__ignoreMap":392},[4046,4060,4068,4076,4083,4090,4098,4112,4124,4136,4148,4160,4171,4178,4185,4193,4201,4209,4216,4224,4231,4238,4250,4263,4276,4289,4297,4310,4323],{"type":398,"tag":439,"props":4047,"children":4048},{"class":441,"line":442},[4049,4054],{"type":398,"tag":439,"props":4050,"children":4052},{"style":4051},"--shiki-light:#39ADB5;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#A6E22E",[4053],{"type":404,"value":1484},{"type":398,"tag":439,"props":4055,"children":4057},{"style":4056},"--shiki-light:#91B859;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#A6E22E",[4058],{"type":404,"value":4059}," private matchAllDeclarations (nesting = 0): void {\n",{"type":398,"tag":439,"props":4061,"children":4062},{"class":441,"line":452},[4063],{"type":398,"tag":439,"props":4064,"children":4065},{"style":503},[4066],{"type":404,"value":4067},"  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n",{"type":398,"tag":439,"props":4069,"children":4070},{"class":441,"line":473},[4071],{"type":398,"tag":439,"props":4072,"children":4073},{"style":503},[4074],{"type":404,"value":4075},"  this.recordResult(cssValue)\n",{"type":398,"tag":439,"props":4077,"children":4078},{"class":441,"line":499},[4079],{"type":398,"tag":439,"props":4080,"children":4081},{"emptyLinePlaceholder":563},[4082],{"type":404,"value":566},{"type":398,"tag":439,"props":4084,"children":4085},{"class":441,"line":519},[4086],{"type":398,"tag":439,"props":4087,"children":4088},{"style":503},[4089],{"type":404,"value":3415},{"type":398,"tag":439,"props":4091,"children":4092},{"class":441,"line":541},[4093],{"type":398,"tag":439,"props":4094,"children":4095},{"style":503},[4096],{"type":404,"value":4097},"  if (!this.cssText) return\n",{"type":398,"tag":439,"props":4099,"children":4100},{"class":441,"line":550},[4101,4106],{"type":398,"tag":439,"props":4102,"children":4104},{"style":4103},"--shiki-light:#39ADB5;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F92672",[4105],{"type":404,"value":1636},{"type":398,"tag":439,"props":4107,"children":4109},{"style":4108},"--shiki-light:#E53935;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F92672",[4110],{"type":404,"value":4111},"  if (this.cssText.charAt(0) === '}') return\n",{"type":398,"tag":439,"props":4113,"children":4114},{"class":441,"line":559},[4115,4119],{"type":398,"tag":439,"props":4116,"children":4117},{"style":4051},[4118],{"type":404,"value":1484},{"type":398,"tag":439,"props":4120,"children":4121},{"style":4056},[4122],{"type":404,"value":4123},"  if (this.cssText.charAt(0) === '}') {\n",{"type":398,"tag":439,"props":4125,"children":4126},{"class":441,"line":569},[4127,4131],{"type":398,"tag":439,"props":4128,"children":4129},{"style":4051},[4130],{"type":404,"value":1484},{"type":398,"tag":439,"props":4132,"children":4133},{"style":4056},[4134],{"type":404,"value":4135},"    if (!nesting) return\n",{"type":398,"tag":439,"props":4137,"children":4138},{"class":441,"line":578},[4139,4143],{"type":398,"tag":439,"props":4140,"children":4141},{"style":4051},[4142],{"type":404,"value":1484},{"type":398,"tag":439,"props":4144,"children":4145},{"style":4056},[4146],{"type":404,"value":4147},"    this.commonMatch(/}+\\s*/)\n",{"type":398,"tag":439,"props":4149,"children":4150},{"class":441,"line":639},[4151,4155],{"type":398,"tag":439,"props":4152,"children":4153},{"style":4051},[4154],{"type":404,"value":1484},{"type":398,"tag":439,"props":4156,"children":4157},{"style":4056},[4158],{"type":404,"value":4159},"    return this.matchAllDeclarations(nesting - 1)\n",{"type":398,"tag":439,"props":4161,"children":4162},{"class":441,"line":659},[4163,4167],{"type":398,"tag":439,"props":4164,"children":4165},{"style":4051},[4166],{"type":404,"value":1484},{"type":398,"tag":439,"props":4168,"children":4169},{"style":4056},[4170],{"type":404,"value":547},{"type":398,"tag":439,"props":4172,"children":4173},{"class":441,"line":675},[4174],{"type":398,"tag":439,"props":4175,"children":4176},{"emptyLinePlaceholder":563},[4177],{"type":404,"value":566},{"type":398,"tag":439,"props":4179,"children":4180},{"class":441,"line":695},[4181],{"type":398,"tag":439,"props":4182,"children":4183},{"style":503},[4184],{"type":404,"value":3534},{"type":398,"tag":439,"props":4186,"children":4187},{"class":441,"line":703},[4188],{"type":398,"tag":439,"props":4189,"children":4190},{"style":503},[4191],{"type":404,"value":4192},"  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n",{"type":398,"tag":439,"props":4194,"children":4195},{"class":441,"line":711},[4196],{"type":398,"tag":439,"props":4197,"children":4198},{"style":503},[4199],{"type":404,"value":4200},"    this.matchComments()\n",{"type":398,"tag":439,"props":4202,"children":4203},{"class":441,"line":719},[4204],{"type":398,"tag":439,"props":4205,"children":4206},{"style":503},[4207],{"type":404,"value":4208},"  } else {\n",{"type":398,"tag":439,"props":4210,"children":4211},{"class":441,"line":728},[4212],{"type":398,"tag":439,"props":4213,"children":4214},{"style":503},[4215],{"type":404,"value":3697},{"type":398,"tag":439,"props":4217,"children":4218},{"class":441,"line":776},[4219],{"type":398,"tag":439,"props":4220,"children":4221},{"style":503},[4222],{"type":404,"value":4223},"    this.commonMatch(/\\/+/)\n",{"type":398,"tag":439,"props":4225,"children":4226},{"class":441,"line":796},[4227],{"type":398,"tag":439,"props":4228,"children":4229},{"style":503},[4230],{"type":404,"value":547},{"type":398,"tag":439,"props":4232,"children":4233},{"class":441,"line":812},[4234],{"type":398,"tag":439,"props":4235,"children":4236},{"emptyLinePlaceholder":563},[4237],{"type":404,"value":566},{"type":398,"tag":439,"props":4239,"children":4240},{"class":441,"line":832},[4241,4245],{"type":398,"tag":439,"props":4242,"children":4243},{"style":4051},[4244],{"type":404,"value":1484},{"type":398,"tag":439,"props":4246,"children":4247},{"style":4056},[4248],{"type":404,"value":4249}," if (this.cssText.charAt(0) === '{') {\n",{"type":398,"tag":439,"props":4251,"children":4253},{"class":441,"line":4252},23,[4254,4258],{"type":398,"tag":439,"props":4255,"children":4256},{"style":4051},[4257],{"type":404,"value":1484},{"type":398,"tag":439,"props":4259,"children":4260},{"style":4056},[4261],{"type":404,"value":4262},"   this.commonMatch(/{+\\s*/)\n",{"type":398,"tag":439,"props":4264,"children":4266},{"class":441,"line":4265},24,[4267,4271],{"type":398,"tag":439,"props":4268,"children":4269},{"style":4051},[4270],{"type":404,"value":1484},{"type":398,"tag":439,"props":4272,"children":4273},{"style":4056},[4274],{"type":404,"value":4275},"   nesting++\n",{"type":398,"tag":439,"props":4277,"children":4279},{"class":441,"line":4278},25,[4280,4284],{"type":398,"tag":439,"props":4281,"children":4282},{"style":4051},[4283],{"type":404,"value":1484},{"type":398,"tag":439,"props":4285,"children":4286},{"style":4056},[4287],{"type":404,"value":4288}," }\n",{"type":398,"tag":439,"props":4290,"children":4292},{"class":441,"line":4291},26,[4293],{"type":398,"tag":439,"props":4294,"children":4295},{"emptyLinePlaceholder":563},[4296],{"type":404,"value":566},{"type":398,"tag":439,"props":4298,"children":4300},{"class":441,"line":4299},27,[4301,4305],{"type":398,"tag":439,"props":4302,"children":4303},{"style":4103},[4304],{"type":404,"value":1636},{"type":398,"tag":439,"props":4306,"children":4307},{"style":4108},[4308],{"type":404,"value":4309}," return this.matchAllDeclarations()\n",{"type":398,"tag":439,"props":4311,"children":4313},{"class":441,"line":4312},28,[4314,4318],{"type":398,"tag":439,"props":4315,"children":4316},{"style":4051},[4317],{"type":404,"value":1484},{"type":398,"tag":439,"props":4319,"children":4320},{"style":4056},[4321],{"type":404,"value":4322}," return this.matchAllDeclarations(nesting)\n",{"type":398,"tag":439,"props":4324,"children":4326},{"class":441,"line":4325},29,[4327],{"type":398,"tag":439,"props":4328,"children":4329},{"style":503},[4330],{"type":404,"value":556},{"type":398,"tag":406,"props":4332,"children":4333},{},[4334],{"type":404,"value":4335},"最终 CSS Nesting 解析成功。",{"type":398,"tag":406,"props":4337,"children":4338},{},[4339],{"type":398,"tag":929,"props":4340,"children":4342},{"alt":1828,"src":4341},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230804025910.png",[],{"type":398,"tag":399,"props":4344,"children":4346},{"id":4345},"结语",[4347],{"type":404,"value":4345},{"type":398,"tag":406,"props":4349,"children":4350},{},[4351],{"type":404,"value":4352},"整个 CSS Parser 的代码简单，功能强悍，耐人寻味。不过有许多边界条件没有处理好，尤其是引入了使用注释禁用样式隔离功能后，匹配注释变得更复杂且易错了。",{"type":398,"tag":3852,"props":4354,"children":4355},{},[4356],{"type":398,"tag":3856,"props":4357,"children":4358},{},[4359],{"type":404,"value":4360},"注释不能和选择器等混用（以下 result 文件代表解析结果）。",{"type":398,"tag":406,"props":4362,"children":4363},{},[4364],{"type":398,"tag":929,"props":4365,"children":4368},{"alt":4366,"src":4367},"comment in selectors","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/9d2b75bda238f9bbe24825a793f0f715.png",[],{"type":398,"tag":3852,"props":4370,"children":4371},{"start":452},[4372],{"type":398,"tag":3856,"props":4373,"children":4374},{},[4375],{"type":404,"value":4376},"CSS 字符串值可能意外启用编译器的特殊功能。",{"type":398,"tag":406,"props":4378,"children":4379},{},[4380],{"type":398,"tag":929,"props":4381,"children":4384},{"alt":4382,"src":4383},"special comment in string value","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230803225103.png",[],{"type":398,"tag":3852,"props":4386,"children":4387},{"start":473},[4388],{"type":398,"tag":3856,"props":4389,"children":4390},{},[4391,4393,4399,4401,4412,4414,4419],{"type":404,"value":4392},"错误的 ",{"type":398,"tag":435,"props":4394,"children":4396},{"className":4395},[],[4397],{"type":404,"value":4398},"@host",{"type":404,"value":4400}," 规则匹配。猜测是想匹配 ",{"type":398,"tag":417,"props":4402,"children":4405},{"href":4403,"rel":4404},"https://drafts.csswg.org/css-scoping/#host-selector",[421],[4406],{"type":398,"tag":435,"props":4407,"children":4409},{"className":4408},[],[4410],{"type":404,"value":4411},":host",{"type":404,"value":4413}," 但是手滑写成了 ",{"type":398,"tag":435,"props":4415,"children":4417},{"className":4416},[],[4418],{"type":404,"value":4398},{"type":404,"value":924},{"type":398,"tag":428,"props":4421,"children":4423},{"className":988,"code":4422,"language":990,"meta":392,"style":392},"private hostRule =\n  this.createMatcherForRuleWithChildRule(\n    /^@host\\s*/,\n    '@host'\n  )\n",[4424],{"type":398,"tag":435,"props":4425,"children":4426},{"__ignoreMap":392},[4427,4440,4461,4494,4511],{"type":398,"tag":439,"props":4428,"children":4429},{"class":441,"line":442},[4430,4435],{"type":398,"tag":439,"props":4431,"children":4432},{"style":503},[4433],{"type":404,"value":4434},"private hostRule ",{"type":398,"tag":439,"props":4436,"children":4437},{"style":599},[4438],{"type":404,"value":4439},"=\n",{"type":398,"tag":439,"props":4441,"children":4442},{"class":441,"line":452},[4443,4447,4451,4456],{"type":398,"tag":439,"props":4444,"children":4445},{"style":1055},[4446],{"type":404,"value":1367},{"type":398,"tag":439,"props":4448,"children":4449},{"style":467},[4450],{"type":404,"value":459},{"type":398,"tag":439,"props":4452,"children":4453},{"style":1065},[4454],{"type":404,"value":4455},"createMatcherForRuleWithChildRule",{"type":398,"tag":439,"props":4457,"children":4458},{"style":503},[4459],{"type":404,"value":4460},"(\n",{"type":398,"tag":439,"props":4462,"children":4463},{"class":441,"line":473},[4464,4469,4473,4477,4481,4485,4489],{"type":398,"tag":439,"props":4465,"children":4466},{"style":605},[4467],{"type":404,"value":4468},"    /",{"type":398,"tag":439,"props":4470,"children":4471},{"style":1043},[4472],{"type":404,"value":2298},{"type":398,"tag":439,"props":4474,"children":4475},{"style":2939},[4476],{"type":404,"value":4398},{"type":398,"tag":439,"props":4478,"children":4479},{"style":2301},[4480],{"type":404,"value":2304},{"type":398,"tag":439,"props":4482,"children":4483},{"style":599},[4484],{"type":404,"value":1231},{"type":398,"tag":439,"props":4486,"children":4487},{"style":605},[4488],{"type":404,"value":1176},{"type":398,"tag":439,"props":4490,"children":4491},{"style":467},[4492],{"type":404,"value":4493},",\n",{"type":398,"tag":439,"props":4495,"children":4496},{"class":441,"line":499},[4497,4502,4506],{"type":398,"tag":439,"props":4498,"children":4499},{"style":605},[4500],{"type":404,"value":4501},"    '",{"type":398,"tag":439,"props":4503,"children":4504},{"style":611},[4505],{"type":404,"value":4398},{"type":398,"tag":439,"props":4507,"children":4508},{"style":605},[4509],{"type":404,"value":4510},"'\n",{"type":398,"tag":439,"props":4512,"children":4513},{"class":441,"line":519},[4514],{"type":398,"tag":439,"props":4515,"children":4516},{"style":503},[4517],{"type":404,"value":4518},"  )\n",{"type":398,"tag":406,"props":4520,"children":4521},{},[4522],{"type":398,"tag":929,"props":4523,"children":4526},{"alt":4524,"src":4525},"error @host rule","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230803235802.png",[],{"type":398,"tag":406,"props":4528,"children":4529},{},[4530,4532,4539],{"type":404,"value":4531},"在实际项目中，考虑到性能和可维护性的平衡，为了使代码不变得过于复杂，没有必要去完善“边界功能”。运行时的解析应当尽量简单且运行快速，并保持一定的容错：不规范的 CSS 代码在浏览器中本身就能运行，再者，解析器是一个容易带来代码性能和体积瓶颈的地方，要不然 VueJS 也不会分全局构建和运行时",{"type":398,"tag":417,"props":4533,"children":4536},{"href":4534,"rel":4535},"https://www.jsdelivr.com/package/npm/vue?tab=files&path=dist",[421],[4537],{"type":404,"value":4538},"两个版本的编译产物",{"type":404,"value":924},{"type":398,"tag":406,"props":4541,"children":4542},{},[4543],{"type":404,"value":4544},"鉴于 CSS 在部分语法上的灵活性，如果从降低维护难度的角度考虑优化这个 CSS Parser，可能从以下方向：",{"type":398,"tag":4546,"props":4547,"children":4548},"ul",{},[4549,4584],{"type":398,"tag":3856,"props":4550,"children":4551},{},[4552,4554,4559,4561,4567,4569,4574,4576,4583],{"type":404,"value":4553},"在规则匹配部分使用黑名单机制而不是白名单匹配。就 ",{"type":398,"tag":435,"props":4555,"children":4557},{"className":4556},[],[4558],{"type":404,"value":944},{"type":404,"value":4560}," 等灵活语法而言，如果浏览器支持新的 ",{"type":398,"tag":435,"props":4562,"children":4564},{"className":4563},[],[4565],{"type":404,"value":4566},"@xxx",{"type":404,"value":4568}," 语法，黑名单机制编写的代码不需要对 ",{"type":398,"tag":435,"props":4570,"children":4572},{"className":4571},[],[4573],{"type":404,"value":4566},{"type":404,"value":4575}," 做额外处理；而白名单机制需要",{"type":398,"tag":417,"props":4577,"children":4580},{"href":4578,"rel":4579},"https://github.com/micro-zoe/micro-app/commit/b83c4600102e0db6f591bacbdc592bea8f1d5bb8",[421],[4581],{"type":404,"value":4582},"手动处理",{"type":404,"value":924},{"type":398,"tag":3856,"props":4585,"children":4586},{},[4587,4589,4600],{"type":404,"value":4588},"在复杂的解析器部分使用外部依赖，如使用类似 ",{"type":398,"tag":417,"props":4590,"children":4593},{"href":4591,"rel":4592},"https://www.npmjs.com/package/lightningcss-wasm/v/1.16.0",[421],[4594],{"type":398,"tag":435,"props":4595,"children":4597},{"className":4596},[],[4598],{"type":404,"value":4599},"lightingcss-wasm",{"type":404,"value":4601}," 等方案。",{"type":398,"tag":406,"props":4603,"children":4604},{},[4605],{"type":404,"value":4606},"关于样式隔离，作者两年前专门写了文章介绍，不过时效性稍有不足，没有涉及解析器的具体流程，写得更多是解析器在整个微前端框架中的作用，也可作为补充阅读。",{"type":398,"tag":4546,"props":4608,"children":4609},{},[4610],{"type":398,"tag":3856,"props":4611,"children":4612},{},[4613],{"type":398,"tag":417,"props":4614,"children":4617},{"href":4615,"rel":4616},"https://github.com/micro-zoe/micro-app/issues/20",[421],[4618],{"type":404,"value":4619},"从零开始写一个微前端框架-样式隔离篇",{"type":398,"tag":406,"props":4621,"children":4622},{},[4623],{"type":404,"value":4624},"最后，微前端框架中的 CSS 的有很多中实施办法，采用一些办法可以抛弃运行时解析。em... 也许以后有机会聊一聊（咕一咕）。",{"type":398,"tag":399,"props":4626,"children":4628},{"id":4627},"增订-2024-年-1-月-28-日",[4629],{"type":404,"value":4630},"增订 | 2024 年 1 月 28 日",{"type":398,"tag":406,"props":4632,"children":4633},{},[4634,4636],{"type":404,"value":4635},"相关实现和测试用例见",{"type":398,"tag":417,"props":4637,"children":4640},{"href":4638,"rel":4639},"https://github.com/micro-zoe/micro-app/issues/868?_issue=nesting",[421],[4641],{"type":404,"value":4642},"这个 Issue",{"type":398,"tag":4644,"props":4645,"children":4648},"section",{"className":4646,"dataFootnotes":392},[4647],"footnotes",[4649,4656],{"type":398,"tag":399,"props":4650,"children":4653},{"className":4651,"id":918},[4652],"sr-only",[4654],{"type":404,"value":4655},"Footnotes",{"type":398,"tag":3852,"props":4657,"children":4658},{},[4659],{"type":398,"tag":3856,"props":4660,"children":4662},{"id":4661},"user-content-fn-css-syntax",[4663,4665,4671,4673],{"type":404,"value":4664},"比较完整的 CSS 语法参见：",{"type":398,"tag":417,"props":4666,"children":4669},{"href":4667,"rel":4668},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/Syntax",[421],[4670],{"type":404,"value":4667},{"type":404,"value":4672}," ",{"type":398,"tag":417,"props":4674,"children":4679},{"href":4675,"ariaLabel":4676,"className":4677,"dataFootnoteBackref":392},"#user-content-fnref-css-syntax","Back to reference 1",[4678],"data-footnote-backref",[4680],{"type":404,"value":4681},"↩",{"type":398,"tag":4683,"props":4684,"children":4685},"style",{},[4686],{"type":404,"value":4687},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":392,"searchDepth":452,"depth":452,"links":4689},[4690,4691,4692,4693,4694,4695,4696],{"id":401,"depth":452,"text":401},{"id":846,"depth":452,"text":849},{"id":949,"depth":452,"text":949},{"id":4029,"depth":452,"text":4029},{"id":4345,"depth":452,"text":4345},{"id":4627,"depth":452,"text":4630},{"id":918,"depth":452,"text":4655},"markdown","content:2.articles:1101.mini-css-parser.md","content","2.articles/1101.mini-css-parser.md","md",[4703,4705],{"_path":43,"title":42,"description":4704},"忍者秘籍中提到的模板解析器，很短但支持变量和 if 等语句，还是 15 年前的代码！",{"_path":49,"title":48,"description":4706},"在两个纯知识面的问题上，受到了 GPT 的碾压",1711873528822]