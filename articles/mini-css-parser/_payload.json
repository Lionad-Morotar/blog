[{"data":1,"prerenderedAt":4729},["ShallowReactive",2],{"navigation":3,"/articles/mini-css-parser":410,"/articles/mini-css-parser-surround":4724},[4,32,83,102,129,135,141,147,393,399,405],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77,80],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":42,"_path":43},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":45,"_path":46},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":48,"_path":49},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":51,"_path":52},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":54,"_path":55},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":57,"_path":58},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":60,"_path":61},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":63,"_path":64},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":66,"_path":67},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":69,"_path":70},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":72,"_path":73},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":75,"_path":76},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":78,"_path":79},"🚝 四十二篇系列","/articles/fourty-two",{"title":81,"_path":82},"📝 技术博客归档","/articles/fold",{"title":84,"_path":85,"children":86},"造物 / Make","/tools",[87,90,93,96,99],{"title":88,"_path":89},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":91,"_path":92},"🌐 AnySort","/tools/anysort",{"title":94,"_path":95},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":97,"_path":98},"👓 Crapto","/tools/crypto-inline",{"title":100,"_path":101},"🖨️ any-to-base64","/tools/any-to-base64",{"title":103,"_path":104,"children":105},"吉他剧场 / Music","/music",[106,108,111,114,117,120,123,126],{"title":107,"_path":104},"🎸 FingerStyle！",{"title":109,"_path":110},"🌬️ 等待的风","/music/wind",{"title":112,"_path":113},"💕 约定的海洋","/music/ocean",{"title":115,"_path":116},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":118,"_path":119},"🌏 残酷天使的行动纲领","/music/eva",{"title":121,"_path":122},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":124,"_path":125},"🍷 Wu Wei","/music/wu-wei",{"title":127,"_path":128},"🌅 无题","/music/untitled",{"title":130,"_path":131,"children":132},"画点什么 / Paint","/paint",[133],{"title":134,"_path":131},"🚧 正在施工",{"title":136,"_path":137,"children":138},"读书笔记 / Notes","/books",[139],{"title":140,"_path":137},"📕 读书笔记",{"title":142,"_path":143,"children":144},"知识地图 / Maps","/maps",[145],{"title":146,"_path":143},"🏁 知识地图",{"title":148,"_path":149,"children":150},"零散的笔记 / Gists","/gists",[151,153,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375,378,381,384,387,390],{"title":152,"_path":149},"🧊 Gists",{"title":154,"_path":155},"网站的可访问性","/gists/accessibility",{"title":157,"_path":158},"Bit","/gists/bit",{"title":160,"_path":161},"图片模糊","/gists/blur",{"title":163,"_path":164},"渲染相关笔记","/gists/c4d",{"title":166,"_path":167},"CDN 问题记录","/gists/cdn",{"title":169,"_path":170},"消毒剂","/gists/cleaner",{"title":172,"_path":173},"Windows Command","/gists/cmd",{"title":175,"_path":176},"Command","/gists/command",{"title":178,"_path":179},"复杂科学","/gists/complexity-science",{"title":181,"_path":182},"GitHub Copilot","/gists/copilot",{"title":184,"_path":185},"宇宙","/gists/cosmos",{"title":187,"_path":188},"C++","/gists/cpp",{"title":190,"_path":191},"Data Structure","/gists/data-structure",{"title":193,"_path":194},"DEPRESSION","/gists/depression",{"title":196,"_path":197},"设计模式","/gists/design-patterns",{"title":199,"_path":200},"Developer Experience","/gists/developer-experience",{"title":202,"_path":203},"Device Metrics","/gists/device-metrix",{"title":205,"_path":206},"数字化转型","/gists/digital-transformation",{"title":208,"_path":209},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":211,"_path":212},"正则表达式","/gists/eegex",{"title":214,"_path":215},"Emoji","/gists/emoji",{"title":217,"_path":218},"工程","/gists/engineering",{"title":220,"_path":221},"熵","/gists/entropy",{"title":223,"_path":224},"Environment","/gists/environment",{"title":226,"_path":227},"Erlang","/gists/erlang",{"title":229,"_path":230},"逃离塔克夫","/gists/escape-from-tarkov",{"title":232,"_path":233},"ESNext (ES6-ES11)","/gists/esnext",{"title":235,"_path":236},"Eval！","/gists/eval",{"title":238,"_path":239},"Flutter","/gists/flutter",{"title":241,"_path":242},"字体","/gists/font",{"title":244,"_path":245},"JS 函数式编程","/gists/functional",{"title":247,"_path":248},"游戏化","/gists/gamification",{"title":250,"_path":251},"Google C++ Standard","/gists/google-cpp-standard",{"title":253,"_path":254},"双向链接完全体","/gists/graph",{"title":256,"_path":257},"Hardwares","/gists/hardwares",{"title":259,"_path":260},"哈希冲突","/gists/hash-collision",{"title":262,"_path":263},"信息设计","/gists/information-design",{"title":265,"_path":266},"InstantPage","/gists/instant.page",{"title":268,"_path":269},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":271,"_path":272},"KVStore","/gists/key-value-db",{"title":274,"_path":275},"Kubernetes","/gists/kubernetes",{"title":277,"_path":278},"Makefile","/gists/makefile",{"title":280,"_path":281},"Markdown Inline Style","/gists/markdown-nice",{"title":283,"_path":284},"小程序","/gists/miniapp",{"title":286,"_path":287},"减小页面快照体积","/gists/minify-html",{"title":289,"_path":290},"mklink","/gists/mklink",{"title":292,"_path":293},"Mock","/gists/mock",{"title":295,"_path":296},"多人协作系统","/gists/multiplayer",{"title":298,"_path":299},"多端应用","/gists/multy-end-app",{"title":301,"_path":302},"神经科学","/gists/neuroscience",{"title":304,"_path":305},"OO","/gists/oo",{"title":307,"_path":308},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":310,"_path":311},"PInvoke","/gists/pinvoke",{"title":313,"_path":314},"像素","/gists/pixel",{"title":316,"_path":317},"PowerShell","/gists/powershell",{"title":319,"_path":320},"量子","/gists/quantum",{"title":322,"_path":323},"保持好奇心","/gists/questions",{"title":325,"_path":326},"React Native","/gists/react-native",{"title":328,"_path":329},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":331,"_path":332},"SEO","/gists/seo",{"title":334,"_path":335},"Shader","/gists/shader",{"title":337,"_path":338},"Shape Up","/gists/shape-up",{"title":340,"_path":341},"睡觉","/gists/sleep",{"title":343,"_path":344},"记录奇怪的问题","/gists/solved",{"title":346,"_path":347},"States","/gists/states",{"title":349,"_path":350},"Storage","/gists/storage",{"title":352,"_path":353},"音视频流处理","/gists/stream-cli",{"title":355,"_path":356},"Symbol","/gists/symbol",{"title":358,"_path":359},"系统论","/gists/systems-theory",{"title":361,"_path":362},"Taro","/gists/taro",{"title":364,"_path":365},"任务切片","/gists/task-slice",{"title":367,"_path":368},"技术偏好","/gists/tech-dudge",{"title":370,"_path":371},"Untitled","/gists/untitled",{"title":373,"_path":374},"可变字体","/gists/variable-font",{"title":376,"_path":377},"视觉错觉","/gists/visual-illusion",{"title":379,"_path":380},"SS(SSR)","/gists/vpn",{"title":382,"_path":383},"VS Code 插件开发","/gists/vscode-plugin",{"title":385,"_path":386},"Web Components","/gists/web-components",{"title":388,"_path":389},"Windows","/gists/windows",{"title":391,"_path":392},"查缺补漏","/gists/wrong",{"title":394,"_path":395,"children":396},"代码笔记 / Gists","/source-code",[397],{"title":398,"_path":395},"🚄 代码笔记",{"title":400,"_path":401,"children":402},"我 / Abount","/hire",[403],{"title":404,"_path":401},"📬 技术简历",{"title":406,"_path":407,"children":408},"todo","/todo",[409],{"title":406,"_path":407},{"_path":46,"_dir":411,"_draft":412,"_partial":412,"_locale":413,"title":45,"description":414,"body":415,"_type":4718,"_id":4719,"_source":4720,"_file":4721,"_stem":4722,"_extension":4723},"articles",false,"","我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。我碰到的问题是，如果 CSS 源码中带嵌套语法那么解析就会失败。今天借这个问题给大家简单介绍一下 CSS Parser 的基本流程。",{"type":416,"children":417,"toc":4709},"root",[418,426,432,448,865,871,946,955,968,973,979,1002,1007,1331,1336,1728,1756,1827,1832,1852,1877,1953,1958,1963,2249,2261,2353,2392,2409,2694,2738,3212,3253,3804,3815,3855,3860,3872,3973,4008,4028,4048,4053,4058,4352,4357,4364,4369,4374,4382,4390,4398,4406,4441,4540,4548,4561,4566,4623,4628,4641,4646,4652,4664,4703],{"type":419,"tag":420,"props":421,"children":423},"element","h2",{"id":422},"前言",[424],{"type":425,"value":422},"text",{"type":419,"tag":427,"props":428,"children":429},"p",{},[430],{"type":425,"value":431},"Vue 源码中包含 HTML Parser，随着大家在框架方向的深入学习（卷），不免要开始接触一些编译解析相关的东西。社区很多看 Vue 源码时总结的 HTML Parser 的文章，但是很少有介绍 CSS Parser 的文章。今天借着在开发时碰到的一个问题，给大家简单介绍一下 CSS Parser 的基本流程。",{"type":419,"tag":427,"props":433,"children":434},{},[435,437,446],{"type":425,"value":436},"我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。代码示例见下。我碰到的问题是，如果 CSS 源码中带",{"type":419,"tag":438,"props":439,"children":443},"a",{"href":440,"rel":441},"https://caniuse.com/?search=css%20nesting",[442],"nofollow",[444],{"type":425,"value":445},"嵌套语法",{"type":425,"value":447},"，那么解析就会失败。",{"type":419,"tag":449,"props":450,"children":454},"pre",{"className":451,"code":452,"language":453,"meta":413,"style":413},"language-css shiki shiki-themes material-theme-lighter github-light github-dark monokai","/* css 源代码 */\n.a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  }\n}\n\n/* 期待转化得到的代码 */\nmicro-app[name=\"test-app\"] .a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  }\n}\n\n/* 实际得到的代码 */\nmicro-app[name=\"test-app\"] .a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  } /* -> 到这里就停了 */\n","css",[455],{"type":419,"tag":456,"props":457,"children":458},"code",{"__ignoreMap":413},[459,471,492,518,538,560,569,578,588,597,658,678,694,714,722,730,738,747,795,815,831,851],{"type":419,"tag":460,"props":461,"children":464},"span",{"class":462,"line":463},"line",1,[465],{"type":419,"tag":460,"props":466,"children":468},{"style":467},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[469],{"type":425,"value":470},"/* css 源代码 */\n",{"type":419,"tag":460,"props":472,"children":474},{"class":462,"line":473},2,[475,481,486],{"type":419,"tag":460,"props":476,"children":478},{"style":477},"--shiki-light:#39ADB5;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[479],{"type":425,"value":480},".",{"type":419,"tag":460,"props":482,"children":484},{"style":483},"--shiki-light:#E2931D;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[485],{"type":425,"value":438},{"type":419,"tag":460,"props":487,"children":489},{"style":488},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[490],{"type":425,"value":491}," {\n",{"type":419,"tag":460,"props":493,"children":495},{"class":462,"line":494},3,[496,502,507,513],{"type":419,"tag":460,"props":497,"children":499},{"style":498},"--shiki-light:#8796B0;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[500],{"type":425,"value":501},"  z-index",{"type":419,"tag":460,"props":503,"children":504},{"style":488},[505],{"type":425,"value":506},":",{"type":419,"tag":460,"props":508,"children":510},{"style":509},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[511],{"type":425,"value":512}," 1",{"type":419,"tag":460,"props":514,"children":515},{"style":488},[516],{"type":425,"value":517},";\n",{"type":419,"tag":460,"props":519,"children":521},{"class":462,"line":520},4,[522,528,534],{"type":419,"tag":460,"props":523,"children":525},{"style":524},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[526],{"type":425,"value":527},"  .",{"type":419,"tag":460,"props":529,"children":531},{"style":530},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[532],{"type":425,"value":533},"b",{"type":419,"tag":460,"props":535,"children":536},{"style":524},[537],{"type":425,"value":491},{"type":419,"tag":460,"props":539,"children":541},{"class":462,"line":540},5,[542,547,551,556],{"type":419,"tag":460,"props":543,"children":544},{"style":498},[545],{"type":425,"value":546},"    z-index",{"type":419,"tag":460,"props":548,"children":549},{"style":488},[550],{"type":425,"value":506},{"type":419,"tag":460,"props":552,"children":553},{"style":509},[554],{"type":425,"value":555}," 2",{"type":419,"tag":460,"props":557,"children":558},{"style":488},[559],{"type":425,"value":517},{"type":419,"tag":460,"props":561,"children":563},{"class":462,"line":562},6,[564],{"type":419,"tag":460,"props":565,"children":566},{"style":488},[567],{"type":425,"value":568},"  }\n",{"type":419,"tag":460,"props":570,"children":572},{"class":462,"line":571},7,[573],{"type":419,"tag":460,"props":574,"children":575},{"style":524},[576],{"type":425,"value":577},"}\n",{"type":419,"tag":460,"props":579,"children":581},{"class":462,"line":580},8,[582],{"type":419,"tag":460,"props":583,"children":585},{"emptyLinePlaceholder":584},true,[586],{"type":425,"value":587},"\n",{"type":419,"tag":460,"props":589,"children":591},{"class":462,"line":590},9,[592],{"type":419,"tag":460,"props":593,"children":594},{"style":467},[595],{"type":425,"value":596},"/* 期待转化得到的代码 */\n",{"type":419,"tag":460,"props":598,"children":600},{"class":462,"line":599},10,[601,607,612,618,624,630,636,640,645,650,654],{"type":419,"tag":460,"props":602,"children":604},{"style":603},"--shiki-light:#E2931D;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[605],{"type":425,"value":606},"micro-app",{"type":419,"tag":460,"props":608,"children":609},{"style":488},[610],{"type":425,"value":611},"[",{"type":419,"tag":460,"props":613,"children":615},{"style":614},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[616],{"type":425,"value":617},"name",{"type":419,"tag":460,"props":619,"children":621},{"style":620},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[622],{"type":425,"value":623},"=",{"type":419,"tag":460,"props":625,"children":627},{"style":626},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[628],{"type":425,"value":629},"\"",{"type":419,"tag":460,"props":631,"children":633},{"style":632},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[634],{"type":425,"value":635},"test-app",{"type":419,"tag":460,"props":637,"children":638},{"style":626},[639],{"type":425,"value":629},{"type":419,"tag":460,"props":641,"children":642},{"style":488},[643],{"type":425,"value":644},"]",{"type":419,"tag":460,"props":646,"children":647},{"style":477},[648],{"type":425,"value":649}," .",{"type":419,"tag":460,"props":651,"children":652},{"style":483},[653],{"type":425,"value":438},{"type":419,"tag":460,"props":655,"children":656},{"style":488},[657],{"type":425,"value":491},{"type":419,"tag":460,"props":659,"children":661},{"class":462,"line":660},11,[662,666,670,674],{"type":419,"tag":460,"props":663,"children":664},{"style":498},[665],{"type":425,"value":501},{"type":419,"tag":460,"props":667,"children":668},{"style":488},[669],{"type":425,"value":506},{"type":419,"tag":460,"props":671,"children":672},{"style":509},[673],{"type":425,"value":512},{"type":419,"tag":460,"props":675,"children":676},{"style":488},[677],{"type":425,"value":517},{"type":419,"tag":460,"props":679,"children":681},{"class":462,"line":680},12,[682,686,690],{"type":419,"tag":460,"props":683,"children":684},{"style":524},[685],{"type":425,"value":527},{"type":419,"tag":460,"props":687,"children":688},{"style":530},[689],{"type":425,"value":533},{"type":419,"tag":460,"props":691,"children":692},{"style":524},[693],{"type":425,"value":491},{"type":419,"tag":460,"props":695,"children":697},{"class":462,"line":696},13,[698,702,706,710],{"type":419,"tag":460,"props":699,"children":700},{"style":498},[701],{"type":425,"value":546},{"type":419,"tag":460,"props":703,"children":704},{"style":488},[705],{"type":425,"value":506},{"type":419,"tag":460,"props":707,"children":708},{"style":509},[709],{"type":425,"value":555},{"type":419,"tag":460,"props":711,"children":712},{"style":488},[713],{"type":425,"value":517},{"type":419,"tag":460,"props":715,"children":717},{"class":462,"line":716},14,[718],{"type":419,"tag":460,"props":719,"children":720},{"style":488},[721],{"type":425,"value":568},{"type":419,"tag":460,"props":723,"children":725},{"class":462,"line":724},15,[726],{"type":419,"tag":460,"props":727,"children":728},{"style":524},[729],{"type":425,"value":577},{"type":419,"tag":460,"props":731,"children":733},{"class":462,"line":732},16,[734],{"type":419,"tag":460,"props":735,"children":736},{"emptyLinePlaceholder":584},[737],{"type":425,"value":587},{"type":419,"tag":460,"props":739,"children":741},{"class":462,"line":740},17,[742],{"type":419,"tag":460,"props":743,"children":744},{"style":467},[745],{"type":425,"value":746},"/* 实际得到的代码 */\n",{"type":419,"tag":460,"props":748,"children":750},{"class":462,"line":749},18,[751,755,759,763,767,771,775,779,783,787,791],{"type":419,"tag":460,"props":752,"children":753},{"style":603},[754],{"type":425,"value":606},{"type":419,"tag":460,"props":756,"children":757},{"style":488},[758],{"type":425,"value":611},{"type":419,"tag":460,"props":760,"children":761},{"style":614},[762],{"type":425,"value":617},{"type":419,"tag":460,"props":764,"children":765},{"style":620},[766],{"type":425,"value":623},{"type":419,"tag":460,"props":768,"children":769},{"style":626},[770],{"type":425,"value":629},{"type":419,"tag":460,"props":772,"children":773},{"style":632},[774],{"type":425,"value":635},{"type":419,"tag":460,"props":776,"children":777},{"style":626},[778],{"type":425,"value":629},{"type":419,"tag":460,"props":780,"children":781},{"style":488},[782],{"type":425,"value":644},{"type":419,"tag":460,"props":784,"children":785},{"style":477},[786],{"type":425,"value":649},{"type":419,"tag":460,"props":788,"children":789},{"style":483},[790],{"type":425,"value":438},{"type":419,"tag":460,"props":792,"children":793},{"style":488},[794],{"type":425,"value":491},{"type":419,"tag":460,"props":796,"children":798},{"class":462,"line":797},19,[799,803,807,811],{"type":419,"tag":460,"props":800,"children":801},{"style":498},[802],{"type":425,"value":501},{"type":419,"tag":460,"props":804,"children":805},{"style":488},[806],{"type":425,"value":506},{"type":419,"tag":460,"props":808,"children":809},{"style":509},[810],{"type":425,"value":512},{"type":419,"tag":460,"props":812,"children":813},{"style":488},[814],{"type":425,"value":517},{"type":419,"tag":460,"props":816,"children":818},{"class":462,"line":817},20,[819,823,827],{"type":419,"tag":460,"props":820,"children":821},{"style":524},[822],{"type":425,"value":527},{"type":419,"tag":460,"props":824,"children":825},{"style":530},[826],{"type":425,"value":533},{"type":419,"tag":460,"props":828,"children":829},{"style":524},[830],{"type":425,"value":491},{"type":419,"tag":460,"props":832,"children":834},{"class":462,"line":833},21,[835,839,843,847],{"type":419,"tag":460,"props":836,"children":837},{"style":498},[838],{"type":425,"value":546},{"type":419,"tag":460,"props":840,"children":841},{"style":488},[842],{"type":425,"value":506},{"type":419,"tag":460,"props":844,"children":845},{"style":509},[846],{"type":425,"value":555},{"type":419,"tag":460,"props":848,"children":849},{"style":488},[850],{"type":425,"value":517},{"type":419,"tag":460,"props":852,"children":854},{"class":462,"line":853},22,[855,860],{"type":419,"tag":460,"props":856,"children":857},{"style":488},[858],{"type":425,"value":859},"  }",{"type":419,"tag":460,"props":861,"children":862},{"style":467},[863],{"type":425,"value":864}," /* -> 到这里就停了 */\n",{"type":419,"tag":420,"props":866,"children":868},{"id":867},"css-的组成部分",[869],{"type":425,"value":870},"CSS 的组成部分",{"type":419,"tag":427,"props":872,"children":873},{},[874,876,883,885,891,893,899,901,907,909,915,917,923,925,931,944],{"type":425,"value":875},"要理解 CSS 是怎么解析的，就要先清楚 CSS 是由哪几部分组成的。由我们平常见得最多的普通 CSS 代码开始说起，见下图，基本的 CSS 代码的组成部分包含规则集（rules）、选择器（selector）、选择器（declares）、属性（property）、值（value）这五个部分。",{"type":419,"tag":877,"props":878,"children":880},"abbr",{"title":879},"rule",[881],{"type":425,"value":882},"规则",{"type":425,"value":884},"是由",{"type":419,"tag":877,"props":886,"children":888},{"title":887},"property",[889],{"type":425,"value":890},"属性",{"type":425,"value":892},"和",{"type":419,"tag":877,"props":894,"children":896},{"title":895},"value",[897],{"type":425,"value":898},"值",{"type":425,"value":900},"组成的",{"type":419,"tag":877,"props":902,"children":904},{"title":903},"declaration",[905],{"type":425,"value":906},"声明",{"type":425,"value":908},"、声明与括号形成的",{"type":419,"tag":877,"props":910,"children":912},{"title":911},"declaration block",[913],{"type":425,"value":914},"声明块",{"type":425,"value":916},"再加上",{"type":419,"tag":877,"props":918,"children":920},{"title":919},"selector",[921],{"type":425,"value":922},"选择器",{"type":425,"value":924},"组成，而一条或多条规则组合成了",{"type":419,"tag":877,"props":926,"children":928},{"title":927},"rule sets",[929],{"type":425,"value":930},"规则集",{"type":419,"tag":932,"props":933,"children":934},"sup",{},[935],{"type":419,"tag":438,"props":936,"children":941},{"href":937,"ariaDescribedBy":938,"dataFootnoteRef":413,"id":940},"#user-content-fn-css-syntax",[939],"footnote-label","user-content-fnref-css-syntax",[942],{"type":425,"value":943},"1",{"type":425,"value":945},"。",{"type":419,"tag":427,"props":947,"children":948},{},[949],{"type":419,"tag":950,"props":951,"children":954},"img",{"alt":952,"src":953},"规则&规则集","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/200621/20200625022018.png",[],{"type":419,"tag":427,"props":956,"children":957},{},[958,960,966],{"type":425,"value":959},"图中没有包含 ",{"type":419,"tag":456,"props":961,"children":963},{"className":962},[],[964],{"type":425,"value":965},"at-rule",{"type":425,"value":967}," 的部分，哦，还少了注释部分~ 由于注释是 CSS 中语法最简单的部分，我们从解析注释开始代码部分的解读吧。",{"type":419,"tag":420,"props":969,"children":971},{"id":970},"流程速览",[972],{"type":425,"value":970},{"type":419,"tag":974,"props":975,"children":977},"h4",{"id":976},"解析注释",[978],{"type":425,"value":976},{"type":419,"tag":427,"props":980,"children":981},{},[982,984,991,993,1000],{"type":425,"value":983},"可能许多人不了解 CSS 的注释风格，这里先说明一下，原生 CSS 仅支持",{"type":419,"tag":438,"props":985,"children":988},{"href":986,"rel":987},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/Comments",[442],[989],{"type":425,"value":990},"斜杠星号风格注释",{"type":425,"value":992},"，不支持",{"type":419,"tag":438,"props":994,"children":997},{"href":995,"rel":996},"https://segmentfault.com/a/1190000043885414",[442],[998],{"type":425,"value":999},"双斜杠注释",{"type":425,"value":1001},"，所以解析器并未处理双斜杠的情况。",{"type":419,"tag":427,"props":1003,"children":1004},{},[1005],{"type":425,"value":1006},"解析注释的函数是一个 while 循环，从代码开头开始匹配，每次循环解析一条注释，直到代码开头没有注释为止。",{"type":419,"tag":449,"props":1008,"children":1012},{"className":1009,"code":1010,"language":1011,"meta":413,"style":413},"language-ts shiki shiki-themes material-theme-lighter github-light github-dark monokai","class CSSParser {\n  private matchComments() {\n    while (this.matchComment());\n  }\n  private matchComment() {\n    // 快速跳过非注释部分代码\n    if (this.cssText.charAt(0) !== \"/\" || this.cssText.charAt(1) !== \"*\") {\n      return false;\n    }\n    // ...\n    return true;\n  }\n}\n","ts",[1013],{"type":419,"tag":456,"props":1014,"children":1015},{"__ignoreMap":413},[1016,1035,1059,1099,1106,1126,1134,1266,1284,1292,1300,1317,1324],{"type":419,"tag":460,"props":1017,"children":1018},{"class":462,"line":463},[1019,1025,1031],{"type":419,"tag":460,"props":1020,"children":1022},{"style":1021},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[1023],{"type":425,"value":1024},"class",{"type":419,"tag":460,"props":1026,"children":1028},{"style":1027},"--shiki-light:#E2931D;--shiki-light-text-decoration:inherit;--shiki-default:#6F42C1;--shiki-default-text-decoration:inherit;--shiki-dark:#B392F0;--shiki-dark-text-decoration:inherit;--shiki-sepia:#A6E22E;--shiki-sepia-text-decoration:underline",[1029],{"type":425,"value":1030}," CSSParser",{"type":419,"tag":460,"props":1032,"children":1033},{"style":488},[1034],{"type":425,"value":491},{"type":419,"tag":460,"props":1036,"children":1037},{"class":462,"line":473},[1038,1044,1050,1055],{"type":419,"tag":460,"props":1039,"children":1041},{"style":1040},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1042],{"type":425,"value":1043},"  private",{"type":419,"tag":460,"props":1045,"children":1047},{"style":1046},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1048],{"type":425,"value":1049}," matchComments",{"type":419,"tag":460,"props":1051,"children":1052},{"style":488},[1053],{"type":425,"value":1054},"()",{"type":419,"tag":460,"props":1056,"children":1057},{"style":488},[1058],{"type":425,"value":491},{"type":419,"tag":460,"props":1060,"children":1061},{"class":462,"line":494},[1062,1068,1074,1080,1084,1090,1095],{"type":419,"tag":460,"props":1063,"children":1065},{"style":1064},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[1066],{"type":425,"value":1067},"    while",{"type":419,"tag":460,"props":1069,"children":1071},{"style":1070},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[1072],{"type":425,"value":1073}," (",{"type":419,"tag":460,"props":1075,"children":1077},{"style":1076},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[1078],{"type":425,"value":1079},"this",{"type":419,"tag":460,"props":1081,"children":1082},{"style":488},[1083],{"type":425,"value":480},{"type":419,"tag":460,"props":1085,"children":1087},{"style":1086},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1088],{"type":425,"value":1089},"matchComment",{"type":419,"tag":460,"props":1091,"children":1092},{"style":1070},[1093],{"type":425,"value":1094},"())",{"type":419,"tag":460,"props":1096,"children":1097},{"style":488},[1098],{"type":425,"value":517},{"type":419,"tag":460,"props":1100,"children":1101},{"class":462,"line":520},[1102],{"type":419,"tag":460,"props":1103,"children":1104},{"style":488},[1105],{"type":425,"value":568},{"type":419,"tag":460,"props":1107,"children":1108},{"class":462,"line":540},[1109,1113,1118,1122],{"type":419,"tag":460,"props":1110,"children":1111},{"style":1040},[1112],{"type":425,"value":1043},{"type":419,"tag":460,"props":1114,"children":1115},{"style":1046},[1116],{"type":425,"value":1117}," matchComment",{"type":419,"tag":460,"props":1119,"children":1120},{"style":488},[1121],{"type":425,"value":1054},{"type":419,"tag":460,"props":1123,"children":1124},{"style":488},[1125],{"type":425,"value":491},{"type":419,"tag":460,"props":1127,"children":1128},{"class":462,"line":562},[1129],{"type":419,"tag":460,"props":1130,"children":1131},{"style":467},[1132],{"type":425,"value":1133},"    // 快速跳过非注释部分代码\n",{"type":419,"tag":460,"props":1135,"children":1136},{"class":462,"line":571},[1137,1142,1146,1150,1154,1159,1163,1168,1173,1178,1183,1188,1193,1198,1202,1207,1212,1216,1220,1224,1228,1232,1236,1240,1244,1248,1253,1257,1261],{"type":419,"tag":460,"props":1138,"children":1139},{"style":1064},[1140],{"type":425,"value":1141},"    if",{"type":419,"tag":460,"props":1143,"children":1144},{"style":1070},[1145],{"type":425,"value":1073},{"type":419,"tag":460,"props":1147,"children":1148},{"style":1076},[1149],{"type":425,"value":1079},{"type":419,"tag":460,"props":1151,"children":1152},{"style":488},[1153],{"type":425,"value":480},{"type":419,"tag":460,"props":1155,"children":1156},{"style":524},[1157],{"type":425,"value":1158},"cssText",{"type":419,"tag":460,"props":1160,"children":1161},{"style":488},[1162],{"type":425,"value":480},{"type":419,"tag":460,"props":1164,"children":1165},{"style":1086},[1166],{"type":425,"value":1167},"charAt",{"type":419,"tag":460,"props":1169,"children":1170},{"style":1070},[1171],{"type":425,"value":1172},"(",{"type":419,"tag":460,"props":1174,"children":1175},{"style":509},[1176],{"type":425,"value":1177},"0",{"type":419,"tag":460,"props":1179,"children":1180},{"style":1070},[1181],{"type":425,"value":1182},") ",{"type":419,"tag":460,"props":1184,"children":1185},{"style":620},[1186],{"type":425,"value":1187},"!==",{"type":419,"tag":460,"props":1189,"children":1190},{"style":626},[1191],{"type":425,"value":1192}," \"",{"type":419,"tag":460,"props":1194,"children":1195},{"style":632},[1196],{"type":425,"value":1197},"/",{"type":419,"tag":460,"props":1199,"children":1200},{"style":626},[1201],{"type":425,"value":629},{"type":419,"tag":460,"props":1203,"children":1204},{"style":620},[1205],{"type":425,"value":1206}," ||",{"type":419,"tag":460,"props":1208,"children":1209},{"style":1076},[1210],{"type":425,"value":1211}," this",{"type":419,"tag":460,"props":1213,"children":1214},{"style":488},[1215],{"type":425,"value":480},{"type":419,"tag":460,"props":1217,"children":1218},{"style":524},[1219],{"type":425,"value":1158},{"type":419,"tag":460,"props":1221,"children":1222},{"style":488},[1223],{"type":425,"value":480},{"type":419,"tag":460,"props":1225,"children":1226},{"style":1086},[1227],{"type":425,"value":1167},{"type":419,"tag":460,"props":1229,"children":1230},{"style":1070},[1231],{"type":425,"value":1172},{"type":419,"tag":460,"props":1233,"children":1234},{"style":509},[1235],{"type":425,"value":943},{"type":419,"tag":460,"props":1237,"children":1238},{"style":1070},[1239],{"type":425,"value":1182},{"type":419,"tag":460,"props":1241,"children":1242},{"style":620},[1243],{"type":425,"value":1187},{"type":419,"tag":460,"props":1245,"children":1246},{"style":626},[1247],{"type":425,"value":1192},{"type":419,"tag":460,"props":1249,"children":1250},{"style":632},[1251],{"type":425,"value":1252},"*",{"type":419,"tag":460,"props":1254,"children":1255},{"style":626},[1256],{"type":425,"value":629},{"type":419,"tag":460,"props":1258,"children":1259},{"style":1070},[1260],{"type":425,"value":1182},{"type":419,"tag":460,"props":1262,"children":1263},{"style":488},[1264],{"type":425,"value":1265},"{\n",{"type":419,"tag":460,"props":1267,"children":1268},{"class":462,"line":580},[1269,1274,1280],{"type":419,"tag":460,"props":1270,"children":1271},{"style":1064},[1272],{"type":425,"value":1273},"      return",{"type":419,"tag":460,"props":1275,"children":1277},{"style":1276},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1278],{"type":425,"value":1279}," false",{"type":419,"tag":460,"props":1281,"children":1282},{"style":488},[1283],{"type":425,"value":517},{"type":419,"tag":460,"props":1285,"children":1286},{"class":462,"line":590},[1287],{"type":419,"tag":460,"props":1288,"children":1289},{"style":488},[1290],{"type":425,"value":1291},"    }\n",{"type":419,"tag":460,"props":1293,"children":1294},{"class":462,"line":599},[1295],{"type":419,"tag":460,"props":1296,"children":1297},{"style":467},[1298],{"type":425,"value":1299},"    // ...\n",{"type":419,"tag":460,"props":1301,"children":1302},{"class":462,"line":660},[1303,1308,1313],{"type":419,"tag":460,"props":1304,"children":1305},{"style":1064},[1306],{"type":425,"value":1307},"    return",{"type":419,"tag":460,"props":1309,"children":1310},{"style":1276},[1311],{"type":425,"value":1312}," true",{"type":419,"tag":460,"props":1314,"children":1315},{"style":488},[1316],{"type":425,"value":517},{"type":419,"tag":460,"props":1318,"children":1319},{"class":462,"line":680},[1320],{"type":419,"tag":460,"props":1321,"children":1322},{"style":488},[1323],{"type":425,"value":568},{"type":419,"tag":460,"props":1325,"children":1326},{"class":462,"line":696},[1327],{"type":419,"tag":460,"props":1328,"children":1329},{"style":488},[1330],{"type":425,"value":577},{"type":419,"tag":427,"props":1332,"children":1333},{},[1334],{"type":425,"value":1335},"在选择解析注释内容的方法上，micro-app 没有使用正则，而是用了下标递增的办法。暂不清楚原因，感兴趣的小伙伴可以试试几种相关办法的性能对比。",{"type":419,"tag":449,"props":1337,"children":1339},{"className":1009,"code":1338,"language":1011,"meta":413,"style":413},"let i = 2;\nwhile (\n  this.cssText.charAt(i) !== \"\" &&\n  (this.cssText.charAt(i) !== \"*\" || this.cssText.charAt(i + 1) !== \"/\")\n) {\n  ++i;\n}\ni += 2;\n\nlet commentText = this.cssText.slice(2, i - 2);\n/* ... */\nthis.cssText = this.cssText.slice(i);\n",[1340],{"type":419,"tag":456,"props":1341,"children":1342},{"__ignoreMap":413},[1343,1368,1381,1424,1535,1546,1563,1570,1591,1598,1671,1679],{"type":419,"tag":460,"props":1344,"children":1345},{"class":462,"line":463},[1346,1351,1356,1360,1364],{"type":419,"tag":460,"props":1347,"children":1348},{"style":1021},[1349],{"type":425,"value":1350},"let",{"type":419,"tag":460,"props":1352,"children":1353},{"style":524},[1354],{"type":425,"value":1355}," i ",{"type":419,"tag":460,"props":1357,"children":1358},{"style":620},[1359],{"type":425,"value":623},{"type":419,"tag":460,"props":1361,"children":1362},{"style":509},[1363],{"type":425,"value":555},{"type":419,"tag":460,"props":1365,"children":1366},{"style":488},[1367],{"type":425,"value":517},{"type":419,"tag":460,"props":1369,"children":1370},{"class":462,"line":473},[1371,1376],{"type":419,"tag":460,"props":1372,"children":1373},{"style":1064},[1374],{"type":425,"value":1375},"while",{"type":419,"tag":460,"props":1377,"children":1378},{"style":524},[1379],{"type":425,"value":1380}," (\n",{"type":419,"tag":460,"props":1382,"children":1383},{"class":462,"line":494},[1384,1389,1393,1397,1401,1405,1410,1414,1419],{"type":419,"tag":460,"props":1385,"children":1386},{"style":1076},[1387],{"type":425,"value":1388},"  this",{"type":419,"tag":460,"props":1390,"children":1391},{"style":488},[1392],{"type":425,"value":480},{"type":419,"tag":460,"props":1394,"children":1395},{"style":524},[1396],{"type":425,"value":1158},{"type":419,"tag":460,"props":1398,"children":1399},{"style":488},[1400],{"type":425,"value":480},{"type":419,"tag":460,"props":1402,"children":1403},{"style":1086},[1404],{"type":425,"value":1167},{"type":419,"tag":460,"props":1406,"children":1407},{"style":524},[1408],{"type":425,"value":1409},"(i) ",{"type":419,"tag":460,"props":1411,"children":1412},{"style":620},[1413],{"type":425,"value":1187},{"type":419,"tag":460,"props":1415,"children":1416},{"style":626},[1417],{"type":425,"value":1418}," \"\"",{"type":419,"tag":460,"props":1420,"children":1421},{"style":620},[1422],{"type":425,"value":1423}," &&\n",{"type":419,"tag":460,"props":1425,"children":1426},{"class":462,"line":520},[1427,1432,1436,1440,1444,1448,1452,1456,1460,1464,1468,1472,1476,1480,1484,1488,1492,1496,1501,1506,1510,1514,1518,1522,1526,1530],{"type":419,"tag":460,"props":1428,"children":1429},{"style":524},[1430],{"type":425,"value":1431},"  (",{"type":419,"tag":460,"props":1433,"children":1434},{"style":1076},[1435],{"type":425,"value":1079},{"type":419,"tag":460,"props":1437,"children":1438},{"style":488},[1439],{"type":425,"value":480},{"type":419,"tag":460,"props":1441,"children":1442},{"style":524},[1443],{"type":425,"value":1158},{"type":419,"tag":460,"props":1445,"children":1446},{"style":488},[1447],{"type":425,"value":480},{"type":419,"tag":460,"props":1449,"children":1450},{"style":1086},[1451],{"type":425,"value":1167},{"type":419,"tag":460,"props":1453,"children":1454},{"style":524},[1455],{"type":425,"value":1409},{"type":419,"tag":460,"props":1457,"children":1458},{"style":620},[1459],{"type":425,"value":1187},{"type":419,"tag":460,"props":1461,"children":1462},{"style":626},[1463],{"type":425,"value":1192},{"type":419,"tag":460,"props":1465,"children":1466},{"style":632},[1467],{"type":425,"value":1252},{"type":419,"tag":460,"props":1469,"children":1470},{"style":626},[1471],{"type":425,"value":629},{"type":419,"tag":460,"props":1473,"children":1474},{"style":620},[1475],{"type":425,"value":1206},{"type":419,"tag":460,"props":1477,"children":1478},{"style":1076},[1479],{"type":425,"value":1211},{"type":419,"tag":460,"props":1481,"children":1482},{"style":488},[1483],{"type":425,"value":480},{"type":419,"tag":460,"props":1485,"children":1486},{"style":524},[1487],{"type":425,"value":1158},{"type":419,"tag":460,"props":1489,"children":1490},{"style":488},[1491],{"type":425,"value":480},{"type":419,"tag":460,"props":1493,"children":1494},{"style":1086},[1495],{"type":425,"value":1167},{"type":419,"tag":460,"props":1497,"children":1498},{"style":524},[1499],{"type":425,"value":1500},"(i ",{"type":419,"tag":460,"props":1502,"children":1503},{"style":620},[1504],{"type":425,"value":1505},"+",{"type":419,"tag":460,"props":1507,"children":1508},{"style":509},[1509],{"type":425,"value":512},{"type":419,"tag":460,"props":1511,"children":1512},{"style":524},[1513],{"type":425,"value":1182},{"type":419,"tag":460,"props":1515,"children":1516},{"style":620},[1517],{"type":425,"value":1187},{"type":419,"tag":460,"props":1519,"children":1520},{"style":626},[1521],{"type":425,"value":1192},{"type":419,"tag":460,"props":1523,"children":1524},{"style":632},[1525],{"type":425,"value":1197},{"type":419,"tag":460,"props":1527,"children":1528},{"style":626},[1529],{"type":425,"value":629},{"type":419,"tag":460,"props":1531,"children":1532},{"style":524},[1533],{"type":425,"value":1534},")\n",{"type":419,"tag":460,"props":1536,"children":1537},{"class":462,"line":540},[1538,1542],{"type":419,"tag":460,"props":1539,"children":1540},{"style":524},[1541],{"type":425,"value":1182},{"type":419,"tag":460,"props":1543,"children":1544},{"style":488},[1545],{"type":425,"value":1265},{"type":419,"tag":460,"props":1547,"children":1548},{"class":462,"line":562},[1549,1554,1559],{"type":419,"tag":460,"props":1550,"children":1551},{"style":620},[1552],{"type":425,"value":1553},"  ++",{"type":419,"tag":460,"props":1555,"children":1556},{"style":524},[1557],{"type":425,"value":1558},"i",{"type":419,"tag":460,"props":1560,"children":1561},{"style":488},[1562],{"type":425,"value":517},{"type":419,"tag":460,"props":1564,"children":1565},{"class":462,"line":571},[1566],{"type":419,"tag":460,"props":1567,"children":1568},{"style":488},[1569],{"type":425,"value":577},{"type":419,"tag":460,"props":1571,"children":1572},{"class":462,"line":580},[1573,1578,1583,1587],{"type":419,"tag":460,"props":1574,"children":1575},{"style":524},[1576],{"type":425,"value":1577},"i ",{"type":419,"tag":460,"props":1579,"children":1580},{"style":620},[1581],{"type":425,"value":1582},"+=",{"type":419,"tag":460,"props":1584,"children":1585},{"style":509},[1586],{"type":425,"value":555},{"type":419,"tag":460,"props":1588,"children":1589},{"style":488},[1590],{"type":425,"value":517},{"type":419,"tag":460,"props":1592,"children":1593},{"class":462,"line":590},[1594],{"type":419,"tag":460,"props":1595,"children":1596},{"emptyLinePlaceholder":584},[1597],{"type":425,"value":587},{"type":419,"tag":460,"props":1599,"children":1600},{"class":462,"line":599},[1601,1605,1610,1614,1618,1622,1626,1630,1635,1639,1644,1649,1653,1658,1662,1667],{"type":419,"tag":460,"props":1602,"children":1603},{"style":1021},[1604],{"type":425,"value":1350},{"type":419,"tag":460,"props":1606,"children":1607},{"style":524},[1608],{"type":425,"value":1609}," commentText ",{"type":419,"tag":460,"props":1611,"children":1612},{"style":620},[1613],{"type":425,"value":623},{"type":419,"tag":460,"props":1615,"children":1616},{"style":1076},[1617],{"type":425,"value":1211},{"type":419,"tag":460,"props":1619,"children":1620},{"style":488},[1621],{"type":425,"value":480},{"type":419,"tag":460,"props":1623,"children":1624},{"style":524},[1625],{"type":425,"value":1158},{"type":419,"tag":460,"props":1627,"children":1628},{"style":488},[1629],{"type":425,"value":480},{"type":419,"tag":460,"props":1631,"children":1632},{"style":1086},[1633],{"type":425,"value":1634},"slice",{"type":419,"tag":460,"props":1636,"children":1637},{"style":524},[1638],{"type":425,"value":1172},{"type":419,"tag":460,"props":1640,"children":1641},{"style":509},[1642],{"type":425,"value":1643},"2",{"type":419,"tag":460,"props":1645,"children":1646},{"style":488},[1647],{"type":425,"value":1648},",",{"type":419,"tag":460,"props":1650,"children":1651},{"style":524},[1652],{"type":425,"value":1355},{"type":419,"tag":460,"props":1654,"children":1655},{"style":620},[1656],{"type":425,"value":1657},"-",{"type":419,"tag":460,"props":1659,"children":1660},{"style":509},[1661],{"type":425,"value":555},{"type":419,"tag":460,"props":1663,"children":1664},{"style":524},[1665],{"type":425,"value":1666},")",{"type":419,"tag":460,"props":1668,"children":1669},{"style":488},[1670],{"type":425,"value":517},{"type":419,"tag":460,"props":1672,"children":1673},{"class":462,"line":660},[1674],{"type":419,"tag":460,"props":1675,"children":1676},{"style":467},[1677],{"type":425,"value":1678},"/* ... */\n",{"type":419,"tag":460,"props":1680,"children":1681},{"class":462,"line":680},[1682,1686,1690,1695,1699,1703,1707,1711,1715,1719,1724],{"type":419,"tag":460,"props":1683,"children":1684},{"style":1076},[1685],{"type":425,"value":1079},{"type":419,"tag":460,"props":1687,"children":1688},{"style":488},[1689],{"type":425,"value":480},{"type":419,"tag":460,"props":1691,"children":1692},{"style":524},[1693],{"type":425,"value":1694},"cssText ",{"type":419,"tag":460,"props":1696,"children":1697},{"style":620},[1698],{"type":425,"value":623},{"type":419,"tag":460,"props":1700,"children":1701},{"style":1076},[1702],{"type":425,"value":1211},{"type":419,"tag":460,"props":1704,"children":1705},{"style":488},[1706],{"type":425,"value":480},{"type":419,"tag":460,"props":1708,"children":1709},{"style":524},[1710],{"type":425,"value":1158},{"type":419,"tag":460,"props":1712,"children":1713},{"style":488},[1714],{"type":425,"value":480},{"type":419,"tag":460,"props":1716,"children":1717},{"style":1086},[1718],{"type":425,"value":1634},{"type":419,"tag":460,"props":1720,"children":1721},{"style":524},[1722],{"type":425,"value":1723},"(i)",{"type":419,"tag":460,"props":1725,"children":1726},{"style":488},[1727],{"type":425,"value":517},{"type":419,"tag":427,"props":1729,"children":1730},{},[1731,1733,1739,1741,1746,1748,1754],{"type":425,"value":1732},"注释的正文结果保存在了变量 ",{"type":419,"tag":456,"props":1734,"children":1736},{"className":1735},[],[1737],{"type":425,"value":1738},"commentText",{"type":425,"value":1740}," 中，这样可以判断 ",{"type":419,"tag":456,"props":1742,"children":1744},{"className":1743},[],[1745],{"type":425,"value":1738},{"type":425,"value":1747}," 的内容来实现通过注释禁用某个选择器、禁用某行的样式隔离之类的功能。比如想让 ",{"type":419,"tag":456,"props":1749,"children":1751},{"className":1750},[],[1752],{"type":425,"value":1753},".test2",{"type":425,"value":1755}," 选择器不被 scoped 规则覆盖，我们可以在业务代码中这样写。",{"type":419,"tag":449,"props":1757,"children":1759},{"className":451,"code":1758,"language":453,"meta":413,"style":413},"/*! scopecss-disable-next-line */\n.test2 {\n  background: url(/test.png);\n}\n",[1760],{"type":419,"tag":456,"props":1761,"children":1762},{"__ignoreMap":413},[1763,1771,1787,1820],{"type":419,"tag":460,"props":1764,"children":1765},{"class":462,"line":463},[1766],{"type":419,"tag":460,"props":1767,"children":1768},{"style":467},[1769],{"type":425,"value":1770},"/*! scopecss-disable-next-line */\n",{"type":419,"tag":460,"props":1772,"children":1773},{"class":462,"line":473},[1774,1778,1783],{"type":419,"tag":460,"props":1775,"children":1776},{"style":477},[1777],{"type":425,"value":480},{"type":419,"tag":460,"props":1779,"children":1780},{"style":483},[1781],{"type":425,"value":1782},"test2",{"type":419,"tag":460,"props":1784,"children":1785},{"style":488},[1786],{"type":425,"value":491},{"type":419,"tag":460,"props":1788,"children":1789},{"class":462,"line":494},[1790,1795,1799,1805,1809,1815],{"type":419,"tag":460,"props":1791,"children":1792},{"style":498},[1793],{"type":425,"value":1794},"  background",{"type":419,"tag":460,"props":1796,"children":1797},{"style":488},[1798],{"type":425,"value":506},{"type":419,"tag":460,"props":1800,"children":1802},{"style":1801},"--shiki-light:#6182B8;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF",[1803],{"type":425,"value":1804}," url",{"type":419,"tag":460,"props":1806,"children":1807},{"style":488},[1808],{"type":425,"value":1172},{"type":419,"tag":460,"props":1810,"children":1812},{"style":1811},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[1813],{"type":425,"value":1814},"/test.png",{"type":419,"tag":460,"props":1816,"children":1817},{"style":488},[1818],{"type":425,"value":1819},");\n",{"type":419,"tag":460,"props":1821,"children":1822},{"class":462,"line":520},[1823],{"type":419,"tag":460,"props":1824,"children":1825},{"style":488},[1826],{"type":425,"value":577},{"type":419,"tag":974,"props":1828,"children":1830},{"id":1829},"输入输出",[1831],{"type":425,"value":1829},{"type":419,"tag":427,"props":1833,"children":1834},{},[1835,1837,1842,1844,1850],{"type":425,"value":1836},"“解析注释”中“解析”实际指对输入的 CSS 源文件待处理部分以及处理好的输出部分做出改变。这里引申出解析器里两个关键状态，",{"type":419,"tag":456,"props":1838,"children":1840},{"className":1839},[],[1841],{"type":425,"value":1158},{"type":425,"value":1843}," 和 ",{"type":419,"tag":456,"props":1845,"children":1847},{"className":1846},[],[1848],{"type":425,"value":1849},"result",{"type":425,"value":1851},"，分别代表待解析的内容和最终输出结果。",{"type":419,"tag":427,"props":1853,"children":1854},{},[1855,1860,1862,1867,1869,1875],{"type":419,"tag":456,"props":1856,"children":1858},{"className":1857},[],[1859],{"type":425,"value":1158},{"type":425,"value":1861}," 随着循环应当逐渐减小直到为空，此时代表解析完成。",{"type":419,"tag":456,"props":1863,"children":1865},{"className":1864},[],[1866],{"type":425,"value":1849},{"type":425,"value":1868}," 能被内部方法 ",{"type":419,"tag":456,"props":1870,"children":1872},{"className":1871},[],[1873],{"type":425,"value":1874},"recordResult",{"type":425,"value":1876}," 改变，比如如果要把注释的正文内容记录到输出结果，可以这样使用：",{"type":419,"tag":449,"props":1878,"children":1880},{"className":1009,"code":1879,"language":1011,"meta":413,"style":413},"this.recordResult(`/*${commentText}*/`);\n// 相当于：this.result += `/*${commentText}*/`\n",[1881],{"type":419,"tag":456,"props":1882,"children":1883},{"__ignoreMap":413},[1884,1945],{"type":419,"tag":460,"props":1885,"children":1886},{"class":462,"line":463},[1887,1891,1895,1899,1903,1908,1913,1919,1923,1928,1933,1937,1941],{"type":419,"tag":460,"props":1888,"children":1889},{"style":1076},[1890],{"type":425,"value":1079},{"type":419,"tag":460,"props":1892,"children":1893},{"style":488},[1894],{"type":425,"value":480},{"type":419,"tag":460,"props":1896,"children":1897},{"style":1086},[1898],{"type":425,"value":1874},{"type":419,"tag":460,"props":1900,"children":1901},{"style":524},[1902],{"type":425,"value":1172},{"type":419,"tag":460,"props":1904,"children":1905},{"style":626},[1906],{"type":425,"value":1907},"`",{"type":419,"tag":460,"props":1909,"children":1910},{"style":632},[1911],{"type":425,"value":1912},"/*",{"type":419,"tag":460,"props":1914,"children":1916},{"style":1915},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#F92672",[1917],{"type":425,"value":1918},"${",{"type":419,"tag":460,"props":1920,"children":1921},{"style":524},[1922],{"type":425,"value":1738},{"type":419,"tag":460,"props":1924,"children":1925},{"style":1915},[1926],{"type":425,"value":1927},"}",{"type":419,"tag":460,"props":1929,"children":1930},{"style":632},[1931],{"type":425,"value":1932},"*/",{"type":419,"tag":460,"props":1934,"children":1935},{"style":626},[1936],{"type":425,"value":1907},{"type":419,"tag":460,"props":1938,"children":1939},{"style":524},[1940],{"type":425,"value":1666},{"type":419,"tag":460,"props":1942,"children":1943},{"style":488},[1944],{"type":425,"value":517},{"type":419,"tag":460,"props":1946,"children":1947},{"class":462,"line":473},[1948],{"type":419,"tag":460,"props":1949,"children":1950},{"style":467},[1951],{"type":425,"value":1952},"// 相当于：this.result += `/*${commentText}*/`\n",{"type":419,"tag":974,"props":1954,"children":1956},{"id":1955},"解析规则集",[1957],{"type":425,"value":1955},{"type":419,"tag":427,"props":1959,"children":1960},{},[1961],{"type":425,"value":1962},"规则集的解析是整个解析的核心过程。原理与解析注释类似，也是一个 while 循环。每一轮循环都会尝试匹配一条规则，并且将多余的注释和空白字符匹配出来。",{"type":419,"tag":449,"props":1964,"children":1966},{"className":1009,"code":1965,"language":1011,"meta":413,"style":413},"private matchRules (): void {\n  this.matchLeadingSpaces()\n  this.matchComments()\n  while (\n    this.cssText.length &&\n    this.cssText.charAt(0) !== '}' &&\n    (this.matchAtRule() || this.matchStyleRule())\n  ) {\n    this.matchComments()\n    this.matchLeadingSpaces()\n  }\n}\n",[1967],{"type":419,"tag":456,"props":1968,"children":1969},{"__ignoreMap":413},[1970,1997,2018,2038,2050,2079,2136,2185,2197,2216,2235,2242],{"type":419,"tag":460,"props":1971,"children":1972},{"class":462,"line":463},[1973,1978,1983,1988,1993],{"type":419,"tag":460,"props":1974,"children":1975},{"style":524},[1976],{"type":425,"value":1977},"private ",{"type":419,"tag":460,"props":1979,"children":1980},{"style":1086},[1981],{"type":425,"value":1982},"matchRules",{"type":419,"tag":460,"props":1984,"children":1985},{"style":524},[1986],{"type":425,"value":1987}," (): ",{"type":419,"tag":460,"props":1989,"children":1990},{"style":620},[1991],{"type":425,"value":1992},"void",{"type":419,"tag":460,"props":1994,"children":1995},{"style":488},[1996],{"type":425,"value":491},{"type":419,"tag":460,"props":1998,"children":1999},{"class":462,"line":473},[2000,2004,2008,2013],{"type":419,"tag":460,"props":2001,"children":2002},{"style":1076},[2003],{"type":425,"value":1388},{"type":419,"tag":460,"props":2005,"children":2006},{"style":488},[2007],{"type":425,"value":480},{"type":419,"tag":460,"props":2009,"children":2010},{"style":1086},[2011],{"type":425,"value":2012},"matchLeadingSpaces",{"type":419,"tag":460,"props":2014,"children":2015},{"style":1070},[2016],{"type":425,"value":2017},"()\n",{"type":419,"tag":460,"props":2019,"children":2020},{"class":462,"line":494},[2021,2025,2029,2034],{"type":419,"tag":460,"props":2022,"children":2023},{"style":1076},[2024],{"type":425,"value":1388},{"type":419,"tag":460,"props":2026,"children":2027},{"style":488},[2028],{"type":425,"value":480},{"type":419,"tag":460,"props":2030,"children":2031},{"style":1086},[2032],{"type":425,"value":2033},"matchComments",{"type":419,"tag":460,"props":2035,"children":2036},{"style":1070},[2037],{"type":425,"value":2017},{"type":419,"tag":460,"props":2039,"children":2040},{"class":462,"line":520},[2041,2046],{"type":419,"tag":460,"props":2042,"children":2043},{"style":1064},[2044],{"type":425,"value":2045},"  while",{"type":419,"tag":460,"props":2047,"children":2048},{"style":1070},[2049],{"type":425,"value":1380},{"type":419,"tag":460,"props":2051,"children":2052},{"class":462,"line":540},[2053,2058,2062,2066,2070,2075],{"type":419,"tag":460,"props":2054,"children":2055},{"style":1076},[2056],{"type":425,"value":2057},"    this",{"type":419,"tag":460,"props":2059,"children":2060},{"style":488},[2061],{"type":425,"value":480},{"type":419,"tag":460,"props":2063,"children":2064},{"style":524},[2065],{"type":425,"value":1158},{"type":419,"tag":460,"props":2067,"children":2068},{"style":488},[2069],{"type":425,"value":480},{"type":419,"tag":460,"props":2071,"children":2072},{"style":530},[2073],{"type":425,"value":2074},"length",{"type":419,"tag":460,"props":2076,"children":2077},{"style":620},[2078],{"type":425,"value":1423},{"type":419,"tag":460,"props":2080,"children":2081},{"class":462,"line":562},[2082,2086,2090,2094,2098,2102,2106,2110,2114,2118,2123,2127,2132],{"type":419,"tag":460,"props":2083,"children":2084},{"style":1076},[2085],{"type":425,"value":2057},{"type":419,"tag":460,"props":2087,"children":2088},{"style":488},[2089],{"type":425,"value":480},{"type":419,"tag":460,"props":2091,"children":2092},{"style":524},[2093],{"type":425,"value":1158},{"type":419,"tag":460,"props":2095,"children":2096},{"style":488},[2097],{"type":425,"value":480},{"type":419,"tag":460,"props":2099,"children":2100},{"style":1086},[2101],{"type":425,"value":1167},{"type":419,"tag":460,"props":2103,"children":2104},{"style":1070},[2105],{"type":425,"value":1172},{"type":419,"tag":460,"props":2107,"children":2108},{"style":509},[2109],{"type":425,"value":1177},{"type":419,"tag":460,"props":2111,"children":2112},{"style":1070},[2113],{"type":425,"value":1182},{"type":419,"tag":460,"props":2115,"children":2116},{"style":620},[2117],{"type":425,"value":1187},{"type":419,"tag":460,"props":2119,"children":2120},{"style":626},[2121],{"type":425,"value":2122}," '",{"type":419,"tag":460,"props":2124,"children":2125},{"style":632},[2126],{"type":425,"value":1927},{"type":419,"tag":460,"props":2128,"children":2129},{"style":626},[2130],{"type":425,"value":2131},"'",{"type":419,"tag":460,"props":2133,"children":2134},{"style":620},[2135],{"type":425,"value":1423},{"type":419,"tag":460,"props":2137,"children":2138},{"class":462,"line":571},[2139,2144,2148,2152,2157,2162,2167,2171,2175,2180],{"type":419,"tag":460,"props":2140,"children":2141},{"style":1070},[2142],{"type":425,"value":2143},"    (",{"type":419,"tag":460,"props":2145,"children":2146},{"style":1076},[2147],{"type":425,"value":1079},{"type":419,"tag":460,"props":2149,"children":2150},{"style":488},[2151],{"type":425,"value":480},{"type":419,"tag":460,"props":2153,"children":2154},{"style":1086},[2155],{"type":425,"value":2156},"matchAtRule",{"type":419,"tag":460,"props":2158,"children":2159},{"style":1070},[2160],{"type":425,"value":2161},"() ",{"type":419,"tag":460,"props":2163,"children":2164},{"style":620},[2165],{"type":425,"value":2166},"||",{"type":419,"tag":460,"props":2168,"children":2169},{"style":1076},[2170],{"type":425,"value":1211},{"type":419,"tag":460,"props":2172,"children":2173},{"style":488},[2174],{"type":425,"value":480},{"type":419,"tag":460,"props":2176,"children":2177},{"style":1086},[2178],{"type":425,"value":2179},"matchStyleRule",{"type":419,"tag":460,"props":2181,"children":2182},{"style":1070},[2183],{"type":425,"value":2184},"())\n",{"type":419,"tag":460,"props":2186,"children":2187},{"class":462,"line":580},[2188,2193],{"type":419,"tag":460,"props":2189,"children":2190},{"style":1070},[2191],{"type":425,"value":2192},"  ) ",{"type":419,"tag":460,"props":2194,"children":2195},{"style":488},[2196],{"type":425,"value":1265},{"type":419,"tag":460,"props":2198,"children":2199},{"class":462,"line":590},[2200,2204,2208,2212],{"type":419,"tag":460,"props":2201,"children":2202},{"style":1076},[2203],{"type":425,"value":2057},{"type":419,"tag":460,"props":2205,"children":2206},{"style":488},[2207],{"type":425,"value":480},{"type":419,"tag":460,"props":2209,"children":2210},{"style":1086},[2211],{"type":425,"value":2033},{"type":419,"tag":460,"props":2213,"children":2214},{"style":1070},[2215],{"type":425,"value":2017},{"type":419,"tag":460,"props":2217,"children":2218},{"class":462,"line":599},[2219,2223,2227,2231],{"type":419,"tag":460,"props":2220,"children":2221},{"style":1076},[2222],{"type":425,"value":2057},{"type":419,"tag":460,"props":2224,"children":2225},{"style":488},[2226],{"type":425,"value":480},{"type":419,"tag":460,"props":2228,"children":2229},{"style":1086},[2230],{"type":425,"value":2012},{"type":419,"tag":460,"props":2232,"children":2233},{"style":1070},[2234],{"type":425,"value":2017},{"type":419,"tag":460,"props":2236,"children":2237},{"class":462,"line":660},[2238],{"type":419,"tag":460,"props":2239,"children":2240},{"style":488},[2241],{"type":425,"value":568},{"type":419,"tag":460,"props":2243,"children":2244},{"class":462,"line":680},[2245],{"type":419,"tag":460,"props":2246,"children":2247},{"style":488},[2248],{"type":425,"value":577},{"type":419,"tag":427,"props":2250,"children":2251},{},[2252,2254,2259],{"type":425,"value":2253},"匹配注释我们知道它是使用了下标递增 + Slice 的方法，匹配空白这里则是用的一个非常简单的正则。见下 ",{"type":419,"tag":456,"props":2255,"children":2257},{"className":2256},[],[2258],{"type":425,"value":2012},{"type":425,"value":2260}," 函数。",{"type":419,"tag":449,"props":2262,"children":2264},{"className":1009,"code":2263,"language":1011,"meta":413,"style":413},"private matchLeadingSpaces (): void {\n  this.commonMatch(/^\\s*/, false)\n}\n",[2265],{"type":419,"tag":456,"props":2266,"children":2267},{"__ignoreMap":413},[2268,2291,2346],{"type":419,"tag":460,"props":2269,"children":2270},{"class":462,"line":463},[2271,2275,2279,2283,2287],{"type":419,"tag":460,"props":2272,"children":2273},{"style":524},[2274],{"type":425,"value":1977},{"type":419,"tag":460,"props":2276,"children":2277},{"style":1086},[2278],{"type":425,"value":2012},{"type":419,"tag":460,"props":2280,"children":2281},{"style":524},[2282],{"type":425,"value":1987},{"type":419,"tag":460,"props":2284,"children":2285},{"style":620},[2286],{"type":425,"value":1992},{"type":419,"tag":460,"props":2288,"children":2289},{"style":488},[2290],{"type":425,"value":491},{"type":419,"tag":460,"props":2292,"children":2293},{"class":462,"line":473},[2294,2298,2302,2307,2311,2315,2320,2326,2330,2334,2338,2342],{"type":419,"tag":460,"props":2295,"children":2296},{"style":1076},[2297],{"type":425,"value":1388},{"type":419,"tag":460,"props":2299,"children":2300},{"style":488},[2301],{"type":425,"value":480},{"type":419,"tag":460,"props":2303,"children":2304},{"style":1086},[2305],{"type":425,"value":2306},"commonMatch",{"type":419,"tag":460,"props":2308,"children":2309},{"style":1070},[2310],{"type":425,"value":1172},{"type":419,"tag":460,"props":2312,"children":2313},{"style":626},[2314],{"type":425,"value":1197},{"type":419,"tag":460,"props":2316,"children":2317},{"style":1064},[2318],{"type":425,"value":2319},"^",{"type":419,"tag":460,"props":2321,"children":2323},{"style":2322},"--shiki-light:#91B859;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2324],{"type":425,"value":2325},"\\s",{"type":419,"tag":460,"props":2327,"children":2328},{"style":620},[2329],{"type":425,"value":1252},{"type":419,"tag":460,"props":2331,"children":2332},{"style":626},[2333],{"type":425,"value":1197},{"type":419,"tag":460,"props":2335,"children":2336},{"style":488},[2337],{"type":425,"value":1648},{"type":419,"tag":460,"props":2339,"children":2340},{"style":1276},[2341],{"type":425,"value":1279},{"type":419,"tag":460,"props":2343,"children":2344},{"style":1070},[2345],{"type":425,"value":1534},{"type":419,"tag":460,"props":2347,"children":2348},{"class":462,"line":494},[2349],{"type":419,"tag":460,"props":2350,"children":2351},{"style":488},[2352],{"type":425,"value":577},{"type":419,"tag":427,"props":2354,"children":2355},{},[2356,2358,2363,2365,2370,2371,2376,2378,2383,2385,2390],{"type":425,"value":2357},"可以想象，",{"type":419,"tag":456,"props":2359,"children":2361},{"className":2360},[],[2362],{"type":425,"value":2306},{"type":425,"value":2364}," 应当会对状态 ",{"type":419,"tag":456,"props":2366,"children":2368},{"className":2367},[],[2369],{"type":425,"value":1158},{"type":425,"value":1843},{"type":419,"tag":456,"props":2372,"children":2374},{"className":2373},[],[2375],{"type":425,"value":1849},{"type":425,"value":2377}," 做一些操作。实际上，commonMatch 两个参数分别是用于匹配 ",{"type":419,"tag":456,"props":2379,"children":2381},{"className":2380},[],[2382],{"type":425,"value":1158},{"type":425,"value":2384}," 的正则，及跳过标记。如果在待匹配内容中匹配到了字符串，便把匹配的内容从中移除；跳过标记则意味着当确认跳过时，匹配的内容将不会被记录到输出结果中。以上面的 ",{"type":419,"tag":456,"props":2386,"children":2388},{"className":2387},[],[2389],{"type":425,"value":2012},{"type":425,"value":2391}," 函数举例，如果在待匹配内容中匹配到空白字符，那么会将其丢弃不做处理。",{"type":419,"tag":427,"props":2393,"children":2394},{},[2395,2400,2402,2407],{"type":419,"tag":456,"props":2396,"children":2398},{"className":2397},[],[2399],{"type":425,"value":2306},{"type":425,"value":2401}," 可谓是解析器匹配逻辑的核心，只要理解了它，那么我们回到上面提到的样式规则匹配 ",{"type":419,"tag":456,"props":2403,"children":2405},{"className":2404},[],[2406],{"type":425,"value":2179},{"type":425,"value":2408},"，会发现其过程非常简单。简单来说只有三步，匹配选择器、记录解析后的选择器、解析（并记录）声明。结束条件只有成功解析以及选择器解析报错或声明解析报错。",{"type":419,"tag":449,"props":2410,"children":2412},{"className":1009,"code":2411,"language":1011,"meta":413,"style":413},"private matchStyleRule (): boolean | void {\n  const selectors = this.formatSelector(true)\n  this.scopecssDisableNextLine = false\n  if (!selectors) return parseError('selector missing', this.linkPath)\n  this.recordResult(selectors)\n  this.matchComments()\n  this.styleDeclarations()\n  this.matchLeadingSpaces()\n  return true\n}\n",[2413],{"type":419,"tag":456,"props":2414,"children":2415},{"__ignoreMap":413},[2416,2446,2490,2515,2589,2616,2635,2655,2674,2687],{"type":419,"tag":460,"props":2417,"children":2418},{"class":462,"line":463},[2419,2423,2427,2432,2437,2442],{"type":419,"tag":460,"props":2420,"children":2421},{"style":524},[2422],{"type":425,"value":1977},{"type":419,"tag":460,"props":2424,"children":2425},{"style":1086},[2426],{"type":425,"value":2179},{"type":419,"tag":460,"props":2428,"children":2429},{"style":524},[2430],{"type":425,"value":2431}," (): boolean ",{"type":419,"tag":460,"props":2433,"children":2434},{"style":620},[2435],{"type":425,"value":2436},"|",{"type":419,"tag":460,"props":2438,"children":2439},{"style":620},[2440],{"type":425,"value":2441}," void",{"type":419,"tag":460,"props":2443,"children":2444},{"style":488},[2445],{"type":425,"value":491},{"type":419,"tag":460,"props":2447,"children":2448},{"class":462,"line":473},[2449,2454,2459,2464,2468,2472,2477,2481,2486],{"type":419,"tag":460,"props":2450,"children":2451},{"style":1021},[2452],{"type":425,"value":2453},"  const",{"type":419,"tag":460,"props":2455,"children":2456},{"style":530},[2457],{"type":425,"value":2458}," selectors",{"type":419,"tag":460,"props":2460,"children":2461},{"style":620},[2462],{"type":425,"value":2463}," =",{"type":419,"tag":460,"props":2465,"children":2466},{"style":1076},[2467],{"type":425,"value":1211},{"type":419,"tag":460,"props":2469,"children":2470},{"style":488},[2471],{"type":425,"value":480},{"type":419,"tag":460,"props":2473,"children":2474},{"style":1086},[2475],{"type":425,"value":2476},"formatSelector",{"type":419,"tag":460,"props":2478,"children":2479},{"style":1070},[2480],{"type":425,"value":1172},{"type":419,"tag":460,"props":2482,"children":2483},{"style":1276},[2484],{"type":425,"value":2485},"true",{"type":419,"tag":460,"props":2487,"children":2488},{"style":1070},[2489],{"type":425,"value":1534},{"type":419,"tag":460,"props":2491,"children":2492},{"class":462,"line":494},[2493,2497,2501,2506,2510],{"type":419,"tag":460,"props":2494,"children":2495},{"style":1076},[2496],{"type":425,"value":1388},{"type":419,"tag":460,"props":2498,"children":2499},{"style":488},[2500],{"type":425,"value":480},{"type":419,"tag":460,"props":2502,"children":2503},{"style":524},[2504],{"type":425,"value":2505},"scopecssDisableNextLine",{"type":419,"tag":460,"props":2507,"children":2508},{"style":620},[2509],{"type":425,"value":2463},{"type":419,"tag":460,"props":2511,"children":2512},{"style":1276},[2513],{"type":425,"value":2514}," false\n",{"type":419,"tag":460,"props":2516,"children":2517},{"class":462,"line":520},[2518,2523,2527,2532,2537,2541,2546,2551,2555,2559,2564,2568,2572,2576,2580,2585],{"type":419,"tag":460,"props":2519,"children":2520},{"style":1064},[2521],{"type":425,"value":2522},"  if",{"type":419,"tag":460,"props":2524,"children":2525},{"style":1070},[2526],{"type":425,"value":1073},{"type":419,"tag":460,"props":2528,"children":2529},{"style":620},[2530],{"type":425,"value":2531},"!",{"type":419,"tag":460,"props":2533,"children":2534},{"style":524},[2535],{"type":425,"value":2536},"selectors",{"type":419,"tag":460,"props":2538,"children":2539},{"style":1070},[2540],{"type":425,"value":1182},{"type":419,"tag":460,"props":2542,"children":2543},{"style":1064},[2544],{"type":425,"value":2545},"return",{"type":419,"tag":460,"props":2547,"children":2548},{"style":1086},[2549],{"type":425,"value":2550}," parseError",{"type":419,"tag":460,"props":2552,"children":2553},{"style":1070},[2554],{"type":425,"value":1172},{"type":419,"tag":460,"props":2556,"children":2557},{"style":626},[2558],{"type":425,"value":2131},{"type":419,"tag":460,"props":2560,"children":2561},{"style":632},[2562],{"type":425,"value":2563},"selector missing",{"type":419,"tag":460,"props":2565,"children":2566},{"style":626},[2567],{"type":425,"value":2131},{"type":419,"tag":460,"props":2569,"children":2570},{"style":488},[2571],{"type":425,"value":1648},{"type":419,"tag":460,"props":2573,"children":2574},{"style":1076},[2575],{"type":425,"value":1211},{"type":419,"tag":460,"props":2577,"children":2578},{"style":488},[2579],{"type":425,"value":480},{"type":419,"tag":460,"props":2581,"children":2582},{"style":524},[2583],{"type":425,"value":2584},"linkPath",{"type":419,"tag":460,"props":2586,"children":2587},{"style":1070},[2588],{"type":425,"value":1534},{"type":419,"tag":460,"props":2590,"children":2591},{"class":462,"line":540},[2592,2596,2600,2604,2608,2612],{"type":419,"tag":460,"props":2593,"children":2594},{"style":1076},[2595],{"type":425,"value":1388},{"type":419,"tag":460,"props":2597,"children":2598},{"style":488},[2599],{"type":425,"value":480},{"type":419,"tag":460,"props":2601,"children":2602},{"style":1086},[2603],{"type":425,"value":1874},{"type":419,"tag":460,"props":2605,"children":2606},{"style":1070},[2607],{"type":425,"value":1172},{"type":419,"tag":460,"props":2609,"children":2610},{"style":524},[2611],{"type":425,"value":2536},{"type":419,"tag":460,"props":2613,"children":2614},{"style":1070},[2615],{"type":425,"value":1534},{"type":419,"tag":460,"props":2617,"children":2618},{"class":462,"line":562},[2619,2623,2627,2631],{"type":419,"tag":460,"props":2620,"children":2621},{"style":1076},[2622],{"type":425,"value":1388},{"type":419,"tag":460,"props":2624,"children":2625},{"style":488},[2626],{"type":425,"value":480},{"type":419,"tag":460,"props":2628,"children":2629},{"style":1086},[2630],{"type":425,"value":2033},{"type":419,"tag":460,"props":2632,"children":2633},{"style":1070},[2634],{"type":425,"value":2017},{"type":419,"tag":460,"props":2636,"children":2637},{"class":462,"line":571},[2638,2642,2646,2651],{"type":419,"tag":460,"props":2639,"children":2640},{"style":1076},[2641],{"type":425,"value":1388},{"type":419,"tag":460,"props":2643,"children":2644},{"style":488},[2645],{"type":425,"value":480},{"type":419,"tag":460,"props":2647,"children":2648},{"style":1086},[2649],{"type":425,"value":2650},"styleDeclarations",{"type":419,"tag":460,"props":2652,"children":2653},{"style":1070},[2654],{"type":425,"value":2017},{"type":419,"tag":460,"props":2656,"children":2657},{"class":462,"line":580},[2658,2662,2666,2670],{"type":419,"tag":460,"props":2659,"children":2660},{"style":1076},[2661],{"type":425,"value":1388},{"type":419,"tag":460,"props":2663,"children":2664},{"style":488},[2665],{"type":425,"value":480},{"type":419,"tag":460,"props":2667,"children":2668},{"style":1086},[2669],{"type":425,"value":2012},{"type":419,"tag":460,"props":2671,"children":2672},{"style":1070},[2673],{"type":425,"value":2017},{"type":419,"tag":460,"props":2675,"children":2676},{"class":462,"line":590},[2677,2682],{"type":419,"tag":460,"props":2678,"children":2679},{"style":1064},[2680],{"type":425,"value":2681},"  return",{"type":419,"tag":460,"props":2683,"children":2684},{"style":1276},[2685],{"type":425,"value":2686}," true\n",{"type":419,"tag":460,"props":2688,"children":2689},{"class":462,"line":599},[2690],{"type":419,"tag":460,"props":2691,"children":2692},{"style":488},[2693],{"type":425,"value":577},{"type":419,"tag":427,"props":2695,"children":2696},{},[2697,2699,2705,2707,2713,2715,2721,2723,2728,2730,2736],{"type":425,"value":2698},"首先是匹配选择器的部分。以 ",{"type":419,"tag":456,"props":2700,"children":2702},{"className":2701},[],[2703],{"type":425,"value":2704},".a,.b{color:red}",{"type":425,"value":2706}," 为例，首先匹配出",{"type":419,"tag":456,"props":2708,"children":2710},{"className":2709},[],[2711],{"type":425,"value":2712},"{",{"type":425,"value":2714},"字符前的部分即",{"type":419,"tag":456,"props":2716,"children":2718},{"className":2717},[],[2719],{"type":425,"value":2720},".a,.b",{"type":425,"value":2722},"作为选择器的正文，然后使用",{"type":419,"tag":456,"props":2724,"children":2726},{"className":2725},[],[2727],{"type":425,"value":1648},{"type":425,"value":2729},"分割选择器，并给选择器加上 prefix，最终返回",{"type":419,"tag":456,"props":2731,"children":2733},{"className":2732},[],[2734],{"type":425,"value":2735},"micro-app[name=\"subapp\"] .a, micro-app[name=\"subapp\"] .b",{"type":425,"value":2737},"。刚才提到可以在业务代码中使用注释给特定选择器禁用 prefix 前缀，相关的代码的实现也在这个函数中。",{"type":419,"tag":449,"props":2739,"children":2741},{"className":1009,"code":2740,"language":1011,"meta":413,"style":413},"const selectors = this.formatSelector()\n\nprivate formatSelector (skip: boolean): false | string {\n  // 匹配选择器正文\n  const m = this.commonMatch(/^[^{]+/, skip)\n  return m[0].replace(/(^|,[\\n\\s]*)([^,]+)/g, (_, separator, selector) => {\n    // 如果检测到选择器被禁用则跳过添加前缀步骤\n    if (...) {\n      const prefix = this.prefix // micro-app[name=\"subapp\"]\n      selector = prefix + ' ' + selector\n    }\n    return separator + selector\n  })\n}\n",[2742],{"type":419,"tag":456,"props":2743,"children":2744},{"__ignoreMap":413},[2745,2777,2784,2819,2827,2905,3063,3071,3095,3130,3168,3175,3194,3205],{"type":419,"tag":460,"props":2746,"children":2747},{"class":462,"line":463},[2748,2753,2757,2761,2765,2769,2773],{"type":419,"tag":460,"props":2749,"children":2750},{"style":1021},[2751],{"type":425,"value":2752},"const",{"type":419,"tag":460,"props":2754,"children":2755},{"style":530},[2756],{"type":425,"value":2458},{"type":419,"tag":460,"props":2758,"children":2759},{"style":620},[2760],{"type":425,"value":2463},{"type":419,"tag":460,"props":2762,"children":2763},{"style":1076},[2764],{"type":425,"value":1211},{"type":419,"tag":460,"props":2766,"children":2767},{"style":488},[2768],{"type":425,"value":480},{"type":419,"tag":460,"props":2770,"children":2771},{"style":1086},[2772],{"type":425,"value":2476},{"type":419,"tag":460,"props":2774,"children":2775},{"style":524},[2776],{"type":425,"value":2017},{"type":419,"tag":460,"props":2778,"children":2779},{"class":462,"line":473},[2780],{"type":419,"tag":460,"props":2781,"children":2782},{"emptyLinePlaceholder":584},[2783],{"type":425,"value":587},{"type":419,"tag":460,"props":2785,"children":2786},{"class":462,"line":494},[2787,2791,2795,2800,2805,2810,2815],{"type":419,"tag":460,"props":2788,"children":2789},{"style":524},[2790],{"type":425,"value":1977},{"type":419,"tag":460,"props":2792,"children":2793},{"style":1086},[2794],{"type":425,"value":2476},{"type":419,"tag":460,"props":2796,"children":2797},{"style":524},[2798],{"type":425,"value":2799}," (skip: boolean): ",{"type":419,"tag":460,"props":2801,"children":2802},{"style":1276},[2803],{"type":425,"value":2804},"false",{"type":419,"tag":460,"props":2806,"children":2807},{"style":620},[2808],{"type":425,"value":2809}," |",{"type":419,"tag":460,"props":2811,"children":2812},{"style":524},[2813],{"type":425,"value":2814}," string ",{"type":419,"tag":460,"props":2816,"children":2817},{"style":488},[2818],{"type":425,"value":1265},{"type":419,"tag":460,"props":2820,"children":2821},{"class":462,"line":520},[2822],{"type":419,"tag":460,"props":2823,"children":2824},{"style":467},[2825],{"type":425,"value":2826},"  // 匹配选择器正文\n",{"type":419,"tag":460,"props":2828,"children":2829},{"class":462,"line":540},[2830,2834,2839,2843,2847,2851,2855,2859,2863,2867,2872,2876,2880,2884,2888,2892,2896,2901],{"type":419,"tag":460,"props":2831,"children":2832},{"style":1021},[2833],{"type":425,"value":2453},{"type":419,"tag":460,"props":2835,"children":2836},{"style":530},[2837],{"type":425,"value":2838}," m",{"type":419,"tag":460,"props":2840,"children":2841},{"style":620},[2842],{"type":425,"value":2463},{"type":419,"tag":460,"props":2844,"children":2845},{"style":1076},[2846],{"type":425,"value":1211},{"type":419,"tag":460,"props":2848,"children":2849},{"style":488},[2850],{"type":425,"value":480},{"type":419,"tag":460,"props":2852,"children":2853},{"style":1086},[2854],{"type":425,"value":2306},{"type":419,"tag":460,"props":2856,"children":2857},{"style":1070},[2858],{"type":425,"value":1172},{"type":419,"tag":460,"props":2860,"children":2861},{"style":626},[2862],{"type":425,"value":1197},{"type":419,"tag":460,"props":2864,"children":2865},{"style":1064},[2866],{"type":425,"value":2319},{"type":419,"tag":460,"props":2868,"children":2870},{"style":2869},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2871],{"type":425,"value":611},{"type":419,"tag":460,"props":2873,"children":2874},{"style":620},[2875],{"type":425,"value":2319},{"type":419,"tag":460,"props":2877,"children":2878},{"style":2322},[2879],{"type":425,"value":2712},{"type":419,"tag":460,"props":2881,"children":2882},{"style":2869},[2883],{"type":425,"value":644},{"type":419,"tag":460,"props":2885,"children":2886},{"style":620},[2887],{"type":425,"value":1505},{"type":419,"tag":460,"props":2889,"children":2890},{"style":626},[2891],{"type":425,"value":1197},{"type":419,"tag":460,"props":2893,"children":2894},{"style":488},[2895],{"type":425,"value":1648},{"type":419,"tag":460,"props":2897,"children":2898},{"style":524},[2899],{"type":425,"value":2900}," skip",{"type":419,"tag":460,"props":2902,"children":2903},{"style":1070},[2904],{"type":425,"value":1534},{"type":419,"tag":460,"props":2906,"children":2907},{"class":462,"line":562},[2908,2912,2916,2920,2924,2928,2932,2937,2941,2945,2950,2954,2958,2963,2967,2972,2976,2980,2985,2989,2993,2997,3001,3005,3009,3013,3019,3023,3027,3032,3036,3041,3045,3050,3054,3059],{"type":419,"tag":460,"props":2909,"children":2910},{"style":1064},[2911],{"type":425,"value":2681},{"type":419,"tag":460,"props":2913,"children":2914},{"style":524},[2915],{"type":425,"value":2838},{"type":419,"tag":460,"props":2917,"children":2918},{"style":1070},[2919],{"type":425,"value":611},{"type":419,"tag":460,"props":2921,"children":2922},{"style":509},[2923],{"type":425,"value":1177},{"type":419,"tag":460,"props":2925,"children":2926},{"style":1070},[2927],{"type":425,"value":644},{"type":419,"tag":460,"props":2929,"children":2930},{"style":488},[2931],{"type":425,"value":480},{"type":419,"tag":460,"props":2933,"children":2934},{"style":1086},[2935],{"type":425,"value":2936},"replace",{"type":419,"tag":460,"props":2938,"children":2939},{"style":1070},[2940],{"type":425,"value":1172},{"type":419,"tag":460,"props":2942,"children":2943},{"style":626},[2944],{"type":425,"value":1197},{"type":419,"tag":460,"props":2946,"children":2948},{"style":2947},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[2949],{"type":425,"value":1172},{"type":419,"tag":460,"props":2951,"children":2952},{"style":1064},[2953],{"type":425,"value":2319},{"type":419,"tag":460,"props":2955,"children":2956},{"style":620},[2957],{"type":425,"value":2436},{"type":419,"tag":460,"props":2959,"children":2961},{"style":2960},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[2962],{"type":425,"value":1648},{"type":419,"tag":460,"props":2964,"children":2965},{"style":2869},[2966],{"type":425,"value":611},{"type":419,"tag":460,"props":2968,"children":2969},{"style":2322},[2970],{"type":425,"value":2971},"\\n\\s",{"type":419,"tag":460,"props":2973,"children":2974},{"style":2869},[2975],{"type":425,"value":644},{"type":419,"tag":460,"props":2977,"children":2978},{"style":620},[2979],{"type":425,"value":1252},{"type":419,"tag":460,"props":2981,"children":2982},{"style":2947},[2983],{"type":425,"value":2984},")(",{"type":419,"tag":460,"props":2986,"children":2987},{"style":2869},[2988],{"type":425,"value":611},{"type":419,"tag":460,"props":2990,"children":2991},{"style":620},[2992],{"type":425,"value":2319},{"type":419,"tag":460,"props":2994,"children":2995},{"style":2322},[2996],{"type":425,"value":1648},{"type":419,"tag":460,"props":2998,"children":2999},{"style":2869},[3000],{"type":425,"value":644},{"type":419,"tag":460,"props":3002,"children":3003},{"style":620},[3004],{"type":425,"value":1505},{"type":419,"tag":460,"props":3006,"children":3007},{"style":2947},[3008],{"type":425,"value":1666},{"type":419,"tag":460,"props":3010,"children":3011},{"style":626},[3012],{"type":425,"value":1197},{"type":419,"tag":460,"props":3014,"children":3016},{"style":3015},"--shiki-light:#F76D47;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[3017],{"type":425,"value":3018},"g",{"type":419,"tag":460,"props":3020,"children":3021},{"style":488},[3022],{"type":425,"value":1648},{"type":419,"tag":460,"props":3024,"children":3025},{"style":488},[3026],{"type":425,"value":1073},{"type":419,"tag":460,"props":3028,"children":3029},{"style":1811},[3030],{"type":425,"value":3031},"_",{"type":419,"tag":460,"props":3033,"children":3034},{"style":488},[3035],{"type":425,"value":1648},{"type":419,"tag":460,"props":3037,"children":3038},{"style":1811},[3039],{"type":425,"value":3040}," separator",{"type":419,"tag":460,"props":3042,"children":3043},{"style":488},[3044],{"type":425,"value":1648},{"type":419,"tag":460,"props":3046,"children":3047},{"style":1811},[3048],{"type":425,"value":3049}," selector",{"type":419,"tag":460,"props":3051,"children":3052},{"style":488},[3053],{"type":425,"value":1666},{"type":419,"tag":460,"props":3055,"children":3056},{"style":1021},[3057],{"type":425,"value":3058}," =>",{"type":419,"tag":460,"props":3060,"children":3061},{"style":488},[3062],{"type":425,"value":491},{"type":419,"tag":460,"props":3064,"children":3065},{"class":462,"line":571},[3066],{"type":419,"tag":460,"props":3067,"children":3068},{"style":467},[3069],{"type":425,"value":3070},"    // 如果检测到选择器被禁用则跳过添加前缀步骤\n",{"type":419,"tag":460,"props":3072,"children":3073},{"class":462,"line":580},[3074,3078,3082,3087,3091],{"type":419,"tag":460,"props":3075,"children":3076},{"style":1064},[3077],{"type":425,"value":1141},{"type":419,"tag":460,"props":3079,"children":3080},{"style":1070},[3081],{"type":425,"value":1073},{"type":419,"tag":460,"props":3083,"children":3084},{"style":620},[3085],{"type":425,"value":3086},"...",{"type":419,"tag":460,"props":3088,"children":3089},{"style":1070},[3090],{"type":425,"value":1182},{"type":419,"tag":460,"props":3092,"children":3093},{"style":488},[3094],{"type":425,"value":1265},{"type":419,"tag":460,"props":3096,"children":3097},{"class":462,"line":590},[3098,3103,3108,3112,3116,3120,3125],{"type":419,"tag":460,"props":3099,"children":3100},{"style":1021},[3101],{"type":425,"value":3102},"      const",{"type":419,"tag":460,"props":3104,"children":3105},{"style":530},[3106],{"type":425,"value":3107}," prefix",{"type":419,"tag":460,"props":3109,"children":3110},{"style":620},[3111],{"type":425,"value":2463},{"type":419,"tag":460,"props":3113,"children":3114},{"style":1076},[3115],{"type":425,"value":1211},{"type":419,"tag":460,"props":3117,"children":3118},{"style":488},[3119],{"type":425,"value":480},{"type":419,"tag":460,"props":3121,"children":3122},{"style":524},[3123],{"type":425,"value":3124},"prefix",{"type":419,"tag":460,"props":3126,"children":3127},{"style":467},[3128],{"type":425,"value":3129}," // micro-app[name=\"subapp\"]\n",{"type":419,"tag":460,"props":3131,"children":3132},{"class":462,"line":599},[3133,3138,3142,3146,3151,3155,3159,3163],{"type":419,"tag":460,"props":3134,"children":3135},{"style":524},[3136],{"type":425,"value":3137},"      selector",{"type":419,"tag":460,"props":3139,"children":3140},{"style":620},[3141],{"type":425,"value":2463},{"type":419,"tag":460,"props":3143,"children":3144},{"style":524},[3145],{"type":425,"value":3107},{"type":419,"tag":460,"props":3147,"children":3148},{"style":620},[3149],{"type":425,"value":3150}," +",{"type":419,"tag":460,"props":3152,"children":3153},{"style":626},[3154],{"type":425,"value":2122},{"type":419,"tag":460,"props":3156,"children":3157},{"style":626},[3158],{"type":425,"value":2122},{"type":419,"tag":460,"props":3160,"children":3161},{"style":620},[3162],{"type":425,"value":3150},{"type":419,"tag":460,"props":3164,"children":3165},{"style":524},[3166],{"type":425,"value":3167}," selector\n",{"type":419,"tag":460,"props":3169,"children":3170},{"class":462,"line":660},[3171],{"type":419,"tag":460,"props":3172,"children":3173},{"style":488},[3174],{"type":425,"value":1291},{"type":419,"tag":460,"props":3176,"children":3177},{"class":462,"line":680},[3178,3182,3186,3190],{"type":419,"tag":460,"props":3179,"children":3180},{"style":1064},[3181],{"type":425,"value":1307},{"type":419,"tag":460,"props":3183,"children":3184},{"style":524},[3185],{"type":425,"value":3040},{"type":419,"tag":460,"props":3187,"children":3188},{"style":620},[3189],{"type":425,"value":3150},{"type":419,"tag":460,"props":3191,"children":3192},{"style":524},[3193],{"type":425,"value":3167},{"type":419,"tag":460,"props":3195,"children":3196},{"class":462,"line":696},[3197,3201],{"type":419,"tag":460,"props":3198,"children":3199},{"style":488},[3200],{"type":425,"value":859},{"type":419,"tag":460,"props":3202,"children":3203},{"style":1070},[3204],{"type":425,"value":1534},{"type":419,"tag":460,"props":3206,"children":3207},{"class":462,"line":716},[3208],{"type":419,"tag":460,"props":3209,"children":3210},{"style":488},[3211],{"type":425,"value":577},{"type":419,"tag":427,"props":3213,"children":3214},{},[3215,3217,3222,3224,3229,3231,3236,3238,3243,3245,3252],{"type":425,"value":3216},"匹配完选择器后，声明便是剩下的包含在左右花括号的内容。匹配过程是一个递归，以遇到",{"type":419,"tag":456,"props":3218,"children":3220},{"className":3219},[],[3221],{"type":425,"value":1927},{"type":425,"value":3223},"作为结束条件。如果遇到斜杠",{"type":419,"tag":456,"props":3225,"children":3227},{"className":3226},[],[3228],{"type":425,"value":1197},{"type":425,"value":3230},"，则尝试停止声明匹配并开始注释匹配。总之，",{"type":419,"tag":456,"props":3232,"children":3234},{"className":3233},[],[3235],{"type":425,"value":1927},{"type":425,"value":3237},"之前的内容都作为当前选择器的声明，添加到",{"type":419,"tag":456,"props":3239,"children":3241},{"className":3240},[],[3242],{"type":425,"value":1158},{"type":425,"value":3244},"中。micro-app 框架会对 CSS 资源中的 URL 补全为主应用的完整路径这个功能也是在这个函数中实现，有兴趣的话可以查看其",{"type":419,"tag":438,"props":3246,"children":3249},{"href":3247,"rel":3248},"https://github.com/micro-zoe/micro-app/blob/dev/src/sandbox/scoped_css.ts",[442],[3250],{"type":425,"value":3251},"完整代码",{"type":425,"value":945},{"type":419,"tag":449,"props":3254,"children":3256},{"className":1009,"code":3255,"language":1011,"meta":413,"style":413},"private matchAllDeclarations (): void {\n  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n  this.recordResult(cssValue)\n\n  // 递归退出条件\n  if (!this.cssText) return\n  if (this.cssText.charAt(0) === '}') return\n\n  // extract comments in declarations\n  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n    this.matchComments()\n  } else {\n    // 如果不是注释则忽略中断，继续匹配声明\n    this.commonMatch(/\\/+/)\n  }\n\n  return this.matchAllDeclarations()\n}\n",[3257],{"type":419,"tag":456,"props":3258,"children":3259},{"__ignoreMap":413},[3260,3284,3394,3422,3429,3437,3473,3541,3548,3556,3676,3695,3711,3719,3760,3767,3774,3797],{"type":419,"tag":460,"props":3261,"children":3262},{"class":462,"line":463},[3263,3267,3272,3276,3280],{"type":419,"tag":460,"props":3264,"children":3265},{"style":524},[3266],{"type":425,"value":1977},{"type":419,"tag":460,"props":3268,"children":3269},{"style":1086},[3270],{"type":425,"value":3271},"matchAllDeclarations",{"type":419,"tag":460,"props":3273,"children":3274},{"style":524},[3275],{"type":425,"value":1987},{"type":419,"tag":460,"props":3277,"children":3278},{"style":620},[3279],{"type":425,"value":1992},{"type":419,"tag":460,"props":3281,"children":3282},{"style":488},[3283],{"type":425,"value":491},{"type":419,"tag":460,"props":3285,"children":3286},{"class":462,"line":473},[3287,3292,3297,3301,3305,3309,3313,3317,3321,3325,3329,3333,3337,3342,3346,3350,3354,3358,3362,3366,3370,3375,3380,3385,3389],{"type":419,"tag":460,"props":3288,"children":3289},{"style":1021},[3290],{"type":425,"value":3291},"  let",{"type":419,"tag":460,"props":3293,"children":3294},{"style":524},[3295],{"type":425,"value":3296}," cssValue",{"type":419,"tag":460,"props":3298,"children":3299},{"style":620},[3300],{"type":425,"value":2463},{"type":419,"tag":460,"props":3302,"children":3303},{"style":1070},[3304],{"type":425,"value":1073},{"type":419,"tag":460,"props":3306,"children":3307},{"style":1076},[3308],{"type":425,"value":1079},{"type":419,"tag":460,"props":3310,"children":3311},{"style":488},[3312],{"type":425,"value":480},{"type":419,"tag":460,"props":3314,"children":3315},{"style":1086},[3316],{"type":425,"value":2306},{"type":419,"tag":460,"props":3318,"children":3319},{"style":1070},[3320],{"type":425,"value":1172},{"type":419,"tag":460,"props":3322,"children":3323},{"style":626},[3324],{"type":425,"value":1197},{"type":419,"tag":460,"props":3326,"children":3327},{"style":1064},[3328],{"type":425,"value":2319},{"type":419,"tag":460,"props":3330,"children":3331},{"style":2869},[3332],{"type":425,"value":611},{"type":419,"tag":460,"props":3334,"children":3335},{"style":620},[3336],{"type":425,"value":2319},{"type":419,"tag":460,"props":3338,"children":3339},{"style":2322},[3340],{"type":425,"value":3341},"}/",{"type":419,"tag":460,"props":3343,"children":3344},{"style":2869},[3345],{"type":425,"value":644},{"type":419,"tag":460,"props":3347,"children":3348},{"style":2960},[3349],{"type":425,"value":1666},{"type":419,"tag":460,"props":3351,"children":3352},{"style":620},[3353],{"type":425,"value":1252},{"type":419,"tag":460,"props":3355,"children":3356},{"style":626},[3357],{"type":425,"value":1197},{"type":419,"tag":460,"props":3359,"children":3360},{"style":488},[3361],{"type":425,"value":1648},{"type":419,"tag":460,"props":3363,"children":3364},{"style":1276},[3365],{"type":425,"value":1312},{"type":419,"tag":460,"props":3367,"children":3368},{"style":1070},[3369],{"type":425,"value":1182},{"type":419,"tag":460,"props":3371,"children":3372},{"style":1064},[3373],{"type":425,"value":3374},"as",{"type":419,"tag":460,"props":3376,"children":3377},{"style":1027},[3378],{"type":425,"value":3379}," RegExpExecArray",{"type":419,"tag":460,"props":3381,"children":3382},{"style":1070},[3383],{"type":425,"value":3384},")[",{"type":419,"tag":460,"props":3386,"children":3387},{"style":509},[3388],{"type":425,"value":1177},{"type":419,"tag":460,"props":3390,"children":3391},{"style":1070},[3392],{"type":425,"value":3393},"]\n",{"type":419,"tag":460,"props":3395,"children":3396},{"class":462,"line":494},[3397,3401,3405,3409,3413,3418],{"type":419,"tag":460,"props":3398,"children":3399},{"style":1076},[3400],{"type":425,"value":1388},{"type":419,"tag":460,"props":3402,"children":3403},{"style":488},[3404],{"type":425,"value":480},{"type":419,"tag":460,"props":3406,"children":3407},{"style":1086},[3408],{"type":425,"value":1874},{"type":419,"tag":460,"props":3410,"children":3411},{"style":1070},[3412],{"type":425,"value":1172},{"type":419,"tag":460,"props":3414,"children":3415},{"style":524},[3416],{"type":425,"value":3417},"cssValue",{"type":419,"tag":460,"props":3419,"children":3420},{"style":1070},[3421],{"type":425,"value":1534},{"type":419,"tag":460,"props":3423,"children":3424},{"class":462,"line":520},[3425],{"type":419,"tag":460,"props":3426,"children":3427},{"emptyLinePlaceholder":584},[3428],{"type":425,"value":587},{"type":419,"tag":460,"props":3430,"children":3431},{"class":462,"line":540},[3432],{"type":419,"tag":460,"props":3433,"children":3434},{"style":467},[3435],{"type":425,"value":3436},"  // 递归退出条件\n",{"type":419,"tag":460,"props":3438,"children":3439},{"class":462,"line":562},[3440,3444,3448,3452,3456,3460,3464,3468],{"type":419,"tag":460,"props":3441,"children":3442},{"style":1064},[3443],{"type":425,"value":2522},{"type":419,"tag":460,"props":3445,"children":3446},{"style":1070},[3447],{"type":425,"value":1073},{"type":419,"tag":460,"props":3449,"children":3450},{"style":620},[3451],{"type":425,"value":2531},{"type":419,"tag":460,"props":3453,"children":3454},{"style":1076},[3455],{"type":425,"value":1079},{"type":419,"tag":460,"props":3457,"children":3458},{"style":488},[3459],{"type":425,"value":480},{"type":419,"tag":460,"props":3461,"children":3462},{"style":524},[3463],{"type":425,"value":1158},{"type":419,"tag":460,"props":3465,"children":3466},{"style":1070},[3467],{"type":425,"value":1182},{"type":419,"tag":460,"props":3469,"children":3470},{"style":1064},[3471],{"type":425,"value":3472},"return\n",{"type":419,"tag":460,"props":3474,"children":3475},{"class":462,"line":571},[3476,3480,3484,3488,3492,3496,3500,3504,3508,3512,3516,3521,3525,3529,3533,3537],{"type":419,"tag":460,"props":3477,"children":3478},{"style":1064},[3479],{"type":425,"value":2522},{"type":419,"tag":460,"props":3481,"children":3482},{"style":1070},[3483],{"type":425,"value":1073},{"type":419,"tag":460,"props":3485,"children":3486},{"style":1076},[3487],{"type":425,"value":1079},{"type":419,"tag":460,"props":3489,"children":3490},{"style":488},[3491],{"type":425,"value":480},{"type":419,"tag":460,"props":3493,"children":3494},{"style":524},[3495],{"type":425,"value":1158},{"type":419,"tag":460,"props":3497,"children":3498},{"style":488},[3499],{"type":425,"value":480},{"type":419,"tag":460,"props":3501,"children":3502},{"style":1086},[3503],{"type":425,"value":1167},{"type":419,"tag":460,"props":3505,"children":3506},{"style":1070},[3507],{"type":425,"value":1172},{"type":419,"tag":460,"props":3509,"children":3510},{"style":509},[3511],{"type":425,"value":1177},{"type":419,"tag":460,"props":3513,"children":3514},{"style":1070},[3515],{"type":425,"value":1182},{"type":419,"tag":460,"props":3517,"children":3518},{"style":620},[3519],{"type":425,"value":3520},"===",{"type":419,"tag":460,"props":3522,"children":3523},{"style":626},[3524],{"type":425,"value":2122},{"type":419,"tag":460,"props":3526,"children":3527},{"style":632},[3528],{"type":425,"value":1927},{"type":419,"tag":460,"props":3530,"children":3531},{"style":626},[3532],{"type":425,"value":2131},{"type":419,"tag":460,"props":3534,"children":3535},{"style":1070},[3536],{"type":425,"value":1182},{"type":419,"tag":460,"props":3538,"children":3539},{"style":1064},[3540],{"type":425,"value":3472},{"type":419,"tag":460,"props":3542,"children":3543},{"class":462,"line":580},[3544],{"type":419,"tag":460,"props":3545,"children":3546},{"emptyLinePlaceholder":584},[3547],{"type":425,"value":587},{"type":419,"tag":460,"props":3549,"children":3550},{"class":462,"line":590},[3551],{"type":419,"tag":460,"props":3552,"children":3553},{"style":467},[3554],{"type":425,"value":3555},"  // extract comments in declarations\n",{"type":419,"tag":460,"props":3557,"children":3558},{"class":462,"line":599},[3559,3563,3567,3571,3575,3579,3583,3587,3591,3595,3599,3603,3607,3611,3615,3620,3624,3628,3632,3636,3640,3644,3648,3652,3656,3660,3664,3668,3672],{"type":419,"tag":460,"props":3560,"children":3561},{"style":1064},[3562],{"type":425,"value":2522},{"type":419,"tag":460,"props":3564,"children":3565},{"style":1070},[3566],{"type":425,"value":1073},{"type":419,"tag":460,"props":3568,"children":3569},{"style":1076},[3570],{"type":425,"value":1079},{"type":419,"tag":460,"props":3572,"children":3573},{"style":488},[3574],{"type":425,"value":480},{"type":419,"tag":460,"props":3576,"children":3577},{"style":524},[3578],{"type":425,"value":1158},{"type":419,"tag":460,"props":3580,"children":3581},{"style":488},[3582],{"type":425,"value":480},{"type":419,"tag":460,"props":3584,"children":3585},{"style":1086},[3586],{"type":425,"value":1167},{"type":419,"tag":460,"props":3588,"children":3589},{"style":1070},[3590],{"type":425,"value":1172},{"type":419,"tag":460,"props":3592,"children":3593},{"style":509},[3594],{"type":425,"value":1177},{"type":419,"tag":460,"props":3596,"children":3597},{"style":1070},[3598],{"type":425,"value":1182},{"type":419,"tag":460,"props":3600,"children":3601},{"style":620},[3602],{"type":425,"value":3520},{"type":419,"tag":460,"props":3604,"children":3605},{"style":626},[3606],{"type":425,"value":2122},{"type":419,"tag":460,"props":3608,"children":3609},{"style":632},[3610],{"type":425,"value":1197},{"type":419,"tag":460,"props":3612,"children":3613},{"style":626},[3614],{"type":425,"value":2131},{"type":419,"tag":460,"props":3616,"children":3617},{"style":620},[3618],{"type":425,"value":3619}," &&",{"type":419,"tag":460,"props":3621,"children":3622},{"style":1076},[3623],{"type":425,"value":1211},{"type":419,"tag":460,"props":3625,"children":3626},{"style":488},[3627],{"type":425,"value":480},{"type":419,"tag":460,"props":3629,"children":3630},{"style":524},[3631],{"type":425,"value":1158},{"type":419,"tag":460,"props":3633,"children":3634},{"style":488},[3635],{"type":425,"value":480},{"type":419,"tag":460,"props":3637,"children":3638},{"style":1086},[3639],{"type":425,"value":1167},{"type":419,"tag":460,"props":3641,"children":3642},{"style":1070},[3643],{"type":425,"value":1172},{"type":419,"tag":460,"props":3645,"children":3646},{"style":509},[3647],{"type":425,"value":943},{"type":419,"tag":460,"props":3649,"children":3650},{"style":1070},[3651],{"type":425,"value":1182},{"type":419,"tag":460,"props":3653,"children":3654},{"style":620},[3655],{"type":425,"value":3520},{"type":419,"tag":460,"props":3657,"children":3658},{"style":626},[3659],{"type":425,"value":2122},{"type":419,"tag":460,"props":3661,"children":3662},{"style":632},[3663],{"type":425,"value":1252},{"type":419,"tag":460,"props":3665,"children":3666},{"style":626},[3667],{"type":425,"value":2131},{"type":419,"tag":460,"props":3669,"children":3670},{"style":1070},[3671],{"type":425,"value":1182},{"type":419,"tag":460,"props":3673,"children":3674},{"style":488},[3675],{"type":425,"value":1265},{"type":419,"tag":460,"props":3677,"children":3678},{"class":462,"line":660},[3679,3683,3687,3691],{"type":419,"tag":460,"props":3680,"children":3681},{"style":1076},[3682],{"type":425,"value":2057},{"type":419,"tag":460,"props":3684,"children":3685},{"style":488},[3686],{"type":425,"value":480},{"type":419,"tag":460,"props":3688,"children":3689},{"style":1086},[3690],{"type":425,"value":2033},{"type":419,"tag":460,"props":3692,"children":3693},{"style":1070},[3694],{"type":425,"value":2017},{"type":419,"tag":460,"props":3696,"children":3697},{"class":462,"line":680},[3698,3702,3707],{"type":419,"tag":460,"props":3699,"children":3700},{"style":488},[3701],{"type":425,"value":859},{"type":419,"tag":460,"props":3703,"children":3704},{"style":1064},[3705],{"type":425,"value":3706}," else",{"type":419,"tag":460,"props":3708,"children":3709},{"style":488},[3710],{"type":425,"value":491},{"type":419,"tag":460,"props":3712,"children":3713},{"class":462,"line":696},[3714],{"type":419,"tag":460,"props":3715,"children":3716},{"style":467},[3717],{"type":425,"value":3718},"    // 如果不是注释则忽略中断，继续匹配声明\n",{"type":419,"tag":460,"props":3720,"children":3721},{"class":462,"line":716},[3722,3726,3730,3734,3738,3742,3748,3752,3756],{"type":419,"tag":460,"props":3723,"children":3724},{"style":1076},[3725],{"type":425,"value":2057},{"type":419,"tag":460,"props":3727,"children":3728},{"style":488},[3729],{"type":425,"value":480},{"type":419,"tag":460,"props":3731,"children":3732},{"style":1086},[3733],{"type":425,"value":2306},{"type":419,"tag":460,"props":3735,"children":3736},{"style":1070},[3737],{"type":425,"value":1172},{"type":419,"tag":460,"props":3739,"children":3740},{"style":626},[3741],{"type":425,"value":1197},{"type":419,"tag":460,"props":3743,"children":3745},{"style":3744},"--shiki-light:#90A4AE;--shiki-light-font-weight:inherit;--shiki-default:#22863A;--shiki-default-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;--shiki-sepia:#AE81FF;--shiki-sepia-font-weight:inherit",[3746],{"type":425,"value":3747},"\\/",{"type":419,"tag":460,"props":3749,"children":3750},{"style":620},[3751],{"type":425,"value":1505},{"type":419,"tag":460,"props":3753,"children":3754},{"style":626},[3755],{"type":425,"value":1197},{"type":419,"tag":460,"props":3757,"children":3758},{"style":1070},[3759],{"type":425,"value":1534},{"type":419,"tag":460,"props":3761,"children":3762},{"class":462,"line":724},[3763],{"type":419,"tag":460,"props":3764,"children":3765},{"style":488},[3766],{"type":425,"value":568},{"type":419,"tag":460,"props":3768,"children":3769},{"class":462,"line":732},[3770],{"type":419,"tag":460,"props":3771,"children":3772},{"emptyLinePlaceholder":584},[3773],{"type":425,"value":587},{"type":419,"tag":460,"props":3775,"children":3776},{"class":462,"line":740},[3777,3781,3785,3789,3793],{"type":419,"tag":460,"props":3778,"children":3779},{"style":1064},[3780],{"type":425,"value":2681},{"type":419,"tag":460,"props":3782,"children":3783},{"style":1076},[3784],{"type":425,"value":1211},{"type":419,"tag":460,"props":3786,"children":3787},{"style":488},[3788],{"type":425,"value":480},{"type":419,"tag":460,"props":3790,"children":3791},{"style":1086},[3792],{"type":425,"value":3271},{"type":419,"tag":460,"props":3794,"children":3795},{"style":1070},[3796],{"type":425,"value":2017},{"type":419,"tag":460,"props":3798,"children":3799},{"class":462,"line":749},[3800],{"type":419,"tag":460,"props":3801,"children":3802},{"style":488},[3803],{"type":425,"value":577},{"type":419,"tag":974,"props":3805,"children":3807},{"id":3806},"解析at-rule",[3808,3810],{"type":425,"value":3809},"解析",{"type":419,"tag":456,"props":3811,"children":3813},{"className":3812},[],[3814],{"type":425,"value":965},{"type":419,"tag":427,"props":3816,"children":3817},{},[3818,3820,3826,3828,3834,3835,3841,3843,3854],{"type":425,"value":3819},"流程中最繁琐的部分，是匹配 ",{"type":419,"tag":456,"props":3821,"children":3823},{"className":3822},[],[3824],{"type":425,"value":3825},"@media",{"type":425,"value":3827},"、",{"type":419,"tag":456,"props":3829,"children":3831},{"className":3830},[],[3832],{"type":425,"value":3833},"@import",{"type":425,"value":3827},{"type":419,"tag":456,"props":3836,"children":3838},{"className":3837},[],[3839],{"type":425,"value":3840},"@charset",{"type":425,"value":3842}," 等 ",{"type":419,"tag":438,"props":3844,"children":3847},{"href":3845,"rel":3846},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/At-rule",[442],[3848],{"type":419,"tag":456,"props":3849,"children":3851},{"className":3850},[],[3852],{"type":425,"value":3853},"at-rules",{"type":425,"value":945},{"type":419,"tag":427,"props":3856,"children":3857},{},[3858],{"type":425,"value":3859},"每一种规则的语法都不同，要怎么处理才合适呢？",{"type":419,"tag":427,"props":3861,"children":3862},{},[3863,3865,3870],{"type":425,"value":3864},"这里，micro-app 把 ",{"type":419,"tag":456,"props":3866,"children":3868},{"className":3867},[],[3869],{"type":425,"value":965},{"type":425,"value":3871}," 分为了三组：",{"type":419,"tag":3873,"props":3874,"children":3875},"ol",{},[3876,3910,3942],{"type":419,"tag":3877,"props":3878,"children":3879},"li",{},[3880,3882,3888,3890,3895,3896,3901,3902,3908],{"type":425,"value":3881},"类似 ",{"type":419,"tag":456,"props":3883,"children":3885},{"className":3884},[],[3886],{"type":425,"value":3887},"@charset \"utf-8\";",{"type":425,"value":3889}," 为一组，包括 ",{"type":419,"tag":456,"props":3891,"children":3893},{"className":3892},[],[3894],{"type":425,"value":3833},{"type":425,"value":3827},{"type":419,"tag":456,"props":3897,"children":3899},{"className":3898},[],[3900],{"type":425,"value":3840},{"type":425,"value":3827},{"type":419,"tag":456,"props":3903,"children":3905},{"className":3904},[],[3906],{"type":425,"value":3907},"@namespace",{"type":425,"value":3909}," 等。",{"type":419,"tag":3877,"props":3911,"children":3912},{},[3913,3914,3920,3921,3927,3928,3934,3935,3941],{"type":425,"value":3881},{"type":419,"tag":456,"props":3915,"children":3917},{"className":3916},[],[3918],{"type":425,"value":3919},"@media (w \u003C 100px) { .selector { xxx: xxx } }",{"type":425,"value":3889},{"type":419,"tag":456,"props":3922,"children":3924},{"className":3923},[],[3925],{"type":425,"value":3926},"@supports",{"type":425,"value":3827},{"type":419,"tag":456,"props":3929,"children":3931},{"className":3930},[],[3932],{"type":425,"value":3933},"@font-face",{"type":425,"value":3827},{"type":419,"tag":456,"props":3936,"children":3938},{"className":3937},[],[3939],{"type":425,"value":3940},"@document",{"type":425,"value":3909},{"type":419,"tag":3877,"props":3943,"children":3944},{},[3945,3946,3952,3953,3958,3959,3965,3966,3972],{"type":425,"value":3881},{"type":419,"tag":456,"props":3947,"children":3949},{"className":3948},[],[3950],{"type":425,"value":3951},"@font-face { unicode-range: 'xxx' }",{"type":425,"value":3889},{"type":419,"tag":456,"props":3954,"children":3956},{"className":3955},[],[3957],{"type":425,"value":3933},{"type":425,"value":3827},{"type":419,"tag":456,"props":3960,"children":3962},{"className":3961},[],[3963],{"type":425,"value":3964},"@page",{"type":425,"value":3827},{"type":419,"tag":456,"props":3967,"children":3969},{"className":3968},[],[3970],{"type":425,"value":3971},"@key-frames",{"type":425,"value":3909},{"type":419,"tag":427,"props":3974,"children":3975},{},[3976,3978,3983,3985,3991,3993,3999,4001,4006],{"type":425,"value":3977},"第一组，",{"type":419,"tag":456,"props":3979,"children":3981},{"className":3980},[],[3982],{"type":425,"value":3840},{"type":425,"value":3984}," 所在的第一组规则的规则正文内容从 ",{"type":419,"tag":456,"props":3986,"children":3988},{"className":3987},[],[3989],{"type":425,"value":3990},"@",{"type":425,"value":3992}," 开始到 ",{"type":419,"tag":456,"props":3994,"children":3996},{"className":3995},[],[3997],{"type":425,"value":3998},";",{"type":425,"value":4000}," 结束，比如 ",{"type":419,"tag":456,"props":4002,"children":4004},{"className":4003},[],[4005],{"type":425,"value":3887},{"type":425,"value":4007}," 就是一条完整的声明；",{"type":419,"tag":427,"props":4009,"children":4010},{},[4011,4013,4019,4021,4026],{"type":425,"value":4012},"第二组，",{"type":419,"tag":456,"props":4014,"children":4016},{"className":4015},[],[4017],{"type":425,"value":4018},"@media () {}",{"type":425,"value":4020}," 的花括号部分可能包含选择器，所以其正文内容需要重新进入 ",{"type":419,"tag":456,"props":4022,"children":4024},{"className":4023},[],[4025],{"type":425,"value":1982},{"type":425,"value":4027}," 匹配选择器以及声明。",{"type":419,"tag":427,"props":4029,"children":4030},{},[4031,4033,4039,4041,4046],{"type":425,"value":4032},"第三组，",{"type":419,"tag":456,"props":4034,"children":4036},{"className":4035},[],[4037],{"type":425,"value":4038},"@font-face {}",{"type":425,"value":4040}," 的花括号部分仅包含声明，不包含选择器，所以只需要进入 ",{"type":419,"tag":456,"props":4042,"children":4044},{"className":4043},[],[4045],{"type":425,"value":3271},{"type":425,"value":4047}," 匹配声明即可。",{"type":419,"tag":420,"props":4049,"children":4051},{"id":4050},"解决问题",[4052],{"type":425,"value":4050},{"type":419,"tag":427,"props":4054,"children":4055},{},[4056],{"type":425,"value":4057},"回到文章开头的问题，如果要给这个 CSS Parser 增加原生的嵌套功能，见下代码，可以仅用十行简单实现。",{"type":419,"tag":449,"props":4059,"children":4063},{"className":4060,"code":4061,"language":4062,"meta":413,"style":413},"language-diff shiki shiki-themes material-theme-lighter github-light github-dark monokai","+ private matchAllDeclarations (nesting = 0): void {\n  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n  this.recordResult(cssValue)\n\n  // 递归退出条件\n  if (!this.cssText) return\n-  if (this.cssText.charAt(0) === '}') return\n+  if (this.cssText.charAt(0) === '}') {\n+    if (!nesting) return\n+    this.commonMatch(/}+\\s*/)\n+    return this.matchAllDeclarations(nesting - 1)\n+  }\n\n  // extract comments in declarations\n  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n    this.matchComments()\n  } else {\n    // 如果不是注释则忽略中断，继续匹配声明\n    this.commonMatch(/\\/+/)\n  }\n\n+ if (this.cssText.charAt(0) === '{') {\n+   this.commonMatch(/{+\\s*/)\n+   nesting++\n+ }\n\n- return this.matchAllDeclarations()\n+ return this.matchAllDeclarations(nesting)\n}\n","diff",[4064],{"type":419,"tag":456,"props":4065,"children":4066},{"__ignoreMap":413},[4067,4081,4089,4097,4104,4111,4119,4133,4145,4157,4169,4181,4192,4199,4206,4214,4222,4230,4237,4245,4252,4259,4271,4284,4297,4310,4318,4331,4344],{"type":419,"tag":460,"props":4068,"children":4069},{"class":462,"line":463},[4070,4075],{"type":419,"tag":460,"props":4071,"children":4073},{"style":4072},"--shiki-light:#39ADB5;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#A6E22E",[4074],{"type":425,"value":1505},{"type":419,"tag":460,"props":4076,"children":4078},{"style":4077},"--shiki-light:#91B859;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#A6E22E",[4079],{"type":425,"value":4080}," private matchAllDeclarations (nesting = 0): void {\n",{"type":419,"tag":460,"props":4082,"children":4083},{"class":462,"line":473},[4084],{"type":419,"tag":460,"props":4085,"children":4086},{"style":524},[4087],{"type":425,"value":4088},"  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n",{"type":419,"tag":460,"props":4090,"children":4091},{"class":462,"line":494},[4092],{"type":419,"tag":460,"props":4093,"children":4094},{"style":524},[4095],{"type":425,"value":4096},"  this.recordResult(cssValue)\n",{"type":419,"tag":460,"props":4098,"children":4099},{"class":462,"line":520},[4100],{"type":419,"tag":460,"props":4101,"children":4102},{"emptyLinePlaceholder":584},[4103],{"type":425,"value":587},{"type":419,"tag":460,"props":4105,"children":4106},{"class":462,"line":540},[4107],{"type":419,"tag":460,"props":4108,"children":4109},{"style":524},[4110],{"type":425,"value":3436},{"type":419,"tag":460,"props":4112,"children":4113},{"class":462,"line":562},[4114],{"type":419,"tag":460,"props":4115,"children":4116},{"style":524},[4117],{"type":425,"value":4118},"  if (!this.cssText) return\n",{"type":419,"tag":460,"props":4120,"children":4121},{"class":462,"line":571},[4122,4127],{"type":419,"tag":460,"props":4123,"children":4125},{"style":4124},"--shiki-light:#39ADB5;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F92672",[4126],{"type":425,"value":1657},{"type":419,"tag":460,"props":4128,"children":4130},{"style":4129},"--shiki-light:#E53935;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F92672",[4131],{"type":425,"value":4132},"  if (this.cssText.charAt(0) === '}') return\n",{"type":419,"tag":460,"props":4134,"children":4135},{"class":462,"line":580},[4136,4140],{"type":419,"tag":460,"props":4137,"children":4138},{"style":4072},[4139],{"type":425,"value":1505},{"type":419,"tag":460,"props":4141,"children":4142},{"style":4077},[4143],{"type":425,"value":4144},"  if (this.cssText.charAt(0) === '}') {\n",{"type":419,"tag":460,"props":4146,"children":4147},{"class":462,"line":590},[4148,4152],{"type":419,"tag":460,"props":4149,"children":4150},{"style":4072},[4151],{"type":425,"value":1505},{"type":419,"tag":460,"props":4153,"children":4154},{"style":4077},[4155],{"type":425,"value":4156},"    if (!nesting) return\n",{"type":419,"tag":460,"props":4158,"children":4159},{"class":462,"line":599},[4160,4164],{"type":419,"tag":460,"props":4161,"children":4162},{"style":4072},[4163],{"type":425,"value":1505},{"type":419,"tag":460,"props":4165,"children":4166},{"style":4077},[4167],{"type":425,"value":4168},"    this.commonMatch(/}+\\s*/)\n",{"type":419,"tag":460,"props":4170,"children":4171},{"class":462,"line":660},[4172,4176],{"type":419,"tag":460,"props":4173,"children":4174},{"style":4072},[4175],{"type":425,"value":1505},{"type":419,"tag":460,"props":4177,"children":4178},{"style":4077},[4179],{"type":425,"value":4180},"    return this.matchAllDeclarations(nesting - 1)\n",{"type":419,"tag":460,"props":4182,"children":4183},{"class":462,"line":680},[4184,4188],{"type":419,"tag":460,"props":4185,"children":4186},{"style":4072},[4187],{"type":425,"value":1505},{"type":419,"tag":460,"props":4189,"children":4190},{"style":4077},[4191],{"type":425,"value":568},{"type":419,"tag":460,"props":4193,"children":4194},{"class":462,"line":696},[4195],{"type":419,"tag":460,"props":4196,"children":4197},{"emptyLinePlaceholder":584},[4198],{"type":425,"value":587},{"type":419,"tag":460,"props":4200,"children":4201},{"class":462,"line":716},[4202],{"type":419,"tag":460,"props":4203,"children":4204},{"style":524},[4205],{"type":425,"value":3555},{"type":419,"tag":460,"props":4207,"children":4208},{"class":462,"line":724},[4209],{"type":419,"tag":460,"props":4210,"children":4211},{"style":524},[4212],{"type":425,"value":4213},"  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n",{"type":419,"tag":460,"props":4215,"children":4216},{"class":462,"line":732},[4217],{"type":419,"tag":460,"props":4218,"children":4219},{"style":524},[4220],{"type":425,"value":4221},"    this.matchComments()\n",{"type":419,"tag":460,"props":4223,"children":4224},{"class":462,"line":740},[4225],{"type":419,"tag":460,"props":4226,"children":4227},{"style":524},[4228],{"type":425,"value":4229},"  } else {\n",{"type":419,"tag":460,"props":4231,"children":4232},{"class":462,"line":749},[4233],{"type":419,"tag":460,"props":4234,"children":4235},{"style":524},[4236],{"type":425,"value":3718},{"type":419,"tag":460,"props":4238,"children":4239},{"class":462,"line":797},[4240],{"type":419,"tag":460,"props":4241,"children":4242},{"style":524},[4243],{"type":425,"value":4244},"    this.commonMatch(/\\/+/)\n",{"type":419,"tag":460,"props":4246,"children":4247},{"class":462,"line":817},[4248],{"type":419,"tag":460,"props":4249,"children":4250},{"style":524},[4251],{"type":425,"value":568},{"type":419,"tag":460,"props":4253,"children":4254},{"class":462,"line":833},[4255],{"type":419,"tag":460,"props":4256,"children":4257},{"emptyLinePlaceholder":584},[4258],{"type":425,"value":587},{"type":419,"tag":460,"props":4260,"children":4261},{"class":462,"line":853},[4262,4266],{"type":419,"tag":460,"props":4263,"children":4264},{"style":4072},[4265],{"type":425,"value":1505},{"type":419,"tag":460,"props":4267,"children":4268},{"style":4077},[4269],{"type":425,"value":4270}," if (this.cssText.charAt(0) === '{') {\n",{"type":419,"tag":460,"props":4272,"children":4274},{"class":462,"line":4273},23,[4275,4279],{"type":419,"tag":460,"props":4276,"children":4277},{"style":4072},[4278],{"type":425,"value":1505},{"type":419,"tag":460,"props":4280,"children":4281},{"style":4077},[4282],{"type":425,"value":4283},"   this.commonMatch(/{+\\s*/)\n",{"type":419,"tag":460,"props":4285,"children":4287},{"class":462,"line":4286},24,[4288,4292],{"type":419,"tag":460,"props":4289,"children":4290},{"style":4072},[4291],{"type":425,"value":1505},{"type":419,"tag":460,"props":4293,"children":4294},{"style":4077},[4295],{"type":425,"value":4296},"   nesting++\n",{"type":419,"tag":460,"props":4298,"children":4300},{"class":462,"line":4299},25,[4301,4305],{"type":419,"tag":460,"props":4302,"children":4303},{"style":4072},[4304],{"type":425,"value":1505},{"type":419,"tag":460,"props":4306,"children":4307},{"style":4077},[4308],{"type":425,"value":4309}," }\n",{"type":419,"tag":460,"props":4311,"children":4313},{"class":462,"line":4312},26,[4314],{"type":419,"tag":460,"props":4315,"children":4316},{"emptyLinePlaceholder":584},[4317],{"type":425,"value":587},{"type":419,"tag":460,"props":4319,"children":4321},{"class":462,"line":4320},27,[4322,4326],{"type":419,"tag":460,"props":4323,"children":4324},{"style":4124},[4325],{"type":425,"value":1657},{"type":419,"tag":460,"props":4327,"children":4328},{"style":4129},[4329],{"type":425,"value":4330}," return this.matchAllDeclarations()\n",{"type":419,"tag":460,"props":4332,"children":4334},{"class":462,"line":4333},28,[4335,4339],{"type":419,"tag":460,"props":4336,"children":4337},{"style":4072},[4338],{"type":425,"value":1505},{"type":419,"tag":460,"props":4340,"children":4341},{"style":4077},[4342],{"type":425,"value":4343}," return this.matchAllDeclarations(nesting)\n",{"type":419,"tag":460,"props":4345,"children":4347},{"class":462,"line":4346},29,[4348],{"type":419,"tag":460,"props":4349,"children":4350},{"style":524},[4351],{"type":425,"value":577},{"type":419,"tag":427,"props":4353,"children":4354},{},[4355],{"type":425,"value":4356},"最终 CSS Nesting 解析成功。",{"type":419,"tag":427,"props":4358,"children":4359},{},[4360],{"type":419,"tag":950,"props":4361,"children":4363},{"alt":1849,"src":4362},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230804025910.png",[],{"type":419,"tag":420,"props":4365,"children":4367},{"id":4366},"结语",[4368],{"type":425,"value":4366},{"type":419,"tag":427,"props":4370,"children":4371},{},[4372],{"type":425,"value":4373},"整个 CSS Parser 的代码简单，功能强悍，耐人寻味。不过有许多边界条件没有处理好，尤其是引入了使用注释禁用样式隔离功能后，匹配注释变得更复杂且易错了。",{"type":419,"tag":3873,"props":4375,"children":4376},{},[4377],{"type":419,"tag":3877,"props":4378,"children":4379},{},[4380],{"type":425,"value":4381},"注释不能和选择器等混用（以下 result 文件代表解析结果）。",{"type":419,"tag":427,"props":4383,"children":4384},{},[4385],{"type":419,"tag":950,"props":4386,"children":4389},{"alt":4387,"src":4388},"comment in selectors","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/9d2b75bda238f9bbe24825a793f0f715.png",[],{"type":419,"tag":3873,"props":4391,"children":4392},{"start":473},[4393],{"type":419,"tag":3877,"props":4394,"children":4395},{},[4396],{"type":425,"value":4397},"CSS 字符串值可能意外启用编译器的特殊功能。",{"type":419,"tag":427,"props":4399,"children":4400},{},[4401],{"type":419,"tag":950,"props":4402,"children":4405},{"alt":4403,"src":4404},"special comment in string value","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230803225103.png",[],{"type":419,"tag":3873,"props":4407,"children":4408},{"start":494},[4409],{"type":419,"tag":3877,"props":4410,"children":4411},{},[4412,4414,4420,4422,4433,4435,4440],{"type":425,"value":4413},"错误的 ",{"type":419,"tag":456,"props":4415,"children":4417},{"className":4416},[],[4418],{"type":425,"value":4419},"@host",{"type":425,"value":4421}," 规则匹配。猜测是想匹配 ",{"type":419,"tag":438,"props":4423,"children":4426},{"href":4424,"rel":4425},"https://drafts.csswg.org/css-scoping/#host-selector",[442],[4427],{"type":419,"tag":456,"props":4428,"children":4430},{"className":4429},[],[4431],{"type":425,"value":4432},":host",{"type":425,"value":4434}," 但是手滑写成了 ",{"type":419,"tag":456,"props":4436,"children":4438},{"className":4437},[],[4439],{"type":425,"value":4419},{"type":425,"value":945},{"type":419,"tag":449,"props":4442,"children":4444},{"className":1009,"code":4443,"language":1011,"meta":413,"style":413},"private hostRule =\n  this.createMatcherForRuleWithChildRule(\n    /^@host\\s*/,\n    '@host'\n  )\n",[4445],{"type":419,"tag":456,"props":4446,"children":4447},{"__ignoreMap":413},[4448,4461,4482,4515,4532],{"type":419,"tag":460,"props":4449,"children":4450},{"class":462,"line":463},[4451,4456],{"type":419,"tag":460,"props":4452,"children":4453},{"style":524},[4454],{"type":425,"value":4455},"private hostRule ",{"type":419,"tag":460,"props":4457,"children":4458},{"style":620},[4459],{"type":425,"value":4460},"=\n",{"type":419,"tag":460,"props":4462,"children":4463},{"class":462,"line":473},[4464,4468,4472,4477],{"type":419,"tag":460,"props":4465,"children":4466},{"style":1076},[4467],{"type":425,"value":1388},{"type":419,"tag":460,"props":4469,"children":4470},{"style":488},[4471],{"type":425,"value":480},{"type":419,"tag":460,"props":4473,"children":4474},{"style":1086},[4475],{"type":425,"value":4476},"createMatcherForRuleWithChildRule",{"type":419,"tag":460,"props":4478,"children":4479},{"style":524},[4480],{"type":425,"value":4481},"(\n",{"type":419,"tag":460,"props":4483,"children":4484},{"class":462,"line":494},[4485,4490,4494,4498,4502,4506,4510],{"type":419,"tag":460,"props":4486,"children":4487},{"style":626},[4488],{"type":425,"value":4489},"    /",{"type":419,"tag":460,"props":4491,"children":4492},{"style":1064},[4493],{"type":425,"value":2319},{"type":419,"tag":460,"props":4495,"children":4496},{"style":2960},[4497],{"type":425,"value":4419},{"type":419,"tag":460,"props":4499,"children":4500},{"style":2322},[4501],{"type":425,"value":2325},{"type":419,"tag":460,"props":4503,"children":4504},{"style":620},[4505],{"type":425,"value":1252},{"type":419,"tag":460,"props":4507,"children":4508},{"style":626},[4509],{"type":425,"value":1197},{"type":419,"tag":460,"props":4511,"children":4512},{"style":488},[4513],{"type":425,"value":4514},",\n",{"type":419,"tag":460,"props":4516,"children":4517},{"class":462,"line":520},[4518,4523,4527],{"type":419,"tag":460,"props":4519,"children":4520},{"style":626},[4521],{"type":425,"value":4522},"    '",{"type":419,"tag":460,"props":4524,"children":4525},{"style":632},[4526],{"type":425,"value":4419},{"type":419,"tag":460,"props":4528,"children":4529},{"style":626},[4530],{"type":425,"value":4531},"'\n",{"type":419,"tag":460,"props":4533,"children":4534},{"class":462,"line":540},[4535],{"type":419,"tag":460,"props":4536,"children":4537},{"style":524},[4538],{"type":425,"value":4539},"  )\n",{"type":419,"tag":427,"props":4541,"children":4542},{},[4543],{"type":419,"tag":950,"props":4544,"children":4547},{"alt":4545,"src":4546},"error @host rule","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230803235802.png",[],{"type":419,"tag":427,"props":4549,"children":4550},{},[4551,4553,4560],{"type":425,"value":4552},"在实际项目中，考虑到性能和可维护性的平衡，为了使代码不变得过于复杂，没有必要去完善“边界功能”。运行时的解析应当尽量简单且运行快速，并保持一定的容错：不规范的 CSS 代码在浏览器中本身就能运行，再者，解析器是一个容易带来代码性能和体积瓶颈的地方，要不然 VueJS 也不会分全局构建和运行时",{"type":419,"tag":438,"props":4554,"children":4557},{"href":4555,"rel":4556},"https://www.jsdelivr.com/package/npm/vue?tab=files&path=dist",[442],[4558],{"type":425,"value":4559},"两个版本的编译产物",{"type":425,"value":945},{"type":419,"tag":427,"props":4562,"children":4563},{},[4564],{"type":425,"value":4565},"鉴于 CSS 在部分语法上的灵活性，如果从降低维护难度的角度考虑优化这个 CSS Parser，可能从以下方向：",{"type":419,"tag":4567,"props":4568,"children":4569},"ul",{},[4570,4605],{"type":419,"tag":3877,"props":4571,"children":4572},{},[4573,4575,4580,4582,4588,4590,4595,4597,4604],{"type":425,"value":4574},"在规则匹配部分使用黑名单机制而不是白名单匹配。就 ",{"type":419,"tag":456,"props":4576,"children":4578},{"className":4577},[],[4579],{"type":425,"value":965},{"type":425,"value":4581}," 等灵活语法而言，如果浏览器支持新的 ",{"type":419,"tag":456,"props":4583,"children":4585},{"className":4584},[],[4586],{"type":425,"value":4587},"@xxx",{"type":425,"value":4589}," 语法，黑名单机制编写的代码不需要对 ",{"type":419,"tag":456,"props":4591,"children":4593},{"className":4592},[],[4594],{"type":425,"value":4587},{"type":425,"value":4596}," 做额外处理；而白名单机制需要",{"type":419,"tag":438,"props":4598,"children":4601},{"href":4599,"rel":4600},"https://github.com/micro-zoe/micro-app/commit/b83c4600102e0db6f591bacbdc592bea8f1d5bb8",[442],[4602],{"type":425,"value":4603},"手动处理",{"type":425,"value":945},{"type":419,"tag":3877,"props":4606,"children":4607},{},[4608,4610,4621],{"type":425,"value":4609},"在复杂的解析器部分使用外部依赖，如使用类似 ",{"type":419,"tag":438,"props":4611,"children":4614},{"href":4612,"rel":4613},"https://www.npmjs.com/package/lightningcss-wasm/v/1.16.0",[442],[4615],{"type":419,"tag":456,"props":4616,"children":4618},{"className":4617},[],[4619],{"type":425,"value":4620},"lightingcss-wasm",{"type":425,"value":4622}," 等方案。",{"type":419,"tag":427,"props":4624,"children":4625},{},[4626],{"type":425,"value":4627},"关于样式隔离，作者两年前专门写了文章介绍，不过时效性稍有不足，没有涉及解析器的具体流程，写得更多是解析器在整个微前端框架中的作用，也可作为补充阅读。",{"type":419,"tag":4567,"props":4629,"children":4630},{},[4631],{"type":419,"tag":3877,"props":4632,"children":4633},{},[4634],{"type":419,"tag":438,"props":4635,"children":4638},{"href":4636,"rel":4637},"https://github.com/micro-zoe/micro-app/issues/20",[442],[4639],{"type":425,"value":4640},"从零开始写一个微前端框架-样式隔离篇",{"type":419,"tag":427,"props":4642,"children":4643},{},[4644],{"type":425,"value":4645},"最后，微前端框架中的 CSS 的有很多中实施办法，采用一些办法可以抛弃运行时解析。em... 也许以后有机会聊一聊（咕一咕）。",{"type":419,"tag":420,"props":4647,"children":4649},{"id":4648},"增订-2024-年-1-月-28-日",[4650],{"type":425,"value":4651},"增订 | 2024 年 1 月 28 日",{"type":419,"tag":427,"props":4653,"children":4654},{},[4655,4657],{"type":425,"value":4656},"相关实现和测试用例见",{"type":419,"tag":438,"props":4658,"children":4661},{"href":4659,"rel":4660},"https://github.com/micro-zoe/micro-app/issues/868?_issue=nesting",[442],[4662],{"type":425,"value":4663},"这个 Issue",{"type":419,"tag":4665,"props":4666,"children":4669},"section",{"className":4667,"dataFootnotes":413},[4668],"footnotes",[4670,4677],{"type":419,"tag":420,"props":4671,"children":4674},{"className":4672,"id":939},[4673],"sr-only",[4675],{"type":425,"value":4676},"Footnotes",{"type":419,"tag":3873,"props":4678,"children":4679},{},[4680],{"type":419,"tag":3877,"props":4681,"children":4683},{"id":4682},"user-content-fn-css-syntax",[4684,4686,4692,4694],{"type":425,"value":4685},"比较完整的 CSS 语法参见：",{"type":419,"tag":438,"props":4687,"children":4690},{"href":4688,"rel":4689},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/Syntax",[442],[4691],{"type":425,"value":4688},{"type":425,"value":4693}," ",{"type":419,"tag":438,"props":4695,"children":4700},{"href":4696,"ariaLabel":4697,"className":4698,"dataFootnoteBackref":413},"#user-content-fnref-css-syntax","Back to reference 1",[4699],"data-footnote-backref",[4701],{"type":425,"value":4702},"↩",{"type":419,"tag":4704,"props":4705,"children":4706},"style",{},[4707],{"type":425,"value":4708},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":413,"searchDepth":473,"depth":473,"links":4710},[4711,4712,4713,4714,4715,4716,4717],{"id":422,"depth":473,"text":422},{"id":867,"depth":473,"text":870},{"id":970,"depth":473,"text":970},{"id":4050,"depth":473,"text":4050},{"id":4366,"depth":473,"text":4366},{"id":4648,"depth":473,"text":4651},{"id":939,"depth":473,"text":4676},"markdown","content:2.articles:1101.mini-css-parser.md","content","2.articles/1101.mini-css-parser.md","2.articles/1101.mini-css-parser","md",[4725,4727],{"_path":43,"title":42,"description":4726},"忍者秘籍中提到的模板解析器，很短但支持变量和 if 等语句，还是 15 年前的代码！",{"_path":49,"title":48,"description":4728},"在两个纯知识面的问题上，受到了 GPT 的碾压",1732808694972]