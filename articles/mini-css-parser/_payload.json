[{"data":1,"prerenderedAt":4712},["ShallowReactive",2],{"navigation":3,"/articles/mini-css-parser":393,"/articles/mini-css-parser-surround":4707},[4,35,86,105,132,138,144,150,387],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":45,"_path":46},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":48,"_path":49},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":51,"_path":52},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":54,"_path":55},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":57,"_path":58},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":60,"_path":61},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":63,"_path":64},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":66,"_path":67},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":69,"_path":70},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":72,"_path":73},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":75,"_path":76},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":78,"_path":79},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":81,"_path":82},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":84,"_path":85},"📝 技术博客归档","/articles/archive",{"title":87,"_path":88,"children":89},"造物 / Make","/tools",[90,93,96,99,102],{"title":91,"_path":92},"🥥 Coconut","/tools/coconut",{"title":94,"_path":95},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":97,"_path":98},"🌐 AnySort","/tools/anysort",{"title":100,"_path":101},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":103,"_path":104},"👓 Crapto","/tools/crypto-inline",{"title":106,"_path":107,"children":108},"吉他剧场 / Music","/music",[109,111,114,117,120,123,126,129],{"title":110,"_path":107},"🎸 FingerStyle！",{"title":112,"_path":113},"🌬️ 等待的风","/music/wind",{"title":115,"_path":116},"💕 约定的海洋","/music/ocean",{"title":118,"_path":119},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":121,"_path":122},"🌏 残酷天使的行动纲领","/music/eva",{"title":124,"_path":125},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":127,"_path":128},"🍷 Wu Wei","/music/wu-wei",{"title":130,"_path":131},"🌅 无题","/music/untitled",{"title":133,"_path":134,"children":135},"画点什么 / Paint","/paint",[136],{"title":137,"_path":134},"🚧 正在施工",{"title":139,"_path":140,"children":141},"读书笔记 / Notes","/books",[142],{"title":143,"_path":140},"📕 读书笔记",{"title":145,"_path":146,"children":147},"知识地图 / Maps","/maps",[148],{"title":149,"_path":146},"🏁 知识地图",{"title":151,"_path":152,"children":153},"零散的笔记 / Gists","/gists",[154,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375,378,381,384],{"title":155,"_path":152},"🧊 Gists",{"title":157,"_path":158},"网站的可访问性","/gists/accessibility",{"title":160,"_path":161},"Bit","/gists/bit",{"title":163,"_path":164},"图片模糊","/gists/blur",{"title":166,"_path":167},"渲染相关笔记","/gists/c4d",{"title":169,"_path":170},"CDN 问题记录","/gists/cdn",{"title":172,"_path":173},"消毒剂","/gists/cleaner",{"title":175,"_path":176},"Windows Command","/gists/cmd",{"title":178,"_path":179},"Command","/gists/command",{"title":181,"_path":182},"复杂科学","/gists/complexity-science",{"title":184,"_path":185},"GitHub Copilot","/gists/copilot",{"title":187,"_path":188},"宇宙","/gists/cosmos",{"title":190,"_path":191},"C++","/gists/cpp",{"title":193,"_path":194},"DEPRESSION","/gists/depression",{"title":196,"_path":197},"Developer Experience","/gists/developer-experience",{"title":199,"_path":200},"Device Metrics","/gists/device-metrix",{"title":202,"_path":203},"数字化转型","/gists/digital-transformation",{"title":205,"_path":206},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":208,"_path":209},"正则表达式","/gists/eegex",{"title":211,"_path":212},"Emoji","/gists/emoji",{"title":214,"_path":215},"工程","/gists/engineering",{"title":217,"_path":218},"熵","/gists/entropy",{"title":220,"_path":221},"Environment","/gists/environment",{"title":223,"_path":224},"Erlang","/gists/erlang",{"title":226,"_path":227},"逃离塔克夫","/gists/escape-from-tarkov",{"title":229,"_path":230},"ESNext (ES6-ES11)","/gists/esnext",{"title":232,"_path":233},"Eval！","/gists/eval",{"title":235,"_path":236},"Flutter","/gists/flutter",{"title":238,"_path":239},"字体","/gists/font",{"title":241,"_path":242},"JS 函数式编程","/gists/functional",{"title":244,"_path":245},"游戏化","/gists/gamification",{"title":247,"_path":248},"Google C++ Standard","/gists/google-cpp-standard",{"title":250,"_path":251},"双向链接完全体","/gists/graph",{"title":253,"_path":254},"Hardwares","/gists/hardwares",{"title":256,"_path":257},"哈希冲突","/gists/hash-collision",{"title":259,"_path":260},"信息设计","/gists/information-design",{"title":262,"_path":263},"InstantPage","/gists/instant.page",{"title":265,"_path":266},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":268,"_path":269},"KVStore","/gists/key-value-db",{"title":271,"_path":272},"Kubernetes","/gists/kubernetes",{"title":274,"_path":275},"Makefile","/gists/makefile",{"title":277,"_path":278},"Markdown Inline Style","/gists/markdown-nice",{"title":280,"_path":281},"小程序","/gists/miniapp",{"title":283,"_path":284},"减小页面快照体积","/gists/minify-html",{"title":286,"_path":287},"mklink","/gists/mklink",{"title":289,"_path":290},"Mock","/gists/mock",{"title":292,"_path":293},"多人协作系统","/gists/multiplayer",{"title":295,"_path":296},"多端应用","/gists/multy-end-app",{"title":298,"_path":299},"神经科学","/gists/neuroscience",{"title":301,"_path":302},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":304,"_path":305},"PInvoke","/gists/pinvoke",{"title":307,"_path":308},"像素","/gists/pixel",{"title":310,"_path":311},"PowerShell","/gists/powershell",{"title":313,"_path":314},"量子","/gists/quantum",{"title":316,"_path":317},"保持好奇心","/gists/questions",{"title":319,"_path":320},"React Native","/gists/react-native",{"title":322,"_path":323},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":325,"_path":326},"SEO","/gists/seo",{"title":328,"_path":329},"Shader","/gists/shader",{"title":331,"_path":332},"Shape Up","/gists/shape-up",{"title":334,"_path":335},"睡觉","/gists/sleep",{"title":337,"_path":338},"记录奇怪的问题","/gists/solved",{"title":340,"_path":341},"States","/gists/states",{"title":343,"_path":344},"Storage","/gists/storage",{"title":346,"_path":347},"音视频流处理","/gists/stream-cli",{"title":349,"_path":350},"Symbol","/gists/symbol",{"title":352,"_path":353},"系统论","/gists/systems-theory",{"title":355,"_path":356},"Taro","/gists/taro",{"title":358,"_path":359},"任务切片","/gists/task-slice",{"title":361,"_path":362},"技术偏好","/gists/tech-dudge",{"title":364,"_path":365},"Untitled","/gists/untitled",{"title":367,"_path":368},"可变字体","/gists/variable-font",{"title":370,"_path":371},"视觉错觉","/gists/visual-illusion",{"title":373,"_path":374},"SS(SSR)","/gists/vpn",{"title":376,"_path":377},"VS Code 插件开发","/gists/vscode-plugin",{"title":379,"_path":380},"Web Components","/gists/web-components",{"title":382,"_path":383},"Windows","/gists/windows",{"title":385,"_path":386},"查缺补漏","/gists/wrong",{"title":388,"_path":389,"children":390},"我 / About","/hire",[391],{"title":392,"_path":389},"📬 技术简历",{"_path":52,"_dir":394,"_draft":395,"_partial":395,"_locale":396,"title":51,"description":397,"body":398,"_type":4701,"_id":4702,"_source":4703,"_file":4704,"_stem":4705,"_extension":4706},"articles",false,"","我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。我碰到的问题是，如果 CSS 源码中带嵌套语法那么解析就会失败。今天借这个问题给大家简单介绍一下 CSS Parser 的基本流程。",{"type":399,"children":400,"toc":4692},"root",[401,409,415,431,848,854,929,938,951,956,962,985,990,1314,1319,1711,1739,1810,1815,1835,1860,1936,1941,1946,2232,2244,2336,2375,2392,2677,2721,3195,3236,3787,3798,3838,3843,3855,3956,3991,4011,4031,4036,4041,4335,4340,4347,4352,4357,4365,4373,4381,4389,4424,4523,4531,4544,4549,4606,4611,4624,4629,4635,4647,4686],{"type":402,"tag":403,"props":404,"children":406},"element","h2",{"id":405},"前言",[407],{"type":408,"value":405},"text",{"type":402,"tag":410,"props":411,"children":412},"p",{},[413],{"type":408,"value":414},"Vue 源码中包含 HTML Parser，随着大家在框架方向的深入学习（卷），不免要开始接触一些编译解析相关的东西。社区很多看 Vue 源码时总结的 HTML Parser 的文章，但是很少有介绍 CSS Parser 的文章。今天借着在开发时碰到的一个问题，给大家简单介绍一下 CSS Parser 的基本流程。",{"type":402,"tag":410,"props":416,"children":417},{},[418,420,429],{"type":408,"value":419},"我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。代码示例见下。我碰到的问题是，如果 CSS 源码中带",{"type":402,"tag":421,"props":422,"children":426},"a",{"href":423,"rel":424},"https://caniuse.com/?search=css%20nesting",[425],"nofollow",[427],{"type":408,"value":428},"嵌套语法",{"type":408,"value":430},"，那么解析就会失败。",{"type":402,"tag":432,"props":433,"children":437},"pre",{"className":434,"code":435,"language":436,"meta":396,"style":396},"language-css shiki shiki-themes material-theme-lighter github-light github-dark monokai","/* css 源代码 */\n.a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  }\n}\n\n/* 期待转化得到的代码 */\nmicro-app[name=\"test-app\"] .a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  }\n}\n\n/* 实际得到的代码 */\nmicro-app[name=\"test-app\"] .a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  } /* -> 到这里就停了 */\n","css",[438],{"type":402,"tag":439,"props":440,"children":441},"code",{"__ignoreMap":396},[442,454,475,501,521,543,552,561,571,580,641,661,677,697,705,713,721,730,778,798,814,834],{"type":402,"tag":443,"props":444,"children":447},"span",{"class":445,"line":446},"line",1,[448],{"type":402,"tag":443,"props":449,"children":451},{"style":450},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[452],{"type":408,"value":453},"/* css 源代码 */\n",{"type":402,"tag":443,"props":455,"children":457},{"class":445,"line":456},2,[458,464,469],{"type":402,"tag":443,"props":459,"children":461},{"style":460},"--shiki-light:#39ADB5;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[462],{"type":408,"value":463},".",{"type":402,"tag":443,"props":465,"children":467},{"style":466},"--shiki-light:#E2931D;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[468],{"type":408,"value":421},{"type":402,"tag":443,"props":470,"children":472},{"style":471},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[473],{"type":408,"value":474}," {\n",{"type":402,"tag":443,"props":476,"children":478},{"class":445,"line":477},3,[479,485,490,496],{"type":402,"tag":443,"props":480,"children":482},{"style":481},"--shiki-light:#8796B0;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[483],{"type":408,"value":484},"  z-index",{"type":402,"tag":443,"props":486,"children":487},{"style":471},[488],{"type":408,"value":489},":",{"type":402,"tag":443,"props":491,"children":493},{"style":492},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[494],{"type":408,"value":495}," 1",{"type":402,"tag":443,"props":497,"children":498},{"style":471},[499],{"type":408,"value":500},";\n",{"type":402,"tag":443,"props":502,"children":504},{"class":445,"line":503},4,[505,511,517],{"type":402,"tag":443,"props":506,"children":508},{"style":507},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[509],{"type":408,"value":510},"  .",{"type":402,"tag":443,"props":512,"children":514},{"style":513},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[515],{"type":408,"value":516},"b",{"type":402,"tag":443,"props":518,"children":519},{"style":507},[520],{"type":408,"value":474},{"type":402,"tag":443,"props":522,"children":524},{"class":445,"line":523},5,[525,530,534,539],{"type":402,"tag":443,"props":526,"children":527},{"style":481},[528],{"type":408,"value":529},"    z-index",{"type":402,"tag":443,"props":531,"children":532},{"style":471},[533],{"type":408,"value":489},{"type":402,"tag":443,"props":535,"children":536},{"style":492},[537],{"type":408,"value":538}," 2",{"type":402,"tag":443,"props":540,"children":541},{"style":471},[542],{"type":408,"value":500},{"type":402,"tag":443,"props":544,"children":546},{"class":445,"line":545},6,[547],{"type":402,"tag":443,"props":548,"children":549},{"style":471},[550],{"type":408,"value":551},"  }\n",{"type":402,"tag":443,"props":553,"children":555},{"class":445,"line":554},7,[556],{"type":402,"tag":443,"props":557,"children":558},{"style":507},[559],{"type":408,"value":560},"}\n",{"type":402,"tag":443,"props":562,"children":564},{"class":445,"line":563},8,[565],{"type":402,"tag":443,"props":566,"children":568},{"emptyLinePlaceholder":567},true,[569],{"type":408,"value":570},"\n",{"type":402,"tag":443,"props":572,"children":574},{"class":445,"line":573},9,[575],{"type":402,"tag":443,"props":576,"children":577},{"style":450},[578],{"type":408,"value":579},"/* 期待转化得到的代码 */\n",{"type":402,"tag":443,"props":581,"children":583},{"class":445,"line":582},10,[584,590,595,601,607,613,619,623,628,633,637],{"type":402,"tag":443,"props":585,"children":587},{"style":586},"--shiki-light:#E2931D;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[588],{"type":408,"value":589},"micro-app",{"type":402,"tag":443,"props":591,"children":592},{"style":471},[593],{"type":408,"value":594},"[",{"type":402,"tag":443,"props":596,"children":598},{"style":597},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[599],{"type":408,"value":600},"name",{"type":402,"tag":443,"props":602,"children":604},{"style":603},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[605],{"type":408,"value":606},"=",{"type":402,"tag":443,"props":608,"children":610},{"style":609},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[611],{"type":408,"value":612},"\"",{"type":402,"tag":443,"props":614,"children":616},{"style":615},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[617],{"type":408,"value":618},"test-app",{"type":402,"tag":443,"props":620,"children":621},{"style":609},[622],{"type":408,"value":612},{"type":402,"tag":443,"props":624,"children":625},{"style":471},[626],{"type":408,"value":627},"]",{"type":402,"tag":443,"props":629,"children":630},{"style":460},[631],{"type":408,"value":632}," .",{"type":402,"tag":443,"props":634,"children":635},{"style":466},[636],{"type":408,"value":421},{"type":402,"tag":443,"props":638,"children":639},{"style":471},[640],{"type":408,"value":474},{"type":402,"tag":443,"props":642,"children":644},{"class":445,"line":643},11,[645,649,653,657],{"type":402,"tag":443,"props":646,"children":647},{"style":481},[648],{"type":408,"value":484},{"type":402,"tag":443,"props":650,"children":651},{"style":471},[652],{"type":408,"value":489},{"type":402,"tag":443,"props":654,"children":655},{"style":492},[656],{"type":408,"value":495},{"type":402,"tag":443,"props":658,"children":659},{"style":471},[660],{"type":408,"value":500},{"type":402,"tag":443,"props":662,"children":664},{"class":445,"line":663},12,[665,669,673],{"type":402,"tag":443,"props":666,"children":667},{"style":507},[668],{"type":408,"value":510},{"type":402,"tag":443,"props":670,"children":671},{"style":513},[672],{"type":408,"value":516},{"type":402,"tag":443,"props":674,"children":675},{"style":507},[676],{"type":408,"value":474},{"type":402,"tag":443,"props":678,"children":680},{"class":445,"line":679},13,[681,685,689,693],{"type":402,"tag":443,"props":682,"children":683},{"style":481},[684],{"type":408,"value":529},{"type":402,"tag":443,"props":686,"children":687},{"style":471},[688],{"type":408,"value":489},{"type":402,"tag":443,"props":690,"children":691},{"style":492},[692],{"type":408,"value":538},{"type":402,"tag":443,"props":694,"children":695},{"style":471},[696],{"type":408,"value":500},{"type":402,"tag":443,"props":698,"children":700},{"class":445,"line":699},14,[701],{"type":402,"tag":443,"props":702,"children":703},{"style":471},[704],{"type":408,"value":551},{"type":402,"tag":443,"props":706,"children":708},{"class":445,"line":707},15,[709],{"type":402,"tag":443,"props":710,"children":711},{"style":507},[712],{"type":408,"value":560},{"type":402,"tag":443,"props":714,"children":716},{"class":445,"line":715},16,[717],{"type":402,"tag":443,"props":718,"children":719},{"emptyLinePlaceholder":567},[720],{"type":408,"value":570},{"type":402,"tag":443,"props":722,"children":724},{"class":445,"line":723},17,[725],{"type":402,"tag":443,"props":726,"children":727},{"style":450},[728],{"type":408,"value":729},"/* 实际得到的代码 */\n",{"type":402,"tag":443,"props":731,"children":733},{"class":445,"line":732},18,[734,738,742,746,750,754,758,762,766,770,774],{"type":402,"tag":443,"props":735,"children":736},{"style":586},[737],{"type":408,"value":589},{"type":402,"tag":443,"props":739,"children":740},{"style":471},[741],{"type":408,"value":594},{"type":402,"tag":443,"props":743,"children":744},{"style":597},[745],{"type":408,"value":600},{"type":402,"tag":443,"props":747,"children":748},{"style":603},[749],{"type":408,"value":606},{"type":402,"tag":443,"props":751,"children":752},{"style":609},[753],{"type":408,"value":612},{"type":402,"tag":443,"props":755,"children":756},{"style":615},[757],{"type":408,"value":618},{"type":402,"tag":443,"props":759,"children":760},{"style":609},[761],{"type":408,"value":612},{"type":402,"tag":443,"props":763,"children":764},{"style":471},[765],{"type":408,"value":627},{"type":402,"tag":443,"props":767,"children":768},{"style":460},[769],{"type":408,"value":632},{"type":402,"tag":443,"props":771,"children":772},{"style":466},[773],{"type":408,"value":421},{"type":402,"tag":443,"props":775,"children":776},{"style":471},[777],{"type":408,"value":474},{"type":402,"tag":443,"props":779,"children":781},{"class":445,"line":780},19,[782,786,790,794],{"type":402,"tag":443,"props":783,"children":784},{"style":481},[785],{"type":408,"value":484},{"type":402,"tag":443,"props":787,"children":788},{"style":471},[789],{"type":408,"value":489},{"type":402,"tag":443,"props":791,"children":792},{"style":492},[793],{"type":408,"value":495},{"type":402,"tag":443,"props":795,"children":796},{"style":471},[797],{"type":408,"value":500},{"type":402,"tag":443,"props":799,"children":801},{"class":445,"line":800},20,[802,806,810],{"type":402,"tag":443,"props":803,"children":804},{"style":507},[805],{"type":408,"value":510},{"type":402,"tag":443,"props":807,"children":808},{"style":513},[809],{"type":408,"value":516},{"type":402,"tag":443,"props":811,"children":812},{"style":507},[813],{"type":408,"value":474},{"type":402,"tag":443,"props":815,"children":817},{"class":445,"line":816},21,[818,822,826,830],{"type":402,"tag":443,"props":819,"children":820},{"style":481},[821],{"type":408,"value":529},{"type":402,"tag":443,"props":823,"children":824},{"style":471},[825],{"type":408,"value":489},{"type":402,"tag":443,"props":827,"children":828},{"style":492},[829],{"type":408,"value":538},{"type":402,"tag":443,"props":831,"children":832},{"style":471},[833],{"type":408,"value":500},{"type":402,"tag":443,"props":835,"children":837},{"class":445,"line":836},22,[838,843],{"type":402,"tag":443,"props":839,"children":840},{"style":471},[841],{"type":408,"value":842},"  }",{"type":402,"tag":443,"props":844,"children":845},{"style":450},[846],{"type":408,"value":847}," /* -> 到这里就停了 */\n",{"type":402,"tag":403,"props":849,"children":851},{"id":850},"css-的组成部分",[852],{"type":408,"value":853},"CSS 的组成部分",{"type":402,"tag":410,"props":855,"children":856},{},[857,859,866,868,874,876,882,884,890,892,898,900,906,908,914,927],{"type":408,"value":858},"要理解 CSS 是怎么解析的，就要先清楚 CSS 是由哪几部分组成的。由我们平常见得最多的普通 CSS 代码开始说起，见下图，基本的 CSS 代码的组成部分包含规则集（rules）、选择器（selector）、选择器（declares）、属性（property）、值（value）这五个部分。",{"type":402,"tag":860,"props":861,"children":863},"abbr",{"title":862},"rule",[864],{"type":408,"value":865},"规则",{"type":408,"value":867},"是由",{"type":402,"tag":860,"props":869,"children":871},{"title":870},"property",[872],{"type":408,"value":873},"属性",{"type":408,"value":875},"和",{"type":402,"tag":860,"props":877,"children":879},{"title":878},"value",[880],{"type":408,"value":881},"值",{"type":408,"value":883},"组成的",{"type":402,"tag":860,"props":885,"children":887},{"title":886},"declaration",[888],{"type":408,"value":889},"声明",{"type":408,"value":891},"、声明与括号形成的",{"type":402,"tag":860,"props":893,"children":895},{"title":894},"declaration block",[896],{"type":408,"value":897},"声明块",{"type":408,"value":899},"再加上",{"type":402,"tag":860,"props":901,"children":903},{"title":902},"selector",[904],{"type":408,"value":905},"选择器",{"type":408,"value":907},"组成，而一条或多条规则组合成了",{"type":402,"tag":860,"props":909,"children":911},{"title":910},"rule sets",[912],{"type":408,"value":913},"规则集",{"type":402,"tag":915,"props":916,"children":917},"sup",{},[918],{"type":402,"tag":421,"props":919,"children":924},{"href":920,"ariaDescribedBy":921,"dataFootnoteRef":396,"id":923},"#user-content-fn-css-syntax",[922],"footnote-label","user-content-fnref-css-syntax",[925],{"type":408,"value":926},"1",{"type":408,"value":928},"。",{"type":402,"tag":410,"props":930,"children":931},{},[932],{"type":402,"tag":933,"props":934,"children":937},"img",{"alt":935,"src":936},"规则&规则集","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/200621/20200625022018.png",[],{"type":402,"tag":410,"props":939,"children":940},{},[941,943,949],{"type":408,"value":942},"图中没有包含 ",{"type":402,"tag":439,"props":944,"children":946},{"className":945},[],[947],{"type":408,"value":948},"at-rule",{"type":408,"value":950}," 的部分，哦，还少了注释部分~ 由于注释是 CSS 中语法最简单的部分，我们从解析注释开始代码部分的解读吧。",{"type":402,"tag":403,"props":952,"children":954},{"id":953},"流程速览",[955],{"type":408,"value":953},{"type":402,"tag":957,"props":958,"children":960},"h4",{"id":959},"解析注释",[961],{"type":408,"value":959},{"type":402,"tag":410,"props":963,"children":964},{},[965,967,974,976,983],{"type":408,"value":966},"可能许多人不了解 CSS 的注释风格，这里先说明一下，原生 CSS 仅支持",{"type":402,"tag":421,"props":968,"children":971},{"href":969,"rel":970},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/Comments",[425],[972],{"type":408,"value":973},"斜杠星号风格注释",{"type":408,"value":975},"，不支持",{"type":402,"tag":421,"props":977,"children":980},{"href":978,"rel":979},"https://segmentfault.com/a/1190000043885414",[425],[981],{"type":408,"value":982},"双斜杠注释",{"type":408,"value":984},"，所以解析器并未处理双斜杠的情况。",{"type":402,"tag":410,"props":986,"children":987},{},[988],{"type":408,"value":989},"解析注释的函数是一个 while 循环，从代码开头开始匹配，每次循环解析一条注释，直到代码开头没有注释为止。",{"type":402,"tag":432,"props":991,"children":995},{"className":992,"code":993,"language":994,"meta":396,"style":396},"language-ts shiki shiki-themes material-theme-lighter github-light github-dark monokai","class CSSParser {\n  private matchComments() {\n    while (this.matchComment());\n  }\n  private matchComment() {\n    // 快速跳过非注释部分代码\n    if (this.cssText.charAt(0) !== \"/\" || this.cssText.charAt(1) !== \"*\") {\n      return false;\n    }\n    // ...\n    return true;\n  }\n}\n","ts",[996],{"type":402,"tag":439,"props":997,"children":998},{"__ignoreMap":396},[999,1018,1042,1082,1089,1109,1117,1249,1267,1275,1283,1300,1307],{"type":402,"tag":443,"props":1000,"children":1001},{"class":445,"line":446},[1002,1008,1014],{"type":402,"tag":443,"props":1003,"children":1005},{"style":1004},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[1006],{"type":408,"value":1007},"class",{"type":402,"tag":443,"props":1009,"children":1011},{"style":1010},"--shiki-light:#E2931D;--shiki-light-text-decoration:inherit;--shiki-default:#6F42C1;--shiki-default-text-decoration:inherit;--shiki-dark:#B392F0;--shiki-dark-text-decoration:inherit;--shiki-sepia:#A6E22E;--shiki-sepia-text-decoration:underline",[1012],{"type":408,"value":1013}," CSSParser",{"type":402,"tag":443,"props":1015,"children":1016},{"style":471},[1017],{"type":408,"value":474},{"type":402,"tag":443,"props":1019,"children":1020},{"class":445,"line":456},[1021,1027,1033,1038],{"type":402,"tag":443,"props":1022,"children":1024},{"style":1023},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1025],{"type":408,"value":1026},"  private",{"type":402,"tag":443,"props":1028,"children":1030},{"style":1029},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1031],{"type":408,"value":1032}," matchComments",{"type":402,"tag":443,"props":1034,"children":1035},{"style":471},[1036],{"type":408,"value":1037},"()",{"type":402,"tag":443,"props":1039,"children":1040},{"style":471},[1041],{"type":408,"value":474},{"type":402,"tag":443,"props":1043,"children":1044},{"class":445,"line":477},[1045,1051,1057,1063,1067,1073,1078],{"type":402,"tag":443,"props":1046,"children":1048},{"style":1047},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[1049],{"type":408,"value":1050},"    while",{"type":402,"tag":443,"props":1052,"children":1054},{"style":1053},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[1055],{"type":408,"value":1056}," (",{"type":402,"tag":443,"props":1058,"children":1060},{"style":1059},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[1061],{"type":408,"value":1062},"this",{"type":402,"tag":443,"props":1064,"children":1065},{"style":471},[1066],{"type":408,"value":463},{"type":402,"tag":443,"props":1068,"children":1070},{"style":1069},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1071],{"type":408,"value":1072},"matchComment",{"type":402,"tag":443,"props":1074,"children":1075},{"style":1053},[1076],{"type":408,"value":1077},"())",{"type":402,"tag":443,"props":1079,"children":1080},{"style":471},[1081],{"type":408,"value":500},{"type":402,"tag":443,"props":1083,"children":1084},{"class":445,"line":503},[1085],{"type":402,"tag":443,"props":1086,"children":1087},{"style":471},[1088],{"type":408,"value":551},{"type":402,"tag":443,"props":1090,"children":1091},{"class":445,"line":523},[1092,1096,1101,1105],{"type":402,"tag":443,"props":1093,"children":1094},{"style":1023},[1095],{"type":408,"value":1026},{"type":402,"tag":443,"props":1097,"children":1098},{"style":1029},[1099],{"type":408,"value":1100}," matchComment",{"type":402,"tag":443,"props":1102,"children":1103},{"style":471},[1104],{"type":408,"value":1037},{"type":402,"tag":443,"props":1106,"children":1107},{"style":471},[1108],{"type":408,"value":474},{"type":402,"tag":443,"props":1110,"children":1111},{"class":445,"line":545},[1112],{"type":402,"tag":443,"props":1113,"children":1114},{"style":450},[1115],{"type":408,"value":1116},"    // 快速跳过非注释部分代码\n",{"type":402,"tag":443,"props":1118,"children":1119},{"class":445,"line":554},[1120,1125,1129,1133,1137,1142,1146,1151,1156,1161,1166,1171,1176,1181,1185,1190,1195,1199,1203,1207,1211,1215,1219,1223,1227,1231,1236,1240,1244],{"type":402,"tag":443,"props":1121,"children":1122},{"style":1047},[1123],{"type":408,"value":1124},"    if",{"type":402,"tag":443,"props":1126,"children":1127},{"style":1053},[1128],{"type":408,"value":1056},{"type":402,"tag":443,"props":1130,"children":1131},{"style":1059},[1132],{"type":408,"value":1062},{"type":402,"tag":443,"props":1134,"children":1135},{"style":471},[1136],{"type":408,"value":463},{"type":402,"tag":443,"props":1138,"children":1139},{"style":507},[1140],{"type":408,"value":1141},"cssText",{"type":402,"tag":443,"props":1143,"children":1144},{"style":471},[1145],{"type":408,"value":463},{"type":402,"tag":443,"props":1147,"children":1148},{"style":1069},[1149],{"type":408,"value":1150},"charAt",{"type":402,"tag":443,"props":1152,"children":1153},{"style":1053},[1154],{"type":408,"value":1155},"(",{"type":402,"tag":443,"props":1157,"children":1158},{"style":492},[1159],{"type":408,"value":1160},"0",{"type":402,"tag":443,"props":1162,"children":1163},{"style":1053},[1164],{"type":408,"value":1165},") ",{"type":402,"tag":443,"props":1167,"children":1168},{"style":603},[1169],{"type":408,"value":1170},"!==",{"type":402,"tag":443,"props":1172,"children":1173},{"style":609},[1174],{"type":408,"value":1175}," \"",{"type":402,"tag":443,"props":1177,"children":1178},{"style":615},[1179],{"type":408,"value":1180},"/",{"type":402,"tag":443,"props":1182,"children":1183},{"style":609},[1184],{"type":408,"value":612},{"type":402,"tag":443,"props":1186,"children":1187},{"style":603},[1188],{"type":408,"value":1189}," ||",{"type":402,"tag":443,"props":1191,"children":1192},{"style":1059},[1193],{"type":408,"value":1194}," this",{"type":402,"tag":443,"props":1196,"children":1197},{"style":471},[1198],{"type":408,"value":463},{"type":402,"tag":443,"props":1200,"children":1201},{"style":507},[1202],{"type":408,"value":1141},{"type":402,"tag":443,"props":1204,"children":1205},{"style":471},[1206],{"type":408,"value":463},{"type":402,"tag":443,"props":1208,"children":1209},{"style":1069},[1210],{"type":408,"value":1150},{"type":402,"tag":443,"props":1212,"children":1213},{"style":1053},[1214],{"type":408,"value":1155},{"type":402,"tag":443,"props":1216,"children":1217},{"style":492},[1218],{"type":408,"value":926},{"type":402,"tag":443,"props":1220,"children":1221},{"style":1053},[1222],{"type":408,"value":1165},{"type":402,"tag":443,"props":1224,"children":1225},{"style":603},[1226],{"type":408,"value":1170},{"type":402,"tag":443,"props":1228,"children":1229},{"style":609},[1230],{"type":408,"value":1175},{"type":402,"tag":443,"props":1232,"children":1233},{"style":615},[1234],{"type":408,"value":1235},"*",{"type":402,"tag":443,"props":1237,"children":1238},{"style":609},[1239],{"type":408,"value":612},{"type":402,"tag":443,"props":1241,"children":1242},{"style":1053},[1243],{"type":408,"value":1165},{"type":402,"tag":443,"props":1245,"children":1246},{"style":471},[1247],{"type":408,"value":1248},"{\n",{"type":402,"tag":443,"props":1250,"children":1251},{"class":445,"line":563},[1252,1257,1263],{"type":402,"tag":443,"props":1253,"children":1254},{"style":1047},[1255],{"type":408,"value":1256},"      return",{"type":402,"tag":443,"props":1258,"children":1260},{"style":1259},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1261],{"type":408,"value":1262}," false",{"type":402,"tag":443,"props":1264,"children":1265},{"style":471},[1266],{"type":408,"value":500},{"type":402,"tag":443,"props":1268,"children":1269},{"class":445,"line":573},[1270],{"type":402,"tag":443,"props":1271,"children":1272},{"style":471},[1273],{"type":408,"value":1274},"    }\n",{"type":402,"tag":443,"props":1276,"children":1277},{"class":445,"line":582},[1278],{"type":402,"tag":443,"props":1279,"children":1280},{"style":450},[1281],{"type":408,"value":1282},"    // ...\n",{"type":402,"tag":443,"props":1284,"children":1285},{"class":445,"line":643},[1286,1291,1296],{"type":402,"tag":443,"props":1287,"children":1288},{"style":1047},[1289],{"type":408,"value":1290},"    return",{"type":402,"tag":443,"props":1292,"children":1293},{"style":1259},[1294],{"type":408,"value":1295}," true",{"type":402,"tag":443,"props":1297,"children":1298},{"style":471},[1299],{"type":408,"value":500},{"type":402,"tag":443,"props":1301,"children":1302},{"class":445,"line":663},[1303],{"type":402,"tag":443,"props":1304,"children":1305},{"style":471},[1306],{"type":408,"value":551},{"type":402,"tag":443,"props":1308,"children":1309},{"class":445,"line":679},[1310],{"type":402,"tag":443,"props":1311,"children":1312},{"style":471},[1313],{"type":408,"value":560},{"type":402,"tag":410,"props":1315,"children":1316},{},[1317],{"type":408,"value":1318},"在选择解析注释内容的方法上，micro-app 没有使用正则，而是用了下标递增的办法。暂不清楚原因，感兴趣的小伙伴可以试试几种相关办法的性能对比。",{"type":402,"tag":432,"props":1320,"children":1322},{"className":992,"code":1321,"language":994,"meta":396,"style":396},"let i = 2;\nwhile (\n  this.cssText.charAt(i) !== \"\" &&\n  (this.cssText.charAt(i) !== \"*\" || this.cssText.charAt(i + 1) !== \"/\")\n) {\n  ++i;\n}\ni += 2;\n\nlet commentText = this.cssText.slice(2, i - 2);\n/* ... */\nthis.cssText = this.cssText.slice(i);\n",[1323],{"type":402,"tag":439,"props":1324,"children":1325},{"__ignoreMap":396},[1326,1351,1364,1407,1518,1529,1546,1553,1574,1581,1654,1662],{"type":402,"tag":443,"props":1327,"children":1328},{"class":445,"line":446},[1329,1334,1339,1343,1347],{"type":402,"tag":443,"props":1330,"children":1331},{"style":1004},[1332],{"type":408,"value":1333},"let",{"type":402,"tag":443,"props":1335,"children":1336},{"style":507},[1337],{"type":408,"value":1338}," i ",{"type":402,"tag":443,"props":1340,"children":1341},{"style":603},[1342],{"type":408,"value":606},{"type":402,"tag":443,"props":1344,"children":1345},{"style":492},[1346],{"type":408,"value":538},{"type":402,"tag":443,"props":1348,"children":1349},{"style":471},[1350],{"type":408,"value":500},{"type":402,"tag":443,"props":1352,"children":1353},{"class":445,"line":456},[1354,1359],{"type":402,"tag":443,"props":1355,"children":1356},{"style":1047},[1357],{"type":408,"value":1358},"while",{"type":402,"tag":443,"props":1360,"children":1361},{"style":507},[1362],{"type":408,"value":1363}," (\n",{"type":402,"tag":443,"props":1365,"children":1366},{"class":445,"line":477},[1367,1372,1376,1380,1384,1388,1393,1397,1402],{"type":402,"tag":443,"props":1368,"children":1369},{"style":1059},[1370],{"type":408,"value":1371},"  this",{"type":402,"tag":443,"props":1373,"children":1374},{"style":471},[1375],{"type":408,"value":463},{"type":402,"tag":443,"props":1377,"children":1378},{"style":507},[1379],{"type":408,"value":1141},{"type":402,"tag":443,"props":1381,"children":1382},{"style":471},[1383],{"type":408,"value":463},{"type":402,"tag":443,"props":1385,"children":1386},{"style":1069},[1387],{"type":408,"value":1150},{"type":402,"tag":443,"props":1389,"children":1390},{"style":507},[1391],{"type":408,"value":1392},"(i) ",{"type":402,"tag":443,"props":1394,"children":1395},{"style":603},[1396],{"type":408,"value":1170},{"type":402,"tag":443,"props":1398,"children":1399},{"style":609},[1400],{"type":408,"value":1401}," \"\"",{"type":402,"tag":443,"props":1403,"children":1404},{"style":603},[1405],{"type":408,"value":1406}," &&\n",{"type":402,"tag":443,"props":1408,"children":1409},{"class":445,"line":503},[1410,1415,1419,1423,1427,1431,1435,1439,1443,1447,1451,1455,1459,1463,1467,1471,1475,1479,1484,1489,1493,1497,1501,1505,1509,1513],{"type":402,"tag":443,"props":1411,"children":1412},{"style":507},[1413],{"type":408,"value":1414},"  (",{"type":402,"tag":443,"props":1416,"children":1417},{"style":1059},[1418],{"type":408,"value":1062},{"type":402,"tag":443,"props":1420,"children":1421},{"style":471},[1422],{"type":408,"value":463},{"type":402,"tag":443,"props":1424,"children":1425},{"style":507},[1426],{"type":408,"value":1141},{"type":402,"tag":443,"props":1428,"children":1429},{"style":471},[1430],{"type":408,"value":463},{"type":402,"tag":443,"props":1432,"children":1433},{"style":1069},[1434],{"type":408,"value":1150},{"type":402,"tag":443,"props":1436,"children":1437},{"style":507},[1438],{"type":408,"value":1392},{"type":402,"tag":443,"props":1440,"children":1441},{"style":603},[1442],{"type":408,"value":1170},{"type":402,"tag":443,"props":1444,"children":1445},{"style":609},[1446],{"type":408,"value":1175},{"type":402,"tag":443,"props":1448,"children":1449},{"style":615},[1450],{"type":408,"value":1235},{"type":402,"tag":443,"props":1452,"children":1453},{"style":609},[1454],{"type":408,"value":612},{"type":402,"tag":443,"props":1456,"children":1457},{"style":603},[1458],{"type":408,"value":1189},{"type":402,"tag":443,"props":1460,"children":1461},{"style":1059},[1462],{"type":408,"value":1194},{"type":402,"tag":443,"props":1464,"children":1465},{"style":471},[1466],{"type":408,"value":463},{"type":402,"tag":443,"props":1468,"children":1469},{"style":507},[1470],{"type":408,"value":1141},{"type":402,"tag":443,"props":1472,"children":1473},{"style":471},[1474],{"type":408,"value":463},{"type":402,"tag":443,"props":1476,"children":1477},{"style":1069},[1478],{"type":408,"value":1150},{"type":402,"tag":443,"props":1480,"children":1481},{"style":507},[1482],{"type":408,"value":1483},"(i ",{"type":402,"tag":443,"props":1485,"children":1486},{"style":603},[1487],{"type":408,"value":1488},"+",{"type":402,"tag":443,"props":1490,"children":1491},{"style":492},[1492],{"type":408,"value":495},{"type":402,"tag":443,"props":1494,"children":1495},{"style":507},[1496],{"type":408,"value":1165},{"type":402,"tag":443,"props":1498,"children":1499},{"style":603},[1500],{"type":408,"value":1170},{"type":402,"tag":443,"props":1502,"children":1503},{"style":609},[1504],{"type":408,"value":1175},{"type":402,"tag":443,"props":1506,"children":1507},{"style":615},[1508],{"type":408,"value":1180},{"type":402,"tag":443,"props":1510,"children":1511},{"style":609},[1512],{"type":408,"value":612},{"type":402,"tag":443,"props":1514,"children":1515},{"style":507},[1516],{"type":408,"value":1517},")\n",{"type":402,"tag":443,"props":1519,"children":1520},{"class":445,"line":523},[1521,1525],{"type":402,"tag":443,"props":1522,"children":1523},{"style":507},[1524],{"type":408,"value":1165},{"type":402,"tag":443,"props":1526,"children":1527},{"style":471},[1528],{"type":408,"value":1248},{"type":402,"tag":443,"props":1530,"children":1531},{"class":445,"line":545},[1532,1537,1542],{"type":402,"tag":443,"props":1533,"children":1534},{"style":603},[1535],{"type":408,"value":1536},"  ++",{"type":402,"tag":443,"props":1538,"children":1539},{"style":507},[1540],{"type":408,"value":1541},"i",{"type":402,"tag":443,"props":1543,"children":1544},{"style":471},[1545],{"type":408,"value":500},{"type":402,"tag":443,"props":1547,"children":1548},{"class":445,"line":554},[1549],{"type":402,"tag":443,"props":1550,"children":1551},{"style":471},[1552],{"type":408,"value":560},{"type":402,"tag":443,"props":1554,"children":1555},{"class":445,"line":563},[1556,1561,1566,1570],{"type":402,"tag":443,"props":1557,"children":1558},{"style":507},[1559],{"type":408,"value":1560},"i ",{"type":402,"tag":443,"props":1562,"children":1563},{"style":603},[1564],{"type":408,"value":1565},"+=",{"type":402,"tag":443,"props":1567,"children":1568},{"style":492},[1569],{"type":408,"value":538},{"type":402,"tag":443,"props":1571,"children":1572},{"style":471},[1573],{"type":408,"value":500},{"type":402,"tag":443,"props":1575,"children":1576},{"class":445,"line":573},[1577],{"type":402,"tag":443,"props":1578,"children":1579},{"emptyLinePlaceholder":567},[1580],{"type":408,"value":570},{"type":402,"tag":443,"props":1582,"children":1583},{"class":445,"line":582},[1584,1588,1593,1597,1601,1605,1609,1613,1618,1622,1627,1632,1636,1641,1645,1650],{"type":402,"tag":443,"props":1585,"children":1586},{"style":1004},[1587],{"type":408,"value":1333},{"type":402,"tag":443,"props":1589,"children":1590},{"style":507},[1591],{"type":408,"value":1592}," commentText ",{"type":402,"tag":443,"props":1594,"children":1595},{"style":603},[1596],{"type":408,"value":606},{"type":402,"tag":443,"props":1598,"children":1599},{"style":1059},[1600],{"type":408,"value":1194},{"type":402,"tag":443,"props":1602,"children":1603},{"style":471},[1604],{"type":408,"value":463},{"type":402,"tag":443,"props":1606,"children":1607},{"style":507},[1608],{"type":408,"value":1141},{"type":402,"tag":443,"props":1610,"children":1611},{"style":471},[1612],{"type":408,"value":463},{"type":402,"tag":443,"props":1614,"children":1615},{"style":1069},[1616],{"type":408,"value":1617},"slice",{"type":402,"tag":443,"props":1619,"children":1620},{"style":507},[1621],{"type":408,"value":1155},{"type":402,"tag":443,"props":1623,"children":1624},{"style":492},[1625],{"type":408,"value":1626},"2",{"type":402,"tag":443,"props":1628,"children":1629},{"style":471},[1630],{"type":408,"value":1631},",",{"type":402,"tag":443,"props":1633,"children":1634},{"style":507},[1635],{"type":408,"value":1338},{"type":402,"tag":443,"props":1637,"children":1638},{"style":603},[1639],{"type":408,"value":1640},"-",{"type":402,"tag":443,"props":1642,"children":1643},{"style":492},[1644],{"type":408,"value":538},{"type":402,"tag":443,"props":1646,"children":1647},{"style":507},[1648],{"type":408,"value":1649},")",{"type":402,"tag":443,"props":1651,"children":1652},{"style":471},[1653],{"type":408,"value":500},{"type":402,"tag":443,"props":1655,"children":1656},{"class":445,"line":643},[1657],{"type":402,"tag":443,"props":1658,"children":1659},{"style":450},[1660],{"type":408,"value":1661},"/* ... */\n",{"type":402,"tag":443,"props":1663,"children":1664},{"class":445,"line":663},[1665,1669,1673,1678,1682,1686,1690,1694,1698,1702,1707],{"type":402,"tag":443,"props":1666,"children":1667},{"style":1059},[1668],{"type":408,"value":1062},{"type":402,"tag":443,"props":1670,"children":1671},{"style":471},[1672],{"type":408,"value":463},{"type":402,"tag":443,"props":1674,"children":1675},{"style":507},[1676],{"type":408,"value":1677},"cssText ",{"type":402,"tag":443,"props":1679,"children":1680},{"style":603},[1681],{"type":408,"value":606},{"type":402,"tag":443,"props":1683,"children":1684},{"style":1059},[1685],{"type":408,"value":1194},{"type":402,"tag":443,"props":1687,"children":1688},{"style":471},[1689],{"type":408,"value":463},{"type":402,"tag":443,"props":1691,"children":1692},{"style":507},[1693],{"type":408,"value":1141},{"type":402,"tag":443,"props":1695,"children":1696},{"style":471},[1697],{"type":408,"value":463},{"type":402,"tag":443,"props":1699,"children":1700},{"style":1069},[1701],{"type":408,"value":1617},{"type":402,"tag":443,"props":1703,"children":1704},{"style":507},[1705],{"type":408,"value":1706},"(i)",{"type":402,"tag":443,"props":1708,"children":1709},{"style":471},[1710],{"type":408,"value":500},{"type":402,"tag":410,"props":1712,"children":1713},{},[1714,1716,1722,1724,1729,1731,1737],{"type":408,"value":1715},"注释的正文结果保存在了变量 ",{"type":402,"tag":439,"props":1717,"children":1719},{"className":1718},[],[1720],{"type":408,"value":1721},"commentText",{"type":408,"value":1723}," 中，这样可以判断 ",{"type":402,"tag":439,"props":1725,"children":1727},{"className":1726},[],[1728],{"type":408,"value":1721},{"type":408,"value":1730}," 的内容来实现通过注释禁用某个选择器、禁用某行的样式隔离之类的功能。比如想让 ",{"type":402,"tag":439,"props":1732,"children":1734},{"className":1733},[],[1735],{"type":408,"value":1736},".test2",{"type":408,"value":1738}," 选择器不被 scoped 规则覆盖，我们可以在业务代码中这样写。",{"type":402,"tag":432,"props":1740,"children":1742},{"className":434,"code":1741,"language":436,"meta":396,"style":396},"/*! scopecss-disable-next-line */\n.test2 {\n  background: url(/test.png);\n}\n",[1743],{"type":402,"tag":439,"props":1744,"children":1745},{"__ignoreMap":396},[1746,1754,1770,1803],{"type":402,"tag":443,"props":1747,"children":1748},{"class":445,"line":446},[1749],{"type":402,"tag":443,"props":1750,"children":1751},{"style":450},[1752],{"type":408,"value":1753},"/*! scopecss-disable-next-line */\n",{"type":402,"tag":443,"props":1755,"children":1756},{"class":445,"line":456},[1757,1761,1766],{"type":402,"tag":443,"props":1758,"children":1759},{"style":460},[1760],{"type":408,"value":463},{"type":402,"tag":443,"props":1762,"children":1763},{"style":466},[1764],{"type":408,"value":1765},"test2",{"type":402,"tag":443,"props":1767,"children":1768},{"style":471},[1769],{"type":408,"value":474},{"type":402,"tag":443,"props":1771,"children":1772},{"class":445,"line":477},[1773,1778,1782,1788,1792,1798],{"type":402,"tag":443,"props":1774,"children":1775},{"style":481},[1776],{"type":408,"value":1777},"  background",{"type":402,"tag":443,"props":1779,"children":1780},{"style":471},[1781],{"type":408,"value":489},{"type":402,"tag":443,"props":1783,"children":1785},{"style":1784},"--shiki-light:#6182B8;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF",[1786],{"type":408,"value":1787}," url",{"type":402,"tag":443,"props":1789,"children":1790},{"style":471},[1791],{"type":408,"value":1155},{"type":402,"tag":443,"props":1793,"children":1795},{"style":1794},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[1796],{"type":408,"value":1797},"/test.png",{"type":402,"tag":443,"props":1799,"children":1800},{"style":471},[1801],{"type":408,"value":1802},");\n",{"type":402,"tag":443,"props":1804,"children":1805},{"class":445,"line":503},[1806],{"type":402,"tag":443,"props":1807,"children":1808},{"style":471},[1809],{"type":408,"value":560},{"type":402,"tag":957,"props":1811,"children":1813},{"id":1812},"输入输出",[1814],{"type":408,"value":1812},{"type":402,"tag":410,"props":1816,"children":1817},{},[1818,1820,1825,1827,1833],{"type":408,"value":1819},"“解析注释”中“解析”实际指对输入的 CSS 源文件待处理部分以及处理好的输出部分做出改变。这里引申出解析器里两个关键状态，",{"type":402,"tag":439,"props":1821,"children":1823},{"className":1822},[],[1824],{"type":408,"value":1141},{"type":408,"value":1826}," 和 ",{"type":402,"tag":439,"props":1828,"children":1830},{"className":1829},[],[1831],{"type":408,"value":1832},"result",{"type":408,"value":1834},"，分别代表待解析的内容和最终输出结果。",{"type":402,"tag":410,"props":1836,"children":1837},{},[1838,1843,1845,1850,1852,1858],{"type":402,"tag":439,"props":1839,"children":1841},{"className":1840},[],[1842],{"type":408,"value":1141},{"type":408,"value":1844}," 随着循环应当逐渐减小直到为空，此时代表解析完成。",{"type":402,"tag":439,"props":1846,"children":1848},{"className":1847},[],[1849],{"type":408,"value":1832},{"type":408,"value":1851}," 能被内部方法 ",{"type":402,"tag":439,"props":1853,"children":1855},{"className":1854},[],[1856],{"type":408,"value":1857},"recordResult",{"type":408,"value":1859}," 改变，比如如果要把注释的正文内容记录到输出结果，可以这样使用：",{"type":402,"tag":432,"props":1861,"children":1863},{"className":992,"code":1862,"language":994,"meta":396,"style":396},"this.recordResult(`/*${commentText}*/`);\n// 相当于：this.result += `/*${commentText}*/`\n",[1864],{"type":402,"tag":439,"props":1865,"children":1866},{"__ignoreMap":396},[1867,1928],{"type":402,"tag":443,"props":1868,"children":1869},{"class":445,"line":446},[1870,1874,1878,1882,1886,1891,1896,1902,1906,1911,1916,1920,1924],{"type":402,"tag":443,"props":1871,"children":1872},{"style":1059},[1873],{"type":408,"value":1062},{"type":402,"tag":443,"props":1875,"children":1876},{"style":471},[1877],{"type":408,"value":463},{"type":402,"tag":443,"props":1879,"children":1880},{"style":1069},[1881],{"type":408,"value":1857},{"type":402,"tag":443,"props":1883,"children":1884},{"style":507},[1885],{"type":408,"value":1155},{"type":402,"tag":443,"props":1887,"children":1888},{"style":609},[1889],{"type":408,"value":1890},"`",{"type":402,"tag":443,"props":1892,"children":1893},{"style":615},[1894],{"type":408,"value":1895},"/*",{"type":402,"tag":443,"props":1897,"children":1899},{"style":1898},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#F92672",[1900],{"type":408,"value":1901},"${",{"type":402,"tag":443,"props":1903,"children":1904},{"style":507},[1905],{"type":408,"value":1721},{"type":402,"tag":443,"props":1907,"children":1908},{"style":1898},[1909],{"type":408,"value":1910},"}",{"type":402,"tag":443,"props":1912,"children":1913},{"style":615},[1914],{"type":408,"value":1915},"*/",{"type":402,"tag":443,"props":1917,"children":1918},{"style":609},[1919],{"type":408,"value":1890},{"type":402,"tag":443,"props":1921,"children":1922},{"style":507},[1923],{"type":408,"value":1649},{"type":402,"tag":443,"props":1925,"children":1926},{"style":471},[1927],{"type":408,"value":500},{"type":402,"tag":443,"props":1929,"children":1930},{"class":445,"line":456},[1931],{"type":402,"tag":443,"props":1932,"children":1933},{"style":450},[1934],{"type":408,"value":1935},"// 相当于：this.result += `/*${commentText}*/`\n",{"type":402,"tag":957,"props":1937,"children":1939},{"id":1938},"解析规则集",[1940],{"type":408,"value":1938},{"type":402,"tag":410,"props":1942,"children":1943},{},[1944],{"type":408,"value":1945},"规则集的解析是整个解析的核心过程。原理与解析注释类似，也是一个 while 循环。每一轮循环都会尝试匹配一条规则，并且将多余的注释和空白字符匹配出来。",{"type":402,"tag":432,"props":1947,"children":1949},{"className":992,"code":1948,"language":994,"meta":396,"style":396},"private matchRules (): void {\n  this.matchLeadingSpaces()\n  this.matchComments()\n  while (\n    this.cssText.length &&\n    this.cssText.charAt(0) !== '}' &&\n    (this.matchAtRule() || this.matchStyleRule())\n  ) {\n    this.matchComments()\n    this.matchLeadingSpaces()\n  }\n}\n",[1950],{"type":402,"tag":439,"props":1951,"children":1952},{"__ignoreMap":396},[1953,1980,2001,2021,2033,2062,2119,2168,2180,2199,2218,2225],{"type":402,"tag":443,"props":1954,"children":1955},{"class":445,"line":446},[1956,1961,1966,1971,1976],{"type":402,"tag":443,"props":1957,"children":1958},{"style":507},[1959],{"type":408,"value":1960},"private ",{"type":402,"tag":443,"props":1962,"children":1963},{"style":1069},[1964],{"type":408,"value":1965},"matchRules",{"type":402,"tag":443,"props":1967,"children":1968},{"style":507},[1969],{"type":408,"value":1970}," (): ",{"type":402,"tag":443,"props":1972,"children":1973},{"style":603},[1974],{"type":408,"value":1975},"void",{"type":402,"tag":443,"props":1977,"children":1978},{"style":471},[1979],{"type":408,"value":474},{"type":402,"tag":443,"props":1981,"children":1982},{"class":445,"line":456},[1983,1987,1991,1996],{"type":402,"tag":443,"props":1984,"children":1985},{"style":1059},[1986],{"type":408,"value":1371},{"type":402,"tag":443,"props":1988,"children":1989},{"style":471},[1990],{"type":408,"value":463},{"type":402,"tag":443,"props":1992,"children":1993},{"style":1069},[1994],{"type":408,"value":1995},"matchLeadingSpaces",{"type":402,"tag":443,"props":1997,"children":1998},{"style":1053},[1999],{"type":408,"value":2000},"()\n",{"type":402,"tag":443,"props":2002,"children":2003},{"class":445,"line":477},[2004,2008,2012,2017],{"type":402,"tag":443,"props":2005,"children":2006},{"style":1059},[2007],{"type":408,"value":1371},{"type":402,"tag":443,"props":2009,"children":2010},{"style":471},[2011],{"type":408,"value":463},{"type":402,"tag":443,"props":2013,"children":2014},{"style":1069},[2015],{"type":408,"value":2016},"matchComments",{"type":402,"tag":443,"props":2018,"children":2019},{"style":1053},[2020],{"type":408,"value":2000},{"type":402,"tag":443,"props":2022,"children":2023},{"class":445,"line":503},[2024,2029],{"type":402,"tag":443,"props":2025,"children":2026},{"style":1047},[2027],{"type":408,"value":2028},"  while",{"type":402,"tag":443,"props":2030,"children":2031},{"style":1053},[2032],{"type":408,"value":1363},{"type":402,"tag":443,"props":2034,"children":2035},{"class":445,"line":523},[2036,2041,2045,2049,2053,2058],{"type":402,"tag":443,"props":2037,"children":2038},{"style":1059},[2039],{"type":408,"value":2040},"    this",{"type":402,"tag":443,"props":2042,"children":2043},{"style":471},[2044],{"type":408,"value":463},{"type":402,"tag":443,"props":2046,"children":2047},{"style":507},[2048],{"type":408,"value":1141},{"type":402,"tag":443,"props":2050,"children":2051},{"style":471},[2052],{"type":408,"value":463},{"type":402,"tag":443,"props":2054,"children":2055},{"style":513},[2056],{"type":408,"value":2057},"length",{"type":402,"tag":443,"props":2059,"children":2060},{"style":603},[2061],{"type":408,"value":1406},{"type":402,"tag":443,"props":2063,"children":2064},{"class":445,"line":545},[2065,2069,2073,2077,2081,2085,2089,2093,2097,2101,2106,2110,2115],{"type":402,"tag":443,"props":2066,"children":2067},{"style":1059},[2068],{"type":408,"value":2040},{"type":402,"tag":443,"props":2070,"children":2071},{"style":471},[2072],{"type":408,"value":463},{"type":402,"tag":443,"props":2074,"children":2075},{"style":507},[2076],{"type":408,"value":1141},{"type":402,"tag":443,"props":2078,"children":2079},{"style":471},[2080],{"type":408,"value":463},{"type":402,"tag":443,"props":2082,"children":2083},{"style":1069},[2084],{"type":408,"value":1150},{"type":402,"tag":443,"props":2086,"children":2087},{"style":1053},[2088],{"type":408,"value":1155},{"type":402,"tag":443,"props":2090,"children":2091},{"style":492},[2092],{"type":408,"value":1160},{"type":402,"tag":443,"props":2094,"children":2095},{"style":1053},[2096],{"type":408,"value":1165},{"type":402,"tag":443,"props":2098,"children":2099},{"style":603},[2100],{"type":408,"value":1170},{"type":402,"tag":443,"props":2102,"children":2103},{"style":609},[2104],{"type":408,"value":2105}," '",{"type":402,"tag":443,"props":2107,"children":2108},{"style":615},[2109],{"type":408,"value":1910},{"type":402,"tag":443,"props":2111,"children":2112},{"style":609},[2113],{"type":408,"value":2114},"'",{"type":402,"tag":443,"props":2116,"children":2117},{"style":603},[2118],{"type":408,"value":1406},{"type":402,"tag":443,"props":2120,"children":2121},{"class":445,"line":554},[2122,2127,2131,2135,2140,2145,2150,2154,2158,2163],{"type":402,"tag":443,"props":2123,"children":2124},{"style":1053},[2125],{"type":408,"value":2126},"    (",{"type":402,"tag":443,"props":2128,"children":2129},{"style":1059},[2130],{"type":408,"value":1062},{"type":402,"tag":443,"props":2132,"children":2133},{"style":471},[2134],{"type":408,"value":463},{"type":402,"tag":443,"props":2136,"children":2137},{"style":1069},[2138],{"type":408,"value":2139},"matchAtRule",{"type":402,"tag":443,"props":2141,"children":2142},{"style":1053},[2143],{"type":408,"value":2144},"() ",{"type":402,"tag":443,"props":2146,"children":2147},{"style":603},[2148],{"type":408,"value":2149},"||",{"type":402,"tag":443,"props":2151,"children":2152},{"style":1059},[2153],{"type":408,"value":1194},{"type":402,"tag":443,"props":2155,"children":2156},{"style":471},[2157],{"type":408,"value":463},{"type":402,"tag":443,"props":2159,"children":2160},{"style":1069},[2161],{"type":408,"value":2162},"matchStyleRule",{"type":402,"tag":443,"props":2164,"children":2165},{"style":1053},[2166],{"type":408,"value":2167},"())\n",{"type":402,"tag":443,"props":2169,"children":2170},{"class":445,"line":563},[2171,2176],{"type":402,"tag":443,"props":2172,"children":2173},{"style":1053},[2174],{"type":408,"value":2175},"  ) ",{"type":402,"tag":443,"props":2177,"children":2178},{"style":471},[2179],{"type":408,"value":1248},{"type":402,"tag":443,"props":2181,"children":2182},{"class":445,"line":573},[2183,2187,2191,2195],{"type":402,"tag":443,"props":2184,"children":2185},{"style":1059},[2186],{"type":408,"value":2040},{"type":402,"tag":443,"props":2188,"children":2189},{"style":471},[2190],{"type":408,"value":463},{"type":402,"tag":443,"props":2192,"children":2193},{"style":1069},[2194],{"type":408,"value":2016},{"type":402,"tag":443,"props":2196,"children":2197},{"style":1053},[2198],{"type":408,"value":2000},{"type":402,"tag":443,"props":2200,"children":2201},{"class":445,"line":582},[2202,2206,2210,2214],{"type":402,"tag":443,"props":2203,"children":2204},{"style":1059},[2205],{"type":408,"value":2040},{"type":402,"tag":443,"props":2207,"children":2208},{"style":471},[2209],{"type":408,"value":463},{"type":402,"tag":443,"props":2211,"children":2212},{"style":1069},[2213],{"type":408,"value":1995},{"type":402,"tag":443,"props":2215,"children":2216},{"style":1053},[2217],{"type":408,"value":2000},{"type":402,"tag":443,"props":2219,"children":2220},{"class":445,"line":643},[2221],{"type":402,"tag":443,"props":2222,"children":2223},{"style":471},[2224],{"type":408,"value":551},{"type":402,"tag":443,"props":2226,"children":2227},{"class":445,"line":663},[2228],{"type":402,"tag":443,"props":2229,"children":2230},{"style":471},[2231],{"type":408,"value":560},{"type":402,"tag":410,"props":2233,"children":2234},{},[2235,2237,2242],{"type":408,"value":2236},"匹配注释我们知道它是使用了下标递增 + Slice 的方法，匹配空白这里则是用的一个非常简单的正则。见下 ",{"type":402,"tag":439,"props":2238,"children":2240},{"className":2239},[],[2241],{"type":408,"value":1995},{"type":408,"value":2243}," 函数。",{"type":402,"tag":432,"props":2245,"children":2247},{"className":992,"code":2246,"language":994,"meta":396,"style":396},"private matchLeadingSpaces (): void {\n  this.commonMatch(/^\\s*/, false)\n}\n",[2248],{"type":402,"tag":439,"props":2249,"children":2250},{"__ignoreMap":396},[2251,2274,2329],{"type":402,"tag":443,"props":2252,"children":2253},{"class":445,"line":446},[2254,2258,2262,2266,2270],{"type":402,"tag":443,"props":2255,"children":2256},{"style":507},[2257],{"type":408,"value":1960},{"type":402,"tag":443,"props":2259,"children":2260},{"style":1069},[2261],{"type":408,"value":1995},{"type":402,"tag":443,"props":2263,"children":2264},{"style":507},[2265],{"type":408,"value":1970},{"type":402,"tag":443,"props":2267,"children":2268},{"style":603},[2269],{"type":408,"value":1975},{"type":402,"tag":443,"props":2271,"children":2272},{"style":471},[2273],{"type":408,"value":474},{"type":402,"tag":443,"props":2275,"children":2276},{"class":445,"line":456},[2277,2281,2285,2290,2294,2298,2303,2309,2313,2317,2321,2325],{"type":402,"tag":443,"props":2278,"children":2279},{"style":1059},[2280],{"type":408,"value":1371},{"type":402,"tag":443,"props":2282,"children":2283},{"style":471},[2284],{"type":408,"value":463},{"type":402,"tag":443,"props":2286,"children":2287},{"style":1069},[2288],{"type":408,"value":2289},"commonMatch",{"type":402,"tag":443,"props":2291,"children":2292},{"style":1053},[2293],{"type":408,"value":1155},{"type":402,"tag":443,"props":2295,"children":2296},{"style":609},[2297],{"type":408,"value":1180},{"type":402,"tag":443,"props":2299,"children":2300},{"style":1047},[2301],{"type":408,"value":2302},"^",{"type":402,"tag":443,"props":2304,"children":2306},{"style":2305},"--shiki-light:#91B859;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2307],{"type":408,"value":2308},"\\s",{"type":402,"tag":443,"props":2310,"children":2311},{"style":603},[2312],{"type":408,"value":1235},{"type":402,"tag":443,"props":2314,"children":2315},{"style":609},[2316],{"type":408,"value":1180},{"type":402,"tag":443,"props":2318,"children":2319},{"style":471},[2320],{"type":408,"value":1631},{"type":402,"tag":443,"props":2322,"children":2323},{"style":1259},[2324],{"type":408,"value":1262},{"type":402,"tag":443,"props":2326,"children":2327},{"style":1053},[2328],{"type":408,"value":1517},{"type":402,"tag":443,"props":2330,"children":2331},{"class":445,"line":477},[2332],{"type":402,"tag":443,"props":2333,"children":2334},{"style":471},[2335],{"type":408,"value":560},{"type":402,"tag":410,"props":2337,"children":2338},{},[2339,2341,2346,2348,2353,2354,2359,2361,2366,2368,2373],{"type":408,"value":2340},"可以想象，",{"type":402,"tag":439,"props":2342,"children":2344},{"className":2343},[],[2345],{"type":408,"value":2289},{"type":408,"value":2347}," 应当会对状态 ",{"type":402,"tag":439,"props":2349,"children":2351},{"className":2350},[],[2352],{"type":408,"value":1141},{"type":408,"value":1826},{"type":402,"tag":439,"props":2355,"children":2357},{"className":2356},[],[2358],{"type":408,"value":1832},{"type":408,"value":2360}," 做一些操作。实际上，commonMatch 两个参数分别是用于匹配 ",{"type":402,"tag":439,"props":2362,"children":2364},{"className":2363},[],[2365],{"type":408,"value":1141},{"type":408,"value":2367}," 的正则，及跳过标记。如果在待匹配内容中匹配到了字符串，便把匹配的内容从中移除；跳过标记则意味着当确认跳过时，匹配的内容将不会被记录到输出结果中。以上面的 ",{"type":402,"tag":439,"props":2369,"children":2371},{"className":2370},[],[2372],{"type":408,"value":1995},{"type":408,"value":2374}," 函数举例，如果在待匹配内容中匹配到空白字符，那么会将其丢弃不做处理。",{"type":402,"tag":410,"props":2376,"children":2377},{},[2378,2383,2385,2390],{"type":402,"tag":439,"props":2379,"children":2381},{"className":2380},[],[2382],{"type":408,"value":2289},{"type":408,"value":2384}," 可谓是解析器匹配逻辑的核心，只要理解了它，那么我们回到上面提到的样式规则匹配 ",{"type":402,"tag":439,"props":2386,"children":2388},{"className":2387},[],[2389],{"type":408,"value":2162},{"type":408,"value":2391},"，会发现其过程非常简单。简单来说只有三步，匹配选择器、记录解析后的选择器、解析（并记录）声明。结束条件只有成功解析以及选择器解析报错或声明解析报错。",{"type":402,"tag":432,"props":2393,"children":2395},{"className":992,"code":2394,"language":994,"meta":396,"style":396},"private matchStyleRule (): boolean | void {\n  const selectors = this.formatSelector(true)\n  this.scopecssDisableNextLine = false\n  if (!selectors) return parseError('selector missing', this.linkPath)\n  this.recordResult(selectors)\n  this.matchComments()\n  this.styleDeclarations()\n  this.matchLeadingSpaces()\n  return true\n}\n",[2396],{"type":402,"tag":439,"props":2397,"children":2398},{"__ignoreMap":396},[2399,2429,2473,2498,2572,2599,2618,2638,2657,2670],{"type":402,"tag":443,"props":2400,"children":2401},{"class":445,"line":446},[2402,2406,2410,2415,2420,2425],{"type":402,"tag":443,"props":2403,"children":2404},{"style":507},[2405],{"type":408,"value":1960},{"type":402,"tag":443,"props":2407,"children":2408},{"style":1069},[2409],{"type":408,"value":2162},{"type":402,"tag":443,"props":2411,"children":2412},{"style":507},[2413],{"type":408,"value":2414}," (): boolean ",{"type":402,"tag":443,"props":2416,"children":2417},{"style":603},[2418],{"type":408,"value":2419},"|",{"type":402,"tag":443,"props":2421,"children":2422},{"style":603},[2423],{"type":408,"value":2424}," void",{"type":402,"tag":443,"props":2426,"children":2427},{"style":471},[2428],{"type":408,"value":474},{"type":402,"tag":443,"props":2430,"children":2431},{"class":445,"line":456},[2432,2437,2442,2447,2451,2455,2460,2464,2469],{"type":402,"tag":443,"props":2433,"children":2434},{"style":1004},[2435],{"type":408,"value":2436},"  const",{"type":402,"tag":443,"props":2438,"children":2439},{"style":513},[2440],{"type":408,"value":2441}," selectors",{"type":402,"tag":443,"props":2443,"children":2444},{"style":603},[2445],{"type":408,"value":2446}," =",{"type":402,"tag":443,"props":2448,"children":2449},{"style":1059},[2450],{"type":408,"value":1194},{"type":402,"tag":443,"props":2452,"children":2453},{"style":471},[2454],{"type":408,"value":463},{"type":402,"tag":443,"props":2456,"children":2457},{"style":1069},[2458],{"type":408,"value":2459},"formatSelector",{"type":402,"tag":443,"props":2461,"children":2462},{"style":1053},[2463],{"type":408,"value":1155},{"type":402,"tag":443,"props":2465,"children":2466},{"style":1259},[2467],{"type":408,"value":2468},"true",{"type":402,"tag":443,"props":2470,"children":2471},{"style":1053},[2472],{"type":408,"value":1517},{"type":402,"tag":443,"props":2474,"children":2475},{"class":445,"line":477},[2476,2480,2484,2489,2493],{"type":402,"tag":443,"props":2477,"children":2478},{"style":1059},[2479],{"type":408,"value":1371},{"type":402,"tag":443,"props":2481,"children":2482},{"style":471},[2483],{"type":408,"value":463},{"type":402,"tag":443,"props":2485,"children":2486},{"style":507},[2487],{"type":408,"value":2488},"scopecssDisableNextLine",{"type":402,"tag":443,"props":2490,"children":2491},{"style":603},[2492],{"type":408,"value":2446},{"type":402,"tag":443,"props":2494,"children":2495},{"style":1259},[2496],{"type":408,"value":2497}," false\n",{"type":402,"tag":443,"props":2499,"children":2500},{"class":445,"line":503},[2501,2506,2510,2515,2520,2524,2529,2534,2538,2542,2547,2551,2555,2559,2563,2568],{"type":402,"tag":443,"props":2502,"children":2503},{"style":1047},[2504],{"type":408,"value":2505},"  if",{"type":402,"tag":443,"props":2507,"children":2508},{"style":1053},[2509],{"type":408,"value":1056},{"type":402,"tag":443,"props":2511,"children":2512},{"style":603},[2513],{"type":408,"value":2514},"!",{"type":402,"tag":443,"props":2516,"children":2517},{"style":507},[2518],{"type":408,"value":2519},"selectors",{"type":402,"tag":443,"props":2521,"children":2522},{"style":1053},[2523],{"type":408,"value":1165},{"type":402,"tag":443,"props":2525,"children":2526},{"style":1047},[2527],{"type":408,"value":2528},"return",{"type":402,"tag":443,"props":2530,"children":2531},{"style":1069},[2532],{"type":408,"value":2533}," parseError",{"type":402,"tag":443,"props":2535,"children":2536},{"style":1053},[2537],{"type":408,"value":1155},{"type":402,"tag":443,"props":2539,"children":2540},{"style":609},[2541],{"type":408,"value":2114},{"type":402,"tag":443,"props":2543,"children":2544},{"style":615},[2545],{"type":408,"value":2546},"selector missing",{"type":402,"tag":443,"props":2548,"children":2549},{"style":609},[2550],{"type":408,"value":2114},{"type":402,"tag":443,"props":2552,"children":2553},{"style":471},[2554],{"type":408,"value":1631},{"type":402,"tag":443,"props":2556,"children":2557},{"style":1059},[2558],{"type":408,"value":1194},{"type":402,"tag":443,"props":2560,"children":2561},{"style":471},[2562],{"type":408,"value":463},{"type":402,"tag":443,"props":2564,"children":2565},{"style":507},[2566],{"type":408,"value":2567},"linkPath",{"type":402,"tag":443,"props":2569,"children":2570},{"style":1053},[2571],{"type":408,"value":1517},{"type":402,"tag":443,"props":2573,"children":2574},{"class":445,"line":523},[2575,2579,2583,2587,2591,2595],{"type":402,"tag":443,"props":2576,"children":2577},{"style":1059},[2578],{"type":408,"value":1371},{"type":402,"tag":443,"props":2580,"children":2581},{"style":471},[2582],{"type":408,"value":463},{"type":402,"tag":443,"props":2584,"children":2585},{"style":1069},[2586],{"type":408,"value":1857},{"type":402,"tag":443,"props":2588,"children":2589},{"style":1053},[2590],{"type":408,"value":1155},{"type":402,"tag":443,"props":2592,"children":2593},{"style":507},[2594],{"type":408,"value":2519},{"type":402,"tag":443,"props":2596,"children":2597},{"style":1053},[2598],{"type":408,"value":1517},{"type":402,"tag":443,"props":2600,"children":2601},{"class":445,"line":545},[2602,2606,2610,2614],{"type":402,"tag":443,"props":2603,"children":2604},{"style":1059},[2605],{"type":408,"value":1371},{"type":402,"tag":443,"props":2607,"children":2608},{"style":471},[2609],{"type":408,"value":463},{"type":402,"tag":443,"props":2611,"children":2612},{"style":1069},[2613],{"type":408,"value":2016},{"type":402,"tag":443,"props":2615,"children":2616},{"style":1053},[2617],{"type":408,"value":2000},{"type":402,"tag":443,"props":2619,"children":2620},{"class":445,"line":554},[2621,2625,2629,2634],{"type":402,"tag":443,"props":2622,"children":2623},{"style":1059},[2624],{"type":408,"value":1371},{"type":402,"tag":443,"props":2626,"children":2627},{"style":471},[2628],{"type":408,"value":463},{"type":402,"tag":443,"props":2630,"children":2631},{"style":1069},[2632],{"type":408,"value":2633},"styleDeclarations",{"type":402,"tag":443,"props":2635,"children":2636},{"style":1053},[2637],{"type":408,"value":2000},{"type":402,"tag":443,"props":2639,"children":2640},{"class":445,"line":563},[2641,2645,2649,2653],{"type":402,"tag":443,"props":2642,"children":2643},{"style":1059},[2644],{"type":408,"value":1371},{"type":402,"tag":443,"props":2646,"children":2647},{"style":471},[2648],{"type":408,"value":463},{"type":402,"tag":443,"props":2650,"children":2651},{"style":1069},[2652],{"type":408,"value":1995},{"type":402,"tag":443,"props":2654,"children":2655},{"style":1053},[2656],{"type":408,"value":2000},{"type":402,"tag":443,"props":2658,"children":2659},{"class":445,"line":573},[2660,2665],{"type":402,"tag":443,"props":2661,"children":2662},{"style":1047},[2663],{"type":408,"value":2664},"  return",{"type":402,"tag":443,"props":2666,"children":2667},{"style":1259},[2668],{"type":408,"value":2669}," true\n",{"type":402,"tag":443,"props":2671,"children":2672},{"class":445,"line":582},[2673],{"type":402,"tag":443,"props":2674,"children":2675},{"style":471},[2676],{"type":408,"value":560},{"type":402,"tag":410,"props":2678,"children":2679},{},[2680,2682,2688,2690,2696,2698,2704,2706,2711,2713,2719],{"type":408,"value":2681},"首先是匹配选择器的部分。以 ",{"type":402,"tag":439,"props":2683,"children":2685},{"className":2684},[],[2686],{"type":408,"value":2687},".a,.b{color:red}",{"type":408,"value":2689}," 为例，首先匹配出",{"type":402,"tag":439,"props":2691,"children":2693},{"className":2692},[],[2694],{"type":408,"value":2695},"{",{"type":408,"value":2697},"字符前的部分即",{"type":402,"tag":439,"props":2699,"children":2701},{"className":2700},[],[2702],{"type":408,"value":2703},".a,.b",{"type":408,"value":2705},"作为选择器的正文，然后使用",{"type":402,"tag":439,"props":2707,"children":2709},{"className":2708},[],[2710],{"type":408,"value":1631},{"type":408,"value":2712},"分割选择器，并给选择器加上 prefix，最终返回",{"type":402,"tag":439,"props":2714,"children":2716},{"className":2715},[],[2717],{"type":408,"value":2718},"micro-app[name=\"subapp\"] .a, micro-app[name=\"subapp\"] .b",{"type":408,"value":2720},"。刚才提到可以在业务代码中使用注释给特定选择器禁用 prefix 前缀，相关的代码的实现也在这个函数中。",{"type":402,"tag":432,"props":2722,"children":2724},{"className":992,"code":2723,"language":994,"meta":396,"style":396},"const selectors = this.formatSelector()\n\nprivate formatSelector (skip: boolean): false | string {\n  // 匹配选择器正文\n  const m = this.commonMatch(/^[^{]+/, skip)\n  return m[0].replace(/(^|,[\\n\\s]*)([^,]+)/g, (_, separator, selector) => {\n    // 如果检测到选择器被禁用则跳过添加前缀步骤\n    if (...) {\n      const prefix = this.prefix // micro-app[name=\"subapp\"]\n      selector = prefix + ' ' + selector\n    }\n    return separator + selector\n  })\n}\n",[2725],{"type":402,"tag":439,"props":2726,"children":2727},{"__ignoreMap":396},[2728,2760,2767,2802,2810,2888,3046,3054,3078,3113,3151,3158,3177,3188],{"type":402,"tag":443,"props":2729,"children":2730},{"class":445,"line":446},[2731,2736,2740,2744,2748,2752,2756],{"type":402,"tag":443,"props":2732,"children":2733},{"style":1004},[2734],{"type":408,"value":2735},"const",{"type":402,"tag":443,"props":2737,"children":2738},{"style":513},[2739],{"type":408,"value":2441},{"type":402,"tag":443,"props":2741,"children":2742},{"style":603},[2743],{"type":408,"value":2446},{"type":402,"tag":443,"props":2745,"children":2746},{"style":1059},[2747],{"type":408,"value":1194},{"type":402,"tag":443,"props":2749,"children":2750},{"style":471},[2751],{"type":408,"value":463},{"type":402,"tag":443,"props":2753,"children":2754},{"style":1069},[2755],{"type":408,"value":2459},{"type":402,"tag":443,"props":2757,"children":2758},{"style":507},[2759],{"type":408,"value":2000},{"type":402,"tag":443,"props":2761,"children":2762},{"class":445,"line":456},[2763],{"type":402,"tag":443,"props":2764,"children":2765},{"emptyLinePlaceholder":567},[2766],{"type":408,"value":570},{"type":402,"tag":443,"props":2768,"children":2769},{"class":445,"line":477},[2770,2774,2778,2783,2788,2793,2798],{"type":402,"tag":443,"props":2771,"children":2772},{"style":507},[2773],{"type":408,"value":1960},{"type":402,"tag":443,"props":2775,"children":2776},{"style":1069},[2777],{"type":408,"value":2459},{"type":402,"tag":443,"props":2779,"children":2780},{"style":507},[2781],{"type":408,"value":2782}," (skip: boolean): ",{"type":402,"tag":443,"props":2784,"children":2785},{"style":1259},[2786],{"type":408,"value":2787},"false",{"type":402,"tag":443,"props":2789,"children":2790},{"style":603},[2791],{"type":408,"value":2792}," |",{"type":402,"tag":443,"props":2794,"children":2795},{"style":507},[2796],{"type":408,"value":2797}," string ",{"type":402,"tag":443,"props":2799,"children":2800},{"style":471},[2801],{"type":408,"value":1248},{"type":402,"tag":443,"props":2803,"children":2804},{"class":445,"line":503},[2805],{"type":402,"tag":443,"props":2806,"children":2807},{"style":450},[2808],{"type":408,"value":2809},"  // 匹配选择器正文\n",{"type":402,"tag":443,"props":2811,"children":2812},{"class":445,"line":523},[2813,2817,2822,2826,2830,2834,2838,2842,2846,2850,2855,2859,2863,2867,2871,2875,2879,2884],{"type":402,"tag":443,"props":2814,"children":2815},{"style":1004},[2816],{"type":408,"value":2436},{"type":402,"tag":443,"props":2818,"children":2819},{"style":513},[2820],{"type":408,"value":2821}," m",{"type":402,"tag":443,"props":2823,"children":2824},{"style":603},[2825],{"type":408,"value":2446},{"type":402,"tag":443,"props":2827,"children":2828},{"style":1059},[2829],{"type":408,"value":1194},{"type":402,"tag":443,"props":2831,"children":2832},{"style":471},[2833],{"type":408,"value":463},{"type":402,"tag":443,"props":2835,"children":2836},{"style":1069},[2837],{"type":408,"value":2289},{"type":402,"tag":443,"props":2839,"children":2840},{"style":1053},[2841],{"type":408,"value":1155},{"type":402,"tag":443,"props":2843,"children":2844},{"style":609},[2845],{"type":408,"value":1180},{"type":402,"tag":443,"props":2847,"children":2848},{"style":1047},[2849],{"type":408,"value":2302},{"type":402,"tag":443,"props":2851,"children":2853},{"style":2852},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2854],{"type":408,"value":594},{"type":402,"tag":443,"props":2856,"children":2857},{"style":603},[2858],{"type":408,"value":2302},{"type":402,"tag":443,"props":2860,"children":2861},{"style":2305},[2862],{"type":408,"value":2695},{"type":402,"tag":443,"props":2864,"children":2865},{"style":2852},[2866],{"type":408,"value":627},{"type":402,"tag":443,"props":2868,"children":2869},{"style":603},[2870],{"type":408,"value":1488},{"type":402,"tag":443,"props":2872,"children":2873},{"style":609},[2874],{"type":408,"value":1180},{"type":402,"tag":443,"props":2876,"children":2877},{"style":471},[2878],{"type":408,"value":1631},{"type":402,"tag":443,"props":2880,"children":2881},{"style":507},[2882],{"type":408,"value":2883}," skip",{"type":402,"tag":443,"props":2885,"children":2886},{"style":1053},[2887],{"type":408,"value":1517},{"type":402,"tag":443,"props":2889,"children":2890},{"class":445,"line":545},[2891,2895,2899,2903,2907,2911,2915,2920,2924,2928,2933,2937,2941,2946,2950,2955,2959,2963,2968,2972,2976,2980,2984,2988,2992,2996,3002,3006,3010,3015,3019,3024,3028,3033,3037,3042],{"type":402,"tag":443,"props":2892,"children":2893},{"style":1047},[2894],{"type":408,"value":2664},{"type":402,"tag":443,"props":2896,"children":2897},{"style":507},[2898],{"type":408,"value":2821},{"type":402,"tag":443,"props":2900,"children":2901},{"style":1053},[2902],{"type":408,"value":594},{"type":402,"tag":443,"props":2904,"children":2905},{"style":492},[2906],{"type":408,"value":1160},{"type":402,"tag":443,"props":2908,"children":2909},{"style":1053},[2910],{"type":408,"value":627},{"type":402,"tag":443,"props":2912,"children":2913},{"style":471},[2914],{"type":408,"value":463},{"type":402,"tag":443,"props":2916,"children":2917},{"style":1069},[2918],{"type":408,"value":2919},"replace",{"type":402,"tag":443,"props":2921,"children":2922},{"style":1053},[2923],{"type":408,"value":1155},{"type":402,"tag":443,"props":2925,"children":2926},{"style":609},[2927],{"type":408,"value":1180},{"type":402,"tag":443,"props":2929,"children":2931},{"style":2930},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[2932],{"type":408,"value":1155},{"type":402,"tag":443,"props":2934,"children":2935},{"style":1047},[2936],{"type":408,"value":2302},{"type":402,"tag":443,"props":2938,"children":2939},{"style":603},[2940],{"type":408,"value":2419},{"type":402,"tag":443,"props":2942,"children":2944},{"style":2943},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[2945],{"type":408,"value":1631},{"type":402,"tag":443,"props":2947,"children":2948},{"style":2852},[2949],{"type":408,"value":594},{"type":402,"tag":443,"props":2951,"children":2952},{"style":2305},[2953],{"type":408,"value":2954},"\\n\\s",{"type":402,"tag":443,"props":2956,"children":2957},{"style":2852},[2958],{"type":408,"value":627},{"type":402,"tag":443,"props":2960,"children":2961},{"style":603},[2962],{"type":408,"value":1235},{"type":402,"tag":443,"props":2964,"children":2965},{"style":2930},[2966],{"type":408,"value":2967},")(",{"type":402,"tag":443,"props":2969,"children":2970},{"style":2852},[2971],{"type":408,"value":594},{"type":402,"tag":443,"props":2973,"children":2974},{"style":603},[2975],{"type":408,"value":2302},{"type":402,"tag":443,"props":2977,"children":2978},{"style":2305},[2979],{"type":408,"value":1631},{"type":402,"tag":443,"props":2981,"children":2982},{"style":2852},[2983],{"type":408,"value":627},{"type":402,"tag":443,"props":2985,"children":2986},{"style":603},[2987],{"type":408,"value":1488},{"type":402,"tag":443,"props":2989,"children":2990},{"style":2930},[2991],{"type":408,"value":1649},{"type":402,"tag":443,"props":2993,"children":2994},{"style":609},[2995],{"type":408,"value":1180},{"type":402,"tag":443,"props":2997,"children":2999},{"style":2998},"--shiki-light:#F76D47;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[3000],{"type":408,"value":3001},"g",{"type":402,"tag":443,"props":3003,"children":3004},{"style":471},[3005],{"type":408,"value":1631},{"type":402,"tag":443,"props":3007,"children":3008},{"style":471},[3009],{"type":408,"value":1056},{"type":402,"tag":443,"props":3011,"children":3012},{"style":1794},[3013],{"type":408,"value":3014},"_",{"type":402,"tag":443,"props":3016,"children":3017},{"style":471},[3018],{"type":408,"value":1631},{"type":402,"tag":443,"props":3020,"children":3021},{"style":1794},[3022],{"type":408,"value":3023}," separator",{"type":402,"tag":443,"props":3025,"children":3026},{"style":471},[3027],{"type":408,"value":1631},{"type":402,"tag":443,"props":3029,"children":3030},{"style":1794},[3031],{"type":408,"value":3032}," selector",{"type":402,"tag":443,"props":3034,"children":3035},{"style":471},[3036],{"type":408,"value":1649},{"type":402,"tag":443,"props":3038,"children":3039},{"style":1004},[3040],{"type":408,"value":3041}," =>",{"type":402,"tag":443,"props":3043,"children":3044},{"style":471},[3045],{"type":408,"value":474},{"type":402,"tag":443,"props":3047,"children":3048},{"class":445,"line":554},[3049],{"type":402,"tag":443,"props":3050,"children":3051},{"style":450},[3052],{"type":408,"value":3053},"    // 如果检测到选择器被禁用则跳过添加前缀步骤\n",{"type":402,"tag":443,"props":3055,"children":3056},{"class":445,"line":563},[3057,3061,3065,3070,3074],{"type":402,"tag":443,"props":3058,"children":3059},{"style":1047},[3060],{"type":408,"value":1124},{"type":402,"tag":443,"props":3062,"children":3063},{"style":1053},[3064],{"type":408,"value":1056},{"type":402,"tag":443,"props":3066,"children":3067},{"style":603},[3068],{"type":408,"value":3069},"...",{"type":402,"tag":443,"props":3071,"children":3072},{"style":1053},[3073],{"type":408,"value":1165},{"type":402,"tag":443,"props":3075,"children":3076},{"style":471},[3077],{"type":408,"value":1248},{"type":402,"tag":443,"props":3079,"children":3080},{"class":445,"line":573},[3081,3086,3091,3095,3099,3103,3108],{"type":402,"tag":443,"props":3082,"children":3083},{"style":1004},[3084],{"type":408,"value":3085},"      const",{"type":402,"tag":443,"props":3087,"children":3088},{"style":513},[3089],{"type":408,"value":3090}," prefix",{"type":402,"tag":443,"props":3092,"children":3093},{"style":603},[3094],{"type":408,"value":2446},{"type":402,"tag":443,"props":3096,"children":3097},{"style":1059},[3098],{"type":408,"value":1194},{"type":402,"tag":443,"props":3100,"children":3101},{"style":471},[3102],{"type":408,"value":463},{"type":402,"tag":443,"props":3104,"children":3105},{"style":507},[3106],{"type":408,"value":3107},"prefix",{"type":402,"tag":443,"props":3109,"children":3110},{"style":450},[3111],{"type":408,"value":3112}," // micro-app[name=\"subapp\"]\n",{"type":402,"tag":443,"props":3114,"children":3115},{"class":445,"line":582},[3116,3121,3125,3129,3134,3138,3142,3146],{"type":402,"tag":443,"props":3117,"children":3118},{"style":507},[3119],{"type":408,"value":3120},"      selector",{"type":402,"tag":443,"props":3122,"children":3123},{"style":603},[3124],{"type":408,"value":2446},{"type":402,"tag":443,"props":3126,"children":3127},{"style":507},[3128],{"type":408,"value":3090},{"type":402,"tag":443,"props":3130,"children":3131},{"style":603},[3132],{"type":408,"value":3133}," +",{"type":402,"tag":443,"props":3135,"children":3136},{"style":609},[3137],{"type":408,"value":2105},{"type":402,"tag":443,"props":3139,"children":3140},{"style":609},[3141],{"type":408,"value":2105},{"type":402,"tag":443,"props":3143,"children":3144},{"style":603},[3145],{"type":408,"value":3133},{"type":402,"tag":443,"props":3147,"children":3148},{"style":507},[3149],{"type":408,"value":3150}," selector\n",{"type":402,"tag":443,"props":3152,"children":3153},{"class":445,"line":643},[3154],{"type":402,"tag":443,"props":3155,"children":3156},{"style":471},[3157],{"type":408,"value":1274},{"type":402,"tag":443,"props":3159,"children":3160},{"class":445,"line":663},[3161,3165,3169,3173],{"type":402,"tag":443,"props":3162,"children":3163},{"style":1047},[3164],{"type":408,"value":1290},{"type":402,"tag":443,"props":3166,"children":3167},{"style":507},[3168],{"type":408,"value":3023},{"type":402,"tag":443,"props":3170,"children":3171},{"style":603},[3172],{"type":408,"value":3133},{"type":402,"tag":443,"props":3174,"children":3175},{"style":507},[3176],{"type":408,"value":3150},{"type":402,"tag":443,"props":3178,"children":3179},{"class":445,"line":679},[3180,3184],{"type":402,"tag":443,"props":3181,"children":3182},{"style":471},[3183],{"type":408,"value":842},{"type":402,"tag":443,"props":3185,"children":3186},{"style":1053},[3187],{"type":408,"value":1517},{"type":402,"tag":443,"props":3189,"children":3190},{"class":445,"line":699},[3191],{"type":402,"tag":443,"props":3192,"children":3193},{"style":471},[3194],{"type":408,"value":560},{"type":402,"tag":410,"props":3196,"children":3197},{},[3198,3200,3205,3207,3212,3214,3219,3221,3226,3228,3235],{"type":408,"value":3199},"匹配完选择器后，声明便是剩下的包含在左右花括号的内容。匹配过程是一个递归，以遇到",{"type":402,"tag":439,"props":3201,"children":3203},{"className":3202},[],[3204],{"type":408,"value":1910},{"type":408,"value":3206},"作为结束条件。如果遇到斜杠",{"type":402,"tag":439,"props":3208,"children":3210},{"className":3209},[],[3211],{"type":408,"value":1180},{"type":408,"value":3213},"，则尝试停止声明匹配并开始注释匹配。总之，",{"type":402,"tag":439,"props":3215,"children":3217},{"className":3216},[],[3218],{"type":408,"value":1910},{"type":408,"value":3220},"之前的内容都作为当前选择器的声明，添加到",{"type":402,"tag":439,"props":3222,"children":3224},{"className":3223},[],[3225],{"type":408,"value":1141},{"type":408,"value":3227},"中。micro-app 框架会对 CSS 资源中的 URL 补全为主应用的完整路径这个功能也是在这个函数中实现，有兴趣的话可以查看其",{"type":402,"tag":421,"props":3229,"children":3232},{"href":3230,"rel":3231},"https://github.com/micro-zoe/micro-app/blob/dev/src/sandbox/scoped_css.ts",[425],[3233],{"type":408,"value":3234},"完整代码",{"type":408,"value":928},{"type":402,"tag":432,"props":3237,"children":3239},{"className":992,"code":3238,"language":994,"meta":396,"style":396},"private matchAllDeclarations (): void {\n  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n  this.recordResult(cssValue)\n\n  // 递归退出条件\n  if (!this.cssText) return\n  if (this.cssText.charAt(0) === '}') return\n\n  // extract comments in declarations\n  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n    this.matchComments()\n  } else {\n    // 如果不是注释则忽略中断，继续匹配声明\n    this.commonMatch(/\\/+/)\n  }\n\n  return this.matchAllDeclarations()\n}\n",[3240],{"type":402,"tag":439,"props":3241,"children":3242},{"__ignoreMap":396},[3243,3267,3377,3405,3412,3420,3456,3524,3531,3539,3659,3678,3694,3702,3743,3750,3757,3780],{"type":402,"tag":443,"props":3244,"children":3245},{"class":445,"line":446},[3246,3250,3255,3259,3263],{"type":402,"tag":443,"props":3247,"children":3248},{"style":507},[3249],{"type":408,"value":1960},{"type":402,"tag":443,"props":3251,"children":3252},{"style":1069},[3253],{"type":408,"value":3254},"matchAllDeclarations",{"type":402,"tag":443,"props":3256,"children":3257},{"style":507},[3258],{"type":408,"value":1970},{"type":402,"tag":443,"props":3260,"children":3261},{"style":603},[3262],{"type":408,"value":1975},{"type":402,"tag":443,"props":3264,"children":3265},{"style":471},[3266],{"type":408,"value":474},{"type":402,"tag":443,"props":3268,"children":3269},{"class":445,"line":456},[3270,3275,3280,3284,3288,3292,3296,3300,3304,3308,3312,3316,3320,3325,3329,3333,3337,3341,3345,3349,3353,3358,3363,3368,3372],{"type":402,"tag":443,"props":3271,"children":3272},{"style":1004},[3273],{"type":408,"value":3274},"  let",{"type":402,"tag":443,"props":3276,"children":3277},{"style":507},[3278],{"type":408,"value":3279}," cssValue",{"type":402,"tag":443,"props":3281,"children":3282},{"style":603},[3283],{"type":408,"value":2446},{"type":402,"tag":443,"props":3285,"children":3286},{"style":1053},[3287],{"type":408,"value":1056},{"type":402,"tag":443,"props":3289,"children":3290},{"style":1059},[3291],{"type":408,"value":1062},{"type":402,"tag":443,"props":3293,"children":3294},{"style":471},[3295],{"type":408,"value":463},{"type":402,"tag":443,"props":3297,"children":3298},{"style":1069},[3299],{"type":408,"value":2289},{"type":402,"tag":443,"props":3301,"children":3302},{"style":1053},[3303],{"type":408,"value":1155},{"type":402,"tag":443,"props":3305,"children":3306},{"style":609},[3307],{"type":408,"value":1180},{"type":402,"tag":443,"props":3309,"children":3310},{"style":1047},[3311],{"type":408,"value":2302},{"type":402,"tag":443,"props":3313,"children":3314},{"style":2852},[3315],{"type":408,"value":594},{"type":402,"tag":443,"props":3317,"children":3318},{"style":603},[3319],{"type":408,"value":2302},{"type":402,"tag":443,"props":3321,"children":3322},{"style":2305},[3323],{"type":408,"value":3324},"}/",{"type":402,"tag":443,"props":3326,"children":3327},{"style":2852},[3328],{"type":408,"value":627},{"type":402,"tag":443,"props":3330,"children":3331},{"style":2943},[3332],{"type":408,"value":1649},{"type":402,"tag":443,"props":3334,"children":3335},{"style":603},[3336],{"type":408,"value":1235},{"type":402,"tag":443,"props":3338,"children":3339},{"style":609},[3340],{"type":408,"value":1180},{"type":402,"tag":443,"props":3342,"children":3343},{"style":471},[3344],{"type":408,"value":1631},{"type":402,"tag":443,"props":3346,"children":3347},{"style":1259},[3348],{"type":408,"value":1295},{"type":402,"tag":443,"props":3350,"children":3351},{"style":1053},[3352],{"type":408,"value":1165},{"type":402,"tag":443,"props":3354,"children":3355},{"style":1047},[3356],{"type":408,"value":3357},"as",{"type":402,"tag":443,"props":3359,"children":3360},{"style":1010},[3361],{"type":408,"value":3362}," RegExpExecArray",{"type":402,"tag":443,"props":3364,"children":3365},{"style":1053},[3366],{"type":408,"value":3367},")[",{"type":402,"tag":443,"props":3369,"children":3370},{"style":492},[3371],{"type":408,"value":1160},{"type":402,"tag":443,"props":3373,"children":3374},{"style":1053},[3375],{"type":408,"value":3376},"]\n",{"type":402,"tag":443,"props":3378,"children":3379},{"class":445,"line":477},[3380,3384,3388,3392,3396,3401],{"type":402,"tag":443,"props":3381,"children":3382},{"style":1059},[3383],{"type":408,"value":1371},{"type":402,"tag":443,"props":3385,"children":3386},{"style":471},[3387],{"type":408,"value":463},{"type":402,"tag":443,"props":3389,"children":3390},{"style":1069},[3391],{"type":408,"value":1857},{"type":402,"tag":443,"props":3393,"children":3394},{"style":1053},[3395],{"type":408,"value":1155},{"type":402,"tag":443,"props":3397,"children":3398},{"style":507},[3399],{"type":408,"value":3400},"cssValue",{"type":402,"tag":443,"props":3402,"children":3403},{"style":1053},[3404],{"type":408,"value":1517},{"type":402,"tag":443,"props":3406,"children":3407},{"class":445,"line":503},[3408],{"type":402,"tag":443,"props":3409,"children":3410},{"emptyLinePlaceholder":567},[3411],{"type":408,"value":570},{"type":402,"tag":443,"props":3413,"children":3414},{"class":445,"line":523},[3415],{"type":402,"tag":443,"props":3416,"children":3417},{"style":450},[3418],{"type":408,"value":3419},"  // 递归退出条件\n",{"type":402,"tag":443,"props":3421,"children":3422},{"class":445,"line":545},[3423,3427,3431,3435,3439,3443,3447,3451],{"type":402,"tag":443,"props":3424,"children":3425},{"style":1047},[3426],{"type":408,"value":2505},{"type":402,"tag":443,"props":3428,"children":3429},{"style":1053},[3430],{"type":408,"value":1056},{"type":402,"tag":443,"props":3432,"children":3433},{"style":603},[3434],{"type":408,"value":2514},{"type":402,"tag":443,"props":3436,"children":3437},{"style":1059},[3438],{"type":408,"value":1062},{"type":402,"tag":443,"props":3440,"children":3441},{"style":471},[3442],{"type":408,"value":463},{"type":402,"tag":443,"props":3444,"children":3445},{"style":507},[3446],{"type":408,"value":1141},{"type":402,"tag":443,"props":3448,"children":3449},{"style":1053},[3450],{"type":408,"value":1165},{"type":402,"tag":443,"props":3452,"children":3453},{"style":1047},[3454],{"type":408,"value":3455},"return\n",{"type":402,"tag":443,"props":3457,"children":3458},{"class":445,"line":554},[3459,3463,3467,3471,3475,3479,3483,3487,3491,3495,3499,3504,3508,3512,3516,3520],{"type":402,"tag":443,"props":3460,"children":3461},{"style":1047},[3462],{"type":408,"value":2505},{"type":402,"tag":443,"props":3464,"children":3465},{"style":1053},[3466],{"type":408,"value":1056},{"type":402,"tag":443,"props":3468,"children":3469},{"style":1059},[3470],{"type":408,"value":1062},{"type":402,"tag":443,"props":3472,"children":3473},{"style":471},[3474],{"type":408,"value":463},{"type":402,"tag":443,"props":3476,"children":3477},{"style":507},[3478],{"type":408,"value":1141},{"type":402,"tag":443,"props":3480,"children":3481},{"style":471},[3482],{"type":408,"value":463},{"type":402,"tag":443,"props":3484,"children":3485},{"style":1069},[3486],{"type":408,"value":1150},{"type":402,"tag":443,"props":3488,"children":3489},{"style":1053},[3490],{"type":408,"value":1155},{"type":402,"tag":443,"props":3492,"children":3493},{"style":492},[3494],{"type":408,"value":1160},{"type":402,"tag":443,"props":3496,"children":3497},{"style":1053},[3498],{"type":408,"value":1165},{"type":402,"tag":443,"props":3500,"children":3501},{"style":603},[3502],{"type":408,"value":3503},"===",{"type":402,"tag":443,"props":3505,"children":3506},{"style":609},[3507],{"type":408,"value":2105},{"type":402,"tag":443,"props":3509,"children":3510},{"style":615},[3511],{"type":408,"value":1910},{"type":402,"tag":443,"props":3513,"children":3514},{"style":609},[3515],{"type":408,"value":2114},{"type":402,"tag":443,"props":3517,"children":3518},{"style":1053},[3519],{"type":408,"value":1165},{"type":402,"tag":443,"props":3521,"children":3522},{"style":1047},[3523],{"type":408,"value":3455},{"type":402,"tag":443,"props":3525,"children":3526},{"class":445,"line":563},[3527],{"type":402,"tag":443,"props":3528,"children":3529},{"emptyLinePlaceholder":567},[3530],{"type":408,"value":570},{"type":402,"tag":443,"props":3532,"children":3533},{"class":445,"line":573},[3534],{"type":402,"tag":443,"props":3535,"children":3536},{"style":450},[3537],{"type":408,"value":3538},"  // extract comments in declarations\n",{"type":402,"tag":443,"props":3540,"children":3541},{"class":445,"line":582},[3542,3546,3550,3554,3558,3562,3566,3570,3574,3578,3582,3586,3590,3594,3598,3603,3607,3611,3615,3619,3623,3627,3631,3635,3639,3643,3647,3651,3655],{"type":402,"tag":443,"props":3543,"children":3544},{"style":1047},[3545],{"type":408,"value":2505},{"type":402,"tag":443,"props":3547,"children":3548},{"style":1053},[3549],{"type":408,"value":1056},{"type":402,"tag":443,"props":3551,"children":3552},{"style":1059},[3553],{"type":408,"value":1062},{"type":402,"tag":443,"props":3555,"children":3556},{"style":471},[3557],{"type":408,"value":463},{"type":402,"tag":443,"props":3559,"children":3560},{"style":507},[3561],{"type":408,"value":1141},{"type":402,"tag":443,"props":3563,"children":3564},{"style":471},[3565],{"type":408,"value":463},{"type":402,"tag":443,"props":3567,"children":3568},{"style":1069},[3569],{"type":408,"value":1150},{"type":402,"tag":443,"props":3571,"children":3572},{"style":1053},[3573],{"type":408,"value":1155},{"type":402,"tag":443,"props":3575,"children":3576},{"style":492},[3577],{"type":408,"value":1160},{"type":402,"tag":443,"props":3579,"children":3580},{"style":1053},[3581],{"type":408,"value":1165},{"type":402,"tag":443,"props":3583,"children":3584},{"style":603},[3585],{"type":408,"value":3503},{"type":402,"tag":443,"props":3587,"children":3588},{"style":609},[3589],{"type":408,"value":2105},{"type":402,"tag":443,"props":3591,"children":3592},{"style":615},[3593],{"type":408,"value":1180},{"type":402,"tag":443,"props":3595,"children":3596},{"style":609},[3597],{"type":408,"value":2114},{"type":402,"tag":443,"props":3599,"children":3600},{"style":603},[3601],{"type":408,"value":3602}," &&",{"type":402,"tag":443,"props":3604,"children":3605},{"style":1059},[3606],{"type":408,"value":1194},{"type":402,"tag":443,"props":3608,"children":3609},{"style":471},[3610],{"type":408,"value":463},{"type":402,"tag":443,"props":3612,"children":3613},{"style":507},[3614],{"type":408,"value":1141},{"type":402,"tag":443,"props":3616,"children":3617},{"style":471},[3618],{"type":408,"value":463},{"type":402,"tag":443,"props":3620,"children":3621},{"style":1069},[3622],{"type":408,"value":1150},{"type":402,"tag":443,"props":3624,"children":3625},{"style":1053},[3626],{"type":408,"value":1155},{"type":402,"tag":443,"props":3628,"children":3629},{"style":492},[3630],{"type":408,"value":926},{"type":402,"tag":443,"props":3632,"children":3633},{"style":1053},[3634],{"type":408,"value":1165},{"type":402,"tag":443,"props":3636,"children":3637},{"style":603},[3638],{"type":408,"value":3503},{"type":402,"tag":443,"props":3640,"children":3641},{"style":609},[3642],{"type":408,"value":2105},{"type":402,"tag":443,"props":3644,"children":3645},{"style":615},[3646],{"type":408,"value":1235},{"type":402,"tag":443,"props":3648,"children":3649},{"style":609},[3650],{"type":408,"value":2114},{"type":402,"tag":443,"props":3652,"children":3653},{"style":1053},[3654],{"type":408,"value":1165},{"type":402,"tag":443,"props":3656,"children":3657},{"style":471},[3658],{"type":408,"value":1248},{"type":402,"tag":443,"props":3660,"children":3661},{"class":445,"line":643},[3662,3666,3670,3674],{"type":402,"tag":443,"props":3663,"children":3664},{"style":1059},[3665],{"type":408,"value":2040},{"type":402,"tag":443,"props":3667,"children":3668},{"style":471},[3669],{"type":408,"value":463},{"type":402,"tag":443,"props":3671,"children":3672},{"style":1069},[3673],{"type":408,"value":2016},{"type":402,"tag":443,"props":3675,"children":3676},{"style":1053},[3677],{"type":408,"value":2000},{"type":402,"tag":443,"props":3679,"children":3680},{"class":445,"line":663},[3681,3685,3690],{"type":402,"tag":443,"props":3682,"children":3683},{"style":471},[3684],{"type":408,"value":842},{"type":402,"tag":443,"props":3686,"children":3687},{"style":1047},[3688],{"type":408,"value":3689}," else",{"type":402,"tag":443,"props":3691,"children":3692},{"style":471},[3693],{"type":408,"value":474},{"type":402,"tag":443,"props":3695,"children":3696},{"class":445,"line":679},[3697],{"type":402,"tag":443,"props":3698,"children":3699},{"style":450},[3700],{"type":408,"value":3701},"    // 如果不是注释则忽略中断，继续匹配声明\n",{"type":402,"tag":443,"props":3703,"children":3704},{"class":445,"line":699},[3705,3709,3713,3717,3721,3725,3731,3735,3739],{"type":402,"tag":443,"props":3706,"children":3707},{"style":1059},[3708],{"type":408,"value":2040},{"type":402,"tag":443,"props":3710,"children":3711},{"style":471},[3712],{"type":408,"value":463},{"type":402,"tag":443,"props":3714,"children":3715},{"style":1069},[3716],{"type":408,"value":2289},{"type":402,"tag":443,"props":3718,"children":3719},{"style":1053},[3720],{"type":408,"value":1155},{"type":402,"tag":443,"props":3722,"children":3723},{"style":609},[3724],{"type":408,"value":1180},{"type":402,"tag":443,"props":3726,"children":3728},{"style":3727},"--shiki-light:#90A4AE;--shiki-light-font-weight:inherit;--shiki-default:#22863A;--shiki-default-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;--shiki-sepia:#AE81FF;--shiki-sepia-font-weight:inherit",[3729],{"type":408,"value":3730},"\\/",{"type":402,"tag":443,"props":3732,"children":3733},{"style":603},[3734],{"type":408,"value":1488},{"type":402,"tag":443,"props":3736,"children":3737},{"style":609},[3738],{"type":408,"value":1180},{"type":402,"tag":443,"props":3740,"children":3741},{"style":1053},[3742],{"type":408,"value":1517},{"type":402,"tag":443,"props":3744,"children":3745},{"class":445,"line":707},[3746],{"type":402,"tag":443,"props":3747,"children":3748},{"style":471},[3749],{"type":408,"value":551},{"type":402,"tag":443,"props":3751,"children":3752},{"class":445,"line":715},[3753],{"type":402,"tag":443,"props":3754,"children":3755},{"emptyLinePlaceholder":567},[3756],{"type":408,"value":570},{"type":402,"tag":443,"props":3758,"children":3759},{"class":445,"line":723},[3760,3764,3768,3772,3776],{"type":402,"tag":443,"props":3761,"children":3762},{"style":1047},[3763],{"type":408,"value":2664},{"type":402,"tag":443,"props":3765,"children":3766},{"style":1059},[3767],{"type":408,"value":1194},{"type":402,"tag":443,"props":3769,"children":3770},{"style":471},[3771],{"type":408,"value":463},{"type":402,"tag":443,"props":3773,"children":3774},{"style":1069},[3775],{"type":408,"value":3254},{"type":402,"tag":443,"props":3777,"children":3778},{"style":1053},[3779],{"type":408,"value":2000},{"type":402,"tag":443,"props":3781,"children":3782},{"class":445,"line":732},[3783],{"type":402,"tag":443,"props":3784,"children":3785},{"style":471},[3786],{"type":408,"value":560},{"type":402,"tag":957,"props":3788,"children":3790},{"id":3789},"解析at-rule",[3791,3793],{"type":408,"value":3792},"解析",{"type":402,"tag":439,"props":3794,"children":3796},{"className":3795},[],[3797],{"type":408,"value":948},{"type":402,"tag":410,"props":3799,"children":3800},{},[3801,3803,3809,3811,3817,3818,3824,3826,3837],{"type":408,"value":3802},"流程中最繁琐的部分，是匹配 ",{"type":402,"tag":439,"props":3804,"children":3806},{"className":3805},[],[3807],{"type":408,"value":3808},"@media",{"type":408,"value":3810},"、",{"type":402,"tag":439,"props":3812,"children":3814},{"className":3813},[],[3815],{"type":408,"value":3816},"@import",{"type":408,"value":3810},{"type":402,"tag":439,"props":3819,"children":3821},{"className":3820},[],[3822],{"type":408,"value":3823},"@charset",{"type":408,"value":3825}," 等 ",{"type":402,"tag":421,"props":3827,"children":3830},{"href":3828,"rel":3829},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/At-rule",[425],[3831],{"type":402,"tag":439,"props":3832,"children":3834},{"className":3833},[],[3835],{"type":408,"value":3836},"at-rules",{"type":408,"value":928},{"type":402,"tag":410,"props":3839,"children":3840},{},[3841],{"type":408,"value":3842},"每一种规则的语法都不同，要怎么处理才合适呢？",{"type":402,"tag":410,"props":3844,"children":3845},{},[3846,3848,3853],{"type":408,"value":3847},"这里，micro-app 把 ",{"type":402,"tag":439,"props":3849,"children":3851},{"className":3850},[],[3852],{"type":408,"value":948},{"type":408,"value":3854}," 分为了三组：",{"type":402,"tag":3856,"props":3857,"children":3858},"ol",{},[3859,3893,3925],{"type":402,"tag":3860,"props":3861,"children":3862},"li",{},[3863,3865,3871,3873,3878,3879,3884,3885,3891],{"type":408,"value":3864},"类似 ",{"type":402,"tag":439,"props":3866,"children":3868},{"className":3867},[],[3869],{"type":408,"value":3870},"@charset \"utf-8\";",{"type":408,"value":3872}," 为一组，包括 ",{"type":402,"tag":439,"props":3874,"children":3876},{"className":3875},[],[3877],{"type":408,"value":3816},{"type":408,"value":3810},{"type":402,"tag":439,"props":3880,"children":3882},{"className":3881},[],[3883],{"type":408,"value":3823},{"type":408,"value":3810},{"type":402,"tag":439,"props":3886,"children":3888},{"className":3887},[],[3889],{"type":408,"value":3890},"@namespace",{"type":408,"value":3892}," 等。",{"type":402,"tag":3860,"props":3894,"children":3895},{},[3896,3897,3903,3904,3910,3911,3917,3918,3924],{"type":408,"value":3864},{"type":402,"tag":439,"props":3898,"children":3900},{"className":3899},[],[3901],{"type":408,"value":3902},"@media (w \u003C 100px) { .selector { xxx: xxx } }",{"type":408,"value":3872},{"type":402,"tag":439,"props":3905,"children":3907},{"className":3906},[],[3908],{"type":408,"value":3909},"@supports",{"type":408,"value":3810},{"type":402,"tag":439,"props":3912,"children":3914},{"className":3913},[],[3915],{"type":408,"value":3916},"@font-face",{"type":408,"value":3810},{"type":402,"tag":439,"props":3919,"children":3921},{"className":3920},[],[3922],{"type":408,"value":3923},"@document",{"type":408,"value":3892},{"type":402,"tag":3860,"props":3926,"children":3927},{},[3928,3929,3935,3936,3941,3942,3948,3949,3955],{"type":408,"value":3864},{"type":402,"tag":439,"props":3930,"children":3932},{"className":3931},[],[3933],{"type":408,"value":3934},"@font-face { unicode-range: 'xxx' }",{"type":408,"value":3872},{"type":402,"tag":439,"props":3937,"children":3939},{"className":3938},[],[3940],{"type":408,"value":3916},{"type":408,"value":3810},{"type":402,"tag":439,"props":3943,"children":3945},{"className":3944},[],[3946],{"type":408,"value":3947},"@page",{"type":408,"value":3810},{"type":402,"tag":439,"props":3950,"children":3952},{"className":3951},[],[3953],{"type":408,"value":3954},"@key-frames",{"type":408,"value":3892},{"type":402,"tag":410,"props":3957,"children":3958},{},[3959,3961,3966,3968,3974,3976,3982,3984,3989],{"type":408,"value":3960},"第一组，",{"type":402,"tag":439,"props":3962,"children":3964},{"className":3963},[],[3965],{"type":408,"value":3823},{"type":408,"value":3967}," 所在的第一组规则的规则正文内容从 ",{"type":402,"tag":439,"props":3969,"children":3971},{"className":3970},[],[3972],{"type":408,"value":3973},"@",{"type":408,"value":3975}," 开始到 ",{"type":402,"tag":439,"props":3977,"children":3979},{"className":3978},[],[3980],{"type":408,"value":3981},";",{"type":408,"value":3983}," 结束，比如 ",{"type":402,"tag":439,"props":3985,"children":3987},{"className":3986},[],[3988],{"type":408,"value":3870},{"type":408,"value":3990}," 就是一条完整的声明；",{"type":402,"tag":410,"props":3992,"children":3993},{},[3994,3996,4002,4004,4009],{"type":408,"value":3995},"第二组，",{"type":402,"tag":439,"props":3997,"children":3999},{"className":3998},[],[4000],{"type":408,"value":4001},"@media () {}",{"type":408,"value":4003}," 的花括号部分可能包含选择器，所以其正文内容需要重新进入 ",{"type":402,"tag":439,"props":4005,"children":4007},{"className":4006},[],[4008],{"type":408,"value":1965},{"type":408,"value":4010}," 匹配选择器以及声明。",{"type":402,"tag":410,"props":4012,"children":4013},{},[4014,4016,4022,4024,4029],{"type":408,"value":4015},"第三组，",{"type":402,"tag":439,"props":4017,"children":4019},{"className":4018},[],[4020],{"type":408,"value":4021},"@font-face {}",{"type":408,"value":4023}," 的花括号部分仅包含声明，不包含选择器，所以只需要进入 ",{"type":402,"tag":439,"props":4025,"children":4027},{"className":4026},[],[4028],{"type":408,"value":3254},{"type":408,"value":4030}," 匹配声明即可。",{"type":402,"tag":403,"props":4032,"children":4034},{"id":4033},"解决问题",[4035],{"type":408,"value":4033},{"type":402,"tag":410,"props":4037,"children":4038},{},[4039],{"type":408,"value":4040},"回到文章开头的问题，如果要给这个 CSS Parser 增加原生的嵌套功能，见下代码，可以仅用十行简单实现。",{"type":402,"tag":432,"props":4042,"children":4046},{"className":4043,"code":4044,"language":4045,"meta":396,"style":396},"language-diff shiki shiki-themes material-theme-lighter github-light github-dark monokai","+ private matchAllDeclarations (nesting = 0): void {\n  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n  this.recordResult(cssValue)\n\n  // 递归退出条件\n  if (!this.cssText) return\n-  if (this.cssText.charAt(0) === '}') return\n+  if (this.cssText.charAt(0) === '}') {\n+    if (!nesting) return\n+    this.commonMatch(/}+\\s*/)\n+    return this.matchAllDeclarations(nesting - 1)\n+  }\n\n  // extract comments in declarations\n  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n    this.matchComments()\n  } else {\n    // 如果不是注释则忽略中断，继续匹配声明\n    this.commonMatch(/\\/+/)\n  }\n\n+ if (this.cssText.charAt(0) === '{') {\n+   this.commonMatch(/{+\\s*/)\n+   nesting++\n+ }\n\n- return this.matchAllDeclarations()\n+ return this.matchAllDeclarations(nesting)\n}\n","diff",[4047],{"type":402,"tag":439,"props":4048,"children":4049},{"__ignoreMap":396},[4050,4064,4072,4080,4087,4094,4102,4116,4128,4140,4152,4164,4175,4182,4189,4197,4205,4213,4220,4228,4235,4242,4254,4267,4280,4293,4301,4314,4327],{"type":402,"tag":443,"props":4051,"children":4052},{"class":445,"line":446},[4053,4058],{"type":402,"tag":443,"props":4054,"children":4056},{"style":4055},"--shiki-light:#39ADB5;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#A6E22E",[4057],{"type":408,"value":1488},{"type":402,"tag":443,"props":4059,"children":4061},{"style":4060},"--shiki-light:#91B859;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#A6E22E",[4062],{"type":408,"value":4063}," private matchAllDeclarations (nesting = 0): void {\n",{"type":402,"tag":443,"props":4065,"children":4066},{"class":445,"line":456},[4067],{"type":402,"tag":443,"props":4068,"children":4069},{"style":507},[4070],{"type":408,"value":4071},"  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n",{"type":402,"tag":443,"props":4073,"children":4074},{"class":445,"line":477},[4075],{"type":402,"tag":443,"props":4076,"children":4077},{"style":507},[4078],{"type":408,"value":4079},"  this.recordResult(cssValue)\n",{"type":402,"tag":443,"props":4081,"children":4082},{"class":445,"line":503},[4083],{"type":402,"tag":443,"props":4084,"children":4085},{"emptyLinePlaceholder":567},[4086],{"type":408,"value":570},{"type":402,"tag":443,"props":4088,"children":4089},{"class":445,"line":523},[4090],{"type":402,"tag":443,"props":4091,"children":4092},{"style":507},[4093],{"type":408,"value":3419},{"type":402,"tag":443,"props":4095,"children":4096},{"class":445,"line":545},[4097],{"type":402,"tag":443,"props":4098,"children":4099},{"style":507},[4100],{"type":408,"value":4101},"  if (!this.cssText) return\n",{"type":402,"tag":443,"props":4103,"children":4104},{"class":445,"line":554},[4105,4110],{"type":402,"tag":443,"props":4106,"children":4108},{"style":4107},"--shiki-light:#39ADB5;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F92672",[4109],{"type":408,"value":1640},{"type":402,"tag":443,"props":4111,"children":4113},{"style":4112},"--shiki-light:#E53935;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F92672",[4114],{"type":408,"value":4115},"  if (this.cssText.charAt(0) === '}') return\n",{"type":402,"tag":443,"props":4117,"children":4118},{"class":445,"line":563},[4119,4123],{"type":402,"tag":443,"props":4120,"children":4121},{"style":4055},[4122],{"type":408,"value":1488},{"type":402,"tag":443,"props":4124,"children":4125},{"style":4060},[4126],{"type":408,"value":4127},"  if (this.cssText.charAt(0) === '}') {\n",{"type":402,"tag":443,"props":4129,"children":4130},{"class":445,"line":573},[4131,4135],{"type":402,"tag":443,"props":4132,"children":4133},{"style":4055},[4134],{"type":408,"value":1488},{"type":402,"tag":443,"props":4136,"children":4137},{"style":4060},[4138],{"type":408,"value":4139},"    if (!nesting) return\n",{"type":402,"tag":443,"props":4141,"children":4142},{"class":445,"line":582},[4143,4147],{"type":402,"tag":443,"props":4144,"children":4145},{"style":4055},[4146],{"type":408,"value":1488},{"type":402,"tag":443,"props":4148,"children":4149},{"style":4060},[4150],{"type":408,"value":4151},"    this.commonMatch(/}+\\s*/)\n",{"type":402,"tag":443,"props":4153,"children":4154},{"class":445,"line":643},[4155,4159],{"type":402,"tag":443,"props":4156,"children":4157},{"style":4055},[4158],{"type":408,"value":1488},{"type":402,"tag":443,"props":4160,"children":4161},{"style":4060},[4162],{"type":408,"value":4163},"    return this.matchAllDeclarations(nesting - 1)\n",{"type":402,"tag":443,"props":4165,"children":4166},{"class":445,"line":663},[4167,4171],{"type":402,"tag":443,"props":4168,"children":4169},{"style":4055},[4170],{"type":408,"value":1488},{"type":402,"tag":443,"props":4172,"children":4173},{"style":4060},[4174],{"type":408,"value":551},{"type":402,"tag":443,"props":4176,"children":4177},{"class":445,"line":679},[4178],{"type":402,"tag":443,"props":4179,"children":4180},{"emptyLinePlaceholder":567},[4181],{"type":408,"value":570},{"type":402,"tag":443,"props":4183,"children":4184},{"class":445,"line":699},[4185],{"type":402,"tag":443,"props":4186,"children":4187},{"style":507},[4188],{"type":408,"value":3538},{"type":402,"tag":443,"props":4190,"children":4191},{"class":445,"line":707},[4192],{"type":402,"tag":443,"props":4193,"children":4194},{"style":507},[4195],{"type":408,"value":4196},"  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n",{"type":402,"tag":443,"props":4198,"children":4199},{"class":445,"line":715},[4200],{"type":402,"tag":443,"props":4201,"children":4202},{"style":507},[4203],{"type":408,"value":4204},"    this.matchComments()\n",{"type":402,"tag":443,"props":4206,"children":4207},{"class":445,"line":723},[4208],{"type":402,"tag":443,"props":4209,"children":4210},{"style":507},[4211],{"type":408,"value":4212},"  } else {\n",{"type":402,"tag":443,"props":4214,"children":4215},{"class":445,"line":732},[4216],{"type":402,"tag":443,"props":4217,"children":4218},{"style":507},[4219],{"type":408,"value":3701},{"type":402,"tag":443,"props":4221,"children":4222},{"class":445,"line":780},[4223],{"type":402,"tag":443,"props":4224,"children":4225},{"style":507},[4226],{"type":408,"value":4227},"    this.commonMatch(/\\/+/)\n",{"type":402,"tag":443,"props":4229,"children":4230},{"class":445,"line":800},[4231],{"type":402,"tag":443,"props":4232,"children":4233},{"style":507},[4234],{"type":408,"value":551},{"type":402,"tag":443,"props":4236,"children":4237},{"class":445,"line":816},[4238],{"type":402,"tag":443,"props":4239,"children":4240},{"emptyLinePlaceholder":567},[4241],{"type":408,"value":570},{"type":402,"tag":443,"props":4243,"children":4244},{"class":445,"line":836},[4245,4249],{"type":402,"tag":443,"props":4246,"children":4247},{"style":4055},[4248],{"type":408,"value":1488},{"type":402,"tag":443,"props":4250,"children":4251},{"style":4060},[4252],{"type":408,"value":4253}," if (this.cssText.charAt(0) === '{') {\n",{"type":402,"tag":443,"props":4255,"children":4257},{"class":445,"line":4256},23,[4258,4262],{"type":402,"tag":443,"props":4259,"children":4260},{"style":4055},[4261],{"type":408,"value":1488},{"type":402,"tag":443,"props":4263,"children":4264},{"style":4060},[4265],{"type":408,"value":4266},"   this.commonMatch(/{+\\s*/)\n",{"type":402,"tag":443,"props":4268,"children":4270},{"class":445,"line":4269},24,[4271,4275],{"type":402,"tag":443,"props":4272,"children":4273},{"style":4055},[4274],{"type":408,"value":1488},{"type":402,"tag":443,"props":4276,"children":4277},{"style":4060},[4278],{"type":408,"value":4279},"   nesting++\n",{"type":402,"tag":443,"props":4281,"children":4283},{"class":445,"line":4282},25,[4284,4288],{"type":402,"tag":443,"props":4285,"children":4286},{"style":4055},[4287],{"type":408,"value":1488},{"type":402,"tag":443,"props":4289,"children":4290},{"style":4060},[4291],{"type":408,"value":4292}," }\n",{"type":402,"tag":443,"props":4294,"children":4296},{"class":445,"line":4295},26,[4297],{"type":402,"tag":443,"props":4298,"children":4299},{"emptyLinePlaceholder":567},[4300],{"type":408,"value":570},{"type":402,"tag":443,"props":4302,"children":4304},{"class":445,"line":4303},27,[4305,4309],{"type":402,"tag":443,"props":4306,"children":4307},{"style":4107},[4308],{"type":408,"value":1640},{"type":402,"tag":443,"props":4310,"children":4311},{"style":4112},[4312],{"type":408,"value":4313}," return this.matchAllDeclarations()\n",{"type":402,"tag":443,"props":4315,"children":4317},{"class":445,"line":4316},28,[4318,4322],{"type":402,"tag":443,"props":4319,"children":4320},{"style":4055},[4321],{"type":408,"value":1488},{"type":402,"tag":443,"props":4323,"children":4324},{"style":4060},[4325],{"type":408,"value":4326}," return this.matchAllDeclarations(nesting)\n",{"type":402,"tag":443,"props":4328,"children":4330},{"class":445,"line":4329},29,[4331],{"type":402,"tag":443,"props":4332,"children":4333},{"style":507},[4334],{"type":408,"value":560},{"type":402,"tag":410,"props":4336,"children":4337},{},[4338],{"type":408,"value":4339},"最终 CSS Nesting 解析成功。",{"type":402,"tag":410,"props":4341,"children":4342},{},[4343],{"type":402,"tag":933,"props":4344,"children":4346},{"alt":1832,"src":4345},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230804025910.png",[],{"type":402,"tag":403,"props":4348,"children":4350},{"id":4349},"结语",[4351],{"type":408,"value":4349},{"type":402,"tag":410,"props":4353,"children":4354},{},[4355],{"type":408,"value":4356},"整个 CSS Parser 的代码简单，功能强悍，耐人寻味。不过有许多边界条件没有处理好，尤其是引入了使用注释禁用样式隔离功能后，匹配注释变得更复杂且易错了。",{"type":402,"tag":3856,"props":4358,"children":4359},{},[4360],{"type":402,"tag":3860,"props":4361,"children":4362},{},[4363],{"type":408,"value":4364},"注释不能和选择器等混用（以下 result 文件代表解析结果）。",{"type":402,"tag":410,"props":4366,"children":4367},{},[4368],{"type":402,"tag":933,"props":4369,"children":4372},{"alt":4370,"src":4371},"comment in selectors","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/9d2b75bda238f9bbe24825a793f0f715.png",[],{"type":402,"tag":3856,"props":4374,"children":4375},{"start":456},[4376],{"type":402,"tag":3860,"props":4377,"children":4378},{},[4379],{"type":408,"value":4380},"CSS 字符串值可能意外启用编译器的特殊功能。",{"type":402,"tag":410,"props":4382,"children":4383},{},[4384],{"type":402,"tag":933,"props":4385,"children":4388},{"alt":4386,"src":4387},"special comment in string value","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230803225103.png",[],{"type":402,"tag":3856,"props":4390,"children":4391},{"start":477},[4392],{"type":402,"tag":3860,"props":4393,"children":4394},{},[4395,4397,4403,4405,4416,4418,4423],{"type":408,"value":4396},"错误的 ",{"type":402,"tag":439,"props":4398,"children":4400},{"className":4399},[],[4401],{"type":408,"value":4402},"@host",{"type":408,"value":4404}," 规则匹配。猜测是想匹配 ",{"type":402,"tag":421,"props":4406,"children":4409},{"href":4407,"rel":4408},"https://drafts.csswg.org/css-scoping/#host-selector",[425],[4410],{"type":402,"tag":439,"props":4411,"children":4413},{"className":4412},[],[4414],{"type":408,"value":4415},":host",{"type":408,"value":4417}," 但是手滑写成了 ",{"type":402,"tag":439,"props":4419,"children":4421},{"className":4420},[],[4422],{"type":408,"value":4402},{"type":408,"value":928},{"type":402,"tag":432,"props":4425,"children":4427},{"className":992,"code":4426,"language":994,"meta":396,"style":396},"private hostRule =\n  this.createMatcherForRuleWithChildRule(\n    /^@host\\s*/,\n    '@host'\n  )\n",[4428],{"type":402,"tag":439,"props":4429,"children":4430},{"__ignoreMap":396},[4431,4444,4465,4498,4515],{"type":402,"tag":443,"props":4432,"children":4433},{"class":445,"line":446},[4434,4439],{"type":402,"tag":443,"props":4435,"children":4436},{"style":507},[4437],{"type":408,"value":4438},"private hostRule ",{"type":402,"tag":443,"props":4440,"children":4441},{"style":603},[4442],{"type":408,"value":4443},"=\n",{"type":402,"tag":443,"props":4445,"children":4446},{"class":445,"line":456},[4447,4451,4455,4460],{"type":402,"tag":443,"props":4448,"children":4449},{"style":1059},[4450],{"type":408,"value":1371},{"type":402,"tag":443,"props":4452,"children":4453},{"style":471},[4454],{"type":408,"value":463},{"type":402,"tag":443,"props":4456,"children":4457},{"style":1069},[4458],{"type":408,"value":4459},"createMatcherForRuleWithChildRule",{"type":402,"tag":443,"props":4461,"children":4462},{"style":507},[4463],{"type":408,"value":4464},"(\n",{"type":402,"tag":443,"props":4466,"children":4467},{"class":445,"line":477},[4468,4473,4477,4481,4485,4489,4493],{"type":402,"tag":443,"props":4469,"children":4470},{"style":609},[4471],{"type":408,"value":4472},"    /",{"type":402,"tag":443,"props":4474,"children":4475},{"style":1047},[4476],{"type":408,"value":2302},{"type":402,"tag":443,"props":4478,"children":4479},{"style":2943},[4480],{"type":408,"value":4402},{"type":402,"tag":443,"props":4482,"children":4483},{"style":2305},[4484],{"type":408,"value":2308},{"type":402,"tag":443,"props":4486,"children":4487},{"style":603},[4488],{"type":408,"value":1235},{"type":402,"tag":443,"props":4490,"children":4491},{"style":609},[4492],{"type":408,"value":1180},{"type":402,"tag":443,"props":4494,"children":4495},{"style":471},[4496],{"type":408,"value":4497},",\n",{"type":402,"tag":443,"props":4499,"children":4500},{"class":445,"line":503},[4501,4506,4510],{"type":402,"tag":443,"props":4502,"children":4503},{"style":609},[4504],{"type":408,"value":4505},"    '",{"type":402,"tag":443,"props":4507,"children":4508},{"style":615},[4509],{"type":408,"value":4402},{"type":402,"tag":443,"props":4511,"children":4512},{"style":609},[4513],{"type":408,"value":4514},"'\n",{"type":402,"tag":443,"props":4516,"children":4517},{"class":445,"line":523},[4518],{"type":402,"tag":443,"props":4519,"children":4520},{"style":507},[4521],{"type":408,"value":4522},"  )\n",{"type":402,"tag":410,"props":4524,"children":4525},{},[4526],{"type":402,"tag":933,"props":4527,"children":4530},{"alt":4528,"src":4529},"error @host rule","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230803235802.png",[],{"type":402,"tag":410,"props":4532,"children":4533},{},[4534,4536,4543],{"type":408,"value":4535},"在实际项目中，考虑到性能和可维护性的平衡，为了使代码不变得过于复杂，没有必要去完善“边界功能”。运行时的解析应当尽量简单且运行快速，并保持一定的容错：不规范的 CSS 代码在浏览器中本身就能运行，再者，解析器是一个容易带来代码性能和体积瓶颈的地方，要不然 VueJS 也不会分全局构建和运行时",{"type":402,"tag":421,"props":4537,"children":4540},{"href":4538,"rel":4539},"https://www.jsdelivr.com/package/npm/vue?tab=files&path=dist",[425],[4541],{"type":408,"value":4542},"两个版本的编译产物",{"type":408,"value":928},{"type":402,"tag":410,"props":4545,"children":4546},{},[4547],{"type":408,"value":4548},"鉴于 CSS 在部分语法上的灵活性，如果从降低维护难度的角度考虑优化这个 CSS Parser，可能从以下方向：",{"type":402,"tag":4550,"props":4551,"children":4552},"ul",{},[4553,4588],{"type":402,"tag":3860,"props":4554,"children":4555},{},[4556,4558,4563,4565,4571,4573,4578,4580,4587],{"type":408,"value":4557},"在规则匹配部分使用黑名单机制而不是白名单匹配。就 ",{"type":402,"tag":439,"props":4559,"children":4561},{"className":4560},[],[4562],{"type":408,"value":948},{"type":408,"value":4564}," 等灵活语法而言，如果浏览器支持新的 ",{"type":402,"tag":439,"props":4566,"children":4568},{"className":4567},[],[4569],{"type":408,"value":4570},"@xxx",{"type":408,"value":4572}," 语法，黑名单机制编写的代码不需要对 ",{"type":402,"tag":439,"props":4574,"children":4576},{"className":4575},[],[4577],{"type":408,"value":4570},{"type":408,"value":4579}," 做额外处理；而白名单机制需要",{"type":402,"tag":421,"props":4581,"children":4584},{"href":4582,"rel":4583},"https://github.com/micro-zoe/micro-app/commit/b83c4600102e0db6f591bacbdc592bea8f1d5bb8",[425],[4585],{"type":408,"value":4586},"手动处理",{"type":408,"value":928},{"type":402,"tag":3860,"props":4589,"children":4590},{},[4591,4593,4604],{"type":408,"value":4592},"在复杂的解析器部分使用外部依赖，如使用类似 ",{"type":402,"tag":421,"props":4594,"children":4597},{"href":4595,"rel":4596},"https://www.npmjs.com/package/lightningcss-wasm/v/1.16.0",[425],[4598],{"type":402,"tag":439,"props":4599,"children":4601},{"className":4600},[],[4602],{"type":408,"value":4603},"lightingcss-wasm",{"type":408,"value":4605}," 等方案。",{"type":402,"tag":410,"props":4607,"children":4608},{},[4609],{"type":408,"value":4610},"关于样式隔离，作者两年前专门写了文章介绍，不过时效性稍有不足，没有涉及解析器的具体流程，写得更多是解析器在整个微前端框架中的作用，也可作为补充阅读。",{"type":402,"tag":4550,"props":4612,"children":4613},{},[4614],{"type":402,"tag":3860,"props":4615,"children":4616},{},[4617],{"type":402,"tag":421,"props":4618,"children":4621},{"href":4619,"rel":4620},"https://github.com/micro-zoe/micro-app/issues/20",[425],[4622],{"type":408,"value":4623},"从零开始写一个微前端框架-样式隔离篇",{"type":402,"tag":410,"props":4625,"children":4626},{},[4627],{"type":408,"value":4628},"最后，微前端框架中的 CSS 的有很多中实施办法，采用一些办法可以抛弃运行时解析。em... 也许以后有机会聊一聊（咕一咕）。",{"type":402,"tag":403,"props":4630,"children":4632},{"id":4631},"增订-2024-年-1-月-28-日",[4633],{"type":408,"value":4634},"增订 | 2024 年 1 月 28 日",{"type":402,"tag":410,"props":4636,"children":4637},{},[4638,4640],{"type":408,"value":4639},"相关实现和测试用例见",{"type":402,"tag":421,"props":4641,"children":4644},{"href":4642,"rel":4643},"https://github.com/micro-zoe/micro-app/issues/868?_issue=nesting",[425],[4645],{"type":408,"value":4646},"这个 Issue",{"type":402,"tag":4648,"props":4649,"children":4652},"section",{"className":4650,"dataFootnotes":396},[4651],"footnotes",[4653,4660],{"type":402,"tag":403,"props":4654,"children":4657},{"className":4655,"id":922},[4656],"sr-only",[4658],{"type":408,"value":4659},"Footnotes",{"type":402,"tag":3856,"props":4661,"children":4662},{},[4663],{"type":402,"tag":3860,"props":4664,"children":4666},{"id":4665},"user-content-fn-css-syntax",[4667,4669,4675,4677],{"type":408,"value":4668},"比较完整的 CSS 语法参见：",{"type":402,"tag":421,"props":4670,"children":4673},{"href":4671,"rel":4672},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/Syntax",[425],[4674],{"type":408,"value":4671},{"type":408,"value":4676}," ",{"type":402,"tag":421,"props":4678,"children":4683},{"href":4679,"ariaLabel":4680,"className":4681,"dataFootnoteBackref":396},"#user-content-fnref-css-syntax","Back to reference 1",[4682],"data-footnote-backref",[4684],{"type":408,"value":4685},"↩",{"type":402,"tag":4687,"props":4688,"children":4689},"style",{},[4690],{"type":408,"value":4691},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":396,"searchDepth":456,"depth":456,"links":4693},[4694,4695,4696,4697,4698,4699,4700],{"id":405,"depth":456,"text":405},{"id":850,"depth":456,"text":853},{"id":953,"depth":456,"text":953},{"id":4033,"depth":456,"text":4033},{"id":4349,"depth":456,"text":4349},{"id":4631,"depth":456,"text":4634},{"id":922,"depth":456,"text":4659},"markdown","content:2.articles:1101.mini-css-parser.md","content","2.articles/1101.mini-css-parser.md","2.articles/1101.mini-css-parser","md",[4708,4710],{"_path":49,"title":48,"description":4709},"忍者秘籍中提到的模板解析器，很短但支持变量和 if 等语句，还是 15 年前的代码！",{"_path":55,"title":54,"description":4711},"在两个纯知识面的问题上，受到了 GPT 的碾压",1741604940721]