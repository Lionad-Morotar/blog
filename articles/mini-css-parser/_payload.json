[{"data":1,"prerenderedAt":4703},["ShallowReactive",2],{"navigation":3,"/articles/mini-css-parser":384,"/articles/mini-css-parser-surround":4698},[4,35,86,105,132,138,144,150,378],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":45,"_path":46},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":48,"_path":49},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":51,"_path":52},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":54,"_path":55},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":57,"_path":58},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":60,"_path":61},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":63,"_path":64},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":66,"_path":67},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":69,"_path":70},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":72,"_path":73},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":75,"_path":76},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":78,"_path":79},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":81,"_path":82},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":84,"_path":85},"📝 技术博客归档","/articles/archive",{"title":87,"_path":88,"children":89},"造物 / Make","/tools",[90,93,96,99,102],{"title":91,"_path":92},"🥥 Coconut","/tools/coconut",{"title":94,"_path":95},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":97,"_path":98},"🌐 AnySort","/tools/anysort",{"title":100,"_path":101},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":103,"_path":104},"👓 Crapto","/tools/crypto-inline",{"title":106,"_path":107,"children":108},"吉他剧场 / Music","/music",[109,111,114,117,120,123,126,129],{"title":110,"_path":107},"🎸 FingerStyle！",{"title":112,"_path":113},"🌬️ 等待的风","/music/wind",{"title":115,"_path":116},"💕 约定的海洋","/music/ocean",{"title":118,"_path":119},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":121,"_path":122},"🌏 残酷天使的行动纲领","/music/eva",{"title":124,"_path":125},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":127,"_path":128},"🍷 Wu Wei","/music/wu-wei",{"title":130,"_path":131},"🌅 无题","/music/untitled",{"title":133,"_path":134,"children":135},"画点什么 / Paint","/paint",[136],{"title":137,"_path":134},"🚧 正在施工",{"title":139,"_path":140,"children":141},"读书笔记 / Notes","/books",[142],{"title":143,"_path":140},"📕 读书笔记",{"title":145,"_path":146,"children":147},"知识地图 / Maps","/maps",[148],{"title":149,"_path":146},"🏁 知识地图",{"title":151,"_path":152,"children":153},"零散的笔记 / Gists","/gists",[154,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375],{"title":155,"_path":152},"🧊 Gists",{"title":157,"_path":158},"网站的可访问性","/gists/accessibility",{"title":160,"_path":161},"Bit","/gists/bit",{"title":163,"_path":164},"图片模糊","/gists/blur",{"title":166,"_path":167},"渲染相关笔记","/gists/c4d",{"title":169,"_path":170},"CDN 问题记录","/gists/cdn",{"title":172,"_path":173},"消毒剂","/gists/cleaner",{"title":175,"_path":176},"Windows Command","/gists/cmd",{"title":178,"_path":179},"Command","/gists/command",{"title":181,"_path":182},"复杂科学","/gists/complexity-science",{"title":184,"_path":185},"GitHub Copilot","/gists/copilot",{"title":187,"_path":188},"宇宙","/gists/cosmos",{"title":190,"_path":191},"C++","/gists/cpp",{"title":193,"_path":194},"DEPRESSION","/gists/depression",{"title":196,"_path":197},"Developer Experience","/gists/developer-experience",{"title":199,"_path":200},"Device Metrics","/gists/device-metrix",{"title":202,"_path":203},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":205,"_path":206},"正则表达式","/gists/eegex",{"title":208,"_path":209},"Emoji","/gists/emoji",{"title":211,"_path":212},"工程","/gists/engineering",{"title":214,"_path":215},"熵","/gists/entropy",{"title":217,"_path":218},"Environment","/gists/environment",{"title":220,"_path":221},"Erlang","/gists/erlang",{"title":223,"_path":224},"逃离塔克夫","/gists/escape-from-tarkov",{"title":226,"_path":227},"ESNext (ES6-ES11)","/gists/esnext",{"title":229,"_path":230},"Eval！","/gists/eval",{"title":232,"_path":233},"Flutter","/gists/flutter",{"title":235,"_path":236},"字体","/gists/font",{"title":238,"_path":239},"JS 函数式编程","/gists/functional",{"title":241,"_path":242},"游戏化","/gists/gamification",{"title":244,"_path":245},"Google C++ Standard","/gists/google-cpp-standard",{"title":247,"_path":248},"双向链接完全体","/gists/graph",{"title":250,"_path":251},"Hardwares","/gists/hardwares",{"title":253,"_path":254},"哈希冲突","/gists/hash-collision",{"title":256,"_path":257},"信息设计","/gists/information-design",{"title":259,"_path":260},"InstantPage","/gists/instant.page",{"title":262,"_path":263},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":265,"_path":266},"KVStore","/gists/key-value-db",{"title":268,"_path":269},"Kubernetes","/gists/kubernetes",{"title":271,"_path":272},"Makefile","/gists/makefile",{"title":274,"_path":275},"Markdown Inline Style","/gists/markdown-nice",{"title":277,"_path":278},"减小页面快照体积","/gists/minify-html",{"title":280,"_path":281},"mklink","/gists/mklink",{"title":283,"_path":284},"Mock","/gists/mock",{"title":286,"_path":287},"多人协作系统","/gists/multiplayer",{"title":289,"_path":290},"多端应用","/gists/multy-end-app",{"title":292,"_path":293},"神经科学","/gists/neuroscience",{"title":295,"_path":296},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":298,"_path":299},"PInvoke","/gists/pinvoke",{"title":301,"_path":302},"像素","/gists/pixel",{"title":304,"_path":305},"PowerShell","/gists/powershell",{"title":307,"_path":308},"量子","/gists/quantum",{"title":310,"_path":311},"保持好奇心","/gists/questions",{"title":313,"_path":314},"React Native","/gists/react-native",{"title":316,"_path":317},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":319,"_path":320},"SEO","/gists/seo",{"title":322,"_path":323},"Shader","/gists/shader",{"title":325,"_path":326},"Shape Up","/gists/shape-up",{"title":328,"_path":329},"睡觉","/gists/sleep",{"title":331,"_path":332},"记录奇怪的问题","/gists/solved",{"title":334,"_path":335},"States","/gists/states",{"title":337,"_path":338},"Storage","/gists/storage",{"title":340,"_path":341},"音视频流处理","/gists/stream-cli",{"title":343,"_path":344},"Symbol","/gists/symbol",{"title":346,"_path":347},"系统论","/gists/systems-theory",{"title":349,"_path":350},"任务切片","/gists/task-slice",{"title":352,"_path":353},"技术偏好","/gists/tech-dudge",{"title":355,"_path":356},"Untitled","/gists/untitled",{"title":358,"_path":359},"可变字体","/gists/variable-font",{"title":361,"_path":362},"视觉错觉","/gists/visual-illusion",{"title":364,"_path":365},"SS(SSR)","/gists/vpn",{"title":367,"_path":368},"VS Code 插件开发","/gists/vscode-plugin",{"title":370,"_path":371},"Web Components","/gists/web-components",{"title":373,"_path":374},"Windows","/gists/windows",{"title":376,"_path":377},"查缺补漏","/gists/wrong",{"title":379,"_path":380,"children":381},"我 / About","/hire",[382],{"title":383,"_path":380},"📬 技术简历",{"_path":52,"_dir":385,"_draft":386,"_partial":386,"_locale":387,"title":51,"description":388,"body":389,"_type":4692,"_id":4693,"_source":4694,"_file":4695,"_stem":4696,"_extension":4697},"articles",false,"","我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。我碰到的问题是，如果 CSS 源码中带嵌套语法那么解析就会失败。今天借这个问题给大家简单介绍一下 CSS Parser 的基本流程。",{"type":390,"children":391,"toc":4683},"root",[392,400,406,422,839,845,920,929,942,947,953,976,981,1305,1310,1702,1730,1801,1806,1826,1851,1927,1932,1937,2223,2235,2327,2366,2383,2668,2712,3186,3227,3778,3789,3829,3834,3846,3947,3982,4002,4022,4027,4032,4326,4331,4338,4343,4348,4356,4364,4372,4380,4415,4514,4522,4535,4540,4597,4602,4615,4620,4626,4638,4677],{"type":393,"tag":394,"props":395,"children":397},"element","h2",{"id":396},"前言",[398],{"type":399,"value":396},"text",{"type":393,"tag":401,"props":402,"children":403},"p",{},[404],{"type":399,"value":405},"Vue 源码中包含 HTML Parser，随着大家在框架方向的深入学习（卷），不免要开始接触一些编译解析相关的东西。社区很多看 Vue 源码时总结的 HTML Parser 的文章，但是很少有介绍 CSS Parser 的文章。今天借着在开发时碰到的一个问题，给大家简单介绍一下 CSS Parser 的基本流程。",{"type":393,"tag":401,"props":407,"children":408},{},[409,411,420],{"type":399,"value":410},"我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。代码示例见下。我碰到的问题是，如果 CSS 源码中带",{"type":393,"tag":412,"props":413,"children":417},"a",{"href":414,"rel":415},"https://caniuse.com/?search=css%20nesting",[416],"nofollow",[418],{"type":399,"value":419},"嵌套语法",{"type":399,"value":421},"，那么解析就会失败。",{"type":393,"tag":423,"props":424,"children":428},"pre",{"className":425,"code":426,"language":427,"meta":387,"style":387},"language-css shiki shiki-themes material-theme-lighter github-light github-dark monokai","/* css 源代码 */\n.a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  }\n}\n\n/* 期待转化得到的代码 */\nmicro-app[name=\"test-app\"] .a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  }\n}\n\n/* 实际得到的代码 */\nmicro-app[name=\"test-app\"] .a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  } /* -> 到这里就停了 */\n","css",[429],{"type":393,"tag":430,"props":431,"children":432},"code",{"__ignoreMap":387},[433,445,466,492,512,534,543,552,562,571,632,652,668,688,696,704,712,721,769,789,805,825],{"type":393,"tag":434,"props":435,"children":438},"span",{"class":436,"line":437},"line",1,[439],{"type":393,"tag":434,"props":440,"children":442},{"style":441},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[443],{"type":399,"value":444},"/* css 源代码 */\n",{"type":393,"tag":434,"props":446,"children":448},{"class":436,"line":447},2,[449,455,460],{"type":393,"tag":434,"props":450,"children":452},{"style":451},"--shiki-light:#39ADB5;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[453],{"type":399,"value":454},".",{"type":393,"tag":434,"props":456,"children":458},{"style":457},"--shiki-light:#E2931D;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[459],{"type":399,"value":412},{"type":393,"tag":434,"props":461,"children":463},{"style":462},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[464],{"type":399,"value":465}," {\n",{"type":393,"tag":434,"props":467,"children":469},{"class":436,"line":468},3,[470,476,481,487],{"type":393,"tag":434,"props":471,"children":473},{"style":472},"--shiki-light:#8796B0;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[474],{"type":399,"value":475},"  z-index",{"type":393,"tag":434,"props":477,"children":478},{"style":462},[479],{"type":399,"value":480},":",{"type":393,"tag":434,"props":482,"children":484},{"style":483},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[485],{"type":399,"value":486}," 1",{"type":393,"tag":434,"props":488,"children":489},{"style":462},[490],{"type":399,"value":491},";\n",{"type":393,"tag":434,"props":493,"children":495},{"class":436,"line":494},4,[496,502,508],{"type":393,"tag":434,"props":497,"children":499},{"style":498},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[500],{"type":399,"value":501},"  .",{"type":393,"tag":434,"props":503,"children":505},{"style":504},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[506],{"type":399,"value":507},"b",{"type":393,"tag":434,"props":509,"children":510},{"style":498},[511],{"type":399,"value":465},{"type":393,"tag":434,"props":513,"children":515},{"class":436,"line":514},5,[516,521,525,530],{"type":393,"tag":434,"props":517,"children":518},{"style":472},[519],{"type":399,"value":520},"    z-index",{"type":393,"tag":434,"props":522,"children":523},{"style":462},[524],{"type":399,"value":480},{"type":393,"tag":434,"props":526,"children":527},{"style":483},[528],{"type":399,"value":529}," 2",{"type":393,"tag":434,"props":531,"children":532},{"style":462},[533],{"type":399,"value":491},{"type":393,"tag":434,"props":535,"children":537},{"class":436,"line":536},6,[538],{"type":393,"tag":434,"props":539,"children":540},{"style":462},[541],{"type":399,"value":542},"  }\n",{"type":393,"tag":434,"props":544,"children":546},{"class":436,"line":545},7,[547],{"type":393,"tag":434,"props":548,"children":549},{"style":498},[550],{"type":399,"value":551},"}\n",{"type":393,"tag":434,"props":553,"children":555},{"class":436,"line":554},8,[556],{"type":393,"tag":434,"props":557,"children":559},{"emptyLinePlaceholder":558},true,[560],{"type":399,"value":561},"\n",{"type":393,"tag":434,"props":563,"children":565},{"class":436,"line":564},9,[566],{"type":393,"tag":434,"props":567,"children":568},{"style":441},[569],{"type":399,"value":570},"/* 期待转化得到的代码 */\n",{"type":393,"tag":434,"props":572,"children":574},{"class":436,"line":573},10,[575,581,586,592,598,604,610,614,619,624,628],{"type":393,"tag":434,"props":576,"children":578},{"style":577},"--shiki-light:#E2931D;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[579],{"type":399,"value":580},"micro-app",{"type":393,"tag":434,"props":582,"children":583},{"style":462},[584],{"type":399,"value":585},"[",{"type":393,"tag":434,"props":587,"children":589},{"style":588},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[590],{"type":399,"value":591},"name",{"type":393,"tag":434,"props":593,"children":595},{"style":594},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[596],{"type":399,"value":597},"=",{"type":393,"tag":434,"props":599,"children":601},{"style":600},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[602],{"type":399,"value":603},"\"",{"type":393,"tag":434,"props":605,"children":607},{"style":606},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[608],{"type":399,"value":609},"test-app",{"type":393,"tag":434,"props":611,"children":612},{"style":600},[613],{"type":399,"value":603},{"type":393,"tag":434,"props":615,"children":616},{"style":462},[617],{"type":399,"value":618},"]",{"type":393,"tag":434,"props":620,"children":621},{"style":451},[622],{"type":399,"value":623}," .",{"type":393,"tag":434,"props":625,"children":626},{"style":457},[627],{"type":399,"value":412},{"type":393,"tag":434,"props":629,"children":630},{"style":462},[631],{"type":399,"value":465},{"type":393,"tag":434,"props":633,"children":635},{"class":436,"line":634},11,[636,640,644,648],{"type":393,"tag":434,"props":637,"children":638},{"style":472},[639],{"type":399,"value":475},{"type":393,"tag":434,"props":641,"children":642},{"style":462},[643],{"type":399,"value":480},{"type":393,"tag":434,"props":645,"children":646},{"style":483},[647],{"type":399,"value":486},{"type":393,"tag":434,"props":649,"children":650},{"style":462},[651],{"type":399,"value":491},{"type":393,"tag":434,"props":653,"children":655},{"class":436,"line":654},12,[656,660,664],{"type":393,"tag":434,"props":657,"children":658},{"style":498},[659],{"type":399,"value":501},{"type":393,"tag":434,"props":661,"children":662},{"style":504},[663],{"type":399,"value":507},{"type":393,"tag":434,"props":665,"children":666},{"style":498},[667],{"type":399,"value":465},{"type":393,"tag":434,"props":669,"children":671},{"class":436,"line":670},13,[672,676,680,684],{"type":393,"tag":434,"props":673,"children":674},{"style":472},[675],{"type":399,"value":520},{"type":393,"tag":434,"props":677,"children":678},{"style":462},[679],{"type":399,"value":480},{"type":393,"tag":434,"props":681,"children":682},{"style":483},[683],{"type":399,"value":529},{"type":393,"tag":434,"props":685,"children":686},{"style":462},[687],{"type":399,"value":491},{"type":393,"tag":434,"props":689,"children":691},{"class":436,"line":690},14,[692],{"type":393,"tag":434,"props":693,"children":694},{"style":462},[695],{"type":399,"value":542},{"type":393,"tag":434,"props":697,"children":699},{"class":436,"line":698},15,[700],{"type":393,"tag":434,"props":701,"children":702},{"style":498},[703],{"type":399,"value":551},{"type":393,"tag":434,"props":705,"children":707},{"class":436,"line":706},16,[708],{"type":393,"tag":434,"props":709,"children":710},{"emptyLinePlaceholder":558},[711],{"type":399,"value":561},{"type":393,"tag":434,"props":713,"children":715},{"class":436,"line":714},17,[716],{"type":393,"tag":434,"props":717,"children":718},{"style":441},[719],{"type":399,"value":720},"/* 实际得到的代码 */\n",{"type":393,"tag":434,"props":722,"children":724},{"class":436,"line":723},18,[725,729,733,737,741,745,749,753,757,761,765],{"type":393,"tag":434,"props":726,"children":727},{"style":577},[728],{"type":399,"value":580},{"type":393,"tag":434,"props":730,"children":731},{"style":462},[732],{"type":399,"value":585},{"type":393,"tag":434,"props":734,"children":735},{"style":588},[736],{"type":399,"value":591},{"type":393,"tag":434,"props":738,"children":739},{"style":594},[740],{"type":399,"value":597},{"type":393,"tag":434,"props":742,"children":743},{"style":600},[744],{"type":399,"value":603},{"type":393,"tag":434,"props":746,"children":747},{"style":606},[748],{"type":399,"value":609},{"type":393,"tag":434,"props":750,"children":751},{"style":600},[752],{"type":399,"value":603},{"type":393,"tag":434,"props":754,"children":755},{"style":462},[756],{"type":399,"value":618},{"type":393,"tag":434,"props":758,"children":759},{"style":451},[760],{"type":399,"value":623},{"type":393,"tag":434,"props":762,"children":763},{"style":457},[764],{"type":399,"value":412},{"type":393,"tag":434,"props":766,"children":767},{"style":462},[768],{"type":399,"value":465},{"type":393,"tag":434,"props":770,"children":772},{"class":436,"line":771},19,[773,777,781,785],{"type":393,"tag":434,"props":774,"children":775},{"style":472},[776],{"type":399,"value":475},{"type":393,"tag":434,"props":778,"children":779},{"style":462},[780],{"type":399,"value":480},{"type":393,"tag":434,"props":782,"children":783},{"style":483},[784],{"type":399,"value":486},{"type":393,"tag":434,"props":786,"children":787},{"style":462},[788],{"type":399,"value":491},{"type":393,"tag":434,"props":790,"children":792},{"class":436,"line":791},20,[793,797,801],{"type":393,"tag":434,"props":794,"children":795},{"style":498},[796],{"type":399,"value":501},{"type":393,"tag":434,"props":798,"children":799},{"style":504},[800],{"type":399,"value":507},{"type":393,"tag":434,"props":802,"children":803},{"style":498},[804],{"type":399,"value":465},{"type":393,"tag":434,"props":806,"children":808},{"class":436,"line":807},21,[809,813,817,821],{"type":393,"tag":434,"props":810,"children":811},{"style":472},[812],{"type":399,"value":520},{"type":393,"tag":434,"props":814,"children":815},{"style":462},[816],{"type":399,"value":480},{"type":393,"tag":434,"props":818,"children":819},{"style":483},[820],{"type":399,"value":529},{"type":393,"tag":434,"props":822,"children":823},{"style":462},[824],{"type":399,"value":491},{"type":393,"tag":434,"props":826,"children":828},{"class":436,"line":827},22,[829,834],{"type":393,"tag":434,"props":830,"children":831},{"style":462},[832],{"type":399,"value":833},"  }",{"type":393,"tag":434,"props":835,"children":836},{"style":441},[837],{"type":399,"value":838}," /* -> 到这里就停了 */\n",{"type":393,"tag":394,"props":840,"children":842},{"id":841},"css-的组成部分",[843],{"type":399,"value":844},"CSS 的组成部分",{"type":393,"tag":401,"props":846,"children":847},{},[848,850,857,859,865,867,873,875,881,883,889,891,897,899,905,918],{"type":399,"value":849},"要理解 CSS 是怎么解析的，就要先清楚 CSS 是由哪几部分组成的。由我们平常见得最多的普通 CSS 代码开始说起，见下图，基本的 CSS 代码的组成部分包含规则集（rules）、选择器（selector）、选择器（declares）、属性（property）、值（value）这五个部分。",{"type":393,"tag":851,"props":852,"children":854},"abbr",{"title":853},"rule",[855],{"type":399,"value":856},"规则",{"type":399,"value":858},"是由",{"type":393,"tag":851,"props":860,"children":862},{"title":861},"property",[863],{"type":399,"value":864},"属性",{"type":399,"value":866},"和",{"type":393,"tag":851,"props":868,"children":870},{"title":869},"value",[871],{"type":399,"value":872},"值",{"type":399,"value":874},"组成的",{"type":393,"tag":851,"props":876,"children":878},{"title":877},"declaration",[879],{"type":399,"value":880},"声明",{"type":399,"value":882},"、声明与括号形成的",{"type":393,"tag":851,"props":884,"children":886},{"title":885},"declaration block",[887],{"type":399,"value":888},"声明块",{"type":399,"value":890},"再加上",{"type":393,"tag":851,"props":892,"children":894},{"title":893},"selector",[895],{"type":399,"value":896},"选择器",{"type":399,"value":898},"组成，而一条或多条规则组合成了",{"type":393,"tag":851,"props":900,"children":902},{"title":901},"rule sets",[903],{"type":399,"value":904},"规则集",{"type":393,"tag":906,"props":907,"children":908},"sup",{},[909],{"type":393,"tag":412,"props":910,"children":915},{"href":911,"ariaDescribedBy":912,"dataFootnoteRef":387,"id":914},"#user-content-fn-css-syntax",[913],"footnote-label","user-content-fnref-css-syntax",[916],{"type":399,"value":917},"1",{"type":399,"value":919},"。",{"type":393,"tag":401,"props":921,"children":922},{},[923],{"type":393,"tag":924,"props":925,"children":928},"img",{"alt":926,"src":927},"规则&规则集","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/200621/20200625022018.png",[],{"type":393,"tag":401,"props":930,"children":931},{},[932,934,940],{"type":399,"value":933},"图中没有包含 ",{"type":393,"tag":430,"props":935,"children":937},{"className":936},[],[938],{"type":399,"value":939},"at-rule",{"type":399,"value":941}," 的部分，哦，还少了注释部分~ 由于注释是 CSS 中语法最简单的部分，我们从解析注释开始代码部分的解读吧。",{"type":393,"tag":394,"props":943,"children":945},{"id":944},"流程速览",[946],{"type":399,"value":944},{"type":393,"tag":948,"props":949,"children":951},"h4",{"id":950},"解析注释",[952],{"type":399,"value":950},{"type":393,"tag":401,"props":954,"children":955},{},[956,958,965,967,974],{"type":399,"value":957},"可能许多人不了解 CSS 的注释风格，这里先说明一下，原生 CSS 仅支持",{"type":393,"tag":412,"props":959,"children":962},{"href":960,"rel":961},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/Comments",[416],[963],{"type":399,"value":964},"斜杠星号风格注释",{"type":399,"value":966},"，不支持",{"type":393,"tag":412,"props":968,"children":971},{"href":969,"rel":970},"https://segmentfault.com/a/1190000043885414",[416],[972],{"type":399,"value":973},"双斜杠注释",{"type":399,"value":975},"，所以解析器并未处理双斜杠的情况。",{"type":393,"tag":401,"props":977,"children":978},{},[979],{"type":399,"value":980},"解析注释的函数是一个 while 循环，从代码开头开始匹配，每次循环解析一条注释，直到代码开头没有注释为止。",{"type":393,"tag":423,"props":982,"children":986},{"className":983,"code":984,"language":985,"meta":387,"style":387},"language-ts shiki shiki-themes material-theme-lighter github-light github-dark monokai","class CSSParser {\n  private matchComments() {\n    while (this.matchComment());\n  }\n  private matchComment() {\n    // 快速跳过非注释部分代码\n    if (this.cssText.charAt(0) !== \"/\" || this.cssText.charAt(1) !== \"*\") {\n      return false;\n    }\n    // ...\n    return true;\n  }\n}\n","ts",[987],{"type":393,"tag":430,"props":988,"children":989},{"__ignoreMap":387},[990,1009,1033,1073,1080,1100,1108,1240,1258,1266,1274,1291,1298],{"type":393,"tag":434,"props":991,"children":992},{"class":436,"line":437},[993,999,1005],{"type":393,"tag":434,"props":994,"children":996},{"style":995},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[997],{"type":399,"value":998},"class",{"type":393,"tag":434,"props":1000,"children":1002},{"style":1001},"--shiki-light:#E2931D;--shiki-light-text-decoration:inherit;--shiki-default:#6F42C1;--shiki-default-text-decoration:inherit;--shiki-dark:#B392F0;--shiki-dark-text-decoration:inherit;--shiki-sepia:#A6E22E;--shiki-sepia-text-decoration:underline",[1003],{"type":399,"value":1004}," CSSParser",{"type":393,"tag":434,"props":1006,"children":1007},{"style":462},[1008],{"type":399,"value":465},{"type":393,"tag":434,"props":1010,"children":1011},{"class":436,"line":447},[1012,1018,1024,1029],{"type":393,"tag":434,"props":1013,"children":1015},{"style":1014},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1016],{"type":399,"value":1017},"  private",{"type":393,"tag":434,"props":1019,"children":1021},{"style":1020},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1022],{"type":399,"value":1023}," matchComments",{"type":393,"tag":434,"props":1025,"children":1026},{"style":462},[1027],{"type":399,"value":1028},"()",{"type":393,"tag":434,"props":1030,"children":1031},{"style":462},[1032],{"type":399,"value":465},{"type":393,"tag":434,"props":1034,"children":1035},{"class":436,"line":468},[1036,1042,1048,1054,1058,1064,1069],{"type":393,"tag":434,"props":1037,"children":1039},{"style":1038},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[1040],{"type":399,"value":1041},"    while",{"type":393,"tag":434,"props":1043,"children":1045},{"style":1044},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[1046],{"type":399,"value":1047}," (",{"type":393,"tag":434,"props":1049,"children":1051},{"style":1050},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[1052],{"type":399,"value":1053},"this",{"type":393,"tag":434,"props":1055,"children":1056},{"style":462},[1057],{"type":399,"value":454},{"type":393,"tag":434,"props":1059,"children":1061},{"style":1060},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1062],{"type":399,"value":1063},"matchComment",{"type":393,"tag":434,"props":1065,"children":1066},{"style":1044},[1067],{"type":399,"value":1068},"())",{"type":393,"tag":434,"props":1070,"children":1071},{"style":462},[1072],{"type":399,"value":491},{"type":393,"tag":434,"props":1074,"children":1075},{"class":436,"line":494},[1076],{"type":393,"tag":434,"props":1077,"children":1078},{"style":462},[1079],{"type":399,"value":542},{"type":393,"tag":434,"props":1081,"children":1082},{"class":436,"line":514},[1083,1087,1092,1096],{"type":393,"tag":434,"props":1084,"children":1085},{"style":1014},[1086],{"type":399,"value":1017},{"type":393,"tag":434,"props":1088,"children":1089},{"style":1020},[1090],{"type":399,"value":1091}," matchComment",{"type":393,"tag":434,"props":1093,"children":1094},{"style":462},[1095],{"type":399,"value":1028},{"type":393,"tag":434,"props":1097,"children":1098},{"style":462},[1099],{"type":399,"value":465},{"type":393,"tag":434,"props":1101,"children":1102},{"class":436,"line":536},[1103],{"type":393,"tag":434,"props":1104,"children":1105},{"style":441},[1106],{"type":399,"value":1107},"    // 快速跳过非注释部分代码\n",{"type":393,"tag":434,"props":1109,"children":1110},{"class":436,"line":545},[1111,1116,1120,1124,1128,1133,1137,1142,1147,1152,1157,1162,1167,1172,1176,1181,1186,1190,1194,1198,1202,1206,1210,1214,1218,1222,1227,1231,1235],{"type":393,"tag":434,"props":1112,"children":1113},{"style":1038},[1114],{"type":399,"value":1115},"    if",{"type":393,"tag":434,"props":1117,"children":1118},{"style":1044},[1119],{"type":399,"value":1047},{"type":393,"tag":434,"props":1121,"children":1122},{"style":1050},[1123],{"type":399,"value":1053},{"type":393,"tag":434,"props":1125,"children":1126},{"style":462},[1127],{"type":399,"value":454},{"type":393,"tag":434,"props":1129,"children":1130},{"style":498},[1131],{"type":399,"value":1132},"cssText",{"type":393,"tag":434,"props":1134,"children":1135},{"style":462},[1136],{"type":399,"value":454},{"type":393,"tag":434,"props":1138,"children":1139},{"style":1060},[1140],{"type":399,"value":1141},"charAt",{"type":393,"tag":434,"props":1143,"children":1144},{"style":1044},[1145],{"type":399,"value":1146},"(",{"type":393,"tag":434,"props":1148,"children":1149},{"style":483},[1150],{"type":399,"value":1151},"0",{"type":393,"tag":434,"props":1153,"children":1154},{"style":1044},[1155],{"type":399,"value":1156},") ",{"type":393,"tag":434,"props":1158,"children":1159},{"style":594},[1160],{"type":399,"value":1161},"!==",{"type":393,"tag":434,"props":1163,"children":1164},{"style":600},[1165],{"type":399,"value":1166}," \"",{"type":393,"tag":434,"props":1168,"children":1169},{"style":606},[1170],{"type":399,"value":1171},"/",{"type":393,"tag":434,"props":1173,"children":1174},{"style":600},[1175],{"type":399,"value":603},{"type":393,"tag":434,"props":1177,"children":1178},{"style":594},[1179],{"type":399,"value":1180}," ||",{"type":393,"tag":434,"props":1182,"children":1183},{"style":1050},[1184],{"type":399,"value":1185}," this",{"type":393,"tag":434,"props":1187,"children":1188},{"style":462},[1189],{"type":399,"value":454},{"type":393,"tag":434,"props":1191,"children":1192},{"style":498},[1193],{"type":399,"value":1132},{"type":393,"tag":434,"props":1195,"children":1196},{"style":462},[1197],{"type":399,"value":454},{"type":393,"tag":434,"props":1199,"children":1200},{"style":1060},[1201],{"type":399,"value":1141},{"type":393,"tag":434,"props":1203,"children":1204},{"style":1044},[1205],{"type":399,"value":1146},{"type":393,"tag":434,"props":1207,"children":1208},{"style":483},[1209],{"type":399,"value":917},{"type":393,"tag":434,"props":1211,"children":1212},{"style":1044},[1213],{"type":399,"value":1156},{"type":393,"tag":434,"props":1215,"children":1216},{"style":594},[1217],{"type":399,"value":1161},{"type":393,"tag":434,"props":1219,"children":1220},{"style":600},[1221],{"type":399,"value":1166},{"type":393,"tag":434,"props":1223,"children":1224},{"style":606},[1225],{"type":399,"value":1226},"*",{"type":393,"tag":434,"props":1228,"children":1229},{"style":600},[1230],{"type":399,"value":603},{"type":393,"tag":434,"props":1232,"children":1233},{"style":1044},[1234],{"type":399,"value":1156},{"type":393,"tag":434,"props":1236,"children":1237},{"style":462},[1238],{"type":399,"value":1239},"{\n",{"type":393,"tag":434,"props":1241,"children":1242},{"class":436,"line":554},[1243,1248,1254],{"type":393,"tag":434,"props":1244,"children":1245},{"style":1038},[1246],{"type":399,"value":1247},"      return",{"type":393,"tag":434,"props":1249,"children":1251},{"style":1250},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1252],{"type":399,"value":1253}," false",{"type":393,"tag":434,"props":1255,"children":1256},{"style":462},[1257],{"type":399,"value":491},{"type":393,"tag":434,"props":1259,"children":1260},{"class":436,"line":564},[1261],{"type":393,"tag":434,"props":1262,"children":1263},{"style":462},[1264],{"type":399,"value":1265},"    }\n",{"type":393,"tag":434,"props":1267,"children":1268},{"class":436,"line":573},[1269],{"type":393,"tag":434,"props":1270,"children":1271},{"style":441},[1272],{"type":399,"value":1273},"    // ...\n",{"type":393,"tag":434,"props":1275,"children":1276},{"class":436,"line":634},[1277,1282,1287],{"type":393,"tag":434,"props":1278,"children":1279},{"style":1038},[1280],{"type":399,"value":1281},"    return",{"type":393,"tag":434,"props":1283,"children":1284},{"style":1250},[1285],{"type":399,"value":1286}," true",{"type":393,"tag":434,"props":1288,"children":1289},{"style":462},[1290],{"type":399,"value":491},{"type":393,"tag":434,"props":1292,"children":1293},{"class":436,"line":654},[1294],{"type":393,"tag":434,"props":1295,"children":1296},{"style":462},[1297],{"type":399,"value":542},{"type":393,"tag":434,"props":1299,"children":1300},{"class":436,"line":670},[1301],{"type":393,"tag":434,"props":1302,"children":1303},{"style":462},[1304],{"type":399,"value":551},{"type":393,"tag":401,"props":1306,"children":1307},{},[1308],{"type":399,"value":1309},"在选择解析注释内容的方法上，micro-app 没有使用正则，而是用了下标递增的办法。暂不清楚原因，感兴趣的小伙伴可以试试几种相关办法的性能对比。",{"type":393,"tag":423,"props":1311,"children":1313},{"className":983,"code":1312,"language":985,"meta":387,"style":387},"let i = 2;\nwhile (\n  this.cssText.charAt(i) !== \"\" &&\n  (this.cssText.charAt(i) !== \"*\" || this.cssText.charAt(i + 1) !== \"/\")\n) {\n  ++i;\n}\ni += 2;\n\nlet commentText = this.cssText.slice(2, i - 2);\n/* ... */\nthis.cssText = this.cssText.slice(i);\n",[1314],{"type":393,"tag":430,"props":1315,"children":1316},{"__ignoreMap":387},[1317,1342,1355,1398,1509,1520,1537,1544,1565,1572,1645,1653],{"type":393,"tag":434,"props":1318,"children":1319},{"class":436,"line":437},[1320,1325,1330,1334,1338],{"type":393,"tag":434,"props":1321,"children":1322},{"style":995},[1323],{"type":399,"value":1324},"let",{"type":393,"tag":434,"props":1326,"children":1327},{"style":498},[1328],{"type":399,"value":1329}," i ",{"type":393,"tag":434,"props":1331,"children":1332},{"style":594},[1333],{"type":399,"value":597},{"type":393,"tag":434,"props":1335,"children":1336},{"style":483},[1337],{"type":399,"value":529},{"type":393,"tag":434,"props":1339,"children":1340},{"style":462},[1341],{"type":399,"value":491},{"type":393,"tag":434,"props":1343,"children":1344},{"class":436,"line":447},[1345,1350],{"type":393,"tag":434,"props":1346,"children":1347},{"style":1038},[1348],{"type":399,"value":1349},"while",{"type":393,"tag":434,"props":1351,"children":1352},{"style":498},[1353],{"type":399,"value":1354}," (\n",{"type":393,"tag":434,"props":1356,"children":1357},{"class":436,"line":468},[1358,1363,1367,1371,1375,1379,1384,1388,1393],{"type":393,"tag":434,"props":1359,"children":1360},{"style":1050},[1361],{"type":399,"value":1362},"  this",{"type":393,"tag":434,"props":1364,"children":1365},{"style":462},[1366],{"type":399,"value":454},{"type":393,"tag":434,"props":1368,"children":1369},{"style":498},[1370],{"type":399,"value":1132},{"type":393,"tag":434,"props":1372,"children":1373},{"style":462},[1374],{"type":399,"value":454},{"type":393,"tag":434,"props":1376,"children":1377},{"style":1060},[1378],{"type":399,"value":1141},{"type":393,"tag":434,"props":1380,"children":1381},{"style":498},[1382],{"type":399,"value":1383},"(i) ",{"type":393,"tag":434,"props":1385,"children":1386},{"style":594},[1387],{"type":399,"value":1161},{"type":393,"tag":434,"props":1389,"children":1390},{"style":600},[1391],{"type":399,"value":1392}," \"\"",{"type":393,"tag":434,"props":1394,"children":1395},{"style":594},[1396],{"type":399,"value":1397}," &&\n",{"type":393,"tag":434,"props":1399,"children":1400},{"class":436,"line":494},[1401,1406,1410,1414,1418,1422,1426,1430,1434,1438,1442,1446,1450,1454,1458,1462,1466,1470,1475,1480,1484,1488,1492,1496,1500,1504],{"type":393,"tag":434,"props":1402,"children":1403},{"style":498},[1404],{"type":399,"value":1405},"  (",{"type":393,"tag":434,"props":1407,"children":1408},{"style":1050},[1409],{"type":399,"value":1053},{"type":393,"tag":434,"props":1411,"children":1412},{"style":462},[1413],{"type":399,"value":454},{"type":393,"tag":434,"props":1415,"children":1416},{"style":498},[1417],{"type":399,"value":1132},{"type":393,"tag":434,"props":1419,"children":1420},{"style":462},[1421],{"type":399,"value":454},{"type":393,"tag":434,"props":1423,"children":1424},{"style":1060},[1425],{"type":399,"value":1141},{"type":393,"tag":434,"props":1427,"children":1428},{"style":498},[1429],{"type":399,"value":1383},{"type":393,"tag":434,"props":1431,"children":1432},{"style":594},[1433],{"type":399,"value":1161},{"type":393,"tag":434,"props":1435,"children":1436},{"style":600},[1437],{"type":399,"value":1166},{"type":393,"tag":434,"props":1439,"children":1440},{"style":606},[1441],{"type":399,"value":1226},{"type":393,"tag":434,"props":1443,"children":1444},{"style":600},[1445],{"type":399,"value":603},{"type":393,"tag":434,"props":1447,"children":1448},{"style":594},[1449],{"type":399,"value":1180},{"type":393,"tag":434,"props":1451,"children":1452},{"style":1050},[1453],{"type":399,"value":1185},{"type":393,"tag":434,"props":1455,"children":1456},{"style":462},[1457],{"type":399,"value":454},{"type":393,"tag":434,"props":1459,"children":1460},{"style":498},[1461],{"type":399,"value":1132},{"type":393,"tag":434,"props":1463,"children":1464},{"style":462},[1465],{"type":399,"value":454},{"type":393,"tag":434,"props":1467,"children":1468},{"style":1060},[1469],{"type":399,"value":1141},{"type":393,"tag":434,"props":1471,"children":1472},{"style":498},[1473],{"type":399,"value":1474},"(i ",{"type":393,"tag":434,"props":1476,"children":1477},{"style":594},[1478],{"type":399,"value":1479},"+",{"type":393,"tag":434,"props":1481,"children":1482},{"style":483},[1483],{"type":399,"value":486},{"type":393,"tag":434,"props":1485,"children":1486},{"style":498},[1487],{"type":399,"value":1156},{"type":393,"tag":434,"props":1489,"children":1490},{"style":594},[1491],{"type":399,"value":1161},{"type":393,"tag":434,"props":1493,"children":1494},{"style":600},[1495],{"type":399,"value":1166},{"type":393,"tag":434,"props":1497,"children":1498},{"style":606},[1499],{"type":399,"value":1171},{"type":393,"tag":434,"props":1501,"children":1502},{"style":600},[1503],{"type":399,"value":603},{"type":393,"tag":434,"props":1505,"children":1506},{"style":498},[1507],{"type":399,"value":1508},")\n",{"type":393,"tag":434,"props":1510,"children":1511},{"class":436,"line":514},[1512,1516],{"type":393,"tag":434,"props":1513,"children":1514},{"style":498},[1515],{"type":399,"value":1156},{"type":393,"tag":434,"props":1517,"children":1518},{"style":462},[1519],{"type":399,"value":1239},{"type":393,"tag":434,"props":1521,"children":1522},{"class":436,"line":536},[1523,1528,1533],{"type":393,"tag":434,"props":1524,"children":1525},{"style":594},[1526],{"type":399,"value":1527},"  ++",{"type":393,"tag":434,"props":1529,"children":1530},{"style":498},[1531],{"type":399,"value":1532},"i",{"type":393,"tag":434,"props":1534,"children":1535},{"style":462},[1536],{"type":399,"value":491},{"type":393,"tag":434,"props":1538,"children":1539},{"class":436,"line":545},[1540],{"type":393,"tag":434,"props":1541,"children":1542},{"style":462},[1543],{"type":399,"value":551},{"type":393,"tag":434,"props":1545,"children":1546},{"class":436,"line":554},[1547,1552,1557,1561],{"type":393,"tag":434,"props":1548,"children":1549},{"style":498},[1550],{"type":399,"value":1551},"i ",{"type":393,"tag":434,"props":1553,"children":1554},{"style":594},[1555],{"type":399,"value":1556},"+=",{"type":393,"tag":434,"props":1558,"children":1559},{"style":483},[1560],{"type":399,"value":529},{"type":393,"tag":434,"props":1562,"children":1563},{"style":462},[1564],{"type":399,"value":491},{"type":393,"tag":434,"props":1566,"children":1567},{"class":436,"line":564},[1568],{"type":393,"tag":434,"props":1569,"children":1570},{"emptyLinePlaceholder":558},[1571],{"type":399,"value":561},{"type":393,"tag":434,"props":1573,"children":1574},{"class":436,"line":573},[1575,1579,1584,1588,1592,1596,1600,1604,1609,1613,1618,1623,1627,1632,1636,1641],{"type":393,"tag":434,"props":1576,"children":1577},{"style":995},[1578],{"type":399,"value":1324},{"type":393,"tag":434,"props":1580,"children":1581},{"style":498},[1582],{"type":399,"value":1583}," commentText ",{"type":393,"tag":434,"props":1585,"children":1586},{"style":594},[1587],{"type":399,"value":597},{"type":393,"tag":434,"props":1589,"children":1590},{"style":1050},[1591],{"type":399,"value":1185},{"type":393,"tag":434,"props":1593,"children":1594},{"style":462},[1595],{"type":399,"value":454},{"type":393,"tag":434,"props":1597,"children":1598},{"style":498},[1599],{"type":399,"value":1132},{"type":393,"tag":434,"props":1601,"children":1602},{"style":462},[1603],{"type":399,"value":454},{"type":393,"tag":434,"props":1605,"children":1606},{"style":1060},[1607],{"type":399,"value":1608},"slice",{"type":393,"tag":434,"props":1610,"children":1611},{"style":498},[1612],{"type":399,"value":1146},{"type":393,"tag":434,"props":1614,"children":1615},{"style":483},[1616],{"type":399,"value":1617},"2",{"type":393,"tag":434,"props":1619,"children":1620},{"style":462},[1621],{"type":399,"value":1622},",",{"type":393,"tag":434,"props":1624,"children":1625},{"style":498},[1626],{"type":399,"value":1329},{"type":393,"tag":434,"props":1628,"children":1629},{"style":594},[1630],{"type":399,"value":1631},"-",{"type":393,"tag":434,"props":1633,"children":1634},{"style":483},[1635],{"type":399,"value":529},{"type":393,"tag":434,"props":1637,"children":1638},{"style":498},[1639],{"type":399,"value":1640},")",{"type":393,"tag":434,"props":1642,"children":1643},{"style":462},[1644],{"type":399,"value":491},{"type":393,"tag":434,"props":1646,"children":1647},{"class":436,"line":634},[1648],{"type":393,"tag":434,"props":1649,"children":1650},{"style":441},[1651],{"type":399,"value":1652},"/* ... */\n",{"type":393,"tag":434,"props":1654,"children":1655},{"class":436,"line":654},[1656,1660,1664,1669,1673,1677,1681,1685,1689,1693,1698],{"type":393,"tag":434,"props":1657,"children":1658},{"style":1050},[1659],{"type":399,"value":1053},{"type":393,"tag":434,"props":1661,"children":1662},{"style":462},[1663],{"type":399,"value":454},{"type":393,"tag":434,"props":1665,"children":1666},{"style":498},[1667],{"type":399,"value":1668},"cssText ",{"type":393,"tag":434,"props":1670,"children":1671},{"style":594},[1672],{"type":399,"value":597},{"type":393,"tag":434,"props":1674,"children":1675},{"style":1050},[1676],{"type":399,"value":1185},{"type":393,"tag":434,"props":1678,"children":1679},{"style":462},[1680],{"type":399,"value":454},{"type":393,"tag":434,"props":1682,"children":1683},{"style":498},[1684],{"type":399,"value":1132},{"type":393,"tag":434,"props":1686,"children":1687},{"style":462},[1688],{"type":399,"value":454},{"type":393,"tag":434,"props":1690,"children":1691},{"style":1060},[1692],{"type":399,"value":1608},{"type":393,"tag":434,"props":1694,"children":1695},{"style":498},[1696],{"type":399,"value":1697},"(i)",{"type":393,"tag":434,"props":1699,"children":1700},{"style":462},[1701],{"type":399,"value":491},{"type":393,"tag":401,"props":1703,"children":1704},{},[1705,1707,1713,1715,1720,1722,1728],{"type":399,"value":1706},"注释的正文结果保存在了变量 ",{"type":393,"tag":430,"props":1708,"children":1710},{"className":1709},[],[1711],{"type":399,"value":1712},"commentText",{"type":399,"value":1714}," 中，这样可以判断 ",{"type":393,"tag":430,"props":1716,"children":1718},{"className":1717},[],[1719],{"type":399,"value":1712},{"type":399,"value":1721}," 的内容来实现通过注释禁用某个选择器、禁用某行的样式隔离之类的功能。比如想让 ",{"type":393,"tag":430,"props":1723,"children":1725},{"className":1724},[],[1726],{"type":399,"value":1727},".test2",{"type":399,"value":1729}," 选择器不被 scoped 规则覆盖，我们可以在业务代码中这样写。",{"type":393,"tag":423,"props":1731,"children":1733},{"className":425,"code":1732,"language":427,"meta":387,"style":387},"/*! scopecss-disable-next-line */\n.test2 {\n  background: url(/test.png);\n}\n",[1734],{"type":393,"tag":430,"props":1735,"children":1736},{"__ignoreMap":387},[1737,1745,1761,1794],{"type":393,"tag":434,"props":1738,"children":1739},{"class":436,"line":437},[1740],{"type":393,"tag":434,"props":1741,"children":1742},{"style":441},[1743],{"type":399,"value":1744},"/*! scopecss-disable-next-line */\n",{"type":393,"tag":434,"props":1746,"children":1747},{"class":436,"line":447},[1748,1752,1757],{"type":393,"tag":434,"props":1749,"children":1750},{"style":451},[1751],{"type":399,"value":454},{"type":393,"tag":434,"props":1753,"children":1754},{"style":457},[1755],{"type":399,"value":1756},"test2",{"type":393,"tag":434,"props":1758,"children":1759},{"style":462},[1760],{"type":399,"value":465},{"type":393,"tag":434,"props":1762,"children":1763},{"class":436,"line":468},[1764,1769,1773,1779,1783,1789],{"type":393,"tag":434,"props":1765,"children":1766},{"style":472},[1767],{"type":399,"value":1768},"  background",{"type":393,"tag":434,"props":1770,"children":1771},{"style":462},[1772],{"type":399,"value":480},{"type":393,"tag":434,"props":1774,"children":1776},{"style":1775},"--shiki-light:#6182B8;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF",[1777],{"type":399,"value":1778}," url",{"type":393,"tag":434,"props":1780,"children":1781},{"style":462},[1782],{"type":399,"value":1146},{"type":393,"tag":434,"props":1784,"children":1786},{"style":1785},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[1787],{"type":399,"value":1788},"/test.png",{"type":393,"tag":434,"props":1790,"children":1791},{"style":462},[1792],{"type":399,"value":1793},");\n",{"type":393,"tag":434,"props":1795,"children":1796},{"class":436,"line":494},[1797],{"type":393,"tag":434,"props":1798,"children":1799},{"style":462},[1800],{"type":399,"value":551},{"type":393,"tag":948,"props":1802,"children":1804},{"id":1803},"输入输出",[1805],{"type":399,"value":1803},{"type":393,"tag":401,"props":1807,"children":1808},{},[1809,1811,1816,1818,1824],{"type":399,"value":1810},"“解析注释”中“解析”实际指对输入的 CSS 源文件待处理部分以及处理好的输出部分做出改变。这里引申出解析器里两个关键状态，",{"type":393,"tag":430,"props":1812,"children":1814},{"className":1813},[],[1815],{"type":399,"value":1132},{"type":399,"value":1817}," 和 ",{"type":393,"tag":430,"props":1819,"children":1821},{"className":1820},[],[1822],{"type":399,"value":1823},"result",{"type":399,"value":1825},"，分别代表待解析的内容和最终输出结果。",{"type":393,"tag":401,"props":1827,"children":1828},{},[1829,1834,1836,1841,1843,1849],{"type":393,"tag":430,"props":1830,"children":1832},{"className":1831},[],[1833],{"type":399,"value":1132},{"type":399,"value":1835}," 随着循环应当逐渐减小直到为空，此时代表解析完成。",{"type":393,"tag":430,"props":1837,"children":1839},{"className":1838},[],[1840],{"type":399,"value":1823},{"type":399,"value":1842}," 能被内部方法 ",{"type":393,"tag":430,"props":1844,"children":1846},{"className":1845},[],[1847],{"type":399,"value":1848},"recordResult",{"type":399,"value":1850}," 改变，比如如果要把注释的正文内容记录到输出结果，可以这样使用：",{"type":393,"tag":423,"props":1852,"children":1854},{"className":983,"code":1853,"language":985,"meta":387,"style":387},"this.recordResult(`/*${commentText}*/`);\n// 相当于：this.result += `/*${commentText}*/`\n",[1855],{"type":393,"tag":430,"props":1856,"children":1857},{"__ignoreMap":387},[1858,1919],{"type":393,"tag":434,"props":1859,"children":1860},{"class":436,"line":437},[1861,1865,1869,1873,1877,1882,1887,1893,1897,1902,1907,1911,1915],{"type":393,"tag":434,"props":1862,"children":1863},{"style":1050},[1864],{"type":399,"value":1053},{"type":393,"tag":434,"props":1866,"children":1867},{"style":462},[1868],{"type":399,"value":454},{"type":393,"tag":434,"props":1870,"children":1871},{"style":1060},[1872],{"type":399,"value":1848},{"type":393,"tag":434,"props":1874,"children":1875},{"style":498},[1876],{"type":399,"value":1146},{"type":393,"tag":434,"props":1878,"children":1879},{"style":600},[1880],{"type":399,"value":1881},"`",{"type":393,"tag":434,"props":1883,"children":1884},{"style":606},[1885],{"type":399,"value":1886},"/*",{"type":393,"tag":434,"props":1888,"children":1890},{"style":1889},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#F92672",[1891],{"type":399,"value":1892},"${",{"type":393,"tag":434,"props":1894,"children":1895},{"style":498},[1896],{"type":399,"value":1712},{"type":393,"tag":434,"props":1898,"children":1899},{"style":1889},[1900],{"type":399,"value":1901},"}",{"type":393,"tag":434,"props":1903,"children":1904},{"style":606},[1905],{"type":399,"value":1906},"*/",{"type":393,"tag":434,"props":1908,"children":1909},{"style":600},[1910],{"type":399,"value":1881},{"type":393,"tag":434,"props":1912,"children":1913},{"style":498},[1914],{"type":399,"value":1640},{"type":393,"tag":434,"props":1916,"children":1917},{"style":462},[1918],{"type":399,"value":491},{"type":393,"tag":434,"props":1920,"children":1921},{"class":436,"line":447},[1922],{"type":393,"tag":434,"props":1923,"children":1924},{"style":441},[1925],{"type":399,"value":1926},"// 相当于：this.result += `/*${commentText}*/`\n",{"type":393,"tag":948,"props":1928,"children":1930},{"id":1929},"解析规则集",[1931],{"type":399,"value":1929},{"type":393,"tag":401,"props":1933,"children":1934},{},[1935],{"type":399,"value":1936},"规则集的解析是整个解析的核心过程。原理与解析注释类似，也是一个 while 循环。每一轮循环都会尝试匹配一条规则，并且将多余的注释和空白字符匹配出来。",{"type":393,"tag":423,"props":1938,"children":1940},{"className":983,"code":1939,"language":985,"meta":387,"style":387},"private matchRules (): void {\n  this.matchLeadingSpaces()\n  this.matchComments()\n  while (\n    this.cssText.length &&\n    this.cssText.charAt(0) !== '}' &&\n    (this.matchAtRule() || this.matchStyleRule())\n  ) {\n    this.matchComments()\n    this.matchLeadingSpaces()\n  }\n}\n",[1941],{"type":393,"tag":430,"props":1942,"children":1943},{"__ignoreMap":387},[1944,1971,1992,2012,2024,2053,2110,2159,2171,2190,2209,2216],{"type":393,"tag":434,"props":1945,"children":1946},{"class":436,"line":437},[1947,1952,1957,1962,1967],{"type":393,"tag":434,"props":1948,"children":1949},{"style":498},[1950],{"type":399,"value":1951},"private ",{"type":393,"tag":434,"props":1953,"children":1954},{"style":1060},[1955],{"type":399,"value":1956},"matchRules",{"type":393,"tag":434,"props":1958,"children":1959},{"style":498},[1960],{"type":399,"value":1961}," (): ",{"type":393,"tag":434,"props":1963,"children":1964},{"style":594},[1965],{"type":399,"value":1966},"void",{"type":393,"tag":434,"props":1968,"children":1969},{"style":462},[1970],{"type":399,"value":465},{"type":393,"tag":434,"props":1972,"children":1973},{"class":436,"line":447},[1974,1978,1982,1987],{"type":393,"tag":434,"props":1975,"children":1976},{"style":1050},[1977],{"type":399,"value":1362},{"type":393,"tag":434,"props":1979,"children":1980},{"style":462},[1981],{"type":399,"value":454},{"type":393,"tag":434,"props":1983,"children":1984},{"style":1060},[1985],{"type":399,"value":1986},"matchLeadingSpaces",{"type":393,"tag":434,"props":1988,"children":1989},{"style":1044},[1990],{"type":399,"value":1991},"()\n",{"type":393,"tag":434,"props":1993,"children":1994},{"class":436,"line":468},[1995,1999,2003,2008],{"type":393,"tag":434,"props":1996,"children":1997},{"style":1050},[1998],{"type":399,"value":1362},{"type":393,"tag":434,"props":2000,"children":2001},{"style":462},[2002],{"type":399,"value":454},{"type":393,"tag":434,"props":2004,"children":2005},{"style":1060},[2006],{"type":399,"value":2007},"matchComments",{"type":393,"tag":434,"props":2009,"children":2010},{"style":1044},[2011],{"type":399,"value":1991},{"type":393,"tag":434,"props":2013,"children":2014},{"class":436,"line":494},[2015,2020],{"type":393,"tag":434,"props":2016,"children":2017},{"style":1038},[2018],{"type":399,"value":2019},"  while",{"type":393,"tag":434,"props":2021,"children":2022},{"style":1044},[2023],{"type":399,"value":1354},{"type":393,"tag":434,"props":2025,"children":2026},{"class":436,"line":514},[2027,2032,2036,2040,2044,2049],{"type":393,"tag":434,"props":2028,"children":2029},{"style":1050},[2030],{"type":399,"value":2031},"    this",{"type":393,"tag":434,"props":2033,"children":2034},{"style":462},[2035],{"type":399,"value":454},{"type":393,"tag":434,"props":2037,"children":2038},{"style":498},[2039],{"type":399,"value":1132},{"type":393,"tag":434,"props":2041,"children":2042},{"style":462},[2043],{"type":399,"value":454},{"type":393,"tag":434,"props":2045,"children":2046},{"style":504},[2047],{"type":399,"value":2048},"length",{"type":393,"tag":434,"props":2050,"children":2051},{"style":594},[2052],{"type":399,"value":1397},{"type":393,"tag":434,"props":2054,"children":2055},{"class":436,"line":536},[2056,2060,2064,2068,2072,2076,2080,2084,2088,2092,2097,2101,2106],{"type":393,"tag":434,"props":2057,"children":2058},{"style":1050},[2059],{"type":399,"value":2031},{"type":393,"tag":434,"props":2061,"children":2062},{"style":462},[2063],{"type":399,"value":454},{"type":393,"tag":434,"props":2065,"children":2066},{"style":498},[2067],{"type":399,"value":1132},{"type":393,"tag":434,"props":2069,"children":2070},{"style":462},[2071],{"type":399,"value":454},{"type":393,"tag":434,"props":2073,"children":2074},{"style":1060},[2075],{"type":399,"value":1141},{"type":393,"tag":434,"props":2077,"children":2078},{"style":1044},[2079],{"type":399,"value":1146},{"type":393,"tag":434,"props":2081,"children":2082},{"style":483},[2083],{"type":399,"value":1151},{"type":393,"tag":434,"props":2085,"children":2086},{"style":1044},[2087],{"type":399,"value":1156},{"type":393,"tag":434,"props":2089,"children":2090},{"style":594},[2091],{"type":399,"value":1161},{"type":393,"tag":434,"props":2093,"children":2094},{"style":600},[2095],{"type":399,"value":2096}," '",{"type":393,"tag":434,"props":2098,"children":2099},{"style":606},[2100],{"type":399,"value":1901},{"type":393,"tag":434,"props":2102,"children":2103},{"style":600},[2104],{"type":399,"value":2105},"'",{"type":393,"tag":434,"props":2107,"children":2108},{"style":594},[2109],{"type":399,"value":1397},{"type":393,"tag":434,"props":2111,"children":2112},{"class":436,"line":545},[2113,2118,2122,2126,2131,2136,2141,2145,2149,2154],{"type":393,"tag":434,"props":2114,"children":2115},{"style":1044},[2116],{"type":399,"value":2117},"    (",{"type":393,"tag":434,"props":2119,"children":2120},{"style":1050},[2121],{"type":399,"value":1053},{"type":393,"tag":434,"props":2123,"children":2124},{"style":462},[2125],{"type":399,"value":454},{"type":393,"tag":434,"props":2127,"children":2128},{"style":1060},[2129],{"type":399,"value":2130},"matchAtRule",{"type":393,"tag":434,"props":2132,"children":2133},{"style":1044},[2134],{"type":399,"value":2135},"() ",{"type":393,"tag":434,"props":2137,"children":2138},{"style":594},[2139],{"type":399,"value":2140},"||",{"type":393,"tag":434,"props":2142,"children":2143},{"style":1050},[2144],{"type":399,"value":1185},{"type":393,"tag":434,"props":2146,"children":2147},{"style":462},[2148],{"type":399,"value":454},{"type":393,"tag":434,"props":2150,"children":2151},{"style":1060},[2152],{"type":399,"value":2153},"matchStyleRule",{"type":393,"tag":434,"props":2155,"children":2156},{"style":1044},[2157],{"type":399,"value":2158},"())\n",{"type":393,"tag":434,"props":2160,"children":2161},{"class":436,"line":554},[2162,2167],{"type":393,"tag":434,"props":2163,"children":2164},{"style":1044},[2165],{"type":399,"value":2166},"  ) ",{"type":393,"tag":434,"props":2168,"children":2169},{"style":462},[2170],{"type":399,"value":1239},{"type":393,"tag":434,"props":2172,"children":2173},{"class":436,"line":564},[2174,2178,2182,2186],{"type":393,"tag":434,"props":2175,"children":2176},{"style":1050},[2177],{"type":399,"value":2031},{"type":393,"tag":434,"props":2179,"children":2180},{"style":462},[2181],{"type":399,"value":454},{"type":393,"tag":434,"props":2183,"children":2184},{"style":1060},[2185],{"type":399,"value":2007},{"type":393,"tag":434,"props":2187,"children":2188},{"style":1044},[2189],{"type":399,"value":1991},{"type":393,"tag":434,"props":2191,"children":2192},{"class":436,"line":573},[2193,2197,2201,2205],{"type":393,"tag":434,"props":2194,"children":2195},{"style":1050},[2196],{"type":399,"value":2031},{"type":393,"tag":434,"props":2198,"children":2199},{"style":462},[2200],{"type":399,"value":454},{"type":393,"tag":434,"props":2202,"children":2203},{"style":1060},[2204],{"type":399,"value":1986},{"type":393,"tag":434,"props":2206,"children":2207},{"style":1044},[2208],{"type":399,"value":1991},{"type":393,"tag":434,"props":2210,"children":2211},{"class":436,"line":634},[2212],{"type":393,"tag":434,"props":2213,"children":2214},{"style":462},[2215],{"type":399,"value":542},{"type":393,"tag":434,"props":2217,"children":2218},{"class":436,"line":654},[2219],{"type":393,"tag":434,"props":2220,"children":2221},{"style":462},[2222],{"type":399,"value":551},{"type":393,"tag":401,"props":2224,"children":2225},{},[2226,2228,2233],{"type":399,"value":2227},"匹配注释我们知道它是使用了下标递增 + Slice 的方法，匹配空白这里则是用的一个非常简单的正则。见下 ",{"type":393,"tag":430,"props":2229,"children":2231},{"className":2230},[],[2232],{"type":399,"value":1986},{"type":399,"value":2234}," 函数。",{"type":393,"tag":423,"props":2236,"children":2238},{"className":983,"code":2237,"language":985,"meta":387,"style":387},"private matchLeadingSpaces (): void {\n  this.commonMatch(/^\\s*/, false)\n}\n",[2239],{"type":393,"tag":430,"props":2240,"children":2241},{"__ignoreMap":387},[2242,2265,2320],{"type":393,"tag":434,"props":2243,"children":2244},{"class":436,"line":437},[2245,2249,2253,2257,2261],{"type":393,"tag":434,"props":2246,"children":2247},{"style":498},[2248],{"type":399,"value":1951},{"type":393,"tag":434,"props":2250,"children":2251},{"style":1060},[2252],{"type":399,"value":1986},{"type":393,"tag":434,"props":2254,"children":2255},{"style":498},[2256],{"type":399,"value":1961},{"type":393,"tag":434,"props":2258,"children":2259},{"style":594},[2260],{"type":399,"value":1966},{"type":393,"tag":434,"props":2262,"children":2263},{"style":462},[2264],{"type":399,"value":465},{"type":393,"tag":434,"props":2266,"children":2267},{"class":436,"line":447},[2268,2272,2276,2281,2285,2289,2294,2300,2304,2308,2312,2316],{"type":393,"tag":434,"props":2269,"children":2270},{"style":1050},[2271],{"type":399,"value":1362},{"type":393,"tag":434,"props":2273,"children":2274},{"style":462},[2275],{"type":399,"value":454},{"type":393,"tag":434,"props":2277,"children":2278},{"style":1060},[2279],{"type":399,"value":2280},"commonMatch",{"type":393,"tag":434,"props":2282,"children":2283},{"style":1044},[2284],{"type":399,"value":1146},{"type":393,"tag":434,"props":2286,"children":2287},{"style":600},[2288],{"type":399,"value":1171},{"type":393,"tag":434,"props":2290,"children":2291},{"style":1038},[2292],{"type":399,"value":2293},"^",{"type":393,"tag":434,"props":2295,"children":2297},{"style":2296},"--shiki-light:#91B859;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2298],{"type":399,"value":2299},"\\s",{"type":393,"tag":434,"props":2301,"children":2302},{"style":594},[2303],{"type":399,"value":1226},{"type":393,"tag":434,"props":2305,"children":2306},{"style":600},[2307],{"type":399,"value":1171},{"type":393,"tag":434,"props":2309,"children":2310},{"style":462},[2311],{"type":399,"value":1622},{"type":393,"tag":434,"props":2313,"children":2314},{"style":1250},[2315],{"type":399,"value":1253},{"type":393,"tag":434,"props":2317,"children":2318},{"style":1044},[2319],{"type":399,"value":1508},{"type":393,"tag":434,"props":2321,"children":2322},{"class":436,"line":468},[2323],{"type":393,"tag":434,"props":2324,"children":2325},{"style":462},[2326],{"type":399,"value":551},{"type":393,"tag":401,"props":2328,"children":2329},{},[2330,2332,2337,2339,2344,2345,2350,2352,2357,2359,2364],{"type":399,"value":2331},"可以想象，",{"type":393,"tag":430,"props":2333,"children":2335},{"className":2334},[],[2336],{"type":399,"value":2280},{"type":399,"value":2338}," 应当会对状态 ",{"type":393,"tag":430,"props":2340,"children":2342},{"className":2341},[],[2343],{"type":399,"value":1132},{"type":399,"value":1817},{"type":393,"tag":430,"props":2346,"children":2348},{"className":2347},[],[2349],{"type":399,"value":1823},{"type":399,"value":2351}," 做一些操作。实际上，commonMatch 两个参数分别是用于匹配 ",{"type":393,"tag":430,"props":2353,"children":2355},{"className":2354},[],[2356],{"type":399,"value":1132},{"type":399,"value":2358}," 的正则，及跳过标记。如果在待匹配内容中匹配到了字符串，便把匹配的内容从中移除；跳过标记则意味着当确认跳过时，匹配的内容将不会被记录到输出结果中。以上面的 ",{"type":393,"tag":430,"props":2360,"children":2362},{"className":2361},[],[2363],{"type":399,"value":1986},{"type":399,"value":2365}," 函数举例，如果在待匹配内容中匹配到空白字符，那么会将其丢弃不做处理。",{"type":393,"tag":401,"props":2367,"children":2368},{},[2369,2374,2376,2381],{"type":393,"tag":430,"props":2370,"children":2372},{"className":2371},[],[2373],{"type":399,"value":2280},{"type":399,"value":2375}," 可谓是解析器匹配逻辑的核心，只要理解了它，那么我们回到上面提到的样式规则匹配 ",{"type":393,"tag":430,"props":2377,"children":2379},{"className":2378},[],[2380],{"type":399,"value":2153},{"type":399,"value":2382},"，会发现其过程非常简单。简单来说只有三步，匹配选择器、记录解析后的选择器、解析（并记录）声明。结束条件只有成功解析以及选择器解析报错或声明解析报错。",{"type":393,"tag":423,"props":2384,"children":2386},{"className":983,"code":2385,"language":985,"meta":387,"style":387},"private matchStyleRule (): boolean | void {\n  const selectors = this.formatSelector(true)\n  this.scopecssDisableNextLine = false\n  if (!selectors) return parseError('selector missing', this.linkPath)\n  this.recordResult(selectors)\n  this.matchComments()\n  this.styleDeclarations()\n  this.matchLeadingSpaces()\n  return true\n}\n",[2387],{"type":393,"tag":430,"props":2388,"children":2389},{"__ignoreMap":387},[2390,2420,2464,2489,2563,2590,2609,2629,2648,2661],{"type":393,"tag":434,"props":2391,"children":2392},{"class":436,"line":437},[2393,2397,2401,2406,2411,2416],{"type":393,"tag":434,"props":2394,"children":2395},{"style":498},[2396],{"type":399,"value":1951},{"type":393,"tag":434,"props":2398,"children":2399},{"style":1060},[2400],{"type":399,"value":2153},{"type":393,"tag":434,"props":2402,"children":2403},{"style":498},[2404],{"type":399,"value":2405}," (): boolean ",{"type":393,"tag":434,"props":2407,"children":2408},{"style":594},[2409],{"type":399,"value":2410},"|",{"type":393,"tag":434,"props":2412,"children":2413},{"style":594},[2414],{"type":399,"value":2415}," void",{"type":393,"tag":434,"props":2417,"children":2418},{"style":462},[2419],{"type":399,"value":465},{"type":393,"tag":434,"props":2421,"children":2422},{"class":436,"line":447},[2423,2428,2433,2438,2442,2446,2451,2455,2460],{"type":393,"tag":434,"props":2424,"children":2425},{"style":995},[2426],{"type":399,"value":2427},"  const",{"type":393,"tag":434,"props":2429,"children":2430},{"style":504},[2431],{"type":399,"value":2432}," selectors",{"type":393,"tag":434,"props":2434,"children":2435},{"style":594},[2436],{"type":399,"value":2437}," =",{"type":393,"tag":434,"props":2439,"children":2440},{"style":1050},[2441],{"type":399,"value":1185},{"type":393,"tag":434,"props":2443,"children":2444},{"style":462},[2445],{"type":399,"value":454},{"type":393,"tag":434,"props":2447,"children":2448},{"style":1060},[2449],{"type":399,"value":2450},"formatSelector",{"type":393,"tag":434,"props":2452,"children":2453},{"style":1044},[2454],{"type":399,"value":1146},{"type":393,"tag":434,"props":2456,"children":2457},{"style":1250},[2458],{"type":399,"value":2459},"true",{"type":393,"tag":434,"props":2461,"children":2462},{"style":1044},[2463],{"type":399,"value":1508},{"type":393,"tag":434,"props":2465,"children":2466},{"class":436,"line":468},[2467,2471,2475,2480,2484],{"type":393,"tag":434,"props":2468,"children":2469},{"style":1050},[2470],{"type":399,"value":1362},{"type":393,"tag":434,"props":2472,"children":2473},{"style":462},[2474],{"type":399,"value":454},{"type":393,"tag":434,"props":2476,"children":2477},{"style":498},[2478],{"type":399,"value":2479},"scopecssDisableNextLine",{"type":393,"tag":434,"props":2481,"children":2482},{"style":594},[2483],{"type":399,"value":2437},{"type":393,"tag":434,"props":2485,"children":2486},{"style":1250},[2487],{"type":399,"value":2488}," false\n",{"type":393,"tag":434,"props":2490,"children":2491},{"class":436,"line":494},[2492,2497,2501,2506,2511,2515,2520,2525,2529,2533,2538,2542,2546,2550,2554,2559],{"type":393,"tag":434,"props":2493,"children":2494},{"style":1038},[2495],{"type":399,"value":2496},"  if",{"type":393,"tag":434,"props":2498,"children":2499},{"style":1044},[2500],{"type":399,"value":1047},{"type":393,"tag":434,"props":2502,"children":2503},{"style":594},[2504],{"type":399,"value":2505},"!",{"type":393,"tag":434,"props":2507,"children":2508},{"style":498},[2509],{"type":399,"value":2510},"selectors",{"type":393,"tag":434,"props":2512,"children":2513},{"style":1044},[2514],{"type":399,"value":1156},{"type":393,"tag":434,"props":2516,"children":2517},{"style":1038},[2518],{"type":399,"value":2519},"return",{"type":393,"tag":434,"props":2521,"children":2522},{"style":1060},[2523],{"type":399,"value":2524}," parseError",{"type":393,"tag":434,"props":2526,"children":2527},{"style":1044},[2528],{"type":399,"value":1146},{"type":393,"tag":434,"props":2530,"children":2531},{"style":600},[2532],{"type":399,"value":2105},{"type":393,"tag":434,"props":2534,"children":2535},{"style":606},[2536],{"type":399,"value":2537},"selector missing",{"type":393,"tag":434,"props":2539,"children":2540},{"style":600},[2541],{"type":399,"value":2105},{"type":393,"tag":434,"props":2543,"children":2544},{"style":462},[2545],{"type":399,"value":1622},{"type":393,"tag":434,"props":2547,"children":2548},{"style":1050},[2549],{"type":399,"value":1185},{"type":393,"tag":434,"props":2551,"children":2552},{"style":462},[2553],{"type":399,"value":454},{"type":393,"tag":434,"props":2555,"children":2556},{"style":498},[2557],{"type":399,"value":2558},"linkPath",{"type":393,"tag":434,"props":2560,"children":2561},{"style":1044},[2562],{"type":399,"value":1508},{"type":393,"tag":434,"props":2564,"children":2565},{"class":436,"line":514},[2566,2570,2574,2578,2582,2586],{"type":393,"tag":434,"props":2567,"children":2568},{"style":1050},[2569],{"type":399,"value":1362},{"type":393,"tag":434,"props":2571,"children":2572},{"style":462},[2573],{"type":399,"value":454},{"type":393,"tag":434,"props":2575,"children":2576},{"style":1060},[2577],{"type":399,"value":1848},{"type":393,"tag":434,"props":2579,"children":2580},{"style":1044},[2581],{"type":399,"value":1146},{"type":393,"tag":434,"props":2583,"children":2584},{"style":498},[2585],{"type":399,"value":2510},{"type":393,"tag":434,"props":2587,"children":2588},{"style":1044},[2589],{"type":399,"value":1508},{"type":393,"tag":434,"props":2591,"children":2592},{"class":436,"line":536},[2593,2597,2601,2605],{"type":393,"tag":434,"props":2594,"children":2595},{"style":1050},[2596],{"type":399,"value":1362},{"type":393,"tag":434,"props":2598,"children":2599},{"style":462},[2600],{"type":399,"value":454},{"type":393,"tag":434,"props":2602,"children":2603},{"style":1060},[2604],{"type":399,"value":2007},{"type":393,"tag":434,"props":2606,"children":2607},{"style":1044},[2608],{"type":399,"value":1991},{"type":393,"tag":434,"props":2610,"children":2611},{"class":436,"line":545},[2612,2616,2620,2625],{"type":393,"tag":434,"props":2613,"children":2614},{"style":1050},[2615],{"type":399,"value":1362},{"type":393,"tag":434,"props":2617,"children":2618},{"style":462},[2619],{"type":399,"value":454},{"type":393,"tag":434,"props":2621,"children":2622},{"style":1060},[2623],{"type":399,"value":2624},"styleDeclarations",{"type":393,"tag":434,"props":2626,"children":2627},{"style":1044},[2628],{"type":399,"value":1991},{"type":393,"tag":434,"props":2630,"children":2631},{"class":436,"line":554},[2632,2636,2640,2644],{"type":393,"tag":434,"props":2633,"children":2634},{"style":1050},[2635],{"type":399,"value":1362},{"type":393,"tag":434,"props":2637,"children":2638},{"style":462},[2639],{"type":399,"value":454},{"type":393,"tag":434,"props":2641,"children":2642},{"style":1060},[2643],{"type":399,"value":1986},{"type":393,"tag":434,"props":2645,"children":2646},{"style":1044},[2647],{"type":399,"value":1991},{"type":393,"tag":434,"props":2649,"children":2650},{"class":436,"line":564},[2651,2656],{"type":393,"tag":434,"props":2652,"children":2653},{"style":1038},[2654],{"type":399,"value":2655},"  return",{"type":393,"tag":434,"props":2657,"children":2658},{"style":1250},[2659],{"type":399,"value":2660}," true\n",{"type":393,"tag":434,"props":2662,"children":2663},{"class":436,"line":573},[2664],{"type":393,"tag":434,"props":2665,"children":2666},{"style":462},[2667],{"type":399,"value":551},{"type":393,"tag":401,"props":2669,"children":2670},{},[2671,2673,2679,2681,2687,2689,2695,2697,2702,2704,2710],{"type":399,"value":2672},"首先是匹配选择器的部分。以 ",{"type":393,"tag":430,"props":2674,"children":2676},{"className":2675},[],[2677],{"type":399,"value":2678},".a,.b{color:red}",{"type":399,"value":2680}," 为例，首先匹配出",{"type":393,"tag":430,"props":2682,"children":2684},{"className":2683},[],[2685],{"type":399,"value":2686},"{",{"type":399,"value":2688},"字符前的部分即",{"type":393,"tag":430,"props":2690,"children":2692},{"className":2691},[],[2693],{"type":399,"value":2694},".a,.b",{"type":399,"value":2696},"作为选择器的正文，然后使用",{"type":393,"tag":430,"props":2698,"children":2700},{"className":2699},[],[2701],{"type":399,"value":1622},{"type":399,"value":2703},"分割选择器，并给选择器加上 prefix，最终返回",{"type":393,"tag":430,"props":2705,"children":2707},{"className":2706},[],[2708],{"type":399,"value":2709},"micro-app[name=\"subapp\"] .a, micro-app[name=\"subapp\"] .b",{"type":399,"value":2711},"。刚才提到可以在业务代码中使用注释给特定选择器禁用 prefix 前缀，相关的代码的实现也在这个函数中。",{"type":393,"tag":423,"props":2713,"children":2715},{"className":983,"code":2714,"language":985,"meta":387,"style":387},"const selectors = this.formatSelector()\n\nprivate formatSelector (skip: boolean): false | string {\n  // 匹配选择器正文\n  const m = this.commonMatch(/^[^{]+/, skip)\n  return m[0].replace(/(^|,[\\n\\s]*)([^,]+)/g, (_, separator, selector) => {\n    // 如果检测到选择器被禁用则跳过添加前缀步骤\n    if (...) {\n      const prefix = this.prefix // micro-app[name=\"subapp\"]\n      selector = prefix + ' ' + selector\n    }\n    return separator + selector\n  })\n}\n",[2716],{"type":393,"tag":430,"props":2717,"children":2718},{"__ignoreMap":387},[2719,2751,2758,2793,2801,2879,3037,3045,3069,3104,3142,3149,3168,3179],{"type":393,"tag":434,"props":2720,"children":2721},{"class":436,"line":437},[2722,2727,2731,2735,2739,2743,2747],{"type":393,"tag":434,"props":2723,"children":2724},{"style":995},[2725],{"type":399,"value":2726},"const",{"type":393,"tag":434,"props":2728,"children":2729},{"style":504},[2730],{"type":399,"value":2432},{"type":393,"tag":434,"props":2732,"children":2733},{"style":594},[2734],{"type":399,"value":2437},{"type":393,"tag":434,"props":2736,"children":2737},{"style":1050},[2738],{"type":399,"value":1185},{"type":393,"tag":434,"props":2740,"children":2741},{"style":462},[2742],{"type":399,"value":454},{"type":393,"tag":434,"props":2744,"children":2745},{"style":1060},[2746],{"type":399,"value":2450},{"type":393,"tag":434,"props":2748,"children":2749},{"style":498},[2750],{"type":399,"value":1991},{"type":393,"tag":434,"props":2752,"children":2753},{"class":436,"line":447},[2754],{"type":393,"tag":434,"props":2755,"children":2756},{"emptyLinePlaceholder":558},[2757],{"type":399,"value":561},{"type":393,"tag":434,"props":2759,"children":2760},{"class":436,"line":468},[2761,2765,2769,2774,2779,2784,2789],{"type":393,"tag":434,"props":2762,"children":2763},{"style":498},[2764],{"type":399,"value":1951},{"type":393,"tag":434,"props":2766,"children":2767},{"style":1060},[2768],{"type":399,"value":2450},{"type":393,"tag":434,"props":2770,"children":2771},{"style":498},[2772],{"type":399,"value":2773}," (skip: boolean): ",{"type":393,"tag":434,"props":2775,"children":2776},{"style":1250},[2777],{"type":399,"value":2778},"false",{"type":393,"tag":434,"props":2780,"children":2781},{"style":594},[2782],{"type":399,"value":2783}," |",{"type":393,"tag":434,"props":2785,"children":2786},{"style":498},[2787],{"type":399,"value":2788}," string ",{"type":393,"tag":434,"props":2790,"children":2791},{"style":462},[2792],{"type":399,"value":1239},{"type":393,"tag":434,"props":2794,"children":2795},{"class":436,"line":494},[2796],{"type":393,"tag":434,"props":2797,"children":2798},{"style":441},[2799],{"type":399,"value":2800},"  // 匹配选择器正文\n",{"type":393,"tag":434,"props":2802,"children":2803},{"class":436,"line":514},[2804,2808,2813,2817,2821,2825,2829,2833,2837,2841,2846,2850,2854,2858,2862,2866,2870,2875],{"type":393,"tag":434,"props":2805,"children":2806},{"style":995},[2807],{"type":399,"value":2427},{"type":393,"tag":434,"props":2809,"children":2810},{"style":504},[2811],{"type":399,"value":2812}," m",{"type":393,"tag":434,"props":2814,"children":2815},{"style":594},[2816],{"type":399,"value":2437},{"type":393,"tag":434,"props":2818,"children":2819},{"style":1050},[2820],{"type":399,"value":1185},{"type":393,"tag":434,"props":2822,"children":2823},{"style":462},[2824],{"type":399,"value":454},{"type":393,"tag":434,"props":2826,"children":2827},{"style":1060},[2828],{"type":399,"value":2280},{"type":393,"tag":434,"props":2830,"children":2831},{"style":1044},[2832],{"type":399,"value":1146},{"type":393,"tag":434,"props":2834,"children":2835},{"style":600},[2836],{"type":399,"value":1171},{"type":393,"tag":434,"props":2838,"children":2839},{"style":1038},[2840],{"type":399,"value":2293},{"type":393,"tag":434,"props":2842,"children":2844},{"style":2843},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2845],{"type":399,"value":585},{"type":393,"tag":434,"props":2847,"children":2848},{"style":594},[2849],{"type":399,"value":2293},{"type":393,"tag":434,"props":2851,"children":2852},{"style":2296},[2853],{"type":399,"value":2686},{"type":393,"tag":434,"props":2855,"children":2856},{"style":2843},[2857],{"type":399,"value":618},{"type":393,"tag":434,"props":2859,"children":2860},{"style":594},[2861],{"type":399,"value":1479},{"type":393,"tag":434,"props":2863,"children":2864},{"style":600},[2865],{"type":399,"value":1171},{"type":393,"tag":434,"props":2867,"children":2868},{"style":462},[2869],{"type":399,"value":1622},{"type":393,"tag":434,"props":2871,"children":2872},{"style":498},[2873],{"type":399,"value":2874}," skip",{"type":393,"tag":434,"props":2876,"children":2877},{"style":1044},[2878],{"type":399,"value":1508},{"type":393,"tag":434,"props":2880,"children":2881},{"class":436,"line":536},[2882,2886,2890,2894,2898,2902,2906,2911,2915,2919,2924,2928,2932,2937,2941,2946,2950,2954,2959,2963,2967,2971,2975,2979,2983,2987,2993,2997,3001,3006,3010,3015,3019,3024,3028,3033],{"type":393,"tag":434,"props":2883,"children":2884},{"style":1038},[2885],{"type":399,"value":2655},{"type":393,"tag":434,"props":2887,"children":2888},{"style":498},[2889],{"type":399,"value":2812},{"type":393,"tag":434,"props":2891,"children":2892},{"style":1044},[2893],{"type":399,"value":585},{"type":393,"tag":434,"props":2895,"children":2896},{"style":483},[2897],{"type":399,"value":1151},{"type":393,"tag":434,"props":2899,"children":2900},{"style":1044},[2901],{"type":399,"value":618},{"type":393,"tag":434,"props":2903,"children":2904},{"style":462},[2905],{"type":399,"value":454},{"type":393,"tag":434,"props":2907,"children":2908},{"style":1060},[2909],{"type":399,"value":2910},"replace",{"type":393,"tag":434,"props":2912,"children":2913},{"style":1044},[2914],{"type":399,"value":1146},{"type":393,"tag":434,"props":2916,"children":2917},{"style":600},[2918],{"type":399,"value":1171},{"type":393,"tag":434,"props":2920,"children":2922},{"style":2921},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[2923],{"type":399,"value":1146},{"type":393,"tag":434,"props":2925,"children":2926},{"style":1038},[2927],{"type":399,"value":2293},{"type":393,"tag":434,"props":2929,"children":2930},{"style":594},[2931],{"type":399,"value":2410},{"type":393,"tag":434,"props":2933,"children":2935},{"style":2934},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[2936],{"type":399,"value":1622},{"type":393,"tag":434,"props":2938,"children":2939},{"style":2843},[2940],{"type":399,"value":585},{"type":393,"tag":434,"props":2942,"children":2943},{"style":2296},[2944],{"type":399,"value":2945},"\\n\\s",{"type":393,"tag":434,"props":2947,"children":2948},{"style":2843},[2949],{"type":399,"value":618},{"type":393,"tag":434,"props":2951,"children":2952},{"style":594},[2953],{"type":399,"value":1226},{"type":393,"tag":434,"props":2955,"children":2956},{"style":2921},[2957],{"type":399,"value":2958},")(",{"type":393,"tag":434,"props":2960,"children":2961},{"style":2843},[2962],{"type":399,"value":585},{"type":393,"tag":434,"props":2964,"children":2965},{"style":594},[2966],{"type":399,"value":2293},{"type":393,"tag":434,"props":2968,"children":2969},{"style":2296},[2970],{"type":399,"value":1622},{"type":393,"tag":434,"props":2972,"children":2973},{"style":2843},[2974],{"type":399,"value":618},{"type":393,"tag":434,"props":2976,"children":2977},{"style":594},[2978],{"type":399,"value":1479},{"type":393,"tag":434,"props":2980,"children":2981},{"style":2921},[2982],{"type":399,"value":1640},{"type":393,"tag":434,"props":2984,"children":2985},{"style":600},[2986],{"type":399,"value":1171},{"type":393,"tag":434,"props":2988,"children":2990},{"style":2989},"--shiki-light:#F76D47;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[2991],{"type":399,"value":2992},"g",{"type":393,"tag":434,"props":2994,"children":2995},{"style":462},[2996],{"type":399,"value":1622},{"type":393,"tag":434,"props":2998,"children":2999},{"style":462},[3000],{"type":399,"value":1047},{"type":393,"tag":434,"props":3002,"children":3003},{"style":1785},[3004],{"type":399,"value":3005},"_",{"type":393,"tag":434,"props":3007,"children":3008},{"style":462},[3009],{"type":399,"value":1622},{"type":393,"tag":434,"props":3011,"children":3012},{"style":1785},[3013],{"type":399,"value":3014}," separator",{"type":393,"tag":434,"props":3016,"children":3017},{"style":462},[3018],{"type":399,"value":1622},{"type":393,"tag":434,"props":3020,"children":3021},{"style":1785},[3022],{"type":399,"value":3023}," selector",{"type":393,"tag":434,"props":3025,"children":3026},{"style":462},[3027],{"type":399,"value":1640},{"type":393,"tag":434,"props":3029,"children":3030},{"style":995},[3031],{"type":399,"value":3032}," =>",{"type":393,"tag":434,"props":3034,"children":3035},{"style":462},[3036],{"type":399,"value":465},{"type":393,"tag":434,"props":3038,"children":3039},{"class":436,"line":545},[3040],{"type":393,"tag":434,"props":3041,"children":3042},{"style":441},[3043],{"type":399,"value":3044},"    // 如果检测到选择器被禁用则跳过添加前缀步骤\n",{"type":393,"tag":434,"props":3046,"children":3047},{"class":436,"line":554},[3048,3052,3056,3061,3065],{"type":393,"tag":434,"props":3049,"children":3050},{"style":1038},[3051],{"type":399,"value":1115},{"type":393,"tag":434,"props":3053,"children":3054},{"style":1044},[3055],{"type":399,"value":1047},{"type":393,"tag":434,"props":3057,"children":3058},{"style":594},[3059],{"type":399,"value":3060},"...",{"type":393,"tag":434,"props":3062,"children":3063},{"style":1044},[3064],{"type":399,"value":1156},{"type":393,"tag":434,"props":3066,"children":3067},{"style":462},[3068],{"type":399,"value":1239},{"type":393,"tag":434,"props":3070,"children":3071},{"class":436,"line":564},[3072,3077,3082,3086,3090,3094,3099],{"type":393,"tag":434,"props":3073,"children":3074},{"style":995},[3075],{"type":399,"value":3076},"      const",{"type":393,"tag":434,"props":3078,"children":3079},{"style":504},[3080],{"type":399,"value":3081}," prefix",{"type":393,"tag":434,"props":3083,"children":3084},{"style":594},[3085],{"type":399,"value":2437},{"type":393,"tag":434,"props":3087,"children":3088},{"style":1050},[3089],{"type":399,"value":1185},{"type":393,"tag":434,"props":3091,"children":3092},{"style":462},[3093],{"type":399,"value":454},{"type":393,"tag":434,"props":3095,"children":3096},{"style":498},[3097],{"type":399,"value":3098},"prefix",{"type":393,"tag":434,"props":3100,"children":3101},{"style":441},[3102],{"type":399,"value":3103}," // micro-app[name=\"subapp\"]\n",{"type":393,"tag":434,"props":3105,"children":3106},{"class":436,"line":573},[3107,3112,3116,3120,3125,3129,3133,3137],{"type":393,"tag":434,"props":3108,"children":3109},{"style":498},[3110],{"type":399,"value":3111},"      selector",{"type":393,"tag":434,"props":3113,"children":3114},{"style":594},[3115],{"type":399,"value":2437},{"type":393,"tag":434,"props":3117,"children":3118},{"style":498},[3119],{"type":399,"value":3081},{"type":393,"tag":434,"props":3121,"children":3122},{"style":594},[3123],{"type":399,"value":3124}," +",{"type":393,"tag":434,"props":3126,"children":3127},{"style":600},[3128],{"type":399,"value":2096},{"type":393,"tag":434,"props":3130,"children":3131},{"style":600},[3132],{"type":399,"value":2096},{"type":393,"tag":434,"props":3134,"children":3135},{"style":594},[3136],{"type":399,"value":3124},{"type":393,"tag":434,"props":3138,"children":3139},{"style":498},[3140],{"type":399,"value":3141}," selector\n",{"type":393,"tag":434,"props":3143,"children":3144},{"class":436,"line":634},[3145],{"type":393,"tag":434,"props":3146,"children":3147},{"style":462},[3148],{"type":399,"value":1265},{"type":393,"tag":434,"props":3150,"children":3151},{"class":436,"line":654},[3152,3156,3160,3164],{"type":393,"tag":434,"props":3153,"children":3154},{"style":1038},[3155],{"type":399,"value":1281},{"type":393,"tag":434,"props":3157,"children":3158},{"style":498},[3159],{"type":399,"value":3014},{"type":393,"tag":434,"props":3161,"children":3162},{"style":594},[3163],{"type":399,"value":3124},{"type":393,"tag":434,"props":3165,"children":3166},{"style":498},[3167],{"type":399,"value":3141},{"type":393,"tag":434,"props":3169,"children":3170},{"class":436,"line":670},[3171,3175],{"type":393,"tag":434,"props":3172,"children":3173},{"style":462},[3174],{"type":399,"value":833},{"type":393,"tag":434,"props":3176,"children":3177},{"style":1044},[3178],{"type":399,"value":1508},{"type":393,"tag":434,"props":3180,"children":3181},{"class":436,"line":690},[3182],{"type":393,"tag":434,"props":3183,"children":3184},{"style":462},[3185],{"type":399,"value":551},{"type":393,"tag":401,"props":3187,"children":3188},{},[3189,3191,3196,3198,3203,3205,3210,3212,3217,3219,3226],{"type":399,"value":3190},"匹配完选择器后，声明便是剩下的包含在左右花括号的内容。匹配过程是一个递归，以遇到",{"type":393,"tag":430,"props":3192,"children":3194},{"className":3193},[],[3195],{"type":399,"value":1901},{"type":399,"value":3197},"作为结束条件。如果遇到斜杠",{"type":393,"tag":430,"props":3199,"children":3201},{"className":3200},[],[3202],{"type":399,"value":1171},{"type":399,"value":3204},"，则尝试停止声明匹配并开始注释匹配。总之，",{"type":393,"tag":430,"props":3206,"children":3208},{"className":3207},[],[3209],{"type":399,"value":1901},{"type":399,"value":3211},"之前的内容都作为当前选择器的声明，添加到",{"type":393,"tag":430,"props":3213,"children":3215},{"className":3214},[],[3216],{"type":399,"value":1132},{"type":399,"value":3218},"中。micro-app 框架会对 CSS 资源中的 URL 补全为主应用的完整路径这个功能也是在这个函数中实现，有兴趣的话可以查看其",{"type":393,"tag":412,"props":3220,"children":3223},{"href":3221,"rel":3222},"https://github.com/micro-zoe/micro-app/blob/dev/src/sandbox/scoped_css.ts",[416],[3224],{"type":399,"value":3225},"完整代码",{"type":399,"value":919},{"type":393,"tag":423,"props":3228,"children":3230},{"className":983,"code":3229,"language":985,"meta":387,"style":387},"private matchAllDeclarations (): void {\n  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n  this.recordResult(cssValue)\n\n  // 递归退出条件\n  if (!this.cssText) return\n  if (this.cssText.charAt(0) === '}') return\n\n  // extract comments in declarations\n  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n    this.matchComments()\n  } else {\n    // 如果不是注释则忽略中断，继续匹配声明\n    this.commonMatch(/\\/+/)\n  }\n\n  return this.matchAllDeclarations()\n}\n",[3231],{"type":393,"tag":430,"props":3232,"children":3233},{"__ignoreMap":387},[3234,3258,3368,3396,3403,3411,3447,3515,3522,3530,3650,3669,3685,3693,3734,3741,3748,3771],{"type":393,"tag":434,"props":3235,"children":3236},{"class":436,"line":437},[3237,3241,3246,3250,3254],{"type":393,"tag":434,"props":3238,"children":3239},{"style":498},[3240],{"type":399,"value":1951},{"type":393,"tag":434,"props":3242,"children":3243},{"style":1060},[3244],{"type":399,"value":3245},"matchAllDeclarations",{"type":393,"tag":434,"props":3247,"children":3248},{"style":498},[3249],{"type":399,"value":1961},{"type":393,"tag":434,"props":3251,"children":3252},{"style":594},[3253],{"type":399,"value":1966},{"type":393,"tag":434,"props":3255,"children":3256},{"style":462},[3257],{"type":399,"value":465},{"type":393,"tag":434,"props":3259,"children":3260},{"class":436,"line":447},[3261,3266,3271,3275,3279,3283,3287,3291,3295,3299,3303,3307,3311,3316,3320,3324,3328,3332,3336,3340,3344,3349,3354,3359,3363],{"type":393,"tag":434,"props":3262,"children":3263},{"style":995},[3264],{"type":399,"value":3265},"  let",{"type":393,"tag":434,"props":3267,"children":3268},{"style":498},[3269],{"type":399,"value":3270}," cssValue",{"type":393,"tag":434,"props":3272,"children":3273},{"style":594},[3274],{"type":399,"value":2437},{"type":393,"tag":434,"props":3276,"children":3277},{"style":1044},[3278],{"type":399,"value":1047},{"type":393,"tag":434,"props":3280,"children":3281},{"style":1050},[3282],{"type":399,"value":1053},{"type":393,"tag":434,"props":3284,"children":3285},{"style":462},[3286],{"type":399,"value":454},{"type":393,"tag":434,"props":3288,"children":3289},{"style":1060},[3290],{"type":399,"value":2280},{"type":393,"tag":434,"props":3292,"children":3293},{"style":1044},[3294],{"type":399,"value":1146},{"type":393,"tag":434,"props":3296,"children":3297},{"style":600},[3298],{"type":399,"value":1171},{"type":393,"tag":434,"props":3300,"children":3301},{"style":1038},[3302],{"type":399,"value":2293},{"type":393,"tag":434,"props":3304,"children":3305},{"style":2843},[3306],{"type":399,"value":585},{"type":393,"tag":434,"props":3308,"children":3309},{"style":594},[3310],{"type":399,"value":2293},{"type":393,"tag":434,"props":3312,"children":3313},{"style":2296},[3314],{"type":399,"value":3315},"}/",{"type":393,"tag":434,"props":3317,"children":3318},{"style":2843},[3319],{"type":399,"value":618},{"type":393,"tag":434,"props":3321,"children":3322},{"style":2934},[3323],{"type":399,"value":1640},{"type":393,"tag":434,"props":3325,"children":3326},{"style":594},[3327],{"type":399,"value":1226},{"type":393,"tag":434,"props":3329,"children":3330},{"style":600},[3331],{"type":399,"value":1171},{"type":393,"tag":434,"props":3333,"children":3334},{"style":462},[3335],{"type":399,"value":1622},{"type":393,"tag":434,"props":3337,"children":3338},{"style":1250},[3339],{"type":399,"value":1286},{"type":393,"tag":434,"props":3341,"children":3342},{"style":1044},[3343],{"type":399,"value":1156},{"type":393,"tag":434,"props":3345,"children":3346},{"style":1038},[3347],{"type":399,"value":3348},"as",{"type":393,"tag":434,"props":3350,"children":3351},{"style":1001},[3352],{"type":399,"value":3353}," RegExpExecArray",{"type":393,"tag":434,"props":3355,"children":3356},{"style":1044},[3357],{"type":399,"value":3358},")[",{"type":393,"tag":434,"props":3360,"children":3361},{"style":483},[3362],{"type":399,"value":1151},{"type":393,"tag":434,"props":3364,"children":3365},{"style":1044},[3366],{"type":399,"value":3367},"]\n",{"type":393,"tag":434,"props":3369,"children":3370},{"class":436,"line":468},[3371,3375,3379,3383,3387,3392],{"type":393,"tag":434,"props":3372,"children":3373},{"style":1050},[3374],{"type":399,"value":1362},{"type":393,"tag":434,"props":3376,"children":3377},{"style":462},[3378],{"type":399,"value":454},{"type":393,"tag":434,"props":3380,"children":3381},{"style":1060},[3382],{"type":399,"value":1848},{"type":393,"tag":434,"props":3384,"children":3385},{"style":1044},[3386],{"type":399,"value":1146},{"type":393,"tag":434,"props":3388,"children":3389},{"style":498},[3390],{"type":399,"value":3391},"cssValue",{"type":393,"tag":434,"props":3393,"children":3394},{"style":1044},[3395],{"type":399,"value":1508},{"type":393,"tag":434,"props":3397,"children":3398},{"class":436,"line":494},[3399],{"type":393,"tag":434,"props":3400,"children":3401},{"emptyLinePlaceholder":558},[3402],{"type":399,"value":561},{"type":393,"tag":434,"props":3404,"children":3405},{"class":436,"line":514},[3406],{"type":393,"tag":434,"props":3407,"children":3408},{"style":441},[3409],{"type":399,"value":3410},"  // 递归退出条件\n",{"type":393,"tag":434,"props":3412,"children":3413},{"class":436,"line":536},[3414,3418,3422,3426,3430,3434,3438,3442],{"type":393,"tag":434,"props":3415,"children":3416},{"style":1038},[3417],{"type":399,"value":2496},{"type":393,"tag":434,"props":3419,"children":3420},{"style":1044},[3421],{"type":399,"value":1047},{"type":393,"tag":434,"props":3423,"children":3424},{"style":594},[3425],{"type":399,"value":2505},{"type":393,"tag":434,"props":3427,"children":3428},{"style":1050},[3429],{"type":399,"value":1053},{"type":393,"tag":434,"props":3431,"children":3432},{"style":462},[3433],{"type":399,"value":454},{"type":393,"tag":434,"props":3435,"children":3436},{"style":498},[3437],{"type":399,"value":1132},{"type":393,"tag":434,"props":3439,"children":3440},{"style":1044},[3441],{"type":399,"value":1156},{"type":393,"tag":434,"props":3443,"children":3444},{"style":1038},[3445],{"type":399,"value":3446},"return\n",{"type":393,"tag":434,"props":3448,"children":3449},{"class":436,"line":545},[3450,3454,3458,3462,3466,3470,3474,3478,3482,3486,3490,3495,3499,3503,3507,3511],{"type":393,"tag":434,"props":3451,"children":3452},{"style":1038},[3453],{"type":399,"value":2496},{"type":393,"tag":434,"props":3455,"children":3456},{"style":1044},[3457],{"type":399,"value":1047},{"type":393,"tag":434,"props":3459,"children":3460},{"style":1050},[3461],{"type":399,"value":1053},{"type":393,"tag":434,"props":3463,"children":3464},{"style":462},[3465],{"type":399,"value":454},{"type":393,"tag":434,"props":3467,"children":3468},{"style":498},[3469],{"type":399,"value":1132},{"type":393,"tag":434,"props":3471,"children":3472},{"style":462},[3473],{"type":399,"value":454},{"type":393,"tag":434,"props":3475,"children":3476},{"style":1060},[3477],{"type":399,"value":1141},{"type":393,"tag":434,"props":3479,"children":3480},{"style":1044},[3481],{"type":399,"value":1146},{"type":393,"tag":434,"props":3483,"children":3484},{"style":483},[3485],{"type":399,"value":1151},{"type":393,"tag":434,"props":3487,"children":3488},{"style":1044},[3489],{"type":399,"value":1156},{"type":393,"tag":434,"props":3491,"children":3492},{"style":594},[3493],{"type":399,"value":3494},"===",{"type":393,"tag":434,"props":3496,"children":3497},{"style":600},[3498],{"type":399,"value":2096},{"type":393,"tag":434,"props":3500,"children":3501},{"style":606},[3502],{"type":399,"value":1901},{"type":393,"tag":434,"props":3504,"children":3505},{"style":600},[3506],{"type":399,"value":2105},{"type":393,"tag":434,"props":3508,"children":3509},{"style":1044},[3510],{"type":399,"value":1156},{"type":393,"tag":434,"props":3512,"children":3513},{"style":1038},[3514],{"type":399,"value":3446},{"type":393,"tag":434,"props":3516,"children":3517},{"class":436,"line":554},[3518],{"type":393,"tag":434,"props":3519,"children":3520},{"emptyLinePlaceholder":558},[3521],{"type":399,"value":561},{"type":393,"tag":434,"props":3523,"children":3524},{"class":436,"line":564},[3525],{"type":393,"tag":434,"props":3526,"children":3527},{"style":441},[3528],{"type":399,"value":3529},"  // extract comments in declarations\n",{"type":393,"tag":434,"props":3531,"children":3532},{"class":436,"line":573},[3533,3537,3541,3545,3549,3553,3557,3561,3565,3569,3573,3577,3581,3585,3589,3594,3598,3602,3606,3610,3614,3618,3622,3626,3630,3634,3638,3642,3646],{"type":393,"tag":434,"props":3534,"children":3535},{"style":1038},[3536],{"type":399,"value":2496},{"type":393,"tag":434,"props":3538,"children":3539},{"style":1044},[3540],{"type":399,"value":1047},{"type":393,"tag":434,"props":3542,"children":3543},{"style":1050},[3544],{"type":399,"value":1053},{"type":393,"tag":434,"props":3546,"children":3547},{"style":462},[3548],{"type":399,"value":454},{"type":393,"tag":434,"props":3550,"children":3551},{"style":498},[3552],{"type":399,"value":1132},{"type":393,"tag":434,"props":3554,"children":3555},{"style":462},[3556],{"type":399,"value":454},{"type":393,"tag":434,"props":3558,"children":3559},{"style":1060},[3560],{"type":399,"value":1141},{"type":393,"tag":434,"props":3562,"children":3563},{"style":1044},[3564],{"type":399,"value":1146},{"type":393,"tag":434,"props":3566,"children":3567},{"style":483},[3568],{"type":399,"value":1151},{"type":393,"tag":434,"props":3570,"children":3571},{"style":1044},[3572],{"type":399,"value":1156},{"type":393,"tag":434,"props":3574,"children":3575},{"style":594},[3576],{"type":399,"value":3494},{"type":393,"tag":434,"props":3578,"children":3579},{"style":600},[3580],{"type":399,"value":2096},{"type":393,"tag":434,"props":3582,"children":3583},{"style":606},[3584],{"type":399,"value":1171},{"type":393,"tag":434,"props":3586,"children":3587},{"style":600},[3588],{"type":399,"value":2105},{"type":393,"tag":434,"props":3590,"children":3591},{"style":594},[3592],{"type":399,"value":3593}," &&",{"type":393,"tag":434,"props":3595,"children":3596},{"style":1050},[3597],{"type":399,"value":1185},{"type":393,"tag":434,"props":3599,"children":3600},{"style":462},[3601],{"type":399,"value":454},{"type":393,"tag":434,"props":3603,"children":3604},{"style":498},[3605],{"type":399,"value":1132},{"type":393,"tag":434,"props":3607,"children":3608},{"style":462},[3609],{"type":399,"value":454},{"type":393,"tag":434,"props":3611,"children":3612},{"style":1060},[3613],{"type":399,"value":1141},{"type":393,"tag":434,"props":3615,"children":3616},{"style":1044},[3617],{"type":399,"value":1146},{"type":393,"tag":434,"props":3619,"children":3620},{"style":483},[3621],{"type":399,"value":917},{"type":393,"tag":434,"props":3623,"children":3624},{"style":1044},[3625],{"type":399,"value":1156},{"type":393,"tag":434,"props":3627,"children":3628},{"style":594},[3629],{"type":399,"value":3494},{"type":393,"tag":434,"props":3631,"children":3632},{"style":600},[3633],{"type":399,"value":2096},{"type":393,"tag":434,"props":3635,"children":3636},{"style":606},[3637],{"type":399,"value":1226},{"type":393,"tag":434,"props":3639,"children":3640},{"style":600},[3641],{"type":399,"value":2105},{"type":393,"tag":434,"props":3643,"children":3644},{"style":1044},[3645],{"type":399,"value":1156},{"type":393,"tag":434,"props":3647,"children":3648},{"style":462},[3649],{"type":399,"value":1239},{"type":393,"tag":434,"props":3651,"children":3652},{"class":436,"line":634},[3653,3657,3661,3665],{"type":393,"tag":434,"props":3654,"children":3655},{"style":1050},[3656],{"type":399,"value":2031},{"type":393,"tag":434,"props":3658,"children":3659},{"style":462},[3660],{"type":399,"value":454},{"type":393,"tag":434,"props":3662,"children":3663},{"style":1060},[3664],{"type":399,"value":2007},{"type":393,"tag":434,"props":3666,"children":3667},{"style":1044},[3668],{"type":399,"value":1991},{"type":393,"tag":434,"props":3670,"children":3671},{"class":436,"line":654},[3672,3676,3681],{"type":393,"tag":434,"props":3673,"children":3674},{"style":462},[3675],{"type":399,"value":833},{"type":393,"tag":434,"props":3677,"children":3678},{"style":1038},[3679],{"type":399,"value":3680}," else",{"type":393,"tag":434,"props":3682,"children":3683},{"style":462},[3684],{"type":399,"value":465},{"type":393,"tag":434,"props":3686,"children":3687},{"class":436,"line":670},[3688],{"type":393,"tag":434,"props":3689,"children":3690},{"style":441},[3691],{"type":399,"value":3692},"    // 如果不是注释则忽略中断，继续匹配声明\n",{"type":393,"tag":434,"props":3694,"children":3695},{"class":436,"line":690},[3696,3700,3704,3708,3712,3716,3722,3726,3730],{"type":393,"tag":434,"props":3697,"children":3698},{"style":1050},[3699],{"type":399,"value":2031},{"type":393,"tag":434,"props":3701,"children":3702},{"style":462},[3703],{"type":399,"value":454},{"type":393,"tag":434,"props":3705,"children":3706},{"style":1060},[3707],{"type":399,"value":2280},{"type":393,"tag":434,"props":3709,"children":3710},{"style":1044},[3711],{"type":399,"value":1146},{"type":393,"tag":434,"props":3713,"children":3714},{"style":600},[3715],{"type":399,"value":1171},{"type":393,"tag":434,"props":3717,"children":3719},{"style":3718},"--shiki-light:#90A4AE;--shiki-light-font-weight:inherit;--shiki-default:#22863A;--shiki-default-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;--shiki-sepia:#AE81FF;--shiki-sepia-font-weight:inherit",[3720],{"type":399,"value":3721},"\\/",{"type":393,"tag":434,"props":3723,"children":3724},{"style":594},[3725],{"type":399,"value":1479},{"type":393,"tag":434,"props":3727,"children":3728},{"style":600},[3729],{"type":399,"value":1171},{"type":393,"tag":434,"props":3731,"children":3732},{"style":1044},[3733],{"type":399,"value":1508},{"type":393,"tag":434,"props":3735,"children":3736},{"class":436,"line":698},[3737],{"type":393,"tag":434,"props":3738,"children":3739},{"style":462},[3740],{"type":399,"value":542},{"type":393,"tag":434,"props":3742,"children":3743},{"class":436,"line":706},[3744],{"type":393,"tag":434,"props":3745,"children":3746},{"emptyLinePlaceholder":558},[3747],{"type":399,"value":561},{"type":393,"tag":434,"props":3749,"children":3750},{"class":436,"line":714},[3751,3755,3759,3763,3767],{"type":393,"tag":434,"props":3752,"children":3753},{"style":1038},[3754],{"type":399,"value":2655},{"type":393,"tag":434,"props":3756,"children":3757},{"style":1050},[3758],{"type":399,"value":1185},{"type":393,"tag":434,"props":3760,"children":3761},{"style":462},[3762],{"type":399,"value":454},{"type":393,"tag":434,"props":3764,"children":3765},{"style":1060},[3766],{"type":399,"value":3245},{"type":393,"tag":434,"props":3768,"children":3769},{"style":1044},[3770],{"type":399,"value":1991},{"type":393,"tag":434,"props":3772,"children":3773},{"class":436,"line":723},[3774],{"type":393,"tag":434,"props":3775,"children":3776},{"style":462},[3777],{"type":399,"value":551},{"type":393,"tag":948,"props":3779,"children":3781},{"id":3780},"解析at-rule",[3782,3784],{"type":399,"value":3783},"解析",{"type":393,"tag":430,"props":3785,"children":3787},{"className":3786},[],[3788],{"type":399,"value":939},{"type":393,"tag":401,"props":3790,"children":3791},{},[3792,3794,3800,3802,3808,3809,3815,3817,3828],{"type":399,"value":3793},"流程中最繁琐的部分，是匹配 ",{"type":393,"tag":430,"props":3795,"children":3797},{"className":3796},[],[3798],{"type":399,"value":3799},"@media",{"type":399,"value":3801},"、",{"type":393,"tag":430,"props":3803,"children":3805},{"className":3804},[],[3806],{"type":399,"value":3807},"@import",{"type":399,"value":3801},{"type":393,"tag":430,"props":3810,"children":3812},{"className":3811},[],[3813],{"type":399,"value":3814},"@charset",{"type":399,"value":3816}," 等 ",{"type":393,"tag":412,"props":3818,"children":3821},{"href":3819,"rel":3820},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/At-rule",[416],[3822],{"type":393,"tag":430,"props":3823,"children":3825},{"className":3824},[],[3826],{"type":399,"value":3827},"at-rules",{"type":399,"value":919},{"type":393,"tag":401,"props":3830,"children":3831},{},[3832],{"type":399,"value":3833},"每一种规则的语法都不同，要怎么处理才合适呢？",{"type":393,"tag":401,"props":3835,"children":3836},{},[3837,3839,3844],{"type":399,"value":3838},"这里，micro-app 把 ",{"type":393,"tag":430,"props":3840,"children":3842},{"className":3841},[],[3843],{"type":399,"value":939},{"type":399,"value":3845}," 分为了三组：",{"type":393,"tag":3847,"props":3848,"children":3849},"ol",{},[3850,3884,3916],{"type":393,"tag":3851,"props":3852,"children":3853},"li",{},[3854,3856,3862,3864,3869,3870,3875,3876,3882],{"type":399,"value":3855},"类似 ",{"type":393,"tag":430,"props":3857,"children":3859},{"className":3858},[],[3860],{"type":399,"value":3861},"@charset \"utf-8\";",{"type":399,"value":3863}," 为一组，包括 ",{"type":393,"tag":430,"props":3865,"children":3867},{"className":3866},[],[3868],{"type":399,"value":3807},{"type":399,"value":3801},{"type":393,"tag":430,"props":3871,"children":3873},{"className":3872},[],[3874],{"type":399,"value":3814},{"type":399,"value":3801},{"type":393,"tag":430,"props":3877,"children":3879},{"className":3878},[],[3880],{"type":399,"value":3881},"@namespace",{"type":399,"value":3883}," 等。",{"type":393,"tag":3851,"props":3885,"children":3886},{},[3887,3888,3894,3895,3901,3902,3908,3909,3915],{"type":399,"value":3855},{"type":393,"tag":430,"props":3889,"children":3891},{"className":3890},[],[3892],{"type":399,"value":3893},"@media (w \u003C 100px) { .selector { xxx: xxx } }",{"type":399,"value":3863},{"type":393,"tag":430,"props":3896,"children":3898},{"className":3897},[],[3899],{"type":399,"value":3900},"@supports",{"type":399,"value":3801},{"type":393,"tag":430,"props":3903,"children":3905},{"className":3904},[],[3906],{"type":399,"value":3907},"@font-face",{"type":399,"value":3801},{"type":393,"tag":430,"props":3910,"children":3912},{"className":3911},[],[3913],{"type":399,"value":3914},"@document",{"type":399,"value":3883},{"type":393,"tag":3851,"props":3917,"children":3918},{},[3919,3920,3926,3927,3932,3933,3939,3940,3946],{"type":399,"value":3855},{"type":393,"tag":430,"props":3921,"children":3923},{"className":3922},[],[3924],{"type":399,"value":3925},"@font-face { unicode-range: 'xxx' }",{"type":399,"value":3863},{"type":393,"tag":430,"props":3928,"children":3930},{"className":3929},[],[3931],{"type":399,"value":3907},{"type":399,"value":3801},{"type":393,"tag":430,"props":3934,"children":3936},{"className":3935},[],[3937],{"type":399,"value":3938},"@page",{"type":399,"value":3801},{"type":393,"tag":430,"props":3941,"children":3943},{"className":3942},[],[3944],{"type":399,"value":3945},"@key-frames",{"type":399,"value":3883},{"type":393,"tag":401,"props":3948,"children":3949},{},[3950,3952,3957,3959,3965,3967,3973,3975,3980],{"type":399,"value":3951},"第一组，",{"type":393,"tag":430,"props":3953,"children":3955},{"className":3954},[],[3956],{"type":399,"value":3814},{"type":399,"value":3958}," 所在的第一组规则的规则正文内容从 ",{"type":393,"tag":430,"props":3960,"children":3962},{"className":3961},[],[3963],{"type":399,"value":3964},"@",{"type":399,"value":3966}," 开始到 ",{"type":393,"tag":430,"props":3968,"children":3970},{"className":3969},[],[3971],{"type":399,"value":3972},";",{"type":399,"value":3974}," 结束，比如 ",{"type":393,"tag":430,"props":3976,"children":3978},{"className":3977},[],[3979],{"type":399,"value":3861},{"type":399,"value":3981}," 就是一条完整的声明；",{"type":393,"tag":401,"props":3983,"children":3984},{},[3985,3987,3993,3995,4000],{"type":399,"value":3986},"第二组，",{"type":393,"tag":430,"props":3988,"children":3990},{"className":3989},[],[3991],{"type":399,"value":3992},"@media () {}",{"type":399,"value":3994}," 的花括号部分可能包含选择器，所以其正文内容需要重新进入 ",{"type":393,"tag":430,"props":3996,"children":3998},{"className":3997},[],[3999],{"type":399,"value":1956},{"type":399,"value":4001}," 匹配选择器以及声明。",{"type":393,"tag":401,"props":4003,"children":4004},{},[4005,4007,4013,4015,4020],{"type":399,"value":4006},"第三组，",{"type":393,"tag":430,"props":4008,"children":4010},{"className":4009},[],[4011],{"type":399,"value":4012},"@font-face {}",{"type":399,"value":4014}," 的花括号部分仅包含声明，不包含选择器，所以只需要进入 ",{"type":393,"tag":430,"props":4016,"children":4018},{"className":4017},[],[4019],{"type":399,"value":3245},{"type":399,"value":4021}," 匹配声明即可。",{"type":393,"tag":394,"props":4023,"children":4025},{"id":4024},"解决问题",[4026],{"type":399,"value":4024},{"type":393,"tag":401,"props":4028,"children":4029},{},[4030],{"type":399,"value":4031},"回到文章开头的问题，如果要给这个 CSS Parser 增加原生的嵌套功能，见下代码，可以仅用十行简单实现。",{"type":393,"tag":423,"props":4033,"children":4037},{"className":4034,"code":4035,"language":4036,"meta":387,"style":387},"language-diff shiki shiki-themes material-theme-lighter github-light github-dark monokai","+ private matchAllDeclarations (nesting = 0): void {\n  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n  this.recordResult(cssValue)\n\n  // 递归退出条件\n  if (!this.cssText) return\n-  if (this.cssText.charAt(0) === '}') return\n+  if (this.cssText.charAt(0) === '}') {\n+    if (!nesting) return\n+    this.commonMatch(/}+\\s*/)\n+    return this.matchAllDeclarations(nesting - 1)\n+  }\n\n  // extract comments in declarations\n  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n    this.matchComments()\n  } else {\n    // 如果不是注释则忽略中断，继续匹配声明\n    this.commonMatch(/\\/+/)\n  }\n\n+ if (this.cssText.charAt(0) === '{') {\n+   this.commonMatch(/{+\\s*/)\n+   nesting++\n+ }\n\n- return this.matchAllDeclarations()\n+ return this.matchAllDeclarations(nesting)\n}\n","diff",[4038],{"type":393,"tag":430,"props":4039,"children":4040},{"__ignoreMap":387},[4041,4055,4063,4071,4078,4085,4093,4107,4119,4131,4143,4155,4166,4173,4180,4188,4196,4204,4211,4219,4226,4233,4245,4258,4271,4284,4292,4305,4318],{"type":393,"tag":434,"props":4042,"children":4043},{"class":436,"line":437},[4044,4049],{"type":393,"tag":434,"props":4045,"children":4047},{"style":4046},"--shiki-light:#39ADB5;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#A6E22E",[4048],{"type":399,"value":1479},{"type":393,"tag":434,"props":4050,"children":4052},{"style":4051},"--shiki-light:#91B859;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#A6E22E",[4053],{"type":399,"value":4054}," private matchAllDeclarations (nesting = 0): void {\n",{"type":393,"tag":434,"props":4056,"children":4057},{"class":436,"line":447},[4058],{"type":393,"tag":434,"props":4059,"children":4060},{"style":498},[4061],{"type":399,"value":4062},"  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n",{"type":393,"tag":434,"props":4064,"children":4065},{"class":436,"line":468},[4066],{"type":393,"tag":434,"props":4067,"children":4068},{"style":498},[4069],{"type":399,"value":4070},"  this.recordResult(cssValue)\n",{"type":393,"tag":434,"props":4072,"children":4073},{"class":436,"line":494},[4074],{"type":393,"tag":434,"props":4075,"children":4076},{"emptyLinePlaceholder":558},[4077],{"type":399,"value":561},{"type":393,"tag":434,"props":4079,"children":4080},{"class":436,"line":514},[4081],{"type":393,"tag":434,"props":4082,"children":4083},{"style":498},[4084],{"type":399,"value":3410},{"type":393,"tag":434,"props":4086,"children":4087},{"class":436,"line":536},[4088],{"type":393,"tag":434,"props":4089,"children":4090},{"style":498},[4091],{"type":399,"value":4092},"  if (!this.cssText) return\n",{"type":393,"tag":434,"props":4094,"children":4095},{"class":436,"line":545},[4096,4101],{"type":393,"tag":434,"props":4097,"children":4099},{"style":4098},"--shiki-light:#39ADB5;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F92672",[4100],{"type":399,"value":1631},{"type":393,"tag":434,"props":4102,"children":4104},{"style":4103},"--shiki-light:#E53935;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F92672",[4105],{"type":399,"value":4106},"  if (this.cssText.charAt(0) === '}') return\n",{"type":393,"tag":434,"props":4108,"children":4109},{"class":436,"line":554},[4110,4114],{"type":393,"tag":434,"props":4111,"children":4112},{"style":4046},[4113],{"type":399,"value":1479},{"type":393,"tag":434,"props":4115,"children":4116},{"style":4051},[4117],{"type":399,"value":4118},"  if (this.cssText.charAt(0) === '}') {\n",{"type":393,"tag":434,"props":4120,"children":4121},{"class":436,"line":564},[4122,4126],{"type":393,"tag":434,"props":4123,"children":4124},{"style":4046},[4125],{"type":399,"value":1479},{"type":393,"tag":434,"props":4127,"children":4128},{"style":4051},[4129],{"type":399,"value":4130},"    if (!nesting) return\n",{"type":393,"tag":434,"props":4132,"children":4133},{"class":436,"line":573},[4134,4138],{"type":393,"tag":434,"props":4135,"children":4136},{"style":4046},[4137],{"type":399,"value":1479},{"type":393,"tag":434,"props":4139,"children":4140},{"style":4051},[4141],{"type":399,"value":4142},"    this.commonMatch(/}+\\s*/)\n",{"type":393,"tag":434,"props":4144,"children":4145},{"class":436,"line":634},[4146,4150],{"type":393,"tag":434,"props":4147,"children":4148},{"style":4046},[4149],{"type":399,"value":1479},{"type":393,"tag":434,"props":4151,"children":4152},{"style":4051},[4153],{"type":399,"value":4154},"    return this.matchAllDeclarations(nesting - 1)\n",{"type":393,"tag":434,"props":4156,"children":4157},{"class":436,"line":654},[4158,4162],{"type":393,"tag":434,"props":4159,"children":4160},{"style":4046},[4161],{"type":399,"value":1479},{"type":393,"tag":434,"props":4163,"children":4164},{"style":4051},[4165],{"type":399,"value":542},{"type":393,"tag":434,"props":4167,"children":4168},{"class":436,"line":670},[4169],{"type":393,"tag":434,"props":4170,"children":4171},{"emptyLinePlaceholder":558},[4172],{"type":399,"value":561},{"type":393,"tag":434,"props":4174,"children":4175},{"class":436,"line":690},[4176],{"type":393,"tag":434,"props":4177,"children":4178},{"style":498},[4179],{"type":399,"value":3529},{"type":393,"tag":434,"props":4181,"children":4182},{"class":436,"line":698},[4183],{"type":393,"tag":434,"props":4184,"children":4185},{"style":498},[4186],{"type":399,"value":4187},"  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n",{"type":393,"tag":434,"props":4189,"children":4190},{"class":436,"line":706},[4191],{"type":393,"tag":434,"props":4192,"children":4193},{"style":498},[4194],{"type":399,"value":4195},"    this.matchComments()\n",{"type":393,"tag":434,"props":4197,"children":4198},{"class":436,"line":714},[4199],{"type":393,"tag":434,"props":4200,"children":4201},{"style":498},[4202],{"type":399,"value":4203},"  } else {\n",{"type":393,"tag":434,"props":4205,"children":4206},{"class":436,"line":723},[4207],{"type":393,"tag":434,"props":4208,"children":4209},{"style":498},[4210],{"type":399,"value":3692},{"type":393,"tag":434,"props":4212,"children":4213},{"class":436,"line":771},[4214],{"type":393,"tag":434,"props":4215,"children":4216},{"style":498},[4217],{"type":399,"value":4218},"    this.commonMatch(/\\/+/)\n",{"type":393,"tag":434,"props":4220,"children":4221},{"class":436,"line":791},[4222],{"type":393,"tag":434,"props":4223,"children":4224},{"style":498},[4225],{"type":399,"value":542},{"type":393,"tag":434,"props":4227,"children":4228},{"class":436,"line":807},[4229],{"type":393,"tag":434,"props":4230,"children":4231},{"emptyLinePlaceholder":558},[4232],{"type":399,"value":561},{"type":393,"tag":434,"props":4234,"children":4235},{"class":436,"line":827},[4236,4240],{"type":393,"tag":434,"props":4237,"children":4238},{"style":4046},[4239],{"type":399,"value":1479},{"type":393,"tag":434,"props":4241,"children":4242},{"style":4051},[4243],{"type":399,"value":4244}," if (this.cssText.charAt(0) === '{') {\n",{"type":393,"tag":434,"props":4246,"children":4248},{"class":436,"line":4247},23,[4249,4253],{"type":393,"tag":434,"props":4250,"children":4251},{"style":4046},[4252],{"type":399,"value":1479},{"type":393,"tag":434,"props":4254,"children":4255},{"style":4051},[4256],{"type":399,"value":4257},"   this.commonMatch(/{+\\s*/)\n",{"type":393,"tag":434,"props":4259,"children":4261},{"class":436,"line":4260},24,[4262,4266],{"type":393,"tag":434,"props":4263,"children":4264},{"style":4046},[4265],{"type":399,"value":1479},{"type":393,"tag":434,"props":4267,"children":4268},{"style":4051},[4269],{"type":399,"value":4270},"   nesting++\n",{"type":393,"tag":434,"props":4272,"children":4274},{"class":436,"line":4273},25,[4275,4279],{"type":393,"tag":434,"props":4276,"children":4277},{"style":4046},[4278],{"type":399,"value":1479},{"type":393,"tag":434,"props":4280,"children":4281},{"style":4051},[4282],{"type":399,"value":4283}," }\n",{"type":393,"tag":434,"props":4285,"children":4287},{"class":436,"line":4286},26,[4288],{"type":393,"tag":434,"props":4289,"children":4290},{"emptyLinePlaceholder":558},[4291],{"type":399,"value":561},{"type":393,"tag":434,"props":4293,"children":4295},{"class":436,"line":4294},27,[4296,4300],{"type":393,"tag":434,"props":4297,"children":4298},{"style":4098},[4299],{"type":399,"value":1631},{"type":393,"tag":434,"props":4301,"children":4302},{"style":4103},[4303],{"type":399,"value":4304}," return this.matchAllDeclarations()\n",{"type":393,"tag":434,"props":4306,"children":4308},{"class":436,"line":4307},28,[4309,4313],{"type":393,"tag":434,"props":4310,"children":4311},{"style":4046},[4312],{"type":399,"value":1479},{"type":393,"tag":434,"props":4314,"children":4315},{"style":4051},[4316],{"type":399,"value":4317}," return this.matchAllDeclarations(nesting)\n",{"type":393,"tag":434,"props":4319,"children":4321},{"class":436,"line":4320},29,[4322],{"type":393,"tag":434,"props":4323,"children":4324},{"style":498},[4325],{"type":399,"value":551},{"type":393,"tag":401,"props":4327,"children":4328},{},[4329],{"type":399,"value":4330},"最终 CSS Nesting 解析成功。",{"type":393,"tag":401,"props":4332,"children":4333},{},[4334],{"type":393,"tag":924,"props":4335,"children":4337},{"alt":1823,"src":4336},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230804025910.png",[],{"type":393,"tag":394,"props":4339,"children":4341},{"id":4340},"结语",[4342],{"type":399,"value":4340},{"type":393,"tag":401,"props":4344,"children":4345},{},[4346],{"type":399,"value":4347},"整个 CSS Parser 的代码简单，功能强悍，耐人寻味。不过有许多边界条件没有处理好，尤其是引入了使用注释禁用样式隔离功能后，匹配注释变得更复杂且易错了。",{"type":393,"tag":3847,"props":4349,"children":4350},{},[4351],{"type":393,"tag":3851,"props":4352,"children":4353},{},[4354],{"type":399,"value":4355},"注释不能和选择器等混用（以下 result 文件代表解析结果）。",{"type":393,"tag":401,"props":4357,"children":4358},{},[4359],{"type":393,"tag":924,"props":4360,"children":4363},{"alt":4361,"src":4362},"comment in selectors","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/9d2b75bda238f9bbe24825a793f0f715.png",[],{"type":393,"tag":3847,"props":4365,"children":4366},{"start":447},[4367],{"type":393,"tag":3851,"props":4368,"children":4369},{},[4370],{"type":399,"value":4371},"CSS 字符串值可能意外启用编译器的特殊功能。",{"type":393,"tag":401,"props":4373,"children":4374},{},[4375],{"type":393,"tag":924,"props":4376,"children":4379},{"alt":4377,"src":4378},"special comment in string value","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230803225103.png",[],{"type":393,"tag":3847,"props":4381,"children":4382},{"start":468},[4383],{"type":393,"tag":3851,"props":4384,"children":4385},{},[4386,4388,4394,4396,4407,4409,4414],{"type":399,"value":4387},"错误的 ",{"type":393,"tag":430,"props":4389,"children":4391},{"className":4390},[],[4392],{"type":399,"value":4393},"@host",{"type":399,"value":4395}," 规则匹配。猜测是想匹配 ",{"type":393,"tag":412,"props":4397,"children":4400},{"href":4398,"rel":4399},"https://drafts.csswg.org/css-scoping/#host-selector",[416],[4401],{"type":393,"tag":430,"props":4402,"children":4404},{"className":4403},[],[4405],{"type":399,"value":4406},":host",{"type":399,"value":4408}," 但是手滑写成了 ",{"type":393,"tag":430,"props":4410,"children":4412},{"className":4411},[],[4413],{"type":399,"value":4393},{"type":399,"value":919},{"type":393,"tag":423,"props":4416,"children":4418},{"className":983,"code":4417,"language":985,"meta":387,"style":387},"private hostRule =\n  this.createMatcherForRuleWithChildRule(\n    /^@host\\s*/,\n    '@host'\n  )\n",[4419],{"type":393,"tag":430,"props":4420,"children":4421},{"__ignoreMap":387},[4422,4435,4456,4489,4506],{"type":393,"tag":434,"props":4423,"children":4424},{"class":436,"line":437},[4425,4430],{"type":393,"tag":434,"props":4426,"children":4427},{"style":498},[4428],{"type":399,"value":4429},"private hostRule ",{"type":393,"tag":434,"props":4431,"children":4432},{"style":594},[4433],{"type":399,"value":4434},"=\n",{"type":393,"tag":434,"props":4436,"children":4437},{"class":436,"line":447},[4438,4442,4446,4451],{"type":393,"tag":434,"props":4439,"children":4440},{"style":1050},[4441],{"type":399,"value":1362},{"type":393,"tag":434,"props":4443,"children":4444},{"style":462},[4445],{"type":399,"value":454},{"type":393,"tag":434,"props":4447,"children":4448},{"style":1060},[4449],{"type":399,"value":4450},"createMatcherForRuleWithChildRule",{"type":393,"tag":434,"props":4452,"children":4453},{"style":498},[4454],{"type":399,"value":4455},"(\n",{"type":393,"tag":434,"props":4457,"children":4458},{"class":436,"line":468},[4459,4464,4468,4472,4476,4480,4484],{"type":393,"tag":434,"props":4460,"children":4461},{"style":600},[4462],{"type":399,"value":4463},"    /",{"type":393,"tag":434,"props":4465,"children":4466},{"style":1038},[4467],{"type":399,"value":2293},{"type":393,"tag":434,"props":4469,"children":4470},{"style":2934},[4471],{"type":399,"value":4393},{"type":393,"tag":434,"props":4473,"children":4474},{"style":2296},[4475],{"type":399,"value":2299},{"type":393,"tag":434,"props":4477,"children":4478},{"style":594},[4479],{"type":399,"value":1226},{"type":393,"tag":434,"props":4481,"children":4482},{"style":600},[4483],{"type":399,"value":1171},{"type":393,"tag":434,"props":4485,"children":4486},{"style":462},[4487],{"type":399,"value":4488},",\n",{"type":393,"tag":434,"props":4490,"children":4491},{"class":436,"line":494},[4492,4497,4501],{"type":393,"tag":434,"props":4493,"children":4494},{"style":600},[4495],{"type":399,"value":4496},"    '",{"type":393,"tag":434,"props":4498,"children":4499},{"style":606},[4500],{"type":399,"value":4393},{"type":393,"tag":434,"props":4502,"children":4503},{"style":600},[4504],{"type":399,"value":4505},"'\n",{"type":393,"tag":434,"props":4507,"children":4508},{"class":436,"line":514},[4509],{"type":393,"tag":434,"props":4510,"children":4511},{"style":498},[4512],{"type":399,"value":4513},"  )\n",{"type":393,"tag":401,"props":4515,"children":4516},{},[4517],{"type":393,"tag":924,"props":4518,"children":4521},{"alt":4519,"src":4520},"error @host rule","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230803235802.png",[],{"type":393,"tag":401,"props":4523,"children":4524},{},[4525,4527,4534],{"type":399,"value":4526},"在实际项目中，考虑到性能和可维护性的平衡，为了使代码不变得过于复杂，没有必要去完善“边界功能”。运行时的解析应当尽量简单且运行快速，并保持一定的容错：不规范的 CSS 代码在浏览器中本身就能运行，再者，解析器是一个容易带来代码性能和体积瓶颈的地方，要不然 VueJS 也不会分全局构建和运行时",{"type":393,"tag":412,"props":4528,"children":4531},{"href":4529,"rel":4530},"https://www.jsdelivr.com/package/npm/vue?tab=files&path=dist",[416],[4532],{"type":399,"value":4533},"两个版本的编译产物",{"type":399,"value":919},{"type":393,"tag":401,"props":4536,"children":4537},{},[4538],{"type":399,"value":4539},"鉴于 CSS 在部分语法上的灵活性，如果从降低维护难度的角度考虑优化这个 CSS Parser，可能从以下方向：",{"type":393,"tag":4541,"props":4542,"children":4543},"ul",{},[4544,4579],{"type":393,"tag":3851,"props":4545,"children":4546},{},[4547,4549,4554,4556,4562,4564,4569,4571,4578],{"type":399,"value":4548},"在规则匹配部分使用黑名单机制而不是白名单匹配。就 ",{"type":393,"tag":430,"props":4550,"children":4552},{"className":4551},[],[4553],{"type":399,"value":939},{"type":399,"value":4555}," 等灵活语法而言，如果浏览器支持新的 ",{"type":393,"tag":430,"props":4557,"children":4559},{"className":4558},[],[4560],{"type":399,"value":4561},"@xxx",{"type":399,"value":4563}," 语法，黑名单机制编写的代码不需要对 ",{"type":393,"tag":430,"props":4565,"children":4567},{"className":4566},[],[4568],{"type":399,"value":4561},{"type":399,"value":4570}," 做额外处理；而白名单机制需要",{"type":393,"tag":412,"props":4572,"children":4575},{"href":4573,"rel":4574},"https://github.com/micro-zoe/micro-app/commit/b83c4600102e0db6f591bacbdc592bea8f1d5bb8",[416],[4576],{"type":399,"value":4577},"手动处理",{"type":399,"value":919},{"type":393,"tag":3851,"props":4580,"children":4581},{},[4582,4584,4595],{"type":399,"value":4583},"在复杂的解析器部分使用外部依赖，如使用类似 ",{"type":393,"tag":412,"props":4585,"children":4588},{"href":4586,"rel":4587},"https://www.npmjs.com/package/lightningcss-wasm/v/1.16.0",[416],[4589],{"type":393,"tag":430,"props":4590,"children":4592},{"className":4591},[],[4593],{"type":399,"value":4594},"lightingcss-wasm",{"type":399,"value":4596}," 等方案。",{"type":393,"tag":401,"props":4598,"children":4599},{},[4600],{"type":399,"value":4601},"关于样式隔离，作者两年前专门写了文章介绍，不过时效性稍有不足，没有涉及解析器的具体流程，写得更多是解析器在整个微前端框架中的作用，也可作为补充阅读。",{"type":393,"tag":4541,"props":4603,"children":4604},{},[4605],{"type":393,"tag":3851,"props":4606,"children":4607},{},[4608],{"type":393,"tag":412,"props":4609,"children":4612},{"href":4610,"rel":4611},"https://github.com/micro-zoe/micro-app/issues/20",[416],[4613],{"type":399,"value":4614},"从零开始写一个微前端框架-样式隔离篇",{"type":393,"tag":401,"props":4616,"children":4617},{},[4618],{"type":399,"value":4619},"最后，微前端框架中的 CSS 的有很多中实施办法，采用一些办法可以抛弃运行时解析。em... 也许以后有机会聊一聊（咕一咕）。",{"type":393,"tag":394,"props":4621,"children":4623},{"id":4622},"增订-2024-年-1-月-28-日",[4624],{"type":399,"value":4625},"增订 | 2024 年 1 月 28 日",{"type":393,"tag":401,"props":4627,"children":4628},{},[4629,4631],{"type":399,"value":4630},"相关实现和测试用例见",{"type":393,"tag":412,"props":4632,"children":4635},{"href":4633,"rel":4634},"https://github.com/micro-zoe/micro-app/issues/868?_issue=nesting",[416],[4636],{"type":399,"value":4637},"这个 Issue",{"type":393,"tag":4639,"props":4640,"children":4643},"section",{"className":4641,"dataFootnotes":387},[4642],"footnotes",[4644,4651],{"type":393,"tag":394,"props":4645,"children":4648},{"className":4646,"id":913},[4647],"sr-only",[4649],{"type":399,"value":4650},"Footnotes",{"type":393,"tag":3847,"props":4652,"children":4653},{},[4654],{"type":393,"tag":3851,"props":4655,"children":4657},{"id":4656},"user-content-fn-css-syntax",[4658,4660,4666,4668],{"type":399,"value":4659},"比较完整的 CSS 语法参见：",{"type":393,"tag":412,"props":4661,"children":4664},{"href":4662,"rel":4663},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/Syntax",[416],[4665],{"type":399,"value":4662},{"type":399,"value":4667}," ",{"type":393,"tag":412,"props":4669,"children":4674},{"href":4670,"ariaLabel":4671,"className":4672,"dataFootnoteBackref":387},"#user-content-fnref-css-syntax","Back to reference 1",[4673],"data-footnote-backref",[4675],{"type":399,"value":4676},"↩",{"type":393,"tag":4678,"props":4679,"children":4680},"style",{},[4681],{"type":399,"value":4682},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":387,"searchDepth":447,"depth":447,"links":4684},[4685,4686,4687,4688,4689,4690,4691],{"id":396,"depth":447,"text":396},{"id":841,"depth":447,"text":844},{"id":944,"depth":447,"text":944},{"id":4024,"depth":447,"text":4024},{"id":4340,"depth":447,"text":4340},{"id":4622,"depth":447,"text":4625},{"id":913,"depth":447,"text":4650},"markdown","content:2.articles:1101.mini-css-parser.md","content","2.articles/1101.mini-css-parser.md","2.articles/1101.mini-css-parser","md",[4699,4701],{"_path":49,"title":48,"description":4700},"忍者秘籍中提到的模板解析器，很短但支持变量和 if 等语句，还是 15 年前的代码！",{"_path":55,"title":54,"description":4702},"在两个纯知识面的问题上，受到了 GPT 的碾压",1742039234193]