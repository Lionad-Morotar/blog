[{"data":1,"prerenderedAt":4735},["ShallowReactive",2],{"navigation":3,"/articles/mini-css-parser":416,"/articles/mini-css-parser-surround":4730},[4,32,86,108,135,141,147,153,399,405,411],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":42,"_path":43},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":45,"_path":46},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":48,"_path":49},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":51,"_path":52},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":54,"_path":55},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":57,"_path":58},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":60,"_path":61},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":63,"_path":64},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":66,"_path":67},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":69,"_path":70},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":72,"_path":73},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":75,"_path":76},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":78,"_path":79},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":81,"_path":82},"🚝 四十二篇系列","/articles/fourty-two",{"title":84,"_path":85},"📝 技术博客归档","/articles/fold",{"title":87,"_path":88,"children":89},"造物 / Make","/tools",[90,93,96,99,102,105],{"title":91,"_path":92},"🥥 Coconut","/tools/coconut",{"title":94,"_path":95},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":97,"_path":98},"🌐 AnySort","/tools/anysort",{"title":100,"_path":101},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":103,"_path":104},"👓 Crapto","/tools/crypto-inline",{"title":106,"_path":107},"🖨️ any-to-base64","/tools/any-to-base64",{"title":109,"_path":110,"children":111},"吉他剧场 / Music","/music",[112,114,117,120,123,126,129,132],{"title":113,"_path":110},"🎸 FingerStyle！",{"title":115,"_path":116},"🌬️ 等待的风","/music/wind",{"title":118,"_path":119},"💕 约定的海洋","/music/ocean",{"title":121,"_path":122},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":124,"_path":125},"🌏 残酷天使的行动纲领","/music/eva",{"title":127,"_path":128},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":130,"_path":131},"🍷 Wu Wei","/music/wu-wei",{"title":133,"_path":134},"🌅 无题","/music/untitled",{"title":136,"_path":137,"children":138},"画点什么 / Paint","/paint",[139],{"title":140,"_path":137},"🚧 正在施工",{"title":142,"_path":143,"children":144},"读书笔记 / Notes","/books",[145],{"title":146,"_path":143},"📕 读书笔记",{"title":148,"_path":149,"children":150},"知识地图 / Maps","/maps",[151],{"title":152,"_path":149},"🏁 知识地图",{"title":154,"_path":155,"children":156},"零散的笔记 / Gists","/gists",[157,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375,378,381,384,387,390,393,396],{"title":158,"_path":155},"🧊 Gists",{"title":160,"_path":161},"网站的可访问性","/gists/accessibility",{"title":163,"_path":164},"Bit","/gists/bit",{"title":166,"_path":167},"图片模糊","/gists/blur",{"title":169,"_path":170},"渲染相关笔记","/gists/c4d",{"title":172,"_path":173},"CDN 问题记录","/gists/cdn",{"title":175,"_path":176},"消毒剂","/gists/cleaner",{"title":178,"_path":179},"Windows Command","/gists/cmd",{"title":181,"_path":182},"Command","/gists/command",{"title":184,"_path":185},"复杂科学","/gists/complexity-science",{"title":187,"_path":188},"GitHub Copilot","/gists/copilot",{"title":190,"_path":191},"宇宙","/gists/cosmos",{"title":193,"_path":194},"C++","/gists/cpp",{"title":196,"_path":197},"Data Structure","/gists/data-structure",{"title":199,"_path":200},"DEPRESSION","/gists/depression",{"title":202,"_path":203},"设计模式","/gists/design-patterns",{"title":205,"_path":206},"Developer Experience","/gists/developer-experience",{"title":208,"_path":209},"Device Metrics","/gists/device-metrix",{"title":211,"_path":212},"数字化转型","/gists/digital-transformation",{"title":214,"_path":215},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":217,"_path":218},"正则表达式","/gists/eegex",{"title":220,"_path":221},"Emoji","/gists/emoji",{"title":223,"_path":224},"工程","/gists/engineering",{"title":226,"_path":227},"熵","/gists/entropy",{"title":229,"_path":230},"Environment","/gists/environment",{"title":232,"_path":233},"Erlang","/gists/erlang",{"title":235,"_path":236},"逃离塔克夫","/gists/escape-from-tarkov",{"title":238,"_path":239},"ESNext (ES6-ES11)","/gists/esnext",{"title":241,"_path":242},"Eval！","/gists/eval",{"title":244,"_path":245},"Flutter","/gists/flutter",{"title":247,"_path":248},"字体","/gists/font",{"title":250,"_path":251},"JS 函数式编程","/gists/functional",{"title":253,"_path":254},"游戏化","/gists/gamification",{"title":256,"_path":257},"Google C++ Standard","/gists/google-cpp-standard",{"title":259,"_path":260},"双向链接完全体","/gists/graph",{"title":262,"_path":263},"Hardwares","/gists/hardwares",{"title":265,"_path":266},"哈希冲突","/gists/hash-collision",{"title":268,"_path":269},"信息设计","/gists/information-design",{"title":271,"_path":272},"InstantPage","/gists/instant.page",{"title":274,"_path":275},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":277,"_path":278},"KVStore","/gists/key-value-db",{"title":280,"_path":281},"Kubernetes","/gists/kubernetes",{"title":283,"_path":284},"Makefile","/gists/makefile",{"title":286,"_path":287},"Markdown Inline Style","/gists/markdown-nice",{"title":289,"_path":290},"小程序","/gists/miniapp",{"title":292,"_path":293},"减小页面快照体积","/gists/minify-html",{"title":295,"_path":296},"mklink","/gists/mklink",{"title":298,"_path":299},"Mock","/gists/mock",{"title":301,"_path":302},"多人协作系统","/gists/multiplayer",{"title":304,"_path":305},"多端应用","/gists/multy-end-app",{"title":307,"_path":308},"神经科学","/gists/neuroscience",{"title":310,"_path":311},"OO","/gists/oo",{"title":313,"_path":314},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":316,"_path":317},"PInvoke","/gists/pinvoke",{"title":319,"_path":320},"像素","/gists/pixel",{"title":322,"_path":323},"PowerShell","/gists/powershell",{"title":325,"_path":326},"量子","/gists/quantum",{"title":328,"_path":329},"保持好奇心","/gists/questions",{"title":331,"_path":332},"React Native","/gists/react-native",{"title":334,"_path":335},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":337,"_path":338},"SEO","/gists/seo",{"title":340,"_path":341},"Shader","/gists/shader",{"title":343,"_path":344},"Shape Up","/gists/shape-up",{"title":346,"_path":347},"睡觉","/gists/sleep",{"title":349,"_path":350},"记录奇怪的问题","/gists/solved",{"title":352,"_path":353},"States","/gists/states",{"title":355,"_path":356},"Storage","/gists/storage",{"title":358,"_path":359},"音视频流处理","/gists/stream-cli",{"title":361,"_path":362},"Symbol","/gists/symbol",{"title":364,"_path":365},"系统论","/gists/systems-theory",{"title":367,"_path":368},"Taro","/gists/taro",{"title":370,"_path":371},"任务切片","/gists/task-slice",{"title":373,"_path":374},"技术偏好","/gists/tech-dudge",{"title":376,"_path":377},"Untitled","/gists/untitled",{"title":379,"_path":380},"可变字体","/gists/variable-font",{"title":382,"_path":383},"视觉错觉","/gists/visual-illusion",{"title":385,"_path":386},"SS(SSR)","/gists/vpn",{"title":388,"_path":389},"VS Code 插件开发","/gists/vscode-plugin",{"title":391,"_path":392},"Web Components","/gists/web-components",{"title":394,"_path":395},"Windows","/gists/windows",{"title":397,"_path":398},"查缺补漏","/gists/wrong",{"title":400,"_path":401,"children":402},"代码笔记 / Gists","/source-code",[403],{"title":404,"_path":401},"🚄 代码笔记",{"title":406,"_path":407,"children":408},"我 / Abount","/hire",[409],{"title":410,"_path":407},"📬 技术简历",{"title":412,"_path":413,"children":414},"todo","/todo",[415],{"title":412,"_path":413},{"_path":49,"_dir":417,"_draft":418,"_partial":418,"_locale":419,"title":48,"description":420,"body":421,"_type":4724,"_id":4725,"_source":4726,"_file":4727,"_stem":4728,"_extension":4729},"articles",false,"","我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。我碰到的问题是，如果 CSS 源码中带嵌套语法那么解析就会失败。今天借这个问题给大家简单介绍一下 CSS Parser 的基本流程。",{"type":422,"children":423,"toc":4715},"root",[424,432,438,454,871,877,952,961,974,979,985,1008,1013,1337,1342,1734,1762,1833,1838,1858,1883,1959,1964,1969,2255,2267,2359,2398,2415,2700,2744,3218,3259,3810,3821,3861,3866,3878,3979,4014,4034,4054,4059,4064,4358,4363,4370,4375,4380,4388,4396,4404,4412,4447,4546,4554,4567,4572,4629,4634,4647,4652,4658,4670,4709],{"type":425,"tag":426,"props":427,"children":429},"element","h2",{"id":428},"前言",[430],{"type":431,"value":428},"text",{"type":425,"tag":433,"props":434,"children":435},"p",{},[436],{"type":431,"value":437},"Vue 源码中包含 HTML Parser，随着大家在框架方向的深入学习（卷），不免要开始接触一些编译解析相关的东西。社区很多看 Vue 源码时总结的 HTML Parser 的文章，但是很少有介绍 CSS Parser 的文章。今天借着在开发时碰到的一个问题，给大家简单介绍一下 CSS Parser 的基本流程。",{"type":425,"tag":433,"props":439,"children":440},{},[441,443,452],{"type":431,"value":442},"我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。代码示例见下。我碰到的问题是，如果 CSS 源码中带",{"type":425,"tag":444,"props":445,"children":449},"a",{"href":446,"rel":447},"https://caniuse.com/?search=css%20nesting",[448],"nofollow",[450],{"type":431,"value":451},"嵌套语法",{"type":431,"value":453},"，那么解析就会失败。",{"type":425,"tag":455,"props":456,"children":460},"pre",{"className":457,"code":458,"language":459,"meta":419,"style":419},"language-css shiki shiki-themes material-theme-lighter github-light github-dark monokai","/* css 源代码 */\n.a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  }\n}\n\n/* 期待转化得到的代码 */\nmicro-app[name=\"test-app\"] .a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  }\n}\n\n/* 实际得到的代码 */\nmicro-app[name=\"test-app\"] .a {\n  z-index: 1;\n  .b {\n    z-index: 2;\n  } /* -> 到这里就停了 */\n","css",[461],{"type":425,"tag":462,"props":463,"children":464},"code",{"__ignoreMap":419},[465,477,498,524,544,566,575,584,594,603,664,684,700,720,728,736,744,753,801,821,837,857],{"type":425,"tag":466,"props":467,"children":470},"span",{"class":468,"line":469},"line",1,[471],{"type":425,"tag":466,"props":472,"children":474},{"style":473},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[475],{"type":431,"value":476},"/* css 源代码 */\n",{"type":425,"tag":466,"props":478,"children":480},{"class":468,"line":479},2,[481,487,492],{"type":425,"tag":466,"props":482,"children":484},{"style":483},"--shiki-light:#39ADB5;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[485],{"type":431,"value":486},".",{"type":425,"tag":466,"props":488,"children":490},{"style":489},"--shiki-light:#E2931D;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[491],{"type":431,"value":444},{"type":425,"tag":466,"props":493,"children":495},{"style":494},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[496],{"type":431,"value":497}," {\n",{"type":425,"tag":466,"props":499,"children":501},{"class":468,"line":500},3,[502,508,513,519],{"type":425,"tag":466,"props":503,"children":505},{"style":504},"--shiki-light:#8796B0;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[506],{"type":431,"value":507},"  z-index",{"type":425,"tag":466,"props":509,"children":510},{"style":494},[511],{"type":431,"value":512},":",{"type":425,"tag":466,"props":514,"children":516},{"style":515},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[517],{"type":431,"value":518}," 1",{"type":425,"tag":466,"props":520,"children":521},{"style":494},[522],{"type":431,"value":523},";\n",{"type":425,"tag":466,"props":525,"children":527},{"class":468,"line":526},4,[528,534,540],{"type":425,"tag":466,"props":529,"children":531},{"style":530},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[532],{"type":431,"value":533},"  .",{"type":425,"tag":466,"props":535,"children":537},{"style":536},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[538],{"type":431,"value":539},"b",{"type":425,"tag":466,"props":541,"children":542},{"style":530},[543],{"type":431,"value":497},{"type":425,"tag":466,"props":545,"children":547},{"class":468,"line":546},5,[548,553,557,562],{"type":425,"tag":466,"props":549,"children":550},{"style":504},[551],{"type":431,"value":552},"    z-index",{"type":425,"tag":466,"props":554,"children":555},{"style":494},[556],{"type":431,"value":512},{"type":425,"tag":466,"props":558,"children":559},{"style":515},[560],{"type":431,"value":561}," 2",{"type":425,"tag":466,"props":563,"children":564},{"style":494},[565],{"type":431,"value":523},{"type":425,"tag":466,"props":567,"children":569},{"class":468,"line":568},6,[570],{"type":425,"tag":466,"props":571,"children":572},{"style":494},[573],{"type":431,"value":574},"  }\n",{"type":425,"tag":466,"props":576,"children":578},{"class":468,"line":577},7,[579],{"type":425,"tag":466,"props":580,"children":581},{"style":530},[582],{"type":431,"value":583},"}\n",{"type":425,"tag":466,"props":585,"children":587},{"class":468,"line":586},8,[588],{"type":425,"tag":466,"props":589,"children":591},{"emptyLinePlaceholder":590},true,[592],{"type":431,"value":593},"\n",{"type":425,"tag":466,"props":595,"children":597},{"class":468,"line":596},9,[598],{"type":425,"tag":466,"props":599,"children":600},{"style":473},[601],{"type":431,"value":602},"/* 期待转化得到的代码 */\n",{"type":425,"tag":466,"props":604,"children":606},{"class":468,"line":605},10,[607,613,618,624,630,636,642,646,651,656,660],{"type":425,"tag":466,"props":608,"children":610},{"style":609},"--shiki-light:#E2931D;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[611],{"type":431,"value":612},"micro-app",{"type":425,"tag":466,"props":614,"children":615},{"style":494},[616],{"type":431,"value":617},"[",{"type":425,"tag":466,"props":619,"children":621},{"style":620},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[622],{"type":431,"value":623},"name",{"type":425,"tag":466,"props":625,"children":627},{"style":626},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[628],{"type":431,"value":629},"=",{"type":425,"tag":466,"props":631,"children":633},{"style":632},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[634],{"type":431,"value":635},"\"",{"type":425,"tag":466,"props":637,"children":639},{"style":638},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[640],{"type":431,"value":641},"test-app",{"type":425,"tag":466,"props":643,"children":644},{"style":632},[645],{"type":431,"value":635},{"type":425,"tag":466,"props":647,"children":648},{"style":494},[649],{"type":431,"value":650},"]",{"type":425,"tag":466,"props":652,"children":653},{"style":483},[654],{"type":431,"value":655}," .",{"type":425,"tag":466,"props":657,"children":658},{"style":489},[659],{"type":431,"value":444},{"type":425,"tag":466,"props":661,"children":662},{"style":494},[663],{"type":431,"value":497},{"type":425,"tag":466,"props":665,"children":667},{"class":468,"line":666},11,[668,672,676,680],{"type":425,"tag":466,"props":669,"children":670},{"style":504},[671],{"type":431,"value":507},{"type":425,"tag":466,"props":673,"children":674},{"style":494},[675],{"type":431,"value":512},{"type":425,"tag":466,"props":677,"children":678},{"style":515},[679],{"type":431,"value":518},{"type":425,"tag":466,"props":681,"children":682},{"style":494},[683],{"type":431,"value":523},{"type":425,"tag":466,"props":685,"children":687},{"class":468,"line":686},12,[688,692,696],{"type":425,"tag":466,"props":689,"children":690},{"style":530},[691],{"type":431,"value":533},{"type":425,"tag":466,"props":693,"children":694},{"style":536},[695],{"type":431,"value":539},{"type":425,"tag":466,"props":697,"children":698},{"style":530},[699],{"type":431,"value":497},{"type":425,"tag":466,"props":701,"children":703},{"class":468,"line":702},13,[704,708,712,716],{"type":425,"tag":466,"props":705,"children":706},{"style":504},[707],{"type":431,"value":552},{"type":425,"tag":466,"props":709,"children":710},{"style":494},[711],{"type":431,"value":512},{"type":425,"tag":466,"props":713,"children":714},{"style":515},[715],{"type":431,"value":561},{"type":425,"tag":466,"props":717,"children":718},{"style":494},[719],{"type":431,"value":523},{"type":425,"tag":466,"props":721,"children":723},{"class":468,"line":722},14,[724],{"type":425,"tag":466,"props":725,"children":726},{"style":494},[727],{"type":431,"value":574},{"type":425,"tag":466,"props":729,"children":731},{"class":468,"line":730},15,[732],{"type":425,"tag":466,"props":733,"children":734},{"style":530},[735],{"type":431,"value":583},{"type":425,"tag":466,"props":737,"children":739},{"class":468,"line":738},16,[740],{"type":425,"tag":466,"props":741,"children":742},{"emptyLinePlaceholder":590},[743],{"type":431,"value":593},{"type":425,"tag":466,"props":745,"children":747},{"class":468,"line":746},17,[748],{"type":425,"tag":466,"props":749,"children":750},{"style":473},[751],{"type":431,"value":752},"/* 实际得到的代码 */\n",{"type":425,"tag":466,"props":754,"children":756},{"class":468,"line":755},18,[757,761,765,769,773,777,781,785,789,793,797],{"type":425,"tag":466,"props":758,"children":759},{"style":609},[760],{"type":431,"value":612},{"type":425,"tag":466,"props":762,"children":763},{"style":494},[764],{"type":431,"value":617},{"type":425,"tag":466,"props":766,"children":767},{"style":620},[768],{"type":431,"value":623},{"type":425,"tag":466,"props":770,"children":771},{"style":626},[772],{"type":431,"value":629},{"type":425,"tag":466,"props":774,"children":775},{"style":632},[776],{"type":431,"value":635},{"type":425,"tag":466,"props":778,"children":779},{"style":638},[780],{"type":431,"value":641},{"type":425,"tag":466,"props":782,"children":783},{"style":632},[784],{"type":431,"value":635},{"type":425,"tag":466,"props":786,"children":787},{"style":494},[788],{"type":431,"value":650},{"type":425,"tag":466,"props":790,"children":791},{"style":483},[792],{"type":431,"value":655},{"type":425,"tag":466,"props":794,"children":795},{"style":489},[796],{"type":431,"value":444},{"type":425,"tag":466,"props":798,"children":799},{"style":494},[800],{"type":431,"value":497},{"type":425,"tag":466,"props":802,"children":804},{"class":468,"line":803},19,[805,809,813,817],{"type":425,"tag":466,"props":806,"children":807},{"style":504},[808],{"type":431,"value":507},{"type":425,"tag":466,"props":810,"children":811},{"style":494},[812],{"type":431,"value":512},{"type":425,"tag":466,"props":814,"children":815},{"style":515},[816],{"type":431,"value":518},{"type":425,"tag":466,"props":818,"children":819},{"style":494},[820],{"type":431,"value":523},{"type":425,"tag":466,"props":822,"children":824},{"class":468,"line":823},20,[825,829,833],{"type":425,"tag":466,"props":826,"children":827},{"style":530},[828],{"type":431,"value":533},{"type":425,"tag":466,"props":830,"children":831},{"style":536},[832],{"type":431,"value":539},{"type":425,"tag":466,"props":834,"children":835},{"style":530},[836],{"type":431,"value":497},{"type":425,"tag":466,"props":838,"children":840},{"class":468,"line":839},21,[841,845,849,853],{"type":425,"tag":466,"props":842,"children":843},{"style":504},[844],{"type":431,"value":552},{"type":425,"tag":466,"props":846,"children":847},{"style":494},[848],{"type":431,"value":512},{"type":425,"tag":466,"props":850,"children":851},{"style":515},[852],{"type":431,"value":561},{"type":425,"tag":466,"props":854,"children":855},{"style":494},[856],{"type":431,"value":523},{"type":425,"tag":466,"props":858,"children":860},{"class":468,"line":859},22,[861,866],{"type":425,"tag":466,"props":862,"children":863},{"style":494},[864],{"type":431,"value":865},"  }",{"type":425,"tag":466,"props":867,"children":868},{"style":473},[869],{"type":431,"value":870}," /* -> 到这里就停了 */\n",{"type":425,"tag":426,"props":872,"children":874},{"id":873},"css-的组成部分",[875],{"type":431,"value":876},"CSS 的组成部分",{"type":425,"tag":433,"props":878,"children":879},{},[880,882,889,891,897,899,905,907,913,915,921,923,929,931,937,950],{"type":431,"value":881},"要理解 CSS 是怎么解析的，就要先清楚 CSS 是由哪几部分组成的。由我们平常见得最多的普通 CSS 代码开始说起，见下图，基本的 CSS 代码的组成部分包含规则集（rules）、选择器（selector）、选择器（declares）、属性（property）、值（value）这五个部分。",{"type":425,"tag":883,"props":884,"children":886},"abbr",{"title":885},"rule",[887],{"type":431,"value":888},"规则",{"type":431,"value":890},"是由",{"type":425,"tag":883,"props":892,"children":894},{"title":893},"property",[895],{"type":431,"value":896},"属性",{"type":431,"value":898},"和",{"type":425,"tag":883,"props":900,"children":902},{"title":901},"value",[903],{"type":431,"value":904},"值",{"type":431,"value":906},"组成的",{"type":425,"tag":883,"props":908,"children":910},{"title":909},"declaration",[911],{"type":431,"value":912},"声明",{"type":431,"value":914},"、声明与括号形成的",{"type":425,"tag":883,"props":916,"children":918},{"title":917},"declaration block",[919],{"type":431,"value":920},"声明块",{"type":431,"value":922},"再加上",{"type":425,"tag":883,"props":924,"children":926},{"title":925},"selector",[927],{"type":431,"value":928},"选择器",{"type":431,"value":930},"组成，而一条或多条规则组合成了",{"type":425,"tag":883,"props":932,"children":934},{"title":933},"rule sets",[935],{"type":431,"value":936},"规则集",{"type":425,"tag":938,"props":939,"children":940},"sup",{},[941],{"type":425,"tag":444,"props":942,"children":947},{"href":943,"ariaDescribedBy":944,"dataFootnoteRef":419,"id":946},"#user-content-fn-css-syntax",[945],"footnote-label","user-content-fnref-css-syntax",[948],{"type":431,"value":949},"1",{"type":431,"value":951},"。",{"type":425,"tag":433,"props":953,"children":954},{},[955],{"type":425,"tag":956,"props":957,"children":960},"img",{"alt":958,"src":959},"规则&规则集","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/200621/20200625022018.png",[],{"type":425,"tag":433,"props":962,"children":963},{},[964,966,972],{"type":431,"value":965},"图中没有包含 ",{"type":425,"tag":462,"props":967,"children":969},{"className":968},[],[970],{"type":431,"value":971},"at-rule",{"type":431,"value":973}," 的部分，哦，还少了注释部分~ 由于注释是 CSS 中语法最简单的部分，我们从解析注释开始代码部分的解读吧。",{"type":425,"tag":426,"props":975,"children":977},{"id":976},"流程速览",[978],{"type":431,"value":976},{"type":425,"tag":980,"props":981,"children":983},"h4",{"id":982},"解析注释",[984],{"type":431,"value":982},{"type":425,"tag":433,"props":986,"children":987},{},[988,990,997,999,1006],{"type":431,"value":989},"可能许多人不了解 CSS 的注释风格，这里先说明一下，原生 CSS 仅支持",{"type":425,"tag":444,"props":991,"children":994},{"href":992,"rel":993},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/Comments",[448],[995],{"type":431,"value":996},"斜杠星号风格注释",{"type":431,"value":998},"，不支持",{"type":425,"tag":444,"props":1000,"children":1003},{"href":1001,"rel":1002},"https://segmentfault.com/a/1190000043885414",[448],[1004],{"type":431,"value":1005},"双斜杠注释",{"type":431,"value":1007},"，所以解析器并未处理双斜杠的情况。",{"type":425,"tag":433,"props":1009,"children":1010},{},[1011],{"type":431,"value":1012},"解析注释的函数是一个 while 循环，从代码开头开始匹配，每次循环解析一条注释，直到代码开头没有注释为止。",{"type":425,"tag":455,"props":1014,"children":1018},{"className":1015,"code":1016,"language":1017,"meta":419,"style":419},"language-ts shiki shiki-themes material-theme-lighter github-light github-dark monokai","class CSSParser {\n  private matchComments() {\n    while (this.matchComment());\n  }\n  private matchComment() {\n    // 快速跳过非注释部分代码\n    if (this.cssText.charAt(0) !== \"/\" || this.cssText.charAt(1) !== \"*\") {\n      return false;\n    }\n    // ...\n    return true;\n  }\n}\n","ts",[1019],{"type":425,"tag":462,"props":1020,"children":1021},{"__ignoreMap":419},[1022,1041,1065,1105,1112,1132,1140,1272,1290,1298,1306,1323,1330],{"type":425,"tag":466,"props":1023,"children":1024},{"class":468,"line":469},[1025,1031,1037],{"type":425,"tag":466,"props":1026,"children":1028},{"style":1027},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[1029],{"type":431,"value":1030},"class",{"type":425,"tag":466,"props":1032,"children":1034},{"style":1033},"--shiki-light:#E2931D;--shiki-light-text-decoration:inherit;--shiki-default:#6F42C1;--shiki-default-text-decoration:inherit;--shiki-dark:#B392F0;--shiki-dark-text-decoration:inherit;--shiki-sepia:#A6E22E;--shiki-sepia-text-decoration:underline",[1035],{"type":431,"value":1036}," CSSParser",{"type":425,"tag":466,"props":1038,"children":1039},{"style":494},[1040],{"type":431,"value":497},{"type":425,"tag":466,"props":1042,"children":1043},{"class":468,"line":479},[1044,1050,1056,1061],{"type":425,"tag":466,"props":1045,"children":1047},{"style":1046},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1048],{"type":431,"value":1049},"  private",{"type":425,"tag":466,"props":1051,"children":1053},{"style":1052},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1054],{"type":431,"value":1055}," matchComments",{"type":425,"tag":466,"props":1057,"children":1058},{"style":494},[1059],{"type":431,"value":1060},"()",{"type":425,"tag":466,"props":1062,"children":1063},{"style":494},[1064],{"type":431,"value":497},{"type":425,"tag":466,"props":1066,"children":1067},{"class":468,"line":500},[1068,1074,1080,1086,1090,1096,1101],{"type":425,"tag":466,"props":1069,"children":1071},{"style":1070},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[1072],{"type":431,"value":1073},"    while",{"type":425,"tag":466,"props":1075,"children":1077},{"style":1076},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[1078],{"type":431,"value":1079}," (",{"type":425,"tag":466,"props":1081,"children":1083},{"style":1082},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[1084],{"type":431,"value":1085},"this",{"type":425,"tag":466,"props":1087,"children":1088},{"style":494},[1089],{"type":431,"value":486},{"type":425,"tag":466,"props":1091,"children":1093},{"style":1092},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1094],{"type":431,"value":1095},"matchComment",{"type":425,"tag":466,"props":1097,"children":1098},{"style":1076},[1099],{"type":431,"value":1100},"())",{"type":425,"tag":466,"props":1102,"children":1103},{"style":494},[1104],{"type":431,"value":523},{"type":425,"tag":466,"props":1106,"children":1107},{"class":468,"line":526},[1108],{"type":425,"tag":466,"props":1109,"children":1110},{"style":494},[1111],{"type":431,"value":574},{"type":425,"tag":466,"props":1113,"children":1114},{"class":468,"line":546},[1115,1119,1124,1128],{"type":425,"tag":466,"props":1116,"children":1117},{"style":1046},[1118],{"type":431,"value":1049},{"type":425,"tag":466,"props":1120,"children":1121},{"style":1052},[1122],{"type":431,"value":1123}," matchComment",{"type":425,"tag":466,"props":1125,"children":1126},{"style":494},[1127],{"type":431,"value":1060},{"type":425,"tag":466,"props":1129,"children":1130},{"style":494},[1131],{"type":431,"value":497},{"type":425,"tag":466,"props":1133,"children":1134},{"class":468,"line":568},[1135],{"type":425,"tag":466,"props":1136,"children":1137},{"style":473},[1138],{"type":431,"value":1139},"    // 快速跳过非注释部分代码\n",{"type":425,"tag":466,"props":1141,"children":1142},{"class":468,"line":577},[1143,1148,1152,1156,1160,1165,1169,1174,1179,1184,1189,1194,1199,1204,1208,1213,1218,1222,1226,1230,1234,1238,1242,1246,1250,1254,1259,1263,1267],{"type":425,"tag":466,"props":1144,"children":1145},{"style":1070},[1146],{"type":431,"value":1147},"    if",{"type":425,"tag":466,"props":1149,"children":1150},{"style":1076},[1151],{"type":431,"value":1079},{"type":425,"tag":466,"props":1153,"children":1154},{"style":1082},[1155],{"type":431,"value":1085},{"type":425,"tag":466,"props":1157,"children":1158},{"style":494},[1159],{"type":431,"value":486},{"type":425,"tag":466,"props":1161,"children":1162},{"style":530},[1163],{"type":431,"value":1164},"cssText",{"type":425,"tag":466,"props":1166,"children":1167},{"style":494},[1168],{"type":431,"value":486},{"type":425,"tag":466,"props":1170,"children":1171},{"style":1092},[1172],{"type":431,"value":1173},"charAt",{"type":425,"tag":466,"props":1175,"children":1176},{"style":1076},[1177],{"type":431,"value":1178},"(",{"type":425,"tag":466,"props":1180,"children":1181},{"style":515},[1182],{"type":431,"value":1183},"0",{"type":425,"tag":466,"props":1185,"children":1186},{"style":1076},[1187],{"type":431,"value":1188},") ",{"type":425,"tag":466,"props":1190,"children":1191},{"style":626},[1192],{"type":431,"value":1193},"!==",{"type":425,"tag":466,"props":1195,"children":1196},{"style":632},[1197],{"type":431,"value":1198}," \"",{"type":425,"tag":466,"props":1200,"children":1201},{"style":638},[1202],{"type":431,"value":1203},"/",{"type":425,"tag":466,"props":1205,"children":1206},{"style":632},[1207],{"type":431,"value":635},{"type":425,"tag":466,"props":1209,"children":1210},{"style":626},[1211],{"type":431,"value":1212}," ||",{"type":425,"tag":466,"props":1214,"children":1215},{"style":1082},[1216],{"type":431,"value":1217}," this",{"type":425,"tag":466,"props":1219,"children":1220},{"style":494},[1221],{"type":431,"value":486},{"type":425,"tag":466,"props":1223,"children":1224},{"style":530},[1225],{"type":431,"value":1164},{"type":425,"tag":466,"props":1227,"children":1228},{"style":494},[1229],{"type":431,"value":486},{"type":425,"tag":466,"props":1231,"children":1232},{"style":1092},[1233],{"type":431,"value":1173},{"type":425,"tag":466,"props":1235,"children":1236},{"style":1076},[1237],{"type":431,"value":1178},{"type":425,"tag":466,"props":1239,"children":1240},{"style":515},[1241],{"type":431,"value":949},{"type":425,"tag":466,"props":1243,"children":1244},{"style":1076},[1245],{"type":431,"value":1188},{"type":425,"tag":466,"props":1247,"children":1248},{"style":626},[1249],{"type":431,"value":1193},{"type":425,"tag":466,"props":1251,"children":1252},{"style":632},[1253],{"type":431,"value":1198},{"type":425,"tag":466,"props":1255,"children":1256},{"style":638},[1257],{"type":431,"value":1258},"*",{"type":425,"tag":466,"props":1260,"children":1261},{"style":632},[1262],{"type":431,"value":635},{"type":425,"tag":466,"props":1264,"children":1265},{"style":1076},[1266],{"type":431,"value":1188},{"type":425,"tag":466,"props":1268,"children":1269},{"style":494},[1270],{"type":431,"value":1271},"{\n",{"type":425,"tag":466,"props":1273,"children":1274},{"class":468,"line":586},[1275,1280,1286],{"type":425,"tag":466,"props":1276,"children":1277},{"style":1070},[1278],{"type":431,"value":1279},"      return",{"type":425,"tag":466,"props":1281,"children":1283},{"style":1282},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1284],{"type":431,"value":1285}," false",{"type":425,"tag":466,"props":1287,"children":1288},{"style":494},[1289],{"type":431,"value":523},{"type":425,"tag":466,"props":1291,"children":1292},{"class":468,"line":596},[1293],{"type":425,"tag":466,"props":1294,"children":1295},{"style":494},[1296],{"type":431,"value":1297},"    }\n",{"type":425,"tag":466,"props":1299,"children":1300},{"class":468,"line":605},[1301],{"type":425,"tag":466,"props":1302,"children":1303},{"style":473},[1304],{"type":431,"value":1305},"    // ...\n",{"type":425,"tag":466,"props":1307,"children":1308},{"class":468,"line":666},[1309,1314,1319],{"type":425,"tag":466,"props":1310,"children":1311},{"style":1070},[1312],{"type":431,"value":1313},"    return",{"type":425,"tag":466,"props":1315,"children":1316},{"style":1282},[1317],{"type":431,"value":1318}," true",{"type":425,"tag":466,"props":1320,"children":1321},{"style":494},[1322],{"type":431,"value":523},{"type":425,"tag":466,"props":1324,"children":1325},{"class":468,"line":686},[1326],{"type":425,"tag":466,"props":1327,"children":1328},{"style":494},[1329],{"type":431,"value":574},{"type":425,"tag":466,"props":1331,"children":1332},{"class":468,"line":702},[1333],{"type":425,"tag":466,"props":1334,"children":1335},{"style":494},[1336],{"type":431,"value":583},{"type":425,"tag":433,"props":1338,"children":1339},{},[1340],{"type":431,"value":1341},"在选择解析注释内容的方法上，micro-app 没有使用正则，而是用了下标递增的办法。暂不清楚原因，感兴趣的小伙伴可以试试几种相关办法的性能对比。",{"type":425,"tag":455,"props":1343,"children":1345},{"className":1015,"code":1344,"language":1017,"meta":419,"style":419},"let i = 2;\nwhile (\n  this.cssText.charAt(i) !== \"\" &&\n  (this.cssText.charAt(i) !== \"*\" || this.cssText.charAt(i + 1) !== \"/\")\n) {\n  ++i;\n}\ni += 2;\n\nlet commentText = this.cssText.slice(2, i - 2);\n/* ... */\nthis.cssText = this.cssText.slice(i);\n",[1346],{"type":425,"tag":462,"props":1347,"children":1348},{"__ignoreMap":419},[1349,1374,1387,1430,1541,1552,1569,1576,1597,1604,1677,1685],{"type":425,"tag":466,"props":1350,"children":1351},{"class":468,"line":469},[1352,1357,1362,1366,1370],{"type":425,"tag":466,"props":1353,"children":1354},{"style":1027},[1355],{"type":431,"value":1356},"let",{"type":425,"tag":466,"props":1358,"children":1359},{"style":530},[1360],{"type":431,"value":1361}," i ",{"type":425,"tag":466,"props":1363,"children":1364},{"style":626},[1365],{"type":431,"value":629},{"type":425,"tag":466,"props":1367,"children":1368},{"style":515},[1369],{"type":431,"value":561},{"type":425,"tag":466,"props":1371,"children":1372},{"style":494},[1373],{"type":431,"value":523},{"type":425,"tag":466,"props":1375,"children":1376},{"class":468,"line":479},[1377,1382],{"type":425,"tag":466,"props":1378,"children":1379},{"style":1070},[1380],{"type":431,"value":1381},"while",{"type":425,"tag":466,"props":1383,"children":1384},{"style":530},[1385],{"type":431,"value":1386}," (\n",{"type":425,"tag":466,"props":1388,"children":1389},{"class":468,"line":500},[1390,1395,1399,1403,1407,1411,1416,1420,1425],{"type":425,"tag":466,"props":1391,"children":1392},{"style":1082},[1393],{"type":431,"value":1394},"  this",{"type":425,"tag":466,"props":1396,"children":1397},{"style":494},[1398],{"type":431,"value":486},{"type":425,"tag":466,"props":1400,"children":1401},{"style":530},[1402],{"type":431,"value":1164},{"type":425,"tag":466,"props":1404,"children":1405},{"style":494},[1406],{"type":431,"value":486},{"type":425,"tag":466,"props":1408,"children":1409},{"style":1092},[1410],{"type":431,"value":1173},{"type":425,"tag":466,"props":1412,"children":1413},{"style":530},[1414],{"type":431,"value":1415},"(i) ",{"type":425,"tag":466,"props":1417,"children":1418},{"style":626},[1419],{"type":431,"value":1193},{"type":425,"tag":466,"props":1421,"children":1422},{"style":632},[1423],{"type":431,"value":1424}," \"\"",{"type":425,"tag":466,"props":1426,"children":1427},{"style":626},[1428],{"type":431,"value":1429}," &&\n",{"type":425,"tag":466,"props":1431,"children":1432},{"class":468,"line":526},[1433,1438,1442,1446,1450,1454,1458,1462,1466,1470,1474,1478,1482,1486,1490,1494,1498,1502,1507,1512,1516,1520,1524,1528,1532,1536],{"type":425,"tag":466,"props":1434,"children":1435},{"style":530},[1436],{"type":431,"value":1437},"  (",{"type":425,"tag":466,"props":1439,"children":1440},{"style":1082},[1441],{"type":431,"value":1085},{"type":425,"tag":466,"props":1443,"children":1444},{"style":494},[1445],{"type":431,"value":486},{"type":425,"tag":466,"props":1447,"children":1448},{"style":530},[1449],{"type":431,"value":1164},{"type":425,"tag":466,"props":1451,"children":1452},{"style":494},[1453],{"type":431,"value":486},{"type":425,"tag":466,"props":1455,"children":1456},{"style":1092},[1457],{"type":431,"value":1173},{"type":425,"tag":466,"props":1459,"children":1460},{"style":530},[1461],{"type":431,"value":1415},{"type":425,"tag":466,"props":1463,"children":1464},{"style":626},[1465],{"type":431,"value":1193},{"type":425,"tag":466,"props":1467,"children":1468},{"style":632},[1469],{"type":431,"value":1198},{"type":425,"tag":466,"props":1471,"children":1472},{"style":638},[1473],{"type":431,"value":1258},{"type":425,"tag":466,"props":1475,"children":1476},{"style":632},[1477],{"type":431,"value":635},{"type":425,"tag":466,"props":1479,"children":1480},{"style":626},[1481],{"type":431,"value":1212},{"type":425,"tag":466,"props":1483,"children":1484},{"style":1082},[1485],{"type":431,"value":1217},{"type":425,"tag":466,"props":1487,"children":1488},{"style":494},[1489],{"type":431,"value":486},{"type":425,"tag":466,"props":1491,"children":1492},{"style":530},[1493],{"type":431,"value":1164},{"type":425,"tag":466,"props":1495,"children":1496},{"style":494},[1497],{"type":431,"value":486},{"type":425,"tag":466,"props":1499,"children":1500},{"style":1092},[1501],{"type":431,"value":1173},{"type":425,"tag":466,"props":1503,"children":1504},{"style":530},[1505],{"type":431,"value":1506},"(i ",{"type":425,"tag":466,"props":1508,"children":1509},{"style":626},[1510],{"type":431,"value":1511},"+",{"type":425,"tag":466,"props":1513,"children":1514},{"style":515},[1515],{"type":431,"value":518},{"type":425,"tag":466,"props":1517,"children":1518},{"style":530},[1519],{"type":431,"value":1188},{"type":425,"tag":466,"props":1521,"children":1522},{"style":626},[1523],{"type":431,"value":1193},{"type":425,"tag":466,"props":1525,"children":1526},{"style":632},[1527],{"type":431,"value":1198},{"type":425,"tag":466,"props":1529,"children":1530},{"style":638},[1531],{"type":431,"value":1203},{"type":425,"tag":466,"props":1533,"children":1534},{"style":632},[1535],{"type":431,"value":635},{"type":425,"tag":466,"props":1537,"children":1538},{"style":530},[1539],{"type":431,"value":1540},")\n",{"type":425,"tag":466,"props":1542,"children":1543},{"class":468,"line":546},[1544,1548],{"type":425,"tag":466,"props":1545,"children":1546},{"style":530},[1547],{"type":431,"value":1188},{"type":425,"tag":466,"props":1549,"children":1550},{"style":494},[1551],{"type":431,"value":1271},{"type":425,"tag":466,"props":1553,"children":1554},{"class":468,"line":568},[1555,1560,1565],{"type":425,"tag":466,"props":1556,"children":1557},{"style":626},[1558],{"type":431,"value":1559},"  ++",{"type":425,"tag":466,"props":1561,"children":1562},{"style":530},[1563],{"type":431,"value":1564},"i",{"type":425,"tag":466,"props":1566,"children":1567},{"style":494},[1568],{"type":431,"value":523},{"type":425,"tag":466,"props":1570,"children":1571},{"class":468,"line":577},[1572],{"type":425,"tag":466,"props":1573,"children":1574},{"style":494},[1575],{"type":431,"value":583},{"type":425,"tag":466,"props":1577,"children":1578},{"class":468,"line":586},[1579,1584,1589,1593],{"type":425,"tag":466,"props":1580,"children":1581},{"style":530},[1582],{"type":431,"value":1583},"i ",{"type":425,"tag":466,"props":1585,"children":1586},{"style":626},[1587],{"type":431,"value":1588},"+=",{"type":425,"tag":466,"props":1590,"children":1591},{"style":515},[1592],{"type":431,"value":561},{"type":425,"tag":466,"props":1594,"children":1595},{"style":494},[1596],{"type":431,"value":523},{"type":425,"tag":466,"props":1598,"children":1599},{"class":468,"line":596},[1600],{"type":425,"tag":466,"props":1601,"children":1602},{"emptyLinePlaceholder":590},[1603],{"type":431,"value":593},{"type":425,"tag":466,"props":1605,"children":1606},{"class":468,"line":605},[1607,1611,1616,1620,1624,1628,1632,1636,1641,1645,1650,1655,1659,1664,1668,1673],{"type":425,"tag":466,"props":1608,"children":1609},{"style":1027},[1610],{"type":431,"value":1356},{"type":425,"tag":466,"props":1612,"children":1613},{"style":530},[1614],{"type":431,"value":1615}," commentText ",{"type":425,"tag":466,"props":1617,"children":1618},{"style":626},[1619],{"type":431,"value":629},{"type":425,"tag":466,"props":1621,"children":1622},{"style":1082},[1623],{"type":431,"value":1217},{"type":425,"tag":466,"props":1625,"children":1626},{"style":494},[1627],{"type":431,"value":486},{"type":425,"tag":466,"props":1629,"children":1630},{"style":530},[1631],{"type":431,"value":1164},{"type":425,"tag":466,"props":1633,"children":1634},{"style":494},[1635],{"type":431,"value":486},{"type":425,"tag":466,"props":1637,"children":1638},{"style":1092},[1639],{"type":431,"value":1640},"slice",{"type":425,"tag":466,"props":1642,"children":1643},{"style":530},[1644],{"type":431,"value":1178},{"type":425,"tag":466,"props":1646,"children":1647},{"style":515},[1648],{"type":431,"value":1649},"2",{"type":425,"tag":466,"props":1651,"children":1652},{"style":494},[1653],{"type":431,"value":1654},",",{"type":425,"tag":466,"props":1656,"children":1657},{"style":530},[1658],{"type":431,"value":1361},{"type":425,"tag":466,"props":1660,"children":1661},{"style":626},[1662],{"type":431,"value":1663},"-",{"type":425,"tag":466,"props":1665,"children":1666},{"style":515},[1667],{"type":431,"value":561},{"type":425,"tag":466,"props":1669,"children":1670},{"style":530},[1671],{"type":431,"value":1672},")",{"type":425,"tag":466,"props":1674,"children":1675},{"style":494},[1676],{"type":431,"value":523},{"type":425,"tag":466,"props":1678,"children":1679},{"class":468,"line":666},[1680],{"type":425,"tag":466,"props":1681,"children":1682},{"style":473},[1683],{"type":431,"value":1684},"/* ... */\n",{"type":425,"tag":466,"props":1686,"children":1687},{"class":468,"line":686},[1688,1692,1696,1701,1705,1709,1713,1717,1721,1725,1730],{"type":425,"tag":466,"props":1689,"children":1690},{"style":1082},[1691],{"type":431,"value":1085},{"type":425,"tag":466,"props":1693,"children":1694},{"style":494},[1695],{"type":431,"value":486},{"type":425,"tag":466,"props":1697,"children":1698},{"style":530},[1699],{"type":431,"value":1700},"cssText ",{"type":425,"tag":466,"props":1702,"children":1703},{"style":626},[1704],{"type":431,"value":629},{"type":425,"tag":466,"props":1706,"children":1707},{"style":1082},[1708],{"type":431,"value":1217},{"type":425,"tag":466,"props":1710,"children":1711},{"style":494},[1712],{"type":431,"value":486},{"type":425,"tag":466,"props":1714,"children":1715},{"style":530},[1716],{"type":431,"value":1164},{"type":425,"tag":466,"props":1718,"children":1719},{"style":494},[1720],{"type":431,"value":486},{"type":425,"tag":466,"props":1722,"children":1723},{"style":1092},[1724],{"type":431,"value":1640},{"type":425,"tag":466,"props":1726,"children":1727},{"style":530},[1728],{"type":431,"value":1729},"(i)",{"type":425,"tag":466,"props":1731,"children":1732},{"style":494},[1733],{"type":431,"value":523},{"type":425,"tag":433,"props":1735,"children":1736},{},[1737,1739,1745,1747,1752,1754,1760],{"type":431,"value":1738},"注释的正文结果保存在了变量 ",{"type":425,"tag":462,"props":1740,"children":1742},{"className":1741},[],[1743],{"type":431,"value":1744},"commentText",{"type":431,"value":1746}," 中，这样可以判断 ",{"type":425,"tag":462,"props":1748,"children":1750},{"className":1749},[],[1751],{"type":431,"value":1744},{"type":431,"value":1753}," 的内容来实现通过注释禁用某个选择器、禁用某行的样式隔离之类的功能。比如想让 ",{"type":425,"tag":462,"props":1755,"children":1757},{"className":1756},[],[1758],{"type":431,"value":1759},".test2",{"type":431,"value":1761}," 选择器不被 scoped 规则覆盖，我们可以在业务代码中这样写。",{"type":425,"tag":455,"props":1763,"children":1765},{"className":457,"code":1764,"language":459,"meta":419,"style":419},"/*! scopecss-disable-next-line */\n.test2 {\n  background: url(/test.png);\n}\n",[1766],{"type":425,"tag":462,"props":1767,"children":1768},{"__ignoreMap":419},[1769,1777,1793,1826],{"type":425,"tag":466,"props":1770,"children":1771},{"class":468,"line":469},[1772],{"type":425,"tag":466,"props":1773,"children":1774},{"style":473},[1775],{"type":431,"value":1776},"/*! scopecss-disable-next-line */\n",{"type":425,"tag":466,"props":1778,"children":1779},{"class":468,"line":479},[1780,1784,1789],{"type":425,"tag":466,"props":1781,"children":1782},{"style":483},[1783],{"type":431,"value":486},{"type":425,"tag":466,"props":1785,"children":1786},{"style":489},[1787],{"type":431,"value":1788},"test2",{"type":425,"tag":466,"props":1790,"children":1791},{"style":494},[1792],{"type":431,"value":497},{"type":425,"tag":466,"props":1794,"children":1795},{"class":468,"line":500},[1796,1801,1805,1811,1815,1821],{"type":425,"tag":466,"props":1797,"children":1798},{"style":504},[1799],{"type":431,"value":1800},"  background",{"type":425,"tag":466,"props":1802,"children":1803},{"style":494},[1804],{"type":431,"value":512},{"type":425,"tag":466,"props":1806,"children":1808},{"style":1807},"--shiki-light:#6182B8;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF",[1809],{"type":431,"value":1810}," url",{"type":425,"tag":466,"props":1812,"children":1813},{"style":494},[1814],{"type":431,"value":1178},{"type":425,"tag":466,"props":1816,"children":1818},{"style":1817},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[1819],{"type":431,"value":1820},"/test.png",{"type":425,"tag":466,"props":1822,"children":1823},{"style":494},[1824],{"type":431,"value":1825},");\n",{"type":425,"tag":466,"props":1827,"children":1828},{"class":468,"line":526},[1829],{"type":425,"tag":466,"props":1830,"children":1831},{"style":494},[1832],{"type":431,"value":583},{"type":425,"tag":980,"props":1834,"children":1836},{"id":1835},"输入输出",[1837],{"type":431,"value":1835},{"type":425,"tag":433,"props":1839,"children":1840},{},[1841,1843,1848,1850,1856],{"type":431,"value":1842},"“解析注释”中“解析”实际指对输入的 CSS 源文件待处理部分以及处理好的输出部分做出改变。这里引申出解析器里两个关键状态，",{"type":425,"tag":462,"props":1844,"children":1846},{"className":1845},[],[1847],{"type":431,"value":1164},{"type":431,"value":1849}," 和 ",{"type":425,"tag":462,"props":1851,"children":1853},{"className":1852},[],[1854],{"type":431,"value":1855},"result",{"type":431,"value":1857},"，分别代表待解析的内容和最终输出结果。",{"type":425,"tag":433,"props":1859,"children":1860},{},[1861,1866,1868,1873,1875,1881],{"type":425,"tag":462,"props":1862,"children":1864},{"className":1863},[],[1865],{"type":431,"value":1164},{"type":431,"value":1867}," 随着循环应当逐渐减小直到为空，此时代表解析完成。",{"type":425,"tag":462,"props":1869,"children":1871},{"className":1870},[],[1872],{"type":431,"value":1855},{"type":431,"value":1874}," 能被内部方法 ",{"type":425,"tag":462,"props":1876,"children":1878},{"className":1877},[],[1879],{"type":431,"value":1880},"recordResult",{"type":431,"value":1882}," 改变，比如如果要把注释的正文内容记录到输出结果，可以这样使用：",{"type":425,"tag":455,"props":1884,"children":1886},{"className":1015,"code":1885,"language":1017,"meta":419,"style":419},"this.recordResult(`/*${commentText}*/`);\n// 相当于：this.result += `/*${commentText}*/`\n",[1887],{"type":425,"tag":462,"props":1888,"children":1889},{"__ignoreMap":419},[1890,1951],{"type":425,"tag":466,"props":1891,"children":1892},{"class":468,"line":469},[1893,1897,1901,1905,1909,1914,1919,1925,1929,1934,1939,1943,1947],{"type":425,"tag":466,"props":1894,"children":1895},{"style":1082},[1896],{"type":431,"value":1085},{"type":425,"tag":466,"props":1898,"children":1899},{"style":494},[1900],{"type":431,"value":486},{"type":425,"tag":466,"props":1902,"children":1903},{"style":1092},[1904],{"type":431,"value":1880},{"type":425,"tag":466,"props":1906,"children":1907},{"style":530},[1908],{"type":431,"value":1178},{"type":425,"tag":466,"props":1910,"children":1911},{"style":632},[1912],{"type":431,"value":1913},"`",{"type":425,"tag":466,"props":1915,"children":1916},{"style":638},[1917],{"type":431,"value":1918},"/*",{"type":425,"tag":466,"props":1920,"children":1922},{"style":1921},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#F92672",[1923],{"type":431,"value":1924},"${",{"type":425,"tag":466,"props":1926,"children":1927},{"style":530},[1928],{"type":431,"value":1744},{"type":425,"tag":466,"props":1930,"children":1931},{"style":1921},[1932],{"type":431,"value":1933},"}",{"type":425,"tag":466,"props":1935,"children":1936},{"style":638},[1937],{"type":431,"value":1938},"*/",{"type":425,"tag":466,"props":1940,"children":1941},{"style":632},[1942],{"type":431,"value":1913},{"type":425,"tag":466,"props":1944,"children":1945},{"style":530},[1946],{"type":431,"value":1672},{"type":425,"tag":466,"props":1948,"children":1949},{"style":494},[1950],{"type":431,"value":523},{"type":425,"tag":466,"props":1952,"children":1953},{"class":468,"line":479},[1954],{"type":425,"tag":466,"props":1955,"children":1956},{"style":473},[1957],{"type":431,"value":1958},"// 相当于：this.result += `/*${commentText}*/`\n",{"type":425,"tag":980,"props":1960,"children":1962},{"id":1961},"解析规则集",[1963],{"type":431,"value":1961},{"type":425,"tag":433,"props":1965,"children":1966},{},[1967],{"type":431,"value":1968},"规则集的解析是整个解析的核心过程。原理与解析注释类似，也是一个 while 循环。每一轮循环都会尝试匹配一条规则，并且将多余的注释和空白字符匹配出来。",{"type":425,"tag":455,"props":1970,"children":1972},{"className":1015,"code":1971,"language":1017,"meta":419,"style":419},"private matchRules (): void {\n  this.matchLeadingSpaces()\n  this.matchComments()\n  while (\n    this.cssText.length &&\n    this.cssText.charAt(0) !== '}' &&\n    (this.matchAtRule() || this.matchStyleRule())\n  ) {\n    this.matchComments()\n    this.matchLeadingSpaces()\n  }\n}\n",[1973],{"type":425,"tag":462,"props":1974,"children":1975},{"__ignoreMap":419},[1976,2003,2024,2044,2056,2085,2142,2191,2203,2222,2241,2248],{"type":425,"tag":466,"props":1977,"children":1978},{"class":468,"line":469},[1979,1984,1989,1994,1999],{"type":425,"tag":466,"props":1980,"children":1981},{"style":530},[1982],{"type":431,"value":1983},"private ",{"type":425,"tag":466,"props":1985,"children":1986},{"style":1092},[1987],{"type":431,"value":1988},"matchRules",{"type":425,"tag":466,"props":1990,"children":1991},{"style":530},[1992],{"type":431,"value":1993}," (): ",{"type":425,"tag":466,"props":1995,"children":1996},{"style":626},[1997],{"type":431,"value":1998},"void",{"type":425,"tag":466,"props":2000,"children":2001},{"style":494},[2002],{"type":431,"value":497},{"type":425,"tag":466,"props":2004,"children":2005},{"class":468,"line":479},[2006,2010,2014,2019],{"type":425,"tag":466,"props":2007,"children":2008},{"style":1082},[2009],{"type":431,"value":1394},{"type":425,"tag":466,"props":2011,"children":2012},{"style":494},[2013],{"type":431,"value":486},{"type":425,"tag":466,"props":2015,"children":2016},{"style":1092},[2017],{"type":431,"value":2018},"matchLeadingSpaces",{"type":425,"tag":466,"props":2020,"children":2021},{"style":1076},[2022],{"type":431,"value":2023},"()\n",{"type":425,"tag":466,"props":2025,"children":2026},{"class":468,"line":500},[2027,2031,2035,2040],{"type":425,"tag":466,"props":2028,"children":2029},{"style":1082},[2030],{"type":431,"value":1394},{"type":425,"tag":466,"props":2032,"children":2033},{"style":494},[2034],{"type":431,"value":486},{"type":425,"tag":466,"props":2036,"children":2037},{"style":1092},[2038],{"type":431,"value":2039},"matchComments",{"type":425,"tag":466,"props":2041,"children":2042},{"style":1076},[2043],{"type":431,"value":2023},{"type":425,"tag":466,"props":2045,"children":2046},{"class":468,"line":526},[2047,2052],{"type":425,"tag":466,"props":2048,"children":2049},{"style":1070},[2050],{"type":431,"value":2051},"  while",{"type":425,"tag":466,"props":2053,"children":2054},{"style":1076},[2055],{"type":431,"value":1386},{"type":425,"tag":466,"props":2057,"children":2058},{"class":468,"line":546},[2059,2064,2068,2072,2076,2081],{"type":425,"tag":466,"props":2060,"children":2061},{"style":1082},[2062],{"type":431,"value":2063},"    this",{"type":425,"tag":466,"props":2065,"children":2066},{"style":494},[2067],{"type":431,"value":486},{"type":425,"tag":466,"props":2069,"children":2070},{"style":530},[2071],{"type":431,"value":1164},{"type":425,"tag":466,"props":2073,"children":2074},{"style":494},[2075],{"type":431,"value":486},{"type":425,"tag":466,"props":2077,"children":2078},{"style":536},[2079],{"type":431,"value":2080},"length",{"type":425,"tag":466,"props":2082,"children":2083},{"style":626},[2084],{"type":431,"value":1429},{"type":425,"tag":466,"props":2086,"children":2087},{"class":468,"line":568},[2088,2092,2096,2100,2104,2108,2112,2116,2120,2124,2129,2133,2138],{"type":425,"tag":466,"props":2089,"children":2090},{"style":1082},[2091],{"type":431,"value":2063},{"type":425,"tag":466,"props":2093,"children":2094},{"style":494},[2095],{"type":431,"value":486},{"type":425,"tag":466,"props":2097,"children":2098},{"style":530},[2099],{"type":431,"value":1164},{"type":425,"tag":466,"props":2101,"children":2102},{"style":494},[2103],{"type":431,"value":486},{"type":425,"tag":466,"props":2105,"children":2106},{"style":1092},[2107],{"type":431,"value":1173},{"type":425,"tag":466,"props":2109,"children":2110},{"style":1076},[2111],{"type":431,"value":1178},{"type":425,"tag":466,"props":2113,"children":2114},{"style":515},[2115],{"type":431,"value":1183},{"type":425,"tag":466,"props":2117,"children":2118},{"style":1076},[2119],{"type":431,"value":1188},{"type":425,"tag":466,"props":2121,"children":2122},{"style":626},[2123],{"type":431,"value":1193},{"type":425,"tag":466,"props":2125,"children":2126},{"style":632},[2127],{"type":431,"value":2128}," '",{"type":425,"tag":466,"props":2130,"children":2131},{"style":638},[2132],{"type":431,"value":1933},{"type":425,"tag":466,"props":2134,"children":2135},{"style":632},[2136],{"type":431,"value":2137},"'",{"type":425,"tag":466,"props":2139,"children":2140},{"style":626},[2141],{"type":431,"value":1429},{"type":425,"tag":466,"props":2143,"children":2144},{"class":468,"line":577},[2145,2150,2154,2158,2163,2168,2173,2177,2181,2186],{"type":425,"tag":466,"props":2146,"children":2147},{"style":1076},[2148],{"type":431,"value":2149},"    (",{"type":425,"tag":466,"props":2151,"children":2152},{"style":1082},[2153],{"type":431,"value":1085},{"type":425,"tag":466,"props":2155,"children":2156},{"style":494},[2157],{"type":431,"value":486},{"type":425,"tag":466,"props":2159,"children":2160},{"style":1092},[2161],{"type":431,"value":2162},"matchAtRule",{"type":425,"tag":466,"props":2164,"children":2165},{"style":1076},[2166],{"type":431,"value":2167},"() ",{"type":425,"tag":466,"props":2169,"children":2170},{"style":626},[2171],{"type":431,"value":2172},"||",{"type":425,"tag":466,"props":2174,"children":2175},{"style":1082},[2176],{"type":431,"value":1217},{"type":425,"tag":466,"props":2178,"children":2179},{"style":494},[2180],{"type":431,"value":486},{"type":425,"tag":466,"props":2182,"children":2183},{"style":1092},[2184],{"type":431,"value":2185},"matchStyleRule",{"type":425,"tag":466,"props":2187,"children":2188},{"style":1076},[2189],{"type":431,"value":2190},"())\n",{"type":425,"tag":466,"props":2192,"children":2193},{"class":468,"line":586},[2194,2199],{"type":425,"tag":466,"props":2195,"children":2196},{"style":1076},[2197],{"type":431,"value":2198},"  ) ",{"type":425,"tag":466,"props":2200,"children":2201},{"style":494},[2202],{"type":431,"value":1271},{"type":425,"tag":466,"props":2204,"children":2205},{"class":468,"line":596},[2206,2210,2214,2218],{"type":425,"tag":466,"props":2207,"children":2208},{"style":1082},[2209],{"type":431,"value":2063},{"type":425,"tag":466,"props":2211,"children":2212},{"style":494},[2213],{"type":431,"value":486},{"type":425,"tag":466,"props":2215,"children":2216},{"style":1092},[2217],{"type":431,"value":2039},{"type":425,"tag":466,"props":2219,"children":2220},{"style":1076},[2221],{"type":431,"value":2023},{"type":425,"tag":466,"props":2223,"children":2224},{"class":468,"line":605},[2225,2229,2233,2237],{"type":425,"tag":466,"props":2226,"children":2227},{"style":1082},[2228],{"type":431,"value":2063},{"type":425,"tag":466,"props":2230,"children":2231},{"style":494},[2232],{"type":431,"value":486},{"type":425,"tag":466,"props":2234,"children":2235},{"style":1092},[2236],{"type":431,"value":2018},{"type":425,"tag":466,"props":2238,"children":2239},{"style":1076},[2240],{"type":431,"value":2023},{"type":425,"tag":466,"props":2242,"children":2243},{"class":468,"line":666},[2244],{"type":425,"tag":466,"props":2245,"children":2246},{"style":494},[2247],{"type":431,"value":574},{"type":425,"tag":466,"props":2249,"children":2250},{"class":468,"line":686},[2251],{"type":425,"tag":466,"props":2252,"children":2253},{"style":494},[2254],{"type":431,"value":583},{"type":425,"tag":433,"props":2256,"children":2257},{},[2258,2260,2265],{"type":431,"value":2259},"匹配注释我们知道它是使用了下标递增 + Slice 的方法，匹配空白这里则是用的一个非常简单的正则。见下 ",{"type":425,"tag":462,"props":2261,"children":2263},{"className":2262},[],[2264],{"type":431,"value":2018},{"type":431,"value":2266}," 函数。",{"type":425,"tag":455,"props":2268,"children":2270},{"className":1015,"code":2269,"language":1017,"meta":419,"style":419},"private matchLeadingSpaces (): void {\n  this.commonMatch(/^\\s*/, false)\n}\n",[2271],{"type":425,"tag":462,"props":2272,"children":2273},{"__ignoreMap":419},[2274,2297,2352],{"type":425,"tag":466,"props":2275,"children":2276},{"class":468,"line":469},[2277,2281,2285,2289,2293],{"type":425,"tag":466,"props":2278,"children":2279},{"style":530},[2280],{"type":431,"value":1983},{"type":425,"tag":466,"props":2282,"children":2283},{"style":1092},[2284],{"type":431,"value":2018},{"type":425,"tag":466,"props":2286,"children":2287},{"style":530},[2288],{"type":431,"value":1993},{"type":425,"tag":466,"props":2290,"children":2291},{"style":626},[2292],{"type":431,"value":1998},{"type":425,"tag":466,"props":2294,"children":2295},{"style":494},[2296],{"type":431,"value":497},{"type":425,"tag":466,"props":2298,"children":2299},{"class":468,"line":479},[2300,2304,2308,2313,2317,2321,2326,2332,2336,2340,2344,2348],{"type":425,"tag":466,"props":2301,"children":2302},{"style":1082},[2303],{"type":431,"value":1394},{"type":425,"tag":466,"props":2305,"children":2306},{"style":494},[2307],{"type":431,"value":486},{"type":425,"tag":466,"props":2309,"children":2310},{"style":1092},[2311],{"type":431,"value":2312},"commonMatch",{"type":425,"tag":466,"props":2314,"children":2315},{"style":1076},[2316],{"type":431,"value":1178},{"type":425,"tag":466,"props":2318,"children":2319},{"style":632},[2320],{"type":431,"value":1203},{"type":425,"tag":466,"props":2322,"children":2323},{"style":1070},[2324],{"type":431,"value":2325},"^",{"type":425,"tag":466,"props":2327,"children":2329},{"style":2328},"--shiki-light:#91B859;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2330],{"type":431,"value":2331},"\\s",{"type":425,"tag":466,"props":2333,"children":2334},{"style":626},[2335],{"type":431,"value":1258},{"type":425,"tag":466,"props":2337,"children":2338},{"style":632},[2339],{"type":431,"value":1203},{"type":425,"tag":466,"props":2341,"children":2342},{"style":494},[2343],{"type":431,"value":1654},{"type":425,"tag":466,"props":2345,"children":2346},{"style":1282},[2347],{"type":431,"value":1285},{"type":425,"tag":466,"props":2349,"children":2350},{"style":1076},[2351],{"type":431,"value":1540},{"type":425,"tag":466,"props":2353,"children":2354},{"class":468,"line":500},[2355],{"type":425,"tag":466,"props":2356,"children":2357},{"style":494},[2358],{"type":431,"value":583},{"type":425,"tag":433,"props":2360,"children":2361},{},[2362,2364,2369,2371,2376,2377,2382,2384,2389,2391,2396],{"type":431,"value":2363},"可以想象，",{"type":425,"tag":462,"props":2365,"children":2367},{"className":2366},[],[2368],{"type":431,"value":2312},{"type":431,"value":2370}," 应当会对状态 ",{"type":425,"tag":462,"props":2372,"children":2374},{"className":2373},[],[2375],{"type":431,"value":1164},{"type":431,"value":1849},{"type":425,"tag":462,"props":2378,"children":2380},{"className":2379},[],[2381],{"type":431,"value":1855},{"type":431,"value":2383}," 做一些操作。实际上，commonMatch 两个参数分别是用于匹配 ",{"type":425,"tag":462,"props":2385,"children":2387},{"className":2386},[],[2388],{"type":431,"value":1164},{"type":431,"value":2390}," 的正则，及跳过标记。如果在待匹配内容中匹配到了字符串，便把匹配的内容从中移除；跳过标记则意味着当确认跳过时，匹配的内容将不会被记录到输出结果中。以上面的 ",{"type":425,"tag":462,"props":2392,"children":2394},{"className":2393},[],[2395],{"type":431,"value":2018},{"type":431,"value":2397}," 函数举例，如果在待匹配内容中匹配到空白字符，那么会将其丢弃不做处理。",{"type":425,"tag":433,"props":2399,"children":2400},{},[2401,2406,2408,2413],{"type":425,"tag":462,"props":2402,"children":2404},{"className":2403},[],[2405],{"type":431,"value":2312},{"type":431,"value":2407}," 可谓是解析器匹配逻辑的核心，只要理解了它，那么我们回到上面提到的样式规则匹配 ",{"type":425,"tag":462,"props":2409,"children":2411},{"className":2410},[],[2412],{"type":431,"value":2185},{"type":431,"value":2414},"，会发现其过程非常简单。简单来说只有三步，匹配选择器、记录解析后的选择器、解析（并记录）声明。结束条件只有成功解析以及选择器解析报错或声明解析报错。",{"type":425,"tag":455,"props":2416,"children":2418},{"className":1015,"code":2417,"language":1017,"meta":419,"style":419},"private matchStyleRule (): boolean | void {\n  const selectors = this.formatSelector(true)\n  this.scopecssDisableNextLine = false\n  if (!selectors) return parseError('selector missing', this.linkPath)\n  this.recordResult(selectors)\n  this.matchComments()\n  this.styleDeclarations()\n  this.matchLeadingSpaces()\n  return true\n}\n",[2419],{"type":425,"tag":462,"props":2420,"children":2421},{"__ignoreMap":419},[2422,2452,2496,2521,2595,2622,2641,2661,2680,2693],{"type":425,"tag":466,"props":2423,"children":2424},{"class":468,"line":469},[2425,2429,2433,2438,2443,2448],{"type":425,"tag":466,"props":2426,"children":2427},{"style":530},[2428],{"type":431,"value":1983},{"type":425,"tag":466,"props":2430,"children":2431},{"style":1092},[2432],{"type":431,"value":2185},{"type":425,"tag":466,"props":2434,"children":2435},{"style":530},[2436],{"type":431,"value":2437}," (): boolean ",{"type":425,"tag":466,"props":2439,"children":2440},{"style":626},[2441],{"type":431,"value":2442},"|",{"type":425,"tag":466,"props":2444,"children":2445},{"style":626},[2446],{"type":431,"value":2447}," void",{"type":425,"tag":466,"props":2449,"children":2450},{"style":494},[2451],{"type":431,"value":497},{"type":425,"tag":466,"props":2453,"children":2454},{"class":468,"line":479},[2455,2460,2465,2470,2474,2478,2483,2487,2492],{"type":425,"tag":466,"props":2456,"children":2457},{"style":1027},[2458],{"type":431,"value":2459},"  const",{"type":425,"tag":466,"props":2461,"children":2462},{"style":536},[2463],{"type":431,"value":2464}," selectors",{"type":425,"tag":466,"props":2466,"children":2467},{"style":626},[2468],{"type":431,"value":2469}," =",{"type":425,"tag":466,"props":2471,"children":2472},{"style":1082},[2473],{"type":431,"value":1217},{"type":425,"tag":466,"props":2475,"children":2476},{"style":494},[2477],{"type":431,"value":486},{"type":425,"tag":466,"props":2479,"children":2480},{"style":1092},[2481],{"type":431,"value":2482},"formatSelector",{"type":425,"tag":466,"props":2484,"children":2485},{"style":1076},[2486],{"type":431,"value":1178},{"type":425,"tag":466,"props":2488,"children":2489},{"style":1282},[2490],{"type":431,"value":2491},"true",{"type":425,"tag":466,"props":2493,"children":2494},{"style":1076},[2495],{"type":431,"value":1540},{"type":425,"tag":466,"props":2497,"children":2498},{"class":468,"line":500},[2499,2503,2507,2512,2516],{"type":425,"tag":466,"props":2500,"children":2501},{"style":1082},[2502],{"type":431,"value":1394},{"type":425,"tag":466,"props":2504,"children":2505},{"style":494},[2506],{"type":431,"value":486},{"type":425,"tag":466,"props":2508,"children":2509},{"style":530},[2510],{"type":431,"value":2511},"scopecssDisableNextLine",{"type":425,"tag":466,"props":2513,"children":2514},{"style":626},[2515],{"type":431,"value":2469},{"type":425,"tag":466,"props":2517,"children":2518},{"style":1282},[2519],{"type":431,"value":2520}," false\n",{"type":425,"tag":466,"props":2522,"children":2523},{"class":468,"line":526},[2524,2529,2533,2538,2543,2547,2552,2557,2561,2565,2570,2574,2578,2582,2586,2591],{"type":425,"tag":466,"props":2525,"children":2526},{"style":1070},[2527],{"type":431,"value":2528},"  if",{"type":425,"tag":466,"props":2530,"children":2531},{"style":1076},[2532],{"type":431,"value":1079},{"type":425,"tag":466,"props":2534,"children":2535},{"style":626},[2536],{"type":431,"value":2537},"!",{"type":425,"tag":466,"props":2539,"children":2540},{"style":530},[2541],{"type":431,"value":2542},"selectors",{"type":425,"tag":466,"props":2544,"children":2545},{"style":1076},[2546],{"type":431,"value":1188},{"type":425,"tag":466,"props":2548,"children":2549},{"style":1070},[2550],{"type":431,"value":2551},"return",{"type":425,"tag":466,"props":2553,"children":2554},{"style":1092},[2555],{"type":431,"value":2556}," parseError",{"type":425,"tag":466,"props":2558,"children":2559},{"style":1076},[2560],{"type":431,"value":1178},{"type":425,"tag":466,"props":2562,"children":2563},{"style":632},[2564],{"type":431,"value":2137},{"type":425,"tag":466,"props":2566,"children":2567},{"style":638},[2568],{"type":431,"value":2569},"selector missing",{"type":425,"tag":466,"props":2571,"children":2572},{"style":632},[2573],{"type":431,"value":2137},{"type":425,"tag":466,"props":2575,"children":2576},{"style":494},[2577],{"type":431,"value":1654},{"type":425,"tag":466,"props":2579,"children":2580},{"style":1082},[2581],{"type":431,"value":1217},{"type":425,"tag":466,"props":2583,"children":2584},{"style":494},[2585],{"type":431,"value":486},{"type":425,"tag":466,"props":2587,"children":2588},{"style":530},[2589],{"type":431,"value":2590},"linkPath",{"type":425,"tag":466,"props":2592,"children":2593},{"style":1076},[2594],{"type":431,"value":1540},{"type":425,"tag":466,"props":2596,"children":2597},{"class":468,"line":546},[2598,2602,2606,2610,2614,2618],{"type":425,"tag":466,"props":2599,"children":2600},{"style":1082},[2601],{"type":431,"value":1394},{"type":425,"tag":466,"props":2603,"children":2604},{"style":494},[2605],{"type":431,"value":486},{"type":425,"tag":466,"props":2607,"children":2608},{"style":1092},[2609],{"type":431,"value":1880},{"type":425,"tag":466,"props":2611,"children":2612},{"style":1076},[2613],{"type":431,"value":1178},{"type":425,"tag":466,"props":2615,"children":2616},{"style":530},[2617],{"type":431,"value":2542},{"type":425,"tag":466,"props":2619,"children":2620},{"style":1076},[2621],{"type":431,"value":1540},{"type":425,"tag":466,"props":2623,"children":2624},{"class":468,"line":568},[2625,2629,2633,2637],{"type":425,"tag":466,"props":2626,"children":2627},{"style":1082},[2628],{"type":431,"value":1394},{"type":425,"tag":466,"props":2630,"children":2631},{"style":494},[2632],{"type":431,"value":486},{"type":425,"tag":466,"props":2634,"children":2635},{"style":1092},[2636],{"type":431,"value":2039},{"type":425,"tag":466,"props":2638,"children":2639},{"style":1076},[2640],{"type":431,"value":2023},{"type":425,"tag":466,"props":2642,"children":2643},{"class":468,"line":577},[2644,2648,2652,2657],{"type":425,"tag":466,"props":2645,"children":2646},{"style":1082},[2647],{"type":431,"value":1394},{"type":425,"tag":466,"props":2649,"children":2650},{"style":494},[2651],{"type":431,"value":486},{"type":425,"tag":466,"props":2653,"children":2654},{"style":1092},[2655],{"type":431,"value":2656},"styleDeclarations",{"type":425,"tag":466,"props":2658,"children":2659},{"style":1076},[2660],{"type":431,"value":2023},{"type":425,"tag":466,"props":2662,"children":2663},{"class":468,"line":586},[2664,2668,2672,2676],{"type":425,"tag":466,"props":2665,"children":2666},{"style":1082},[2667],{"type":431,"value":1394},{"type":425,"tag":466,"props":2669,"children":2670},{"style":494},[2671],{"type":431,"value":486},{"type":425,"tag":466,"props":2673,"children":2674},{"style":1092},[2675],{"type":431,"value":2018},{"type":425,"tag":466,"props":2677,"children":2678},{"style":1076},[2679],{"type":431,"value":2023},{"type":425,"tag":466,"props":2681,"children":2682},{"class":468,"line":596},[2683,2688],{"type":425,"tag":466,"props":2684,"children":2685},{"style":1070},[2686],{"type":431,"value":2687},"  return",{"type":425,"tag":466,"props":2689,"children":2690},{"style":1282},[2691],{"type":431,"value":2692}," true\n",{"type":425,"tag":466,"props":2694,"children":2695},{"class":468,"line":605},[2696],{"type":425,"tag":466,"props":2697,"children":2698},{"style":494},[2699],{"type":431,"value":583},{"type":425,"tag":433,"props":2701,"children":2702},{},[2703,2705,2711,2713,2719,2721,2727,2729,2734,2736,2742],{"type":431,"value":2704},"首先是匹配选择器的部分。以 ",{"type":425,"tag":462,"props":2706,"children":2708},{"className":2707},[],[2709],{"type":431,"value":2710},".a,.b{color:red}",{"type":431,"value":2712}," 为例，首先匹配出",{"type":425,"tag":462,"props":2714,"children":2716},{"className":2715},[],[2717],{"type":431,"value":2718},"{",{"type":431,"value":2720},"字符前的部分即",{"type":425,"tag":462,"props":2722,"children":2724},{"className":2723},[],[2725],{"type":431,"value":2726},".a,.b",{"type":431,"value":2728},"作为选择器的正文，然后使用",{"type":425,"tag":462,"props":2730,"children":2732},{"className":2731},[],[2733],{"type":431,"value":1654},{"type":431,"value":2735},"分割选择器，并给选择器加上 prefix，最终返回",{"type":425,"tag":462,"props":2737,"children":2739},{"className":2738},[],[2740],{"type":431,"value":2741},"micro-app[name=\"subapp\"] .a, micro-app[name=\"subapp\"] .b",{"type":431,"value":2743},"。刚才提到可以在业务代码中使用注释给特定选择器禁用 prefix 前缀，相关的代码的实现也在这个函数中。",{"type":425,"tag":455,"props":2745,"children":2747},{"className":1015,"code":2746,"language":1017,"meta":419,"style":419},"const selectors = this.formatSelector()\n\nprivate formatSelector (skip: boolean): false | string {\n  // 匹配选择器正文\n  const m = this.commonMatch(/^[^{]+/, skip)\n  return m[0].replace(/(^|,[\\n\\s]*)([^,]+)/g, (_, separator, selector) => {\n    // 如果检测到选择器被禁用则跳过添加前缀步骤\n    if (...) {\n      const prefix = this.prefix // micro-app[name=\"subapp\"]\n      selector = prefix + ' ' + selector\n    }\n    return separator + selector\n  })\n}\n",[2748],{"type":425,"tag":462,"props":2749,"children":2750},{"__ignoreMap":419},[2751,2783,2790,2825,2833,2911,3069,3077,3101,3136,3174,3181,3200,3211],{"type":425,"tag":466,"props":2752,"children":2753},{"class":468,"line":469},[2754,2759,2763,2767,2771,2775,2779],{"type":425,"tag":466,"props":2755,"children":2756},{"style":1027},[2757],{"type":431,"value":2758},"const",{"type":425,"tag":466,"props":2760,"children":2761},{"style":536},[2762],{"type":431,"value":2464},{"type":425,"tag":466,"props":2764,"children":2765},{"style":626},[2766],{"type":431,"value":2469},{"type":425,"tag":466,"props":2768,"children":2769},{"style":1082},[2770],{"type":431,"value":1217},{"type":425,"tag":466,"props":2772,"children":2773},{"style":494},[2774],{"type":431,"value":486},{"type":425,"tag":466,"props":2776,"children":2777},{"style":1092},[2778],{"type":431,"value":2482},{"type":425,"tag":466,"props":2780,"children":2781},{"style":530},[2782],{"type":431,"value":2023},{"type":425,"tag":466,"props":2784,"children":2785},{"class":468,"line":479},[2786],{"type":425,"tag":466,"props":2787,"children":2788},{"emptyLinePlaceholder":590},[2789],{"type":431,"value":593},{"type":425,"tag":466,"props":2791,"children":2792},{"class":468,"line":500},[2793,2797,2801,2806,2811,2816,2821],{"type":425,"tag":466,"props":2794,"children":2795},{"style":530},[2796],{"type":431,"value":1983},{"type":425,"tag":466,"props":2798,"children":2799},{"style":1092},[2800],{"type":431,"value":2482},{"type":425,"tag":466,"props":2802,"children":2803},{"style":530},[2804],{"type":431,"value":2805}," (skip: boolean): ",{"type":425,"tag":466,"props":2807,"children":2808},{"style":1282},[2809],{"type":431,"value":2810},"false",{"type":425,"tag":466,"props":2812,"children":2813},{"style":626},[2814],{"type":431,"value":2815}," |",{"type":425,"tag":466,"props":2817,"children":2818},{"style":530},[2819],{"type":431,"value":2820}," string ",{"type":425,"tag":466,"props":2822,"children":2823},{"style":494},[2824],{"type":431,"value":1271},{"type":425,"tag":466,"props":2826,"children":2827},{"class":468,"line":526},[2828],{"type":425,"tag":466,"props":2829,"children":2830},{"style":473},[2831],{"type":431,"value":2832},"  // 匹配选择器正文\n",{"type":425,"tag":466,"props":2834,"children":2835},{"class":468,"line":546},[2836,2840,2845,2849,2853,2857,2861,2865,2869,2873,2878,2882,2886,2890,2894,2898,2902,2907],{"type":425,"tag":466,"props":2837,"children":2838},{"style":1027},[2839],{"type":431,"value":2459},{"type":425,"tag":466,"props":2841,"children":2842},{"style":536},[2843],{"type":431,"value":2844}," m",{"type":425,"tag":466,"props":2846,"children":2847},{"style":626},[2848],{"type":431,"value":2469},{"type":425,"tag":466,"props":2850,"children":2851},{"style":1082},[2852],{"type":431,"value":1217},{"type":425,"tag":466,"props":2854,"children":2855},{"style":494},[2856],{"type":431,"value":486},{"type":425,"tag":466,"props":2858,"children":2859},{"style":1092},[2860],{"type":431,"value":2312},{"type":425,"tag":466,"props":2862,"children":2863},{"style":1076},[2864],{"type":431,"value":1178},{"type":425,"tag":466,"props":2866,"children":2867},{"style":632},[2868],{"type":431,"value":1203},{"type":425,"tag":466,"props":2870,"children":2871},{"style":1070},[2872],{"type":431,"value":2325},{"type":425,"tag":466,"props":2874,"children":2876},{"style":2875},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2877],{"type":431,"value":617},{"type":425,"tag":466,"props":2879,"children":2880},{"style":626},[2881],{"type":431,"value":2325},{"type":425,"tag":466,"props":2883,"children":2884},{"style":2328},[2885],{"type":431,"value":2718},{"type":425,"tag":466,"props":2887,"children":2888},{"style":2875},[2889],{"type":431,"value":650},{"type":425,"tag":466,"props":2891,"children":2892},{"style":626},[2893],{"type":431,"value":1511},{"type":425,"tag":466,"props":2895,"children":2896},{"style":632},[2897],{"type":431,"value":1203},{"type":425,"tag":466,"props":2899,"children":2900},{"style":494},[2901],{"type":431,"value":1654},{"type":425,"tag":466,"props":2903,"children":2904},{"style":530},[2905],{"type":431,"value":2906}," skip",{"type":425,"tag":466,"props":2908,"children":2909},{"style":1076},[2910],{"type":431,"value":1540},{"type":425,"tag":466,"props":2912,"children":2913},{"class":468,"line":568},[2914,2918,2922,2926,2930,2934,2938,2943,2947,2951,2956,2960,2964,2969,2973,2978,2982,2986,2991,2995,2999,3003,3007,3011,3015,3019,3025,3029,3033,3038,3042,3047,3051,3056,3060,3065],{"type":425,"tag":466,"props":2915,"children":2916},{"style":1070},[2917],{"type":431,"value":2687},{"type":425,"tag":466,"props":2919,"children":2920},{"style":530},[2921],{"type":431,"value":2844},{"type":425,"tag":466,"props":2923,"children":2924},{"style":1076},[2925],{"type":431,"value":617},{"type":425,"tag":466,"props":2927,"children":2928},{"style":515},[2929],{"type":431,"value":1183},{"type":425,"tag":466,"props":2931,"children":2932},{"style":1076},[2933],{"type":431,"value":650},{"type":425,"tag":466,"props":2935,"children":2936},{"style":494},[2937],{"type":431,"value":486},{"type":425,"tag":466,"props":2939,"children":2940},{"style":1092},[2941],{"type":431,"value":2942},"replace",{"type":425,"tag":466,"props":2944,"children":2945},{"style":1076},[2946],{"type":431,"value":1178},{"type":425,"tag":466,"props":2948,"children":2949},{"style":632},[2950],{"type":431,"value":1203},{"type":425,"tag":466,"props":2952,"children":2954},{"style":2953},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[2955],{"type":431,"value":1178},{"type":425,"tag":466,"props":2957,"children":2958},{"style":1070},[2959],{"type":431,"value":2325},{"type":425,"tag":466,"props":2961,"children":2962},{"style":626},[2963],{"type":431,"value":2442},{"type":425,"tag":466,"props":2965,"children":2967},{"style":2966},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[2968],{"type":431,"value":1654},{"type":425,"tag":466,"props":2970,"children":2971},{"style":2875},[2972],{"type":431,"value":617},{"type":425,"tag":466,"props":2974,"children":2975},{"style":2328},[2976],{"type":431,"value":2977},"\\n\\s",{"type":425,"tag":466,"props":2979,"children":2980},{"style":2875},[2981],{"type":431,"value":650},{"type":425,"tag":466,"props":2983,"children":2984},{"style":626},[2985],{"type":431,"value":1258},{"type":425,"tag":466,"props":2987,"children":2988},{"style":2953},[2989],{"type":431,"value":2990},")(",{"type":425,"tag":466,"props":2992,"children":2993},{"style":2875},[2994],{"type":431,"value":617},{"type":425,"tag":466,"props":2996,"children":2997},{"style":626},[2998],{"type":431,"value":2325},{"type":425,"tag":466,"props":3000,"children":3001},{"style":2328},[3002],{"type":431,"value":1654},{"type":425,"tag":466,"props":3004,"children":3005},{"style":2875},[3006],{"type":431,"value":650},{"type":425,"tag":466,"props":3008,"children":3009},{"style":626},[3010],{"type":431,"value":1511},{"type":425,"tag":466,"props":3012,"children":3013},{"style":2953},[3014],{"type":431,"value":1672},{"type":425,"tag":466,"props":3016,"children":3017},{"style":632},[3018],{"type":431,"value":1203},{"type":425,"tag":466,"props":3020,"children":3022},{"style":3021},"--shiki-light:#F76D47;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[3023],{"type":431,"value":3024},"g",{"type":425,"tag":466,"props":3026,"children":3027},{"style":494},[3028],{"type":431,"value":1654},{"type":425,"tag":466,"props":3030,"children":3031},{"style":494},[3032],{"type":431,"value":1079},{"type":425,"tag":466,"props":3034,"children":3035},{"style":1817},[3036],{"type":431,"value":3037},"_",{"type":425,"tag":466,"props":3039,"children":3040},{"style":494},[3041],{"type":431,"value":1654},{"type":425,"tag":466,"props":3043,"children":3044},{"style":1817},[3045],{"type":431,"value":3046}," separator",{"type":425,"tag":466,"props":3048,"children":3049},{"style":494},[3050],{"type":431,"value":1654},{"type":425,"tag":466,"props":3052,"children":3053},{"style":1817},[3054],{"type":431,"value":3055}," selector",{"type":425,"tag":466,"props":3057,"children":3058},{"style":494},[3059],{"type":431,"value":1672},{"type":425,"tag":466,"props":3061,"children":3062},{"style":1027},[3063],{"type":431,"value":3064}," =>",{"type":425,"tag":466,"props":3066,"children":3067},{"style":494},[3068],{"type":431,"value":497},{"type":425,"tag":466,"props":3070,"children":3071},{"class":468,"line":577},[3072],{"type":425,"tag":466,"props":3073,"children":3074},{"style":473},[3075],{"type":431,"value":3076},"    // 如果检测到选择器被禁用则跳过添加前缀步骤\n",{"type":425,"tag":466,"props":3078,"children":3079},{"class":468,"line":586},[3080,3084,3088,3093,3097],{"type":425,"tag":466,"props":3081,"children":3082},{"style":1070},[3083],{"type":431,"value":1147},{"type":425,"tag":466,"props":3085,"children":3086},{"style":1076},[3087],{"type":431,"value":1079},{"type":425,"tag":466,"props":3089,"children":3090},{"style":626},[3091],{"type":431,"value":3092},"...",{"type":425,"tag":466,"props":3094,"children":3095},{"style":1076},[3096],{"type":431,"value":1188},{"type":425,"tag":466,"props":3098,"children":3099},{"style":494},[3100],{"type":431,"value":1271},{"type":425,"tag":466,"props":3102,"children":3103},{"class":468,"line":596},[3104,3109,3114,3118,3122,3126,3131],{"type":425,"tag":466,"props":3105,"children":3106},{"style":1027},[3107],{"type":431,"value":3108},"      const",{"type":425,"tag":466,"props":3110,"children":3111},{"style":536},[3112],{"type":431,"value":3113}," prefix",{"type":425,"tag":466,"props":3115,"children":3116},{"style":626},[3117],{"type":431,"value":2469},{"type":425,"tag":466,"props":3119,"children":3120},{"style":1082},[3121],{"type":431,"value":1217},{"type":425,"tag":466,"props":3123,"children":3124},{"style":494},[3125],{"type":431,"value":486},{"type":425,"tag":466,"props":3127,"children":3128},{"style":530},[3129],{"type":431,"value":3130},"prefix",{"type":425,"tag":466,"props":3132,"children":3133},{"style":473},[3134],{"type":431,"value":3135}," // micro-app[name=\"subapp\"]\n",{"type":425,"tag":466,"props":3137,"children":3138},{"class":468,"line":605},[3139,3144,3148,3152,3157,3161,3165,3169],{"type":425,"tag":466,"props":3140,"children":3141},{"style":530},[3142],{"type":431,"value":3143},"      selector",{"type":425,"tag":466,"props":3145,"children":3146},{"style":626},[3147],{"type":431,"value":2469},{"type":425,"tag":466,"props":3149,"children":3150},{"style":530},[3151],{"type":431,"value":3113},{"type":425,"tag":466,"props":3153,"children":3154},{"style":626},[3155],{"type":431,"value":3156}," +",{"type":425,"tag":466,"props":3158,"children":3159},{"style":632},[3160],{"type":431,"value":2128},{"type":425,"tag":466,"props":3162,"children":3163},{"style":632},[3164],{"type":431,"value":2128},{"type":425,"tag":466,"props":3166,"children":3167},{"style":626},[3168],{"type":431,"value":3156},{"type":425,"tag":466,"props":3170,"children":3171},{"style":530},[3172],{"type":431,"value":3173}," selector\n",{"type":425,"tag":466,"props":3175,"children":3176},{"class":468,"line":666},[3177],{"type":425,"tag":466,"props":3178,"children":3179},{"style":494},[3180],{"type":431,"value":1297},{"type":425,"tag":466,"props":3182,"children":3183},{"class":468,"line":686},[3184,3188,3192,3196],{"type":425,"tag":466,"props":3185,"children":3186},{"style":1070},[3187],{"type":431,"value":1313},{"type":425,"tag":466,"props":3189,"children":3190},{"style":530},[3191],{"type":431,"value":3046},{"type":425,"tag":466,"props":3193,"children":3194},{"style":626},[3195],{"type":431,"value":3156},{"type":425,"tag":466,"props":3197,"children":3198},{"style":530},[3199],{"type":431,"value":3173},{"type":425,"tag":466,"props":3201,"children":3202},{"class":468,"line":702},[3203,3207],{"type":425,"tag":466,"props":3204,"children":3205},{"style":494},[3206],{"type":431,"value":865},{"type":425,"tag":466,"props":3208,"children":3209},{"style":1076},[3210],{"type":431,"value":1540},{"type":425,"tag":466,"props":3212,"children":3213},{"class":468,"line":722},[3214],{"type":425,"tag":466,"props":3215,"children":3216},{"style":494},[3217],{"type":431,"value":583},{"type":425,"tag":433,"props":3219,"children":3220},{},[3221,3223,3228,3230,3235,3237,3242,3244,3249,3251,3258],{"type":431,"value":3222},"匹配完选择器后，声明便是剩下的包含在左右花括号的内容。匹配过程是一个递归，以遇到",{"type":425,"tag":462,"props":3224,"children":3226},{"className":3225},[],[3227],{"type":431,"value":1933},{"type":431,"value":3229},"作为结束条件。如果遇到斜杠",{"type":425,"tag":462,"props":3231,"children":3233},{"className":3232},[],[3234],{"type":431,"value":1203},{"type":431,"value":3236},"，则尝试停止声明匹配并开始注释匹配。总之，",{"type":425,"tag":462,"props":3238,"children":3240},{"className":3239},[],[3241],{"type":431,"value":1933},{"type":431,"value":3243},"之前的内容都作为当前选择器的声明，添加到",{"type":425,"tag":462,"props":3245,"children":3247},{"className":3246},[],[3248],{"type":431,"value":1164},{"type":431,"value":3250},"中。micro-app 框架会对 CSS 资源中的 URL 补全为主应用的完整路径这个功能也是在这个函数中实现，有兴趣的话可以查看其",{"type":425,"tag":444,"props":3252,"children":3255},{"href":3253,"rel":3254},"https://github.com/micro-zoe/micro-app/blob/dev/src/sandbox/scoped_css.ts",[448],[3256],{"type":431,"value":3257},"完整代码",{"type":431,"value":951},{"type":425,"tag":455,"props":3260,"children":3262},{"className":1015,"code":3261,"language":1017,"meta":419,"style":419},"private matchAllDeclarations (): void {\n  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n  this.recordResult(cssValue)\n\n  // 递归退出条件\n  if (!this.cssText) return\n  if (this.cssText.charAt(0) === '}') return\n\n  // extract comments in declarations\n  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n    this.matchComments()\n  } else {\n    // 如果不是注释则忽略中断，继续匹配声明\n    this.commonMatch(/\\/+/)\n  }\n\n  return this.matchAllDeclarations()\n}\n",[3263],{"type":425,"tag":462,"props":3264,"children":3265},{"__ignoreMap":419},[3266,3290,3400,3428,3435,3443,3479,3547,3554,3562,3682,3701,3717,3725,3766,3773,3780,3803],{"type":425,"tag":466,"props":3267,"children":3268},{"class":468,"line":469},[3269,3273,3278,3282,3286],{"type":425,"tag":466,"props":3270,"children":3271},{"style":530},[3272],{"type":431,"value":1983},{"type":425,"tag":466,"props":3274,"children":3275},{"style":1092},[3276],{"type":431,"value":3277},"matchAllDeclarations",{"type":425,"tag":466,"props":3279,"children":3280},{"style":530},[3281],{"type":431,"value":1993},{"type":425,"tag":466,"props":3283,"children":3284},{"style":626},[3285],{"type":431,"value":1998},{"type":425,"tag":466,"props":3287,"children":3288},{"style":494},[3289],{"type":431,"value":497},{"type":425,"tag":466,"props":3291,"children":3292},{"class":468,"line":479},[3293,3298,3303,3307,3311,3315,3319,3323,3327,3331,3335,3339,3343,3348,3352,3356,3360,3364,3368,3372,3376,3381,3386,3391,3395],{"type":425,"tag":466,"props":3294,"children":3295},{"style":1027},[3296],{"type":431,"value":3297},"  let",{"type":425,"tag":466,"props":3299,"children":3300},{"style":530},[3301],{"type":431,"value":3302}," cssValue",{"type":425,"tag":466,"props":3304,"children":3305},{"style":626},[3306],{"type":431,"value":2469},{"type":425,"tag":466,"props":3308,"children":3309},{"style":1076},[3310],{"type":431,"value":1079},{"type":425,"tag":466,"props":3312,"children":3313},{"style":1082},[3314],{"type":431,"value":1085},{"type":425,"tag":466,"props":3316,"children":3317},{"style":494},[3318],{"type":431,"value":486},{"type":425,"tag":466,"props":3320,"children":3321},{"style":1092},[3322],{"type":431,"value":2312},{"type":425,"tag":466,"props":3324,"children":3325},{"style":1076},[3326],{"type":431,"value":1178},{"type":425,"tag":466,"props":3328,"children":3329},{"style":632},[3330],{"type":431,"value":1203},{"type":425,"tag":466,"props":3332,"children":3333},{"style":1070},[3334],{"type":431,"value":2325},{"type":425,"tag":466,"props":3336,"children":3337},{"style":2875},[3338],{"type":431,"value":617},{"type":425,"tag":466,"props":3340,"children":3341},{"style":626},[3342],{"type":431,"value":2325},{"type":425,"tag":466,"props":3344,"children":3345},{"style":2328},[3346],{"type":431,"value":3347},"}/",{"type":425,"tag":466,"props":3349,"children":3350},{"style":2875},[3351],{"type":431,"value":650},{"type":425,"tag":466,"props":3353,"children":3354},{"style":2966},[3355],{"type":431,"value":1672},{"type":425,"tag":466,"props":3357,"children":3358},{"style":626},[3359],{"type":431,"value":1258},{"type":425,"tag":466,"props":3361,"children":3362},{"style":632},[3363],{"type":431,"value":1203},{"type":425,"tag":466,"props":3365,"children":3366},{"style":494},[3367],{"type":431,"value":1654},{"type":425,"tag":466,"props":3369,"children":3370},{"style":1282},[3371],{"type":431,"value":1318},{"type":425,"tag":466,"props":3373,"children":3374},{"style":1076},[3375],{"type":431,"value":1188},{"type":425,"tag":466,"props":3377,"children":3378},{"style":1070},[3379],{"type":431,"value":3380},"as",{"type":425,"tag":466,"props":3382,"children":3383},{"style":1033},[3384],{"type":431,"value":3385}," RegExpExecArray",{"type":425,"tag":466,"props":3387,"children":3388},{"style":1076},[3389],{"type":431,"value":3390},")[",{"type":425,"tag":466,"props":3392,"children":3393},{"style":515},[3394],{"type":431,"value":1183},{"type":425,"tag":466,"props":3396,"children":3397},{"style":1076},[3398],{"type":431,"value":3399},"]\n",{"type":425,"tag":466,"props":3401,"children":3402},{"class":468,"line":500},[3403,3407,3411,3415,3419,3424],{"type":425,"tag":466,"props":3404,"children":3405},{"style":1082},[3406],{"type":431,"value":1394},{"type":425,"tag":466,"props":3408,"children":3409},{"style":494},[3410],{"type":431,"value":486},{"type":425,"tag":466,"props":3412,"children":3413},{"style":1092},[3414],{"type":431,"value":1880},{"type":425,"tag":466,"props":3416,"children":3417},{"style":1076},[3418],{"type":431,"value":1178},{"type":425,"tag":466,"props":3420,"children":3421},{"style":530},[3422],{"type":431,"value":3423},"cssValue",{"type":425,"tag":466,"props":3425,"children":3426},{"style":1076},[3427],{"type":431,"value":1540},{"type":425,"tag":466,"props":3429,"children":3430},{"class":468,"line":526},[3431],{"type":425,"tag":466,"props":3432,"children":3433},{"emptyLinePlaceholder":590},[3434],{"type":431,"value":593},{"type":425,"tag":466,"props":3436,"children":3437},{"class":468,"line":546},[3438],{"type":425,"tag":466,"props":3439,"children":3440},{"style":473},[3441],{"type":431,"value":3442},"  // 递归退出条件\n",{"type":425,"tag":466,"props":3444,"children":3445},{"class":468,"line":568},[3446,3450,3454,3458,3462,3466,3470,3474],{"type":425,"tag":466,"props":3447,"children":3448},{"style":1070},[3449],{"type":431,"value":2528},{"type":425,"tag":466,"props":3451,"children":3452},{"style":1076},[3453],{"type":431,"value":1079},{"type":425,"tag":466,"props":3455,"children":3456},{"style":626},[3457],{"type":431,"value":2537},{"type":425,"tag":466,"props":3459,"children":3460},{"style":1082},[3461],{"type":431,"value":1085},{"type":425,"tag":466,"props":3463,"children":3464},{"style":494},[3465],{"type":431,"value":486},{"type":425,"tag":466,"props":3467,"children":3468},{"style":530},[3469],{"type":431,"value":1164},{"type":425,"tag":466,"props":3471,"children":3472},{"style":1076},[3473],{"type":431,"value":1188},{"type":425,"tag":466,"props":3475,"children":3476},{"style":1070},[3477],{"type":431,"value":3478},"return\n",{"type":425,"tag":466,"props":3480,"children":3481},{"class":468,"line":577},[3482,3486,3490,3494,3498,3502,3506,3510,3514,3518,3522,3527,3531,3535,3539,3543],{"type":425,"tag":466,"props":3483,"children":3484},{"style":1070},[3485],{"type":431,"value":2528},{"type":425,"tag":466,"props":3487,"children":3488},{"style":1076},[3489],{"type":431,"value":1079},{"type":425,"tag":466,"props":3491,"children":3492},{"style":1082},[3493],{"type":431,"value":1085},{"type":425,"tag":466,"props":3495,"children":3496},{"style":494},[3497],{"type":431,"value":486},{"type":425,"tag":466,"props":3499,"children":3500},{"style":530},[3501],{"type":431,"value":1164},{"type":425,"tag":466,"props":3503,"children":3504},{"style":494},[3505],{"type":431,"value":486},{"type":425,"tag":466,"props":3507,"children":3508},{"style":1092},[3509],{"type":431,"value":1173},{"type":425,"tag":466,"props":3511,"children":3512},{"style":1076},[3513],{"type":431,"value":1178},{"type":425,"tag":466,"props":3515,"children":3516},{"style":515},[3517],{"type":431,"value":1183},{"type":425,"tag":466,"props":3519,"children":3520},{"style":1076},[3521],{"type":431,"value":1188},{"type":425,"tag":466,"props":3523,"children":3524},{"style":626},[3525],{"type":431,"value":3526},"===",{"type":425,"tag":466,"props":3528,"children":3529},{"style":632},[3530],{"type":431,"value":2128},{"type":425,"tag":466,"props":3532,"children":3533},{"style":638},[3534],{"type":431,"value":1933},{"type":425,"tag":466,"props":3536,"children":3537},{"style":632},[3538],{"type":431,"value":2137},{"type":425,"tag":466,"props":3540,"children":3541},{"style":1076},[3542],{"type":431,"value":1188},{"type":425,"tag":466,"props":3544,"children":3545},{"style":1070},[3546],{"type":431,"value":3478},{"type":425,"tag":466,"props":3548,"children":3549},{"class":468,"line":586},[3550],{"type":425,"tag":466,"props":3551,"children":3552},{"emptyLinePlaceholder":590},[3553],{"type":431,"value":593},{"type":425,"tag":466,"props":3555,"children":3556},{"class":468,"line":596},[3557],{"type":425,"tag":466,"props":3558,"children":3559},{"style":473},[3560],{"type":431,"value":3561},"  // extract comments in declarations\n",{"type":425,"tag":466,"props":3563,"children":3564},{"class":468,"line":605},[3565,3569,3573,3577,3581,3585,3589,3593,3597,3601,3605,3609,3613,3617,3621,3626,3630,3634,3638,3642,3646,3650,3654,3658,3662,3666,3670,3674,3678],{"type":425,"tag":466,"props":3566,"children":3567},{"style":1070},[3568],{"type":431,"value":2528},{"type":425,"tag":466,"props":3570,"children":3571},{"style":1076},[3572],{"type":431,"value":1079},{"type":425,"tag":466,"props":3574,"children":3575},{"style":1082},[3576],{"type":431,"value":1085},{"type":425,"tag":466,"props":3578,"children":3579},{"style":494},[3580],{"type":431,"value":486},{"type":425,"tag":466,"props":3582,"children":3583},{"style":530},[3584],{"type":431,"value":1164},{"type":425,"tag":466,"props":3586,"children":3587},{"style":494},[3588],{"type":431,"value":486},{"type":425,"tag":466,"props":3590,"children":3591},{"style":1092},[3592],{"type":431,"value":1173},{"type":425,"tag":466,"props":3594,"children":3595},{"style":1076},[3596],{"type":431,"value":1178},{"type":425,"tag":466,"props":3598,"children":3599},{"style":515},[3600],{"type":431,"value":1183},{"type":425,"tag":466,"props":3602,"children":3603},{"style":1076},[3604],{"type":431,"value":1188},{"type":425,"tag":466,"props":3606,"children":3607},{"style":626},[3608],{"type":431,"value":3526},{"type":425,"tag":466,"props":3610,"children":3611},{"style":632},[3612],{"type":431,"value":2128},{"type":425,"tag":466,"props":3614,"children":3615},{"style":638},[3616],{"type":431,"value":1203},{"type":425,"tag":466,"props":3618,"children":3619},{"style":632},[3620],{"type":431,"value":2137},{"type":425,"tag":466,"props":3622,"children":3623},{"style":626},[3624],{"type":431,"value":3625}," &&",{"type":425,"tag":466,"props":3627,"children":3628},{"style":1082},[3629],{"type":431,"value":1217},{"type":425,"tag":466,"props":3631,"children":3632},{"style":494},[3633],{"type":431,"value":486},{"type":425,"tag":466,"props":3635,"children":3636},{"style":530},[3637],{"type":431,"value":1164},{"type":425,"tag":466,"props":3639,"children":3640},{"style":494},[3641],{"type":431,"value":486},{"type":425,"tag":466,"props":3643,"children":3644},{"style":1092},[3645],{"type":431,"value":1173},{"type":425,"tag":466,"props":3647,"children":3648},{"style":1076},[3649],{"type":431,"value":1178},{"type":425,"tag":466,"props":3651,"children":3652},{"style":515},[3653],{"type":431,"value":949},{"type":425,"tag":466,"props":3655,"children":3656},{"style":1076},[3657],{"type":431,"value":1188},{"type":425,"tag":466,"props":3659,"children":3660},{"style":626},[3661],{"type":431,"value":3526},{"type":425,"tag":466,"props":3663,"children":3664},{"style":632},[3665],{"type":431,"value":2128},{"type":425,"tag":466,"props":3667,"children":3668},{"style":638},[3669],{"type":431,"value":1258},{"type":425,"tag":466,"props":3671,"children":3672},{"style":632},[3673],{"type":431,"value":2137},{"type":425,"tag":466,"props":3675,"children":3676},{"style":1076},[3677],{"type":431,"value":1188},{"type":425,"tag":466,"props":3679,"children":3680},{"style":494},[3681],{"type":431,"value":1271},{"type":425,"tag":466,"props":3683,"children":3684},{"class":468,"line":666},[3685,3689,3693,3697],{"type":425,"tag":466,"props":3686,"children":3687},{"style":1082},[3688],{"type":431,"value":2063},{"type":425,"tag":466,"props":3690,"children":3691},{"style":494},[3692],{"type":431,"value":486},{"type":425,"tag":466,"props":3694,"children":3695},{"style":1092},[3696],{"type":431,"value":2039},{"type":425,"tag":466,"props":3698,"children":3699},{"style":1076},[3700],{"type":431,"value":2023},{"type":425,"tag":466,"props":3702,"children":3703},{"class":468,"line":686},[3704,3708,3713],{"type":425,"tag":466,"props":3705,"children":3706},{"style":494},[3707],{"type":431,"value":865},{"type":425,"tag":466,"props":3709,"children":3710},{"style":1070},[3711],{"type":431,"value":3712}," else",{"type":425,"tag":466,"props":3714,"children":3715},{"style":494},[3716],{"type":431,"value":497},{"type":425,"tag":466,"props":3718,"children":3719},{"class":468,"line":702},[3720],{"type":425,"tag":466,"props":3721,"children":3722},{"style":473},[3723],{"type":431,"value":3724},"    // 如果不是注释则忽略中断，继续匹配声明\n",{"type":425,"tag":466,"props":3726,"children":3727},{"class":468,"line":722},[3728,3732,3736,3740,3744,3748,3754,3758,3762],{"type":425,"tag":466,"props":3729,"children":3730},{"style":1082},[3731],{"type":431,"value":2063},{"type":425,"tag":466,"props":3733,"children":3734},{"style":494},[3735],{"type":431,"value":486},{"type":425,"tag":466,"props":3737,"children":3738},{"style":1092},[3739],{"type":431,"value":2312},{"type":425,"tag":466,"props":3741,"children":3742},{"style":1076},[3743],{"type":431,"value":1178},{"type":425,"tag":466,"props":3745,"children":3746},{"style":632},[3747],{"type":431,"value":1203},{"type":425,"tag":466,"props":3749,"children":3751},{"style":3750},"--shiki-light:#90A4AE;--shiki-light-font-weight:inherit;--shiki-default:#22863A;--shiki-default-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;--shiki-sepia:#AE81FF;--shiki-sepia-font-weight:inherit",[3752],{"type":431,"value":3753},"\\/",{"type":425,"tag":466,"props":3755,"children":3756},{"style":626},[3757],{"type":431,"value":1511},{"type":425,"tag":466,"props":3759,"children":3760},{"style":632},[3761],{"type":431,"value":1203},{"type":425,"tag":466,"props":3763,"children":3764},{"style":1076},[3765],{"type":431,"value":1540},{"type":425,"tag":466,"props":3767,"children":3768},{"class":468,"line":730},[3769],{"type":425,"tag":466,"props":3770,"children":3771},{"style":494},[3772],{"type":431,"value":574},{"type":425,"tag":466,"props":3774,"children":3775},{"class":468,"line":738},[3776],{"type":425,"tag":466,"props":3777,"children":3778},{"emptyLinePlaceholder":590},[3779],{"type":431,"value":593},{"type":425,"tag":466,"props":3781,"children":3782},{"class":468,"line":746},[3783,3787,3791,3795,3799],{"type":425,"tag":466,"props":3784,"children":3785},{"style":1070},[3786],{"type":431,"value":2687},{"type":425,"tag":466,"props":3788,"children":3789},{"style":1082},[3790],{"type":431,"value":1217},{"type":425,"tag":466,"props":3792,"children":3793},{"style":494},[3794],{"type":431,"value":486},{"type":425,"tag":466,"props":3796,"children":3797},{"style":1092},[3798],{"type":431,"value":3277},{"type":425,"tag":466,"props":3800,"children":3801},{"style":1076},[3802],{"type":431,"value":2023},{"type":425,"tag":466,"props":3804,"children":3805},{"class":468,"line":755},[3806],{"type":425,"tag":466,"props":3807,"children":3808},{"style":494},[3809],{"type":431,"value":583},{"type":425,"tag":980,"props":3811,"children":3813},{"id":3812},"解析at-rule",[3814,3816],{"type":431,"value":3815},"解析",{"type":425,"tag":462,"props":3817,"children":3819},{"className":3818},[],[3820],{"type":431,"value":971},{"type":425,"tag":433,"props":3822,"children":3823},{},[3824,3826,3832,3834,3840,3841,3847,3849,3860],{"type":431,"value":3825},"流程中最繁琐的部分，是匹配 ",{"type":425,"tag":462,"props":3827,"children":3829},{"className":3828},[],[3830],{"type":431,"value":3831},"@media",{"type":431,"value":3833},"、",{"type":425,"tag":462,"props":3835,"children":3837},{"className":3836},[],[3838],{"type":431,"value":3839},"@import",{"type":431,"value":3833},{"type":425,"tag":462,"props":3842,"children":3844},{"className":3843},[],[3845],{"type":431,"value":3846},"@charset",{"type":431,"value":3848}," 等 ",{"type":425,"tag":444,"props":3850,"children":3853},{"href":3851,"rel":3852},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/At-rule",[448],[3854],{"type":425,"tag":462,"props":3855,"children":3857},{"className":3856},[],[3858],{"type":431,"value":3859},"at-rules",{"type":431,"value":951},{"type":425,"tag":433,"props":3862,"children":3863},{},[3864],{"type":431,"value":3865},"每一种规则的语法都不同，要怎么处理才合适呢？",{"type":425,"tag":433,"props":3867,"children":3868},{},[3869,3871,3876],{"type":431,"value":3870},"这里，micro-app 把 ",{"type":425,"tag":462,"props":3872,"children":3874},{"className":3873},[],[3875],{"type":431,"value":971},{"type":431,"value":3877}," 分为了三组：",{"type":425,"tag":3879,"props":3880,"children":3881},"ol",{},[3882,3916,3948],{"type":425,"tag":3883,"props":3884,"children":3885},"li",{},[3886,3888,3894,3896,3901,3902,3907,3908,3914],{"type":431,"value":3887},"类似 ",{"type":425,"tag":462,"props":3889,"children":3891},{"className":3890},[],[3892],{"type":431,"value":3893},"@charset \"utf-8\";",{"type":431,"value":3895}," 为一组，包括 ",{"type":425,"tag":462,"props":3897,"children":3899},{"className":3898},[],[3900],{"type":431,"value":3839},{"type":431,"value":3833},{"type":425,"tag":462,"props":3903,"children":3905},{"className":3904},[],[3906],{"type":431,"value":3846},{"type":431,"value":3833},{"type":425,"tag":462,"props":3909,"children":3911},{"className":3910},[],[3912],{"type":431,"value":3913},"@namespace",{"type":431,"value":3915}," 等。",{"type":425,"tag":3883,"props":3917,"children":3918},{},[3919,3920,3926,3927,3933,3934,3940,3941,3947],{"type":431,"value":3887},{"type":425,"tag":462,"props":3921,"children":3923},{"className":3922},[],[3924],{"type":431,"value":3925},"@media (w \u003C 100px) { .selector { xxx: xxx } }",{"type":431,"value":3895},{"type":425,"tag":462,"props":3928,"children":3930},{"className":3929},[],[3931],{"type":431,"value":3932},"@supports",{"type":431,"value":3833},{"type":425,"tag":462,"props":3935,"children":3937},{"className":3936},[],[3938],{"type":431,"value":3939},"@font-face",{"type":431,"value":3833},{"type":425,"tag":462,"props":3942,"children":3944},{"className":3943},[],[3945],{"type":431,"value":3946},"@document",{"type":431,"value":3915},{"type":425,"tag":3883,"props":3949,"children":3950},{},[3951,3952,3958,3959,3964,3965,3971,3972,3978],{"type":431,"value":3887},{"type":425,"tag":462,"props":3953,"children":3955},{"className":3954},[],[3956],{"type":431,"value":3957},"@font-face { unicode-range: 'xxx' }",{"type":431,"value":3895},{"type":425,"tag":462,"props":3960,"children":3962},{"className":3961},[],[3963],{"type":431,"value":3939},{"type":431,"value":3833},{"type":425,"tag":462,"props":3966,"children":3968},{"className":3967},[],[3969],{"type":431,"value":3970},"@page",{"type":431,"value":3833},{"type":425,"tag":462,"props":3973,"children":3975},{"className":3974},[],[3976],{"type":431,"value":3977},"@key-frames",{"type":431,"value":3915},{"type":425,"tag":433,"props":3980,"children":3981},{},[3982,3984,3989,3991,3997,3999,4005,4007,4012],{"type":431,"value":3983},"第一组，",{"type":425,"tag":462,"props":3985,"children":3987},{"className":3986},[],[3988],{"type":431,"value":3846},{"type":431,"value":3990}," 所在的第一组规则的规则正文内容从 ",{"type":425,"tag":462,"props":3992,"children":3994},{"className":3993},[],[3995],{"type":431,"value":3996},"@",{"type":431,"value":3998}," 开始到 ",{"type":425,"tag":462,"props":4000,"children":4002},{"className":4001},[],[4003],{"type":431,"value":4004},";",{"type":431,"value":4006}," 结束，比如 ",{"type":425,"tag":462,"props":4008,"children":4010},{"className":4009},[],[4011],{"type":431,"value":3893},{"type":431,"value":4013}," 就是一条完整的声明；",{"type":425,"tag":433,"props":4015,"children":4016},{},[4017,4019,4025,4027,4032],{"type":431,"value":4018},"第二组，",{"type":425,"tag":462,"props":4020,"children":4022},{"className":4021},[],[4023],{"type":431,"value":4024},"@media () {}",{"type":431,"value":4026}," 的花括号部分可能包含选择器，所以其正文内容需要重新进入 ",{"type":425,"tag":462,"props":4028,"children":4030},{"className":4029},[],[4031],{"type":431,"value":1988},{"type":431,"value":4033}," 匹配选择器以及声明。",{"type":425,"tag":433,"props":4035,"children":4036},{},[4037,4039,4045,4047,4052],{"type":431,"value":4038},"第三组，",{"type":425,"tag":462,"props":4040,"children":4042},{"className":4041},[],[4043],{"type":431,"value":4044},"@font-face {}",{"type":431,"value":4046}," 的花括号部分仅包含声明，不包含选择器，所以只需要进入 ",{"type":425,"tag":462,"props":4048,"children":4050},{"className":4049},[],[4051],{"type":431,"value":3277},{"type":431,"value":4053}," 匹配声明即可。",{"type":425,"tag":426,"props":4055,"children":4057},{"id":4056},"解决问题",[4058],{"type":431,"value":4056},{"type":425,"tag":433,"props":4060,"children":4061},{},[4062],{"type":431,"value":4063},"回到文章开头的问题，如果要给这个 CSS Parser 增加原生的嵌套功能，见下代码，可以仅用十行简单实现。",{"type":425,"tag":455,"props":4065,"children":4069},{"className":4066,"code":4067,"language":4068,"meta":419,"style":419},"language-diff shiki shiki-themes material-theme-lighter github-light github-dark monokai","+ private matchAllDeclarations (nesting = 0): void {\n  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n  this.recordResult(cssValue)\n\n  // 递归退出条件\n  if (!this.cssText) return\n-  if (this.cssText.charAt(0) === '}') return\n+  if (this.cssText.charAt(0) === '}') {\n+    if (!nesting) return\n+    this.commonMatch(/}+\\s*/)\n+    return this.matchAllDeclarations(nesting - 1)\n+  }\n\n  // extract comments in declarations\n  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n    this.matchComments()\n  } else {\n    // 如果不是注释则忽略中断，继续匹配声明\n    this.commonMatch(/\\/+/)\n  }\n\n+ if (this.cssText.charAt(0) === '{') {\n+   this.commonMatch(/{+\\s*/)\n+   nesting++\n+ }\n\n- return this.matchAllDeclarations()\n+ return this.matchAllDeclarations(nesting)\n}\n","diff",[4070],{"type":425,"tag":462,"props":4071,"children":4072},{"__ignoreMap":419},[4073,4087,4095,4103,4110,4117,4125,4139,4151,4163,4175,4187,4198,4205,4212,4220,4228,4236,4243,4251,4258,4265,4277,4290,4303,4316,4324,4337,4350],{"type":425,"tag":466,"props":4074,"children":4075},{"class":468,"line":469},[4076,4081],{"type":425,"tag":466,"props":4077,"children":4079},{"style":4078},"--shiki-light:#39ADB5;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#A6E22E",[4080],{"type":431,"value":1511},{"type":425,"tag":466,"props":4082,"children":4084},{"style":4083},"--shiki-light:#91B859;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#A6E22E",[4085],{"type":431,"value":4086}," private matchAllDeclarations (nesting = 0): void {\n",{"type":425,"tag":466,"props":4088,"children":4089},{"class":468,"line":479},[4090],{"type":425,"tag":466,"props":4091,"children":4092},{"style":530},[4093],{"type":431,"value":4094},"  let cssValue = (this.commonMatch(/^[^}/])*/, true) as RegExpExecArray)[0]\n",{"type":425,"tag":466,"props":4096,"children":4097},{"class":468,"line":500},[4098],{"type":425,"tag":466,"props":4099,"children":4100},{"style":530},[4101],{"type":431,"value":4102},"  this.recordResult(cssValue)\n",{"type":425,"tag":466,"props":4104,"children":4105},{"class":468,"line":526},[4106],{"type":425,"tag":466,"props":4107,"children":4108},{"emptyLinePlaceholder":590},[4109],{"type":431,"value":593},{"type":425,"tag":466,"props":4111,"children":4112},{"class":468,"line":546},[4113],{"type":425,"tag":466,"props":4114,"children":4115},{"style":530},[4116],{"type":431,"value":3442},{"type":425,"tag":466,"props":4118,"children":4119},{"class":468,"line":568},[4120],{"type":425,"tag":466,"props":4121,"children":4122},{"style":530},[4123],{"type":431,"value":4124},"  if (!this.cssText) return\n",{"type":425,"tag":466,"props":4126,"children":4127},{"class":468,"line":577},[4128,4133],{"type":425,"tag":466,"props":4129,"children":4131},{"style":4130},"--shiki-light:#39ADB5;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F92672",[4132],{"type":431,"value":1663},{"type":425,"tag":466,"props":4134,"children":4136},{"style":4135},"--shiki-light:#E53935;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F92672",[4137],{"type":431,"value":4138},"  if (this.cssText.charAt(0) === '}') return\n",{"type":425,"tag":466,"props":4140,"children":4141},{"class":468,"line":586},[4142,4146],{"type":425,"tag":466,"props":4143,"children":4144},{"style":4078},[4145],{"type":431,"value":1511},{"type":425,"tag":466,"props":4147,"children":4148},{"style":4083},[4149],{"type":431,"value":4150},"  if (this.cssText.charAt(0) === '}') {\n",{"type":425,"tag":466,"props":4152,"children":4153},{"class":468,"line":596},[4154,4158],{"type":425,"tag":466,"props":4155,"children":4156},{"style":4078},[4157],{"type":431,"value":1511},{"type":425,"tag":466,"props":4159,"children":4160},{"style":4083},[4161],{"type":431,"value":4162},"    if (!nesting) return\n",{"type":425,"tag":466,"props":4164,"children":4165},{"class":468,"line":605},[4166,4170],{"type":425,"tag":466,"props":4167,"children":4168},{"style":4078},[4169],{"type":431,"value":1511},{"type":425,"tag":466,"props":4171,"children":4172},{"style":4083},[4173],{"type":431,"value":4174},"    this.commonMatch(/}+\\s*/)\n",{"type":425,"tag":466,"props":4176,"children":4177},{"class":468,"line":666},[4178,4182],{"type":425,"tag":466,"props":4179,"children":4180},{"style":4078},[4181],{"type":431,"value":1511},{"type":425,"tag":466,"props":4183,"children":4184},{"style":4083},[4185],{"type":431,"value":4186},"    return this.matchAllDeclarations(nesting - 1)\n",{"type":425,"tag":466,"props":4188,"children":4189},{"class":468,"line":686},[4190,4194],{"type":425,"tag":466,"props":4191,"children":4192},{"style":4078},[4193],{"type":431,"value":1511},{"type":425,"tag":466,"props":4195,"children":4196},{"style":4083},[4197],{"type":431,"value":574},{"type":425,"tag":466,"props":4199,"children":4200},{"class":468,"line":702},[4201],{"type":425,"tag":466,"props":4202,"children":4203},{"emptyLinePlaceholder":590},[4204],{"type":431,"value":593},{"type":425,"tag":466,"props":4206,"children":4207},{"class":468,"line":722},[4208],{"type":425,"tag":466,"props":4209,"children":4210},{"style":530},[4211],{"type":431,"value":3561},{"type":425,"tag":466,"props":4213,"children":4214},{"class":468,"line":730},[4215],{"type":425,"tag":466,"props":4216,"children":4217},{"style":530},[4218],{"type":431,"value":4219},"  if (this.cssText.charAt(0) === '/' && this.cssText.charAt(1) === '*') {\n",{"type":425,"tag":466,"props":4221,"children":4222},{"class":468,"line":738},[4223],{"type":425,"tag":466,"props":4224,"children":4225},{"style":530},[4226],{"type":431,"value":4227},"    this.matchComments()\n",{"type":425,"tag":466,"props":4229,"children":4230},{"class":468,"line":746},[4231],{"type":425,"tag":466,"props":4232,"children":4233},{"style":530},[4234],{"type":431,"value":4235},"  } else {\n",{"type":425,"tag":466,"props":4237,"children":4238},{"class":468,"line":755},[4239],{"type":425,"tag":466,"props":4240,"children":4241},{"style":530},[4242],{"type":431,"value":3724},{"type":425,"tag":466,"props":4244,"children":4245},{"class":468,"line":803},[4246],{"type":425,"tag":466,"props":4247,"children":4248},{"style":530},[4249],{"type":431,"value":4250},"    this.commonMatch(/\\/+/)\n",{"type":425,"tag":466,"props":4252,"children":4253},{"class":468,"line":823},[4254],{"type":425,"tag":466,"props":4255,"children":4256},{"style":530},[4257],{"type":431,"value":574},{"type":425,"tag":466,"props":4259,"children":4260},{"class":468,"line":839},[4261],{"type":425,"tag":466,"props":4262,"children":4263},{"emptyLinePlaceholder":590},[4264],{"type":431,"value":593},{"type":425,"tag":466,"props":4266,"children":4267},{"class":468,"line":859},[4268,4272],{"type":425,"tag":466,"props":4269,"children":4270},{"style":4078},[4271],{"type":431,"value":1511},{"type":425,"tag":466,"props":4273,"children":4274},{"style":4083},[4275],{"type":431,"value":4276}," if (this.cssText.charAt(0) === '{') {\n",{"type":425,"tag":466,"props":4278,"children":4280},{"class":468,"line":4279},23,[4281,4285],{"type":425,"tag":466,"props":4282,"children":4283},{"style":4078},[4284],{"type":431,"value":1511},{"type":425,"tag":466,"props":4286,"children":4287},{"style":4083},[4288],{"type":431,"value":4289},"   this.commonMatch(/{+\\s*/)\n",{"type":425,"tag":466,"props":4291,"children":4293},{"class":468,"line":4292},24,[4294,4298],{"type":425,"tag":466,"props":4295,"children":4296},{"style":4078},[4297],{"type":431,"value":1511},{"type":425,"tag":466,"props":4299,"children":4300},{"style":4083},[4301],{"type":431,"value":4302},"   nesting++\n",{"type":425,"tag":466,"props":4304,"children":4306},{"class":468,"line":4305},25,[4307,4311],{"type":425,"tag":466,"props":4308,"children":4309},{"style":4078},[4310],{"type":431,"value":1511},{"type":425,"tag":466,"props":4312,"children":4313},{"style":4083},[4314],{"type":431,"value":4315}," }\n",{"type":425,"tag":466,"props":4317,"children":4319},{"class":468,"line":4318},26,[4320],{"type":425,"tag":466,"props":4321,"children":4322},{"emptyLinePlaceholder":590},[4323],{"type":431,"value":593},{"type":425,"tag":466,"props":4325,"children":4327},{"class":468,"line":4326},27,[4328,4332],{"type":425,"tag":466,"props":4329,"children":4330},{"style":4130},[4331],{"type":431,"value":1663},{"type":425,"tag":466,"props":4333,"children":4334},{"style":4135},[4335],{"type":431,"value":4336}," return this.matchAllDeclarations()\n",{"type":425,"tag":466,"props":4338,"children":4340},{"class":468,"line":4339},28,[4341,4345],{"type":425,"tag":466,"props":4342,"children":4343},{"style":4078},[4344],{"type":431,"value":1511},{"type":425,"tag":466,"props":4346,"children":4347},{"style":4083},[4348],{"type":431,"value":4349}," return this.matchAllDeclarations(nesting)\n",{"type":425,"tag":466,"props":4351,"children":4353},{"class":468,"line":4352},29,[4354],{"type":425,"tag":466,"props":4355,"children":4356},{"style":530},[4357],{"type":431,"value":583},{"type":425,"tag":433,"props":4359,"children":4360},{},[4361],{"type":431,"value":4362},"最终 CSS Nesting 解析成功。",{"type":425,"tag":433,"props":4364,"children":4365},{},[4366],{"type":425,"tag":956,"props":4367,"children":4369},{"alt":1855,"src":4368},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230804025910.png",[],{"type":425,"tag":426,"props":4371,"children":4373},{"id":4372},"结语",[4374],{"type":431,"value":4372},{"type":425,"tag":433,"props":4376,"children":4377},{},[4378],{"type":431,"value":4379},"整个 CSS Parser 的代码简单，功能强悍，耐人寻味。不过有许多边界条件没有处理好，尤其是引入了使用注释禁用样式隔离功能后，匹配注释变得更复杂且易错了。",{"type":425,"tag":3879,"props":4381,"children":4382},{},[4383],{"type":425,"tag":3883,"props":4384,"children":4385},{},[4386],{"type":431,"value":4387},"注释不能和选择器等混用（以下 result 文件代表解析结果）。",{"type":425,"tag":433,"props":4389,"children":4390},{},[4391],{"type":425,"tag":956,"props":4392,"children":4395},{"alt":4393,"src":4394},"comment in selectors","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/9d2b75bda238f9bbe24825a793f0f715.png",[],{"type":425,"tag":3879,"props":4397,"children":4398},{"start":479},[4399],{"type":425,"tag":3883,"props":4400,"children":4401},{},[4402],{"type":431,"value":4403},"CSS 字符串值可能意外启用编译器的特殊功能。",{"type":425,"tag":433,"props":4405,"children":4406},{},[4407],{"type":425,"tag":956,"props":4408,"children":4411},{"alt":4409,"src":4410},"special comment in string value","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230803225103.png",[],{"type":425,"tag":3879,"props":4413,"children":4414},{"start":500},[4415],{"type":425,"tag":3883,"props":4416,"children":4417},{},[4418,4420,4426,4428,4439,4441,4446],{"type":431,"value":4419},"错误的 ",{"type":425,"tag":462,"props":4421,"children":4423},{"className":4422},[],[4424],{"type":431,"value":4425},"@host",{"type":431,"value":4427}," 规则匹配。猜测是想匹配 ",{"type":425,"tag":444,"props":4429,"children":4432},{"href":4430,"rel":4431},"https://drafts.csswg.org/css-scoping/#host-selector",[448],[4433],{"type":425,"tag":462,"props":4434,"children":4436},{"className":4435},[],[4437],{"type":431,"value":4438},":host",{"type":431,"value":4440}," 但是手滑写成了 ",{"type":425,"tag":462,"props":4442,"children":4444},{"className":4443},[],[4445],{"type":431,"value":4425},{"type":431,"value":951},{"type":425,"tag":455,"props":4448,"children":4450},{"className":1015,"code":4449,"language":1017,"meta":419,"style":419},"private hostRule =\n  this.createMatcherForRuleWithChildRule(\n    /^@host\\s*/,\n    '@host'\n  )\n",[4451],{"type":425,"tag":462,"props":4452,"children":4453},{"__ignoreMap":419},[4454,4467,4488,4521,4538],{"type":425,"tag":466,"props":4455,"children":4456},{"class":468,"line":469},[4457,4462],{"type":425,"tag":466,"props":4458,"children":4459},{"style":530},[4460],{"type":431,"value":4461},"private hostRule ",{"type":425,"tag":466,"props":4463,"children":4464},{"style":626},[4465],{"type":431,"value":4466},"=\n",{"type":425,"tag":466,"props":4468,"children":4469},{"class":468,"line":479},[4470,4474,4478,4483],{"type":425,"tag":466,"props":4471,"children":4472},{"style":1082},[4473],{"type":431,"value":1394},{"type":425,"tag":466,"props":4475,"children":4476},{"style":494},[4477],{"type":431,"value":486},{"type":425,"tag":466,"props":4479,"children":4480},{"style":1092},[4481],{"type":431,"value":4482},"createMatcherForRuleWithChildRule",{"type":425,"tag":466,"props":4484,"children":4485},{"style":530},[4486],{"type":431,"value":4487},"(\n",{"type":425,"tag":466,"props":4489,"children":4490},{"class":468,"line":500},[4491,4496,4500,4504,4508,4512,4516],{"type":425,"tag":466,"props":4492,"children":4493},{"style":632},[4494],{"type":431,"value":4495},"    /",{"type":425,"tag":466,"props":4497,"children":4498},{"style":1070},[4499],{"type":431,"value":2325},{"type":425,"tag":466,"props":4501,"children":4502},{"style":2966},[4503],{"type":431,"value":4425},{"type":425,"tag":466,"props":4505,"children":4506},{"style":2328},[4507],{"type":431,"value":2331},{"type":425,"tag":466,"props":4509,"children":4510},{"style":626},[4511],{"type":431,"value":1258},{"type":425,"tag":466,"props":4513,"children":4514},{"style":632},[4515],{"type":431,"value":1203},{"type":425,"tag":466,"props":4517,"children":4518},{"style":494},[4519],{"type":431,"value":4520},",\n",{"type":425,"tag":466,"props":4522,"children":4523},{"class":468,"line":526},[4524,4529,4533],{"type":425,"tag":466,"props":4525,"children":4526},{"style":632},[4527],{"type":431,"value":4528},"    '",{"type":425,"tag":466,"props":4530,"children":4531},{"style":638},[4532],{"type":431,"value":4425},{"type":425,"tag":466,"props":4534,"children":4535},{"style":632},[4536],{"type":431,"value":4537},"'\n",{"type":425,"tag":466,"props":4539,"children":4540},{"class":468,"line":546},[4541],{"type":425,"tag":466,"props":4542,"children":4543},{"style":530},[4544],{"type":431,"value":4545},"  )\n",{"type":425,"tag":433,"props":4547,"children":4548},{},[4549],{"type":425,"tag":956,"props":4550,"children":4553},{"alt":4551,"src":4552},"error @host rule","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20230803235802.png",[],{"type":425,"tag":433,"props":4555,"children":4556},{},[4557,4559,4566],{"type":431,"value":4558},"在实际项目中，考虑到性能和可维护性的平衡，为了使代码不变得过于复杂，没有必要去完善“边界功能”。运行时的解析应当尽量简单且运行快速，并保持一定的容错：不规范的 CSS 代码在浏览器中本身就能运行，再者，解析器是一个容易带来代码性能和体积瓶颈的地方，要不然 VueJS 也不会分全局构建和运行时",{"type":425,"tag":444,"props":4560,"children":4563},{"href":4561,"rel":4562},"https://www.jsdelivr.com/package/npm/vue?tab=files&path=dist",[448],[4564],{"type":431,"value":4565},"两个版本的编译产物",{"type":431,"value":951},{"type":425,"tag":433,"props":4568,"children":4569},{},[4570],{"type":431,"value":4571},"鉴于 CSS 在部分语法上的灵活性，如果从降低维护难度的角度考虑优化这个 CSS Parser，可能从以下方向：",{"type":425,"tag":4573,"props":4574,"children":4575},"ul",{},[4576,4611],{"type":425,"tag":3883,"props":4577,"children":4578},{},[4579,4581,4586,4588,4594,4596,4601,4603,4610],{"type":431,"value":4580},"在规则匹配部分使用黑名单机制而不是白名单匹配。就 ",{"type":425,"tag":462,"props":4582,"children":4584},{"className":4583},[],[4585],{"type":431,"value":971},{"type":431,"value":4587}," 等灵活语法而言，如果浏览器支持新的 ",{"type":425,"tag":462,"props":4589,"children":4591},{"className":4590},[],[4592],{"type":431,"value":4593},"@xxx",{"type":431,"value":4595}," 语法，黑名单机制编写的代码不需要对 ",{"type":425,"tag":462,"props":4597,"children":4599},{"className":4598},[],[4600],{"type":431,"value":4593},{"type":431,"value":4602}," 做额外处理；而白名单机制需要",{"type":425,"tag":444,"props":4604,"children":4607},{"href":4605,"rel":4606},"https://github.com/micro-zoe/micro-app/commit/b83c4600102e0db6f591bacbdc592bea8f1d5bb8",[448],[4608],{"type":431,"value":4609},"手动处理",{"type":431,"value":951},{"type":425,"tag":3883,"props":4612,"children":4613},{},[4614,4616,4627],{"type":431,"value":4615},"在复杂的解析器部分使用外部依赖，如使用类似 ",{"type":425,"tag":444,"props":4617,"children":4620},{"href":4618,"rel":4619},"https://www.npmjs.com/package/lightningcss-wasm/v/1.16.0",[448],[4621],{"type":425,"tag":462,"props":4622,"children":4624},{"className":4623},[],[4625],{"type":431,"value":4626},"lightingcss-wasm",{"type":431,"value":4628}," 等方案。",{"type":425,"tag":433,"props":4630,"children":4631},{},[4632],{"type":431,"value":4633},"关于样式隔离，作者两年前专门写了文章介绍，不过时效性稍有不足，没有涉及解析器的具体流程，写得更多是解析器在整个微前端框架中的作用，也可作为补充阅读。",{"type":425,"tag":4573,"props":4635,"children":4636},{},[4637],{"type":425,"tag":3883,"props":4638,"children":4639},{},[4640],{"type":425,"tag":444,"props":4641,"children":4644},{"href":4642,"rel":4643},"https://github.com/micro-zoe/micro-app/issues/20",[448],[4645],{"type":431,"value":4646},"从零开始写一个微前端框架-样式隔离篇",{"type":425,"tag":433,"props":4648,"children":4649},{},[4650],{"type":431,"value":4651},"最后，微前端框架中的 CSS 的有很多中实施办法，采用一些办法可以抛弃运行时解析。em... 也许以后有机会聊一聊（咕一咕）。",{"type":425,"tag":426,"props":4653,"children":4655},{"id":4654},"增订-2024-年-1-月-28-日",[4656],{"type":431,"value":4657},"增订 | 2024 年 1 月 28 日",{"type":425,"tag":433,"props":4659,"children":4660},{},[4661,4663],{"type":431,"value":4662},"相关实现和测试用例见",{"type":425,"tag":444,"props":4664,"children":4667},{"href":4665,"rel":4666},"https://github.com/micro-zoe/micro-app/issues/868?_issue=nesting",[448],[4668],{"type":431,"value":4669},"这个 Issue",{"type":425,"tag":4671,"props":4672,"children":4675},"section",{"className":4673,"dataFootnotes":419},[4674],"footnotes",[4676,4683],{"type":425,"tag":426,"props":4677,"children":4680},{"className":4678,"id":945},[4679],"sr-only",[4681],{"type":431,"value":4682},"Footnotes",{"type":425,"tag":3879,"props":4684,"children":4685},{},[4686],{"type":425,"tag":3883,"props":4687,"children":4689},{"id":4688},"user-content-fn-css-syntax",[4690,4692,4698,4700],{"type":431,"value":4691},"比较完整的 CSS 语法参见：",{"type":425,"tag":444,"props":4693,"children":4696},{"href":4694,"rel":4695},"https://developer.mozilla.org/zh-CN/docs/Web/CSS/Syntax",[448],[4697],{"type":431,"value":4694},{"type":431,"value":4699}," ",{"type":425,"tag":444,"props":4701,"children":4706},{"href":4702,"ariaLabel":4703,"className":4704,"dataFootnoteBackref":419},"#user-content-fnref-css-syntax","Back to reference 1",[4705],"data-footnote-backref",[4707],{"type":431,"value":4708},"↩",{"type":425,"tag":4710,"props":4711,"children":4712},"style",{},[4713],{"type":431,"value":4714},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":419,"searchDepth":479,"depth":479,"links":4716},[4717,4718,4719,4720,4721,4722,4723],{"id":428,"depth":479,"text":428},{"id":873,"depth":479,"text":876},{"id":976,"depth":479,"text":976},{"id":4056,"depth":479,"text":4056},{"id":4372,"depth":479,"text":4372},{"id":4654,"depth":479,"text":4657},{"id":945,"depth":479,"text":4682},"markdown","content:2.articles:1101.mini-css-parser.md","content","2.articles/1101.mini-css-parser.md","2.articles/1101.mini-css-parser","md",[4731,4733],{"_path":46,"title":45,"description":4732},"忍者秘籍中提到的模板解析器，很短但支持变量和 if 等语句，还是 15 年前的代码！",{"_path":52,"title":51,"description":4734},"在两个纯知识面的问题上，受到了 GPT 的碾压",1738603220787]