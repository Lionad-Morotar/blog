[{"data":1,"prerenderedAt":1854},["ShallowReactive",2],{"navigation":3,"/articles/zindex-manager":161,"/articles/zindex-manager-surround":1849},[4,35,92,98,125,131,155],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83,86,89],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🖌️ Blockies Animation","/maps/_fe-framework/motion/blockies-animation",{"title":45,"_path":46},"🌪️ Tailwind v4 如何兼容预处理器","/articles/tailwind4-with-sass",{"title":48,"_path":49},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":51,"_path":52},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":54,"_path":55},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":57,"_path":58},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":60,"_path":61},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":63,"_path":64},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":66,"_path":67},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":69,"_path":70},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":72,"_path":73},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":75,"_path":76},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":78,"_path":79},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":81,"_path":82},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":84,"_path":85},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":87,"_path":88},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":90,"_path":91},"📝 技术博客归档","/articles/archive",{"title":93,"_path":94,"children":95},"读书笔记 / Notes","/books",[96],{"title":97,"_path":94},"📕 读书笔记",{"title":99,"_path":100,"children":101},"吉他剧场 / Music","/music",[102,104,107,110,113,116,119,122],{"title":103,"_path":100},"🎸 FingerStyle！",{"title":105,"_path":106},"🌬️ 等待的风","/music/wind",{"title":108,"_path":109},"💕 约定的海洋","/music/ocean",{"title":111,"_path":112},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":114,"_path":115},"🌏 残酷天使的行动纲领","/music/eva",{"title":117,"_path":118},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":120,"_path":121},"🍷 Wu Wei","/music/wu-wei",{"title":123,"_path":124},"🌅 无题","/music/untitled",{"title":126,"_path":127,"children":128},"知识地图 / Maps","/maps",[129],{"title":130,"_path":127},"🏁 知识地图",{"title":132,"_path":133,"children":134},"造物 / Make","/tools",[135,137,140,143,146,149,152],{"title":136,"_path":133},"🧰 工具收集",{"title":138,"_path":139},"📕 博客","/tools/blog",{"title":141,"_path":142},"🥥 Coconut","/tools/coconut",{"title":144,"_path":145},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":147,"_path":148},"🌐 AnySort","/tools/anysort",{"title":150,"_path":151},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":153,"_path":154},"👓 Crapto","/tools/crypto-inline",{"title":156,"_path":157,"children":158},"我 / About","/hire",[159],{"title":160,"_path":157},"📬 技术简历",{"_path":67,"_dir":162,"_draft":163,"_partial":163,"_locale":164,"title":66,"description":165,"body":166,"_type":1843,"_id":1844,"_source":1845,"_file":1846,"_stem":1847,"_extension":1848},"articles",false,"","使用 element-plus 内的层级管理器可以解决多组件库间层级不统一的问题",{"type":167,"children":168,"toc":1836},"root",[169,178,184,189,194,215,224,229,234,240,245,753,758,973,978,991,996,1004,1009,1014,1019,1024,1029,1279,1284,1778,1783,1798,1831],{"type":170,"tag":171,"props":172,"children":174},"element","h2",{"id":173},"增订-2022年9月5日",[175],{"type":176,"value":177},"text","增订 | 2022年9月5日",{"type":170,"tag":179,"props":180,"children":181},"p",{},[182],{"type":176,"value":183},"终于把两个 ElementPlus 实例干得只剩了一个，也顺带解决了一些项目中出现的稀奇古怪的问题。不过，这里容我吐槽一句，目前来说 ElementPlus 的问题是真的多，因为遇见 A 问题所以升级 Element 版本却引起了 B 问题这种情况屡见不鲜。我经常对着问题一调试就是两三个小时，恍惚之间就下班了，觉得一天喂狗了。呼呼，我想摸鱼啊，请给机会！",{"type":170,"tag":171,"props":185,"children":187},{"id":186},"背景",[188],{"type":176,"value":186},{"type":170,"tag":179,"props":190,"children":191},{},[192],{"type":176,"value":193},"上周在项目中碰到个棘手的问题。公司某项目依赖了两个不同的组件库，element-plus@2.0.2 和 element-plus@2.1.8。由于没把两个组件库的 zIndex 统一管理起来，所以这两库的弹窗各弹各的，可能互相遮住，很是尴尬。",{"type":170,"tag":179,"props":195,"children":196},{},[197,199,213],{"type":176,"value":198},"举例说明一下，两个组件库以下使用简称 E1 和 E2。element-plus（以及 element-ui）在内部实现了 zIndex 管理器，使打开的弹框的 zIndex 永远递增，解决了在单个 element 内部打开 dialog、popover、selector-option 等组件时互相遮盖的问题。element 默认的 zIndex 起始值是 2000，首先打开一个弹窗，dialog1，dialog1 的 zIndex 设置为 2001，如果在 dialog1 中使用按钮用打开了新的 dialog2，那么 dialog2 的 zIndex 值被置为 2002，遮住了 dialog1，这是正常的",{"type":170,"tag":200,"props":201,"children":202},"sup",{},[203],{"type":170,"tag":204,"props":205,"children":210},"a",{"href":206,"ariaDescribedBy":207,"dataFootnoteRef":164,"id":209},"#user-content-fn-append-to-body",[208],"footnote-label","user-content-fnref-append-to-body",[211],{"type":176,"value":212},"1",{"type":176,"value":214},"。那么问题来了，以上两个 dialog 都是通过 E1 打开的，一但在 dialog2 引用了 E2 的组件，打开弹窗 dialog3，那么 dialog3 的 zIndex 使用的是 E2 从 2000 开始递增为 2001 的值，不足以遮盖 E1 中 2002 的 dialog2，所以 dialog3 被 dialog2 遮挡，显示异常。",{"type":170,"tag":179,"props":216,"children":217},{},[218],{"type":170,"tag":219,"props":220,"children":223},"img",{"alt":221,"src":222},"打开多个弹窗示例","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220814192040.png",[],{"type":170,"tag":171,"props":225,"children":227},{"id":226},"解决",[228],{"type":176,"value":226},{"type":170,"tag":179,"props":230,"children":231},{},[232],{"type":176,"value":233},"统一多组件库层叠顺序，意味着将 E1 和 E2 内部实现的 zIndex 管理器中的 zIndex 通过某种形式关联起来。由于对 element 内部的实现不是很熟悉，所以一开始团队成员内部讨论时提出过许多天马行空的设想，比如“将 E2 的 zIndex 管理器作为 external 载入”、或是“使用 MutationObserver 检测 DOM 变化读取最新的 zIndex 值”... 最坏的情况是把当前的 element fork 出一份代码来自己维护，改造 zIndex 管理器实现多项目的统一管理。这些方案听起来不是那么可靠，所以我们决定先看看 element 的实现再近一步思考更优雅的解决方案。",{"type":170,"tag":235,"props":236,"children":238},"h4",{"id":237},"层叠管理器",[239],{"type":176,"value":237},{"type":170,"tag":179,"props":241,"children":242},{},[243],{"type":176,"value":244},"element-plus 的层叠管理器（PopupManager）实现比较简单，其核心原理和 element-ui 一致，通过闭包维护了一个 zIndex 的值的单例，暴露出获取值以及递增值的接口，以方便内部的 dialog 等组件在需要的时候有能力获取最新 zIndex 或者对 zIndex 进行递增。element-plus 中的层叠值管理的实现甚至比 element-ui 还要简单，它是一个 vue3 的 hook，只有 20 行代码。",{"type":170,"tag":246,"props":247,"children":251},"pre",{"className":248,"code":249,"language":250,"meta":164,"style":164},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","import { ref, computed } from 'vue'\nimport { useGlobalConfig } from '../use-global-config'\n\nconst zIndex = ref(0)\n\nexport const useZIndex = () => {\n  const initialZIndex = useGlobalConfig('zIndex', 2000) // TODO: move to @element-plus/constants\n  const currentZIndex = computed(() => initialZIndex.value + zIndex.value)\n\n  const nextZIndex = () => {\n    zIndex.value++\n    return currentZIndex.value\n  }\n\n  return {\n    initialZIndex,\n    currentZIndex,\n    nextZIndex,\n  }\n}\n","js",[252],{"type":170,"tag":253,"props":254,"children":255},"code",{"__ignoreMap":164},[256,317,355,365,408,416,455,516,585,593,622,644,666,675,683,696,710,723,736,744],{"type":170,"tag":257,"props":258,"children":261},"span",{"class":259,"line":260},"line",1,[262,268,274,280,285,290,295,300,306,312],{"type":170,"tag":257,"props":263,"children":265},{"style":264},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[266],{"type":176,"value":267},"import",{"type":170,"tag":257,"props":269,"children":271},{"style":270},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[272],{"type":176,"value":273}," {",{"type":170,"tag":257,"props":275,"children":277},{"style":276},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[278],{"type":176,"value":279}," ref",{"type":170,"tag":257,"props":281,"children":282},{"style":270},[283],{"type":176,"value":284},",",{"type":170,"tag":257,"props":286,"children":287},{"style":276},[288],{"type":176,"value":289}," computed",{"type":170,"tag":257,"props":291,"children":292},{"style":270},[293],{"type":176,"value":294}," }",{"type":170,"tag":257,"props":296,"children":297},{"style":264},[298],{"type":176,"value":299}," from",{"type":170,"tag":257,"props":301,"children":303},{"style":302},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[304],{"type":176,"value":305}," '",{"type":170,"tag":257,"props":307,"children":309},{"style":308},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[310],{"type":176,"value":311},"vue",{"type":170,"tag":257,"props":313,"children":314},{"style":302},[315],{"type":176,"value":316},"'\n",{"type":170,"tag":257,"props":318,"children":320},{"class":259,"line":319},2,[321,325,329,334,338,342,346,351],{"type":170,"tag":257,"props":322,"children":323},{"style":264},[324],{"type":176,"value":267},{"type":170,"tag":257,"props":326,"children":327},{"style":270},[328],{"type":176,"value":273},{"type":170,"tag":257,"props":330,"children":331},{"style":276},[332],{"type":176,"value":333}," useGlobalConfig",{"type":170,"tag":257,"props":335,"children":336},{"style":270},[337],{"type":176,"value":294},{"type":170,"tag":257,"props":339,"children":340},{"style":264},[341],{"type":176,"value":299},{"type":170,"tag":257,"props":343,"children":344},{"style":302},[345],{"type":176,"value":305},{"type":170,"tag":257,"props":347,"children":348},{"style":308},[349],{"type":176,"value":350},"../use-global-config",{"type":170,"tag":257,"props":352,"children":353},{"style":302},[354],{"type":176,"value":316},{"type":170,"tag":257,"props":356,"children":358},{"class":259,"line":357},3,[359],{"type":170,"tag":257,"props":360,"children":362},{"emptyLinePlaceholder":361},true,[363],{"type":176,"value":364},"\n",{"type":170,"tag":257,"props":366,"children":368},{"class":259,"line":367},4,[369,375,381,387,392,397,403],{"type":170,"tag":257,"props":370,"children":372},{"style":371},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[373],{"type":176,"value":374},"const",{"type":170,"tag":257,"props":376,"children":378},{"style":377},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[379],{"type":176,"value":380}," zIndex",{"type":170,"tag":257,"props":382,"children":384},{"style":383},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[385],{"type":176,"value":386}," =",{"type":170,"tag":257,"props":388,"children":390},{"style":389},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[391],{"type":176,"value":279},{"type":170,"tag":257,"props":393,"children":394},{"style":276},[395],{"type":176,"value":396},"(",{"type":170,"tag":257,"props":398,"children":400},{"style":399},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[401],{"type":176,"value":402},"0",{"type":170,"tag":257,"props":404,"children":405},{"style":276},[406],{"type":176,"value":407},")\n",{"type":170,"tag":257,"props":409,"children":411},{"class":259,"line":410},5,[412],{"type":170,"tag":257,"props":413,"children":414},{"emptyLinePlaceholder":361},[415],{"type":176,"value":364},{"type":170,"tag":257,"props":417,"children":419},{"class":259,"line":418},6,[420,425,430,436,440,445,450],{"type":170,"tag":257,"props":421,"children":422},{"style":264},[423],{"type":176,"value":424},"export",{"type":170,"tag":257,"props":426,"children":427},{"style":371},[428],{"type":176,"value":429}," const",{"type":170,"tag":257,"props":431,"children":433},{"style":432},"--shiki-light:#90A4AE;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[434],{"type":176,"value":435}," useZIndex",{"type":170,"tag":257,"props":437,"children":438},{"style":383},[439],{"type":176,"value":386},{"type":170,"tag":257,"props":441,"children":442},{"style":270},[443],{"type":176,"value":444}," ()",{"type":170,"tag":257,"props":446,"children":447},{"style":371},[448],{"type":176,"value":449}," =>",{"type":170,"tag":257,"props":451,"children":452},{"style":270},[453],{"type":176,"value":454}," {\n",{"type":170,"tag":257,"props":456,"children":458},{"class":259,"line":457},7,[459,464,469,473,477,482,487,492,496,500,505,510],{"type":170,"tag":257,"props":460,"children":461},{"style":371},[462],{"type":176,"value":463},"  const",{"type":170,"tag":257,"props":465,"children":466},{"style":377},[467],{"type":176,"value":468}," initialZIndex",{"type":170,"tag":257,"props":470,"children":471},{"style":383},[472],{"type":176,"value":386},{"type":170,"tag":257,"props":474,"children":475},{"style":389},[476],{"type":176,"value":333},{"type":170,"tag":257,"props":478,"children":480},{"style":479},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[481],{"type":176,"value":396},{"type":170,"tag":257,"props":483,"children":484},{"style":302},[485],{"type":176,"value":486},"'",{"type":170,"tag":257,"props":488,"children":489},{"style":308},[490],{"type":176,"value":491},"zIndex",{"type":170,"tag":257,"props":493,"children":494},{"style":302},[495],{"type":176,"value":486},{"type":170,"tag":257,"props":497,"children":498},{"style":270},[499],{"type":176,"value":284},{"type":170,"tag":257,"props":501,"children":502},{"style":399},[503],{"type":176,"value":504}," 2000",{"type":170,"tag":257,"props":506,"children":507},{"style":479},[508],{"type":176,"value":509},") ",{"type":170,"tag":257,"props":511,"children":513},{"style":512},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[514],{"type":176,"value":515},"// TODO: move to @element-plus/constants\n",{"type":170,"tag":257,"props":517,"children":519},{"class":259,"line":518},8,[520,524,529,533,537,541,546,550,554,559,564,569,573,577,581],{"type":170,"tag":257,"props":521,"children":522},{"style":371},[523],{"type":176,"value":463},{"type":170,"tag":257,"props":525,"children":526},{"style":377},[527],{"type":176,"value":528}," currentZIndex",{"type":170,"tag":257,"props":530,"children":531},{"style":383},[532],{"type":176,"value":386},{"type":170,"tag":257,"props":534,"children":535},{"style":389},[536],{"type":176,"value":289},{"type":170,"tag":257,"props":538,"children":539},{"style":479},[540],{"type":176,"value":396},{"type":170,"tag":257,"props":542,"children":543},{"style":270},[544],{"type":176,"value":545},"()",{"type":170,"tag":257,"props":547,"children":548},{"style":371},[549],{"type":176,"value":449},{"type":170,"tag":257,"props":551,"children":552},{"style":276},[553],{"type":176,"value":468},{"type":170,"tag":257,"props":555,"children":556},{"style":270},[557],{"type":176,"value":558},".",{"type":170,"tag":257,"props":560,"children":561},{"style":276},[562],{"type":176,"value":563},"value",{"type":170,"tag":257,"props":565,"children":566},{"style":383},[567],{"type":176,"value":568}," +",{"type":170,"tag":257,"props":570,"children":571},{"style":276},[572],{"type":176,"value":380},{"type":170,"tag":257,"props":574,"children":575},{"style":270},[576],{"type":176,"value":558},{"type":170,"tag":257,"props":578,"children":579},{"style":276},[580],{"type":176,"value":563},{"type":170,"tag":257,"props":582,"children":583},{"style":479},[584],{"type":176,"value":407},{"type":170,"tag":257,"props":586,"children":588},{"class":259,"line":587},9,[589],{"type":170,"tag":257,"props":590,"children":591},{"emptyLinePlaceholder":361},[592],{"type":176,"value":364},{"type":170,"tag":257,"props":594,"children":596},{"class":259,"line":595},10,[597,601,606,610,614,618],{"type":170,"tag":257,"props":598,"children":599},{"style":371},[600],{"type":176,"value":463},{"type":170,"tag":257,"props":602,"children":603},{"style":432},[604],{"type":176,"value":605}," nextZIndex",{"type":170,"tag":257,"props":607,"children":608},{"style":383},[609],{"type":176,"value":386},{"type":170,"tag":257,"props":611,"children":612},{"style":270},[613],{"type":176,"value":444},{"type":170,"tag":257,"props":615,"children":616},{"style":371},[617],{"type":176,"value":449},{"type":170,"tag":257,"props":619,"children":620},{"style":270},[621],{"type":176,"value":454},{"type":170,"tag":257,"props":623,"children":625},{"class":259,"line":624},11,[626,631,635,639],{"type":170,"tag":257,"props":627,"children":628},{"style":276},[629],{"type":176,"value":630},"    zIndex",{"type":170,"tag":257,"props":632,"children":633},{"style":270},[634],{"type":176,"value":558},{"type":170,"tag":257,"props":636,"children":637},{"style":276},[638],{"type":176,"value":563},{"type":170,"tag":257,"props":640,"children":641},{"style":383},[642],{"type":176,"value":643},"++\n",{"type":170,"tag":257,"props":645,"children":647},{"class":259,"line":646},12,[648,653,657,661],{"type":170,"tag":257,"props":649,"children":650},{"style":264},[651],{"type":176,"value":652},"    return",{"type":170,"tag":257,"props":654,"children":655},{"style":276},[656],{"type":176,"value":528},{"type":170,"tag":257,"props":658,"children":659},{"style":270},[660],{"type":176,"value":558},{"type":170,"tag":257,"props":662,"children":663},{"style":276},[664],{"type":176,"value":665},"value\n",{"type":170,"tag":257,"props":667,"children":669},{"class":259,"line":668},13,[670],{"type":170,"tag":257,"props":671,"children":672},{"style":270},[673],{"type":176,"value":674},"  }\n",{"type":170,"tag":257,"props":676,"children":678},{"class":259,"line":677},14,[679],{"type":170,"tag":257,"props":680,"children":681},{"emptyLinePlaceholder":361},[682],{"type":176,"value":364},{"type":170,"tag":257,"props":684,"children":686},{"class":259,"line":685},15,[687,692],{"type":170,"tag":257,"props":688,"children":689},{"style":264},[690],{"type":176,"value":691},"  return",{"type":170,"tag":257,"props":693,"children":694},{"style":270},[695],{"type":176,"value":454},{"type":170,"tag":257,"props":697,"children":699},{"class":259,"line":698},16,[700,705],{"type":170,"tag":257,"props":701,"children":702},{"style":276},[703],{"type":176,"value":704},"    initialZIndex",{"type":170,"tag":257,"props":706,"children":707},{"style":270},[708],{"type":176,"value":709},",\n",{"type":170,"tag":257,"props":711,"children":713},{"class":259,"line":712},17,[714,719],{"type":170,"tag":257,"props":715,"children":716},{"style":276},[717],{"type":176,"value":718},"    currentZIndex",{"type":170,"tag":257,"props":720,"children":721},{"style":270},[722],{"type":176,"value":709},{"type":170,"tag":257,"props":724,"children":726},{"class":259,"line":725},18,[727,732],{"type":170,"tag":257,"props":728,"children":729},{"style":276},[730],{"type":176,"value":731},"    nextZIndex",{"type":170,"tag":257,"props":733,"children":734},{"style":270},[735],{"type":176,"value":709},{"type":170,"tag":257,"props":737,"children":739},{"class":259,"line":738},19,[740],{"type":170,"tag":257,"props":741,"children":742},{"style":270},[743],{"type":176,"value":674},{"type":170,"tag":257,"props":745,"children":747},{"class":259,"line":746},20,[748],{"type":170,"tag":257,"props":749,"children":750},{"style":270},[751],{"type":176,"value":752},"}\n",{"type":170,"tag":179,"props":754,"children":755},{},[756],{"type":176,"value":757},"useZIndex 可以在任意 vue setup 中调用。调用后的回调提供了 initialZIndex、currentZIndex、nextZIndex 三个接口。initialZIndex 是通过 ElementConfigProvider 传入的 zIndex 初始值；用 currentZIndex 能拿到最新的 zIndex 值；用 nextZindex 可以给 zIndex 递增后获取其值，因为 zIndex 是全局的单例，所以使用 nextZIndex 拿到的值一定是全局最大的 zIndex。",{"type":170,"tag":246,"props":759,"children":762},{"className":760,"code":761,"language":311,"meta":164,"style":164},"language-vue shiki shiki-themes material-theme-lighter github-light github-dark monokai","\u003Ctemplate>\n  \u003Cdialog :style=\"{zIndex}\" />\n\u003C/template>\n\u003Cscript setup>\nconst { useZIndex } from \"../hooks/use-z-index\";\n// 这个 zIndex 一定是当前 element 中最大的 zIndex\nconst zIndex = useZIndex.nextZIndex();\n\u003C/script>\n",[763],{"type":170,"tag":253,"props":764,"children":765},{"__ignoreMap":164},[766,785,848,864,885,914,922,958],{"type":170,"tag":257,"props":767,"children":768},{"class":259,"line":260},[769,774,780],{"type":170,"tag":257,"props":770,"children":771},{"style":270},[772],{"type":176,"value":773},"\u003C",{"type":170,"tag":257,"props":775,"children":777},{"style":776},"--shiki-light:#E53935;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[778],{"type":176,"value":779},"template",{"type":170,"tag":257,"props":781,"children":782},{"style":270},[783],{"type":176,"value":784},">\n",{"type":170,"tag":257,"props":786,"children":787},{"class":259,"line":319},[788,793,798,803,809,814,820,825,829,834,838,844],{"type":170,"tag":257,"props":789,"children":790},{"style":270},[791],{"type":176,"value":792},"  \u003C",{"type":170,"tag":257,"props":794,"children":795},{"style":776},[796],{"type":176,"value":797},"dialog",{"type":170,"tag":257,"props":799,"children":800},{"style":270},[801],{"type":176,"value":802}," :",{"type":170,"tag":257,"props":804,"children":806},{"style":805},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[807],{"type":176,"value":808},"style",{"type":170,"tag":257,"props":810,"children":811},{"style":270},[812],{"type":176,"value":813},"=",{"type":170,"tag":257,"props":815,"children":817},{"style":816},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#F8F8F2",[818],{"type":176,"value":819},"\"",{"type":170,"tag":257,"props":821,"children":822},{"style":270},[823],{"type":176,"value":824},"{",{"type":170,"tag":257,"props":826,"children":827},{"style":276},[828],{"type":176,"value":491},{"type":170,"tag":257,"props":830,"children":831},{"style":270},[832],{"type":176,"value":833},"}",{"type":170,"tag":257,"props":835,"children":836},{"style":816},[837],{"type":176,"value":819},{"type":170,"tag":257,"props":839,"children":841},{"style":840},"--shiki-light:#39ADB5;--shiki-light-font-style:inherit;--shiki-default:#B31D28;--shiki-default-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;--shiki-sepia:#F44747;--shiki-sepia-font-style:inherit",[842],{"type":176,"value":843}," /",{"type":170,"tag":257,"props":845,"children":846},{"style":270},[847],{"type":176,"value":784},{"type":170,"tag":257,"props":849,"children":850},{"class":259,"line":357},[851,856,860],{"type":170,"tag":257,"props":852,"children":853},{"style":270},[854],{"type":176,"value":855},"\u003C/",{"type":170,"tag":257,"props":857,"children":858},{"style":776},[859],{"type":176,"value":779},{"type":170,"tag":257,"props":861,"children":862},{"style":270},[863],{"type":176,"value":784},{"type":170,"tag":257,"props":865,"children":866},{"class":259,"line":367},[867,871,876,881],{"type":170,"tag":257,"props":868,"children":869},{"style":270},[870],{"type":176,"value":773},{"type":170,"tag":257,"props":872,"children":873},{"style":776},[874],{"type":176,"value":875},"script",{"type":170,"tag":257,"props":877,"children":878},{"style":805},[879],{"type":176,"value":880}," setup",{"type":170,"tag":257,"props":882,"children":883},{"style":270},[884],{"type":176,"value":784},{"type":170,"tag":257,"props":886,"children":887},{"class":259,"line":410},[888,892,896,900,904,909],{"type":170,"tag":257,"props":889,"children":890},{"style":371},[891],{"type":176,"value":374},{"type":170,"tag":257,"props":893,"children":894},{"style":270},[895],{"type":176,"value":273},{"type":170,"tag":257,"props":897,"children":898},{"style":377},[899],{"type":176,"value":435},{"type":170,"tag":257,"props":901,"children":902},{"style":270},[903],{"type":176,"value":294},{"type":170,"tag":257,"props":905,"children":906},{"style":276},[907],{"type":176,"value":908}," from \"../hooks/use-z-index\"",{"type":170,"tag":257,"props":910,"children":911},{"style":270},[912],{"type":176,"value":913},";\n",{"type":170,"tag":257,"props":915,"children":916},{"class":259,"line":418},[917],{"type":170,"tag":257,"props":918,"children":919},{"style":512},[920],{"type":176,"value":921},"// 这个 zIndex 一定是当前 element 中最大的 zIndex\n",{"type":170,"tag":257,"props":923,"children":924},{"class":259,"line":457},[925,929,933,937,941,945,950,954],{"type":170,"tag":257,"props":926,"children":927},{"style":371},[928],{"type":176,"value":374},{"type":170,"tag":257,"props":930,"children":931},{"style":377},[932],{"type":176,"value":380},{"type":170,"tag":257,"props":934,"children":935},{"style":383},[936],{"type":176,"value":386},{"type":170,"tag":257,"props":938,"children":939},{"style":276},[940],{"type":176,"value":435},{"type":170,"tag":257,"props":942,"children":943},{"style":270},[944],{"type":176,"value":558},{"type":170,"tag":257,"props":946,"children":947},{"style":389},[948],{"type":176,"value":949},"nextZIndex",{"type":170,"tag":257,"props":951,"children":952},{"style":276},[953],{"type":176,"value":545},{"type":170,"tag":257,"props":955,"children":956},{"style":270},[957],{"type":176,"value":913},{"type":170,"tag":257,"props":959,"children":960},{"class":259,"line":518},[961,965,969],{"type":170,"tag":257,"props":962,"children":963},{"style":270},[964],{"type":176,"value":855},{"type":170,"tag":257,"props":966,"children":967},{"style":776},[968],{"type":176,"value":875},{"type":170,"tag":257,"props":970,"children":971},{"style":270},[972],{"type":176,"value":784},{"type":170,"tag":235,"props":974,"children":976},{"id":975},"思路分析",[977],{"type":176,"value":975},{"type":170,"tag":179,"props":979,"children":980},{},[981,983,989],{"type":176,"value":982},"既然在 element-plus 的内部能使用 ",{"type":170,"tag":253,"props":984,"children":986},{"className":985},[],[987],{"type":176,"value":988},"const { useZIndex } from ...",{"type":176,"value":990}," 的形式拿到 zIndex 管理器暴露的接口，那么在项目中是否能通过一样的方法得到它呢？",{"type":170,"tag":179,"props":992,"children":993},{},[994],{"type":176,"value":995},"答案是肯定的。通过观察 element 的默认导出可以发现其中有 useZIndex 的存在。",{"type":170,"tag":179,"props":997,"children":998},{},[999],{"type":170,"tag":219,"props":1000,"children":1003},{"alt":1001,"src":1002},"exports in element-plus","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220814195047.png",[],{"type":170,"tag":179,"props":1005,"children":1006},{},[1007],{"type":176,"value":1008},"解决多组件库统一层叠顺序问题的本质就是在项目的应用层再实现一个 zIndex 管理器。管理器需要接受来自不同组件库的 zIndex 管理器，并在任一管理器中的 zIndex 值发生变化时，把变化同步到其它管理器中。",{"type":170,"tag":179,"props":1010,"children":1011},{},[1012],{"type":176,"value":1013},"举个例子，我们在文章开头先使用 E1 打开了 dialog1 和 dialog2，使 E1 的 zIndex 从 2000 递增到 2001 再递增到 2002，如果再打开 E2 的 dialog3，我们希望 dialog3 的 zIndex 从 2002 递增到 2003，这也就意味着打开 dialog1 和 dialog2 时的 zIndex 递增需要从 E1 同步到 E2。",{"type":170,"tag":179,"props":1015,"children":1016},{},[1017],{"type":176,"value":1018},"既然 element 导出了 useZIndex，那问题就好办了。我们可以在项目中拿到 E1 以及 E2 的 useZIndex，用 vue watch 监听两个 useZIndex 回传的 currentZIndex 接口，并把小的那个 zIndex（对应上述 E2）通过 nextZIndex 接口递增到大的（对应上述 E1）。这样一来，E1 和 E2 的 zIndex 就相等，在下一次打开弹窗时，无论是使用 E1 还是使用 E2 的弹窗，其 zIndex 值都能保证在项目中最大。",{"type":170,"tag":235,"props":1020,"children":1022},{"id":1021},"代码实现",[1023],{"type":176,"value":1021},{"type":170,"tag":179,"props":1025,"children":1026},{},[1027],{"type":176,"value":1028},"代码实现时，团队的小伙伴写了以下代码，这段代码非常好理解，这里就不细说了。",{"type":170,"tag":246,"props":1030,"children":1032},{"className":248,"code":1031,"language":250,"meta":164,"style":164},"watch([\n  () => e1ZIndexContext.currentZIndex.value,\n  () => e2ZIndexContext.currentZIndex.value,\n], ([z1, z2]) => {\n  if (z1 \u003C z2) {\n    e1ZIndexContext.nextZIndex()\n  } else {\n    e2ZIndexContext.nextZIndex()\n  }\n})\n",[1033],{"type":170,"tag":253,"props":1034,"children":1035},{"__ignoreMap":164},[1036,1049,1087,1123,1168,1203,1224,1241,1261,1268],{"type":170,"tag":257,"props":1037,"children":1038},{"class":259,"line":260},[1039,1044],{"type":170,"tag":257,"props":1040,"children":1041},{"style":389},[1042],{"type":176,"value":1043},"watch",{"type":170,"tag":257,"props":1045,"children":1046},{"style":276},[1047],{"type":176,"value":1048},"([\n",{"type":170,"tag":257,"props":1050,"children":1051},{"class":259,"line":319},[1052,1057,1061,1066,1070,1075,1079,1083],{"type":170,"tag":257,"props":1053,"children":1054},{"style":270},[1055],{"type":176,"value":1056},"  ()",{"type":170,"tag":257,"props":1058,"children":1059},{"style":371},[1060],{"type":176,"value":449},{"type":170,"tag":257,"props":1062,"children":1063},{"style":276},[1064],{"type":176,"value":1065}," e1ZIndexContext",{"type":170,"tag":257,"props":1067,"children":1068},{"style":270},[1069],{"type":176,"value":558},{"type":170,"tag":257,"props":1071,"children":1072},{"style":276},[1073],{"type":176,"value":1074},"currentZIndex",{"type":170,"tag":257,"props":1076,"children":1077},{"style":270},[1078],{"type":176,"value":558},{"type":170,"tag":257,"props":1080,"children":1081},{"style":276},[1082],{"type":176,"value":563},{"type":170,"tag":257,"props":1084,"children":1085},{"style":270},[1086],{"type":176,"value":709},{"type":170,"tag":257,"props":1088,"children":1089},{"class":259,"line":357},[1090,1094,1098,1103,1107,1111,1115,1119],{"type":170,"tag":257,"props":1091,"children":1092},{"style":270},[1093],{"type":176,"value":1056},{"type":170,"tag":257,"props":1095,"children":1096},{"style":371},[1097],{"type":176,"value":449},{"type":170,"tag":257,"props":1099,"children":1100},{"style":276},[1101],{"type":176,"value":1102}," e2ZIndexContext",{"type":170,"tag":257,"props":1104,"children":1105},{"style":270},[1106],{"type":176,"value":558},{"type":170,"tag":257,"props":1108,"children":1109},{"style":276},[1110],{"type":176,"value":1074},{"type":170,"tag":257,"props":1112,"children":1113},{"style":270},[1114],{"type":176,"value":558},{"type":170,"tag":257,"props":1116,"children":1117},{"style":276},[1118],{"type":176,"value":563},{"type":170,"tag":257,"props":1120,"children":1121},{"style":270},[1122],{"type":176,"value":709},{"type":170,"tag":257,"props":1124,"children":1125},{"class":259,"line":367},[1126,1131,1135,1140,1146,1150,1155,1160,1164],{"type":170,"tag":257,"props":1127,"children":1128},{"style":276},[1129],{"type":176,"value":1130},"]",{"type":170,"tag":257,"props":1132,"children":1133},{"style":270},[1134],{"type":176,"value":284},{"type":170,"tag":257,"props":1136,"children":1137},{"style":270},[1138],{"type":176,"value":1139}," ([",{"type":170,"tag":257,"props":1141,"children":1143},{"style":1142},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[1144],{"type":176,"value":1145},"z1",{"type":170,"tag":257,"props":1147,"children":1148},{"style":270},[1149],{"type":176,"value":284},{"type":170,"tag":257,"props":1151,"children":1152},{"style":1142},[1153],{"type":176,"value":1154}," z2",{"type":170,"tag":257,"props":1156,"children":1157},{"style":270},[1158],{"type":176,"value":1159},"])",{"type":170,"tag":257,"props":1161,"children":1162},{"style":371},[1163],{"type":176,"value":449},{"type":170,"tag":257,"props":1165,"children":1166},{"style":270},[1167],{"type":176,"value":454},{"type":170,"tag":257,"props":1169,"children":1170},{"class":259,"line":410},[1171,1176,1181,1185,1190,1194,1198],{"type":170,"tag":257,"props":1172,"children":1173},{"style":264},[1174],{"type":176,"value":1175},"  if",{"type":170,"tag":257,"props":1177,"children":1178},{"style":479},[1179],{"type":176,"value":1180}," (",{"type":170,"tag":257,"props":1182,"children":1183},{"style":276},[1184],{"type":176,"value":1145},{"type":170,"tag":257,"props":1186,"children":1187},{"style":383},[1188],{"type":176,"value":1189}," \u003C",{"type":170,"tag":257,"props":1191,"children":1192},{"style":276},[1193],{"type":176,"value":1154},{"type":170,"tag":257,"props":1195,"children":1196},{"style":479},[1197],{"type":176,"value":509},{"type":170,"tag":257,"props":1199,"children":1200},{"style":270},[1201],{"type":176,"value":1202},"{\n",{"type":170,"tag":257,"props":1204,"children":1205},{"class":259,"line":418},[1206,1211,1215,1219],{"type":170,"tag":257,"props":1207,"children":1208},{"style":276},[1209],{"type":176,"value":1210},"    e1ZIndexContext",{"type":170,"tag":257,"props":1212,"children":1213},{"style":270},[1214],{"type":176,"value":558},{"type":170,"tag":257,"props":1216,"children":1217},{"style":389},[1218],{"type":176,"value":949},{"type":170,"tag":257,"props":1220,"children":1221},{"style":479},[1222],{"type":176,"value":1223},"()\n",{"type":170,"tag":257,"props":1225,"children":1226},{"class":259,"line":457},[1227,1232,1237],{"type":170,"tag":257,"props":1228,"children":1229},{"style":270},[1230],{"type":176,"value":1231},"  }",{"type":170,"tag":257,"props":1233,"children":1234},{"style":264},[1235],{"type":176,"value":1236}," else",{"type":170,"tag":257,"props":1238,"children":1239},{"style":270},[1240],{"type":176,"value":454},{"type":170,"tag":257,"props":1242,"children":1243},{"class":259,"line":518},[1244,1249,1253,1257],{"type":170,"tag":257,"props":1245,"children":1246},{"style":276},[1247],{"type":176,"value":1248},"    e2ZIndexContext",{"type":170,"tag":257,"props":1250,"children":1251},{"style":270},[1252],{"type":176,"value":558},{"type":170,"tag":257,"props":1254,"children":1255},{"style":389},[1256],{"type":176,"value":949},{"type":170,"tag":257,"props":1258,"children":1259},{"style":479},[1260],{"type":176,"value":1223},{"type":170,"tag":257,"props":1262,"children":1263},{"class":259,"line":587},[1264],{"type":170,"tag":257,"props":1265,"children":1266},{"style":270},[1267],{"type":176,"value":674},{"type":170,"tag":257,"props":1269,"children":1270},{"class":259,"line":595},[1271,1275],{"type":170,"tag":257,"props":1272,"children":1273},{"style":270},[1274],{"type":176,"value":833},{"type":170,"tag":257,"props":1276,"children":1277},{"style":276},[1278],{"type":176,"value":407},{"type":170,"tag":179,"props":1280,"children":1281},{},[1282],{"type":176,"value":1283},"需要注意的是，可能有非常多组件依赖了 useZIndex 的内部的响应式值，所以直接使用 watch 暴力递增 zIndex 是有问题的。想象一下，每递增一次，相关 vue 组件会被收集到等待更新的队列中，如果 z1 和 z2 的差值很大，容易报栈溢出问题。好在解决方式也非常简单，使用 nextTick 分担每个 tick 的任务，并在回调中，根据最新的 zIndex 值进行 zIndex 递增就行了。",{"type":170,"tag":246,"props":1285,"children":1287},{"className":248,"code":1286,"language":250,"meta":164,"style":164},"const { watch, nextTick } from \"vue\"\nconst unwatch = null\n\nexport function useSameZIndex(ctx1, ctx2) {\n  unwatch && unwatch()\n  unwatch = watch([\n    () => ctx1.currentZIndex.value,\n    () => ctx2.currentZIndex.value,\n  ], ([z1, z2]) => nextTick(() => {\n    const [nz1, nz2] = [\n      ctx1.currentZIndex.value,\n      ctx2.currentZIndex.value\n    ]\n    if (nz1 \u003C nz2) {\n      ctx1.nextZIndex()\n    } else {\n      ctx2.nextZIndex()\n    }\n  })\n}\n",[1288],{"type":170,"tag":253,"props":1289,"children":1290},{"__ignoreMap":164},[1291,1325,1347,1354,1398,1419,1438,1475,1510,1566,1606,1634,1658,1666,1698,1717,1733,1752,1760,1771],{"type":170,"tag":257,"props":1292,"children":1293},{"class":259,"line":260},[1294,1298,1302,1307,1311,1316,1320],{"type":170,"tag":257,"props":1295,"children":1296},{"style":371},[1297],{"type":176,"value":374},{"type":170,"tag":257,"props":1299,"children":1300},{"style":270},[1301],{"type":176,"value":273},{"type":170,"tag":257,"props":1303,"children":1304},{"style":377},[1305],{"type":176,"value":1306}," watch",{"type":170,"tag":257,"props":1308,"children":1309},{"style":270},[1310],{"type":176,"value":284},{"type":170,"tag":257,"props":1312,"children":1313},{"style":377},[1314],{"type":176,"value":1315}," nextTick",{"type":170,"tag":257,"props":1317,"children":1318},{"style":270},[1319],{"type":176,"value":294},{"type":170,"tag":257,"props":1321,"children":1322},{"style":276},[1323],{"type":176,"value":1324}," from \"vue\"\n",{"type":170,"tag":257,"props":1326,"children":1327},{"class":259,"line":319},[1328,1332,1337,1341],{"type":170,"tag":257,"props":1329,"children":1330},{"style":371},[1331],{"type":176,"value":374},{"type":170,"tag":257,"props":1333,"children":1334},{"style":377},[1335],{"type":176,"value":1336}," unwatch",{"type":170,"tag":257,"props":1338,"children":1339},{"style":383},[1340],{"type":176,"value":386},{"type":170,"tag":257,"props":1342,"children":1344},{"style":1343},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1345],{"type":176,"value":1346}," null\n",{"type":170,"tag":257,"props":1348,"children":1349},{"class":259,"line":357},[1350],{"type":170,"tag":257,"props":1351,"children":1352},{"emptyLinePlaceholder":361},[1353],{"type":176,"value":364},{"type":170,"tag":257,"props":1355,"children":1356},{"class":259,"line":367},[1357,1361,1366,1371,1375,1380,1384,1389,1394],{"type":170,"tag":257,"props":1358,"children":1359},{"style":264},[1360],{"type":176,"value":424},{"type":170,"tag":257,"props":1362,"children":1363},{"style":371},[1364],{"type":176,"value":1365}," function",{"type":170,"tag":257,"props":1367,"children":1368},{"style":389},[1369],{"type":176,"value":1370}," useSameZIndex",{"type":170,"tag":257,"props":1372,"children":1373},{"style":270},[1374],{"type":176,"value":396},{"type":170,"tag":257,"props":1376,"children":1377},{"style":1142},[1378],{"type":176,"value":1379},"ctx1",{"type":170,"tag":257,"props":1381,"children":1382},{"style":270},[1383],{"type":176,"value":284},{"type":170,"tag":257,"props":1385,"children":1386},{"style":1142},[1387],{"type":176,"value":1388}," ctx2",{"type":170,"tag":257,"props":1390,"children":1391},{"style":270},[1392],{"type":176,"value":1393},")",{"type":170,"tag":257,"props":1395,"children":1396},{"style":270},[1397],{"type":176,"value":454},{"type":170,"tag":257,"props":1399,"children":1400},{"class":259,"line":410},[1401,1406,1411,1415],{"type":170,"tag":257,"props":1402,"children":1403},{"style":276},[1404],{"type":176,"value":1405},"  unwatch",{"type":170,"tag":257,"props":1407,"children":1408},{"style":383},[1409],{"type":176,"value":1410}," &&",{"type":170,"tag":257,"props":1412,"children":1413},{"style":389},[1414],{"type":176,"value":1336},{"type":170,"tag":257,"props":1416,"children":1417},{"style":479},[1418],{"type":176,"value":1223},{"type":170,"tag":257,"props":1420,"children":1421},{"class":259,"line":418},[1422,1426,1430,1434],{"type":170,"tag":257,"props":1423,"children":1424},{"style":276},[1425],{"type":176,"value":1405},{"type":170,"tag":257,"props":1427,"children":1428},{"style":383},[1429],{"type":176,"value":386},{"type":170,"tag":257,"props":1431,"children":1432},{"style":389},[1433],{"type":176,"value":1306},{"type":170,"tag":257,"props":1435,"children":1436},{"style":479},[1437],{"type":176,"value":1048},{"type":170,"tag":257,"props":1439,"children":1440},{"class":259,"line":457},[1441,1446,1450,1455,1459,1463,1467,1471],{"type":170,"tag":257,"props":1442,"children":1443},{"style":270},[1444],{"type":176,"value":1445},"    ()",{"type":170,"tag":257,"props":1447,"children":1448},{"style":371},[1449],{"type":176,"value":449},{"type":170,"tag":257,"props":1451,"children":1452},{"style":276},[1453],{"type":176,"value":1454}," ctx1",{"type":170,"tag":257,"props":1456,"children":1457},{"style":270},[1458],{"type":176,"value":558},{"type":170,"tag":257,"props":1460,"children":1461},{"style":276},[1462],{"type":176,"value":1074},{"type":170,"tag":257,"props":1464,"children":1465},{"style":270},[1466],{"type":176,"value":558},{"type":170,"tag":257,"props":1468,"children":1469},{"style":276},[1470],{"type":176,"value":563},{"type":170,"tag":257,"props":1472,"children":1473},{"style":270},[1474],{"type":176,"value":709},{"type":170,"tag":257,"props":1476,"children":1477},{"class":259,"line":518},[1478,1482,1486,1490,1494,1498,1502,1506],{"type":170,"tag":257,"props":1479,"children":1480},{"style":270},[1481],{"type":176,"value":1445},{"type":170,"tag":257,"props":1483,"children":1484},{"style":371},[1485],{"type":176,"value":449},{"type":170,"tag":257,"props":1487,"children":1488},{"style":276},[1489],{"type":176,"value":1388},{"type":170,"tag":257,"props":1491,"children":1492},{"style":270},[1493],{"type":176,"value":558},{"type":170,"tag":257,"props":1495,"children":1496},{"style":276},[1497],{"type":176,"value":1074},{"type":170,"tag":257,"props":1499,"children":1500},{"style":270},[1501],{"type":176,"value":558},{"type":170,"tag":257,"props":1503,"children":1504},{"style":276},[1505],{"type":176,"value":563},{"type":170,"tag":257,"props":1507,"children":1508},{"style":270},[1509],{"type":176,"value":709},{"type":170,"tag":257,"props":1511,"children":1512},{"class":259,"line":587},[1513,1518,1522,1526,1530,1534,1538,1542,1546,1550,1554,1558,1562],{"type":170,"tag":257,"props":1514,"children":1515},{"style":479},[1516],{"type":176,"value":1517},"  ]",{"type":170,"tag":257,"props":1519,"children":1520},{"style":270},[1521],{"type":176,"value":284},{"type":170,"tag":257,"props":1523,"children":1524},{"style":270},[1525],{"type":176,"value":1139},{"type":170,"tag":257,"props":1527,"children":1528},{"style":1142},[1529],{"type":176,"value":1145},{"type":170,"tag":257,"props":1531,"children":1532},{"style":270},[1533],{"type":176,"value":284},{"type":170,"tag":257,"props":1535,"children":1536},{"style":1142},[1537],{"type":176,"value":1154},{"type":170,"tag":257,"props":1539,"children":1540},{"style":270},[1541],{"type":176,"value":1159},{"type":170,"tag":257,"props":1543,"children":1544},{"style":371},[1545],{"type":176,"value":449},{"type":170,"tag":257,"props":1547,"children":1548},{"style":389},[1549],{"type":176,"value":1315},{"type":170,"tag":257,"props":1551,"children":1552},{"style":479},[1553],{"type":176,"value":396},{"type":170,"tag":257,"props":1555,"children":1556},{"style":270},[1557],{"type":176,"value":545},{"type":170,"tag":257,"props":1559,"children":1560},{"style":371},[1561],{"type":176,"value":449},{"type":170,"tag":257,"props":1563,"children":1564},{"style":270},[1565],{"type":176,"value":454},{"type":170,"tag":257,"props":1567,"children":1568},{"class":259,"line":595},[1569,1574,1579,1584,1588,1593,1597,1601],{"type":170,"tag":257,"props":1570,"children":1571},{"style":371},[1572],{"type":176,"value":1573},"    const",{"type":170,"tag":257,"props":1575,"children":1576},{"style":270},[1577],{"type":176,"value":1578}," [",{"type":170,"tag":257,"props":1580,"children":1581},{"style":377},[1582],{"type":176,"value":1583},"nz1",{"type":170,"tag":257,"props":1585,"children":1586},{"style":270},[1587],{"type":176,"value":284},{"type":170,"tag":257,"props":1589,"children":1590},{"style":377},[1591],{"type":176,"value":1592}," nz2",{"type":170,"tag":257,"props":1594,"children":1595},{"style":270},[1596],{"type":176,"value":1130},{"type":170,"tag":257,"props":1598,"children":1599},{"style":383},[1600],{"type":176,"value":386},{"type":170,"tag":257,"props":1602,"children":1603},{"style":479},[1604],{"type":176,"value":1605}," [\n",{"type":170,"tag":257,"props":1607,"children":1608},{"class":259,"line":624},[1609,1614,1618,1622,1626,1630],{"type":170,"tag":257,"props":1610,"children":1611},{"style":276},[1612],{"type":176,"value":1613},"      ctx1",{"type":170,"tag":257,"props":1615,"children":1616},{"style":270},[1617],{"type":176,"value":558},{"type":170,"tag":257,"props":1619,"children":1620},{"style":276},[1621],{"type":176,"value":1074},{"type":170,"tag":257,"props":1623,"children":1624},{"style":270},[1625],{"type":176,"value":558},{"type":170,"tag":257,"props":1627,"children":1628},{"style":276},[1629],{"type":176,"value":563},{"type":170,"tag":257,"props":1631,"children":1632},{"style":270},[1633],{"type":176,"value":709},{"type":170,"tag":257,"props":1635,"children":1636},{"class":259,"line":646},[1637,1642,1646,1650,1654],{"type":170,"tag":257,"props":1638,"children":1639},{"style":276},[1640],{"type":176,"value":1641},"      ctx2",{"type":170,"tag":257,"props":1643,"children":1644},{"style":270},[1645],{"type":176,"value":558},{"type":170,"tag":257,"props":1647,"children":1648},{"style":276},[1649],{"type":176,"value":1074},{"type":170,"tag":257,"props":1651,"children":1652},{"style":270},[1653],{"type":176,"value":558},{"type":170,"tag":257,"props":1655,"children":1656},{"style":276},[1657],{"type":176,"value":665},{"type":170,"tag":257,"props":1659,"children":1660},{"class":259,"line":668},[1661],{"type":170,"tag":257,"props":1662,"children":1663},{"style":479},[1664],{"type":176,"value":1665},"    ]\n",{"type":170,"tag":257,"props":1667,"children":1668},{"class":259,"line":677},[1669,1674,1678,1682,1686,1690,1694],{"type":170,"tag":257,"props":1670,"children":1671},{"style":264},[1672],{"type":176,"value":1673},"    if",{"type":170,"tag":257,"props":1675,"children":1676},{"style":479},[1677],{"type":176,"value":1180},{"type":170,"tag":257,"props":1679,"children":1680},{"style":276},[1681],{"type":176,"value":1583},{"type":170,"tag":257,"props":1683,"children":1684},{"style":383},[1685],{"type":176,"value":1189},{"type":170,"tag":257,"props":1687,"children":1688},{"style":276},[1689],{"type":176,"value":1592},{"type":170,"tag":257,"props":1691,"children":1692},{"style":479},[1693],{"type":176,"value":509},{"type":170,"tag":257,"props":1695,"children":1696},{"style":270},[1697],{"type":176,"value":1202},{"type":170,"tag":257,"props":1699,"children":1700},{"class":259,"line":685},[1701,1705,1709,1713],{"type":170,"tag":257,"props":1702,"children":1703},{"style":276},[1704],{"type":176,"value":1613},{"type":170,"tag":257,"props":1706,"children":1707},{"style":270},[1708],{"type":176,"value":558},{"type":170,"tag":257,"props":1710,"children":1711},{"style":389},[1712],{"type":176,"value":949},{"type":170,"tag":257,"props":1714,"children":1715},{"style":479},[1716],{"type":176,"value":1223},{"type":170,"tag":257,"props":1718,"children":1719},{"class":259,"line":698},[1720,1725,1729],{"type":170,"tag":257,"props":1721,"children":1722},{"style":270},[1723],{"type":176,"value":1724},"    }",{"type":170,"tag":257,"props":1726,"children":1727},{"style":264},[1728],{"type":176,"value":1236},{"type":170,"tag":257,"props":1730,"children":1731},{"style":270},[1732],{"type":176,"value":454},{"type":170,"tag":257,"props":1734,"children":1735},{"class":259,"line":712},[1736,1740,1744,1748],{"type":170,"tag":257,"props":1737,"children":1738},{"style":276},[1739],{"type":176,"value":1641},{"type":170,"tag":257,"props":1741,"children":1742},{"style":270},[1743],{"type":176,"value":558},{"type":170,"tag":257,"props":1745,"children":1746},{"style":389},[1747],{"type":176,"value":949},{"type":170,"tag":257,"props":1749,"children":1750},{"style":479},[1751],{"type":176,"value":1223},{"type":170,"tag":257,"props":1753,"children":1754},{"class":259,"line":725},[1755],{"type":170,"tag":257,"props":1756,"children":1757},{"style":270},[1758],{"type":176,"value":1759},"    }\n",{"type":170,"tag":257,"props":1761,"children":1762},{"class":259,"line":738},[1763,1767],{"type":170,"tag":257,"props":1764,"children":1765},{"style":270},[1766],{"type":176,"value":1231},{"type":170,"tag":257,"props":1768,"children":1769},{"style":479},[1770],{"type":176,"value":407},{"type":170,"tag":257,"props":1772,"children":1773},{"class":259,"line":746},[1774],{"type":170,"tag":257,"props":1775,"children":1776},{"style":479},[1777],{"type":176,"value":752},{"type":170,"tag":171,"props":1779,"children":1781},{"id":1780},"更多",[1782],{"type":176,"value":1780},{"type":170,"tag":179,"props":1784,"children":1785},{},[1786,1788,1796],{"type":176,"value":1787},"以上分享的代码略为简单，想深入探索的话推荐直接看 element-plus 相关组件的源码，如 ",{"type":170,"tag":204,"props":1789,"children":1793},{"href":1790,"rel":1791},"https://github.com/element-plus/element-plus/blob/6503e5527715a6424433df0ff523b8910e891033/packages/components/message-box/src/index.vue",[1792],"nofollow",[1794],{"type":176,"value":1795},"message-box",{"type":176,"value":1797},"。虽然文中仅介绍了如何 watch 并递增管理器中的 zIndex 值，但是在实际项目开发时的使用场景肯定更加复杂，比方说，在 element-plus 上层封装业务 UI 库时可能会要用到全屏组件或是购物车等业务弹窗，那么这些库在全局的 zIndex 管理实际也可以使用 element-plus 的这套。总之，要活学活用嘛...",{"type":170,"tag":1799,"props":1800,"children":1803},"section",{"className":1801,"dataFootnotes":164},[1802],"footnotes",[1804,1811],{"type":170,"tag":171,"props":1805,"children":1808},{"className":1806,"id":208},[1807],"sr-only",[1809],{"type":176,"value":1810},"Footnotes",{"type":170,"tag":1812,"props":1813,"children":1814},"ol",{},[1815],{"type":170,"tag":1816,"props":1817,"children":1819},"li",{"id":1818},"user-content-fn-append-to-body",[1820,1822],{"type":176,"value":1821},"为了降低复杂度，这里只考虑将弹窗 teleport 到 body 中的情况。 ",{"type":170,"tag":204,"props":1823,"children":1828},{"href":1824,"ariaLabel":1825,"className":1826,"dataFootnoteBackref":164},"#user-content-fnref-append-to-body","Back to reference 1",[1827],"data-footnote-backref",[1829],{"type":176,"value":1830},"↩",{"type":170,"tag":808,"props":1832,"children":1833},{},[1834],{"type":176,"value":1835},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":164,"searchDepth":319,"depth":319,"links":1837},[1838,1839,1840,1841,1842],{"id":173,"depth":319,"text":177},{"id":186,"depth":319,"text":186},{"id":226,"depth":319,"text":226},{"id":1780,"depth":319,"text":1780},{"id":208,"depth":319,"text":1810},"markdown","content:2.articles:1104.zindex-manager.md","content","2.articles/1104.zindex-manager.md","2.articles/1104.zindex-manager","md",[1850,1852],{"_path":64,"title":63,"description":1851},"如何自定义 antd-table、vxe-table 等复杂组件的滚动条？",{"_path":70,"title":69,"description":1853},"如何破解滑块验证码？本文介绍使用Puppeteer操作浏览器进行图片对比、图片识别及优化鼠标轨迹以模仿真是用户等几种简单爬虫验证码破解思路，适用多种场景。",1754391498692]