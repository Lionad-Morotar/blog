[{"data":1,"prerenderedAt":2075},["Reactive",2],{"navigation":3,"/articles/zindex-manager":383,"/articles/zindex-manager-surround":2070},[4,32,80,96,123,129,135,366,372,378],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":42,"_path":43},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":45,"_path":46},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":48,"_path":49},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":51,"_path":52},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":54,"_path":55},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":57,"_path":58},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":60,"_path":61},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":63,"_path":64},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":66,"_path":67},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":69,"_path":70},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":72,"_path":73},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":75,"_path":76},"🚝 四十二篇系列","/articles/fourty-two",{"title":78,"_path":79},"📝 技术博客归档","/articles/fold",{"title":81,"_path":82,"children":83},"造物 / Make","/tools",[84,87,90,93],{"title":85,"_path":86},"🌐 AnySort","/tools/anysort",{"title":88,"_path":89},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":91,"_path":92},"👓 Crapto","/tools/crypto-inline",{"title":94,"_path":95},"🖨️ any-to-base64","/tools/any-to-base64",{"title":97,"_path":98,"children":99},"吉他剧场 / Music","/music",[100,102,105,108,111,114,117,120],{"title":101,"_path":98},"🎸 FingerStyle！",{"title":103,"_path":104},"🌬️ 等待的风","/music/wind",{"title":106,"_path":107},"💕 约定的海洋","/music/ocean",{"title":109,"_path":110},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":112,"_path":113},"🌏 残酷天使的行动纲领","/music/eva",{"title":115,"_path":116},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":118,"_path":119},"🍷 Wu Wei","/music/wu-wei",{"title":121,"_path":122},"🌅 无题","/music/untitled",{"title":124,"_path":125,"children":126},"画点什么 / Paint","/paint",[127],{"title":128,"_path":125},"🚧 正在施工",{"title":130,"_path":131,"children":132},"知识地图 / Maps","/maps",[133],{"title":134,"_path":131},"🏁 知识地图",{"title":136,"_path":137,"children":138},"零散的笔记 / Gists","/gists",[139,141,144,147,150,153,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363],{"title":140,"_path":137},"🧊 Gists",{"title":142,"_path":143},"网站的可访问性","/gists/accessibility",{"title":145,"_path":146},"图片模糊","/gists/blur",{"title":148,"_path":149},"渲染相关笔记","/gists/c4d",{"title":151,"_path":152},"CDN 问题记录","/gists/cdn",{"title":154,"_path":155},"消毒剂","/gists/cleaner",{"title":157,"_path":158},"Windows Command","/gists/cmd",{"title":160,"_path":161},"Command","/gists/command",{"title":163,"_path":164},"复杂科学","/gists/complexity-science",{"title":166,"_path":167},"宇宙","/gists/cosmos",{"title":169,"_path":170},"C++","/gists/cpp",{"title":172,"_path":173},"Data Structure","/gists/data-structure",{"title":175,"_path":176},"DEPRESSION","/gists/depression",{"title":178,"_path":179},"设计模式","/gists/design-patterns",{"title":181,"_path":182},"Developer Experience","/gists/developer-experience",{"title":184,"_path":185},"Device Metrics","/gists/device-metrix",{"title":187,"_path":188},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":190,"_path":191},"正则表达式","/gists/eegex",{"title":193,"_path":194},"Emoji","/gists/emoji",{"title":196,"_path":197},"工程","/gists/engineering",{"title":199,"_path":200},"熵","/gists/entropy",{"title":202,"_path":203},"Environment","/gists/environment",{"title":205,"_path":206},"Erlang","/gists/erlang",{"title":208,"_path":209},"逃离塔克夫","/gists/escape-from-tarkov",{"title":211,"_path":212},"ESNext (ES6-ES11)","/gists/esnext",{"title":214,"_path":215},"Eval！","/gists/eval",{"title":217,"_path":218},"Flutter","/gists/flutter",{"title":220,"_path":221},"字体","/gists/font",{"title":223,"_path":224},"JS 函数式编程","/gists/functional",{"title":226,"_path":227},"Google C++ Standard","/gists/google-cpp-standard",{"title":229,"_path":230},"双向链接完全体","/gists/graph",{"title":232,"_path":233},"Hardwares","/gists/hardwares",{"title":235,"_path":236},"哈希冲突","/gists/hash-collision",{"title":238,"_path":239},"信息设计","/gists/information-design",{"title":241,"_path":242},"InstantPage","/gists/instant.page",{"title":244,"_path":245},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":247,"_path":248},"KVStore","/gists/key-value-db",{"title":250,"_path":251},"Kubernetes","/gists/kubernetes",{"title":253,"_path":254},"Makefile","/gists/makefile",{"title":256,"_path":257},"Markdown Inline Style","/gists/markdown-nice",{"title":259,"_path":260},"小程序","/gists/miniapp",{"title":262,"_path":263},"减小页面快照体积","/gists/minify-html",{"title":265,"_path":266},"mklink","/gists/mklink",{"title":268,"_path":269},"Mock","/gists/mock",{"title":271,"_path":272},"多端应用","/gists/multy-end-app",{"title":274,"_path":275},"神经科学","/gists/neuroscience",{"title":277,"_path":278},"OO","/gists/oo",{"title":280,"_path":281},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":283,"_path":284},"人物","/gists/person",{"title":286,"_path":287},"PInvoke","/gists/pinvoke",{"title":289,"_path":290},"像素","/gists/pixel",{"title":292,"_path":293},"PowerShell","/gists/powershell",{"title":295,"_path":296},"量子","/gists/quantum",{"title":298,"_path":299},"保持好奇心","/gists/questions",{"title":301,"_path":302},"React Native","/gists/react-native",{"title":304,"_path":305},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":307,"_path":308},"SEO","/gists/seo",{"title":310,"_path":311},"Shader","/gists/shader",{"title":313,"_path":314},"Shape Up","/gists/shape-up",{"title":316,"_path":317},"睡觉","/gists/sleep",{"title":319,"_path":320},"States","/gists/states",{"title":322,"_path":323},"Storage","/gists/storage",{"title":325,"_path":326},"音视频流处理","/gists/stream-cli",{"title":328,"_path":329},"Symbol","/gists/symbol",{"title":331,"_path":332},"系统论","/gists/systems-theory",{"title":334,"_path":335},"Taro","/gists/taro",{"title":337,"_path":338},"任务切片","/gists/task-slice",{"title":340,"_path":341},"技术偏好","/gists/tech-dudge",{"title":343,"_path":344},"Untitled","/gists/untitled",{"title":346,"_path":347},"可变字体","/gists/variable-font",{"title":349,"_path":350},"视觉错觉","/gists/visual-illusion",{"title":352,"_path":353},"SS(SSR)","/gists/vpn",{"title":355,"_path":356},"VS Code 插件开发","/gists/vscode-plugin",{"title":358,"_path":359},"Web Components","/gists/web-components",{"title":361,"_path":362},"Windows","/gists/windows",{"title":364,"_path":365},"查缺补漏","/gists/wrong",{"title":367,"_path":368,"children":369},"代码笔记 / Gists","/source-code",[370],{"title":371,"_path":368},"🚄 代码笔记",{"title":373,"_path":374,"children":375},"我 / Abount","/hire",[376],{"title":377,"_path":374},"📬 技术简历",{"title":379,"_path":380,"children":381},"todo","/todo",[382],{"title":379,"_path":380},{"_path":52,"_dir":384,"_draft":385,"_partial":385,"_locale":386,"title":51,"description":387,"body":388,"_type":2065,"_id":2066,"_source":2067,"_file":2068,"_extension":2069},"articles",false,"","使用 element-plus 内的层级管理器可以解决多组件库间层级不统一的问题",{"type":389,"children":390,"toc":2058},"root",[391,400,406,411,416,437,446,451,456,462,467,975,980,1195,1200,1213,1218,1226,1231,1236,1241,1246,1251,1501,1506,2000,2005,2020,2053],{"type":392,"tag":393,"props":394,"children":396},"element","h2",{"id":395},"增订-2022年9月5日",[397],{"type":398,"value":399},"text","增订 | 2022年9月5日",{"type":392,"tag":401,"props":402,"children":403},"p",{},[404],{"type":398,"value":405},"终于把两个 ElementPlus 实例干得只剩了一个，也顺带解决了一些项目中出现的稀奇古怪的问题。不过，这里容我吐槽一句，目前来说 ElementPlus 的问题是真的多，因为遇见 A 问题所以升级 Element 版本却引起了 B 问题这种情况屡见不鲜。我经常对着问题一调试就是两三个小时，恍惚之间就下班了，觉得一天喂狗了。呼呼，我想摸鱼啊，请给机会！",{"type":392,"tag":393,"props":407,"children":409},{"id":408},"背景",[410],{"type":398,"value":408},{"type":392,"tag":401,"props":412,"children":413},{},[414],{"type":398,"value":415},"上周在项目中碰到个棘手的问题。公司某项目依赖了两个不同的组件库，element-plus@2.0.2 和 element-plus@2.1.8。由于没把两个组件库的 zIndex 统一管理起来，所以这两库的弹窗各弹各的，可能互相遮住，很是尴尬。",{"type":392,"tag":401,"props":417,"children":418},{},[419,421,435],{"type":398,"value":420},"举例说明一下，两个组件库以下使用简称 E1 和 E2。element-plus（以及 element-ui）在内部实现了 zIndex 管理器，使打开的弹框的 zIndex 永远递增，解决了在单个 element 内部打开 dialog、popover、selector-option 等组件时互相遮盖的问题。element 默认的 zIndex 起始值是 2000，首先打开一个弹窗，dialog1，dialog1 的 zIndex 设置为 2001，如果在 dialog1 中使用按钮用打开了新的 dialog2，那么 dialog2 的 zIndex 值被置为 2002，遮住了 dialog1，这是正常的",{"type":392,"tag":422,"props":423,"children":424},"sup",{},[425],{"type":392,"tag":426,"props":427,"children":432},"a",{"href":428,"ariaDescribedBy":429,"dataFootnoteRef":386,"id":431},"#user-content-fn-append-to-body",[430],"footnote-label","user-content-fnref-append-to-body",[433],{"type":398,"value":434},"1",{"type":398,"value":436},"。那么问题来了，以上两个 dialog 都是通过 E1 打开的，一但在 dialog2 引用了 E2 的组件，打开弹窗 dialog3，那么 dialog3 的 zIndex 使用的是 E2 从 2000 开始递增为 2001 的值，不足以遮盖 E1 中 2002 的 dialog2，所以 dialog3 被 dialog2 遮挡，显示异常。",{"type":392,"tag":401,"props":438,"children":439},{},[440],{"type":392,"tag":441,"props":442,"children":445},"img",{"alt":443,"src":444},"打开多个弹窗示例","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220814192040.png",[],{"type":392,"tag":393,"props":447,"children":449},{"id":448},"解决",[450],{"type":398,"value":448},{"type":392,"tag":401,"props":452,"children":453},{},[454],{"type":398,"value":455},"统一多组件库层叠顺序，意味着将 E1 和 E2 内部实现的 zIndex 管理器中的 zIndex 通过某种形式关联起来。由于对 element 内部的实现不是很熟悉，所以一开始团队成员内部讨论时提出过许多天马行空的设想，比如“将 E2 的 zIndex 管理器作为 external 载入”、或是“使用 MutationObserver 检测 DOM 变化读取最新的 zIndex 值”... 最坏的情况是把当前的 element fork 出一份代码来自己维护，改造 zIndex 管理器实现多项目的统一管理。这些方案听起来不是那么可靠，所以我们决定先看看 element 的实现再近一步思考更优雅的解决方案。",{"type":392,"tag":457,"props":458,"children":460},"h4",{"id":459},"层叠管理器",[461],{"type":398,"value":459},{"type":392,"tag":401,"props":463,"children":464},{},[465],{"type":398,"value":466},"element-plus 的层叠管理器（PopupManager）实现比较简单，其核心原理和 element-ui 一致，通过闭包维护了一个 zIndex 的值的单例，暴露出获取值以及递增值的接口，以方便内部的 dialog 等组件在需要的时候有能力获取最新 zIndex 或者对 zIndex 进行递增。element-plus 中的层叠值管理的实现甚至比 element-ui 还要简单，它是一个 vue3 的 hook，只有 20 行代码。",{"type":392,"tag":468,"props":469,"children":473},"pre",{"className":470,"code":471,"language":472,"meta":386,"style":386},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","import { ref, computed } from 'vue'\nimport { useGlobalConfig } from '../use-global-config'\n\nconst zIndex = ref(0)\n\nexport const useZIndex = () => {\n  const initialZIndex = useGlobalConfig('zIndex', 2000) // TODO: move to @element-plus/constants\n  const currentZIndex = computed(() => initialZIndex.value + zIndex.value)\n\n  const nextZIndex = () => {\n    zIndex.value++\n    return currentZIndex.value\n  }\n\n  return {\n    initialZIndex,\n    currentZIndex,\n    nextZIndex,\n  }\n}\n","js",[474],{"type":392,"tag":475,"props":476,"children":477},"code",{"__ignoreMap":386},[478,539,577,587,630,638,677,738,807,815,844,866,888,897,905,918,932,945,958,966],{"type":392,"tag":479,"props":480,"children":483},"span",{"class":481,"line":482},"line",1,[484,490,496,502,507,512,517,522,528,534],{"type":392,"tag":479,"props":485,"children":487},{"style":486},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[488],{"type":398,"value":489},"import",{"type":392,"tag":479,"props":491,"children":493},{"style":492},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[494],{"type":398,"value":495}," {",{"type":392,"tag":479,"props":497,"children":499},{"style":498},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[500],{"type":398,"value":501}," ref",{"type":392,"tag":479,"props":503,"children":504},{"style":492},[505],{"type":398,"value":506},",",{"type":392,"tag":479,"props":508,"children":509},{"style":498},[510],{"type":398,"value":511}," computed",{"type":392,"tag":479,"props":513,"children":514},{"style":492},[515],{"type":398,"value":516}," }",{"type":392,"tag":479,"props":518,"children":519},{"style":486},[520],{"type":398,"value":521}," from",{"type":392,"tag":479,"props":523,"children":525},{"style":524},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[526],{"type":398,"value":527}," '",{"type":392,"tag":479,"props":529,"children":531},{"style":530},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[532],{"type":398,"value":533},"vue",{"type":392,"tag":479,"props":535,"children":536},{"style":524},[537],{"type":398,"value":538},"'\n",{"type":392,"tag":479,"props":540,"children":542},{"class":481,"line":541},2,[543,547,551,556,560,564,568,573],{"type":392,"tag":479,"props":544,"children":545},{"style":486},[546],{"type":398,"value":489},{"type":392,"tag":479,"props":548,"children":549},{"style":492},[550],{"type":398,"value":495},{"type":392,"tag":479,"props":552,"children":553},{"style":498},[554],{"type":398,"value":555}," useGlobalConfig",{"type":392,"tag":479,"props":557,"children":558},{"style":492},[559],{"type":398,"value":516},{"type":392,"tag":479,"props":561,"children":562},{"style":486},[563],{"type":398,"value":521},{"type":392,"tag":479,"props":565,"children":566},{"style":524},[567],{"type":398,"value":527},{"type":392,"tag":479,"props":569,"children":570},{"style":530},[571],{"type":398,"value":572},"../use-global-config",{"type":392,"tag":479,"props":574,"children":575},{"style":524},[576],{"type":398,"value":538},{"type":392,"tag":479,"props":578,"children":580},{"class":481,"line":579},3,[581],{"type":392,"tag":479,"props":582,"children":584},{"emptyLinePlaceholder":583},true,[585],{"type":398,"value":586},"\n",{"type":392,"tag":479,"props":588,"children":590},{"class":481,"line":589},4,[591,597,603,609,614,619,625],{"type":392,"tag":479,"props":592,"children":594},{"style":593},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-light-font-style:inherit;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[595],{"type":398,"value":596},"const",{"type":392,"tag":479,"props":598,"children":600},{"style":599},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[601],{"type":398,"value":602}," zIndex",{"type":392,"tag":479,"props":604,"children":606},{"style":605},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[607],{"type":398,"value":608}," =",{"type":392,"tag":479,"props":610,"children":612},{"style":611},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[613],{"type":398,"value":501},{"type":392,"tag":479,"props":615,"children":616},{"style":498},[617],{"type":398,"value":618},"(",{"type":392,"tag":479,"props":620,"children":622},{"style":621},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[623],{"type":398,"value":624},"0",{"type":392,"tag":479,"props":626,"children":627},{"style":498},[628],{"type":398,"value":629},")\n",{"type":392,"tag":479,"props":631,"children":633},{"class":481,"line":632},5,[634],{"type":392,"tag":479,"props":635,"children":636},{"emptyLinePlaceholder":583},[637],{"type":398,"value":586},{"type":392,"tag":479,"props":639,"children":641},{"class":481,"line":640},6,[642,647,652,658,662,667,672],{"type":392,"tag":479,"props":643,"children":644},{"style":486},[645],{"type":398,"value":646},"export",{"type":392,"tag":479,"props":648,"children":649},{"style":593},[650],{"type":398,"value":651}," const",{"type":392,"tag":479,"props":653,"children":655},{"style":654},"--shiki-light:#90A4AE;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[656],{"type":398,"value":657}," useZIndex",{"type":392,"tag":479,"props":659,"children":660},{"style":605},[661],{"type":398,"value":608},{"type":392,"tag":479,"props":663,"children":664},{"style":492},[665],{"type":398,"value":666}," ()",{"type":392,"tag":479,"props":668,"children":669},{"style":593},[670],{"type":398,"value":671}," =>",{"type":392,"tag":479,"props":673,"children":674},{"style":492},[675],{"type":398,"value":676}," {\n",{"type":392,"tag":479,"props":678,"children":680},{"class":481,"line":679},7,[681,686,691,695,699,704,709,714,718,722,727,732],{"type":392,"tag":479,"props":682,"children":683},{"style":593},[684],{"type":398,"value":685},"  const",{"type":392,"tag":479,"props":687,"children":688},{"style":599},[689],{"type":398,"value":690}," initialZIndex",{"type":392,"tag":479,"props":692,"children":693},{"style":605},[694],{"type":398,"value":608},{"type":392,"tag":479,"props":696,"children":697},{"style":611},[698],{"type":398,"value":555},{"type":392,"tag":479,"props":700,"children":702},{"style":701},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[703],{"type":398,"value":618},{"type":392,"tag":479,"props":705,"children":706},{"style":524},[707],{"type":398,"value":708},"'",{"type":392,"tag":479,"props":710,"children":711},{"style":530},[712],{"type":398,"value":713},"zIndex",{"type":392,"tag":479,"props":715,"children":716},{"style":524},[717],{"type":398,"value":708},{"type":392,"tag":479,"props":719,"children":720},{"style":492},[721],{"type":398,"value":506},{"type":392,"tag":479,"props":723,"children":724},{"style":621},[725],{"type":398,"value":726}," 2000",{"type":392,"tag":479,"props":728,"children":729},{"style":701},[730],{"type":398,"value":731},") ",{"type":392,"tag":479,"props":733,"children":735},{"style":734},"--shiki-light:#90A4AE;--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[736],{"type":398,"value":737},"// TODO: move to @element-plus/constants\n",{"type":392,"tag":479,"props":739,"children":741},{"class":481,"line":740},8,[742,746,751,755,759,763,768,772,776,781,786,791,795,799,803],{"type":392,"tag":479,"props":743,"children":744},{"style":593},[745],{"type":398,"value":685},{"type":392,"tag":479,"props":747,"children":748},{"style":599},[749],{"type":398,"value":750}," currentZIndex",{"type":392,"tag":479,"props":752,"children":753},{"style":605},[754],{"type":398,"value":608},{"type":392,"tag":479,"props":756,"children":757},{"style":611},[758],{"type":398,"value":511},{"type":392,"tag":479,"props":760,"children":761},{"style":701},[762],{"type":398,"value":618},{"type":392,"tag":479,"props":764,"children":765},{"style":492},[766],{"type":398,"value":767},"()",{"type":392,"tag":479,"props":769,"children":770},{"style":593},[771],{"type":398,"value":671},{"type":392,"tag":479,"props":773,"children":774},{"style":498},[775],{"type":398,"value":690},{"type":392,"tag":479,"props":777,"children":778},{"style":492},[779],{"type":398,"value":780},".",{"type":392,"tag":479,"props":782,"children":783},{"style":498},[784],{"type":398,"value":785},"value",{"type":392,"tag":479,"props":787,"children":788},{"style":605},[789],{"type":398,"value":790}," +",{"type":392,"tag":479,"props":792,"children":793},{"style":498},[794],{"type":398,"value":602},{"type":392,"tag":479,"props":796,"children":797},{"style":492},[798],{"type":398,"value":780},{"type":392,"tag":479,"props":800,"children":801},{"style":498},[802],{"type":398,"value":785},{"type":392,"tag":479,"props":804,"children":805},{"style":701},[806],{"type":398,"value":629},{"type":392,"tag":479,"props":808,"children":810},{"class":481,"line":809},9,[811],{"type":392,"tag":479,"props":812,"children":813},{"emptyLinePlaceholder":583},[814],{"type":398,"value":586},{"type":392,"tag":479,"props":816,"children":818},{"class":481,"line":817},10,[819,823,828,832,836,840],{"type":392,"tag":479,"props":820,"children":821},{"style":593},[822],{"type":398,"value":685},{"type":392,"tag":479,"props":824,"children":825},{"style":654},[826],{"type":398,"value":827}," nextZIndex",{"type":392,"tag":479,"props":829,"children":830},{"style":605},[831],{"type":398,"value":608},{"type":392,"tag":479,"props":833,"children":834},{"style":492},[835],{"type":398,"value":666},{"type":392,"tag":479,"props":837,"children":838},{"style":593},[839],{"type":398,"value":671},{"type":392,"tag":479,"props":841,"children":842},{"style":492},[843],{"type":398,"value":676},{"type":392,"tag":479,"props":845,"children":847},{"class":481,"line":846},11,[848,853,857,861],{"type":392,"tag":479,"props":849,"children":850},{"style":498},[851],{"type":398,"value":852},"    zIndex",{"type":392,"tag":479,"props":854,"children":855},{"style":492},[856],{"type":398,"value":780},{"type":392,"tag":479,"props":858,"children":859},{"style":498},[860],{"type":398,"value":785},{"type":392,"tag":479,"props":862,"children":863},{"style":605},[864],{"type":398,"value":865},"++\n",{"type":392,"tag":479,"props":867,"children":869},{"class":481,"line":868},12,[870,875,879,883],{"type":392,"tag":479,"props":871,"children":872},{"style":486},[873],{"type":398,"value":874},"    return",{"type":392,"tag":479,"props":876,"children":877},{"style":498},[878],{"type":398,"value":750},{"type":392,"tag":479,"props":880,"children":881},{"style":492},[882],{"type":398,"value":780},{"type":392,"tag":479,"props":884,"children":885},{"style":498},[886],{"type":398,"value":887},"value\n",{"type":392,"tag":479,"props":889,"children":891},{"class":481,"line":890},13,[892],{"type":392,"tag":479,"props":893,"children":894},{"style":492},[895],{"type":398,"value":896},"  }\n",{"type":392,"tag":479,"props":898,"children":900},{"class":481,"line":899},14,[901],{"type":392,"tag":479,"props":902,"children":903},{"emptyLinePlaceholder":583},[904],{"type":398,"value":586},{"type":392,"tag":479,"props":906,"children":908},{"class":481,"line":907},15,[909,914],{"type":392,"tag":479,"props":910,"children":911},{"style":486},[912],{"type":398,"value":913},"  return",{"type":392,"tag":479,"props":915,"children":916},{"style":492},[917],{"type":398,"value":676},{"type":392,"tag":479,"props":919,"children":921},{"class":481,"line":920},16,[922,927],{"type":392,"tag":479,"props":923,"children":924},{"style":498},[925],{"type":398,"value":926},"    initialZIndex",{"type":392,"tag":479,"props":928,"children":929},{"style":492},[930],{"type":398,"value":931},",\n",{"type":392,"tag":479,"props":933,"children":935},{"class":481,"line":934},17,[936,941],{"type":392,"tag":479,"props":937,"children":938},{"style":498},[939],{"type":398,"value":940},"    currentZIndex",{"type":392,"tag":479,"props":942,"children":943},{"style":492},[944],{"type":398,"value":931},{"type":392,"tag":479,"props":946,"children":948},{"class":481,"line":947},18,[949,954],{"type":392,"tag":479,"props":950,"children":951},{"style":498},[952],{"type":398,"value":953},"    nextZIndex",{"type":392,"tag":479,"props":955,"children":956},{"style":492},[957],{"type":398,"value":931},{"type":392,"tag":479,"props":959,"children":961},{"class":481,"line":960},19,[962],{"type":392,"tag":479,"props":963,"children":964},{"style":492},[965],{"type":398,"value":896},{"type":392,"tag":479,"props":967,"children":969},{"class":481,"line":968},20,[970],{"type":392,"tag":479,"props":971,"children":972},{"style":492},[973],{"type":398,"value":974},"}\n",{"type":392,"tag":401,"props":976,"children":977},{},[978],{"type":398,"value":979},"useZIndex 可以在任意 vue setup 中调用。调用后的回调提供了 initialZIndex、currentZIndex、nextZIndex 三个接口。initialZIndex 是通过 ElementConfigProvider 传入的 zIndex 初始值；用 currentZIndex 能拿到最新的 zIndex 值；用 nextZindex 可以给 zIndex 递增后获取其值，因为 zIndex 是全局的单例，所以使用 nextZIndex 拿到的值一定是全局最大的 zIndex。",{"type":392,"tag":468,"props":981,"children":984},{"className":982,"code":983,"language":533,"meta":386,"style":386},"language-vue shiki shiki-themes material-theme-lighter github-light github-dark monokai","\u003Ctemplate>\n  \u003Cdialog :style=\"{zIndex}\" />\n\u003C/template>\n\u003Cscript setup>\nconst { useZIndex } from \"../hooks/use-z-index\";\n// 这个 zIndex 一定是当前 element 中最大的 zIndex\nconst zIndex = useZIndex.nextZIndex();\n\u003C/script>\n",[985],{"type":392,"tag":475,"props":986,"children":987},{"__ignoreMap":386},[988,1007,1070,1086,1107,1136,1144,1180],{"type":392,"tag":479,"props":989,"children":990},{"class":481,"line":482},[991,996,1002],{"type":392,"tag":479,"props":992,"children":993},{"style":492},[994],{"type":398,"value":995},"\u003C",{"type":392,"tag":479,"props":997,"children":999},{"style":998},"--shiki-light:#E53935;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[1000],{"type":398,"value":1001},"template",{"type":392,"tag":479,"props":1003,"children":1004},{"style":492},[1005],{"type":398,"value":1006},">\n",{"type":392,"tag":479,"props":1008,"children":1009},{"class":481,"line":541},[1010,1015,1020,1025,1031,1036,1042,1047,1051,1056,1060,1066],{"type":392,"tag":479,"props":1011,"children":1012},{"style":492},[1013],{"type":398,"value":1014},"  \u003C",{"type":392,"tag":479,"props":1016,"children":1017},{"style":998},[1018],{"type":398,"value":1019},"dialog",{"type":392,"tag":479,"props":1021,"children":1022},{"style":492},[1023],{"type":398,"value":1024}," :",{"type":392,"tag":479,"props":1026,"children":1028},{"style":1027},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1029],{"type":398,"value":1030},"style",{"type":392,"tag":479,"props":1032,"children":1033},{"style":492},[1034],{"type":398,"value":1035},"=",{"type":392,"tag":479,"props":1037,"children":1039},{"style":1038},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#F8F8F2",[1040],{"type":398,"value":1041},"\"",{"type":392,"tag":479,"props":1043,"children":1044},{"style":492},[1045],{"type":398,"value":1046},"{",{"type":392,"tag":479,"props":1048,"children":1049},{"style":498},[1050],{"type":398,"value":713},{"type":392,"tag":479,"props":1052,"children":1053},{"style":492},[1054],{"type":398,"value":1055},"}",{"type":392,"tag":479,"props":1057,"children":1058},{"style":1038},[1059],{"type":398,"value":1041},{"type":392,"tag":479,"props":1061,"children":1063},{"style":1062},"--shiki-light:#39ADB5;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F44747;--shiki-light-font-style:inherit;--shiki-default-font-style:italic;--shiki-dark-font-style:italic;--shiki-sepia-font-style:inherit",[1064],{"type":398,"value":1065}," /",{"type":392,"tag":479,"props":1067,"children":1068},{"style":492},[1069],{"type":398,"value":1006},{"type":392,"tag":479,"props":1071,"children":1072},{"class":481,"line":579},[1073,1078,1082],{"type":392,"tag":479,"props":1074,"children":1075},{"style":492},[1076],{"type":398,"value":1077},"\u003C/",{"type":392,"tag":479,"props":1079,"children":1080},{"style":998},[1081],{"type":398,"value":1001},{"type":392,"tag":479,"props":1083,"children":1084},{"style":492},[1085],{"type":398,"value":1006},{"type":392,"tag":479,"props":1087,"children":1088},{"class":481,"line":589},[1089,1093,1098,1103],{"type":392,"tag":479,"props":1090,"children":1091},{"style":492},[1092],{"type":398,"value":995},{"type":392,"tag":479,"props":1094,"children":1095},{"style":998},[1096],{"type":398,"value":1097},"script",{"type":392,"tag":479,"props":1099,"children":1100},{"style":1027},[1101],{"type":398,"value":1102}," setup",{"type":392,"tag":479,"props":1104,"children":1105},{"style":492},[1106],{"type":398,"value":1006},{"type":392,"tag":479,"props":1108,"children":1109},{"class":481,"line":632},[1110,1114,1118,1122,1126,1131],{"type":392,"tag":479,"props":1111,"children":1112},{"style":593},[1113],{"type":398,"value":596},{"type":392,"tag":479,"props":1115,"children":1116},{"style":492},[1117],{"type":398,"value":495},{"type":392,"tag":479,"props":1119,"children":1120},{"style":599},[1121],{"type":398,"value":657},{"type":392,"tag":479,"props":1123,"children":1124},{"style":492},[1125],{"type":398,"value":516},{"type":392,"tag":479,"props":1127,"children":1128},{"style":498},[1129],{"type":398,"value":1130}," from \"../hooks/use-z-index\"",{"type":392,"tag":479,"props":1132,"children":1133},{"style":492},[1134],{"type":398,"value":1135},";\n",{"type":392,"tag":479,"props":1137,"children":1138},{"class":481,"line":640},[1139],{"type":392,"tag":479,"props":1140,"children":1141},{"style":734},[1142],{"type":398,"value":1143},"// 这个 zIndex 一定是当前 element 中最大的 zIndex\n",{"type":392,"tag":479,"props":1145,"children":1146},{"class":481,"line":679},[1147,1151,1155,1159,1163,1167,1172,1176],{"type":392,"tag":479,"props":1148,"children":1149},{"style":593},[1150],{"type":398,"value":596},{"type":392,"tag":479,"props":1152,"children":1153},{"style":599},[1154],{"type":398,"value":602},{"type":392,"tag":479,"props":1156,"children":1157},{"style":605},[1158],{"type":398,"value":608},{"type":392,"tag":479,"props":1160,"children":1161},{"style":498},[1162],{"type":398,"value":657},{"type":392,"tag":479,"props":1164,"children":1165},{"style":492},[1166],{"type":398,"value":780},{"type":392,"tag":479,"props":1168,"children":1169},{"style":611},[1170],{"type":398,"value":1171},"nextZIndex",{"type":392,"tag":479,"props":1173,"children":1174},{"style":498},[1175],{"type":398,"value":767},{"type":392,"tag":479,"props":1177,"children":1178},{"style":492},[1179],{"type":398,"value":1135},{"type":392,"tag":479,"props":1181,"children":1182},{"class":481,"line":740},[1183,1187,1191],{"type":392,"tag":479,"props":1184,"children":1185},{"style":492},[1186],{"type":398,"value":1077},{"type":392,"tag":479,"props":1188,"children":1189},{"style":998},[1190],{"type":398,"value":1097},{"type":392,"tag":479,"props":1192,"children":1193},{"style":492},[1194],{"type":398,"value":1006},{"type":392,"tag":457,"props":1196,"children":1198},{"id":1197},"思路分析",[1199],{"type":398,"value":1197},{"type":392,"tag":401,"props":1201,"children":1202},{},[1203,1205,1211],{"type":398,"value":1204},"既然在 element-plus 的内部能使用 ",{"type":392,"tag":475,"props":1206,"children":1208},{"className":1207},[],[1209],{"type":398,"value":1210},"const { useZIndex } from ...",{"type":398,"value":1212}," 的形式拿到 zIndex 管理器暴露的接口，那么在项目中是否能通过一样的方法得到它呢？",{"type":392,"tag":401,"props":1214,"children":1215},{},[1216],{"type":398,"value":1217},"答案是肯定的。通过观察 element 的默认导出可以发现其中有 useZIndex 的存在。",{"type":392,"tag":401,"props":1219,"children":1220},{},[1221],{"type":392,"tag":441,"props":1222,"children":1225},{"alt":1223,"src":1224},"exports in element-plus","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220814195047.png",[],{"type":392,"tag":401,"props":1227,"children":1228},{},[1229],{"type":398,"value":1230},"解决多组件库统一层叠顺序问题的本质就是在项目的应用层再实现一个 zIndex 管理器。管理器需要接受来自不同组件库的 zIndex 管理器，并在任一管理器中的 zIndex 值发生变化时，把变化同步到其它管理器中。",{"type":392,"tag":401,"props":1232,"children":1233},{},[1234],{"type":398,"value":1235},"举个例子，我们在文章开头先使用 E1 打开了 dialog1 和 dialog2，使 E1 的 zIndex 从 2000 递增到 2001 再递增到 2002，如果再打开 E2 的 dialog3，我们希望 dialog3 的 zIndex 从 2002 递增到 2003，这也就意味着打开 dialog1 和 dialog2 时的 zIndex 递增需要从 E1 同步到 E2。",{"type":392,"tag":401,"props":1237,"children":1238},{},[1239],{"type":398,"value":1240},"既然 element 导出了 useZIndex，那问题就好办了。我们可以在项目中拿到 E1 以及 E2 的 useZIndex，用 vue watch 监听两个 useZIndex 回传的 currentZIndex 接口，并把小的那个 zIndex（对应上述 E2）通过 nextZIndex 接口递增到大的（对应上述 E1）。这样一来，E1 和 E2 的 zIndex 就相等，在下一次打开弹窗时，无论是使用 E1 还是使用 E2 的弹窗，其 zIndex 值都能保证在项目中最大。",{"type":392,"tag":457,"props":1242,"children":1244},{"id":1243},"代码实现",[1245],{"type":398,"value":1243},{"type":392,"tag":401,"props":1247,"children":1248},{},[1249],{"type":398,"value":1250},"代码实现时，团队的小伙伴写了以下代码，这段代码非常好理解，这里就不细说了。",{"type":392,"tag":468,"props":1252,"children":1254},{"className":470,"code":1253,"language":472,"meta":386,"style":386},"watch([\n  () => e1ZIndexContext.currentZIndex.value,\n  () => e2ZIndexContext.currentZIndex.value,\n], ([z1, z2]) => {\n  if (z1 \u003C z2) {\n    e1ZIndexContext.nextZIndex()\n  } else {\n    e2ZIndexContext.nextZIndex()\n  }\n})\n",[1255],{"type":392,"tag":475,"props":1256,"children":1257},{"__ignoreMap":386},[1258,1271,1309,1345,1390,1425,1446,1463,1483,1490],{"type":392,"tag":479,"props":1259,"children":1260},{"class":481,"line":482},[1261,1266],{"type":392,"tag":479,"props":1262,"children":1263},{"style":611},[1264],{"type":398,"value":1265},"watch",{"type":392,"tag":479,"props":1267,"children":1268},{"style":498},[1269],{"type":398,"value":1270},"([\n",{"type":392,"tag":479,"props":1272,"children":1273},{"class":481,"line":541},[1274,1279,1283,1288,1292,1297,1301,1305],{"type":392,"tag":479,"props":1275,"children":1276},{"style":492},[1277],{"type":398,"value":1278},"  ()",{"type":392,"tag":479,"props":1280,"children":1281},{"style":593},[1282],{"type":398,"value":671},{"type":392,"tag":479,"props":1284,"children":1285},{"style":498},[1286],{"type":398,"value":1287}," e1ZIndexContext",{"type":392,"tag":479,"props":1289,"children":1290},{"style":492},[1291],{"type":398,"value":780},{"type":392,"tag":479,"props":1293,"children":1294},{"style":498},[1295],{"type":398,"value":1296},"currentZIndex",{"type":392,"tag":479,"props":1298,"children":1299},{"style":492},[1300],{"type":398,"value":780},{"type":392,"tag":479,"props":1302,"children":1303},{"style":498},[1304],{"type":398,"value":785},{"type":392,"tag":479,"props":1306,"children":1307},{"style":492},[1308],{"type":398,"value":931},{"type":392,"tag":479,"props":1310,"children":1311},{"class":481,"line":579},[1312,1316,1320,1325,1329,1333,1337,1341],{"type":392,"tag":479,"props":1313,"children":1314},{"style":492},[1315],{"type":398,"value":1278},{"type":392,"tag":479,"props":1317,"children":1318},{"style":593},[1319],{"type":398,"value":671},{"type":392,"tag":479,"props":1321,"children":1322},{"style":498},[1323],{"type":398,"value":1324}," e2ZIndexContext",{"type":392,"tag":479,"props":1326,"children":1327},{"style":492},[1328],{"type":398,"value":780},{"type":392,"tag":479,"props":1330,"children":1331},{"style":498},[1332],{"type":398,"value":1296},{"type":392,"tag":479,"props":1334,"children":1335},{"style":492},[1336],{"type":398,"value":780},{"type":392,"tag":479,"props":1338,"children":1339},{"style":498},[1340],{"type":398,"value":785},{"type":392,"tag":479,"props":1342,"children":1343},{"style":492},[1344],{"type":398,"value":931},{"type":392,"tag":479,"props":1346,"children":1347},{"class":481,"line":589},[1348,1353,1357,1362,1368,1372,1377,1382,1386],{"type":392,"tag":479,"props":1349,"children":1350},{"style":498},[1351],{"type":398,"value":1352},"]",{"type":392,"tag":479,"props":1354,"children":1355},{"style":492},[1356],{"type":398,"value":506},{"type":392,"tag":479,"props":1358,"children":1359},{"style":492},[1360],{"type":398,"value":1361}," ([",{"type":392,"tag":479,"props":1363,"children":1365},{"style":1364},"--shiki-light:#90A4AE;--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[1366],{"type":398,"value":1367},"z1",{"type":392,"tag":479,"props":1369,"children":1370},{"style":492},[1371],{"type":398,"value":506},{"type":392,"tag":479,"props":1373,"children":1374},{"style":1364},[1375],{"type":398,"value":1376}," z2",{"type":392,"tag":479,"props":1378,"children":1379},{"style":492},[1380],{"type":398,"value":1381},"])",{"type":392,"tag":479,"props":1383,"children":1384},{"style":593},[1385],{"type":398,"value":671},{"type":392,"tag":479,"props":1387,"children":1388},{"style":492},[1389],{"type":398,"value":676},{"type":392,"tag":479,"props":1391,"children":1392},{"class":481,"line":632},[1393,1398,1403,1407,1412,1416,1420],{"type":392,"tag":479,"props":1394,"children":1395},{"style":486},[1396],{"type":398,"value":1397},"  if",{"type":392,"tag":479,"props":1399,"children":1400},{"style":701},[1401],{"type":398,"value":1402}," (",{"type":392,"tag":479,"props":1404,"children":1405},{"style":498},[1406],{"type":398,"value":1367},{"type":392,"tag":479,"props":1408,"children":1409},{"style":605},[1410],{"type":398,"value":1411}," \u003C",{"type":392,"tag":479,"props":1413,"children":1414},{"style":498},[1415],{"type":398,"value":1376},{"type":392,"tag":479,"props":1417,"children":1418},{"style":701},[1419],{"type":398,"value":731},{"type":392,"tag":479,"props":1421,"children":1422},{"style":492},[1423],{"type":398,"value":1424},"{\n",{"type":392,"tag":479,"props":1426,"children":1427},{"class":481,"line":640},[1428,1433,1437,1441],{"type":392,"tag":479,"props":1429,"children":1430},{"style":498},[1431],{"type":398,"value":1432},"    e1ZIndexContext",{"type":392,"tag":479,"props":1434,"children":1435},{"style":492},[1436],{"type":398,"value":780},{"type":392,"tag":479,"props":1438,"children":1439},{"style":611},[1440],{"type":398,"value":1171},{"type":392,"tag":479,"props":1442,"children":1443},{"style":701},[1444],{"type":398,"value":1445},"()\n",{"type":392,"tag":479,"props":1447,"children":1448},{"class":481,"line":679},[1449,1454,1459],{"type":392,"tag":479,"props":1450,"children":1451},{"style":492},[1452],{"type":398,"value":1453},"  }",{"type":392,"tag":479,"props":1455,"children":1456},{"style":486},[1457],{"type":398,"value":1458}," else",{"type":392,"tag":479,"props":1460,"children":1461},{"style":492},[1462],{"type":398,"value":676},{"type":392,"tag":479,"props":1464,"children":1465},{"class":481,"line":740},[1466,1471,1475,1479],{"type":392,"tag":479,"props":1467,"children":1468},{"style":498},[1469],{"type":398,"value":1470},"    e2ZIndexContext",{"type":392,"tag":479,"props":1472,"children":1473},{"style":492},[1474],{"type":398,"value":780},{"type":392,"tag":479,"props":1476,"children":1477},{"style":611},[1478],{"type":398,"value":1171},{"type":392,"tag":479,"props":1480,"children":1481},{"style":701},[1482],{"type":398,"value":1445},{"type":392,"tag":479,"props":1484,"children":1485},{"class":481,"line":809},[1486],{"type":392,"tag":479,"props":1487,"children":1488},{"style":492},[1489],{"type":398,"value":896},{"type":392,"tag":479,"props":1491,"children":1492},{"class":481,"line":817},[1493,1497],{"type":392,"tag":479,"props":1494,"children":1495},{"style":492},[1496],{"type":398,"value":1055},{"type":392,"tag":479,"props":1498,"children":1499},{"style":498},[1500],{"type":398,"value":629},{"type":392,"tag":401,"props":1502,"children":1503},{},[1504],{"type":398,"value":1505},"需要注意的是，可能有非常多组件依赖了 useZIndex 的内部的响应式值，所以直接使用 watch 暴力递增 zIndex 是有问题的。想象一下，每递增一次，相关 vue 组件会被收集到等待更新的队列中，如果 z1 和 z2 的差值很大，容易报栈溢出问题。好在解决方式也非常简单，使用 nextTick 分担每个 tick 的任务，并在回调中，根据最新的 zIndex 值进行 zIndex 递增就行了。",{"type":392,"tag":468,"props":1507,"children":1509},{"className":470,"code":1508,"language":472,"meta":386,"style":386},"const { watch, nextTick } from \"vue\"\nconst unwatch = null\n\nexport function useSameZIndex(ctx1, ctx2) {\n  unwatch && unwatch()\n  unwatch = watch([\n    () => ctx1.currentZIndex.value,\n    () => ctx2.currentZIndex.value,\n  ], ([z1, z2]) => nextTick(() => {\n    const [nz1, nz2] = [\n      ctx1.currentZIndex.value,\n      ctx2.currentZIndex.value\n    ]\n    if (nz1 \u003C nz2) {\n      ctx1.nextZIndex()\n    } else {\n      ctx2.nextZIndex()\n    }\n  })\n}\n",[1510],{"type":392,"tag":475,"props":1511,"children":1512},{"__ignoreMap":386},[1513,1547,1569,1576,1620,1641,1660,1697,1732,1788,1828,1856,1880,1888,1920,1939,1955,1974,1982,1993],{"type":392,"tag":479,"props":1514,"children":1515},{"class":481,"line":482},[1516,1520,1524,1529,1533,1538,1542],{"type":392,"tag":479,"props":1517,"children":1518},{"style":593},[1519],{"type":398,"value":596},{"type":392,"tag":479,"props":1521,"children":1522},{"style":492},[1523],{"type":398,"value":495},{"type":392,"tag":479,"props":1525,"children":1526},{"style":599},[1527],{"type":398,"value":1528}," watch",{"type":392,"tag":479,"props":1530,"children":1531},{"style":492},[1532],{"type":398,"value":506},{"type":392,"tag":479,"props":1534,"children":1535},{"style":599},[1536],{"type":398,"value":1537}," nextTick",{"type":392,"tag":479,"props":1539,"children":1540},{"style":492},[1541],{"type":398,"value":516},{"type":392,"tag":479,"props":1543,"children":1544},{"style":498},[1545],{"type":398,"value":1546}," from \"vue\"\n",{"type":392,"tag":479,"props":1548,"children":1549},{"class":481,"line":541},[1550,1554,1559,1563],{"type":392,"tag":479,"props":1551,"children":1552},{"style":593},[1553],{"type":398,"value":596},{"type":392,"tag":479,"props":1555,"children":1556},{"style":599},[1557],{"type":398,"value":1558}," unwatch",{"type":392,"tag":479,"props":1560,"children":1561},{"style":605},[1562],{"type":398,"value":608},{"type":392,"tag":479,"props":1564,"children":1566},{"style":1565},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1567],{"type":398,"value":1568}," null\n",{"type":392,"tag":479,"props":1570,"children":1571},{"class":481,"line":579},[1572],{"type":392,"tag":479,"props":1573,"children":1574},{"emptyLinePlaceholder":583},[1575],{"type":398,"value":586},{"type":392,"tag":479,"props":1577,"children":1578},{"class":481,"line":589},[1579,1583,1588,1593,1597,1602,1606,1611,1616],{"type":392,"tag":479,"props":1580,"children":1581},{"style":486},[1582],{"type":398,"value":646},{"type":392,"tag":479,"props":1584,"children":1585},{"style":593},[1586],{"type":398,"value":1587}," function",{"type":392,"tag":479,"props":1589,"children":1590},{"style":611},[1591],{"type":398,"value":1592}," useSameZIndex",{"type":392,"tag":479,"props":1594,"children":1595},{"style":492},[1596],{"type":398,"value":618},{"type":392,"tag":479,"props":1598,"children":1599},{"style":1364},[1600],{"type":398,"value":1601},"ctx1",{"type":392,"tag":479,"props":1603,"children":1604},{"style":492},[1605],{"type":398,"value":506},{"type":392,"tag":479,"props":1607,"children":1608},{"style":1364},[1609],{"type":398,"value":1610}," ctx2",{"type":392,"tag":479,"props":1612,"children":1613},{"style":492},[1614],{"type":398,"value":1615},")",{"type":392,"tag":479,"props":1617,"children":1618},{"style":492},[1619],{"type":398,"value":676},{"type":392,"tag":479,"props":1621,"children":1622},{"class":481,"line":632},[1623,1628,1633,1637],{"type":392,"tag":479,"props":1624,"children":1625},{"style":498},[1626],{"type":398,"value":1627},"  unwatch",{"type":392,"tag":479,"props":1629,"children":1630},{"style":605},[1631],{"type":398,"value":1632}," &&",{"type":392,"tag":479,"props":1634,"children":1635},{"style":611},[1636],{"type":398,"value":1558},{"type":392,"tag":479,"props":1638,"children":1639},{"style":701},[1640],{"type":398,"value":1445},{"type":392,"tag":479,"props":1642,"children":1643},{"class":481,"line":640},[1644,1648,1652,1656],{"type":392,"tag":479,"props":1645,"children":1646},{"style":498},[1647],{"type":398,"value":1627},{"type":392,"tag":479,"props":1649,"children":1650},{"style":605},[1651],{"type":398,"value":608},{"type":392,"tag":479,"props":1653,"children":1654},{"style":611},[1655],{"type":398,"value":1528},{"type":392,"tag":479,"props":1657,"children":1658},{"style":701},[1659],{"type":398,"value":1270},{"type":392,"tag":479,"props":1661,"children":1662},{"class":481,"line":679},[1663,1668,1672,1677,1681,1685,1689,1693],{"type":392,"tag":479,"props":1664,"children":1665},{"style":492},[1666],{"type":398,"value":1667},"    ()",{"type":392,"tag":479,"props":1669,"children":1670},{"style":593},[1671],{"type":398,"value":671},{"type":392,"tag":479,"props":1673,"children":1674},{"style":498},[1675],{"type":398,"value":1676}," ctx1",{"type":392,"tag":479,"props":1678,"children":1679},{"style":492},[1680],{"type":398,"value":780},{"type":392,"tag":479,"props":1682,"children":1683},{"style":498},[1684],{"type":398,"value":1296},{"type":392,"tag":479,"props":1686,"children":1687},{"style":492},[1688],{"type":398,"value":780},{"type":392,"tag":479,"props":1690,"children":1691},{"style":498},[1692],{"type":398,"value":785},{"type":392,"tag":479,"props":1694,"children":1695},{"style":492},[1696],{"type":398,"value":931},{"type":392,"tag":479,"props":1698,"children":1699},{"class":481,"line":740},[1700,1704,1708,1712,1716,1720,1724,1728],{"type":392,"tag":479,"props":1701,"children":1702},{"style":492},[1703],{"type":398,"value":1667},{"type":392,"tag":479,"props":1705,"children":1706},{"style":593},[1707],{"type":398,"value":671},{"type":392,"tag":479,"props":1709,"children":1710},{"style":498},[1711],{"type":398,"value":1610},{"type":392,"tag":479,"props":1713,"children":1714},{"style":492},[1715],{"type":398,"value":780},{"type":392,"tag":479,"props":1717,"children":1718},{"style":498},[1719],{"type":398,"value":1296},{"type":392,"tag":479,"props":1721,"children":1722},{"style":492},[1723],{"type":398,"value":780},{"type":392,"tag":479,"props":1725,"children":1726},{"style":498},[1727],{"type":398,"value":785},{"type":392,"tag":479,"props":1729,"children":1730},{"style":492},[1731],{"type":398,"value":931},{"type":392,"tag":479,"props":1733,"children":1734},{"class":481,"line":809},[1735,1740,1744,1748,1752,1756,1760,1764,1768,1772,1776,1780,1784],{"type":392,"tag":479,"props":1736,"children":1737},{"style":701},[1738],{"type":398,"value":1739},"  ]",{"type":392,"tag":479,"props":1741,"children":1742},{"style":492},[1743],{"type":398,"value":506},{"type":392,"tag":479,"props":1745,"children":1746},{"style":492},[1747],{"type":398,"value":1361},{"type":392,"tag":479,"props":1749,"children":1750},{"style":1364},[1751],{"type":398,"value":1367},{"type":392,"tag":479,"props":1753,"children":1754},{"style":492},[1755],{"type":398,"value":506},{"type":392,"tag":479,"props":1757,"children":1758},{"style":1364},[1759],{"type":398,"value":1376},{"type":392,"tag":479,"props":1761,"children":1762},{"style":492},[1763],{"type":398,"value":1381},{"type":392,"tag":479,"props":1765,"children":1766},{"style":593},[1767],{"type":398,"value":671},{"type":392,"tag":479,"props":1769,"children":1770},{"style":611},[1771],{"type":398,"value":1537},{"type":392,"tag":479,"props":1773,"children":1774},{"style":701},[1775],{"type":398,"value":618},{"type":392,"tag":479,"props":1777,"children":1778},{"style":492},[1779],{"type":398,"value":767},{"type":392,"tag":479,"props":1781,"children":1782},{"style":593},[1783],{"type":398,"value":671},{"type":392,"tag":479,"props":1785,"children":1786},{"style":492},[1787],{"type":398,"value":676},{"type":392,"tag":479,"props":1789,"children":1790},{"class":481,"line":817},[1791,1796,1801,1806,1810,1815,1819,1823],{"type":392,"tag":479,"props":1792,"children":1793},{"style":593},[1794],{"type":398,"value":1795},"    const",{"type":392,"tag":479,"props":1797,"children":1798},{"style":492},[1799],{"type":398,"value":1800}," [",{"type":392,"tag":479,"props":1802,"children":1803},{"style":599},[1804],{"type":398,"value":1805},"nz1",{"type":392,"tag":479,"props":1807,"children":1808},{"style":492},[1809],{"type":398,"value":506},{"type":392,"tag":479,"props":1811,"children":1812},{"style":599},[1813],{"type":398,"value":1814}," nz2",{"type":392,"tag":479,"props":1816,"children":1817},{"style":492},[1818],{"type":398,"value":1352},{"type":392,"tag":479,"props":1820,"children":1821},{"style":605},[1822],{"type":398,"value":608},{"type":392,"tag":479,"props":1824,"children":1825},{"style":701},[1826],{"type":398,"value":1827}," [\n",{"type":392,"tag":479,"props":1829,"children":1830},{"class":481,"line":846},[1831,1836,1840,1844,1848,1852],{"type":392,"tag":479,"props":1832,"children":1833},{"style":498},[1834],{"type":398,"value":1835},"      ctx1",{"type":392,"tag":479,"props":1837,"children":1838},{"style":492},[1839],{"type":398,"value":780},{"type":392,"tag":479,"props":1841,"children":1842},{"style":498},[1843],{"type":398,"value":1296},{"type":392,"tag":479,"props":1845,"children":1846},{"style":492},[1847],{"type":398,"value":780},{"type":392,"tag":479,"props":1849,"children":1850},{"style":498},[1851],{"type":398,"value":785},{"type":392,"tag":479,"props":1853,"children":1854},{"style":492},[1855],{"type":398,"value":931},{"type":392,"tag":479,"props":1857,"children":1858},{"class":481,"line":868},[1859,1864,1868,1872,1876],{"type":392,"tag":479,"props":1860,"children":1861},{"style":498},[1862],{"type":398,"value":1863},"      ctx2",{"type":392,"tag":479,"props":1865,"children":1866},{"style":492},[1867],{"type":398,"value":780},{"type":392,"tag":479,"props":1869,"children":1870},{"style":498},[1871],{"type":398,"value":1296},{"type":392,"tag":479,"props":1873,"children":1874},{"style":492},[1875],{"type":398,"value":780},{"type":392,"tag":479,"props":1877,"children":1878},{"style":498},[1879],{"type":398,"value":887},{"type":392,"tag":479,"props":1881,"children":1882},{"class":481,"line":890},[1883],{"type":392,"tag":479,"props":1884,"children":1885},{"style":701},[1886],{"type":398,"value":1887},"    ]\n",{"type":392,"tag":479,"props":1889,"children":1890},{"class":481,"line":899},[1891,1896,1900,1904,1908,1912,1916],{"type":392,"tag":479,"props":1892,"children":1893},{"style":486},[1894],{"type":398,"value":1895},"    if",{"type":392,"tag":479,"props":1897,"children":1898},{"style":701},[1899],{"type":398,"value":1402},{"type":392,"tag":479,"props":1901,"children":1902},{"style":498},[1903],{"type":398,"value":1805},{"type":392,"tag":479,"props":1905,"children":1906},{"style":605},[1907],{"type":398,"value":1411},{"type":392,"tag":479,"props":1909,"children":1910},{"style":498},[1911],{"type":398,"value":1814},{"type":392,"tag":479,"props":1913,"children":1914},{"style":701},[1915],{"type":398,"value":731},{"type":392,"tag":479,"props":1917,"children":1918},{"style":492},[1919],{"type":398,"value":1424},{"type":392,"tag":479,"props":1921,"children":1922},{"class":481,"line":907},[1923,1927,1931,1935],{"type":392,"tag":479,"props":1924,"children":1925},{"style":498},[1926],{"type":398,"value":1835},{"type":392,"tag":479,"props":1928,"children":1929},{"style":492},[1930],{"type":398,"value":780},{"type":392,"tag":479,"props":1932,"children":1933},{"style":611},[1934],{"type":398,"value":1171},{"type":392,"tag":479,"props":1936,"children":1937},{"style":701},[1938],{"type":398,"value":1445},{"type":392,"tag":479,"props":1940,"children":1941},{"class":481,"line":920},[1942,1947,1951],{"type":392,"tag":479,"props":1943,"children":1944},{"style":492},[1945],{"type":398,"value":1946},"    }",{"type":392,"tag":479,"props":1948,"children":1949},{"style":486},[1950],{"type":398,"value":1458},{"type":392,"tag":479,"props":1952,"children":1953},{"style":492},[1954],{"type":398,"value":676},{"type":392,"tag":479,"props":1956,"children":1957},{"class":481,"line":934},[1958,1962,1966,1970],{"type":392,"tag":479,"props":1959,"children":1960},{"style":498},[1961],{"type":398,"value":1863},{"type":392,"tag":479,"props":1963,"children":1964},{"style":492},[1965],{"type":398,"value":780},{"type":392,"tag":479,"props":1967,"children":1968},{"style":611},[1969],{"type":398,"value":1171},{"type":392,"tag":479,"props":1971,"children":1972},{"style":701},[1973],{"type":398,"value":1445},{"type":392,"tag":479,"props":1975,"children":1976},{"class":481,"line":947},[1977],{"type":392,"tag":479,"props":1978,"children":1979},{"style":492},[1980],{"type":398,"value":1981},"    }\n",{"type":392,"tag":479,"props":1983,"children":1984},{"class":481,"line":960},[1985,1989],{"type":392,"tag":479,"props":1986,"children":1987},{"style":492},[1988],{"type":398,"value":1453},{"type":392,"tag":479,"props":1990,"children":1991},{"style":701},[1992],{"type":398,"value":629},{"type":392,"tag":479,"props":1994,"children":1995},{"class":481,"line":968},[1996],{"type":392,"tag":479,"props":1997,"children":1998},{"style":701},[1999],{"type":398,"value":974},{"type":392,"tag":393,"props":2001,"children":2003},{"id":2002},"更多",[2004],{"type":398,"value":2002},{"type":392,"tag":401,"props":2006,"children":2007},{},[2008,2010,2018],{"type":398,"value":2009},"以上分享的代码略为简单，想深入探索的话推荐直接看 element-plus 相关组件的源码，如 ",{"type":392,"tag":426,"props":2011,"children":2015},{"href":2012,"rel":2013},"https://github.com/element-plus/element-plus/blob/6503e5527715a6424433df0ff523b8910e891033/packages/components/message-box/src/index.vue",[2014],"nofollow",[2016],{"type":398,"value":2017},"message-box",{"type":398,"value":2019},"。虽然文中仅介绍了如何 watch 并递增管理器中的 zIndex 值，但是在实际项目开发时的使用场景肯定更加复杂，比方说，在 element-plus 上层封装业务 UI 库时可能会要用到全屏组件或是购物车等业务弹窗，那么这些库在全局的 zIndex 管理实际也可以使用 element-plus 的这套。总之，要活学活用嘛...",{"type":392,"tag":2021,"props":2022,"children":2025},"section",{"className":2023,"dataFootnotes":386},[2024],"footnotes",[2026,2033],{"type":392,"tag":393,"props":2027,"children":2030},{"className":2028,"id":430},[2029],"sr-only",[2031],{"type":398,"value":2032},"Footnotes",{"type":392,"tag":2034,"props":2035,"children":2036},"ol",{},[2037],{"type":392,"tag":2038,"props":2039,"children":2041},"li",{"id":2040},"user-content-fn-append-to-body",[2042,2044],{"type":398,"value":2043},"为了降低复杂度，这里只考虑将弹窗 teleport 到 body 中的情况。 ",{"type":392,"tag":426,"props":2045,"children":2050},{"href":2046,"ariaLabel":2047,"className":2048,"dataFootnoteBackref":386},"#user-content-fnref-append-to-body","Back to reference 1",[2049],"data-footnote-backref",[2051],{"type":398,"value":2052},"↩",{"type":392,"tag":1030,"props":2054,"children":2055},{},[2056],{"type":398,"value":2057},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":386,"searchDepth":541,"depth":541,"links":2059},[2060,2061,2062,2063,2064],{"id":395,"depth":541,"text":399},{"id":408,"depth":541,"text":408},{"id":448,"depth":541,"text":448},{"id":2002,"depth":541,"text":2002},{"id":430,"depth":541,"text":2032},"markdown","content:2.articles:4.zindex-manager.md","content","2.articles/4.zindex-manager.md","md",[2071,2073],{"_path":49,"title":48,"description":2072},"如何自定义 antd-table、vxe-table 等复杂组件的滚动条？",{"_path":55,"title":54,"description":2074},"如何破解滑块验证码？本文介绍使用Puppeteer操作浏览器进行图片对比、图片识别及优化鼠标轨迹以模仿真是用户等几种简单爬虫验证码破解思路，适用多种场景。",1708107554002]