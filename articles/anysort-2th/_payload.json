[{"data":1,"prerenderedAt":3074},["ShallowReactive",2],{"navigation":3,"/articles/anysort-2th":155,"/articles/anysort-2th-surround":3069},[4,35,86,92,119,125,149],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":45,"_path":46},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":48,"_path":49},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":51,"_path":52},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":54,"_path":55},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":57,"_path":58},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":60,"_path":61},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":63,"_path":64},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":66,"_path":67},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":69,"_path":70},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":72,"_path":73},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":75,"_path":76},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":78,"_path":79},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":81,"_path":82},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":84,"_path":85},"📝 技术博客归档","/articles/archive",{"title":87,"_path":88,"children":89},"读书笔记 / Notes","/books",[90],{"title":91,"_path":88},"📕 读书笔记",{"title":93,"_path":94,"children":95},"吉他剧场 / Music","/music",[96,98,101,104,107,110,113,116],{"title":97,"_path":94},"🎸 FingerStyle！",{"title":99,"_path":100},"🌬️ 等待的风","/music/wind",{"title":102,"_path":103},"💕 约定的海洋","/music/ocean",{"title":105,"_path":106},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":108,"_path":109},"🌏 残酷天使的行动纲领","/music/eva",{"title":111,"_path":112},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":114,"_path":115},"🍷 Wu Wei","/music/wu-wei",{"title":117,"_path":118},"🌅 无题","/music/untitled",{"title":120,"_path":121,"children":122},"知识地图 / Maps","/maps",[123],{"title":124,"_path":121},"🏁 知识地图",{"title":126,"_path":127,"children":128},"造物 / Make","/tools",[129,131,134,137,140,143,146],{"title":130,"_path":127},"🧰 工具收集",{"title":132,"_path":133},"📕 博客","/tools/blog",{"title":135,"_path":136},"🥥 Coconut","/tools/coconut",{"title":138,"_path":139},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":141,"_path":142},"🌐 AnySort","/tools/anysort",{"title":144,"_path":145},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":147,"_path":148},"👓 Crapto","/tools/crypto-inline",{"title":150,"_path":151,"children":152},"我 / About","/hire",[153],{"title":154,"_path":151},"📬 技术简历",{"_path":73,"_dir":156,"_draft":157,"_partial":157,"_locale":158,"title":72,"description":159,"body":160,"_type":3063,"_id":3064,"_source":3065,"_file":3066,"_stem":3067,"_extension":3068},"articles",false,"","上一篇讲 anysort 的文章说到因网易云音乐的歌单排序功能较弱，我们自己实现的用来给歌单自定义排序的排序库的思路。这篇文章在排序库的基础上，介绍了其 TypeScript 类型实现。",{"type":161,"children":162,"toc":3047},"root",[163,171,177,211,216,221,796,801,861,869,874,913,920,925,977,990,997,1002,1007,1013,1018,1239,1244,1724,1729,1734,2046,2051,2206,2211,2216,2545,2557,2562,2567,2579,2594,2602,2607,2735,2749,2756,2769,2776,2781,2794,2801,2815,2822,2827,2866,2873,2886,2893,2898,2911,2918,2923,2928,2933,2947,2961,3041],{"type":164,"tag":165,"props":166,"children":168},"element","h2",{"id":167},"前言",[169],{"type":170,"value":167},"text",{"type":164,"tag":172,"props":173,"children":174},"p",{},[175],{"type":170,"value":176},"去年一月的时候，我写了一个多属性排序库 Anysort，给网易云歌单用作自定义排序。正好最近在看其它语言，突然想起 TypeScript 里也有泛型这个东西，我估摸着 TS 正好能给 Anysort 补上一些高级类型约束，于是动手完成了。我特意回到 TS 来玩玩，结果这下惊住了我，TS 的泛型太特喵好玩了！",{"type":164,"tag":172,"props":178,"children":179},{},[180,182,196,198,209],{"type":170,"value":181},"那会儿我写了一篇文章介绍了 Anysort 的实现原理",{"type":164,"tag":183,"props":184,"children":185},"sup",{},[186],{"type":164,"tag":187,"props":188,"children":193},"a",{"href":189,"ariaDescribedBy":190,"dataFootnoteRef":158,"id":192},"#user-content-fn-anysort-1th",[191],"footnote-label","user-content-fnref-anysort-1th",[194],{"type":170,"value":195},"1",{"type":170,"value":197},"，但经过功能更替，代码更迭，早就不再适合阅读。此文章用作去年那篇的补充，额外会讲 Anysort 中一些高级类型的实现方法，但不会涉及基础知识。如果看文章时有任何疑惑的地方，推荐查字典",{"type":164,"tag":183,"props":199,"children":200},{},[201],{"type":164,"tag":187,"props":202,"children":206},{"href":203,"ariaDescribedBy":204,"dataFootnoteRef":158,"id":205},"#user-content-fn-dict",[191],"user-content-fnref-dict",[207],{"type":170,"value":208},"2",{"type":170,"value":210},"。",{"type":164,"tag":165,"props":212,"children":214},{"id":213},"排序示例",[215],{"type":170,"value":213},{"type":164,"tag":172,"props":217,"children":218},{},[219],{"type":170,"value":220},"首先我用例子简单说明一下 Anysort 的调用方式。现在回到二十世纪黑帮时代，警长在警察局关了一票黑帮，知道他们的姓名、年龄和做过的坏事这几个数据，想做一些排序。",{"type":164,"tag":222,"props":223,"children":227},"pre",{"className":224,"code":225,"language":226,"meta":158,"style":158},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","const gangs = [\n  {\n    name: 'A',\n    age: 33,\n    bads: []\n  },\n  {\n    name: 'B',\n    age: 25,\n    bads: ['X001']\n  },\n  {\n    name: 'C',\n    age: 25,\n    bads: ['X888', 'X772']\n  },\n  {\n    name: 'D',\n    age: 25,\n    bads: []\n  },\n  {\n    name: 'E',\n    age: 33,\n    bads: ['X888', 'X772', 'X002']\n  }\n]\n","js",[228],{"type":164,"tag":229,"props":230,"children":231},"code",{"__ignoreMap":158},[232,262,272,309,332,350,359,367,396,417,452,460,468,497,517,568,576,584,613,633,649,657,665,694,714,779,788],{"type":164,"tag":233,"props":234,"children":237},"span",{"class":235,"line":236},"line",1,[238,244,250,256],{"type":164,"tag":233,"props":239,"children":241},{"style":240},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[242],{"type":170,"value":243},"const",{"type":164,"tag":233,"props":245,"children":247},{"style":246},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[248],{"type":170,"value":249}," gangs",{"type":164,"tag":233,"props":251,"children":253},{"style":252},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[254],{"type":170,"value":255}," =",{"type":164,"tag":233,"props":257,"children":259},{"style":258},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[260],{"type":170,"value":261}," [\n",{"type":164,"tag":233,"props":263,"children":265},{"class":235,"line":264},2,[266],{"type":164,"tag":233,"props":267,"children":269},{"style":268},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[270],{"type":170,"value":271},"  {\n",{"type":164,"tag":233,"props":273,"children":275},{"class":235,"line":274},3,[276,282,287,293,299,304],{"type":164,"tag":233,"props":277,"children":279},{"style":278},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[280],{"type":170,"value":281},"    name",{"type":164,"tag":233,"props":283,"children":284},{"style":268},[285],{"type":170,"value":286},":",{"type":164,"tag":233,"props":288,"children":290},{"style":289},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[291],{"type":170,"value":292}," '",{"type":164,"tag":233,"props":294,"children":296},{"style":295},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[297],{"type":170,"value":298},"A",{"type":164,"tag":233,"props":300,"children":301},{"style":289},[302],{"type":170,"value":303},"'",{"type":164,"tag":233,"props":305,"children":306},{"style":268},[307],{"type":170,"value":308},",\n",{"type":164,"tag":233,"props":310,"children":312},{"class":235,"line":311},4,[313,318,322,328],{"type":164,"tag":233,"props":314,"children":315},{"style":278},[316],{"type":170,"value":317},"    age",{"type":164,"tag":233,"props":319,"children":320},{"style":268},[321],{"type":170,"value":286},{"type":164,"tag":233,"props":323,"children":325},{"style":324},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[326],{"type":170,"value":327}," 33",{"type":164,"tag":233,"props":329,"children":330},{"style":268},[331],{"type":170,"value":308},{"type":164,"tag":233,"props":333,"children":335},{"class":235,"line":334},5,[336,341,345],{"type":164,"tag":233,"props":337,"children":338},{"style":278},[339],{"type":170,"value":340},"    bads",{"type":164,"tag":233,"props":342,"children":343},{"style":268},[344],{"type":170,"value":286},{"type":164,"tag":233,"props":346,"children":347},{"style":258},[348],{"type":170,"value":349}," []\n",{"type":164,"tag":233,"props":351,"children":353},{"class":235,"line":352},6,[354],{"type":164,"tag":233,"props":355,"children":356},{"style":268},[357],{"type":170,"value":358},"  },\n",{"type":164,"tag":233,"props":360,"children":362},{"class":235,"line":361},7,[363],{"type":164,"tag":233,"props":364,"children":365},{"style":268},[366],{"type":170,"value":271},{"type":164,"tag":233,"props":368,"children":370},{"class":235,"line":369},8,[371,375,379,383,388,392],{"type":164,"tag":233,"props":372,"children":373},{"style":278},[374],{"type":170,"value":281},{"type":164,"tag":233,"props":376,"children":377},{"style":268},[378],{"type":170,"value":286},{"type":164,"tag":233,"props":380,"children":381},{"style":289},[382],{"type":170,"value":292},{"type":164,"tag":233,"props":384,"children":385},{"style":295},[386],{"type":170,"value":387},"B",{"type":164,"tag":233,"props":389,"children":390},{"style":289},[391],{"type":170,"value":303},{"type":164,"tag":233,"props":393,"children":394},{"style":268},[395],{"type":170,"value":308},{"type":164,"tag":233,"props":397,"children":399},{"class":235,"line":398},9,[400,404,408,413],{"type":164,"tag":233,"props":401,"children":402},{"style":278},[403],{"type":170,"value":317},{"type":164,"tag":233,"props":405,"children":406},{"style":268},[407],{"type":170,"value":286},{"type":164,"tag":233,"props":409,"children":410},{"style":324},[411],{"type":170,"value":412}," 25",{"type":164,"tag":233,"props":414,"children":415},{"style":268},[416],{"type":170,"value":308},{"type":164,"tag":233,"props":418,"children":420},{"class":235,"line":419},10,[421,425,429,434,438,443,447],{"type":164,"tag":233,"props":422,"children":423},{"style":278},[424],{"type":170,"value":340},{"type":164,"tag":233,"props":426,"children":427},{"style":268},[428],{"type":170,"value":286},{"type":164,"tag":233,"props":430,"children":431},{"style":258},[432],{"type":170,"value":433}," [",{"type":164,"tag":233,"props":435,"children":436},{"style":289},[437],{"type":170,"value":303},{"type":164,"tag":233,"props":439,"children":440},{"style":295},[441],{"type":170,"value":442},"X001",{"type":164,"tag":233,"props":444,"children":445},{"style":289},[446],{"type":170,"value":303},{"type":164,"tag":233,"props":448,"children":449},{"style":258},[450],{"type":170,"value":451},"]\n",{"type":164,"tag":233,"props":453,"children":455},{"class":235,"line":454},11,[456],{"type":164,"tag":233,"props":457,"children":458},{"style":268},[459],{"type":170,"value":358},{"type":164,"tag":233,"props":461,"children":463},{"class":235,"line":462},12,[464],{"type":164,"tag":233,"props":465,"children":466},{"style":268},[467],{"type":170,"value":271},{"type":164,"tag":233,"props":469,"children":471},{"class":235,"line":470},13,[472,476,480,484,489,493],{"type":164,"tag":233,"props":473,"children":474},{"style":278},[475],{"type":170,"value":281},{"type":164,"tag":233,"props":477,"children":478},{"style":268},[479],{"type":170,"value":286},{"type":164,"tag":233,"props":481,"children":482},{"style":289},[483],{"type":170,"value":292},{"type":164,"tag":233,"props":485,"children":486},{"style":295},[487],{"type":170,"value":488},"C",{"type":164,"tag":233,"props":490,"children":491},{"style":289},[492],{"type":170,"value":303},{"type":164,"tag":233,"props":494,"children":495},{"style":268},[496],{"type":170,"value":308},{"type":164,"tag":233,"props":498,"children":500},{"class":235,"line":499},14,[501,505,509,513],{"type":164,"tag":233,"props":502,"children":503},{"style":278},[504],{"type":170,"value":317},{"type":164,"tag":233,"props":506,"children":507},{"style":268},[508],{"type":170,"value":286},{"type":164,"tag":233,"props":510,"children":511},{"style":324},[512],{"type":170,"value":412},{"type":164,"tag":233,"props":514,"children":515},{"style":268},[516],{"type":170,"value":308},{"type":164,"tag":233,"props":518,"children":520},{"class":235,"line":519},15,[521,525,529,533,537,542,546,551,555,560,564],{"type":164,"tag":233,"props":522,"children":523},{"style":278},[524],{"type":170,"value":340},{"type":164,"tag":233,"props":526,"children":527},{"style":268},[528],{"type":170,"value":286},{"type":164,"tag":233,"props":530,"children":531},{"style":258},[532],{"type":170,"value":433},{"type":164,"tag":233,"props":534,"children":535},{"style":289},[536],{"type":170,"value":303},{"type":164,"tag":233,"props":538,"children":539},{"style":295},[540],{"type":170,"value":541},"X888",{"type":164,"tag":233,"props":543,"children":544},{"style":289},[545],{"type":170,"value":303},{"type":164,"tag":233,"props":547,"children":548},{"style":268},[549],{"type":170,"value":550},",",{"type":164,"tag":233,"props":552,"children":553},{"style":289},[554],{"type":170,"value":292},{"type":164,"tag":233,"props":556,"children":557},{"style":295},[558],{"type":170,"value":559},"X772",{"type":164,"tag":233,"props":561,"children":562},{"style":289},[563],{"type":170,"value":303},{"type":164,"tag":233,"props":565,"children":566},{"style":258},[567],{"type":170,"value":451},{"type":164,"tag":233,"props":569,"children":571},{"class":235,"line":570},16,[572],{"type":164,"tag":233,"props":573,"children":574},{"style":268},[575],{"type":170,"value":358},{"type":164,"tag":233,"props":577,"children":579},{"class":235,"line":578},17,[580],{"type":164,"tag":233,"props":581,"children":582},{"style":268},[583],{"type":170,"value":271},{"type":164,"tag":233,"props":585,"children":587},{"class":235,"line":586},18,[588,592,596,600,605,609],{"type":164,"tag":233,"props":589,"children":590},{"style":278},[591],{"type":170,"value":281},{"type":164,"tag":233,"props":593,"children":594},{"style":268},[595],{"type":170,"value":286},{"type":164,"tag":233,"props":597,"children":598},{"style":289},[599],{"type":170,"value":292},{"type":164,"tag":233,"props":601,"children":602},{"style":295},[603],{"type":170,"value":604},"D",{"type":164,"tag":233,"props":606,"children":607},{"style":289},[608],{"type":170,"value":303},{"type":164,"tag":233,"props":610,"children":611},{"style":268},[612],{"type":170,"value":308},{"type":164,"tag":233,"props":614,"children":616},{"class":235,"line":615},19,[617,621,625,629],{"type":164,"tag":233,"props":618,"children":619},{"style":278},[620],{"type":170,"value":317},{"type":164,"tag":233,"props":622,"children":623},{"style":268},[624],{"type":170,"value":286},{"type":164,"tag":233,"props":626,"children":627},{"style":324},[628],{"type":170,"value":412},{"type":164,"tag":233,"props":630,"children":631},{"style":268},[632],{"type":170,"value":308},{"type":164,"tag":233,"props":634,"children":636},{"class":235,"line":635},20,[637,641,645],{"type":164,"tag":233,"props":638,"children":639},{"style":278},[640],{"type":170,"value":340},{"type":164,"tag":233,"props":642,"children":643},{"style":268},[644],{"type":170,"value":286},{"type":164,"tag":233,"props":646,"children":647},{"style":258},[648],{"type":170,"value":349},{"type":164,"tag":233,"props":650,"children":652},{"class":235,"line":651},21,[653],{"type":164,"tag":233,"props":654,"children":655},{"style":268},[656],{"type":170,"value":358},{"type":164,"tag":233,"props":658,"children":660},{"class":235,"line":659},22,[661],{"type":164,"tag":233,"props":662,"children":663},{"style":268},[664],{"type":170,"value":271},{"type":164,"tag":233,"props":666,"children":668},{"class":235,"line":667},23,[669,673,677,681,686,690],{"type":164,"tag":233,"props":670,"children":671},{"style":278},[672],{"type":170,"value":281},{"type":164,"tag":233,"props":674,"children":675},{"style":268},[676],{"type":170,"value":286},{"type":164,"tag":233,"props":678,"children":679},{"style":289},[680],{"type":170,"value":292},{"type":164,"tag":233,"props":682,"children":683},{"style":295},[684],{"type":170,"value":685},"E",{"type":164,"tag":233,"props":687,"children":688},{"style":289},[689],{"type":170,"value":303},{"type":164,"tag":233,"props":691,"children":692},{"style":268},[693],{"type":170,"value":308},{"type":164,"tag":233,"props":695,"children":697},{"class":235,"line":696},24,[698,702,706,710],{"type":164,"tag":233,"props":699,"children":700},{"style":278},[701],{"type":170,"value":317},{"type":164,"tag":233,"props":703,"children":704},{"style":268},[705],{"type":170,"value":286},{"type":164,"tag":233,"props":707,"children":708},{"style":324},[709],{"type":170,"value":327},{"type":164,"tag":233,"props":711,"children":712},{"style":268},[713],{"type":170,"value":308},{"type":164,"tag":233,"props":715,"children":717},{"class":235,"line":716},25,[718,722,726,730,734,738,742,746,750,754,758,762,766,771,775],{"type":164,"tag":233,"props":719,"children":720},{"style":278},[721],{"type":170,"value":340},{"type":164,"tag":233,"props":723,"children":724},{"style":268},[725],{"type":170,"value":286},{"type":164,"tag":233,"props":727,"children":728},{"style":258},[729],{"type":170,"value":433},{"type":164,"tag":233,"props":731,"children":732},{"style":289},[733],{"type":170,"value":303},{"type":164,"tag":233,"props":735,"children":736},{"style":295},[737],{"type":170,"value":541},{"type":164,"tag":233,"props":739,"children":740},{"style":289},[741],{"type":170,"value":303},{"type":164,"tag":233,"props":743,"children":744},{"style":268},[745],{"type":170,"value":550},{"type":164,"tag":233,"props":747,"children":748},{"style":289},[749],{"type":170,"value":292},{"type":164,"tag":233,"props":751,"children":752},{"style":295},[753],{"type":170,"value":559},{"type":164,"tag":233,"props":755,"children":756},{"style":289},[757],{"type":170,"value":303},{"type":164,"tag":233,"props":759,"children":760},{"style":268},[761],{"type":170,"value":550},{"type":164,"tag":233,"props":763,"children":764},{"style":289},[765],{"type":170,"value":292},{"type":164,"tag":233,"props":767,"children":768},{"style":295},[769],{"type":170,"value":770},"X002",{"type":164,"tag":233,"props":772,"children":773},{"style":289},[774],{"type":170,"value":303},{"type":164,"tag":233,"props":776,"children":777},{"style":258},[778],{"type":170,"value":451},{"type":164,"tag":233,"props":780,"children":782},{"class":235,"line":781},26,[783],{"type":164,"tag":233,"props":784,"children":785},{"style":268},[786],{"type":170,"value":787},"  }\n",{"type":164,"tag":233,"props":789,"children":791},{"class":235,"line":790},27,[792],{"type":164,"tag":233,"props":793,"children":794},{"style":258},[795],{"type":170,"value":451},{"type":164,"tag":172,"props":797,"children":798},{},[799],{"type":170,"value":800},"恰逢天下大赦，局长要把没做过坏事中的最年轻的那个黑帮释放，这时要对 bads 及 age 两个字段进行排序。",{"type":164,"tag":222,"props":802,"children":804},{"className":224,"code":803,"language":226,"meta":158,"style":158},"anysort(gangs, 'bads.length', 'age')\n",[805],{"type":164,"tag":229,"props":806,"children":807},{"__ignoreMap":158},[808],{"type":164,"tag":233,"props":809,"children":810},{"class":235,"line":236},[811,817,822,826,830,835,839,843,847,852,856],{"type":164,"tag":233,"props":812,"children":814},{"style":813},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[815],{"type":170,"value":816},"anysort",{"type":164,"tag":233,"props":818,"children":819},{"style":258},[820],{"type":170,"value":821},"(gangs",{"type":164,"tag":233,"props":823,"children":824},{"style":268},[825],{"type":170,"value":550},{"type":164,"tag":233,"props":827,"children":828},{"style":289},[829],{"type":170,"value":292},{"type":164,"tag":233,"props":831,"children":832},{"style":295},[833],{"type":170,"value":834},"bads.length",{"type":164,"tag":233,"props":836,"children":837},{"style":289},[838],{"type":170,"value":303},{"type":164,"tag":233,"props":840,"children":841},{"style":268},[842],{"type":170,"value":550},{"type":164,"tag":233,"props":844,"children":845},{"style":289},[846],{"type":170,"value":292},{"type":164,"tag":233,"props":848,"children":849},{"style":295},[850],{"type":170,"value":851},"age",{"type":164,"tag":233,"props":853,"children":854},{"style":289},[855],{"type":170,"value":303},{"type":164,"tag":233,"props":857,"children":858},{"style":258},[859],{"type":170,"value":860},")\n",{"type":164,"tag":172,"props":862,"children":863},{},[864],{"type":164,"tag":865,"props":866,"children":868},"img",{"alt":158,"src":867},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220513170945.png",[],{"type":164,"tag":172,"props":870,"children":871},{},[872],{"type":170,"value":873},"结果很明显：应该释放 D。使用对象的点号访问方法，可以轻松访问到 bads 的长度。这是一个内置的“排序插件”，用来更改排序数据，把 bads 映射到 bads.length。除此之外，插件还可以更改排序的结果，比方说 reverse 插件，可以使某个排序倒序显示。如果局长想枪毙掉某个做过坏事最多的黑帮分子，他需要根据 bads 的长度倒序排序。",{"type":164,"tag":222,"props":875,"children":877},{"className":224,"code":876,"language":226,"meta":158,"style":158},"anysort(gangs, 'bads.length-reverse()')\n",[878],{"type":164,"tag":229,"props":879,"children":880},{"__ignoreMap":158},[881],{"type":164,"tag":233,"props":882,"children":883},{"class":235,"line":236},[884,888,892,896,900,905,909],{"type":164,"tag":233,"props":885,"children":886},{"style":813},[887],{"type":170,"value":816},{"type":164,"tag":233,"props":889,"children":890},{"style":258},[891],{"type":170,"value":821},{"type":164,"tag":233,"props":893,"children":894},{"style":268},[895],{"type":170,"value":550},{"type":164,"tag":233,"props":897,"children":898},{"style":289},[899],{"type":170,"value":292},{"type":164,"tag":233,"props":901,"children":902},{"style":295},[903],{"type":170,"value":904},"bads.length-reverse()",{"type":164,"tag":233,"props":906,"children":907},{"style":289},[908],{"type":170,"value":303},{"type":164,"tag":233,"props":910,"children":911},{"style":258},[912],{"type":170,"value":860},{"type":164,"tag":172,"props":914,"children":915},{},[916],{"type":164,"tag":865,"props":917,"children":919},{"alt":158,"src":918},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220513171506.png",[],{"type":164,"tag":172,"props":921,"children":922},{},[923],{"type":170,"value":924},"结果很明显：应该枪毙 E。这帮黑帮分子的履历太简单了，只有姓名年龄等字段。Anysort 提供了其它的内置插件以便于对复杂的数据进行排序，还可以进行扩展，它显然能处理更复杂的排序情况。就调用方式而言，除了字符串传参，还可以使用对象语法调用。如下所示。",{"type":164,"tag":222,"props":926,"children":928},{"className":224,"code":927,"language":226,"meta":158,"style":158},"anysort(gangs).badsa.length.reverse()\n",[929],{"type":164,"tag":229,"props":930,"children":931},{"__ignoreMap":158},[932],{"type":164,"tag":233,"props":933,"children":934},{"class":235,"line":236},[935,939,944,949,954,958,963,967,972],{"type":164,"tag":233,"props":936,"children":937},{"style":813},[938],{"type":170,"value":816},{"type":164,"tag":233,"props":940,"children":941},{"style":258},[942],{"type":170,"value":943},"(gangs)",{"type":164,"tag":233,"props":945,"children":946},{"style":268},[947],{"type":170,"value":948},".",{"type":164,"tag":233,"props":950,"children":951},{"style":258},[952],{"type":170,"value":953},"badsa",{"type":164,"tag":233,"props":955,"children":956},{"style":268},[957],{"type":170,"value":948},{"type":164,"tag":233,"props":959,"children":960},{"style":246},[961],{"type":170,"value":962},"length",{"type":164,"tag":233,"props":964,"children":965},{"style":268},[966],{"type":170,"value":948},{"type":164,"tag":233,"props":968,"children":969},{"style":813},[970],{"type":170,"value":971},"reverse",{"type":164,"tag":233,"props":973,"children":974},{"style":258},[975],{"type":170,"value":976},"()\n",{"type":164,"tag":172,"props":978,"children":979},{},[980,982,988],{"type":170,"value":981},"呀，恭喜你发现我打错了 bads 这个单词！不过该如何让编辑器也知道这行代码是错误的？假设局长在排序时输错了一个字母，那么得到错误排序结果后，他就有可能枪毙一个本该释放的人。不论是字符串传参，还是对象语法调用，",{"type":164,"tag":983,"props":984,"children":985},"strong",{},[986],{"type":170,"value":987},"该如何保证类型是正确的",{"type":170,"value":989},"？编写代码时，错误调用应该报错。",{"type":164,"tag":172,"props":991,"children":992},{},[993],{"type":164,"tag":865,"props":994,"children":996},{"alt":158,"src":995},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220513181638.png",[],{"type":164,"tag":172,"props":998,"children":999},{},[1000],{"type":170,"value":1001},"探讨 Anysort 的类型前，让我们先简单看看 Anysort 的实现。当然，实现和类型没有强关联，所以你也可以直接跳到下一小节。",{"type":164,"tag":165,"props":1003,"children":1005},{"id":1004},"排序原理",[1006],{"type":170,"value":1004},{"type":164,"tag":1008,"props":1009,"children":1011},"h3",{"id":1010},"多属性排序",[1012],{"type":170,"value":1010},{"type":164,"tag":172,"props":1014,"children":1015},{},[1016],{"type":170,"value":1017},"Anysort 是在 Array.prototype.sort 基础上的封装。Array.prototype.sort 接受一个比较函数，利用内置算法比较各个元素，并根据比较函数给出的结果来决定元素的排序前后顺序。比如根据年龄排序，可以这样编写：",{"type":164,"tag":222,"props":1019,"children":1021},{"className":224,"code":1020,"language":226,"meta":158,"style":158},"function sortByAge(gangsA, gangsB) {\n  const ageA = gangsA.age\n  const ageB = gangsB.age\n  return ageA === ageB ? 0 : (ageA \u003C ageB ? -1 : 1)\n}\ngangs.sort(sortByAge)\n",[1022],{"type":164,"tag":229,"props":1023,"children":1024},{"__ignoreMap":158},[1025,1068,1099,1127,1209,1217],{"type":164,"tag":233,"props":1026,"children":1027},{"class":235,"line":236},[1028,1033,1038,1043,1049,1053,1058,1063],{"type":164,"tag":233,"props":1029,"children":1030},{"style":240},[1031],{"type":170,"value":1032},"function",{"type":164,"tag":233,"props":1034,"children":1035},{"style":813},[1036],{"type":170,"value":1037}," sortByAge",{"type":164,"tag":233,"props":1039,"children":1040},{"style":268},[1041],{"type":170,"value":1042},"(",{"type":164,"tag":233,"props":1044,"children":1046},{"style":1045},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[1047],{"type":170,"value":1048},"gangsA",{"type":164,"tag":233,"props":1050,"children":1051},{"style":268},[1052],{"type":170,"value":550},{"type":164,"tag":233,"props":1054,"children":1055},{"style":1045},[1056],{"type":170,"value":1057}," gangsB",{"type":164,"tag":233,"props":1059,"children":1060},{"style":268},[1061],{"type":170,"value":1062},")",{"type":164,"tag":233,"props":1064,"children":1065},{"style":268},[1066],{"type":170,"value":1067}," {\n",{"type":164,"tag":233,"props":1069,"children":1070},{"class":235,"line":264},[1071,1076,1081,1085,1090,1094],{"type":164,"tag":233,"props":1072,"children":1073},{"style":240},[1074],{"type":170,"value":1075},"  const",{"type":164,"tag":233,"props":1077,"children":1078},{"style":246},[1079],{"type":170,"value":1080}," ageA",{"type":164,"tag":233,"props":1082,"children":1083},{"style":252},[1084],{"type":170,"value":255},{"type":164,"tag":233,"props":1086,"children":1087},{"style":258},[1088],{"type":170,"value":1089}," gangsA",{"type":164,"tag":233,"props":1091,"children":1092},{"style":268},[1093],{"type":170,"value":948},{"type":164,"tag":233,"props":1095,"children":1096},{"style":258},[1097],{"type":170,"value":1098},"age\n",{"type":164,"tag":233,"props":1100,"children":1101},{"class":235,"line":274},[1102,1106,1111,1115,1119,1123],{"type":164,"tag":233,"props":1103,"children":1104},{"style":240},[1105],{"type":170,"value":1075},{"type":164,"tag":233,"props":1107,"children":1108},{"style":246},[1109],{"type":170,"value":1110}," ageB",{"type":164,"tag":233,"props":1112,"children":1113},{"style":252},[1114],{"type":170,"value":255},{"type":164,"tag":233,"props":1116,"children":1117},{"style":258},[1118],{"type":170,"value":1057},{"type":164,"tag":233,"props":1120,"children":1121},{"style":268},[1122],{"type":170,"value":948},{"type":164,"tag":233,"props":1124,"children":1125},{"style":258},[1126],{"type":170,"value":1098},{"type":164,"tag":233,"props":1128,"children":1129},{"class":235,"line":311},[1130,1136,1140,1145,1149,1154,1159,1164,1169,1174,1179,1183,1187,1192,1196,1200,1205],{"type":164,"tag":233,"props":1131,"children":1133},{"style":1132},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[1134],{"type":170,"value":1135},"  return",{"type":164,"tag":233,"props":1137,"children":1138},{"style":258},[1139],{"type":170,"value":1080},{"type":164,"tag":233,"props":1141,"children":1142},{"style":252},[1143],{"type":170,"value":1144}," ===",{"type":164,"tag":233,"props":1146,"children":1147},{"style":258},[1148],{"type":170,"value":1110},{"type":164,"tag":233,"props":1150,"children":1151},{"style":252},[1152],{"type":170,"value":1153}," ?",{"type":164,"tag":233,"props":1155,"children":1156},{"style":324},[1157],{"type":170,"value":1158}," 0",{"type":164,"tag":233,"props":1160,"children":1161},{"style":252},[1162],{"type":170,"value":1163}," :",{"type":164,"tag":233,"props":1165,"children":1166},{"style":278},[1167],{"type":170,"value":1168}," (",{"type":164,"tag":233,"props":1170,"children":1171},{"style":258},[1172],{"type":170,"value":1173},"ageA",{"type":164,"tag":233,"props":1175,"children":1176},{"style":252},[1177],{"type":170,"value":1178}," \u003C",{"type":164,"tag":233,"props":1180,"children":1181},{"style":258},[1182],{"type":170,"value":1110},{"type":164,"tag":233,"props":1184,"children":1185},{"style":252},[1186],{"type":170,"value":1153},{"type":164,"tag":233,"props":1188,"children":1189},{"style":252},[1190],{"type":170,"value":1191}," -",{"type":164,"tag":233,"props":1193,"children":1194},{"style":324},[1195],{"type":170,"value":195},{"type":164,"tag":233,"props":1197,"children":1198},{"style":252},[1199],{"type":170,"value":1163},{"type":164,"tag":233,"props":1201,"children":1202},{"style":324},[1203],{"type":170,"value":1204}," 1",{"type":164,"tag":233,"props":1206,"children":1207},{"style":278},[1208],{"type":170,"value":860},{"type":164,"tag":233,"props":1210,"children":1211},{"class":235,"line":334},[1212],{"type":164,"tag":233,"props":1213,"children":1214},{"style":268},[1215],{"type":170,"value":1216},"}\n",{"type":164,"tag":233,"props":1218,"children":1219},{"class":235,"line":352},[1220,1225,1229,1234],{"type":164,"tag":233,"props":1221,"children":1222},{"style":258},[1223],{"type":170,"value":1224},"gangs",{"type":164,"tag":233,"props":1226,"children":1227},{"style":268},[1228],{"type":170,"value":948},{"type":164,"tag":233,"props":1230,"children":1231},{"style":813},[1232],{"type":170,"value":1233},"sort",{"type":164,"tag":233,"props":1235,"children":1236},{"style":258},[1237],{"type":170,"value":1238},"(sortByAge)\n",{"type":164,"tag":172,"props":1240,"children":1241},{},[1242],{"type":170,"value":1243},"一但涉及多个属性的排序，我们就需要编写多个类似 sortByAge 的比较函数。由于多个属性的比较有先后关系，所以我们需要一个“漏斗”来筛选出最终的排序结果。比如，在挑选无犯罪记录中最年轻的黑帮时，先按照其犯罪记录长度排序，如果某两个黑帮成员的犯罪记录长度相等，也就意味着需要在对其年龄继续排序。有了“漏斗”filter，有再多比较函数都没关系。Anysort 的多属性排序的核心就是这个 filter 方法。",{"type":164,"tag":222,"props":1245,"children":1247},{"className":224,"code":1246,"language":226,"meta":158,"style":158},"const sortByAge = ({age:a}, {age:b}) => a === b ? 0 : a \u003C b ? -1 : 1\nconst sortBybadsLen = ({bads:a}, {bads:b}) => a.length === b.length ? 0 : a.length \u003C b.length ? -1 : 1\n\nconst filter = (...fns) => (a, b) => fns.reduce((res, fn) => res || fn(a, b), 0)\ngangs.sort(filter(sortByAge, sortBybadsLen))\n",[1248],{"type":164,"tag":229,"props":1249,"children":1250},{"__ignoreMap":158},[1251,1380,1531,1540,1686],{"type":164,"tag":233,"props":1252,"children":1253},{"class":235,"line":236},[1254,1258,1263,1267,1272,1277,1281,1285,1290,1295,1299,1303,1308,1313,1318,1323,1328,1333,1338,1342,1346,1350,1355,1359,1363,1367,1371,1375],{"type":164,"tag":233,"props":1255,"children":1256},{"style":240},[1257],{"type":170,"value":243},{"type":164,"tag":233,"props":1259,"children":1261},{"style":1260},"--shiki-light:#90A4AE;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1262],{"type":170,"value":1037},{"type":164,"tag":233,"props":1264,"children":1265},{"style":252},[1266],{"type":170,"value":255},{"type":164,"tag":233,"props":1268,"children":1269},{"style":268},[1270],{"type":170,"value":1271}," ({",{"type":164,"tag":233,"props":1273,"children":1275},{"style":1274},"--shiki-light:#E53935;--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#F8F8F2",[1276],{"type":170,"value":851},{"type":164,"tag":233,"props":1278,"children":1279},{"style":268},[1280],{"type":170,"value":286},{"type":164,"tag":233,"props":1282,"children":1283},{"style":1045},[1284],{"type":170,"value":187},{"type":164,"tag":233,"props":1286,"children":1287},{"style":268},[1288],{"type":170,"value":1289},"},",{"type":164,"tag":233,"props":1291,"children":1292},{"style":268},[1293],{"type":170,"value":1294}," {",{"type":164,"tag":233,"props":1296,"children":1297},{"style":1274},[1298],{"type":170,"value":851},{"type":164,"tag":233,"props":1300,"children":1301},{"style":268},[1302],{"type":170,"value":286},{"type":164,"tag":233,"props":1304,"children":1305},{"style":1045},[1306],{"type":170,"value":1307},"b",{"type":164,"tag":233,"props":1309,"children":1310},{"style":268},[1311],{"type":170,"value":1312},"})",{"type":164,"tag":233,"props":1314,"children":1315},{"style":240},[1316],{"type":170,"value":1317}," =>",{"type":164,"tag":233,"props":1319,"children":1320},{"style":258},[1321],{"type":170,"value":1322}," a ",{"type":164,"tag":233,"props":1324,"children":1325},{"style":252},[1326],{"type":170,"value":1327},"===",{"type":164,"tag":233,"props":1329,"children":1330},{"style":258},[1331],{"type":170,"value":1332}," b ",{"type":164,"tag":233,"props":1334,"children":1335},{"style":252},[1336],{"type":170,"value":1337},"?",{"type":164,"tag":233,"props":1339,"children":1340},{"style":324},[1341],{"type":170,"value":1158},{"type":164,"tag":233,"props":1343,"children":1344},{"style":252},[1345],{"type":170,"value":1163},{"type":164,"tag":233,"props":1347,"children":1348},{"style":258},[1349],{"type":170,"value":1322},{"type":164,"tag":233,"props":1351,"children":1352},{"style":252},[1353],{"type":170,"value":1354},"\u003C",{"type":164,"tag":233,"props":1356,"children":1357},{"style":258},[1358],{"type":170,"value":1332},{"type":164,"tag":233,"props":1360,"children":1361},{"style":252},[1362],{"type":170,"value":1337},{"type":164,"tag":233,"props":1364,"children":1365},{"style":252},[1366],{"type":170,"value":1191},{"type":164,"tag":233,"props":1368,"children":1369},{"style":324},[1370],{"type":170,"value":195},{"type":164,"tag":233,"props":1372,"children":1373},{"style":252},[1374],{"type":170,"value":1163},{"type":164,"tag":233,"props":1376,"children":1377},{"style":324},[1378],{"type":170,"value":1379}," 1\n",{"type":164,"tag":233,"props":1381,"children":1382},{"class":235,"line":264},[1383,1387,1392,1396,1400,1405,1409,1413,1417,1421,1425,1429,1433,1437,1441,1446,1450,1454,1458,1463,1467,1471,1475,1479,1483,1487,1491,1495,1499,1503,1507,1511,1515,1519,1523,1527],{"type":164,"tag":233,"props":1384,"children":1385},{"style":240},[1386],{"type":170,"value":243},{"type":164,"tag":233,"props":1388,"children":1389},{"style":1260},[1390],{"type":170,"value":1391}," sortBybadsLen",{"type":164,"tag":233,"props":1393,"children":1394},{"style":252},[1395],{"type":170,"value":255},{"type":164,"tag":233,"props":1397,"children":1398},{"style":268},[1399],{"type":170,"value":1271},{"type":164,"tag":233,"props":1401,"children":1402},{"style":1274},[1403],{"type":170,"value":1404},"bads",{"type":164,"tag":233,"props":1406,"children":1407},{"style":268},[1408],{"type":170,"value":286},{"type":164,"tag":233,"props":1410,"children":1411},{"style":1045},[1412],{"type":170,"value":187},{"type":164,"tag":233,"props":1414,"children":1415},{"style":268},[1416],{"type":170,"value":1289},{"type":164,"tag":233,"props":1418,"children":1419},{"style":268},[1420],{"type":170,"value":1294},{"type":164,"tag":233,"props":1422,"children":1423},{"style":1274},[1424],{"type":170,"value":1404},{"type":164,"tag":233,"props":1426,"children":1427},{"style":268},[1428],{"type":170,"value":286},{"type":164,"tag":233,"props":1430,"children":1431},{"style":1045},[1432],{"type":170,"value":1307},{"type":164,"tag":233,"props":1434,"children":1435},{"style":268},[1436],{"type":170,"value":1312},{"type":164,"tag":233,"props":1438,"children":1439},{"style":240},[1440],{"type":170,"value":1317},{"type":164,"tag":233,"props":1442,"children":1443},{"style":258},[1444],{"type":170,"value":1445}," a",{"type":164,"tag":233,"props":1447,"children":1448},{"style":268},[1449],{"type":170,"value":948},{"type":164,"tag":233,"props":1451,"children":1452},{"style":246},[1453],{"type":170,"value":962},{"type":164,"tag":233,"props":1455,"children":1456},{"style":252},[1457],{"type":170,"value":1144},{"type":164,"tag":233,"props":1459,"children":1460},{"style":258},[1461],{"type":170,"value":1462}," b",{"type":164,"tag":233,"props":1464,"children":1465},{"style":268},[1466],{"type":170,"value":948},{"type":164,"tag":233,"props":1468,"children":1469},{"style":246},[1470],{"type":170,"value":962},{"type":164,"tag":233,"props":1472,"children":1473},{"style":252},[1474],{"type":170,"value":1153},{"type":164,"tag":233,"props":1476,"children":1477},{"style":324},[1478],{"type":170,"value":1158},{"type":164,"tag":233,"props":1480,"children":1481},{"style":252},[1482],{"type":170,"value":1163},{"type":164,"tag":233,"props":1484,"children":1485},{"style":258},[1486],{"type":170,"value":1445},{"type":164,"tag":233,"props":1488,"children":1489},{"style":268},[1490],{"type":170,"value":948},{"type":164,"tag":233,"props":1492,"children":1493},{"style":246},[1494],{"type":170,"value":962},{"type":164,"tag":233,"props":1496,"children":1497},{"style":252},[1498],{"type":170,"value":1178},{"type":164,"tag":233,"props":1500,"children":1501},{"style":258},[1502],{"type":170,"value":1462},{"type":164,"tag":233,"props":1504,"children":1505},{"style":268},[1506],{"type":170,"value":948},{"type":164,"tag":233,"props":1508,"children":1509},{"style":246},[1510],{"type":170,"value":962},{"type":164,"tag":233,"props":1512,"children":1513},{"style":252},[1514],{"type":170,"value":1153},{"type":164,"tag":233,"props":1516,"children":1517},{"style":252},[1518],{"type":170,"value":1191},{"type":164,"tag":233,"props":1520,"children":1521},{"style":324},[1522],{"type":170,"value":195},{"type":164,"tag":233,"props":1524,"children":1525},{"style":252},[1526],{"type":170,"value":1163},{"type":164,"tag":233,"props":1528,"children":1529},{"style":324},[1530],{"type":170,"value":1379},{"type":164,"tag":233,"props":1532,"children":1533},{"class":235,"line":274},[1534],{"type":164,"tag":233,"props":1535,"children":1537},{"emptyLinePlaceholder":1536},true,[1538],{"type":170,"value":1539},"\n",{"type":164,"tag":233,"props":1541,"children":1542},{"class":235,"line":311},[1543,1547,1552,1556,1560,1565,1570,1574,1578,1582,1586,1590,1594,1598,1602,1607,1611,1616,1620,1624,1629,1633,1638,1642,1646,1651,1656,1660,1665,1669,1674,1678,1682],{"type":164,"tag":233,"props":1544,"children":1545},{"style":240},[1546],{"type":170,"value":243},{"type":164,"tag":233,"props":1548,"children":1549},{"style":1260},[1550],{"type":170,"value":1551}," filter",{"type":164,"tag":233,"props":1553,"children":1554},{"style":252},[1555],{"type":170,"value":255},{"type":164,"tag":233,"props":1557,"children":1558},{"style":268},[1559],{"type":170,"value":1168},{"type":164,"tag":233,"props":1561,"children":1562},{"style":252},[1563],{"type":170,"value":1564},"...",{"type":164,"tag":233,"props":1566,"children":1567},{"style":1045},[1568],{"type":170,"value":1569},"fns",{"type":164,"tag":233,"props":1571,"children":1572},{"style":268},[1573],{"type":170,"value":1062},{"type":164,"tag":233,"props":1575,"children":1576},{"style":240},[1577],{"type":170,"value":1317},{"type":164,"tag":233,"props":1579,"children":1580},{"style":268},[1581],{"type":170,"value":1168},{"type":164,"tag":233,"props":1583,"children":1584},{"style":1045},[1585],{"type":170,"value":187},{"type":164,"tag":233,"props":1587,"children":1588},{"style":268},[1589],{"type":170,"value":550},{"type":164,"tag":233,"props":1591,"children":1592},{"style":1045},[1593],{"type":170,"value":1462},{"type":164,"tag":233,"props":1595,"children":1596},{"style":268},[1597],{"type":170,"value":1062},{"type":164,"tag":233,"props":1599,"children":1600},{"style":240},[1601],{"type":170,"value":1317},{"type":164,"tag":233,"props":1603,"children":1604},{"style":258},[1605],{"type":170,"value":1606}," fns",{"type":164,"tag":233,"props":1608,"children":1609},{"style":268},[1610],{"type":170,"value":948},{"type":164,"tag":233,"props":1612,"children":1613},{"style":813},[1614],{"type":170,"value":1615},"reduce",{"type":164,"tag":233,"props":1617,"children":1618},{"style":258},[1619],{"type":170,"value":1042},{"type":164,"tag":233,"props":1621,"children":1622},{"style":268},[1623],{"type":170,"value":1042},{"type":164,"tag":233,"props":1625,"children":1626},{"style":1045},[1627],{"type":170,"value":1628},"res",{"type":164,"tag":233,"props":1630,"children":1631},{"style":268},[1632],{"type":170,"value":550},{"type":164,"tag":233,"props":1634,"children":1635},{"style":1045},[1636],{"type":170,"value":1637}," fn",{"type":164,"tag":233,"props":1639,"children":1640},{"style":268},[1641],{"type":170,"value":1062},{"type":164,"tag":233,"props":1643,"children":1644},{"style":240},[1645],{"type":170,"value":1317},{"type":164,"tag":233,"props":1647,"children":1648},{"style":258},[1649],{"type":170,"value":1650}," res ",{"type":164,"tag":233,"props":1652,"children":1653},{"style":252},[1654],{"type":170,"value":1655},"||",{"type":164,"tag":233,"props":1657,"children":1658},{"style":813},[1659],{"type":170,"value":1637},{"type":164,"tag":233,"props":1661,"children":1662},{"style":258},[1663],{"type":170,"value":1664},"(a",{"type":164,"tag":233,"props":1666,"children":1667},{"style":268},[1668],{"type":170,"value":550},{"type":164,"tag":233,"props":1670,"children":1671},{"style":258},[1672],{"type":170,"value":1673}," b)",{"type":164,"tag":233,"props":1675,"children":1676},{"style":268},[1677],{"type":170,"value":550},{"type":164,"tag":233,"props":1679,"children":1680},{"style":324},[1681],{"type":170,"value":1158},{"type":164,"tag":233,"props":1683,"children":1684},{"style":258},[1685],{"type":170,"value":860},{"type":164,"tag":233,"props":1687,"children":1688},{"class":235,"line":334},[1689,1693,1697,1701,1705,1710,1715,1719],{"type":164,"tag":233,"props":1690,"children":1691},{"style":258},[1692],{"type":170,"value":1224},{"type":164,"tag":233,"props":1694,"children":1695},{"style":268},[1696],{"type":170,"value":948},{"type":164,"tag":233,"props":1698,"children":1699},{"style":813},[1700],{"type":170,"value":1233},{"type":164,"tag":233,"props":1702,"children":1703},{"style":258},[1704],{"type":170,"value":1042},{"type":164,"tag":233,"props":1706,"children":1707},{"style":813},[1708],{"type":170,"value":1709},"filter",{"type":164,"tag":233,"props":1711,"children":1712},{"style":258},[1713],{"type":170,"value":1714},"(sortByAge",{"type":164,"tag":233,"props":1716,"children":1717},{"style":268},[1718],{"type":170,"value":550},{"type":164,"tag":233,"props":1720,"children":1721},{"style":258},[1722],{"type":170,"value":1723}," sortBybadsLen))\n",{"type":164,"tag":1008,"props":1725,"children":1727},{"id":1726},"对象的点号访问",[1728],{"type":170,"value":1726},{"type":164,"tag":172,"props":1730,"children":1731},{},[1732],{"type":170,"value":1733},"刚才提到，插件可以改变排序的结果，也能改变排序数据。类似从数据 gangsA 到 gangsA.bads.length 的变幻，就是使用内置插件 walk 实现的。它是一个简单递归函数。",{"type":164,"tag":222,"props":1735,"children":1737},{"className":224,"code":1736,"language":226,"meta":158,"style":158},"/**\n * @example\n *  walk('a.b')({a:{b:3}}) === 3\n */\nconst walk = pathsStr => x => {\n  const paths = pathsStr.split('.')\n  let val = x\n  let nextPath = null\n  while (val && paths.length) {\n    nextPath = paths.shift()\n    val = val[nextPath]\n  }\n  return val\n}\n",[1738],{"type":164,"tag":229,"props":1739,"children":1740},{"__ignoreMap":158},[1741,1750,1770,1778,1786,1824,1873,1895,1917,1961,1990,2020,2027,2039],{"type":164,"tag":233,"props":1742,"children":1743},{"class":235,"line":236},[1744],{"type":164,"tag":233,"props":1745,"children":1747},{"style":1746},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[1748],{"type":170,"value":1749},"/**\n",{"type":164,"tag":233,"props":1751,"children":1752},{"class":235,"line":264},[1753,1758,1764],{"type":164,"tag":233,"props":1754,"children":1755},{"style":1746},[1756],{"type":170,"value":1757}," * ",{"type":164,"tag":233,"props":1759,"children":1761},{"style":1760},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[1762],{"type":170,"value":1763},"@",{"type":164,"tag":233,"props":1765,"children":1767},{"style":1766},"--shiki-light:#9C3EDA;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[1768],{"type":170,"value":1769},"example\n",{"type":164,"tag":233,"props":1771,"children":1772},{"class":235,"line":274},[1773],{"type":164,"tag":233,"props":1774,"children":1775},{"style":1746},[1776],{"type":170,"value":1777}," *  walk('a.b')({a:{b:3}}) === 3\n",{"type":164,"tag":233,"props":1779,"children":1780},{"class":235,"line":311},[1781],{"type":164,"tag":233,"props":1782,"children":1783},{"style":1746},[1784],{"type":170,"value":1785}," */\n",{"type":164,"tag":233,"props":1787,"children":1788},{"class":235,"line":334},[1789,1793,1798,1802,1807,1811,1816,1820],{"type":164,"tag":233,"props":1790,"children":1791},{"style":240},[1792],{"type":170,"value":243},{"type":164,"tag":233,"props":1794,"children":1795},{"style":1260},[1796],{"type":170,"value":1797}," walk",{"type":164,"tag":233,"props":1799,"children":1800},{"style":252},[1801],{"type":170,"value":255},{"type":164,"tag":233,"props":1803,"children":1804},{"style":1045},[1805],{"type":170,"value":1806}," pathsStr",{"type":164,"tag":233,"props":1808,"children":1809},{"style":240},[1810],{"type":170,"value":1317},{"type":164,"tag":233,"props":1812,"children":1813},{"style":1045},[1814],{"type":170,"value":1815}," x",{"type":164,"tag":233,"props":1817,"children":1818},{"style":240},[1819],{"type":170,"value":1317},{"type":164,"tag":233,"props":1821,"children":1822},{"style":268},[1823],{"type":170,"value":1067},{"type":164,"tag":233,"props":1825,"children":1826},{"class":235,"line":352},[1827,1831,1836,1840,1844,1848,1853,1857,1861,1865,1869],{"type":164,"tag":233,"props":1828,"children":1829},{"style":240},[1830],{"type":170,"value":1075},{"type":164,"tag":233,"props":1832,"children":1833},{"style":246},[1834],{"type":170,"value":1835}," paths",{"type":164,"tag":233,"props":1837,"children":1838},{"style":252},[1839],{"type":170,"value":255},{"type":164,"tag":233,"props":1841,"children":1842},{"style":258},[1843],{"type":170,"value":1806},{"type":164,"tag":233,"props":1845,"children":1846},{"style":268},[1847],{"type":170,"value":948},{"type":164,"tag":233,"props":1849,"children":1850},{"style":813},[1851],{"type":170,"value":1852},"split",{"type":164,"tag":233,"props":1854,"children":1855},{"style":278},[1856],{"type":170,"value":1042},{"type":164,"tag":233,"props":1858,"children":1859},{"style":289},[1860],{"type":170,"value":303},{"type":164,"tag":233,"props":1862,"children":1863},{"style":295},[1864],{"type":170,"value":948},{"type":164,"tag":233,"props":1866,"children":1867},{"style":289},[1868],{"type":170,"value":303},{"type":164,"tag":233,"props":1870,"children":1871},{"style":278},[1872],{"type":170,"value":860},{"type":164,"tag":233,"props":1874,"children":1875},{"class":235,"line":361},[1876,1881,1886,1890],{"type":164,"tag":233,"props":1877,"children":1878},{"style":240},[1879],{"type":170,"value":1880},"  let",{"type":164,"tag":233,"props":1882,"children":1883},{"style":258},[1884],{"type":170,"value":1885}," val",{"type":164,"tag":233,"props":1887,"children":1888},{"style":252},[1889],{"type":170,"value":255},{"type":164,"tag":233,"props":1891,"children":1892},{"style":258},[1893],{"type":170,"value":1894}," x\n",{"type":164,"tag":233,"props":1896,"children":1897},{"class":235,"line":369},[1898,1902,1907,1911],{"type":164,"tag":233,"props":1899,"children":1900},{"style":240},[1901],{"type":170,"value":1880},{"type":164,"tag":233,"props":1903,"children":1904},{"style":258},[1905],{"type":170,"value":1906}," nextPath",{"type":164,"tag":233,"props":1908,"children":1909},{"style":252},[1910],{"type":170,"value":255},{"type":164,"tag":233,"props":1912,"children":1914},{"style":1913},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1915],{"type":170,"value":1916}," null\n",{"type":164,"tag":233,"props":1918,"children":1919},{"class":235,"line":398},[1920,1925,1929,1934,1939,1943,1947,1951,1956],{"type":164,"tag":233,"props":1921,"children":1922},{"style":1132},[1923],{"type":170,"value":1924},"  while",{"type":164,"tag":233,"props":1926,"children":1927},{"style":278},[1928],{"type":170,"value":1168},{"type":164,"tag":233,"props":1930,"children":1931},{"style":258},[1932],{"type":170,"value":1933},"val",{"type":164,"tag":233,"props":1935,"children":1936},{"style":252},[1937],{"type":170,"value":1938}," &&",{"type":164,"tag":233,"props":1940,"children":1941},{"style":258},[1942],{"type":170,"value":1835},{"type":164,"tag":233,"props":1944,"children":1945},{"style":268},[1946],{"type":170,"value":948},{"type":164,"tag":233,"props":1948,"children":1949},{"style":246},[1950],{"type":170,"value":962},{"type":164,"tag":233,"props":1952,"children":1953},{"style":278},[1954],{"type":170,"value":1955},") ",{"type":164,"tag":233,"props":1957,"children":1958},{"style":268},[1959],{"type":170,"value":1960},"{\n",{"type":164,"tag":233,"props":1962,"children":1963},{"class":235,"line":419},[1964,1969,1973,1977,1981,1986],{"type":164,"tag":233,"props":1965,"children":1966},{"style":258},[1967],{"type":170,"value":1968},"    nextPath",{"type":164,"tag":233,"props":1970,"children":1971},{"style":252},[1972],{"type":170,"value":255},{"type":164,"tag":233,"props":1974,"children":1975},{"style":258},[1976],{"type":170,"value":1835},{"type":164,"tag":233,"props":1978,"children":1979},{"style":268},[1980],{"type":170,"value":948},{"type":164,"tag":233,"props":1982,"children":1983},{"style":813},[1984],{"type":170,"value":1985},"shift",{"type":164,"tag":233,"props":1987,"children":1988},{"style":278},[1989],{"type":170,"value":976},{"type":164,"tag":233,"props":1991,"children":1992},{"class":235,"line":454},[1993,1998,2002,2006,2011,2016],{"type":164,"tag":233,"props":1994,"children":1995},{"style":258},[1996],{"type":170,"value":1997},"    val",{"type":164,"tag":233,"props":1999,"children":2000},{"style":252},[2001],{"type":170,"value":255},{"type":164,"tag":233,"props":2003,"children":2004},{"style":258},[2005],{"type":170,"value":1885},{"type":164,"tag":233,"props":2007,"children":2008},{"style":278},[2009],{"type":170,"value":2010},"[",{"type":164,"tag":233,"props":2012,"children":2013},{"style":258},[2014],{"type":170,"value":2015},"nextPath",{"type":164,"tag":233,"props":2017,"children":2018},{"style":278},[2019],{"type":170,"value":451},{"type":164,"tag":233,"props":2021,"children":2022},{"class":235,"line":462},[2023],{"type":164,"tag":233,"props":2024,"children":2025},{"style":268},[2026],{"type":170,"value":787},{"type":164,"tag":233,"props":2028,"children":2029},{"class":235,"line":470},[2030,2034],{"type":164,"tag":233,"props":2031,"children":2032},{"style":1132},[2033],{"type":170,"value":1135},{"type":164,"tag":233,"props":2035,"children":2036},{"style":258},[2037],{"type":170,"value":2038}," val\n",{"type":164,"tag":233,"props":2040,"children":2041},{"class":235,"line":499},[2042],{"type":164,"tag":233,"props":2043,"children":2044},{"style":268},[2045],{"type":170,"value":1216},{"type":164,"tag":172,"props":2047,"children":2048},{},[2049],{"type":170,"value":2050},"当读取到 'a.b-reverse()'，首先根据中横线将指令划分为 walk('a.b') 和 reverse() 两个插件，分别生成比较函数；之后，把这两个比较函数传入 filter，返回可用于 Array.prototype.sort 的最终结果（一个新的比较函数）。这就是 Anysort 的整个流程。可以看作以下代码：",{"type":164,"tag":222,"props":2052,"children":2054},{"className":224,"code":2053,"language":226,"meta":158,"style":158},"anysort(arr, 'a.b-reverse()')\n\n// 可以看作\narr.sort(filter([\n  generatePlugin(walk('a.b')),\n  generatePlugin(reverse())\n]))\n",[2055],{"type":164,"tag":229,"props":2056,"children":2057},{"__ignoreMap":158},[2058,2091,2098,2106,2135,2178,2198],{"type":164,"tag":233,"props":2059,"children":2060},{"class":235,"line":236},[2061,2065,2070,2074,2078,2083,2087],{"type":164,"tag":233,"props":2062,"children":2063},{"style":813},[2064],{"type":170,"value":816},{"type":164,"tag":233,"props":2066,"children":2067},{"style":258},[2068],{"type":170,"value":2069},"(arr",{"type":164,"tag":233,"props":2071,"children":2072},{"style":268},[2073],{"type":170,"value":550},{"type":164,"tag":233,"props":2075,"children":2076},{"style":289},[2077],{"type":170,"value":292},{"type":164,"tag":233,"props":2079,"children":2080},{"style":295},[2081],{"type":170,"value":2082},"a.b-reverse()",{"type":164,"tag":233,"props":2084,"children":2085},{"style":289},[2086],{"type":170,"value":303},{"type":164,"tag":233,"props":2088,"children":2089},{"style":258},[2090],{"type":170,"value":860},{"type":164,"tag":233,"props":2092,"children":2093},{"class":235,"line":264},[2094],{"type":164,"tag":233,"props":2095,"children":2096},{"emptyLinePlaceholder":1536},[2097],{"type":170,"value":1539},{"type":164,"tag":233,"props":2099,"children":2100},{"class":235,"line":274},[2101],{"type":164,"tag":233,"props":2102,"children":2103},{"style":1746},[2104],{"type":170,"value":2105},"// 可以看作\n",{"type":164,"tag":233,"props":2107,"children":2108},{"class":235,"line":311},[2109,2114,2118,2122,2126,2130],{"type":164,"tag":233,"props":2110,"children":2111},{"style":258},[2112],{"type":170,"value":2113},"arr",{"type":164,"tag":233,"props":2115,"children":2116},{"style":268},[2117],{"type":170,"value":948},{"type":164,"tag":233,"props":2119,"children":2120},{"style":813},[2121],{"type":170,"value":1233},{"type":164,"tag":233,"props":2123,"children":2124},{"style":258},[2125],{"type":170,"value":1042},{"type":164,"tag":233,"props":2127,"children":2128},{"style":813},[2129],{"type":170,"value":1709},{"type":164,"tag":233,"props":2131,"children":2132},{"style":258},[2133],{"type":170,"value":2134},"([\n",{"type":164,"tag":233,"props":2136,"children":2137},{"class":235,"line":334},[2138,2143,2147,2152,2156,2160,2165,2169,2174],{"type":164,"tag":233,"props":2139,"children":2140},{"style":813},[2141],{"type":170,"value":2142},"  generatePlugin",{"type":164,"tag":233,"props":2144,"children":2145},{"style":258},[2146],{"type":170,"value":1042},{"type":164,"tag":233,"props":2148,"children":2149},{"style":813},[2150],{"type":170,"value":2151},"walk",{"type":164,"tag":233,"props":2153,"children":2154},{"style":258},[2155],{"type":170,"value":1042},{"type":164,"tag":233,"props":2157,"children":2158},{"style":289},[2159],{"type":170,"value":303},{"type":164,"tag":233,"props":2161,"children":2162},{"style":295},[2163],{"type":170,"value":2164},"a.b",{"type":164,"tag":233,"props":2166,"children":2167},{"style":289},[2168],{"type":170,"value":303},{"type":164,"tag":233,"props":2170,"children":2171},{"style":258},[2172],{"type":170,"value":2173},"))",{"type":164,"tag":233,"props":2175,"children":2176},{"style":268},[2177],{"type":170,"value":308},{"type":164,"tag":233,"props":2179,"children":2180},{"class":235,"line":352},[2181,2185,2189,2193],{"type":164,"tag":233,"props":2182,"children":2183},{"style":813},[2184],{"type":170,"value":2142},{"type":164,"tag":233,"props":2186,"children":2187},{"style":258},[2188],{"type":170,"value":1042},{"type":164,"tag":233,"props":2190,"children":2191},{"style":813},[2192],{"type":170,"value":971},{"type":164,"tag":233,"props":2194,"children":2195},{"style":258},[2196],{"type":170,"value":2197},"())\n",{"type":164,"tag":233,"props":2199,"children":2200},{"class":235,"line":361},[2201],{"type":164,"tag":233,"props":2202,"children":2203},{"style":258},[2204],{"type":170,"value":2205},"]))\n",{"type":164,"tag":1008,"props":2207,"children":2209},{"id":2208},"对象形式调用",[2210],{"type":170,"value":2208},{"type":164,"tag":172,"props":2212,"children":2213},{},[2214],{"type":170,"value":2215},"gangs.a.b.reverse() 这种对象形式调用的核心实现是 Proxy 的链式调用：gangs.a.b.reverse() 先后访问了三个属性：a、b、reverse，这三个属性都由同一个 Proxy 对象提供。",{"type":164,"tag":222,"props":2217,"children":2219},{"className":224,"code":2218,"language":226,"meta":158,"style":158},"const anysort => xs => wrapped(xs)\n\nconst wrapped = xs => {\n  let proxy = null\n  const visited = []\n  return (proxy = new Proxy(arr, {\n    get (target, prop) {\n      if (prop === 'reverse') {\n        return // ...\n      }\n      visited.push(prop)\n      return proxy\n    }\n  }))\n}\n",[2220],{"type":164,"tag":229,"props":2221,"children":2222},{"__ignoreMap":158},[2223,2258,2265,2292,2312,2332,2378,2413,2454,2467,2475,2504,2517,2525,2538],{"type":164,"tag":233,"props":2224,"children":2225},{"class":235,"line":236},[2226,2230,2235,2239,2244,2248,2253],{"type":164,"tag":233,"props":2227,"children":2228},{"style":240},[2229],{"type":170,"value":243},{"type":164,"tag":233,"props":2231,"children":2232},{"style":246},[2233],{"type":170,"value":2234}," anysort",{"type":164,"tag":233,"props":2236,"children":2237},{"style":252},[2238],{"type":170,"value":1317},{"type":164,"tag":233,"props":2240,"children":2241},{"style":1045},[2242],{"type":170,"value":2243}," xs",{"type":164,"tag":233,"props":2245,"children":2246},{"style":240},[2247],{"type":170,"value":1317},{"type":164,"tag":233,"props":2249,"children":2250},{"style":813},[2251],{"type":170,"value":2252}," wrapped",{"type":164,"tag":233,"props":2254,"children":2255},{"style":258},[2256],{"type":170,"value":2257},"(xs)\n",{"type":164,"tag":233,"props":2259,"children":2260},{"class":235,"line":264},[2261],{"type":164,"tag":233,"props":2262,"children":2263},{"emptyLinePlaceholder":1536},[2264],{"type":170,"value":1539},{"type":164,"tag":233,"props":2266,"children":2267},{"class":235,"line":274},[2268,2272,2276,2280,2284,2288],{"type":164,"tag":233,"props":2269,"children":2270},{"style":240},[2271],{"type":170,"value":243},{"type":164,"tag":233,"props":2273,"children":2274},{"style":1260},[2275],{"type":170,"value":2252},{"type":164,"tag":233,"props":2277,"children":2278},{"style":252},[2279],{"type":170,"value":255},{"type":164,"tag":233,"props":2281,"children":2282},{"style":1045},[2283],{"type":170,"value":2243},{"type":164,"tag":233,"props":2285,"children":2286},{"style":240},[2287],{"type":170,"value":1317},{"type":164,"tag":233,"props":2289,"children":2290},{"style":268},[2291],{"type":170,"value":1067},{"type":164,"tag":233,"props":2293,"children":2294},{"class":235,"line":311},[2295,2299,2304,2308],{"type":164,"tag":233,"props":2296,"children":2297},{"style":240},[2298],{"type":170,"value":1880},{"type":164,"tag":233,"props":2300,"children":2301},{"style":258},[2302],{"type":170,"value":2303}," proxy",{"type":164,"tag":233,"props":2305,"children":2306},{"style":252},[2307],{"type":170,"value":255},{"type":164,"tag":233,"props":2309,"children":2310},{"style":1913},[2311],{"type":170,"value":1916},{"type":164,"tag":233,"props":2313,"children":2314},{"class":235,"line":334},[2315,2319,2324,2328],{"type":164,"tag":233,"props":2316,"children":2317},{"style":240},[2318],{"type":170,"value":1075},{"type":164,"tag":233,"props":2320,"children":2321},{"style":246},[2322],{"type":170,"value":2323}," visited",{"type":164,"tag":233,"props":2325,"children":2326},{"style":252},[2327],{"type":170,"value":255},{"type":164,"tag":233,"props":2329,"children":2330},{"style":278},[2331],{"type":170,"value":349},{"type":164,"tag":233,"props":2333,"children":2334},{"class":235,"line":352},[2335,2339,2343,2348,2352,2357,2362,2366,2370,2374],{"type":164,"tag":233,"props":2336,"children":2337},{"style":1132},[2338],{"type":170,"value":1135},{"type":164,"tag":233,"props":2340,"children":2341},{"style":278},[2342],{"type":170,"value":1168},{"type":164,"tag":233,"props":2344,"children":2345},{"style":258},[2346],{"type":170,"value":2347},"proxy",{"type":164,"tag":233,"props":2349,"children":2350},{"style":252},[2351],{"type":170,"value":255},{"type":164,"tag":233,"props":2353,"children":2354},{"style":252},[2355],{"type":170,"value":2356}," new",{"type":164,"tag":233,"props":2358,"children":2359},{"style":813},[2360],{"type":170,"value":2361}," Proxy",{"type":164,"tag":233,"props":2363,"children":2364},{"style":278},[2365],{"type":170,"value":1042},{"type":164,"tag":233,"props":2367,"children":2368},{"style":258},[2369],{"type":170,"value":2113},{"type":164,"tag":233,"props":2371,"children":2372},{"style":268},[2373],{"type":170,"value":550},{"type":164,"tag":233,"props":2375,"children":2376},{"style":268},[2377],{"type":170,"value":1067},{"type":164,"tag":233,"props":2379,"children":2380},{"class":235,"line":361},[2381,2387,2391,2396,2400,2405,2409],{"type":164,"tag":233,"props":2382,"children":2384},{"style":2383},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[2385],{"type":170,"value":2386},"    get",{"type":164,"tag":233,"props":2388,"children":2389},{"style":268},[2390],{"type":170,"value":1168},{"type":164,"tag":233,"props":2392,"children":2393},{"style":1045},[2394],{"type":170,"value":2395},"target",{"type":164,"tag":233,"props":2397,"children":2398},{"style":268},[2399],{"type":170,"value":550},{"type":164,"tag":233,"props":2401,"children":2402},{"style":1045},[2403],{"type":170,"value":2404}," prop",{"type":164,"tag":233,"props":2406,"children":2407},{"style":268},[2408],{"type":170,"value":1062},{"type":164,"tag":233,"props":2410,"children":2411},{"style":268},[2412],{"type":170,"value":1067},{"type":164,"tag":233,"props":2414,"children":2415},{"class":235,"line":369},[2416,2421,2425,2430,2434,2438,2442,2446,2450],{"type":164,"tag":233,"props":2417,"children":2418},{"style":1132},[2419],{"type":170,"value":2420},"      if",{"type":164,"tag":233,"props":2422,"children":2423},{"style":278},[2424],{"type":170,"value":1168},{"type":164,"tag":233,"props":2426,"children":2427},{"style":258},[2428],{"type":170,"value":2429},"prop",{"type":164,"tag":233,"props":2431,"children":2432},{"style":252},[2433],{"type":170,"value":1144},{"type":164,"tag":233,"props":2435,"children":2436},{"style":289},[2437],{"type":170,"value":292},{"type":164,"tag":233,"props":2439,"children":2440},{"style":295},[2441],{"type":170,"value":971},{"type":164,"tag":233,"props":2443,"children":2444},{"style":289},[2445],{"type":170,"value":303},{"type":164,"tag":233,"props":2447,"children":2448},{"style":278},[2449],{"type":170,"value":1955},{"type":164,"tag":233,"props":2451,"children":2452},{"style":268},[2453],{"type":170,"value":1960},{"type":164,"tag":233,"props":2455,"children":2456},{"class":235,"line":398},[2457,2462],{"type":164,"tag":233,"props":2458,"children":2459},{"style":1132},[2460],{"type":170,"value":2461},"        return",{"type":164,"tag":233,"props":2463,"children":2464},{"style":1746},[2465],{"type":170,"value":2466}," // ...\n",{"type":164,"tag":233,"props":2468,"children":2469},{"class":235,"line":419},[2470],{"type":164,"tag":233,"props":2471,"children":2472},{"style":268},[2473],{"type":170,"value":2474},"      }\n",{"type":164,"tag":233,"props":2476,"children":2477},{"class":235,"line":454},[2478,2483,2487,2492,2496,2500],{"type":164,"tag":233,"props":2479,"children":2480},{"style":258},[2481],{"type":170,"value":2482},"      visited",{"type":164,"tag":233,"props":2484,"children":2485},{"style":268},[2486],{"type":170,"value":948},{"type":164,"tag":233,"props":2488,"children":2489},{"style":813},[2490],{"type":170,"value":2491},"push",{"type":164,"tag":233,"props":2493,"children":2494},{"style":278},[2495],{"type":170,"value":1042},{"type":164,"tag":233,"props":2497,"children":2498},{"style":258},[2499],{"type":170,"value":2429},{"type":164,"tag":233,"props":2501,"children":2502},{"style":278},[2503],{"type":170,"value":860},{"type":164,"tag":233,"props":2505,"children":2506},{"class":235,"line":462},[2507,2512],{"type":164,"tag":233,"props":2508,"children":2509},{"style":1132},[2510],{"type":170,"value":2511},"      return",{"type":164,"tag":233,"props":2513,"children":2514},{"style":258},[2515],{"type":170,"value":2516}," proxy\n",{"type":164,"tag":233,"props":2518,"children":2519},{"class":235,"line":470},[2520],{"type":164,"tag":233,"props":2521,"children":2522},{"style":268},[2523],{"type":170,"value":2524},"    }\n",{"type":164,"tag":233,"props":2526,"children":2527},{"class":235,"line":499},[2528,2533],{"type":164,"tag":233,"props":2529,"children":2530},{"style":268},[2531],{"type":170,"value":2532},"  }",{"type":164,"tag":233,"props":2534,"children":2535},{"style":278},[2536],{"type":170,"value":2537},"))\n",{"type":164,"tag":233,"props":2539,"children":2540},{"class":235,"line":519},[2541],{"type":164,"tag":233,"props":2542,"children":2543},{"style":268},[2544],{"type":170,"value":1216},{"type":164,"tag":172,"props":2546,"children":2547},{},[2548,2550,2555],{"type":170,"value":2549},"访问 proxy.a，把 'a' 放到 visited 中，返回 proxy；访问 proxy.b，把 'b' 放到 visited 中，返回 proxy... 这样就能无限层级访问对象路径了。直到访问到某个插件，这时就可以把已访问的路径 ",{"type":164,"tag":233,"props":2551,"children":2552},{},[2553],{"type":170,"value":2554},"'a', 'b'",{"type":170,"value":2556}," 作为参数带入，这时就不再返回 proxy，而是返回排序结果。",{"type":164,"tag":165,"props":2558,"children":2560},{"id":2559},"类型实现",[2561],{"type":170,"value":2559},{"type":164,"tag":1008,"props":2563,"children":2565},{"id":2564},"从对象获得可行路径",[2566],{"type":170,"value":2564},{"type":164,"tag":172,"props":2568,"children":2569},{},[2570,2572,2577],{"type":170,"value":2571},"显然，你可以给排序函数传任意格式数据，而极端情况只有两个：在 ",{"type":164,"tag":233,"props":2573,"children":2574},{},[2575],{"type":170,"value":2576},"1,2,3",{"type":170,"value":2578}," 排序时使用 'length' 排序是错误的；给 [[1],2,3] 排序使用 'length' 确情有可原（正确的）。",{"type":164,"tag":172,"props":2580,"children":2581},{},[2582,2584,2592],{"type":170,"value":2583},"根据这两个极端情况，我们设定的目标是，根据传入数据的类型生成一个有限的字符串字面量集合，这个集合包含所有可能的正确输入。只要传入的字符串字面量参数不在这个集合中，编辑器自然会报错。假设有",{"type":164,"tag":187,"props":2585,"children":2589},{"href":2586,"rel":2587},"https://www.typescriptlang.org/play?#code/GYVwdgxgLglg9mABAQzATwM5wE5QDwCCASkQHwAUy22AXIsUQDSIZS2IDKbMYA5gGrIANjAAmAdRhQAFoRKkAlIgDeiAPQAqRADpdiDWsQBfAFAmoaAA4BTTtz6CREqbIalEAXkQByZN8QAPj4ARt5maoYA8gDSJqiYOFDkANoAusy+3gomEYgxcehYuCnpIVk5hgDu2Ai8BQnFaRlwMtbY5WZAA",[2588],"nofollow",[2590],{"type":170,"value":2591},"以下代码",{"type":170,"value":2593},"，StringValidWith(ARR) 类型为 'a' | 'b'，那么只有 'a' 或 'b' 两种调用是正确的，其它调用都应该报红。",{"type":164,"tag":172,"props":2595,"children":2596},{},[2597],{"type":164,"tag":865,"props":2598,"children":2601},{"alt":2599,"src":2600},"TS Playground Example","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220513201932.png",[],{"type":164,"tag":172,"props":2603,"children":2604},{},[2605],{"type":170,"value":2606},"所以，StringValidWith 需要遍历 ARR，并返回所有可行路径：",{"type":164,"tag":222,"props":2608,"children":2610},{"className":224,"code":2609,"language":226,"meta":158,"style":158},"const data = [{a:{b:{c:{d:1}}}}]\n\n// 'a'|'a.b'|'a.b.c'|'a.b.c.d'\nStringValidWith\u003Ctypeof data[0]>\n",[2611],{"type":164,"tag":229,"props":2612,"children":2613},{"__ignoreMap":158},[2614,2687,2694,2702],{"type":164,"tag":233,"props":2615,"children":2616},{"class":235,"line":236},[2617,2621,2626,2630,2634,2639,2643,2648,2652,2656,2661,2665,2670,2674,2678,2683],{"type":164,"tag":233,"props":2618,"children":2619},{"style":240},[2620],{"type":170,"value":243},{"type":164,"tag":233,"props":2622,"children":2623},{"style":246},[2624],{"type":170,"value":2625}," data",{"type":164,"tag":233,"props":2627,"children":2628},{"style":252},[2629],{"type":170,"value":255},{"type":164,"tag":233,"props":2631,"children":2632},{"style":258},[2633],{"type":170,"value":433},{"type":164,"tag":233,"props":2635,"children":2636},{"style":268},[2637],{"type":170,"value":2638},"{",{"type":164,"tag":233,"props":2640,"children":2641},{"style":278},[2642],{"type":170,"value":187},{"type":164,"tag":233,"props":2644,"children":2645},{"style":268},[2646],{"type":170,"value":2647},":{",{"type":164,"tag":233,"props":2649,"children":2650},{"style":278},[2651],{"type":170,"value":1307},{"type":164,"tag":233,"props":2653,"children":2654},{"style":268},[2655],{"type":170,"value":2647},{"type":164,"tag":233,"props":2657,"children":2658},{"style":278},[2659],{"type":170,"value":2660},"c",{"type":164,"tag":233,"props":2662,"children":2663},{"style":268},[2664],{"type":170,"value":2647},{"type":164,"tag":233,"props":2666,"children":2667},{"style":278},[2668],{"type":170,"value":2669},"d",{"type":164,"tag":233,"props":2671,"children":2672},{"style":268},[2673],{"type":170,"value":286},{"type":164,"tag":233,"props":2675,"children":2676},{"style":324},[2677],{"type":170,"value":195},{"type":164,"tag":233,"props":2679,"children":2680},{"style":268},[2681],{"type":170,"value":2682},"}}}}",{"type":164,"tag":233,"props":2684,"children":2685},{"style":258},[2686],{"type":170,"value":451},{"type":164,"tag":233,"props":2688,"children":2689},{"class":235,"line":264},[2690],{"type":164,"tag":233,"props":2691,"children":2692},{"emptyLinePlaceholder":1536},[2693],{"type":170,"value":1539},{"type":164,"tag":233,"props":2695,"children":2696},{"class":235,"line":274},[2697],{"type":164,"tag":233,"props":2698,"children":2699},{"style":1746},[2700],{"type":170,"value":2701},"// 'a'|'a.b'|'a.b.c'|'a.b.c.d'\n",{"type":164,"tag":233,"props":2703,"children":2704},{"class":235,"line":311},[2705,2710,2715,2720,2725,2730],{"type":164,"tag":233,"props":2706,"children":2707},{"style":258},[2708],{"type":170,"value":2709},"StringValidWith",{"type":164,"tag":233,"props":2711,"children":2712},{"style":252},[2713],{"type":170,"value":2714},"\u003Ctypeof",{"type":164,"tag":233,"props":2716,"children":2717},{"style":258},[2718],{"type":170,"value":2719}," data[",{"type":164,"tag":233,"props":2721,"children":2722},{"style":324},[2723],{"type":170,"value":2724},"0",{"type":164,"tag":233,"props":2726,"children":2727},{"style":258},[2728],{"type":170,"value":2729},"]",{"type":164,"tag":233,"props":2731,"children":2732},{"style":252},[2733],{"type":170,"value":2734},">\n",{"type":164,"tag":172,"props":2736,"children":2737},{},[2738,2740,2747],{"type":170,"value":2739},"实现",{"type":164,"tag":187,"props":2741,"children":2744},{"href":2742,"rel":2743},"https://www.typescriptlang.org/play?#code/C4TwDgpgBA4hwAUCGwAWAeAUFKAVKEAHsBAHYAmAzlAPYBGAVhAMbAA02UA0gcWVVADWEEDQBmeKAF4hI8XkwA+aZx5ESFapWAAnAJakA5pwD8eANpcAurw0D6TVqagADACQBvLgF8XUAD6unj4AdJ5wiCgYuJZWir6cAFxBXgk4yQDkGZiYoJBQJNoA+gCM0rDwyGjoHkiJHnT1zPXkiaQArgC2dBA63v3eikA",[2588],[2745],{"type":170,"value":2746},"见下 GetPath 类型",{"type":170,"value":2748},"，它也是一个简单的递归函数。它从对象中获取所有的键，返回这些键。一但键对应的值还是对象，则进入值对象的递归。",{"type":164,"tag":172,"props":2750,"children":2751},{},[2752],{"type":164,"tag":865,"props":2753,"children":2755},{"alt":2599,"src":2754},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220513203605.png",[],{"type":164,"tag":172,"props":2757,"children":2758},{},[2759,2761,2768],{"type":170,"value":2760},"为了支持访问数组和字符串的 length 属性，我们对 GetPath 进行一些改造，",{"type":164,"tag":187,"props":2762,"children":2765},{"href":2763,"rel":2764},"https://www.typescriptlang.org/play?#code/C4TwDgpgBA4hwAUCGwAWAeAUFKAVKEAHsBAHYAmAzlAPYBGAVhAMbAA02UA0gcWVVADWEEDQBmeKAF4hI8XkwA+aZx5ESFapWAAnAJakA5pwD8eANpcAurw0CAFElIhzNgD5Rt+owEpTUAAMAEgBvLgBfAKgPYLDwgDoAGzJDNADOAC4La1t+anomVn9YiKiY0Ij40LhEFAxcSytFSMzAipacLIByLsxMUEgoHSQAd1xwaBkQpAyQulnmWc5yLNIAVwBbOggdV04Ibohe8JPwvoHoEm1pWHhkNHRhsYnFIA",[2588],[2766],{"type":170,"value":2767},"见下",{"type":170,"value":210},{"type":164,"tag":172,"props":2770,"children":2771},{},[2772],{"type":164,"tag":865,"props":2773,"children":2775},{"alt":2599,"src":2774},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220513204741.png",[],{"type":164,"tag":1008,"props":2777,"children":2779},{"id":2778},"从数组推断子元素类型",[2780],{"type":170,"value":2778},{"type":164,"tag":172,"props":2782,"children":2783},{},[2784,2786,2792],{"type":170,"value":2785},"由于传入的是数组，数组内部的元素类型不一定是同一种，所以要先从数组中获取子元素类型，再把子元素类型传给 GetPath 以获得所有路径。",{"type":164,"tag":187,"props":2787,"children":2790},{"href":2788,"rel":2789},"https://www.typescriptlang.org/play?#code/C4TwDgpgBA4hwElgQLYBVwQDwA0DKUEAHsgHYAmAzlAK6kDWpA9gO6kDaAugHxQC8AKChR8hEhArUAFAEtSAMwgAnKElQZIASi5CoAflXJ0mXQC4opCADdlAgaEhQlAQxYbofKOwDeUZ+dIaFAAjZS4oAF8AGl9g80pgJTkAc3CIzjtMuwdoZASAJVd3flh4NWNILBc3TG4gA",[2588],[2791],{"type":170,"value":2767},{"type":170,"value":2793},"，一个灵活的 infer 就可以把类数组中所有子元素类型以集合的形式推断出来。",{"type":164,"tag":172,"props":2795,"children":2796},{},[2797],{"type":164,"tag":865,"props":2798,"children":2800},{"alt":2599,"src":2799},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220515154134.png",[],{"type":164,"tag":172,"props":2802,"children":2803},{},[2804,2806,2813],{"type":170,"value":2805},"GetItemType 中的 infer 在这里是有坑的，把子元素类型以集合的形式推断出来，也就意味着抹平顺序差异。传入的元组可以是顺序相关的，但返回的集合却顺序无关。",{"type":164,"tag":187,"props":2807,"children":2810},{"href":2808,"rel":2809},"https://www.typescriptlang.org/play?#code/C4TwDgpgBA4hwElgQLYBVwQDwA0DKUEAHsgHYAmAzlAK6kDWpA9gO6kDaAugHxQC8AKChR8hEhArUAFAEtSAMwgAnKElQZIASi5CoAflXJ0mXQC4opCADdlAgQBt4UZJWABGc+zcAaKACZOfigvXwC7Oxd3IPY-UM47AHoE-ygAHyg3AVBIZwhXNDyovlh4NWNILGyIJnlc1zduIA",[2588],[2811],{"type":170,"value":2812},"见下代码",{"type":170,"value":2814},"，从元组类型的 test1 中推断出子元素类型为 1 | 2 集合。",{"type":164,"tag":172,"props":2816,"children":2817},{},[2818],{"type":164,"tag":865,"props":2819,"children":2821},{"alt":2599,"src":2820},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220515154908.png",[],{"type":164,"tag":172,"props":2823,"children":2824},{},[2825],{"type":170,"value":2826},"不过在排序中，待排序数组和顺序不相关，所以我们可以使用这个 infer。由于待排序数组的内部的元素类型大致是一致的，所以也并不需要过分关心这里及之后的性能损耗。把数组子类型这个集合转为元组后，计算出所有对象的可行路径，按照步骤，简单可行。",{"type":164,"tag":172,"props":2828,"children":2829},{},[2830,2832,2843,2845,2852,2854,2865],{"type":170,"value":2831},"集合转元组，应算是 TypeScript 中一个有名的黑魔法操作。Github 能搜到很多相关讨论，比如 ",{"type":164,"tag":187,"props":2833,"children":2836},{"href":2834,"rel":2835},"https://github.com/microsoft/TypeScript/issues/13298",[2588],[2837],{"type":164,"tag":2838,"props":2839,"children":2840},"i",{},[2841],{"type":170,"value":2842},"union to tuple",{"type":170,"value":2844},"，详细讨论了集合转元组的可行性以及相关实践建议。这里我直接把代码搬过来，",{"type":164,"tag":187,"props":2846,"children":2849},{"href":2847,"rel":2848},"https://www.typescriptlang.org/play?#code/C4TwDgpgBAqgdgSwPZwCpIJJ2BATgZwgGNhk4AeGAPigF4AoKKAChiggA8c4ATfWKAH4WzANYAuFh0kwAlHRoA3JAh7zaSlWqiS4ERXnmdufRiIlQEcAGZ4oGdZtXzhGHVD0Hc9eqEixEFAAZAEN8YEoaBiZ4MnQsHAJiUhRI9i4IXn5mZmlLGzsAJUcoZWcoM2FCs119PB8-aFiUdFQAVzAAGwhyVCizAG1UAF10k34BzzxhyqgBmaZJAYA6Vea0JHaunoBRDiJOtp4e1AAaALJQ8N6qW-P1q4i+mYbwaBxwuguWzY7u8gA5CEAVAAD5QAEAIxB4IBRABVCAA",[2588],[2850],{"type":170,"value":2851},"如下",{"type":170,"value":2853},"，先用 UnionToIntersection 把集合 1|2 转换成对应的函数交集类型 ((x: 1) => void) & ((x: 2) => void)，再使用 UnionLast 把参数类型逐个推断出来就好",{"type":164,"tag":183,"props":2855,"children":2856},{},[2857],{"type":164,"tag":187,"props":2858,"children":2862},{"href":2859,"ariaDescribedBy":2860,"dataFootnoteRef":158,"id":2861},"#user-content-fn-union_to_tuple",[191],"user-content-fnref-union_to_tuple",[2863],{"type":170,"value":2864},"3",{"type":170,"value":210},{"type":164,"tag":172,"props":2867,"children":2868},{},[2869],{"type":164,"tag":865,"props":2870,"children":2872},{"alt":2599,"src":2871},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220515161832.png",[],{"type":164,"tag":172,"props":2874,"children":2875},{},[2876,2878,2884],{"type":170,"value":2877},"为什么要在 Anysort 中使用黑魔法，这不是这篇文章想要讨论的话题。我们回到正题，改造 GetPath，添加内置插件类型，然后添加类型 GetPaths 便于处理元组。",{"type":164,"tag":187,"props":2879,"children":2882},{"href":2880,"rel":2881},"https://www.typescriptlang.org/play?#code/C4TwDgpgBAQgrgSwDYBMCSA7ACkuBzBDAZygF4oByAJwgDcIqiIKoAfSsXAjCgKF9CQoAcQjAsAQ2AALIgB4AGgGUoEAB7AIGFCTgYA1hgD2AdwwBtALoA+MryhRlqjVp1RzhAGYMoACQgSKAA0UAB04V4+AEoQRMCW9lAA-CJikjJy-oFQAGRQRgBGAFYQAMbAtuyi4lKycjFx1okAXFAYdAz8gtDVaJoAtgAq4BCKKuqa2roGxmZWtqSJThOuJAAUkVRQfRBDIwCUVokpO3uQLW0dVF0jUFQSJsNC5OYA3okSrRhw-QUMRwBfILvBwFVpxKiEPCAhICW6aOJRB5PaDkACqGAQRgwgyMgzgnFGvQGKLk90eI2sTX4NyECOAZFSNRk8npSIpkGpNO6TPS0jkiUGzkmbkKJXKQUSAGlhasoPoICAjJ4oELyAqlSrBrwFtLZVMoBCocdVeYpZZ9W41hIMCArGxDcBIRg8PsTQADAAkrylAPdDq9PoBoSQWjwMn97EDvoAtN74Mh0NguIQiH6A97fSGwzI468E6hMDh8Km-RdBmaLSsDWKysAPZn01HG6FvdU+XIK+brE2oNGAXmC0ni9w0+6Lv3xw5WhQ+HChBisTijJhNIw60u5GjdQ41mjLSR9yk1mt9K01mpWmj9mRbLQjAgUDfSHeH0+oF8rjfqzpEiez1AmzbM+r6PjeJwfpc9DXPO0CLtiAAyEhxFuO5QPBy6rgwTDlJu24HlAJ6XoBGDeFsUQgVA95gVAJpRBc7TQbScGYtiuL4oSnZoeYgxVi4BrmIxDAJA4KRHNO7jhKEGHsQSoZyAAomopS4CgoyDCEGFIShgxUtYmmsRg2nAFxlhAA",[2588],[2883],{"type":170,"value":2767},{"type":170,"value":2885},"，假使我们有了插件 reverse 和 plugin，那么无论是传入 'a-reverse' 还是 'a.length-plugin' 都应该是正确的调用。",{"type":164,"tag":172,"props":2887,"children":2888},{},[2889],{"type":164,"tag":865,"props":2890,"children":2892},{"alt":2599,"src":2891},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220515163145.png",[],{"type":164,"tag":1008,"props":2894,"children":2896},{"id":2895},"代理的类型",[2897],{"type":170,"value":2895},{"type":164,"tag":172,"props":2899,"children":2900},{},[2901,2903,2909],{"type":170,"value":2902},"最后讲一讲对象形式调用的类型实现。假如有子元素类型 {a:1}，希望得到 { a:{ reverse() } }。有了 GetPath 的递归基础上，改造其实非常简单。",{"type":164,"tag":187,"props":2904,"children":2907},{"href":2905,"rel":2906},"https://www.typescriptlang.org/play?#code/C4TwDgpgBACgNgVwOYEsB2BhAhnOBnAHgEEAlEgPigF4oBvAKCigAsJcB7KACgEoAuKKRL0AvvXqhIUAOIRgMLMGYFGgslAgAPYBDQATPFARoA1mnYB3NAG0AugBpVAFWpqS1gAy36lGgybWANJQ6FAmECDsAGZQTrZ8qkxOQbYa2roGUOwARgBWEADGwIlQAPwycgpKxGT2sSmUAGSwiKiYOPg1FCUCyYGpzfDI6Ni4hELkolCDrSMd42ST9FHGRSjsaFBYaCB47ABOwF1pOvqGxmaWNrbkXJp4AkI8dKr7cgj7m-db56bmVj8KvJFMoJqJ6NtdgdgFxrLQsHwAORYREiWw8AB0WAxzCAA",[2588],[2908],{"type":170,"value":2812},{"type":170,"value":2910},"，PluginsCalls 是一个根据现有插件返回固定的函数接口对象的类型，GetPath 只需要不断递归对象的键值对，并把值与函数接口的交集返回即可。这样一来，就有了在任意属性调用任意插件的类型能力。",{"type":164,"tag":172,"props":2912,"children":2913},{},[2914],{"type":164,"tag":865,"props":2915,"children":2917},{"alt":2599,"src":2916},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220515170506.png",[],{"type":164,"tag":165,"props":2919,"children":2921},{"id":2920},"阅读更多",[2922],{"type":170,"value":2920},{"type":164,"tag":172,"props":2924,"children":2925},{},[2926],{"type":170,"value":2927},"总结一下，无论是字符串形式的调用还是对象形式的调用，在 Anysort 的类型中的实现都主要依赖了递归类型。文章前两部分简述了其原理。但文章中的代码只是一种最简的还原。比如，没有任何容错，也不支持扩展。Anysort 不仅有内置插件，它还支持插件扩展。这些插件的调用有些需要传参，另一些则不需要... 如何约束诸如之类的调用方式，或仅确保其不会出错，就需要引入一堆不相关代码。在 Anysort 完成时，我惊讶地发现，光是类型代码就占用了 10KB 体积。我的第一感觉就是“这是不可接受的”。",{"type":164,"tag":172,"props":2929,"children":2930},{},[2931],{"type":170,"value":2932},"排除类型体操的可玩性，TS 在我看来是非常不适合前端来写的，至少是不适合在项目中普及的。JavaScript 是一种简单有效的脚本语言，使用 JS 意味着我尽可能希望在保证代码质量底线的情况下，更快速地完成项目，而不是每天写代码却要花上一半的时间来设计类型。类型系统，包括项目中的代码类型以及类型系统本身都只会越来越复杂，TS 使许多程序员陷入了“即使是编写简单的页面，也需要用类型来保证质量，或是它可以给维护者带来好处”的误区。这可能是一种有效的自我安慰或管理手段。",{"type":164,"tag":172,"props":2934,"children":2935},{},[2936,2938,2945],{"type":170,"value":2937},"更多吐槽 TS 的话就不说了。但如果你对类型体操有兴趣，可以去 ",{"type":164,"tag":187,"props":2939,"children":2942},{"href":2940,"rel":2941},"https://github.com/type-challenges/type-challenges",[2588],[2943],{"type":170,"value":2944},"type-challenges",{"type":170,"value":2946}," 这个项目看看。它搜罗了百来道 TS 类型编程的题目，从易到难都有，而且大部分题目都有很好的解答。这是提高 TS 泛型能力非常有效的一条路子。",{"type":164,"tag":172,"props":2948,"children":2949},{},[2950,2952,2959],{"type":170,"value":2951},"最后，哪怕你对 Anysort 有一丝兴趣，欢迎参观 ",{"type":164,"tag":187,"props":2953,"children":2956},{"href":2954,"rel":2955},"https://github.com/Lionad-Morotar/anysort",[2588],[2957],{"type":170,"value":2958},"Anysort@GitHub",{"type":170,"value":2960},"。项目是半个玩具，还有很多不完善的地方，欢迎 PR。",{"type":164,"tag":2962,"props":2963,"children":2966},"section",{"className":2964,"dataFootnotes":158},[2965],"footnotes",[2967,2974],{"type":164,"tag":165,"props":2968,"children":2971},{"className":2969,"id":191},[2970],"sr-only",[2972],{"type":170,"value":2973},"Footnotes",{"type":164,"tag":2975,"props":2976,"children":2977},"ol",{},[2978,3000,3019],{"type":164,"tag":2979,"props":2980,"children":2982},"li",{"id":2981},"user-content-fn-anysort-1th",[2983,2989,2991],{"type":164,"tag":187,"props":2984,"children":2986},{"href":2985},"/_achieved/2021-01/anysort-1th",[2987],{"type":170,"value":2988},"《一文学会排序》",{"type":170,"value":2990}," ",{"type":164,"tag":187,"props":2992,"children":2997},{"href":2993,"ariaLabel":2994,"className":2995,"dataFootnoteBackref":158},"#user-content-fnref-anysort-1th","Back to reference 1",[2996],"data-footnote-backref",[2998],{"type":170,"value":2999},"↩",{"type":164,"tag":2979,"props":3001,"children":3003},{"id":3002},"user-content-fn-dict",[3004,3011,3012],{"type":164,"tag":187,"props":3005,"children":3008},{"href":3006,"rel":3007},"https://juejin.cn/post/6872111128135073806",[2588],[3009],{"type":170,"value":3010},"《一份不可多得的 TS 学习指南》",{"type":170,"value":2990},{"type":164,"tag":187,"props":3013,"children":3017},{"href":3014,"ariaLabel":3015,"className":3016,"dataFootnoteBackref":158},"#user-content-fnref-dict","Back to reference 2",[2996],[3018],{"type":170,"value":2999},{"type":164,"tag":2979,"props":3020,"children":3022},{"id":3021},"user-content-fn-union_to_tuple",[3023,3025,3032,3034],{"type":170,"value":3024},"有关集合转元组的详细中文解释见",{"type":164,"tag":187,"props":3026,"children":3029},{"href":3027,"rel":3028},"https://zhuanlan.zhihu.com/p/58704376",[2588],[3030],{"type":170,"value":3031},"《TypeScript 奇技淫巧 union to tuple》",{"type":170,"value":3033},"。 ",{"type":164,"tag":187,"props":3035,"children":3039},{"href":3036,"ariaLabel":3037,"className":3038,"dataFootnoteBackref":158},"#user-content-fnref-union_to_tuple","Back to reference 3",[2996],[3040],{"type":170,"value":2999},{"type":164,"tag":3042,"props":3043,"children":3044},"style",{},[3045],{"type":170,"value":3046},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":158,"searchDepth":264,"depth":264,"links":3048},[3049,3050,3051,3056,3061,3062],{"id":167,"depth":264,"text":167},{"id":213,"depth":264,"text":213},{"id":1004,"depth":264,"text":1004,"children":3052},[3053,3054,3055],{"id":1010,"depth":274,"text":1010},{"id":1726,"depth":274,"text":1726},{"id":2208,"depth":274,"text":2208},{"id":2559,"depth":264,"text":2559,"children":3057},[3058,3059,3060],{"id":2564,"depth":274,"text":2564},{"id":2778,"depth":274,"text":2778},{"id":2895,"depth":274,"text":2895},{"id":2920,"depth":264,"text":2920},{"id":191,"depth":264,"text":2973},"markdown","content:2.articles:1108.anysort-2th.md","content","2.articles/1108.anysort-2th.md","2.articles/1108.anysort-2th","md",[3070,3072],{"_path":70,"title":69,"description":3071},"排除人的因素，设计模式的本质只是相关代码复用。本文通过使用JS仿制并简化了几种OOL中经典设计模式，以探讨经典设计模式和代码模板的区别主要在于代码复用的层次不同，以及粗浅聊了聊设计模式与语言特征之间此强彼弱的关系。",{"_path":76,"title":75,"description":3073},"传统网页的渲染是基于像素的，所以常出现锯齿。本文简单介绍了锯齿出现的成因，以及CSS中相关锯齿处理的字体平滑、图片渲染属性，并通过实践创造了一种类似FXAA原理的background背景图案抗锯齿技术poaa（pixel-offset-anti-aliasing）。",1742745232701]