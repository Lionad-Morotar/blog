[{"data":1,"prerenderedAt":3080},["ShallowReactive",2],{"navigation":3,"/articles/anysort-2th":161,"/articles/anysort-2th-surround":3075},[4,35,92,98,125,131,155],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83,86,89],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🖌️ Blockies Animation","/maps/_fe-framework/motion/blockies-animation",{"title":45,"_path":46},"🌪️ Tailwind v4 如何兼容预处理器","/articles/tailwind4-with-sass",{"title":48,"_path":49},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":51,"_path":52},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":54,"_path":55},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":57,"_path":58},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":60,"_path":61},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":63,"_path":64},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":66,"_path":67},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":69,"_path":70},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":72,"_path":73},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":75,"_path":76},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":78,"_path":79},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":81,"_path":82},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":84,"_path":85},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":87,"_path":88},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":90,"_path":91},"📝 技术博客归档","/articles/archive",{"title":93,"_path":94,"children":95},"读书笔记 / Notes","/books",[96],{"title":97,"_path":94},"📕 读书笔记",{"title":99,"_path":100,"children":101},"吉他剧场 / Music","/music",[102,104,107,110,113,116,119,122],{"title":103,"_path":100},"🎸 FingerStyle！",{"title":105,"_path":106},"🌬️ 等待的风","/music/wind",{"title":108,"_path":109},"💕 约定的海洋","/music/ocean",{"title":111,"_path":112},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":114,"_path":115},"🌏 残酷天使的行动纲领","/music/eva",{"title":117,"_path":118},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":120,"_path":121},"🍷 Wu Wei","/music/wu-wei",{"title":123,"_path":124},"🌅 无题","/music/untitled",{"title":126,"_path":127,"children":128},"知识地图 / Maps","/maps",[129],{"title":130,"_path":127},"🏁 知识地图",{"title":132,"_path":133,"children":134},"造物 / Make","/tools",[135,137,140,143,146,149,152],{"title":136,"_path":133},"🧰 工具收集",{"title":138,"_path":139},"📕 博客","/tools/blog",{"title":141,"_path":142},"🥥 Coconut","/tools/coconut",{"title":144,"_path":145},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":147,"_path":148},"🌐 AnySort","/tools/anysort",{"title":150,"_path":151},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":153,"_path":154},"👓 Crapto","/tools/crypto-inline",{"title":156,"_path":157,"children":158},"我 / About","/hire",[159],{"title":160,"_path":157},"📬 技术简历",{"_path":79,"_dir":162,"_draft":163,"_partial":163,"_locale":164,"title":78,"description":165,"body":166,"_type":3069,"_id":3070,"_source":3071,"_file":3072,"_stem":3073,"_extension":3074},"articles",false,"","上一篇讲 anysort 的文章说到因网易云音乐的歌单排序功能较弱，我们自己实现的用来给歌单自定义排序的排序库的思路。这篇文章在排序库的基础上，介绍了其 TypeScript 类型实现。",{"type":167,"children":168,"toc":3053},"root",[169,177,183,217,222,227,802,807,867,875,880,919,926,931,983,996,1003,1008,1013,1019,1024,1245,1250,1730,1735,1740,2052,2057,2212,2217,2222,2551,2563,2568,2573,2585,2600,2608,2613,2741,2755,2762,2775,2782,2787,2800,2807,2821,2828,2833,2872,2879,2892,2899,2904,2917,2924,2929,2934,2939,2953,2967,3047],{"type":170,"tag":171,"props":172,"children":174},"element","h2",{"id":173},"前言",[175],{"type":176,"value":173},"text",{"type":170,"tag":178,"props":179,"children":180},"p",{},[181],{"type":176,"value":182},"去年一月的时候，我写了一个多属性排序库 Anysort，给网易云歌单用作自定义排序。正好最近在看其它语言，突然想起 TypeScript 里也有泛型这个东西，我估摸着 TS 正好能给 Anysort 补上一些高级类型约束，于是动手完成了。我特意回到 TS 来玩玩，结果这下惊住了我，TS 的泛型太特喵好玩了！",{"type":170,"tag":178,"props":184,"children":185},{},[186,188,202,204,215],{"type":176,"value":187},"那会儿我写了一篇文章介绍了 Anysort 的实现原理",{"type":170,"tag":189,"props":190,"children":191},"sup",{},[192],{"type":170,"tag":193,"props":194,"children":199},"a",{"href":195,"ariaDescribedBy":196,"dataFootnoteRef":164,"id":198},"#user-content-fn-anysort-1th",[197],"footnote-label","user-content-fnref-anysort-1th",[200],{"type":176,"value":201},"1",{"type":176,"value":203},"，但经过功能更替，代码更迭，早就不再适合阅读。此文章用作去年那篇的补充，额外会讲 Anysort 中一些高级类型的实现方法，但不会涉及基础知识。如果看文章时有任何疑惑的地方，推荐查字典",{"type":170,"tag":189,"props":205,"children":206},{},[207],{"type":170,"tag":193,"props":208,"children":212},{"href":209,"ariaDescribedBy":210,"dataFootnoteRef":164,"id":211},"#user-content-fn-dict",[197],"user-content-fnref-dict",[213],{"type":176,"value":214},"2",{"type":176,"value":216},"。",{"type":170,"tag":171,"props":218,"children":220},{"id":219},"排序示例",[221],{"type":176,"value":219},{"type":170,"tag":178,"props":223,"children":224},{},[225],{"type":176,"value":226},"首先我用例子简单说明一下 Anysort 的调用方式。现在回到二十世纪黑帮时代，警长在警察局关了一票黑帮，知道他们的姓名、年龄和做过的坏事这几个数据，想做一些排序。",{"type":170,"tag":228,"props":229,"children":233},"pre",{"className":230,"code":231,"language":232,"meta":164,"style":164},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","const gangs = [\n  {\n    name: 'A',\n    age: 33,\n    bads: []\n  },\n  {\n    name: 'B',\n    age: 25,\n    bads: ['X001']\n  },\n  {\n    name: 'C',\n    age: 25,\n    bads: ['X888', 'X772']\n  },\n  {\n    name: 'D',\n    age: 25,\n    bads: []\n  },\n  {\n    name: 'E',\n    age: 33,\n    bads: ['X888', 'X772', 'X002']\n  }\n]\n","js",[234],{"type":170,"tag":235,"props":236,"children":237},"code",{"__ignoreMap":164},[238,268,278,315,338,356,365,373,402,423,458,466,474,503,523,574,582,590,619,639,655,663,671,700,720,785,794],{"type":170,"tag":239,"props":240,"children":243},"span",{"class":241,"line":242},"line",1,[244,250,256,262],{"type":170,"tag":239,"props":245,"children":247},{"style":246},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[248],{"type":176,"value":249},"const",{"type":170,"tag":239,"props":251,"children":253},{"style":252},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[254],{"type":176,"value":255}," gangs",{"type":170,"tag":239,"props":257,"children":259},{"style":258},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[260],{"type":176,"value":261}," =",{"type":170,"tag":239,"props":263,"children":265},{"style":264},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[266],{"type":176,"value":267}," [\n",{"type":170,"tag":239,"props":269,"children":271},{"class":241,"line":270},2,[272],{"type":170,"tag":239,"props":273,"children":275},{"style":274},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[276],{"type":176,"value":277},"  {\n",{"type":170,"tag":239,"props":279,"children":281},{"class":241,"line":280},3,[282,288,293,299,305,310],{"type":170,"tag":239,"props":283,"children":285},{"style":284},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[286],{"type":176,"value":287},"    name",{"type":170,"tag":239,"props":289,"children":290},{"style":274},[291],{"type":176,"value":292},":",{"type":170,"tag":239,"props":294,"children":296},{"style":295},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[297],{"type":176,"value":298}," '",{"type":170,"tag":239,"props":300,"children":302},{"style":301},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[303],{"type":176,"value":304},"A",{"type":170,"tag":239,"props":306,"children":307},{"style":295},[308],{"type":176,"value":309},"'",{"type":170,"tag":239,"props":311,"children":312},{"style":274},[313],{"type":176,"value":314},",\n",{"type":170,"tag":239,"props":316,"children":318},{"class":241,"line":317},4,[319,324,328,334],{"type":170,"tag":239,"props":320,"children":321},{"style":284},[322],{"type":176,"value":323},"    age",{"type":170,"tag":239,"props":325,"children":326},{"style":274},[327],{"type":176,"value":292},{"type":170,"tag":239,"props":329,"children":331},{"style":330},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[332],{"type":176,"value":333}," 33",{"type":170,"tag":239,"props":335,"children":336},{"style":274},[337],{"type":176,"value":314},{"type":170,"tag":239,"props":339,"children":341},{"class":241,"line":340},5,[342,347,351],{"type":170,"tag":239,"props":343,"children":344},{"style":284},[345],{"type":176,"value":346},"    bads",{"type":170,"tag":239,"props":348,"children":349},{"style":274},[350],{"type":176,"value":292},{"type":170,"tag":239,"props":352,"children":353},{"style":264},[354],{"type":176,"value":355}," []\n",{"type":170,"tag":239,"props":357,"children":359},{"class":241,"line":358},6,[360],{"type":170,"tag":239,"props":361,"children":362},{"style":274},[363],{"type":176,"value":364},"  },\n",{"type":170,"tag":239,"props":366,"children":368},{"class":241,"line":367},7,[369],{"type":170,"tag":239,"props":370,"children":371},{"style":274},[372],{"type":176,"value":277},{"type":170,"tag":239,"props":374,"children":376},{"class":241,"line":375},8,[377,381,385,389,394,398],{"type":170,"tag":239,"props":378,"children":379},{"style":284},[380],{"type":176,"value":287},{"type":170,"tag":239,"props":382,"children":383},{"style":274},[384],{"type":176,"value":292},{"type":170,"tag":239,"props":386,"children":387},{"style":295},[388],{"type":176,"value":298},{"type":170,"tag":239,"props":390,"children":391},{"style":301},[392],{"type":176,"value":393},"B",{"type":170,"tag":239,"props":395,"children":396},{"style":295},[397],{"type":176,"value":309},{"type":170,"tag":239,"props":399,"children":400},{"style":274},[401],{"type":176,"value":314},{"type":170,"tag":239,"props":403,"children":405},{"class":241,"line":404},9,[406,410,414,419],{"type":170,"tag":239,"props":407,"children":408},{"style":284},[409],{"type":176,"value":323},{"type":170,"tag":239,"props":411,"children":412},{"style":274},[413],{"type":176,"value":292},{"type":170,"tag":239,"props":415,"children":416},{"style":330},[417],{"type":176,"value":418}," 25",{"type":170,"tag":239,"props":420,"children":421},{"style":274},[422],{"type":176,"value":314},{"type":170,"tag":239,"props":424,"children":426},{"class":241,"line":425},10,[427,431,435,440,444,449,453],{"type":170,"tag":239,"props":428,"children":429},{"style":284},[430],{"type":176,"value":346},{"type":170,"tag":239,"props":432,"children":433},{"style":274},[434],{"type":176,"value":292},{"type":170,"tag":239,"props":436,"children":437},{"style":264},[438],{"type":176,"value":439}," [",{"type":170,"tag":239,"props":441,"children":442},{"style":295},[443],{"type":176,"value":309},{"type":170,"tag":239,"props":445,"children":446},{"style":301},[447],{"type":176,"value":448},"X001",{"type":170,"tag":239,"props":450,"children":451},{"style":295},[452],{"type":176,"value":309},{"type":170,"tag":239,"props":454,"children":455},{"style":264},[456],{"type":176,"value":457},"]\n",{"type":170,"tag":239,"props":459,"children":461},{"class":241,"line":460},11,[462],{"type":170,"tag":239,"props":463,"children":464},{"style":274},[465],{"type":176,"value":364},{"type":170,"tag":239,"props":467,"children":469},{"class":241,"line":468},12,[470],{"type":170,"tag":239,"props":471,"children":472},{"style":274},[473],{"type":176,"value":277},{"type":170,"tag":239,"props":475,"children":477},{"class":241,"line":476},13,[478,482,486,490,495,499],{"type":170,"tag":239,"props":479,"children":480},{"style":284},[481],{"type":176,"value":287},{"type":170,"tag":239,"props":483,"children":484},{"style":274},[485],{"type":176,"value":292},{"type":170,"tag":239,"props":487,"children":488},{"style":295},[489],{"type":176,"value":298},{"type":170,"tag":239,"props":491,"children":492},{"style":301},[493],{"type":176,"value":494},"C",{"type":170,"tag":239,"props":496,"children":497},{"style":295},[498],{"type":176,"value":309},{"type":170,"tag":239,"props":500,"children":501},{"style":274},[502],{"type":176,"value":314},{"type":170,"tag":239,"props":504,"children":506},{"class":241,"line":505},14,[507,511,515,519],{"type":170,"tag":239,"props":508,"children":509},{"style":284},[510],{"type":176,"value":323},{"type":170,"tag":239,"props":512,"children":513},{"style":274},[514],{"type":176,"value":292},{"type":170,"tag":239,"props":516,"children":517},{"style":330},[518],{"type":176,"value":418},{"type":170,"tag":239,"props":520,"children":521},{"style":274},[522],{"type":176,"value":314},{"type":170,"tag":239,"props":524,"children":526},{"class":241,"line":525},15,[527,531,535,539,543,548,552,557,561,566,570],{"type":170,"tag":239,"props":528,"children":529},{"style":284},[530],{"type":176,"value":346},{"type":170,"tag":239,"props":532,"children":533},{"style":274},[534],{"type":176,"value":292},{"type":170,"tag":239,"props":536,"children":537},{"style":264},[538],{"type":176,"value":439},{"type":170,"tag":239,"props":540,"children":541},{"style":295},[542],{"type":176,"value":309},{"type":170,"tag":239,"props":544,"children":545},{"style":301},[546],{"type":176,"value":547},"X888",{"type":170,"tag":239,"props":549,"children":550},{"style":295},[551],{"type":176,"value":309},{"type":170,"tag":239,"props":553,"children":554},{"style":274},[555],{"type":176,"value":556},",",{"type":170,"tag":239,"props":558,"children":559},{"style":295},[560],{"type":176,"value":298},{"type":170,"tag":239,"props":562,"children":563},{"style":301},[564],{"type":176,"value":565},"X772",{"type":170,"tag":239,"props":567,"children":568},{"style":295},[569],{"type":176,"value":309},{"type":170,"tag":239,"props":571,"children":572},{"style":264},[573],{"type":176,"value":457},{"type":170,"tag":239,"props":575,"children":577},{"class":241,"line":576},16,[578],{"type":170,"tag":239,"props":579,"children":580},{"style":274},[581],{"type":176,"value":364},{"type":170,"tag":239,"props":583,"children":585},{"class":241,"line":584},17,[586],{"type":170,"tag":239,"props":587,"children":588},{"style":274},[589],{"type":176,"value":277},{"type":170,"tag":239,"props":591,"children":593},{"class":241,"line":592},18,[594,598,602,606,611,615],{"type":170,"tag":239,"props":595,"children":596},{"style":284},[597],{"type":176,"value":287},{"type":170,"tag":239,"props":599,"children":600},{"style":274},[601],{"type":176,"value":292},{"type":170,"tag":239,"props":603,"children":604},{"style":295},[605],{"type":176,"value":298},{"type":170,"tag":239,"props":607,"children":608},{"style":301},[609],{"type":176,"value":610},"D",{"type":170,"tag":239,"props":612,"children":613},{"style":295},[614],{"type":176,"value":309},{"type":170,"tag":239,"props":616,"children":617},{"style":274},[618],{"type":176,"value":314},{"type":170,"tag":239,"props":620,"children":622},{"class":241,"line":621},19,[623,627,631,635],{"type":170,"tag":239,"props":624,"children":625},{"style":284},[626],{"type":176,"value":323},{"type":170,"tag":239,"props":628,"children":629},{"style":274},[630],{"type":176,"value":292},{"type":170,"tag":239,"props":632,"children":633},{"style":330},[634],{"type":176,"value":418},{"type":170,"tag":239,"props":636,"children":637},{"style":274},[638],{"type":176,"value":314},{"type":170,"tag":239,"props":640,"children":642},{"class":241,"line":641},20,[643,647,651],{"type":170,"tag":239,"props":644,"children":645},{"style":284},[646],{"type":176,"value":346},{"type":170,"tag":239,"props":648,"children":649},{"style":274},[650],{"type":176,"value":292},{"type":170,"tag":239,"props":652,"children":653},{"style":264},[654],{"type":176,"value":355},{"type":170,"tag":239,"props":656,"children":658},{"class":241,"line":657},21,[659],{"type":170,"tag":239,"props":660,"children":661},{"style":274},[662],{"type":176,"value":364},{"type":170,"tag":239,"props":664,"children":666},{"class":241,"line":665},22,[667],{"type":170,"tag":239,"props":668,"children":669},{"style":274},[670],{"type":176,"value":277},{"type":170,"tag":239,"props":672,"children":674},{"class":241,"line":673},23,[675,679,683,687,692,696],{"type":170,"tag":239,"props":676,"children":677},{"style":284},[678],{"type":176,"value":287},{"type":170,"tag":239,"props":680,"children":681},{"style":274},[682],{"type":176,"value":292},{"type":170,"tag":239,"props":684,"children":685},{"style":295},[686],{"type":176,"value":298},{"type":170,"tag":239,"props":688,"children":689},{"style":301},[690],{"type":176,"value":691},"E",{"type":170,"tag":239,"props":693,"children":694},{"style":295},[695],{"type":176,"value":309},{"type":170,"tag":239,"props":697,"children":698},{"style":274},[699],{"type":176,"value":314},{"type":170,"tag":239,"props":701,"children":703},{"class":241,"line":702},24,[704,708,712,716],{"type":170,"tag":239,"props":705,"children":706},{"style":284},[707],{"type":176,"value":323},{"type":170,"tag":239,"props":709,"children":710},{"style":274},[711],{"type":176,"value":292},{"type":170,"tag":239,"props":713,"children":714},{"style":330},[715],{"type":176,"value":333},{"type":170,"tag":239,"props":717,"children":718},{"style":274},[719],{"type":176,"value":314},{"type":170,"tag":239,"props":721,"children":723},{"class":241,"line":722},25,[724,728,732,736,740,744,748,752,756,760,764,768,772,777,781],{"type":170,"tag":239,"props":725,"children":726},{"style":284},[727],{"type":176,"value":346},{"type":170,"tag":239,"props":729,"children":730},{"style":274},[731],{"type":176,"value":292},{"type":170,"tag":239,"props":733,"children":734},{"style":264},[735],{"type":176,"value":439},{"type":170,"tag":239,"props":737,"children":738},{"style":295},[739],{"type":176,"value":309},{"type":170,"tag":239,"props":741,"children":742},{"style":301},[743],{"type":176,"value":547},{"type":170,"tag":239,"props":745,"children":746},{"style":295},[747],{"type":176,"value":309},{"type":170,"tag":239,"props":749,"children":750},{"style":274},[751],{"type":176,"value":556},{"type":170,"tag":239,"props":753,"children":754},{"style":295},[755],{"type":176,"value":298},{"type":170,"tag":239,"props":757,"children":758},{"style":301},[759],{"type":176,"value":565},{"type":170,"tag":239,"props":761,"children":762},{"style":295},[763],{"type":176,"value":309},{"type":170,"tag":239,"props":765,"children":766},{"style":274},[767],{"type":176,"value":556},{"type":170,"tag":239,"props":769,"children":770},{"style":295},[771],{"type":176,"value":298},{"type":170,"tag":239,"props":773,"children":774},{"style":301},[775],{"type":176,"value":776},"X002",{"type":170,"tag":239,"props":778,"children":779},{"style":295},[780],{"type":176,"value":309},{"type":170,"tag":239,"props":782,"children":783},{"style":264},[784],{"type":176,"value":457},{"type":170,"tag":239,"props":786,"children":788},{"class":241,"line":787},26,[789],{"type":170,"tag":239,"props":790,"children":791},{"style":274},[792],{"type":176,"value":793},"  }\n",{"type":170,"tag":239,"props":795,"children":797},{"class":241,"line":796},27,[798],{"type":170,"tag":239,"props":799,"children":800},{"style":264},[801],{"type":176,"value":457},{"type":170,"tag":178,"props":803,"children":804},{},[805],{"type":176,"value":806},"恰逢天下大赦，局长要把没做过坏事中的最年轻的那个黑帮释放，这时要对 bads 及 age 两个字段进行排序。",{"type":170,"tag":228,"props":808,"children":810},{"className":230,"code":809,"language":232,"meta":164,"style":164},"anysort(gangs, 'bads.length', 'age')\n",[811],{"type":170,"tag":235,"props":812,"children":813},{"__ignoreMap":164},[814],{"type":170,"tag":239,"props":815,"children":816},{"class":241,"line":242},[817,823,828,832,836,841,845,849,853,858,862],{"type":170,"tag":239,"props":818,"children":820},{"style":819},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[821],{"type":176,"value":822},"anysort",{"type":170,"tag":239,"props":824,"children":825},{"style":264},[826],{"type":176,"value":827},"(gangs",{"type":170,"tag":239,"props":829,"children":830},{"style":274},[831],{"type":176,"value":556},{"type":170,"tag":239,"props":833,"children":834},{"style":295},[835],{"type":176,"value":298},{"type":170,"tag":239,"props":837,"children":838},{"style":301},[839],{"type":176,"value":840},"bads.length",{"type":170,"tag":239,"props":842,"children":843},{"style":295},[844],{"type":176,"value":309},{"type":170,"tag":239,"props":846,"children":847},{"style":274},[848],{"type":176,"value":556},{"type":170,"tag":239,"props":850,"children":851},{"style":295},[852],{"type":176,"value":298},{"type":170,"tag":239,"props":854,"children":855},{"style":301},[856],{"type":176,"value":857},"age",{"type":170,"tag":239,"props":859,"children":860},{"style":295},[861],{"type":176,"value":309},{"type":170,"tag":239,"props":863,"children":864},{"style":264},[865],{"type":176,"value":866},")\n",{"type":170,"tag":178,"props":868,"children":869},{},[870],{"type":170,"tag":871,"props":872,"children":874},"img",{"alt":164,"src":873},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220513170945.png",[],{"type":170,"tag":178,"props":876,"children":877},{},[878],{"type":176,"value":879},"结果很明显：应该释放 D。使用对象的点号访问方法，可以轻松访问到 bads 的长度。这是一个内置的“排序插件”，用来更改排序数据，把 bads 映射到 bads.length。除此之外，插件还可以更改排序的结果，比方说 reverse 插件，可以使某个排序倒序显示。如果局长想枪毙掉某个做过坏事最多的黑帮分子，他需要根据 bads 的长度倒序排序。",{"type":170,"tag":228,"props":881,"children":883},{"className":230,"code":882,"language":232,"meta":164,"style":164},"anysort(gangs, 'bads.length-reverse()')\n",[884],{"type":170,"tag":235,"props":885,"children":886},{"__ignoreMap":164},[887],{"type":170,"tag":239,"props":888,"children":889},{"class":241,"line":242},[890,894,898,902,906,911,915],{"type":170,"tag":239,"props":891,"children":892},{"style":819},[893],{"type":176,"value":822},{"type":170,"tag":239,"props":895,"children":896},{"style":264},[897],{"type":176,"value":827},{"type":170,"tag":239,"props":899,"children":900},{"style":274},[901],{"type":176,"value":556},{"type":170,"tag":239,"props":903,"children":904},{"style":295},[905],{"type":176,"value":298},{"type":170,"tag":239,"props":907,"children":908},{"style":301},[909],{"type":176,"value":910},"bads.length-reverse()",{"type":170,"tag":239,"props":912,"children":913},{"style":295},[914],{"type":176,"value":309},{"type":170,"tag":239,"props":916,"children":917},{"style":264},[918],{"type":176,"value":866},{"type":170,"tag":178,"props":920,"children":921},{},[922],{"type":170,"tag":871,"props":923,"children":925},{"alt":164,"src":924},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220513171506.png",[],{"type":170,"tag":178,"props":927,"children":928},{},[929],{"type":176,"value":930},"结果很明显：应该枪毙 E。这帮黑帮分子的履历太简单了，只有姓名年龄等字段。Anysort 提供了其它的内置插件以便于对复杂的数据进行排序，还可以进行扩展，它显然能处理更复杂的排序情况。就调用方式而言，除了字符串传参，还可以使用对象语法调用。如下所示。",{"type":170,"tag":228,"props":932,"children":934},{"className":230,"code":933,"language":232,"meta":164,"style":164},"anysort(gangs).badsa.length.reverse()\n",[935],{"type":170,"tag":235,"props":936,"children":937},{"__ignoreMap":164},[938],{"type":170,"tag":239,"props":939,"children":940},{"class":241,"line":242},[941,945,950,955,960,964,969,973,978],{"type":170,"tag":239,"props":942,"children":943},{"style":819},[944],{"type":176,"value":822},{"type":170,"tag":239,"props":946,"children":947},{"style":264},[948],{"type":176,"value":949},"(gangs)",{"type":170,"tag":239,"props":951,"children":952},{"style":274},[953],{"type":176,"value":954},".",{"type":170,"tag":239,"props":956,"children":957},{"style":264},[958],{"type":176,"value":959},"badsa",{"type":170,"tag":239,"props":961,"children":962},{"style":274},[963],{"type":176,"value":954},{"type":170,"tag":239,"props":965,"children":966},{"style":252},[967],{"type":176,"value":968},"length",{"type":170,"tag":239,"props":970,"children":971},{"style":274},[972],{"type":176,"value":954},{"type":170,"tag":239,"props":974,"children":975},{"style":819},[976],{"type":176,"value":977},"reverse",{"type":170,"tag":239,"props":979,"children":980},{"style":264},[981],{"type":176,"value":982},"()\n",{"type":170,"tag":178,"props":984,"children":985},{},[986,988,994],{"type":176,"value":987},"呀，恭喜你发现我打错了 bads 这个单词！不过该如何让编辑器也知道这行代码是错误的？假设局长在排序时输错了一个字母，那么得到错误排序结果后，他就有可能枪毙一个本该释放的人。不论是字符串传参，还是对象语法调用，",{"type":170,"tag":989,"props":990,"children":991},"strong",{},[992],{"type":176,"value":993},"该如何保证类型是正确的",{"type":176,"value":995},"？编写代码时，错误调用应该报错。",{"type":170,"tag":178,"props":997,"children":998},{},[999],{"type":170,"tag":871,"props":1000,"children":1002},{"alt":164,"src":1001},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220513181638.png",[],{"type":170,"tag":178,"props":1004,"children":1005},{},[1006],{"type":176,"value":1007},"探讨 Anysort 的类型前，让我们先简单看看 Anysort 的实现。当然，实现和类型没有强关联，所以你也可以直接跳到下一小节。",{"type":170,"tag":171,"props":1009,"children":1011},{"id":1010},"排序原理",[1012],{"type":176,"value":1010},{"type":170,"tag":1014,"props":1015,"children":1017},"h3",{"id":1016},"多属性排序",[1018],{"type":176,"value":1016},{"type":170,"tag":178,"props":1020,"children":1021},{},[1022],{"type":176,"value":1023},"Anysort 是在 Array.prototype.sort 基础上的封装。Array.prototype.sort 接受一个比较函数，利用内置算法比较各个元素，并根据比较函数给出的结果来决定元素的排序前后顺序。比如根据年龄排序，可以这样编写：",{"type":170,"tag":228,"props":1025,"children":1027},{"className":230,"code":1026,"language":232,"meta":164,"style":164},"function sortByAge(gangsA, gangsB) {\n  const ageA = gangsA.age\n  const ageB = gangsB.age\n  return ageA === ageB ? 0 : (ageA \u003C ageB ? -1 : 1)\n}\ngangs.sort(sortByAge)\n",[1028],{"type":170,"tag":235,"props":1029,"children":1030},{"__ignoreMap":164},[1031,1074,1105,1133,1215,1223],{"type":170,"tag":239,"props":1032,"children":1033},{"class":241,"line":242},[1034,1039,1044,1049,1055,1059,1064,1069],{"type":170,"tag":239,"props":1035,"children":1036},{"style":246},[1037],{"type":176,"value":1038},"function",{"type":170,"tag":239,"props":1040,"children":1041},{"style":819},[1042],{"type":176,"value":1043}," sortByAge",{"type":170,"tag":239,"props":1045,"children":1046},{"style":274},[1047],{"type":176,"value":1048},"(",{"type":170,"tag":239,"props":1050,"children":1052},{"style":1051},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[1053],{"type":176,"value":1054},"gangsA",{"type":170,"tag":239,"props":1056,"children":1057},{"style":274},[1058],{"type":176,"value":556},{"type":170,"tag":239,"props":1060,"children":1061},{"style":1051},[1062],{"type":176,"value":1063}," gangsB",{"type":170,"tag":239,"props":1065,"children":1066},{"style":274},[1067],{"type":176,"value":1068},")",{"type":170,"tag":239,"props":1070,"children":1071},{"style":274},[1072],{"type":176,"value":1073}," {\n",{"type":170,"tag":239,"props":1075,"children":1076},{"class":241,"line":270},[1077,1082,1087,1091,1096,1100],{"type":170,"tag":239,"props":1078,"children":1079},{"style":246},[1080],{"type":176,"value":1081},"  const",{"type":170,"tag":239,"props":1083,"children":1084},{"style":252},[1085],{"type":176,"value":1086}," ageA",{"type":170,"tag":239,"props":1088,"children":1089},{"style":258},[1090],{"type":176,"value":261},{"type":170,"tag":239,"props":1092,"children":1093},{"style":264},[1094],{"type":176,"value":1095}," gangsA",{"type":170,"tag":239,"props":1097,"children":1098},{"style":274},[1099],{"type":176,"value":954},{"type":170,"tag":239,"props":1101,"children":1102},{"style":264},[1103],{"type":176,"value":1104},"age\n",{"type":170,"tag":239,"props":1106,"children":1107},{"class":241,"line":280},[1108,1112,1117,1121,1125,1129],{"type":170,"tag":239,"props":1109,"children":1110},{"style":246},[1111],{"type":176,"value":1081},{"type":170,"tag":239,"props":1113,"children":1114},{"style":252},[1115],{"type":176,"value":1116}," ageB",{"type":170,"tag":239,"props":1118,"children":1119},{"style":258},[1120],{"type":176,"value":261},{"type":170,"tag":239,"props":1122,"children":1123},{"style":264},[1124],{"type":176,"value":1063},{"type":170,"tag":239,"props":1126,"children":1127},{"style":274},[1128],{"type":176,"value":954},{"type":170,"tag":239,"props":1130,"children":1131},{"style":264},[1132],{"type":176,"value":1104},{"type":170,"tag":239,"props":1134,"children":1135},{"class":241,"line":317},[1136,1142,1146,1151,1155,1160,1165,1170,1175,1180,1185,1189,1193,1198,1202,1206,1211],{"type":170,"tag":239,"props":1137,"children":1139},{"style":1138},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[1140],{"type":176,"value":1141},"  return",{"type":170,"tag":239,"props":1143,"children":1144},{"style":264},[1145],{"type":176,"value":1086},{"type":170,"tag":239,"props":1147,"children":1148},{"style":258},[1149],{"type":176,"value":1150}," ===",{"type":170,"tag":239,"props":1152,"children":1153},{"style":264},[1154],{"type":176,"value":1116},{"type":170,"tag":239,"props":1156,"children":1157},{"style":258},[1158],{"type":176,"value":1159}," ?",{"type":170,"tag":239,"props":1161,"children":1162},{"style":330},[1163],{"type":176,"value":1164}," 0",{"type":170,"tag":239,"props":1166,"children":1167},{"style":258},[1168],{"type":176,"value":1169}," :",{"type":170,"tag":239,"props":1171,"children":1172},{"style":284},[1173],{"type":176,"value":1174}," (",{"type":170,"tag":239,"props":1176,"children":1177},{"style":264},[1178],{"type":176,"value":1179},"ageA",{"type":170,"tag":239,"props":1181,"children":1182},{"style":258},[1183],{"type":176,"value":1184}," \u003C",{"type":170,"tag":239,"props":1186,"children":1187},{"style":264},[1188],{"type":176,"value":1116},{"type":170,"tag":239,"props":1190,"children":1191},{"style":258},[1192],{"type":176,"value":1159},{"type":170,"tag":239,"props":1194,"children":1195},{"style":258},[1196],{"type":176,"value":1197}," -",{"type":170,"tag":239,"props":1199,"children":1200},{"style":330},[1201],{"type":176,"value":201},{"type":170,"tag":239,"props":1203,"children":1204},{"style":258},[1205],{"type":176,"value":1169},{"type":170,"tag":239,"props":1207,"children":1208},{"style":330},[1209],{"type":176,"value":1210}," 1",{"type":170,"tag":239,"props":1212,"children":1213},{"style":284},[1214],{"type":176,"value":866},{"type":170,"tag":239,"props":1216,"children":1217},{"class":241,"line":340},[1218],{"type":170,"tag":239,"props":1219,"children":1220},{"style":274},[1221],{"type":176,"value":1222},"}\n",{"type":170,"tag":239,"props":1224,"children":1225},{"class":241,"line":358},[1226,1231,1235,1240],{"type":170,"tag":239,"props":1227,"children":1228},{"style":264},[1229],{"type":176,"value":1230},"gangs",{"type":170,"tag":239,"props":1232,"children":1233},{"style":274},[1234],{"type":176,"value":954},{"type":170,"tag":239,"props":1236,"children":1237},{"style":819},[1238],{"type":176,"value":1239},"sort",{"type":170,"tag":239,"props":1241,"children":1242},{"style":264},[1243],{"type":176,"value":1244},"(sortByAge)\n",{"type":170,"tag":178,"props":1246,"children":1247},{},[1248],{"type":176,"value":1249},"一但涉及多个属性的排序，我们就需要编写多个类似 sortByAge 的比较函数。由于多个属性的比较有先后关系，所以我们需要一个“漏斗”来筛选出最终的排序结果。比如，在挑选无犯罪记录中最年轻的黑帮时，先按照其犯罪记录长度排序，如果某两个黑帮成员的犯罪记录长度相等，也就意味着需要在对其年龄继续排序。有了“漏斗”filter，有再多比较函数都没关系。Anysort 的多属性排序的核心就是这个 filter 方法。",{"type":170,"tag":228,"props":1251,"children":1253},{"className":230,"code":1252,"language":232,"meta":164,"style":164},"const sortByAge = ({age:a}, {age:b}) => a === b ? 0 : a \u003C b ? -1 : 1\nconst sortBybadsLen = ({bads:a}, {bads:b}) => a.length === b.length ? 0 : a.length \u003C b.length ? -1 : 1\n\nconst filter = (...fns) => (a, b) => fns.reduce((res, fn) => res || fn(a, b), 0)\ngangs.sort(filter(sortByAge, sortBybadsLen))\n",[1254],{"type":170,"tag":235,"props":1255,"children":1256},{"__ignoreMap":164},[1257,1386,1537,1546,1692],{"type":170,"tag":239,"props":1258,"children":1259},{"class":241,"line":242},[1260,1264,1269,1273,1278,1283,1287,1291,1296,1301,1305,1309,1314,1319,1324,1329,1334,1339,1344,1348,1352,1356,1361,1365,1369,1373,1377,1381],{"type":170,"tag":239,"props":1261,"children":1262},{"style":246},[1263],{"type":176,"value":249},{"type":170,"tag":239,"props":1265,"children":1267},{"style":1266},"--shiki-light:#90A4AE;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[1268],{"type":176,"value":1043},{"type":170,"tag":239,"props":1270,"children":1271},{"style":258},[1272],{"type":176,"value":261},{"type":170,"tag":239,"props":1274,"children":1275},{"style":274},[1276],{"type":176,"value":1277}," ({",{"type":170,"tag":239,"props":1279,"children":1281},{"style":1280},"--shiki-light:#E53935;--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#F8F8F2",[1282],{"type":176,"value":857},{"type":170,"tag":239,"props":1284,"children":1285},{"style":274},[1286],{"type":176,"value":292},{"type":170,"tag":239,"props":1288,"children":1289},{"style":1051},[1290],{"type":176,"value":193},{"type":170,"tag":239,"props":1292,"children":1293},{"style":274},[1294],{"type":176,"value":1295},"},",{"type":170,"tag":239,"props":1297,"children":1298},{"style":274},[1299],{"type":176,"value":1300}," {",{"type":170,"tag":239,"props":1302,"children":1303},{"style":1280},[1304],{"type":176,"value":857},{"type":170,"tag":239,"props":1306,"children":1307},{"style":274},[1308],{"type":176,"value":292},{"type":170,"tag":239,"props":1310,"children":1311},{"style":1051},[1312],{"type":176,"value":1313},"b",{"type":170,"tag":239,"props":1315,"children":1316},{"style":274},[1317],{"type":176,"value":1318},"})",{"type":170,"tag":239,"props":1320,"children":1321},{"style":246},[1322],{"type":176,"value":1323}," =>",{"type":170,"tag":239,"props":1325,"children":1326},{"style":264},[1327],{"type":176,"value":1328}," a ",{"type":170,"tag":239,"props":1330,"children":1331},{"style":258},[1332],{"type":176,"value":1333},"===",{"type":170,"tag":239,"props":1335,"children":1336},{"style":264},[1337],{"type":176,"value":1338}," b ",{"type":170,"tag":239,"props":1340,"children":1341},{"style":258},[1342],{"type":176,"value":1343},"?",{"type":170,"tag":239,"props":1345,"children":1346},{"style":330},[1347],{"type":176,"value":1164},{"type":170,"tag":239,"props":1349,"children":1350},{"style":258},[1351],{"type":176,"value":1169},{"type":170,"tag":239,"props":1353,"children":1354},{"style":264},[1355],{"type":176,"value":1328},{"type":170,"tag":239,"props":1357,"children":1358},{"style":258},[1359],{"type":176,"value":1360},"\u003C",{"type":170,"tag":239,"props":1362,"children":1363},{"style":264},[1364],{"type":176,"value":1338},{"type":170,"tag":239,"props":1366,"children":1367},{"style":258},[1368],{"type":176,"value":1343},{"type":170,"tag":239,"props":1370,"children":1371},{"style":258},[1372],{"type":176,"value":1197},{"type":170,"tag":239,"props":1374,"children":1375},{"style":330},[1376],{"type":176,"value":201},{"type":170,"tag":239,"props":1378,"children":1379},{"style":258},[1380],{"type":176,"value":1169},{"type":170,"tag":239,"props":1382,"children":1383},{"style":330},[1384],{"type":176,"value":1385}," 1\n",{"type":170,"tag":239,"props":1387,"children":1388},{"class":241,"line":270},[1389,1393,1398,1402,1406,1411,1415,1419,1423,1427,1431,1435,1439,1443,1447,1452,1456,1460,1464,1469,1473,1477,1481,1485,1489,1493,1497,1501,1505,1509,1513,1517,1521,1525,1529,1533],{"type":170,"tag":239,"props":1390,"children":1391},{"style":246},[1392],{"type":176,"value":249},{"type":170,"tag":239,"props":1394,"children":1395},{"style":1266},[1396],{"type":176,"value":1397}," sortBybadsLen",{"type":170,"tag":239,"props":1399,"children":1400},{"style":258},[1401],{"type":176,"value":261},{"type":170,"tag":239,"props":1403,"children":1404},{"style":274},[1405],{"type":176,"value":1277},{"type":170,"tag":239,"props":1407,"children":1408},{"style":1280},[1409],{"type":176,"value":1410},"bads",{"type":170,"tag":239,"props":1412,"children":1413},{"style":274},[1414],{"type":176,"value":292},{"type":170,"tag":239,"props":1416,"children":1417},{"style":1051},[1418],{"type":176,"value":193},{"type":170,"tag":239,"props":1420,"children":1421},{"style":274},[1422],{"type":176,"value":1295},{"type":170,"tag":239,"props":1424,"children":1425},{"style":274},[1426],{"type":176,"value":1300},{"type":170,"tag":239,"props":1428,"children":1429},{"style":1280},[1430],{"type":176,"value":1410},{"type":170,"tag":239,"props":1432,"children":1433},{"style":274},[1434],{"type":176,"value":292},{"type":170,"tag":239,"props":1436,"children":1437},{"style":1051},[1438],{"type":176,"value":1313},{"type":170,"tag":239,"props":1440,"children":1441},{"style":274},[1442],{"type":176,"value":1318},{"type":170,"tag":239,"props":1444,"children":1445},{"style":246},[1446],{"type":176,"value":1323},{"type":170,"tag":239,"props":1448,"children":1449},{"style":264},[1450],{"type":176,"value":1451}," a",{"type":170,"tag":239,"props":1453,"children":1454},{"style":274},[1455],{"type":176,"value":954},{"type":170,"tag":239,"props":1457,"children":1458},{"style":252},[1459],{"type":176,"value":968},{"type":170,"tag":239,"props":1461,"children":1462},{"style":258},[1463],{"type":176,"value":1150},{"type":170,"tag":239,"props":1465,"children":1466},{"style":264},[1467],{"type":176,"value":1468}," b",{"type":170,"tag":239,"props":1470,"children":1471},{"style":274},[1472],{"type":176,"value":954},{"type":170,"tag":239,"props":1474,"children":1475},{"style":252},[1476],{"type":176,"value":968},{"type":170,"tag":239,"props":1478,"children":1479},{"style":258},[1480],{"type":176,"value":1159},{"type":170,"tag":239,"props":1482,"children":1483},{"style":330},[1484],{"type":176,"value":1164},{"type":170,"tag":239,"props":1486,"children":1487},{"style":258},[1488],{"type":176,"value":1169},{"type":170,"tag":239,"props":1490,"children":1491},{"style":264},[1492],{"type":176,"value":1451},{"type":170,"tag":239,"props":1494,"children":1495},{"style":274},[1496],{"type":176,"value":954},{"type":170,"tag":239,"props":1498,"children":1499},{"style":252},[1500],{"type":176,"value":968},{"type":170,"tag":239,"props":1502,"children":1503},{"style":258},[1504],{"type":176,"value":1184},{"type":170,"tag":239,"props":1506,"children":1507},{"style":264},[1508],{"type":176,"value":1468},{"type":170,"tag":239,"props":1510,"children":1511},{"style":274},[1512],{"type":176,"value":954},{"type":170,"tag":239,"props":1514,"children":1515},{"style":252},[1516],{"type":176,"value":968},{"type":170,"tag":239,"props":1518,"children":1519},{"style":258},[1520],{"type":176,"value":1159},{"type":170,"tag":239,"props":1522,"children":1523},{"style":258},[1524],{"type":176,"value":1197},{"type":170,"tag":239,"props":1526,"children":1527},{"style":330},[1528],{"type":176,"value":201},{"type":170,"tag":239,"props":1530,"children":1531},{"style":258},[1532],{"type":176,"value":1169},{"type":170,"tag":239,"props":1534,"children":1535},{"style":330},[1536],{"type":176,"value":1385},{"type":170,"tag":239,"props":1538,"children":1539},{"class":241,"line":280},[1540],{"type":170,"tag":239,"props":1541,"children":1543},{"emptyLinePlaceholder":1542},true,[1544],{"type":176,"value":1545},"\n",{"type":170,"tag":239,"props":1547,"children":1548},{"class":241,"line":317},[1549,1553,1558,1562,1566,1571,1576,1580,1584,1588,1592,1596,1600,1604,1608,1613,1617,1622,1626,1630,1635,1639,1644,1648,1652,1657,1662,1666,1671,1675,1680,1684,1688],{"type":170,"tag":239,"props":1550,"children":1551},{"style":246},[1552],{"type":176,"value":249},{"type":170,"tag":239,"props":1554,"children":1555},{"style":1266},[1556],{"type":176,"value":1557}," filter",{"type":170,"tag":239,"props":1559,"children":1560},{"style":258},[1561],{"type":176,"value":261},{"type":170,"tag":239,"props":1563,"children":1564},{"style":274},[1565],{"type":176,"value":1174},{"type":170,"tag":239,"props":1567,"children":1568},{"style":258},[1569],{"type":176,"value":1570},"...",{"type":170,"tag":239,"props":1572,"children":1573},{"style":1051},[1574],{"type":176,"value":1575},"fns",{"type":170,"tag":239,"props":1577,"children":1578},{"style":274},[1579],{"type":176,"value":1068},{"type":170,"tag":239,"props":1581,"children":1582},{"style":246},[1583],{"type":176,"value":1323},{"type":170,"tag":239,"props":1585,"children":1586},{"style":274},[1587],{"type":176,"value":1174},{"type":170,"tag":239,"props":1589,"children":1590},{"style":1051},[1591],{"type":176,"value":193},{"type":170,"tag":239,"props":1593,"children":1594},{"style":274},[1595],{"type":176,"value":556},{"type":170,"tag":239,"props":1597,"children":1598},{"style":1051},[1599],{"type":176,"value":1468},{"type":170,"tag":239,"props":1601,"children":1602},{"style":274},[1603],{"type":176,"value":1068},{"type":170,"tag":239,"props":1605,"children":1606},{"style":246},[1607],{"type":176,"value":1323},{"type":170,"tag":239,"props":1609,"children":1610},{"style":264},[1611],{"type":176,"value":1612}," fns",{"type":170,"tag":239,"props":1614,"children":1615},{"style":274},[1616],{"type":176,"value":954},{"type":170,"tag":239,"props":1618,"children":1619},{"style":819},[1620],{"type":176,"value":1621},"reduce",{"type":170,"tag":239,"props":1623,"children":1624},{"style":264},[1625],{"type":176,"value":1048},{"type":170,"tag":239,"props":1627,"children":1628},{"style":274},[1629],{"type":176,"value":1048},{"type":170,"tag":239,"props":1631,"children":1632},{"style":1051},[1633],{"type":176,"value":1634},"res",{"type":170,"tag":239,"props":1636,"children":1637},{"style":274},[1638],{"type":176,"value":556},{"type":170,"tag":239,"props":1640,"children":1641},{"style":1051},[1642],{"type":176,"value":1643}," fn",{"type":170,"tag":239,"props":1645,"children":1646},{"style":274},[1647],{"type":176,"value":1068},{"type":170,"tag":239,"props":1649,"children":1650},{"style":246},[1651],{"type":176,"value":1323},{"type":170,"tag":239,"props":1653,"children":1654},{"style":264},[1655],{"type":176,"value":1656}," res ",{"type":170,"tag":239,"props":1658,"children":1659},{"style":258},[1660],{"type":176,"value":1661},"||",{"type":170,"tag":239,"props":1663,"children":1664},{"style":819},[1665],{"type":176,"value":1643},{"type":170,"tag":239,"props":1667,"children":1668},{"style":264},[1669],{"type":176,"value":1670},"(a",{"type":170,"tag":239,"props":1672,"children":1673},{"style":274},[1674],{"type":176,"value":556},{"type":170,"tag":239,"props":1676,"children":1677},{"style":264},[1678],{"type":176,"value":1679}," b)",{"type":170,"tag":239,"props":1681,"children":1682},{"style":274},[1683],{"type":176,"value":556},{"type":170,"tag":239,"props":1685,"children":1686},{"style":330},[1687],{"type":176,"value":1164},{"type":170,"tag":239,"props":1689,"children":1690},{"style":264},[1691],{"type":176,"value":866},{"type":170,"tag":239,"props":1693,"children":1694},{"class":241,"line":340},[1695,1699,1703,1707,1711,1716,1721,1725],{"type":170,"tag":239,"props":1696,"children":1697},{"style":264},[1698],{"type":176,"value":1230},{"type":170,"tag":239,"props":1700,"children":1701},{"style":274},[1702],{"type":176,"value":954},{"type":170,"tag":239,"props":1704,"children":1705},{"style":819},[1706],{"type":176,"value":1239},{"type":170,"tag":239,"props":1708,"children":1709},{"style":264},[1710],{"type":176,"value":1048},{"type":170,"tag":239,"props":1712,"children":1713},{"style":819},[1714],{"type":176,"value":1715},"filter",{"type":170,"tag":239,"props":1717,"children":1718},{"style":264},[1719],{"type":176,"value":1720},"(sortByAge",{"type":170,"tag":239,"props":1722,"children":1723},{"style":274},[1724],{"type":176,"value":556},{"type":170,"tag":239,"props":1726,"children":1727},{"style":264},[1728],{"type":176,"value":1729}," sortBybadsLen))\n",{"type":170,"tag":1014,"props":1731,"children":1733},{"id":1732},"对象的点号访问",[1734],{"type":176,"value":1732},{"type":170,"tag":178,"props":1736,"children":1737},{},[1738],{"type":176,"value":1739},"刚才提到，插件可以改变排序的结果，也能改变排序数据。类似从数据 gangsA 到 gangsA.bads.length 的变幻，就是使用内置插件 walk 实现的。它是一个简单递归函数。",{"type":170,"tag":228,"props":1741,"children":1743},{"className":230,"code":1742,"language":232,"meta":164,"style":164},"/**\n * @example\n *  walk('a.b')({a:{b:3}}) === 3\n */\nconst walk = pathsStr => x => {\n  const paths = pathsStr.split('.')\n  let val = x\n  let nextPath = null\n  while (val && paths.length) {\n    nextPath = paths.shift()\n    val = val[nextPath]\n  }\n  return val\n}\n",[1744],{"type":170,"tag":235,"props":1745,"children":1746},{"__ignoreMap":164},[1747,1756,1776,1784,1792,1830,1879,1901,1923,1967,1996,2026,2033,2045],{"type":170,"tag":239,"props":1748,"children":1749},{"class":241,"line":242},[1750],{"type":170,"tag":239,"props":1751,"children":1753},{"style":1752},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[1754],{"type":176,"value":1755},"/**\n",{"type":170,"tag":239,"props":1757,"children":1758},{"class":241,"line":270},[1759,1764,1770],{"type":170,"tag":239,"props":1760,"children":1761},{"style":1752},[1762],{"type":176,"value":1763}," * ",{"type":170,"tag":239,"props":1765,"children":1767},{"style":1766},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[1768],{"type":176,"value":1769},"@",{"type":170,"tag":239,"props":1771,"children":1773},{"style":1772},"--shiki-light:#9C3EDA;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[1774],{"type":176,"value":1775},"example\n",{"type":170,"tag":239,"props":1777,"children":1778},{"class":241,"line":280},[1779],{"type":170,"tag":239,"props":1780,"children":1781},{"style":1752},[1782],{"type":176,"value":1783}," *  walk('a.b')({a:{b:3}}) === 3\n",{"type":170,"tag":239,"props":1785,"children":1786},{"class":241,"line":317},[1787],{"type":170,"tag":239,"props":1788,"children":1789},{"style":1752},[1790],{"type":176,"value":1791}," */\n",{"type":170,"tag":239,"props":1793,"children":1794},{"class":241,"line":340},[1795,1799,1804,1808,1813,1817,1822,1826],{"type":170,"tag":239,"props":1796,"children":1797},{"style":246},[1798],{"type":176,"value":249},{"type":170,"tag":239,"props":1800,"children":1801},{"style":1266},[1802],{"type":176,"value":1803}," walk",{"type":170,"tag":239,"props":1805,"children":1806},{"style":258},[1807],{"type":176,"value":261},{"type":170,"tag":239,"props":1809,"children":1810},{"style":1051},[1811],{"type":176,"value":1812}," pathsStr",{"type":170,"tag":239,"props":1814,"children":1815},{"style":246},[1816],{"type":176,"value":1323},{"type":170,"tag":239,"props":1818,"children":1819},{"style":1051},[1820],{"type":176,"value":1821}," x",{"type":170,"tag":239,"props":1823,"children":1824},{"style":246},[1825],{"type":176,"value":1323},{"type":170,"tag":239,"props":1827,"children":1828},{"style":274},[1829],{"type":176,"value":1073},{"type":170,"tag":239,"props":1831,"children":1832},{"class":241,"line":358},[1833,1837,1842,1846,1850,1854,1859,1863,1867,1871,1875],{"type":170,"tag":239,"props":1834,"children":1835},{"style":246},[1836],{"type":176,"value":1081},{"type":170,"tag":239,"props":1838,"children":1839},{"style":252},[1840],{"type":176,"value":1841}," paths",{"type":170,"tag":239,"props":1843,"children":1844},{"style":258},[1845],{"type":176,"value":261},{"type":170,"tag":239,"props":1847,"children":1848},{"style":264},[1849],{"type":176,"value":1812},{"type":170,"tag":239,"props":1851,"children":1852},{"style":274},[1853],{"type":176,"value":954},{"type":170,"tag":239,"props":1855,"children":1856},{"style":819},[1857],{"type":176,"value":1858},"split",{"type":170,"tag":239,"props":1860,"children":1861},{"style":284},[1862],{"type":176,"value":1048},{"type":170,"tag":239,"props":1864,"children":1865},{"style":295},[1866],{"type":176,"value":309},{"type":170,"tag":239,"props":1868,"children":1869},{"style":301},[1870],{"type":176,"value":954},{"type":170,"tag":239,"props":1872,"children":1873},{"style":295},[1874],{"type":176,"value":309},{"type":170,"tag":239,"props":1876,"children":1877},{"style":284},[1878],{"type":176,"value":866},{"type":170,"tag":239,"props":1880,"children":1881},{"class":241,"line":367},[1882,1887,1892,1896],{"type":170,"tag":239,"props":1883,"children":1884},{"style":246},[1885],{"type":176,"value":1886},"  let",{"type":170,"tag":239,"props":1888,"children":1889},{"style":264},[1890],{"type":176,"value":1891}," val",{"type":170,"tag":239,"props":1893,"children":1894},{"style":258},[1895],{"type":176,"value":261},{"type":170,"tag":239,"props":1897,"children":1898},{"style":264},[1899],{"type":176,"value":1900}," x\n",{"type":170,"tag":239,"props":1902,"children":1903},{"class":241,"line":375},[1904,1908,1913,1917],{"type":170,"tag":239,"props":1905,"children":1906},{"style":246},[1907],{"type":176,"value":1886},{"type":170,"tag":239,"props":1909,"children":1910},{"style":264},[1911],{"type":176,"value":1912}," nextPath",{"type":170,"tag":239,"props":1914,"children":1915},{"style":258},[1916],{"type":176,"value":261},{"type":170,"tag":239,"props":1918,"children":1920},{"style":1919},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1921],{"type":176,"value":1922}," null\n",{"type":170,"tag":239,"props":1924,"children":1925},{"class":241,"line":404},[1926,1931,1935,1940,1945,1949,1953,1957,1962],{"type":170,"tag":239,"props":1927,"children":1928},{"style":1138},[1929],{"type":176,"value":1930},"  while",{"type":170,"tag":239,"props":1932,"children":1933},{"style":284},[1934],{"type":176,"value":1174},{"type":170,"tag":239,"props":1936,"children":1937},{"style":264},[1938],{"type":176,"value":1939},"val",{"type":170,"tag":239,"props":1941,"children":1942},{"style":258},[1943],{"type":176,"value":1944}," &&",{"type":170,"tag":239,"props":1946,"children":1947},{"style":264},[1948],{"type":176,"value":1841},{"type":170,"tag":239,"props":1950,"children":1951},{"style":274},[1952],{"type":176,"value":954},{"type":170,"tag":239,"props":1954,"children":1955},{"style":252},[1956],{"type":176,"value":968},{"type":170,"tag":239,"props":1958,"children":1959},{"style":284},[1960],{"type":176,"value":1961},") ",{"type":170,"tag":239,"props":1963,"children":1964},{"style":274},[1965],{"type":176,"value":1966},"{\n",{"type":170,"tag":239,"props":1968,"children":1969},{"class":241,"line":425},[1970,1975,1979,1983,1987,1992],{"type":170,"tag":239,"props":1971,"children":1972},{"style":264},[1973],{"type":176,"value":1974},"    nextPath",{"type":170,"tag":239,"props":1976,"children":1977},{"style":258},[1978],{"type":176,"value":261},{"type":170,"tag":239,"props":1980,"children":1981},{"style":264},[1982],{"type":176,"value":1841},{"type":170,"tag":239,"props":1984,"children":1985},{"style":274},[1986],{"type":176,"value":954},{"type":170,"tag":239,"props":1988,"children":1989},{"style":819},[1990],{"type":176,"value":1991},"shift",{"type":170,"tag":239,"props":1993,"children":1994},{"style":284},[1995],{"type":176,"value":982},{"type":170,"tag":239,"props":1997,"children":1998},{"class":241,"line":460},[1999,2004,2008,2012,2017,2022],{"type":170,"tag":239,"props":2000,"children":2001},{"style":264},[2002],{"type":176,"value":2003},"    val",{"type":170,"tag":239,"props":2005,"children":2006},{"style":258},[2007],{"type":176,"value":261},{"type":170,"tag":239,"props":2009,"children":2010},{"style":264},[2011],{"type":176,"value":1891},{"type":170,"tag":239,"props":2013,"children":2014},{"style":284},[2015],{"type":176,"value":2016},"[",{"type":170,"tag":239,"props":2018,"children":2019},{"style":264},[2020],{"type":176,"value":2021},"nextPath",{"type":170,"tag":239,"props":2023,"children":2024},{"style":284},[2025],{"type":176,"value":457},{"type":170,"tag":239,"props":2027,"children":2028},{"class":241,"line":468},[2029],{"type":170,"tag":239,"props":2030,"children":2031},{"style":274},[2032],{"type":176,"value":793},{"type":170,"tag":239,"props":2034,"children":2035},{"class":241,"line":476},[2036,2040],{"type":170,"tag":239,"props":2037,"children":2038},{"style":1138},[2039],{"type":176,"value":1141},{"type":170,"tag":239,"props":2041,"children":2042},{"style":264},[2043],{"type":176,"value":2044}," val\n",{"type":170,"tag":239,"props":2046,"children":2047},{"class":241,"line":505},[2048],{"type":170,"tag":239,"props":2049,"children":2050},{"style":274},[2051],{"type":176,"value":1222},{"type":170,"tag":178,"props":2053,"children":2054},{},[2055],{"type":176,"value":2056},"当读取到 'a.b-reverse()'，首先根据中横线将指令划分为 walk('a.b') 和 reverse() 两个插件，分别生成比较函数；之后，把这两个比较函数传入 filter，返回可用于 Array.prototype.sort 的最终结果（一个新的比较函数）。这就是 Anysort 的整个流程。可以看作以下代码：",{"type":170,"tag":228,"props":2058,"children":2060},{"className":230,"code":2059,"language":232,"meta":164,"style":164},"anysort(arr, 'a.b-reverse()')\n\n// 可以看作\narr.sort(filter([\n  generatePlugin(walk('a.b')),\n  generatePlugin(reverse())\n]))\n",[2061],{"type":170,"tag":235,"props":2062,"children":2063},{"__ignoreMap":164},[2064,2097,2104,2112,2141,2184,2204],{"type":170,"tag":239,"props":2065,"children":2066},{"class":241,"line":242},[2067,2071,2076,2080,2084,2089,2093],{"type":170,"tag":239,"props":2068,"children":2069},{"style":819},[2070],{"type":176,"value":822},{"type":170,"tag":239,"props":2072,"children":2073},{"style":264},[2074],{"type":176,"value":2075},"(arr",{"type":170,"tag":239,"props":2077,"children":2078},{"style":274},[2079],{"type":176,"value":556},{"type":170,"tag":239,"props":2081,"children":2082},{"style":295},[2083],{"type":176,"value":298},{"type":170,"tag":239,"props":2085,"children":2086},{"style":301},[2087],{"type":176,"value":2088},"a.b-reverse()",{"type":170,"tag":239,"props":2090,"children":2091},{"style":295},[2092],{"type":176,"value":309},{"type":170,"tag":239,"props":2094,"children":2095},{"style":264},[2096],{"type":176,"value":866},{"type":170,"tag":239,"props":2098,"children":2099},{"class":241,"line":270},[2100],{"type":170,"tag":239,"props":2101,"children":2102},{"emptyLinePlaceholder":1542},[2103],{"type":176,"value":1545},{"type":170,"tag":239,"props":2105,"children":2106},{"class":241,"line":280},[2107],{"type":170,"tag":239,"props":2108,"children":2109},{"style":1752},[2110],{"type":176,"value":2111},"// 可以看作\n",{"type":170,"tag":239,"props":2113,"children":2114},{"class":241,"line":317},[2115,2120,2124,2128,2132,2136],{"type":170,"tag":239,"props":2116,"children":2117},{"style":264},[2118],{"type":176,"value":2119},"arr",{"type":170,"tag":239,"props":2121,"children":2122},{"style":274},[2123],{"type":176,"value":954},{"type":170,"tag":239,"props":2125,"children":2126},{"style":819},[2127],{"type":176,"value":1239},{"type":170,"tag":239,"props":2129,"children":2130},{"style":264},[2131],{"type":176,"value":1048},{"type":170,"tag":239,"props":2133,"children":2134},{"style":819},[2135],{"type":176,"value":1715},{"type":170,"tag":239,"props":2137,"children":2138},{"style":264},[2139],{"type":176,"value":2140},"([\n",{"type":170,"tag":239,"props":2142,"children":2143},{"class":241,"line":340},[2144,2149,2153,2158,2162,2166,2171,2175,2180],{"type":170,"tag":239,"props":2145,"children":2146},{"style":819},[2147],{"type":176,"value":2148},"  generatePlugin",{"type":170,"tag":239,"props":2150,"children":2151},{"style":264},[2152],{"type":176,"value":1048},{"type":170,"tag":239,"props":2154,"children":2155},{"style":819},[2156],{"type":176,"value":2157},"walk",{"type":170,"tag":239,"props":2159,"children":2160},{"style":264},[2161],{"type":176,"value":1048},{"type":170,"tag":239,"props":2163,"children":2164},{"style":295},[2165],{"type":176,"value":309},{"type":170,"tag":239,"props":2167,"children":2168},{"style":301},[2169],{"type":176,"value":2170},"a.b",{"type":170,"tag":239,"props":2172,"children":2173},{"style":295},[2174],{"type":176,"value":309},{"type":170,"tag":239,"props":2176,"children":2177},{"style":264},[2178],{"type":176,"value":2179},"))",{"type":170,"tag":239,"props":2181,"children":2182},{"style":274},[2183],{"type":176,"value":314},{"type":170,"tag":239,"props":2185,"children":2186},{"class":241,"line":358},[2187,2191,2195,2199],{"type":170,"tag":239,"props":2188,"children":2189},{"style":819},[2190],{"type":176,"value":2148},{"type":170,"tag":239,"props":2192,"children":2193},{"style":264},[2194],{"type":176,"value":1048},{"type":170,"tag":239,"props":2196,"children":2197},{"style":819},[2198],{"type":176,"value":977},{"type":170,"tag":239,"props":2200,"children":2201},{"style":264},[2202],{"type":176,"value":2203},"())\n",{"type":170,"tag":239,"props":2205,"children":2206},{"class":241,"line":367},[2207],{"type":170,"tag":239,"props":2208,"children":2209},{"style":264},[2210],{"type":176,"value":2211},"]))\n",{"type":170,"tag":1014,"props":2213,"children":2215},{"id":2214},"对象形式调用",[2216],{"type":176,"value":2214},{"type":170,"tag":178,"props":2218,"children":2219},{},[2220],{"type":176,"value":2221},"gangs.a.b.reverse() 这种对象形式调用的核心实现是 Proxy 的链式调用：gangs.a.b.reverse() 先后访问了三个属性：a、b、reverse，这三个属性都由同一个 Proxy 对象提供。",{"type":170,"tag":228,"props":2223,"children":2225},{"className":230,"code":2224,"language":232,"meta":164,"style":164},"const anysort => xs => wrapped(xs)\n\nconst wrapped = xs => {\n  let proxy = null\n  const visited = []\n  return (proxy = new Proxy(arr, {\n    get (target, prop) {\n      if (prop === 'reverse') {\n        return // ...\n      }\n      visited.push(prop)\n      return proxy\n    }\n  }))\n}\n",[2226],{"type":170,"tag":235,"props":2227,"children":2228},{"__ignoreMap":164},[2229,2264,2271,2298,2318,2338,2384,2419,2460,2473,2481,2510,2523,2531,2544],{"type":170,"tag":239,"props":2230,"children":2231},{"class":241,"line":242},[2232,2236,2241,2245,2250,2254,2259],{"type":170,"tag":239,"props":2233,"children":2234},{"style":246},[2235],{"type":176,"value":249},{"type":170,"tag":239,"props":2237,"children":2238},{"style":252},[2239],{"type":176,"value":2240}," anysort",{"type":170,"tag":239,"props":2242,"children":2243},{"style":258},[2244],{"type":176,"value":1323},{"type":170,"tag":239,"props":2246,"children":2247},{"style":1051},[2248],{"type":176,"value":2249}," xs",{"type":170,"tag":239,"props":2251,"children":2252},{"style":246},[2253],{"type":176,"value":1323},{"type":170,"tag":239,"props":2255,"children":2256},{"style":819},[2257],{"type":176,"value":2258}," wrapped",{"type":170,"tag":239,"props":2260,"children":2261},{"style":264},[2262],{"type":176,"value":2263},"(xs)\n",{"type":170,"tag":239,"props":2265,"children":2266},{"class":241,"line":270},[2267],{"type":170,"tag":239,"props":2268,"children":2269},{"emptyLinePlaceholder":1542},[2270],{"type":176,"value":1545},{"type":170,"tag":239,"props":2272,"children":2273},{"class":241,"line":280},[2274,2278,2282,2286,2290,2294],{"type":170,"tag":239,"props":2275,"children":2276},{"style":246},[2277],{"type":176,"value":249},{"type":170,"tag":239,"props":2279,"children":2280},{"style":1266},[2281],{"type":176,"value":2258},{"type":170,"tag":239,"props":2283,"children":2284},{"style":258},[2285],{"type":176,"value":261},{"type":170,"tag":239,"props":2287,"children":2288},{"style":1051},[2289],{"type":176,"value":2249},{"type":170,"tag":239,"props":2291,"children":2292},{"style":246},[2293],{"type":176,"value":1323},{"type":170,"tag":239,"props":2295,"children":2296},{"style":274},[2297],{"type":176,"value":1073},{"type":170,"tag":239,"props":2299,"children":2300},{"class":241,"line":317},[2301,2305,2310,2314],{"type":170,"tag":239,"props":2302,"children":2303},{"style":246},[2304],{"type":176,"value":1886},{"type":170,"tag":239,"props":2306,"children":2307},{"style":264},[2308],{"type":176,"value":2309}," proxy",{"type":170,"tag":239,"props":2311,"children":2312},{"style":258},[2313],{"type":176,"value":261},{"type":170,"tag":239,"props":2315,"children":2316},{"style":1919},[2317],{"type":176,"value":1922},{"type":170,"tag":239,"props":2319,"children":2320},{"class":241,"line":340},[2321,2325,2330,2334],{"type":170,"tag":239,"props":2322,"children":2323},{"style":246},[2324],{"type":176,"value":1081},{"type":170,"tag":239,"props":2326,"children":2327},{"style":252},[2328],{"type":176,"value":2329}," visited",{"type":170,"tag":239,"props":2331,"children":2332},{"style":258},[2333],{"type":176,"value":261},{"type":170,"tag":239,"props":2335,"children":2336},{"style":284},[2337],{"type":176,"value":355},{"type":170,"tag":239,"props":2339,"children":2340},{"class":241,"line":358},[2341,2345,2349,2354,2358,2363,2368,2372,2376,2380],{"type":170,"tag":239,"props":2342,"children":2343},{"style":1138},[2344],{"type":176,"value":1141},{"type":170,"tag":239,"props":2346,"children":2347},{"style":284},[2348],{"type":176,"value":1174},{"type":170,"tag":239,"props":2350,"children":2351},{"style":264},[2352],{"type":176,"value":2353},"proxy",{"type":170,"tag":239,"props":2355,"children":2356},{"style":258},[2357],{"type":176,"value":261},{"type":170,"tag":239,"props":2359,"children":2360},{"style":258},[2361],{"type":176,"value":2362}," new",{"type":170,"tag":239,"props":2364,"children":2365},{"style":819},[2366],{"type":176,"value":2367}," Proxy",{"type":170,"tag":239,"props":2369,"children":2370},{"style":284},[2371],{"type":176,"value":1048},{"type":170,"tag":239,"props":2373,"children":2374},{"style":264},[2375],{"type":176,"value":2119},{"type":170,"tag":239,"props":2377,"children":2378},{"style":274},[2379],{"type":176,"value":556},{"type":170,"tag":239,"props":2381,"children":2382},{"style":274},[2383],{"type":176,"value":1073},{"type":170,"tag":239,"props":2385,"children":2386},{"class":241,"line":367},[2387,2393,2397,2402,2406,2411,2415],{"type":170,"tag":239,"props":2388,"children":2390},{"style":2389},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[2391],{"type":176,"value":2392},"    get",{"type":170,"tag":239,"props":2394,"children":2395},{"style":274},[2396],{"type":176,"value":1174},{"type":170,"tag":239,"props":2398,"children":2399},{"style":1051},[2400],{"type":176,"value":2401},"target",{"type":170,"tag":239,"props":2403,"children":2404},{"style":274},[2405],{"type":176,"value":556},{"type":170,"tag":239,"props":2407,"children":2408},{"style":1051},[2409],{"type":176,"value":2410}," prop",{"type":170,"tag":239,"props":2412,"children":2413},{"style":274},[2414],{"type":176,"value":1068},{"type":170,"tag":239,"props":2416,"children":2417},{"style":274},[2418],{"type":176,"value":1073},{"type":170,"tag":239,"props":2420,"children":2421},{"class":241,"line":375},[2422,2427,2431,2436,2440,2444,2448,2452,2456],{"type":170,"tag":239,"props":2423,"children":2424},{"style":1138},[2425],{"type":176,"value":2426},"      if",{"type":170,"tag":239,"props":2428,"children":2429},{"style":284},[2430],{"type":176,"value":1174},{"type":170,"tag":239,"props":2432,"children":2433},{"style":264},[2434],{"type":176,"value":2435},"prop",{"type":170,"tag":239,"props":2437,"children":2438},{"style":258},[2439],{"type":176,"value":1150},{"type":170,"tag":239,"props":2441,"children":2442},{"style":295},[2443],{"type":176,"value":298},{"type":170,"tag":239,"props":2445,"children":2446},{"style":301},[2447],{"type":176,"value":977},{"type":170,"tag":239,"props":2449,"children":2450},{"style":295},[2451],{"type":176,"value":309},{"type":170,"tag":239,"props":2453,"children":2454},{"style":284},[2455],{"type":176,"value":1961},{"type":170,"tag":239,"props":2457,"children":2458},{"style":274},[2459],{"type":176,"value":1966},{"type":170,"tag":239,"props":2461,"children":2462},{"class":241,"line":404},[2463,2468],{"type":170,"tag":239,"props":2464,"children":2465},{"style":1138},[2466],{"type":176,"value":2467},"        return",{"type":170,"tag":239,"props":2469,"children":2470},{"style":1752},[2471],{"type":176,"value":2472}," // ...\n",{"type":170,"tag":239,"props":2474,"children":2475},{"class":241,"line":425},[2476],{"type":170,"tag":239,"props":2477,"children":2478},{"style":274},[2479],{"type":176,"value":2480},"      }\n",{"type":170,"tag":239,"props":2482,"children":2483},{"class":241,"line":460},[2484,2489,2493,2498,2502,2506],{"type":170,"tag":239,"props":2485,"children":2486},{"style":264},[2487],{"type":176,"value":2488},"      visited",{"type":170,"tag":239,"props":2490,"children":2491},{"style":274},[2492],{"type":176,"value":954},{"type":170,"tag":239,"props":2494,"children":2495},{"style":819},[2496],{"type":176,"value":2497},"push",{"type":170,"tag":239,"props":2499,"children":2500},{"style":284},[2501],{"type":176,"value":1048},{"type":170,"tag":239,"props":2503,"children":2504},{"style":264},[2505],{"type":176,"value":2435},{"type":170,"tag":239,"props":2507,"children":2508},{"style":284},[2509],{"type":176,"value":866},{"type":170,"tag":239,"props":2511,"children":2512},{"class":241,"line":468},[2513,2518],{"type":170,"tag":239,"props":2514,"children":2515},{"style":1138},[2516],{"type":176,"value":2517},"      return",{"type":170,"tag":239,"props":2519,"children":2520},{"style":264},[2521],{"type":176,"value":2522}," proxy\n",{"type":170,"tag":239,"props":2524,"children":2525},{"class":241,"line":476},[2526],{"type":170,"tag":239,"props":2527,"children":2528},{"style":274},[2529],{"type":176,"value":2530},"    }\n",{"type":170,"tag":239,"props":2532,"children":2533},{"class":241,"line":505},[2534,2539],{"type":170,"tag":239,"props":2535,"children":2536},{"style":274},[2537],{"type":176,"value":2538},"  }",{"type":170,"tag":239,"props":2540,"children":2541},{"style":284},[2542],{"type":176,"value":2543},"))\n",{"type":170,"tag":239,"props":2545,"children":2546},{"class":241,"line":525},[2547],{"type":170,"tag":239,"props":2548,"children":2549},{"style":274},[2550],{"type":176,"value":1222},{"type":170,"tag":178,"props":2552,"children":2553},{},[2554,2556,2561],{"type":176,"value":2555},"访问 proxy.a，把 'a' 放到 visited 中，返回 proxy；访问 proxy.b，把 'b' 放到 visited 中，返回 proxy... 这样就能无限层级访问对象路径了。直到访问到某个插件，这时就可以把已访问的路径 ",{"type":170,"tag":239,"props":2557,"children":2558},{},[2559],{"type":176,"value":2560},"'a', 'b'",{"type":176,"value":2562}," 作为参数带入，这时就不再返回 proxy，而是返回排序结果。",{"type":170,"tag":171,"props":2564,"children":2566},{"id":2565},"类型实现",[2567],{"type":176,"value":2565},{"type":170,"tag":1014,"props":2569,"children":2571},{"id":2570},"从对象获得可行路径",[2572],{"type":176,"value":2570},{"type":170,"tag":178,"props":2574,"children":2575},{},[2576,2578,2583],{"type":176,"value":2577},"显然，你可以给排序函数传任意格式数据，而极端情况只有两个：在 ",{"type":170,"tag":239,"props":2579,"children":2580},{},[2581],{"type":176,"value":2582},"1,2,3",{"type":176,"value":2584}," 排序时使用 'length' 排序是错误的；给 [[1],2,3] 排序使用 'length' 确情有可原（正确的）。",{"type":170,"tag":178,"props":2586,"children":2587},{},[2588,2590,2598],{"type":176,"value":2589},"根据这两个极端情况，我们设定的目标是，根据传入数据的类型生成一个有限的字符串字面量集合，这个集合包含所有可能的正确输入。只要传入的字符串字面量参数不在这个集合中，编辑器自然会报错。假设有",{"type":170,"tag":193,"props":2591,"children":2595},{"href":2592,"rel":2593},"https://www.typescriptlang.org/play?#code/GYVwdgxgLglg9mABAQzATwM5wE5QDwCCASkQHwAUy22AXIsUQDSIZS2IDKbMYA5gGrIANjAAmAdRhQAFoRKkAlIgDeiAPQAqRADpdiDWsQBfAFAmoaAA4BTTtz6CREqbIalEAXkQByZN8QAPj4ARt5maoYA8gDSJqiYOFDkANoAusy+3gomEYgxcehYuCnpIVk5hgDu2Ai8BQnFaRlwMtbY5WZAA",[2594],"nofollow",[2596],{"type":176,"value":2597},"以下代码",{"type":176,"value":2599},"，StringValidWith(ARR) 类型为 'a' | 'b'，那么只有 'a' 或 'b' 两种调用是正确的，其它调用都应该报红。",{"type":170,"tag":178,"props":2601,"children":2602},{},[2603],{"type":170,"tag":871,"props":2604,"children":2607},{"alt":2605,"src":2606},"TS Playground Example","https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220513201932.png",[],{"type":170,"tag":178,"props":2609,"children":2610},{},[2611],{"type":176,"value":2612},"所以，StringValidWith 需要遍历 ARR，并返回所有可行路径：",{"type":170,"tag":228,"props":2614,"children":2616},{"className":230,"code":2615,"language":232,"meta":164,"style":164},"const data = [{a:{b:{c:{d:1}}}}]\n\n// 'a'|'a.b'|'a.b.c'|'a.b.c.d'\nStringValidWith\u003Ctypeof data[0]>\n",[2617],{"type":170,"tag":235,"props":2618,"children":2619},{"__ignoreMap":164},[2620,2693,2700,2708],{"type":170,"tag":239,"props":2621,"children":2622},{"class":241,"line":242},[2623,2627,2632,2636,2640,2645,2649,2654,2658,2662,2667,2671,2676,2680,2684,2689],{"type":170,"tag":239,"props":2624,"children":2625},{"style":246},[2626],{"type":176,"value":249},{"type":170,"tag":239,"props":2628,"children":2629},{"style":252},[2630],{"type":176,"value":2631}," data",{"type":170,"tag":239,"props":2633,"children":2634},{"style":258},[2635],{"type":176,"value":261},{"type":170,"tag":239,"props":2637,"children":2638},{"style":264},[2639],{"type":176,"value":439},{"type":170,"tag":239,"props":2641,"children":2642},{"style":274},[2643],{"type":176,"value":2644},"{",{"type":170,"tag":239,"props":2646,"children":2647},{"style":284},[2648],{"type":176,"value":193},{"type":170,"tag":239,"props":2650,"children":2651},{"style":274},[2652],{"type":176,"value":2653},":{",{"type":170,"tag":239,"props":2655,"children":2656},{"style":284},[2657],{"type":176,"value":1313},{"type":170,"tag":239,"props":2659,"children":2660},{"style":274},[2661],{"type":176,"value":2653},{"type":170,"tag":239,"props":2663,"children":2664},{"style":284},[2665],{"type":176,"value":2666},"c",{"type":170,"tag":239,"props":2668,"children":2669},{"style":274},[2670],{"type":176,"value":2653},{"type":170,"tag":239,"props":2672,"children":2673},{"style":284},[2674],{"type":176,"value":2675},"d",{"type":170,"tag":239,"props":2677,"children":2678},{"style":274},[2679],{"type":176,"value":292},{"type":170,"tag":239,"props":2681,"children":2682},{"style":330},[2683],{"type":176,"value":201},{"type":170,"tag":239,"props":2685,"children":2686},{"style":274},[2687],{"type":176,"value":2688},"}}}}",{"type":170,"tag":239,"props":2690,"children":2691},{"style":264},[2692],{"type":176,"value":457},{"type":170,"tag":239,"props":2694,"children":2695},{"class":241,"line":270},[2696],{"type":170,"tag":239,"props":2697,"children":2698},{"emptyLinePlaceholder":1542},[2699],{"type":176,"value":1545},{"type":170,"tag":239,"props":2701,"children":2702},{"class":241,"line":280},[2703],{"type":170,"tag":239,"props":2704,"children":2705},{"style":1752},[2706],{"type":176,"value":2707},"// 'a'|'a.b'|'a.b.c'|'a.b.c.d'\n",{"type":170,"tag":239,"props":2709,"children":2710},{"class":241,"line":317},[2711,2716,2721,2726,2731,2736],{"type":170,"tag":239,"props":2712,"children":2713},{"style":264},[2714],{"type":176,"value":2715},"StringValidWith",{"type":170,"tag":239,"props":2717,"children":2718},{"style":258},[2719],{"type":176,"value":2720},"\u003Ctypeof",{"type":170,"tag":239,"props":2722,"children":2723},{"style":264},[2724],{"type":176,"value":2725}," data[",{"type":170,"tag":239,"props":2727,"children":2728},{"style":330},[2729],{"type":176,"value":2730},"0",{"type":170,"tag":239,"props":2732,"children":2733},{"style":264},[2734],{"type":176,"value":2735},"]",{"type":170,"tag":239,"props":2737,"children":2738},{"style":258},[2739],{"type":176,"value":2740},">\n",{"type":170,"tag":178,"props":2742,"children":2743},{},[2744,2746,2753],{"type":176,"value":2745},"实现",{"type":170,"tag":193,"props":2747,"children":2750},{"href":2748,"rel":2749},"https://www.typescriptlang.org/play?#code/C4TwDgpgBA4hwAUCGwAWAeAUFKAVKEAHsBAHYAmAzlAPYBGAVhAMbAA02UA0gcWVVADWEEDQBmeKAF4hI8XkwA+aZx5ESFapWAAnAJakA5pwD8eANpcAurw0D6TVqagADACQBvLgF8XUAD6unj4AdJ5wiCgYuJZWir6cAFxBXgk4yQDkGZiYoJBQJNoA+gCM0rDwyGjoHkiJHnT1zPXkiaQArgC2dBA63v3eikA",[2594],[2751],{"type":176,"value":2752},"见下 GetPath 类型",{"type":176,"value":2754},"，它也是一个简单的递归函数。它从对象中获取所有的键，返回这些键。一但键对应的值还是对象，则进入值对象的递归。",{"type":170,"tag":178,"props":2756,"children":2757},{},[2758],{"type":170,"tag":871,"props":2759,"children":2761},{"alt":2605,"src":2760},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220513203605.png",[],{"type":170,"tag":178,"props":2763,"children":2764},{},[2765,2767,2774],{"type":176,"value":2766},"为了支持访问数组和字符串的 length 属性，我们对 GetPath 进行一些改造，",{"type":170,"tag":193,"props":2768,"children":2771},{"href":2769,"rel":2770},"https://www.typescriptlang.org/play?#code/C4TwDgpgBA4hwAUCGwAWAeAUFKAVKEAHsBAHYAmAzlAPYBGAVhAMbAA02UA0gcWVVADWEEDQBmeKAF4hI8XkwA+aZx5ESFapWAAnAJakA5pwD8eANpcAurw0CAFElIhzNgD5Rt+owEpTUAAMAEgBvLgBfAKgPYLDwgDoAGzJDNADOAC4La1t+anomVn9YiKiY0Ij40LhEFAxcSytFSMzAipacLIByLsxMUEgoHSQAd1xwaBkQpAyQulnmWc5yLNIAVwBbOggdV04Ibohe8JPwvoHoEm1pWHhkNHRhsYnFIA",[2594],[2772],{"type":176,"value":2773},"见下",{"type":176,"value":216},{"type":170,"tag":178,"props":2776,"children":2777},{},[2778],{"type":170,"tag":871,"props":2779,"children":2781},{"alt":2605,"src":2780},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220513204741.png",[],{"type":170,"tag":1014,"props":2783,"children":2785},{"id":2784},"从数组推断子元素类型",[2786],{"type":176,"value":2784},{"type":170,"tag":178,"props":2788,"children":2789},{},[2790,2792,2798],{"type":176,"value":2791},"由于传入的是数组，数组内部的元素类型不一定是同一种，所以要先从数组中获取子元素类型，再把子元素类型传给 GetPath 以获得所有路径。",{"type":170,"tag":193,"props":2793,"children":2796},{"href":2794,"rel":2795},"https://www.typescriptlang.org/play?#code/C4TwDgpgBA4hwElgQLYBVwQDwA0DKUEAHsgHYAmAzlAK6kDWpA9gO6kDaAugHxQC8AKChR8hEhArUAFAEtSAMwgAnKElQZIASi5CoAflXJ0mXQC4opCADdlAgaEhQlAQxYbofKOwDeUZ+dIaFAAjZS4oAF8AGl9g80pgJTkAc3CIzjtMuwdoZASAJVd3flh4NWNILBc3TG4gA",[2594],[2797],{"type":176,"value":2773},{"type":176,"value":2799},"，一个灵活的 infer 就可以把类数组中所有子元素类型以集合的形式推断出来。",{"type":170,"tag":178,"props":2801,"children":2802},{},[2803],{"type":170,"tag":871,"props":2804,"children":2806},{"alt":2605,"src":2805},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220515154134.png",[],{"type":170,"tag":178,"props":2808,"children":2809},{},[2810,2812,2819],{"type":176,"value":2811},"GetItemType 中的 infer 在这里是有坑的，把子元素类型以集合的形式推断出来，也就意味着抹平顺序差异。传入的元组可以是顺序相关的，但返回的集合却顺序无关。",{"type":170,"tag":193,"props":2813,"children":2816},{"href":2814,"rel":2815},"https://www.typescriptlang.org/play?#code/C4TwDgpgBA4hwElgQLYBVwQDwA0DKUEAHsgHYAmAzlAK6kDWpA9gO6kDaAugHxQC8AKChR8hEhArUAFAEtSAMwgAnKElQZIASi5CoAflXJ0mXQC4opCADdlAgQBt4UZJWABGc+zcAaKACZOfigvXwC7Oxd3IPY-UM47AHoE-ygAHyg3AVBIZwhXNDyovlh4NWNILGyIJnlc1zduIA",[2594],[2817],{"type":176,"value":2818},"见下代码",{"type":176,"value":2820},"，从元组类型的 test1 中推断出子元素类型为 1 | 2 集合。",{"type":170,"tag":178,"props":2822,"children":2823},{},[2824],{"type":170,"tag":871,"props":2825,"children":2827},{"alt":2605,"src":2826},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220515154908.png",[],{"type":170,"tag":178,"props":2829,"children":2830},{},[2831],{"type":176,"value":2832},"不过在排序中，待排序数组和顺序不相关，所以我们可以使用这个 infer。由于待排序数组的内部的元素类型大致是一致的，所以也并不需要过分关心这里及之后的性能损耗。把数组子类型这个集合转为元组后，计算出所有对象的可行路径，按照步骤，简单可行。",{"type":170,"tag":178,"props":2834,"children":2835},{},[2836,2838,2849,2851,2858,2860,2871],{"type":176,"value":2837},"集合转元组，应算是 TypeScript 中一个有名的黑魔法操作。Github 能搜到很多相关讨论，比如 ",{"type":170,"tag":193,"props":2839,"children":2842},{"href":2840,"rel":2841},"https://github.com/microsoft/TypeScript/issues/13298",[2594],[2843],{"type":170,"tag":2844,"props":2845,"children":2846},"i",{},[2847],{"type":176,"value":2848},"union to tuple",{"type":176,"value":2850},"，详细讨论了集合转元组的可行性以及相关实践建议。这里我直接把代码搬过来，",{"type":170,"tag":193,"props":2852,"children":2855},{"href":2853,"rel":2854},"https://www.typescriptlang.org/play?#code/C4TwDgpgBAqgdgSwPZwCpIJJ2BATgZwgGNhk4AeGAPigF4AoKKAChiggA8c4ATfWKAH4WzANYAuFh0kwAlHRoA3JAh7zaSlWqiS4ERXnmdufRiIlQEcAGZ4oGdZtXzhGHVD0Hc9eqEixEFAAZAEN8YEoaBiZ4MnQsHAJiUhRI9i4IXn5mZmlLGzsAJUcoZWcoM2FCs119PB8-aFiUdFQAVzAAGwhyVCizAG1UAF10k34BzzxhyqgBmaZJAYA6Vea0JHaunoBRDiJOtp4e1AAaALJQ8N6qW-P1q4i+mYbwaBxwuguWzY7u8gA5CEAVAAD5QAEAIxB4IBRABVCAA",[2594],[2856],{"type":176,"value":2857},"如下",{"type":176,"value":2859},"，先用 UnionToIntersection 把集合 1|2 转换成对应的函数交集类型 ((x: 1) => void) & ((x: 2) => void)，再使用 UnionLast 把参数类型逐个推断出来就好",{"type":170,"tag":189,"props":2861,"children":2862},{},[2863],{"type":170,"tag":193,"props":2864,"children":2868},{"href":2865,"ariaDescribedBy":2866,"dataFootnoteRef":164,"id":2867},"#user-content-fn-union_to_tuple",[197],"user-content-fnref-union_to_tuple",[2869],{"type":176,"value":2870},"3",{"type":176,"value":216},{"type":170,"tag":178,"props":2873,"children":2874},{},[2875],{"type":170,"tag":871,"props":2876,"children":2878},{"alt":2605,"src":2877},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220515161832.png",[],{"type":170,"tag":178,"props":2880,"children":2881},{},[2882,2884,2890],{"type":176,"value":2883},"为什么要在 Anysort 中使用黑魔法，这不是这篇文章想要讨论的话题。我们回到正题，改造 GetPath，添加内置插件类型，然后添加类型 GetPaths 便于处理元组。",{"type":170,"tag":193,"props":2885,"children":2888},{"href":2886,"rel":2887},"https://www.typescriptlang.org/play?#code/C4TwDgpgBAQgrgSwDYBMCSA7ACkuBzBDAZygF4oByAJwgDcIqiIKoAfSsXAjCgKF9CQoAcQjAsAQ2AALIgB4AGgGUoEAB7AIGFCTgYA1hgD2AdwwBtALoA+MryhRlqjVp1RzhAGYMoACQgSKAA0UAB04V4+AEoQRMCW9lAA-CJikjJy-oFQAGRQRgBGAFYQAMbAtuyi4lKycjFx1okAXFAYdAz8gtDVaJoAtgAq4BCKKuqa2roGxmZWtqSJThOuJAAUkVRQfRBDIwCUVokpO3uQLW0dVF0jUFQSJsNC5OYA3okSrRhw-QUMRwBfILvBwFVpxKiEPCAhICW6aOJRB5PaDkACqGAQRgwgyMgzgnFGvQGKLk90eI2sTX4NyECOAZFSNRk8npSIpkGpNO6TPS0jkiUGzkmbkKJXKQUSAGlhasoPoICAjJ4oELyAqlSrBrwFtLZVMoBCocdVeYpZZ9W41hIMCArGxDcBIRg8PsTQADAAkrylAPdDq9PoBoSQWjwMn97EDvoAtN74Mh0NguIQiH6A97fSGwzI468E6hMDh8Km-RdBmaLSsDWKysAPZn01HG6FvdU+XIK+brE2oNGAXmC0ni9w0+6Lv3xw5WhQ+HChBisTijJhNIw60u5GjdQ41mjLSR9yk1mt9K01mpWmj9mRbLQjAgUDfSHeH0+oF8rjfqzpEiez1AmzbM+r6PjeJwfpc9DXPO0CLtiAAyEhxFuO5QPBy6rgwTDlJu24HlAJ6XoBGDeFsUQgVA95gVAJpRBc7TQbScGYtiuL4oSnZoeYgxVi4BrmIxDAJA4KRHNO7jhKEGHsQSoZyAAomopS4CgoyDCEGFIShgxUtYmmsRg2nAFxlhAA",[2594],[2889],{"type":176,"value":2773},{"type":176,"value":2891},"，假使我们有了插件 reverse 和 plugin，那么无论是传入 'a-reverse' 还是 'a.length-plugin' 都应该是正确的调用。",{"type":170,"tag":178,"props":2893,"children":2894},{},[2895],{"type":170,"tag":871,"props":2896,"children":2898},{"alt":2605,"src":2897},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220515163145.png",[],{"type":170,"tag":1014,"props":2900,"children":2902},{"id":2901},"代理的类型",[2903],{"type":176,"value":2901},{"type":170,"tag":178,"props":2905,"children":2906},{},[2907,2909,2915],{"type":176,"value":2908},"最后讲一讲对象形式调用的类型实现。假如有子元素类型 {a:1}，希望得到 { a:{ reverse() } }。有了 GetPath 的递归基础上，改造其实非常简单。",{"type":170,"tag":193,"props":2910,"children":2913},{"href":2911,"rel":2912},"https://www.typescriptlang.org/play?#code/C4TwDgpgBACgNgVwOYEsB2BhAhnOBnAHgEEAlEgPigF4oBvAKCigAsJcB7KACgEoAuKKRL0AvvXqhIUAOIRgMLMGYFGgslAgAPYBDQATPFARoA1mnYB3NAG0AugBpVAFWpqS1gAy36lGgybWANJQ6FAmECDsAGZQTrZ8qkxOQbYa2roGUOwARgBWEADGwIlQAPwycgpKxGT2sSmUAGSwiKiYOPg1FCUCyYGpzfDI6Ni4hELkolCDrSMd42ST9FHGRSjsaFBYaCB47ABOwF1pOvqGxmaWNrbkXJp4AkI8dKr7cgj7m-db56bmVj8KvJFMoJqJ6NtdgdgFxrLQsHwAORYREiWw8AB0WAxzCAA",[2594],[2914],{"type":176,"value":2818},{"type":176,"value":2916},"，PluginsCalls 是一个根据现有插件返回固定的函数接口对象的类型，GetPath 只需要不断递归对象的键值对，并把值与函数接口的交集返回即可。这样一来，就有了在任意属性调用任意插件的类型能力。",{"type":170,"tag":178,"props":2918,"children":2919},{},[2920],{"type":170,"tag":871,"props":2921,"children":2923},{"alt":2605,"src":2922},"https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20220515170506.png",[],{"type":170,"tag":171,"props":2925,"children":2927},{"id":2926},"阅读更多",[2928],{"type":176,"value":2926},{"type":170,"tag":178,"props":2930,"children":2931},{},[2932],{"type":176,"value":2933},"总结一下，无论是字符串形式的调用还是对象形式的调用，在 Anysort 的类型中的实现都主要依赖了递归类型。文章前两部分简述了其原理。但文章中的代码只是一种最简的还原。比如，没有任何容错，也不支持扩展。Anysort 不仅有内置插件，它还支持插件扩展。这些插件的调用有些需要传参，另一些则不需要... 如何约束诸如之类的调用方式，或仅确保其不会出错，就需要引入一堆不相关代码。在 Anysort 完成时，我惊讶地发现，光是类型代码就占用了 10KB 体积。我的第一感觉就是“这是不可接受的”。",{"type":170,"tag":178,"props":2935,"children":2936},{},[2937],{"type":176,"value":2938},"排除类型体操的可玩性，TS 在我看来是非常不适合前端来写的，至少是不适合在项目中普及的。JavaScript 是一种简单有效的脚本语言，使用 JS 意味着我尽可能希望在保证代码质量底线的情况下，更快速地完成项目，而不是每天写代码却要花上一半的时间来设计类型。类型系统，包括项目中的代码类型以及类型系统本身都只会越来越复杂，TS 使许多程序员陷入了“即使是编写简单的页面，也需要用类型来保证质量，或是它可以给维护者带来好处”的误区。这可能是一种有效的自我安慰或管理手段。",{"type":170,"tag":178,"props":2940,"children":2941},{},[2942,2944,2951],{"type":176,"value":2943},"更多吐槽 TS 的话就不说了。但如果你对类型体操有兴趣，可以去 ",{"type":170,"tag":193,"props":2945,"children":2948},{"href":2946,"rel":2947},"https://github.com/type-challenges/type-challenges",[2594],[2949],{"type":176,"value":2950},"type-challenges",{"type":176,"value":2952}," 这个项目看看。它搜罗了百来道 TS 类型编程的题目，从易到难都有，而且大部分题目都有很好的解答。这是提高 TS 泛型能力非常有效的一条路子。",{"type":170,"tag":178,"props":2954,"children":2955},{},[2956,2958,2965],{"type":176,"value":2957},"最后，哪怕你对 Anysort 有一丝兴趣，欢迎参观 ",{"type":170,"tag":193,"props":2959,"children":2962},{"href":2960,"rel":2961},"https://github.com/Lionad-Morotar/anysort",[2594],[2963],{"type":176,"value":2964},"Anysort@GitHub",{"type":176,"value":2966},"。项目是半个玩具，还有很多不完善的地方，欢迎 PR。",{"type":170,"tag":2968,"props":2969,"children":2972},"section",{"className":2970,"dataFootnotes":164},[2971],"footnotes",[2973,2980],{"type":170,"tag":171,"props":2974,"children":2977},{"className":2975,"id":197},[2976],"sr-only",[2978],{"type":176,"value":2979},"Footnotes",{"type":170,"tag":2981,"props":2982,"children":2983},"ol",{},[2984,3006,3025],{"type":170,"tag":2985,"props":2986,"children":2988},"li",{"id":2987},"user-content-fn-anysort-1th",[2989,2995,2997],{"type":170,"tag":193,"props":2990,"children":2992},{"href":2991},"/_achieved/2021-01/anysort-1th",[2993],{"type":176,"value":2994},"《一文学会排序》",{"type":176,"value":2996}," ",{"type":170,"tag":193,"props":2998,"children":3003},{"href":2999,"ariaLabel":3000,"className":3001,"dataFootnoteBackref":164},"#user-content-fnref-anysort-1th","Back to reference 1",[3002],"data-footnote-backref",[3004],{"type":176,"value":3005},"↩",{"type":170,"tag":2985,"props":3007,"children":3009},{"id":3008},"user-content-fn-dict",[3010,3017,3018],{"type":170,"tag":193,"props":3011,"children":3014},{"href":3012,"rel":3013},"https://juejin.cn/post/6872111128135073806",[2594],[3015],{"type":176,"value":3016},"《一份不可多得的 TS 学习指南》",{"type":176,"value":2996},{"type":170,"tag":193,"props":3019,"children":3023},{"href":3020,"ariaLabel":3021,"className":3022,"dataFootnoteBackref":164},"#user-content-fnref-dict","Back to reference 2",[3002],[3024],{"type":176,"value":3005},{"type":170,"tag":2985,"props":3026,"children":3028},{"id":3027},"user-content-fn-union_to_tuple",[3029,3031,3038,3040],{"type":176,"value":3030},"有关集合转元组的详细中文解释见",{"type":170,"tag":193,"props":3032,"children":3035},{"href":3033,"rel":3034},"https://zhuanlan.zhihu.com/p/58704376",[2594],[3036],{"type":176,"value":3037},"《TypeScript 奇技淫巧 union to tuple》",{"type":176,"value":3039},"。 ",{"type":170,"tag":193,"props":3041,"children":3045},{"href":3042,"ariaLabel":3043,"className":3044,"dataFootnoteBackref":164},"#user-content-fnref-union_to_tuple","Back to reference 3",[3002],[3046],{"type":176,"value":3005},{"type":170,"tag":3048,"props":3049,"children":3050},"style",{},[3051],{"type":176,"value":3052},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":164,"searchDepth":270,"depth":270,"links":3054},[3055,3056,3057,3062,3067,3068],{"id":173,"depth":270,"text":173},{"id":219,"depth":270,"text":219},{"id":1010,"depth":270,"text":1010,"children":3058},[3059,3060,3061],{"id":1016,"depth":280,"text":1016},{"id":1732,"depth":280,"text":1732},{"id":2214,"depth":280,"text":2214},{"id":2565,"depth":270,"text":2565,"children":3063},[3064,3065,3066],{"id":2570,"depth":280,"text":2570},{"id":2784,"depth":280,"text":2784},{"id":2901,"depth":280,"text":2901},{"id":2926,"depth":270,"text":2926},{"id":197,"depth":270,"text":2979},"markdown","content:2.articles:1108.anysort-2th.md","content","2.articles/1108.anysort-2th.md","2.articles/1108.anysort-2th","md",[3076,3078],{"_path":76,"title":75,"description":3077},"排除人的因素，设计模式的本质只是相关代码复用。本文通过使用JS仿制并简化了几种OOL中经典设计模式，以探讨经典设计模式和代码模板的区别主要在于代码复用的层次不同，以及粗浅聊了聊设计模式与语言特征之间此强彼弱的关系。",{"_path":82,"title":81,"description":3079},"传统网页的渲染是基于像素的，所以常出现锯齿。本文简单介绍了锯齿出现的成因，以及CSS中相关锯齿处理的字体平滑、图片渲染属性，并通过实践创造了一种类似FXAA原理的background背景图案抗锯齿技术poaa（pixel-offset-anti-aliasing）。",1753069985514]