[{"data":1,"prerenderedAt":4323},["Reactive",2],{"navigation":3,"/articles/micro-templating":389,"/articles/micro-templating-surround":4318},[4,32,83,99,126,132,138,372,378,384],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77,80],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":42,"_path":43},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":45,"_path":46},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":48,"_path":49},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":51,"_path":52},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":54,"_path":55},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":57,"_path":58},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":60,"_path":61},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":63,"_path":64},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":66,"_path":67},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":69,"_path":70},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":72,"_path":73},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":75,"_path":76},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":78,"_path":79},"🚝 四十二篇系列","/articles/fourty-two",{"title":81,"_path":82},"📝 技术博客归档","/articles/fold",{"title":84,"_path":85,"children":86},"造物 / Make","/tools",[87,90,93,96],{"title":88,"_path":89},"🌐 AnySort","/tools/anysort",{"title":91,"_path":92},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":94,"_path":95},"👓 Crapto","/tools/crypto-inline",{"title":97,"_path":98},"🖨️ any-to-base64","/tools/any-to-base64",{"title":100,"_path":101,"children":102},"吉他剧场 / Music","/music",[103,105,108,111,114,117,120,123],{"title":104,"_path":101},"🎸 FingerStyle！",{"title":106,"_path":107},"🌬️ 等待的风","/music/wind",{"title":109,"_path":110},"💕 约定的海洋","/music/ocean",{"title":112,"_path":113},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":115,"_path":116},"🌏 残酷天使的行动纲领","/music/eva",{"title":118,"_path":119},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":121,"_path":122},"🍷 Wu Wei","/music/wu-wei",{"title":124,"_path":125},"🌅 无题","/music/untitled",{"title":127,"_path":128,"children":129},"画点什么 / Paint","/paint",[130],{"title":131,"_path":128},"🚧 正在施工",{"title":133,"_path":134,"children":135},"知识地图 / Maps","/maps",[136],{"title":137,"_path":134},"🏁 知识地图",{"title":139,"_path":140,"children":141},"零散的笔记 / Gists","/gists",[142,144,147,150,153,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369],{"title":143,"_path":140},"🧊 Gists",{"title":145,"_path":146},"网站的可访问性","/gists/accessibility",{"title":148,"_path":149},"Bit","/gists/bit",{"title":151,"_path":152},"图片模糊","/gists/blur",{"title":154,"_path":155},"渲染相关笔记","/gists/c4d",{"title":157,"_path":158},"CDN 问题记录","/gists/cdn",{"title":160,"_path":161},"消毒剂","/gists/cleaner",{"title":163,"_path":164},"Windows Command","/gists/cmd",{"title":166,"_path":167},"Command","/gists/command",{"title":169,"_path":170},"复杂科学","/gists/complexity-science",{"title":172,"_path":173},"宇宙","/gists/cosmos",{"title":175,"_path":176},"C++","/gists/cpp",{"title":178,"_path":179},"Data Structure","/gists/data-structure",{"title":181,"_path":182},"DEPRESSION","/gists/depression",{"title":184,"_path":185},"设计模式","/gists/design-patterns",{"title":187,"_path":188},"Developer Experience","/gists/developer-experience",{"title":190,"_path":191},"Device Metrics","/gists/device-metrix",{"title":193,"_path":194},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":196,"_path":197},"正则表达式","/gists/eegex",{"title":199,"_path":200},"Emoji","/gists/emoji",{"title":202,"_path":203},"工程","/gists/engineering",{"title":205,"_path":206},"熵","/gists/entropy",{"title":208,"_path":209},"Environment","/gists/environment",{"title":211,"_path":212},"Erlang","/gists/erlang",{"title":214,"_path":215},"逃离塔克夫","/gists/escape-from-tarkov",{"title":217,"_path":218},"ESNext (ES6-ES11)","/gists/esnext",{"title":220,"_path":221},"Eval！","/gists/eval",{"title":223,"_path":224},"Flutter","/gists/flutter",{"title":226,"_path":227},"字体","/gists/font",{"title":229,"_path":230},"JS 函数式编程","/gists/functional",{"title":232,"_path":233},"Google C++ Standard","/gists/google-cpp-standard",{"title":235,"_path":236},"双向链接完全体","/gists/graph",{"title":238,"_path":239},"Hardwares","/gists/hardwares",{"title":241,"_path":242},"哈希冲突","/gists/hash-collision",{"title":244,"_path":245},"信息设计","/gists/information-design",{"title":247,"_path":248},"InstantPage","/gists/instant.page",{"title":250,"_path":251},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":253,"_path":254},"KVStore","/gists/key-value-db",{"title":256,"_path":257},"Kubernetes","/gists/kubernetes",{"title":259,"_path":260},"Makefile","/gists/makefile",{"title":262,"_path":263},"Markdown Inline Style","/gists/markdown-nice",{"title":265,"_path":266},"小程序","/gists/miniapp",{"title":268,"_path":269},"减小页面快照体积","/gists/minify-html",{"title":271,"_path":272},"mklink","/gists/mklink",{"title":274,"_path":275},"Mock","/gists/mock",{"title":277,"_path":278},"多端应用","/gists/multy-end-app",{"title":280,"_path":281},"神经科学","/gists/neuroscience",{"title":283,"_path":284},"OO","/gists/oo",{"title":286,"_path":287},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":289,"_path":290},"人物","/gists/person",{"title":292,"_path":293},"PInvoke","/gists/pinvoke",{"title":295,"_path":296},"像素","/gists/pixel",{"title":298,"_path":299},"PowerShell","/gists/powershell",{"title":301,"_path":302},"量子","/gists/quantum",{"title":304,"_path":305},"保持好奇心","/gists/questions",{"title":307,"_path":308},"React Native","/gists/react-native",{"title":310,"_path":311},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":313,"_path":314},"SEO","/gists/seo",{"title":316,"_path":317},"Shader","/gists/shader",{"title":319,"_path":320},"Shape Up","/gists/shape-up",{"title":322,"_path":323},"睡觉","/gists/sleep",{"title":325,"_path":326},"States","/gists/states",{"title":328,"_path":329},"Storage","/gists/storage",{"title":331,"_path":332},"音视频流处理","/gists/stream-cli",{"title":334,"_path":335},"Symbol","/gists/symbol",{"title":337,"_path":338},"系统论","/gists/systems-theory",{"title":340,"_path":341},"Taro","/gists/taro",{"title":343,"_path":344},"任务切片","/gists/task-slice",{"title":346,"_path":347},"技术偏好","/gists/tech-dudge",{"title":349,"_path":350},"Untitled","/gists/untitled",{"title":352,"_path":353},"可变字体","/gists/variable-font",{"title":355,"_path":356},"视觉错觉","/gists/visual-illusion",{"title":358,"_path":359},"SS(SSR)","/gists/vpn",{"title":361,"_path":362},"VS Code 插件开发","/gists/vscode-plugin",{"title":364,"_path":365},"Web Components","/gists/web-components",{"title":367,"_path":368},"Windows","/gists/windows",{"title":370,"_path":371},"查缺补漏","/gists/wrong",{"title":373,"_path":374,"children":375},"代码笔记 / Gists","/source-code",[376],{"title":377,"_path":374},"🚄 代码笔记",{"title":379,"_path":380,"children":381},"我 / Abount","/hire",[382],{"title":383,"_path":380},"📬 技术简历",{"title":385,"_path":386,"children":387},"todo","/todo",[388],{"title":385,"_path":386},{"_path":43,"_dir":390,"_draft":391,"_partial":391,"_locale":392,"title":42,"description":393,"body":394,"_type":4313,"_id":4314,"_source":4315,"_file":4316,"_extension":4317},"articles",false,"","忍者秘籍中提到的模板解析器，很短但支持变量和 if 等语句，还是 15 年前的代码！",{"type":395,"children":396,"toc":4308},"root",[397,422,434,439,616,628,748,753,759,764,1872,1877,1882,1887,1998,2011,2472,2778,2789,2888,2901,3072,3077,3096,3135,3140,3207,3212,3265,3925,3972,3977,4051,4064,4069,4074,4235,4240,4261,4284,4289,4302],{"type":398,"tag":399,"props":400,"children":401},"element","p",{},[402,405,411,413,420],{"type":403,"value":404},"text","上回我借着解决 CSS 嵌套解析问题聊到 micro-app 中实现的一个非常精简的 ",{"type":398,"tag":406,"props":407,"children":408},"a",{"href":46},[409],{"type":403,"value":410},"CSS 解析器",{"type":403,"value":412},"，还没过瘾。今天整理笔记的时候发现了角落里的这个模板解析器，那就赶紧擦擦灰尘拉出来聊一聊。这个模板解析器可是有年头了，它是 John Resig 佬 2008 年写的，叫 ",{"type":398,"tag":414,"props":415,"children":417},"code",{"className":416},[],[418],{"type":403,"value":419},"micro-templating",{"type":403,"value":421},"，距今十五年哩。（John Resig 就是写《JavaScript 忍者秘籍》那位）",{"type":398,"tag":399,"props":423,"children":424},{},[425,427,432],{"type":403,"value":426},"令人惊叹的地方是，",{"type":398,"tag":414,"props":428,"children":430},{"className":429},[],[431],{"type":403,"value":419},{"type":403,"value":433}," 的代码和它的名字一样 micro，它能用仅仅 30 行代码完成对模板的处理，并且还有读取 html 模板、缓存、柯里化等额外的高级功能！",{"type":398,"tag":399,"props":435,"children":436},{},[437],{"type":403,"value":438},"可能有些佬没接触过模板解析器，这里给出一个简单的示例。",{"type":398,"tag":440,"props":441,"children":445},"pre",{"className":442,"code":443,"language":444,"meta":392,"style":392},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","parse(`\n  \u003C% if (shouldCount) { %>\n    \u003C% for (var i = 1; i \u003C= 3; i++) { %>\n      \u003Cdiv>hello - \u003C%= i + count %>\u003C/div>\n    \u003C% } %>\n  \u003C% } else { %>\n    \u003Cdiv>noop\u003C/div>\n  \u003C% } %>\n`, {\n  shouldCount: true,\n  count: 1\n})\n","js",[446],{"type":398,"tag":414,"props":447,"children":448},{"__ignoreMap":392},[449,473,483,492,501,510,519,528,537,557,583,602],{"type":398,"tag":450,"props":451,"children":454},"span",{"class":452,"line":453},"line",1,[455,461,467],{"type":398,"tag":450,"props":456,"children":458},{"style":457},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[459],{"type":403,"value":460},"parse",{"type":398,"tag":450,"props":462,"children":464},{"style":463},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[465],{"type":403,"value":466},"(",{"type":398,"tag":450,"props":468,"children":470},{"style":469},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[471],{"type":403,"value":472},"`\n",{"type":398,"tag":450,"props":474,"children":476},{"class":452,"line":475},2,[477],{"type":398,"tag":450,"props":478,"children":480},{"style":479},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[481],{"type":403,"value":482},"  \u003C% if (shouldCount) { %>\n",{"type":398,"tag":450,"props":484,"children":486},{"class":452,"line":485},3,[487],{"type":398,"tag":450,"props":488,"children":489},{"style":479},[490],{"type":403,"value":491},"    \u003C% for (var i = 1; i \u003C= 3; i++) { %>\n",{"type":398,"tag":450,"props":493,"children":495},{"class":452,"line":494},4,[496],{"type":398,"tag":450,"props":497,"children":498},{"style":479},[499],{"type":403,"value":500},"      \u003Cdiv>hello - \u003C%= i + count %>\u003C/div>\n",{"type":398,"tag":450,"props":502,"children":504},{"class":452,"line":503},5,[505],{"type":398,"tag":450,"props":506,"children":507},{"style":479},[508],{"type":403,"value":509},"    \u003C% } %>\n",{"type":398,"tag":450,"props":511,"children":513},{"class":452,"line":512},6,[514],{"type":398,"tag":450,"props":515,"children":516},{"style":479},[517],{"type":403,"value":518},"  \u003C% } else { %>\n",{"type":398,"tag":450,"props":520,"children":522},{"class":452,"line":521},7,[523],{"type":398,"tag":450,"props":524,"children":525},{"style":479},[526],{"type":403,"value":527},"    \u003Cdiv>noop\u003C/div>\n",{"type":398,"tag":450,"props":529,"children":531},{"class":452,"line":530},8,[532],{"type":398,"tag":450,"props":533,"children":534},{"style":479},[535],{"type":403,"value":536},"  \u003C% } %>\n",{"type":398,"tag":450,"props":538,"children":540},{"class":452,"line":539},9,[541,546,552],{"type":398,"tag":450,"props":542,"children":543},{"style":469},[544],{"type":403,"value":545},"`",{"type":398,"tag":450,"props":547,"children":549},{"style":548},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[550],{"type":403,"value":551},",",{"type":398,"tag":450,"props":553,"children":554},{"style":548},[555],{"type":403,"value":556}," {\n",{"type":398,"tag":450,"props":558,"children":560},{"class":452,"line":559},10,[561,567,572,578],{"type":398,"tag":450,"props":562,"children":564},{"style":563},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[565],{"type":403,"value":566},"  shouldCount",{"type":398,"tag":450,"props":568,"children":569},{"style":548},[570],{"type":403,"value":571},":",{"type":398,"tag":450,"props":573,"children":575},{"style":574},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[576],{"type":403,"value":577}," true",{"type":398,"tag":450,"props":579,"children":580},{"style":548},[581],{"type":403,"value":582},",\n",{"type":398,"tag":450,"props":584,"children":586},{"class":452,"line":585},11,[587,592,596],{"type":398,"tag":450,"props":588,"children":589},{"style":563},[590],{"type":403,"value":591},"  count",{"type":398,"tag":450,"props":593,"children":594},{"style":548},[595],{"type":403,"value":571},{"type":398,"tag":450,"props":597,"children":599},{"style":598},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[600],{"type":403,"value":601}," 1\n",{"type":398,"tag":450,"props":603,"children":605},{"class":452,"line":604},12,[606,611],{"type":398,"tag":450,"props":607,"children":608},{"style":548},[609],{"type":403,"value":610},"}",{"type":398,"tag":450,"props":612,"children":613},{"style":463},[614],{"type":403,"value":615},")\n",{"type":398,"tag":399,"props":617,"children":618},{},[619,621,626],{"type":403,"value":620},"给 ",{"type":398,"tag":414,"props":622,"children":624},{"className":623},[],[625],{"type":403,"value":460},{"type":403,"value":627}," 函数传入模板字符串和数据后，自然也是输出字符串啦：",{"type":398,"tag":440,"props":629,"children":633},{"className":630,"code":631,"language":632,"meta":392,"style":392},"language-html shiki shiki-themes material-theme-lighter github-light github-dark monokai","\u003C!-- 以下经过格式化 -->\n\u003Cdiv>hello - 2\u003C/div>\n\u003Cdiv>hello - 3\u003C/div>\n\u003Cdiv>hello - 4\u003C/div>\n","html",[634],{"type":398,"tag":414,"props":635,"children":636},{"__ignoreMap":392},[637,646,684,716],{"type":398,"tag":450,"props":638,"children":639},{"class":452,"line":453},[640],{"type":398,"tag":450,"props":641,"children":643},{"style":642},"--shiki-light:#90A4AE;--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[644],{"type":403,"value":645},"\u003C!-- 以下经过格式化 -->\n",{"type":398,"tag":450,"props":647,"children":648},{"class":452,"line":475},[649,654,660,665,670,675,679],{"type":398,"tag":450,"props":650,"children":651},{"style":548},[652],{"type":403,"value":653},"\u003C",{"type":398,"tag":450,"props":655,"children":657},{"style":656},"--shiki-light:#E53935;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[658],{"type":403,"value":659},"div",{"type":398,"tag":450,"props":661,"children":662},{"style":548},[663],{"type":403,"value":664},">",{"type":398,"tag":450,"props":666,"children":667},{"style":463},[668],{"type":403,"value":669},"hello - 2",{"type":398,"tag":450,"props":671,"children":672},{"style":548},[673],{"type":403,"value":674},"\u003C/",{"type":398,"tag":450,"props":676,"children":677},{"style":656},[678],{"type":403,"value":659},{"type":398,"tag":450,"props":680,"children":681},{"style":548},[682],{"type":403,"value":683},">\n",{"type":398,"tag":450,"props":685,"children":686},{"class":452,"line":485},[687,691,695,699,704,708,712],{"type":398,"tag":450,"props":688,"children":689},{"style":548},[690],{"type":403,"value":653},{"type":398,"tag":450,"props":692,"children":693},{"style":656},[694],{"type":403,"value":659},{"type":398,"tag":450,"props":696,"children":697},{"style":548},[698],{"type":403,"value":664},{"type":398,"tag":450,"props":700,"children":701},{"style":463},[702],{"type":403,"value":703},"hello - 3",{"type":398,"tag":450,"props":705,"children":706},{"style":548},[707],{"type":403,"value":674},{"type":398,"tag":450,"props":709,"children":710},{"style":656},[711],{"type":403,"value":659},{"type":398,"tag":450,"props":713,"children":714},{"style":548},[715],{"type":403,"value":683},{"type":398,"tag":450,"props":717,"children":718},{"class":452,"line":494},[719,723,727,731,736,740,744],{"type":398,"tag":450,"props":720,"children":721},{"style":548},[722],{"type":403,"value":653},{"type":398,"tag":450,"props":724,"children":725},{"style":656},[726],{"type":403,"value":659},{"type":398,"tag":450,"props":728,"children":729},{"style":548},[730],{"type":403,"value":664},{"type":398,"tag":450,"props":732,"children":733},{"style":463},[734],{"type":403,"value":735},"hello - 4",{"type":398,"tag":450,"props":737,"children":738},{"style":548},[739],{"type":403,"value":674},{"type":398,"tag":450,"props":741,"children":742},{"style":656},[743],{"type":403,"value":659},{"type":398,"tag":450,"props":745,"children":746},{"style":548},[747],{"type":403,"value":683},{"type":398,"tag":399,"props":749,"children":750},{},[751],{"type":403,"value":752},"相比生态里现在动则 30kb 甚至 300kb 的库，仅 30 行代码完成这个功能，简直不可思议。",{"type":398,"tag":754,"props":755,"children":757},"h2",{"id":756},"完整实现",[758],{"type":403,"value":756},{"type":398,"tag":399,"props":760,"children":761},{},[762],{"type":403,"value":763},"因为代码真的非常短，先直接看一遍，这是带注释版本的。如果你能在第一遍 review 这段代码后脑袋还保持清醒的话，留下评论，我拜你为大哥。",{"type":398,"tag":440,"props":765,"children":767},{"className":442,"code":766,"language":444,"meta":392,"style":392},"// Simple JavaScript Templating\n// John Resig - https://johnresig.com/ - MIT Licensed\n(function () {\n  var cache = {};\n\n  this.tmpl = function tmpl(str, data) {\n    // Figure out if we're getting a template, or if we need to\n    // load the template - and be sure to cache the result.\n    var fn = !/\\W/.test(str)\n      ? (cache[str] =\n          cache[str] || tmpl(document.getElementById(str).innerHTML))\n      : // Generate a reusable function that will serve as a template\n        // generator (and which will be cached).\n        new Function(\n          \"obj\",\n          \"var p=[],print=function(){p.push.apply(p,arguments);};\" +\n            // Introduce the data as local variables using with(){}\n            \"with(obj){p.push('\" +\n            // Convert the template into pure JavaScript\n            str\n              .replace(/[\\r\\t\\n]/g, \" \")\n              .split(\"\u003C%\")\n              .join(\"\\t\")\n              .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\n              .replace(/\\t=(.*?)%>/g, \"',$1,'\")\n              .split(\"\\t\")\n              .join(\"');\")\n              .split(\"%>\")\n              .join(\"p.push('\")\n              .split(\"\\r\")\n              .join(\"\\\\'\") +\n            \"');}return p.join('');\"\n        );\n\n    // Provide some basic currying to the user\n    return data ? fn(data) : fn;\n  };\n})();\n",[768],{"type":398,"tag":414,"props":769,"children":770},{"__ignoreMap":392},[771,779,787,809,833,842,903,911,919,977,1014,1087,1100,1109,1128,1151,1173,1182,1204,1213,1222,1286,1320,1355,1466,1545,1577,1610,1642,1675,1707,1750,1768,1782,1790,1799,1846,1855],{"type":398,"tag":450,"props":772,"children":773},{"class":452,"line":453},[774],{"type":398,"tag":450,"props":775,"children":776},{"style":642},[777],{"type":403,"value":778},"// Simple JavaScript Templating\n",{"type":398,"tag":450,"props":780,"children":781},{"class":452,"line":475},[782],{"type":398,"tag":450,"props":783,"children":784},{"style":642},[785],{"type":403,"value":786},"// John Resig - https://johnresig.com/ - MIT Licensed\n",{"type":398,"tag":450,"props":788,"children":789},{"class":452,"line":485},[790,794,800,805],{"type":398,"tag":450,"props":791,"children":792},{"style":463},[793],{"type":403,"value":466},{"type":398,"tag":450,"props":795,"children":797},{"style":796},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-light-font-style:inherit;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[798],{"type":403,"value":799},"function",{"type":398,"tag":450,"props":801,"children":802},{"style":548},[803],{"type":403,"value":804}," ()",{"type":398,"tag":450,"props":806,"children":807},{"style":548},[808],{"type":403,"value":556},{"type":398,"tag":450,"props":810,"children":811},{"class":452,"line":494},[812,817,822,828],{"type":398,"tag":450,"props":813,"children":814},{"style":796},[815],{"type":403,"value":816},"  var",{"type":398,"tag":450,"props":818,"children":819},{"style":463},[820],{"type":403,"value":821}," cache",{"type":398,"tag":450,"props":823,"children":825},{"style":824},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[826],{"type":403,"value":827}," =",{"type":398,"tag":450,"props":829,"children":830},{"style":548},[831],{"type":403,"value":832}," {};\n",{"type":398,"tag":450,"props":834,"children":835},{"class":452,"line":503},[836],{"type":398,"tag":450,"props":837,"children":839},{"emptyLinePlaceholder":838},true,[840],{"type":403,"value":841},"\n",{"type":398,"tag":450,"props":843,"children":844},{"class":452,"line":512},[845,851,856,861,865,870,875,879,885,889,894,899],{"type":398,"tag":450,"props":846,"children":848},{"style":847},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[849],{"type":403,"value":850},"  this",{"type":398,"tag":450,"props":852,"children":853},{"style":548},[854],{"type":403,"value":855},".",{"type":398,"tag":450,"props":857,"children":858},{"style":457},[859],{"type":403,"value":860},"tmpl",{"type":398,"tag":450,"props":862,"children":863},{"style":824},[864],{"type":403,"value":827},{"type":398,"tag":450,"props":866,"children":867},{"style":796},[868],{"type":403,"value":869}," function",{"type":398,"tag":450,"props":871,"children":872},{"style":457},[873],{"type":403,"value":874}," tmpl",{"type":398,"tag":450,"props":876,"children":877},{"style":548},[878],{"type":403,"value":466},{"type":398,"tag":450,"props":880,"children":882},{"style":881},"--shiki-light:#90A4AE;--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[883],{"type":403,"value":884},"str",{"type":398,"tag":450,"props":886,"children":887},{"style":548},[888],{"type":403,"value":551},{"type":398,"tag":450,"props":890,"children":891},{"style":881},[892],{"type":403,"value":893}," data",{"type":398,"tag":450,"props":895,"children":896},{"style":548},[897],{"type":403,"value":898},")",{"type":398,"tag":450,"props":900,"children":901},{"style":548},[902],{"type":403,"value":556},{"type":398,"tag":450,"props":904,"children":905},{"class":452,"line":521},[906],{"type":398,"tag":450,"props":907,"children":908},{"style":642},[909],{"type":403,"value":910},"    // Figure out if we're getting a template, or if we need to\n",{"type":398,"tag":450,"props":912,"children":913},{"class":452,"line":530},[914],{"type":398,"tag":450,"props":915,"children":916},{"style":642},[917],{"type":403,"value":918},"    // load the template - and be sure to cache the result.\n",{"type":398,"tag":450,"props":920,"children":921},{"class":452,"line":539},[922,927,932,936,941,946,952,956,960,965,969,973],{"type":398,"tag":450,"props":923,"children":924},{"style":796},[925],{"type":403,"value":926},"    var",{"type":398,"tag":450,"props":928,"children":929},{"style":463},[930],{"type":403,"value":931}," fn",{"type":398,"tag":450,"props":933,"children":934},{"style":824},[935],{"type":403,"value":827},{"type":398,"tag":450,"props":937,"children":938},{"style":824},[939],{"type":403,"value":940}," !",{"type":398,"tag":450,"props":942,"children":943},{"style":469},[944],{"type":403,"value":945},"/",{"type":398,"tag":450,"props":947,"children":949},{"style":948},"--shiki-light:#91B859;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[950],{"type":403,"value":951},"\\W",{"type":398,"tag":450,"props":953,"children":954},{"style":469},[955],{"type":403,"value":945},{"type":398,"tag":450,"props":957,"children":958},{"style":548},[959],{"type":403,"value":855},{"type":398,"tag":450,"props":961,"children":962},{"style":457},[963],{"type":403,"value":964},"test",{"type":398,"tag":450,"props":966,"children":967},{"style":563},[968],{"type":403,"value":466},{"type":398,"tag":450,"props":970,"children":971},{"style":463},[972],{"type":403,"value":884},{"type":398,"tag":450,"props":974,"children":975},{"style":563},[976],{"type":403,"value":615},{"type":398,"tag":450,"props":978,"children":979},{"class":452,"line":559},[980,985,990,995,1000,1004,1009],{"type":398,"tag":450,"props":981,"children":982},{"style":824},[983],{"type":403,"value":984},"      ?",{"type":398,"tag":450,"props":986,"children":987},{"style":563},[988],{"type":403,"value":989}," (",{"type":398,"tag":450,"props":991,"children":992},{"style":463},[993],{"type":403,"value":994},"cache",{"type":398,"tag":450,"props":996,"children":997},{"style":563},[998],{"type":403,"value":999},"[",{"type":398,"tag":450,"props":1001,"children":1002},{"style":463},[1003],{"type":403,"value":884},{"type":398,"tag":450,"props":1005,"children":1006},{"style":563},[1007],{"type":403,"value":1008},"] ",{"type":398,"tag":450,"props":1010,"children":1011},{"style":824},[1012],{"type":403,"value":1013},"=\n",{"type":398,"tag":450,"props":1015,"children":1016},{"class":452,"line":585},[1017,1022,1026,1030,1034,1039,1043,1047,1052,1056,1061,1065,1069,1073,1077,1082],{"type":398,"tag":450,"props":1018,"children":1019},{"style":463},[1020],{"type":403,"value":1021},"          cache",{"type":398,"tag":450,"props":1023,"children":1024},{"style":563},[1025],{"type":403,"value":999},{"type":398,"tag":450,"props":1027,"children":1028},{"style":463},[1029],{"type":403,"value":884},{"type":398,"tag":450,"props":1031,"children":1032},{"style":563},[1033],{"type":403,"value":1008},{"type":398,"tag":450,"props":1035,"children":1036},{"style":824},[1037],{"type":403,"value":1038},"||",{"type":398,"tag":450,"props":1040,"children":1041},{"style":457},[1042],{"type":403,"value":874},{"type":398,"tag":450,"props":1044,"children":1045},{"style":563},[1046],{"type":403,"value":466},{"type":398,"tag":450,"props":1048,"children":1049},{"style":463},[1050],{"type":403,"value":1051},"document",{"type":398,"tag":450,"props":1053,"children":1054},{"style":548},[1055],{"type":403,"value":855},{"type":398,"tag":450,"props":1057,"children":1058},{"style":457},[1059],{"type":403,"value":1060},"getElementById",{"type":398,"tag":450,"props":1062,"children":1063},{"style":563},[1064],{"type":403,"value":466},{"type":398,"tag":450,"props":1066,"children":1067},{"style":463},[1068],{"type":403,"value":884},{"type":398,"tag":450,"props":1070,"children":1071},{"style":563},[1072],{"type":403,"value":898},{"type":398,"tag":450,"props":1074,"children":1075},{"style":548},[1076],{"type":403,"value":855},{"type":398,"tag":450,"props":1078,"children":1079},{"style":463},[1080],{"type":403,"value":1081},"innerHTML",{"type":398,"tag":450,"props":1083,"children":1084},{"style":563},[1085],{"type":403,"value":1086},"))\n",{"type":398,"tag":450,"props":1088,"children":1089},{"class":452,"line":604},[1090,1095],{"type":398,"tag":450,"props":1091,"children":1092},{"style":824},[1093],{"type":403,"value":1094},"      :",{"type":398,"tag":450,"props":1096,"children":1097},{"style":642},[1098],{"type":403,"value":1099}," // Generate a reusable function that will serve as a template\n",{"type":398,"tag":450,"props":1101,"children":1103},{"class":452,"line":1102},13,[1104],{"type":398,"tag":450,"props":1105,"children":1106},{"style":642},[1107],{"type":403,"value":1108},"        // generator (and which will be cached).\n",{"type":398,"tag":450,"props":1110,"children":1112},{"class":452,"line":1111},14,[1113,1118,1123],{"type":398,"tag":450,"props":1114,"children":1115},{"style":824},[1116],{"type":403,"value":1117},"        new",{"type":398,"tag":450,"props":1119,"children":1120},{"style":457},[1121],{"type":403,"value":1122}," Function",{"type":398,"tag":450,"props":1124,"children":1125},{"style":563},[1126],{"type":403,"value":1127},"(\n",{"type":398,"tag":450,"props":1129,"children":1131},{"class":452,"line":1130},15,[1132,1137,1142,1147],{"type":398,"tag":450,"props":1133,"children":1134},{"style":469},[1135],{"type":403,"value":1136},"          \"",{"type":398,"tag":450,"props":1138,"children":1139},{"style":479},[1140],{"type":403,"value":1141},"obj",{"type":398,"tag":450,"props":1143,"children":1144},{"style":469},[1145],{"type":403,"value":1146},"\"",{"type":398,"tag":450,"props":1148,"children":1149},{"style":548},[1150],{"type":403,"value":582},{"type":398,"tag":450,"props":1152,"children":1154},{"class":452,"line":1153},16,[1155,1159,1164,1168],{"type":398,"tag":450,"props":1156,"children":1157},{"style":469},[1158],{"type":403,"value":1136},{"type":398,"tag":450,"props":1160,"children":1161},{"style":479},[1162],{"type":403,"value":1163},"var p=[],print=function(){p.push.apply(p,arguments);};",{"type":398,"tag":450,"props":1165,"children":1166},{"style":469},[1167],{"type":403,"value":1146},{"type":398,"tag":450,"props":1169,"children":1170},{"style":824},[1171],{"type":403,"value":1172}," +\n",{"type":398,"tag":450,"props":1174,"children":1176},{"class":452,"line":1175},17,[1177],{"type":398,"tag":450,"props":1178,"children":1179},{"style":642},[1180],{"type":403,"value":1181},"            // Introduce the data as local variables using with(){}\n",{"type":398,"tag":450,"props":1183,"children":1185},{"class":452,"line":1184},18,[1186,1191,1196,1200],{"type":398,"tag":450,"props":1187,"children":1188},{"style":469},[1189],{"type":403,"value":1190},"            \"",{"type":398,"tag":450,"props":1192,"children":1193},{"style":479},[1194],{"type":403,"value":1195},"with(obj){p.push('",{"type":398,"tag":450,"props":1197,"children":1198},{"style":469},[1199],{"type":403,"value":1146},{"type":398,"tag":450,"props":1201,"children":1202},{"style":824},[1203],{"type":403,"value":1172},{"type":398,"tag":450,"props":1205,"children":1207},{"class":452,"line":1206},19,[1208],{"type":398,"tag":450,"props":1209,"children":1210},{"style":642},[1211],{"type":403,"value":1212},"            // Convert the template into pure JavaScript\n",{"type":398,"tag":450,"props":1214,"children":1216},{"class":452,"line":1215},20,[1217],{"type":398,"tag":450,"props":1218,"children":1219},{"style":463},[1220],{"type":403,"value":1221},"            str\n",{"type":398,"tag":450,"props":1223,"children":1225},{"class":452,"line":1224},21,[1226,1231,1236,1240,1244,1249,1254,1259,1263,1269,1273,1278,1282],{"type":398,"tag":450,"props":1227,"children":1228},{"style":548},[1229],{"type":403,"value":1230},"              .",{"type":398,"tag":450,"props":1232,"children":1233},{"style":457},[1234],{"type":403,"value":1235},"replace",{"type":398,"tag":450,"props":1237,"children":1238},{"style":563},[1239],{"type":403,"value":466},{"type":398,"tag":450,"props":1241,"children":1242},{"style":469},[1243],{"type":403,"value":945},{"type":398,"tag":450,"props":1245,"children":1247},{"style":1246},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1248],{"type":403,"value":999},{"type":398,"tag":450,"props":1250,"children":1251},{"style":948},[1252],{"type":403,"value":1253},"\\r\\t\\n",{"type":398,"tag":450,"props":1255,"children":1256},{"style":1246},[1257],{"type":403,"value":1258},"]",{"type":398,"tag":450,"props":1260,"children":1261},{"style":469},[1262],{"type":403,"value":945},{"type":398,"tag":450,"props":1264,"children":1266},{"style":1265},"--shiki-light:#F76D47;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1267],{"type":403,"value":1268},"g",{"type":398,"tag":450,"props":1270,"children":1271},{"style":548},[1272],{"type":403,"value":551},{"type":398,"tag":450,"props":1274,"children":1275},{"style":469},[1276],{"type":403,"value":1277}," \"",{"type":398,"tag":450,"props":1279,"children":1280},{"style":469},[1281],{"type":403,"value":1277},{"type":398,"tag":450,"props":1283,"children":1284},{"style":563},[1285],{"type":403,"value":615},{"type":398,"tag":450,"props":1287,"children":1289},{"class":452,"line":1288},22,[1290,1294,1299,1303,1307,1312,1316],{"type":398,"tag":450,"props":1291,"children":1292},{"style":548},[1293],{"type":403,"value":1230},{"type":398,"tag":450,"props":1295,"children":1296},{"style":457},[1297],{"type":403,"value":1298},"split",{"type":398,"tag":450,"props":1300,"children":1301},{"style":563},[1302],{"type":403,"value":466},{"type":398,"tag":450,"props":1304,"children":1305},{"style":469},[1306],{"type":403,"value":1146},{"type":398,"tag":450,"props":1308,"children":1309},{"style":479},[1310],{"type":403,"value":1311},"\u003C%",{"type":398,"tag":450,"props":1313,"children":1314},{"style":469},[1315],{"type":403,"value":1146},{"type":398,"tag":450,"props":1317,"children":1318},{"style":563},[1319],{"type":403,"value":615},{"type":398,"tag":450,"props":1321,"children":1323},{"class":452,"line":1322},23,[1324,1328,1333,1337,1341,1347,1351],{"type":398,"tag":450,"props":1325,"children":1326},{"style":548},[1327],{"type":403,"value":1230},{"type":398,"tag":450,"props":1329,"children":1330},{"style":457},[1331],{"type":403,"value":1332},"join",{"type":398,"tag":450,"props":1334,"children":1335},{"style":563},[1336],{"type":403,"value":466},{"type":398,"tag":450,"props":1338,"children":1339},{"style":469},[1340],{"type":403,"value":1146},{"type":398,"tag":450,"props":1342,"children":1344},{"style":1343},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1345],{"type":403,"value":1346},"\\t",{"type":398,"tag":450,"props":1348,"children":1349},{"style":469},[1350],{"type":403,"value":1146},{"type":398,"tag":450,"props":1352,"children":1353},{"style":563},[1354],{"type":403,"value":615},{"type":398,"tag":450,"props":1356,"children":1358},{"class":452,"line":1357},24,[1359,1363,1367,1371,1375,1381,1387,1392,1398,1402,1406,1410,1414,1418,1423,1427,1432,1436,1440,1444,1448,1453,1458,1462],{"type":398,"tag":450,"props":1360,"children":1361},{"style":548},[1362],{"type":403,"value":1230},{"type":398,"tag":450,"props":1364,"children":1365},{"style":457},[1366],{"type":403,"value":1235},{"type":398,"tag":450,"props":1368,"children":1369},{"style":563},[1370],{"type":403,"value":466},{"type":398,"tag":450,"props":1372,"children":1373},{"style":469},[1374],{"type":403,"value":945},{"type":398,"tag":450,"props":1376,"children":1378},{"style":1377},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[1379],{"type":403,"value":1380},"((",{"type":398,"tag":450,"props":1382,"children":1384},{"style":1383},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[1385],{"type":403,"value":1386},"^",{"type":398,"tag":450,"props":1388,"children":1389},{"style":824},[1390],{"type":403,"value":1391},"|",{"type":398,"tag":450,"props":1393,"children":1395},{"style":1394},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[1396],{"type":403,"value":1397},"%>",{"type":398,"tag":450,"props":1399,"children":1400},{"style":1377},[1401],{"type":403,"value":898},{"type":398,"tag":450,"props":1403,"children":1404},{"style":1246},[1405],{"type":403,"value":999},{"type":398,"tag":450,"props":1407,"children":1408},{"style":824},[1409],{"type":403,"value":1386},{"type":398,"tag":450,"props":1411,"children":1412},{"style":948},[1413],{"type":403,"value":1346},{"type":398,"tag":450,"props":1415,"children":1416},{"style":1246},[1417],{"type":403,"value":1258},{"type":398,"tag":450,"props":1419,"children":1420},{"style":824},[1421],{"type":403,"value":1422},"*",{"type":398,"tag":450,"props":1424,"children":1425},{"style":1377},[1426],{"type":403,"value":898},{"type":398,"tag":450,"props":1428,"children":1429},{"style":1394},[1430],{"type":403,"value":1431},"'",{"type":398,"tag":450,"props":1433,"children":1434},{"style":469},[1435],{"type":403,"value":945},{"type":398,"tag":450,"props":1437,"children":1438},{"style":1265},[1439],{"type":403,"value":1268},{"type":398,"tag":450,"props":1441,"children":1442},{"style":548},[1443],{"type":403,"value":551},{"type":398,"tag":450,"props":1445,"children":1446},{"style":469},[1447],{"type":403,"value":1277},{"type":398,"tag":450,"props":1449,"children":1450},{"style":479},[1451],{"type":403,"value":1452},"$1",{"type":398,"tag":450,"props":1454,"children":1455},{"style":1343},[1456],{"type":403,"value":1457},"\\r",{"type":398,"tag":450,"props":1459,"children":1460},{"style":469},[1461],{"type":403,"value":1146},{"type":398,"tag":450,"props":1463,"children":1464},{"style":563},[1465],{"type":403,"value":615},{"type":398,"tag":450,"props":1467,"children":1469},{"class":452,"line":1468},25,[1470,1474,1478,1482,1486,1490,1495,1499,1503,1508,1512,1516,1520,1524,1528,1532,1537,1541],{"type":398,"tag":450,"props":1471,"children":1472},{"style":548},[1473],{"type":403,"value":1230},{"type":398,"tag":450,"props":1475,"children":1476},{"style":457},[1477],{"type":403,"value":1235},{"type":398,"tag":450,"props":1479,"children":1480},{"style":563},[1481],{"type":403,"value":466},{"type":398,"tag":450,"props":1483,"children":1484},{"style":469},[1485],{"type":403,"value":945},{"type":398,"tag":450,"props":1487,"children":1488},{"style":948},[1489],{"type":403,"value":1346},{"type":398,"tag":450,"props":1491,"children":1492},{"style":1394},[1493],{"type":403,"value":1494},"=",{"type":398,"tag":450,"props":1496,"children":1497},{"style":1377},[1498],{"type":403,"value":466},{"type":398,"tag":450,"props":1500,"children":1501},{"style":948},[1502],{"type":403,"value":855},{"type":398,"tag":450,"props":1504,"children":1505},{"style":824},[1506],{"type":403,"value":1507},"*?",{"type":398,"tag":450,"props":1509,"children":1510},{"style":1377},[1511],{"type":403,"value":898},{"type":398,"tag":450,"props":1513,"children":1514},{"style":1394},[1515],{"type":403,"value":1397},{"type":398,"tag":450,"props":1517,"children":1518},{"style":469},[1519],{"type":403,"value":945},{"type":398,"tag":450,"props":1521,"children":1522},{"style":1265},[1523],{"type":403,"value":1268},{"type":398,"tag":450,"props":1525,"children":1526},{"style":548},[1527],{"type":403,"value":551},{"type":398,"tag":450,"props":1529,"children":1530},{"style":469},[1531],{"type":403,"value":1277},{"type":398,"tag":450,"props":1533,"children":1534},{"style":479},[1535],{"type":403,"value":1536},"',$1,'",{"type":398,"tag":450,"props":1538,"children":1539},{"style":469},[1540],{"type":403,"value":1146},{"type":398,"tag":450,"props":1542,"children":1543},{"style":563},[1544],{"type":403,"value":615},{"type":398,"tag":450,"props":1546,"children":1548},{"class":452,"line":1547},26,[1549,1553,1557,1561,1565,1569,1573],{"type":398,"tag":450,"props":1550,"children":1551},{"style":548},[1552],{"type":403,"value":1230},{"type":398,"tag":450,"props":1554,"children":1555},{"style":457},[1556],{"type":403,"value":1298},{"type":398,"tag":450,"props":1558,"children":1559},{"style":563},[1560],{"type":403,"value":466},{"type":398,"tag":450,"props":1562,"children":1563},{"style":469},[1564],{"type":403,"value":1146},{"type":398,"tag":450,"props":1566,"children":1567},{"style":1343},[1568],{"type":403,"value":1346},{"type":398,"tag":450,"props":1570,"children":1571},{"style":469},[1572],{"type":403,"value":1146},{"type":398,"tag":450,"props":1574,"children":1575},{"style":563},[1576],{"type":403,"value":615},{"type":398,"tag":450,"props":1578,"children":1580},{"class":452,"line":1579},27,[1581,1585,1589,1593,1597,1602,1606],{"type":398,"tag":450,"props":1582,"children":1583},{"style":548},[1584],{"type":403,"value":1230},{"type":398,"tag":450,"props":1586,"children":1587},{"style":457},[1588],{"type":403,"value":1332},{"type":398,"tag":450,"props":1590,"children":1591},{"style":563},[1592],{"type":403,"value":466},{"type":398,"tag":450,"props":1594,"children":1595},{"style":469},[1596],{"type":403,"value":1146},{"type":398,"tag":450,"props":1598,"children":1599},{"style":479},[1600],{"type":403,"value":1601},"');",{"type":398,"tag":450,"props":1603,"children":1604},{"style":469},[1605],{"type":403,"value":1146},{"type":398,"tag":450,"props":1607,"children":1608},{"style":563},[1609],{"type":403,"value":615},{"type":398,"tag":450,"props":1611,"children":1613},{"class":452,"line":1612},28,[1614,1618,1622,1626,1630,1634,1638],{"type":398,"tag":450,"props":1615,"children":1616},{"style":548},[1617],{"type":403,"value":1230},{"type":398,"tag":450,"props":1619,"children":1620},{"style":457},[1621],{"type":403,"value":1298},{"type":398,"tag":450,"props":1623,"children":1624},{"style":563},[1625],{"type":403,"value":466},{"type":398,"tag":450,"props":1627,"children":1628},{"style":469},[1629],{"type":403,"value":1146},{"type":398,"tag":450,"props":1631,"children":1632},{"style":479},[1633],{"type":403,"value":1397},{"type":398,"tag":450,"props":1635,"children":1636},{"style":469},[1637],{"type":403,"value":1146},{"type":398,"tag":450,"props":1639,"children":1640},{"style":563},[1641],{"type":403,"value":615},{"type":398,"tag":450,"props":1643,"children":1645},{"class":452,"line":1644},29,[1646,1650,1654,1658,1662,1667,1671],{"type":398,"tag":450,"props":1647,"children":1648},{"style":548},[1649],{"type":403,"value":1230},{"type":398,"tag":450,"props":1651,"children":1652},{"style":457},[1653],{"type":403,"value":1332},{"type":398,"tag":450,"props":1655,"children":1656},{"style":563},[1657],{"type":403,"value":466},{"type":398,"tag":450,"props":1659,"children":1660},{"style":469},[1661],{"type":403,"value":1146},{"type":398,"tag":450,"props":1663,"children":1664},{"style":479},[1665],{"type":403,"value":1666},"p.push('",{"type":398,"tag":450,"props":1668,"children":1669},{"style":469},[1670],{"type":403,"value":1146},{"type":398,"tag":450,"props":1672,"children":1673},{"style":563},[1674],{"type":403,"value":615},{"type":398,"tag":450,"props":1676,"children":1678},{"class":452,"line":1677},30,[1679,1683,1687,1691,1695,1699,1703],{"type":398,"tag":450,"props":1680,"children":1681},{"style":548},[1682],{"type":403,"value":1230},{"type":398,"tag":450,"props":1684,"children":1685},{"style":457},[1686],{"type":403,"value":1298},{"type":398,"tag":450,"props":1688,"children":1689},{"style":563},[1690],{"type":403,"value":466},{"type":398,"tag":450,"props":1692,"children":1693},{"style":469},[1694],{"type":403,"value":1146},{"type":398,"tag":450,"props":1696,"children":1697},{"style":1343},[1698],{"type":403,"value":1457},{"type":398,"tag":450,"props":1700,"children":1701},{"style":469},[1702],{"type":403,"value":1146},{"type":398,"tag":450,"props":1704,"children":1705},{"style":563},[1706],{"type":403,"value":615},{"type":398,"tag":450,"props":1708,"children":1710},{"class":452,"line":1709},31,[1711,1715,1719,1723,1727,1732,1736,1740,1745],{"type":398,"tag":450,"props":1712,"children":1713},{"style":548},[1714],{"type":403,"value":1230},{"type":398,"tag":450,"props":1716,"children":1717},{"style":457},[1718],{"type":403,"value":1332},{"type":398,"tag":450,"props":1720,"children":1721},{"style":563},[1722],{"type":403,"value":466},{"type":398,"tag":450,"props":1724,"children":1725},{"style":469},[1726],{"type":403,"value":1146},{"type":398,"tag":450,"props":1728,"children":1729},{"style":1343},[1730],{"type":403,"value":1731},"\\\\",{"type":398,"tag":450,"props":1733,"children":1734},{"style":479},[1735],{"type":403,"value":1431},{"type":398,"tag":450,"props":1737,"children":1738},{"style":469},[1739],{"type":403,"value":1146},{"type":398,"tag":450,"props":1741,"children":1742},{"style":563},[1743],{"type":403,"value":1744},") ",{"type":398,"tag":450,"props":1746,"children":1747},{"style":824},[1748],{"type":403,"value":1749},"+\n",{"type":398,"tag":450,"props":1751,"children":1753},{"class":452,"line":1752},32,[1754,1758,1763],{"type":398,"tag":450,"props":1755,"children":1756},{"style":469},[1757],{"type":403,"value":1190},{"type":398,"tag":450,"props":1759,"children":1760},{"style":479},[1761],{"type":403,"value":1762},"');}return p.join('');",{"type":398,"tag":450,"props":1764,"children":1765},{"style":469},[1766],{"type":403,"value":1767},"\"\n",{"type":398,"tag":450,"props":1769,"children":1771},{"class":452,"line":1770},33,[1772,1777],{"type":398,"tag":450,"props":1773,"children":1774},{"style":563},[1775],{"type":403,"value":1776},"        )",{"type":398,"tag":450,"props":1778,"children":1779},{"style":548},[1780],{"type":403,"value":1781},";\n",{"type":398,"tag":450,"props":1783,"children":1785},{"class":452,"line":1784},34,[1786],{"type":398,"tag":450,"props":1787,"children":1788},{"emptyLinePlaceholder":838},[1789],{"type":403,"value":841},{"type":398,"tag":450,"props":1791,"children":1793},{"class":452,"line":1792},35,[1794],{"type":398,"tag":450,"props":1795,"children":1796},{"style":642},[1797],{"type":403,"value":1798},"    // Provide some basic currying to the user\n",{"type":398,"tag":450,"props":1800,"children":1802},{"class":452,"line":1801},36,[1803,1808,1812,1817,1821,1825,1830,1834,1838,1842],{"type":398,"tag":450,"props":1804,"children":1805},{"style":1383},[1806],{"type":403,"value":1807},"    return",{"type":398,"tag":450,"props":1809,"children":1810},{"style":463},[1811],{"type":403,"value":893},{"type":398,"tag":450,"props":1813,"children":1814},{"style":824},[1815],{"type":403,"value":1816}," ?",{"type":398,"tag":450,"props":1818,"children":1819},{"style":457},[1820],{"type":403,"value":931},{"type":398,"tag":450,"props":1822,"children":1823},{"style":563},[1824],{"type":403,"value":466},{"type":398,"tag":450,"props":1826,"children":1827},{"style":463},[1828],{"type":403,"value":1829},"data",{"type":398,"tag":450,"props":1831,"children":1832},{"style":563},[1833],{"type":403,"value":1744},{"type":398,"tag":450,"props":1835,"children":1836},{"style":824},[1837],{"type":403,"value":571},{"type":398,"tag":450,"props":1839,"children":1840},{"style":463},[1841],{"type":403,"value":931},{"type":398,"tag":450,"props":1843,"children":1844},{"style":548},[1845],{"type":403,"value":1781},{"type":398,"tag":450,"props":1847,"children":1849},{"class":452,"line":1848},37,[1850],{"type":398,"tag":450,"props":1851,"children":1852},{"style":548},[1853],{"type":403,"value":1854},"  };\n",{"type":398,"tag":450,"props":1856,"children":1858},{"class":452,"line":1857},38,[1859,1863,1868],{"type":398,"tag":450,"props":1860,"children":1861},{"style":548},[1862],{"type":403,"value":610},{"type":398,"tag":450,"props":1864,"children":1865},{"style":463},[1866],{"type":403,"value":1867},")()",{"type":398,"tag":450,"props":1869,"children":1870},{"style":548},[1871],{"type":403,"value":1781},{"type":398,"tag":399,"props":1873,"children":1874},{},[1875],{"type":403,"value":1876},"代码看完了，我知道你没看懂，因为曾经我也是。好了，留下三连，解析开始。",{"type":398,"tag":754,"props":1878,"children":1880},{"id":1879},"解析",[1881],{"type":403,"value":1879},{"type":398,"tag":399,"props":1883,"children":1884},{},[1885],{"type":403,"value":1886},"首先，代码最外层是一个 IIFE，给 this 对象挂载了 tmpl 函数，直接执行的话就是 window。内部通过局部变量保存了模板解析的缓存：",{"type":398,"tag":440,"props":1888,"children":1890},{"className":442,"code":1889,"language":444,"meta":392,"style":392},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {};\n})();\n",[1891],{"type":398,"tag":414,"props":1892,"children":1893},{"__ignoreMap":392},[1894,1913,1932,1983],{"type":398,"tag":450,"props":1895,"children":1896},{"class":452,"line":453},[1897,1901,1905,1909],{"type":398,"tag":450,"props":1898,"children":1899},{"style":463},[1900],{"type":403,"value":466},{"type":398,"tag":450,"props":1902,"children":1903},{"style":796},[1904],{"type":403,"value":799},{"type":398,"tag":450,"props":1906,"children":1907},{"style":548},[1908],{"type":403,"value":804},{"type":398,"tag":450,"props":1910,"children":1911},{"style":548},[1912],{"type":403,"value":556},{"type":398,"tag":450,"props":1914,"children":1915},{"class":452,"line":475},[1916,1920,1924,1928],{"type":398,"tag":450,"props":1917,"children":1918},{"style":796},[1919],{"type":403,"value":816},{"type":398,"tag":450,"props":1921,"children":1922},{"style":463},[1923],{"type":403,"value":821},{"type":398,"tag":450,"props":1925,"children":1926},{"style":824},[1927],{"type":403,"value":827},{"type":398,"tag":450,"props":1929,"children":1930},{"style":548},[1931],{"type":403,"value":832},{"type":398,"tag":450,"props":1933,"children":1934},{"class":452,"line":485},[1935,1939,1943,1947,1951,1955,1959,1963,1967,1971,1975,1979],{"type":398,"tag":450,"props":1936,"children":1937},{"style":847},[1938],{"type":403,"value":850},{"type":398,"tag":450,"props":1940,"children":1941},{"style":548},[1942],{"type":403,"value":855},{"type":398,"tag":450,"props":1944,"children":1945},{"style":457},[1946],{"type":403,"value":860},{"type":398,"tag":450,"props":1948,"children":1949},{"style":824},[1950],{"type":403,"value":827},{"type":398,"tag":450,"props":1952,"children":1953},{"style":796},[1954],{"type":403,"value":869},{"type":398,"tag":450,"props":1956,"children":1957},{"style":457},[1958],{"type":403,"value":874},{"type":398,"tag":450,"props":1960,"children":1961},{"style":548},[1962],{"type":403,"value":466},{"type":398,"tag":450,"props":1964,"children":1965},{"style":881},[1966],{"type":403,"value":884},{"type":398,"tag":450,"props":1968,"children":1969},{"style":548},[1970],{"type":403,"value":551},{"type":398,"tag":450,"props":1972,"children":1973},{"style":881},[1974],{"type":403,"value":893},{"type":398,"tag":450,"props":1976,"children":1977},{"style":548},[1978],{"type":403,"value":898},{"type":398,"tag":450,"props":1980,"children":1981},{"style":548},[1982],{"type":403,"value":832},{"type":398,"tag":450,"props":1984,"children":1985},{"class":452,"line":494},[1986,1990,1994],{"type":398,"tag":450,"props":1987,"children":1988},{"style":548},[1989],{"type":403,"value":610},{"type":398,"tag":450,"props":1991,"children":1992},{"style":463},[1993],{"type":403,"value":1867},{"type":398,"tag":450,"props":1995,"children":1996},{"style":548},[1997],{"type":403,"value":1781},{"type":398,"tag":399,"props":1999,"children":2000},{},[2001,2003,2009],{"type":403,"value":2002},"str 参数有两种两种用途，",{"type":398,"tag":414,"props":2004,"children":2006},{"className":2005},[],[2007],{"type":403,"value":2008},"/\\W/.test(str)",{"type":403,"value":2010}," 用来判断字符串中包不包含模板分隔符，如果不含分隔符，即普通字符串，那就当作 ID，从页面对应 ID 的节点中获取内容作为模板。比如，如果 str 为 'user_tmpl'，那么模板函数将会读取页面的以下脚本的内容作为输入：",{"type":398,"tag":440,"props":2012,"children":2014},{"className":630,"code":2013,"language":632,"meta":392,"style":392},"\u003C!-- type=\"text/html\"，所以浏览器并不会执行这串脚本。它只能由 tmpl 来读取... -->\n\u003Cscript type=\"text/html\" id=\"item_tmpl\">\n  \u003Cdiv id=\"\u003C%=id%>\" class=\"\u003C%=(i % 2 == 1 ? \" even\" : \"\")%>\">\n    \u003Cdiv class=\"grid_1 alpha right\">\n      \u003Cimg class=\"righted\" src=\"\u003C%=profile_image_url%>\"/>\n    \u003C/div>\n    \u003Cdiv class=\"grid_6 omega contents\">\n      \u003Cp>\u003Cb>\u003Ca href=\"/\u003C%=from_user%>\">\u003C%=from_user%>\u003C/a>:\u003C/b> \u003C%=text%>\u003C/p>\n    \u003C/div>\n  \u003C/div>\n\u003C/script>\n",[2015],{"type":398,"tag":414,"props":2016,"children":2017},{"__ignoreMap":392},[2018,2026,2087,2171,2208,2269,2285,2321,2426,2441,2457],{"type":398,"tag":450,"props":2019,"children":2020},{"class":452,"line":453},[2021],{"type":398,"tag":450,"props":2022,"children":2023},{"style":642},[2024],{"type":403,"value":2025},"\u003C!-- type=\"text/html\"，所以浏览器并不会执行这串脚本。它只能由 tmpl 来读取... -->\n",{"type":398,"tag":450,"props":2027,"children":2028},{"class":452,"line":475},[2029,2033,2038,2044,2048,2052,2057,2061,2066,2070,2074,2079,2083],{"type":398,"tag":450,"props":2030,"children":2031},{"style":548},[2032],{"type":403,"value":653},{"type":398,"tag":450,"props":2034,"children":2035},{"style":656},[2036],{"type":403,"value":2037},"script",{"type":398,"tag":450,"props":2039,"children":2041},{"style":2040},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[2042],{"type":403,"value":2043}," type",{"type":398,"tag":450,"props":2045,"children":2046},{"style":548},[2047],{"type":403,"value":1494},{"type":398,"tag":450,"props":2049,"children":2050},{"style":469},[2051],{"type":403,"value":1146},{"type":398,"tag":450,"props":2053,"children":2054},{"style":479},[2055],{"type":403,"value":2056},"text/html",{"type":398,"tag":450,"props":2058,"children":2059},{"style":469},[2060],{"type":403,"value":1146},{"type":398,"tag":450,"props":2062,"children":2063},{"style":2040},[2064],{"type":403,"value":2065}," id",{"type":398,"tag":450,"props":2067,"children":2068},{"style":548},[2069],{"type":403,"value":1494},{"type":398,"tag":450,"props":2071,"children":2072},{"style":469},[2073],{"type":403,"value":1146},{"type":398,"tag":450,"props":2075,"children":2076},{"style":479},[2077],{"type":403,"value":2078},"item_tmpl",{"type":398,"tag":450,"props":2080,"children":2081},{"style":469},[2082],{"type":403,"value":1146},{"type":398,"tag":450,"props":2084,"children":2085},{"style":548},[2086],{"type":403,"value":683},{"type":398,"tag":450,"props":2088,"children":2089},{"class":452,"line":485},[2090,2095,2099,2103,2107,2111,2116,2120,2125,2129,2133,2138,2142,2147,2152,2157,2162,2166],{"type":398,"tag":450,"props":2091,"children":2092},{"style":548},[2093],{"type":403,"value":2094},"  \u003C",{"type":398,"tag":450,"props":2096,"children":2097},{"style":656},[2098],{"type":403,"value":659},{"type":398,"tag":450,"props":2100,"children":2101},{"style":2040},[2102],{"type":403,"value":2065},{"type":398,"tag":450,"props":2104,"children":2105},{"style":548},[2106],{"type":403,"value":1494},{"type":398,"tag":450,"props":2108,"children":2109},{"style":469},[2110],{"type":403,"value":1146},{"type":398,"tag":450,"props":2112,"children":2113},{"style":479},[2114],{"type":403,"value":2115},"\u003C%=id%>",{"type":398,"tag":450,"props":2117,"children":2118},{"style":469},[2119],{"type":403,"value":1146},{"type":398,"tag":450,"props":2121,"children":2122},{"style":2040},[2123],{"type":403,"value":2124}," class",{"type":398,"tag":450,"props":2126,"children":2127},{"style":548},[2128],{"type":403,"value":1494},{"type":398,"tag":450,"props":2130,"children":2131},{"style":469},[2132],{"type":403,"value":1146},{"type":398,"tag":450,"props":2134,"children":2135},{"style":479},[2136],{"type":403,"value":2137},"\u003C%=(i % 2 == 1 ? ",{"type":398,"tag":450,"props":2139,"children":2140},{"style":469},[2141],{"type":403,"value":1146},{"type":398,"tag":450,"props":2143,"children":2144},{"style":2040},[2145],{"type":403,"value":2146}," even",{"type":398,"tag":450,"props":2148,"children":2150},{"style":2149},"--shiki-light:#39ADB5;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F44747;--shiki-light-font-style:inherit;--shiki-default-font-style:italic;--shiki-dark-font-style:italic;--shiki-sepia-font-style:inherit",[2151],{"type":403,"value":1146},{"type":398,"tag":450,"props":2153,"children":2154},{"style":2040},[2155],{"type":403,"value":2156}," :",{"type":398,"tag":450,"props":2158,"children":2159},{"style":2149},[2160],{"type":403,"value":2161}," \"\")%",{"type":398,"tag":450,"props":2163,"children":2164},{"style":548},[2165],{"type":403,"value":664},{"type":398,"tag":450,"props":2167,"children":2168},{"style":463},[2169],{"type":403,"value":2170},"\">\n",{"type":398,"tag":450,"props":2172,"children":2173},{"class":452,"line":494},[2174,2179,2183,2187,2191,2195,2200,2204],{"type":398,"tag":450,"props":2175,"children":2176},{"style":548},[2177],{"type":403,"value":2178},"    \u003C",{"type":398,"tag":450,"props":2180,"children":2181},{"style":656},[2182],{"type":403,"value":659},{"type":398,"tag":450,"props":2184,"children":2185},{"style":2040},[2186],{"type":403,"value":2124},{"type":398,"tag":450,"props":2188,"children":2189},{"style":548},[2190],{"type":403,"value":1494},{"type":398,"tag":450,"props":2192,"children":2193},{"style":469},[2194],{"type":403,"value":1146},{"type":398,"tag":450,"props":2196,"children":2197},{"style":479},[2198],{"type":403,"value":2199},"grid_1 alpha right",{"type":398,"tag":450,"props":2201,"children":2202},{"style":469},[2203],{"type":403,"value":1146},{"type":398,"tag":450,"props":2205,"children":2206},{"style":548},[2207],{"type":403,"value":683},{"type":398,"tag":450,"props":2209,"children":2210},{"class":452,"line":503},[2211,2216,2221,2225,2229,2233,2238,2242,2247,2251,2255,2260,2264],{"type":398,"tag":450,"props":2212,"children":2213},{"style":548},[2214],{"type":403,"value":2215},"      \u003C",{"type":398,"tag":450,"props":2217,"children":2218},{"style":656},[2219],{"type":403,"value":2220},"img",{"type":398,"tag":450,"props":2222,"children":2223},{"style":2040},[2224],{"type":403,"value":2124},{"type":398,"tag":450,"props":2226,"children":2227},{"style":548},[2228],{"type":403,"value":1494},{"type":398,"tag":450,"props":2230,"children":2231},{"style":469},[2232],{"type":403,"value":1146},{"type":398,"tag":450,"props":2234,"children":2235},{"style":479},[2236],{"type":403,"value":2237},"righted",{"type":398,"tag":450,"props":2239,"children":2240},{"style":469},[2241],{"type":403,"value":1146},{"type":398,"tag":450,"props":2243,"children":2244},{"style":2040},[2245],{"type":403,"value":2246}," src",{"type":398,"tag":450,"props":2248,"children":2249},{"style":548},[2250],{"type":403,"value":1494},{"type":398,"tag":450,"props":2252,"children":2253},{"style":469},[2254],{"type":403,"value":1146},{"type":398,"tag":450,"props":2256,"children":2257},{"style":479},[2258],{"type":403,"value":2259},"\u003C%=profile_image_url%>",{"type":398,"tag":450,"props":2261,"children":2262},{"style":469},[2263],{"type":403,"value":1146},{"type":398,"tag":450,"props":2265,"children":2266},{"style":548},[2267],{"type":403,"value":2268},"/>\n",{"type":398,"tag":450,"props":2270,"children":2271},{"class":452,"line":512},[2272,2277,2281],{"type":398,"tag":450,"props":2273,"children":2274},{"style":548},[2275],{"type":403,"value":2276},"    \u003C/",{"type":398,"tag":450,"props":2278,"children":2279},{"style":656},[2280],{"type":403,"value":659},{"type":398,"tag":450,"props":2282,"children":2283},{"style":548},[2284],{"type":403,"value":683},{"type":398,"tag":450,"props":2286,"children":2287},{"class":452,"line":521},[2288,2292,2296,2300,2304,2308,2313,2317],{"type":398,"tag":450,"props":2289,"children":2290},{"style":548},[2291],{"type":403,"value":2178},{"type":398,"tag":450,"props":2293,"children":2294},{"style":656},[2295],{"type":403,"value":659},{"type":398,"tag":450,"props":2297,"children":2298},{"style":2040},[2299],{"type":403,"value":2124},{"type":398,"tag":450,"props":2301,"children":2302},{"style":548},[2303],{"type":403,"value":1494},{"type":398,"tag":450,"props":2305,"children":2306},{"style":469},[2307],{"type":403,"value":1146},{"type":398,"tag":450,"props":2309,"children":2310},{"style":479},[2311],{"type":403,"value":2312},"grid_6 omega contents",{"type":398,"tag":450,"props":2314,"children":2315},{"style":469},[2316],{"type":403,"value":1146},{"type":398,"tag":450,"props":2318,"children":2319},{"style":548},[2320],{"type":403,"value":683},{"type":398,"tag":450,"props":2322,"children":2323},{"class":452,"line":530},[2324,2328,2332,2337,2342,2346,2350,2355,2359,2363,2368,2372,2376,2381,2385,2389,2393,2397,2401,2405,2409,2414,2418,2422],{"type":398,"tag":450,"props":2325,"children":2326},{"style":548},[2327],{"type":403,"value":2215},{"type":398,"tag":450,"props":2329,"children":2330},{"style":656},[2331],{"type":403,"value":399},{"type":398,"tag":450,"props":2333,"children":2334},{"style":548},[2335],{"type":403,"value":2336},">\u003C",{"type":398,"tag":450,"props":2338,"children":2339},{"style":656},[2340],{"type":403,"value":2341},"b",{"type":398,"tag":450,"props":2343,"children":2344},{"style":548},[2345],{"type":403,"value":2336},{"type":398,"tag":450,"props":2347,"children":2348},{"style":656},[2349],{"type":403,"value":406},{"type":398,"tag":450,"props":2351,"children":2352},{"style":2040},[2353],{"type":403,"value":2354}," href",{"type":398,"tag":450,"props":2356,"children":2357},{"style":548},[2358],{"type":403,"value":1494},{"type":398,"tag":450,"props":2360,"children":2361},{"style":469},[2362],{"type":403,"value":1146},{"type":398,"tag":450,"props":2364,"children":2365},{"style":479},[2366],{"type":403,"value":2367},"/\u003C%=from_user%>",{"type":398,"tag":450,"props":2369,"children":2370},{"style":469},[2371],{"type":403,"value":1146},{"type":398,"tag":450,"props":2373,"children":2374},{"style":548},[2375],{"type":403,"value":664},{"type":398,"tag":450,"props":2377,"children":2378},{"style":463},[2379],{"type":403,"value":2380},"\u003C%=from_user%>",{"type":398,"tag":450,"props":2382,"children":2383},{"style":548},[2384],{"type":403,"value":674},{"type":398,"tag":450,"props":2386,"children":2387},{"style":656},[2388],{"type":403,"value":406},{"type":398,"tag":450,"props":2390,"children":2391},{"style":548},[2392],{"type":403,"value":664},{"type":398,"tag":450,"props":2394,"children":2395},{"style":463},[2396],{"type":403,"value":571},{"type":398,"tag":450,"props":2398,"children":2399},{"style":548},[2400],{"type":403,"value":674},{"type":398,"tag":450,"props":2402,"children":2403},{"style":656},[2404],{"type":403,"value":2341},{"type":398,"tag":450,"props":2406,"children":2407},{"style":548},[2408],{"type":403,"value":664},{"type":398,"tag":450,"props":2410,"children":2411},{"style":463},[2412],{"type":403,"value":2413}," \u003C%=text%>",{"type":398,"tag":450,"props":2415,"children":2416},{"style":548},[2417],{"type":403,"value":674},{"type":398,"tag":450,"props":2419,"children":2420},{"style":656},[2421],{"type":403,"value":399},{"type":398,"tag":450,"props":2423,"children":2424},{"style":548},[2425],{"type":403,"value":683},{"type":398,"tag":450,"props":2427,"children":2428},{"class":452,"line":539},[2429,2433,2437],{"type":398,"tag":450,"props":2430,"children":2431},{"style":548},[2432],{"type":403,"value":2276},{"type":398,"tag":450,"props":2434,"children":2435},{"style":656},[2436],{"type":403,"value":659},{"type":398,"tag":450,"props":2438,"children":2439},{"style":548},[2440],{"type":403,"value":683},{"type":398,"tag":450,"props":2442,"children":2443},{"class":452,"line":559},[2444,2449,2453],{"type":398,"tag":450,"props":2445,"children":2446},{"style":548},[2447],{"type":403,"value":2448},"  \u003C/",{"type":398,"tag":450,"props":2450,"children":2451},{"style":656},[2452],{"type":403,"value":659},{"type":398,"tag":450,"props":2454,"children":2455},{"style":548},[2456],{"type":403,"value":683},{"type":398,"tag":450,"props":2458,"children":2459},{"class":452,"line":585},[2460,2464,2468],{"type":398,"tag":450,"props":2461,"children":2462},{"style":548},[2463],{"type":403,"value":674},{"type":398,"tag":450,"props":2465,"children":2466},{"style":656},[2467],{"type":403,"value":2037},{"type":398,"tag":450,"props":2469,"children":2470},{"style":548},[2471],{"type":403,"value":683},{"type":398,"tag":440,"props":2473,"children":2475},{"className":442,"code":2474,"language":444,"meta":392,"style":392},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {\n    return !/\\W/.test(str)\n      ? // 缓存会将读取脚本内容到模板解析这个过程的解析结果缓存下来\n        (cache[str] =\n          cache[str] ||\n          // 读取脚本内容\n          tmpl(document.getElementById(str).innerHTML))\n      : new Function();\n  };\n})();\n",[2476],{"type":398,"tag":414,"props":2477,"children":2478},{"__ignoreMap":392},[2479,2498,2517,2568,2611,2623,2651,2675,2683,2731,2756,2763],{"type":398,"tag":450,"props":2480,"children":2481},{"class":452,"line":453},[2482,2486,2490,2494],{"type":398,"tag":450,"props":2483,"children":2484},{"style":463},[2485],{"type":403,"value":466},{"type":398,"tag":450,"props":2487,"children":2488},{"style":796},[2489],{"type":403,"value":799},{"type":398,"tag":450,"props":2491,"children":2492},{"style":548},[2493],{"type":403,"value":804},{"type":398,"tag":450,"props":2495,"children":2496},{"style":548},[2497],{"type":403,"value":556},{"type":398,"tag":450,"props":2499,"children":2500},{"class":452,"line":475},[2501,2505,2509,2513],{"type":398,"tag":450,"props":2502,"children":2503},{"style":796},[2504],{"type":403,"value":816},{"type":398,"tag":450,"props":2506,"children":2507},{"style":463},[2508],{"type":403,"value":821},{"type":398,"tag":450,"props":2510,"children":2511},{"style":824},[2512],{"type":403,"value":827},{"type":398,"tag":450,"props":2514,"children":2515},{"style":548},[2516],{"type":403,"value":832},{"type":398,"tag":450,"props":2518,"children":2519},{"class":452,"line":485},[2520,2524,2528,2532,2536,2540,2544,2548,2552,2556,2560,2564],{"type":398,"tag":450,"props":2521,"children":2522},{"style":847},[2523],{"type":403,"value":850},{"type":398,"tag":450,"props":2525,"children":2526},{"style":548},[2527],{"type":403,"value":855},{"type":398,"tag":450,"props":2529,"children":2530},{"style":457},[2531],{"type":403,"value":860},{"type":398,"tag":450,"props":2533,"children":2534},{"style":824},[2535],{"type":403,"value":827},{"type":398,"tag":450,"props":2537,"children":2538},{"style":796},[2539],{"type":403,"value":869},{"type":398,"tag":450,"props":2541,"children":2542},{"style":457},[2543],{"type":403,"value":874},{"type":398,"tag":450,"props":2545,"children":2546},{"style":548},[2547],{"type":403,"value":466},{"type":398,"tag":450,"props":2549,"children":2550},{"style":881},[2551],{"type":403,"value":884},{"type":398,"tag":450,"props":2553,"children":2554},{"style":548},[2555],{"type":403,"value":551},{"type":398,"tag":450,"props":2557,"children":2558},{"style":881},[2559],{"type":403,"value":893},{"type":398,"tag":450,"props":2561,"children":2562},{"style":548},[2563],{"type":403,"value":898},{"type":398,"tag":450,"props":2565,"children":2566},{"style":548},[2567],{"type":403,"value":556},{"type":398,"tag":450,"props":2569,"children":2570},{"class":452,"line":494},[2571,2575,2579,2583,2587,2591,2595,2599,2603,2607],{"type":398,"tag":450,"props":2572,"children":2573},{"style":1383},[2574],{"type":403,"value":1807},{"type":398,"tag":450,"props":2576,"children":2577},{"style":824},[2578],{"type":403,"value":940},{"type":398,"tag":450,"props":2580,"children":2581},{"style":469},[2582],{"type":403,"value":945},{"type":398,"tag":450,"props":2584,"children":2585},{"style":948},[2586],{"type":403,"value":951},{"type":398,"tag":450,"props":2588,"children":2589},{"style":469},[2590],{"type":403,"value":945},{"type":398,"tag":450,"props":2592,"children":2593},{"style":548},[2594],{"type":403,"value":855},{"type":398,"tag":450,"props":2596,"children":2597},{"style":457},[2598],{"type":403,"value":964},{"type":398,"tag":450,"props":2600,"children":2601},{"style":563},[2602],{"type":403,"value":466},{"type":398,"tag":450,"props":2604,"children":2605},{"style":463},[2606],{"type":403,"value":884},{"type":398,"tag":450,"props":2608,"children":2609},{"style":563},[2610],{"type":403,"value":615},{"type":398,"tag":450,"props":2612,"children":2613},{"class":452,"line":503},[2614,2618],{"type":398,"tag":450,"props":2615,"children":2616},{"style":824},[2617],{"type":403,"value":984},{"type":398,"tag":450,"props":2619,"children":2620},{"style":642},[2621],{"type":403,"value":2622}," // 缓存会将读取脚本内容到模板解析这个过程的解析结果缓存下来\n",{"type":398,"tag":450,"props":2624,"children":2625},{"class":452,"line":512},[2626,2631,2635,2639,2643,2647],{"type":398,"tag":450,"props":2627,"children":2628},{"style":563},[2629],{"type":403,"value":2630},"        (",{"type":398,"tag":450,"props":2632,"children":2633},{"style":463},[2634],{"type":403,"value":994},{"type":398,"tag":450,"props":2636,"children":2637},{"style":563},[2638],{"type":403,"value":999},{"type":398,"tag":450,"props":2640,"children":2641},{"style":463},[2642],{"type":403,"value":884},{"type":398,"tag":450,"props":2644,"children":2645},{"style":563},[2646],{"type":403,"value":1008},{"type":398,"tag":450,"props":2648,"children":2649},{"style":824},[2650],{"type":403,"value":1013},{"type":398,"tag":450,"props":2652,"children":2653},{"class":452,"line":521},[2654,2658,2662,2666,2670],{"type":398,"tag":450,"props":2655,"children":2656},{"style":463},[2657],{"type":403,"value":1021},{"type":398,"tag":450,"props":2659,"children":2660},{"style":563},[2661],{"type":403,"value":999},{"type":398,"tag":450,"props":2663,"children":2664},{"style":463},[2665],{"type":403,"value":884},{"type":398,"tag":450,"props":2667,"children":2668},{"style":563},[2669],{"type":403,"value":1008},{"type":398,"tag":450,"props":2671,"children":2672},{"style":824},[2673],{"type":403,"value":2674},"||\n",{"type":398,"tag":450,"props":2676,"children":2677},{"class":452,"line":530},[2678],{"type":398,"tag":450,"props":2679,"children":2680},{"style":642},[2681],{"type":403,"value":2682},"          // 读取脚本内容\n",{"type":398,"tag":450,"props":2684,"children":2685},{"class":452,"line":539},[2686,2691,2695,2699,2703,2707,2711,2715,2719,2723,2727],{"type":398,"tag":450,"props":2687,"children":2688},{"style":457},[2689],{"type":403,"value":2690},"          tmpl",{"type":398,"tag":450,"props":2692,"children":2693},{"style":563},[2694],{"type":403,"value":466},{"type":398,"tag":450,"props":2696,"children":2697},{"style":463},[2698],{"type":403,"value":1051},{"type":398,"tag":450,"props":2700,"children":2701},{"style":548},[2702],{"type":403,"value":855},{"type":398,"tag":450,"props":2704,"children":2705},{"style":457},[2706],{"type":403,"value":1060},{"type":398,"tag":450,"props":2708,"children":2709},{"style":563},[2710],{"type":403,"value":466},{"type":398,"tag":450,"props":2712,"children":2713},{"style":463},[2714],{"type":403,"value":884},{"type":398,"tag":450,"props":2716,"children":2717},{"style":563},[2718],{"type":403,"value":898},{"type":398,"tag":450,"props":2720,"children":2721},{"style":548},[2722],{"type":403,"value":855},{"type":398,"tag":450,"props":2724,"children":2725},{"style":463},[2726],{"type":403,"value":1081},{"type":398,"tag":450,"props":2728,"children":2729},{"style":563},[2730],{"type":403,"value":1086},{"type":398,"tag":450,"props":2732,"children":2733},{"class":452,"line":559},[2734,2738,2743,2747,2752],{"type":398,"tag":450,"props":2735,"children":2736},{"style":824},[2737],{"type":403,"value":1094},{"type":398,"tag":450,"props":2739,"children":2740},{"style":824},[2741],{"type":403,"value":2742}," new",{"type":398,"tag":450,"props":2744,"children":2745},{"style":457},[2746],{"type":403,"value":1122},{"type":398,"tag":450,"props":2748,"children":2749},{"style":563},[2750],{"type":403,"value":2751},"()",{"type":398,"tag":450,"props":2753,"children":2754},{"style":548},[2755],{"type":403,"value":1781},{"type":398,"tag":450,"props":2757,"children":2758},{"class":452,"line":585},[2759],{"type":398,"tag":450,"props":2760,"children":2761},{"style":548},[2762],{"type":403,"value":1854},{"type":398,"tag":450,"props":2764,"children":2765},{"class":452,"line":604},[2766,2770,2774],{"type":398,"tag":450,"props":2767,"children":2768},{"style":548},[2769],{"type":403,"value":610},{"type":398,"tag":450,"props":2771,"children":2772},{"style":463},[2773],{"type":403,"value":1867},{"type":398,"tag":450,"props":2775,"children":2776},{"style":548},[2777],{"type":403,"value":1781},{"type":398,"tag":399,"props":2779,"children":2780},{},[2781,2787],{"type":398,"tag":414,"props":2782,"children":2784},{"className":2783},[],[2785],{"type":403,"value":2786},"new Function()",{"type":403,"value":2788}," 即模板解析的核心内容，原理是用一个数组，保存所有解析内容，再拼接回字符串，作为 JS 执行。类似 eval 函数。",{"type":398,"tag":440,"props":2790,"children":2792},{"className":442,"code":2791,"language":444,"meta":392,"style":392},"new Function(\n  \"obj\",\n  \"var p=[];\" +\n    // + '...'\n    \"return p.join('')\"\n);\n",[2793],{"type":398,"tag":414,"props":2794,"children":2795},{"__ignoreMap":392},[2796,2812,2832,2852,2860,2877],{"type":398,"tag":450,"props":2797,"children":2798},{"class":452,"line":453},[2799,2804,2808],{"type":398,"tag":450,"props":2800,"children":2801},{"style":824},[2802],{"type":403,"value":2803},"new",{"type":398,"tag":450,"props":2805,"children":2806},{"style":457},[2807],{"type":403,"value":1122},{"type":398,"tag":450,"props":2809,"children":2810},{"style":463},[2811],{"type":403,"value":1127},{"type":398,"tag":450,"props":2813,"children":2814},{"class":452,"line":475},[2815,2820,2824,2828],{"type":398,"tag":450,"props":2816,"children":2817},{"style":469},[2818],{"type":403,"value":2819},"  \"",{"type":398,"tag":450,"props":2821,"children":2822},{"style":479},[2823],{"type":403,"value":1141},{"type":398,"tag":450,"props":2825,"children":2826},{"style":469},[2827],{"type":403,"value":1146},{"type":398,"tag":450,"props":2829,"children":2830},{"style":548},[2831],{"type":403,"value":582},{"type":398,"tag":450,"props":2833,"children":2834},{"class":452,"line":485},[2835,2839,2844,2848],{"type":398,"tag":450,"props":2836,"children":2837},{"style":469},[2838],{"type":403,"value":2819},{"type":398,"tag":450,"props":2840,"children":2841},{"style":479},[2842],{"type":403,"value":2843},"var p=[];",{"type":398,"tag":450,"props":2845,"children":2846},{"style":469},[2847],{"type":403,"value":1146},{"type":398,"tag":450,"props":2849,"children":2850},{"style":824},[2851],{"type":403,"value":1172},{"type":398,"tag":450,"props":2853,"children":2854},{"class":452,"line":494},[2855],{"type":398,"tag":450,"props":2856,"children":2857},{"style":642},[2858],{"type":403,"value":2859},"    // + '...'\n",{"type":398,"tag":450,"props":2861,"children":2862},{"class":452,"line":503},[2863,2868,2873],{"type":398,"tag":450,"props":2864,"children":2865},{"style":469},[2866],{"type":403,"value":2867},"    \"",{"type":398,"tag":450,"props":2869,"children":2870},{"style":479},[2871],{"type":403,"value":2872},"return p.join('')",{"type":398,"tag":450,"props":2874,"children":2875},{"style":469},[2876],{"type":403,"value":1767},{"type":398,"tag":450,"props":2878,"children":2879},{"class":452,"line":512},[2880,2884],{"type":398,"tag":450,"props":2881,"children":2882},{"style":463},[2883],{"type":403,"value":898},{"type":398,"tag":450,"props":2885,"children":2886},{"style":548},[2887],{"type":403,"value":1781},{"type":398,"tag":399,"props":2889,"children":2890},{},[2891,2893,2899],{"type":403,"value":2892},"要解析什么内容呢？无非是 ",{"type":398,"tag":414,"props":2894,"children":2896},{"className":2895},[],[2897],{"type":403,"value":2898},"\u003C%=hello%>",{"type":403,"value":2900}," 这种模板字符串。执行过程中，通过 with 语句，将内部变量的求值（hello）转移到参数对象（data.hello）。这个玩意儿在 VueJS 的模板编译中也用到过：",{"type":398,"tag":440,"props":2902,"children":2904},{"className":442,"code":2903,"language":444,"meta":392,"style":392},"/* VueJS */\nwith (vm) {\n  return createVNode(\"p\", { attrs: { hi: hello /* vm.hello */ } }, [\n    createTextNode(\"Hello World\"),\n  ]);\n}\n",[2905],{"type":398,"tag":414,"props":2906,"children":2907},{"__ignoreMap":392},[2908,2916,2934,3019,3052,3064],{"type":398,"tag":450,"props":2909,"children":2910},{"class":452,"line":453},[2911],{"type":398,"tag":450,"props":2912,"children":2913},{"style":642},[2914],{"type":403,"value":2915},"/* VueJS */\n",{"type":398,"tag":450,"props":2917,"children":2918},{"class":452,"line":475},[2919,2924,2929],{"type":398,"tag":450,"props":2920,"children":2921},{"style":1383},[2922],{"type":403,"value":2923},"with",{"type":398,"tag":450,"props":2925,"children":2926},{"style":463},[2927],{"type":403,"value":2928}," (vm) ",{"type":398,"tag":450,"props":2930,"children":2931},{"style":548},[2932],{"type":403,"value":2933},"{\n",{"type":398,"tag":450,"props":2935,"children":2936},{"class":452,"line":485},[2937,2942,2947,2951,2955,2959,2963,2967,2972,2977,2981,2985,2990,2994,2999,3004,3009,3014],{"type":398,"tag":450,"props":2938,"children":2939},{"style":1383},[2940],{"type":403,"value":2941},"  return",{"type":398,"tag":450,"props":2943,"children":2944},{"style":457},[2945],{"type":403,"value":2946}," createVNode",{"type":398,"tag":450,"props":2948,"children":2949},{"style":563},[2950],{"type":403,"value":466},{"type":398,"tag":450,"props":2952,"children":2953},{"style":469},[2954],{"type":403,"value":1146},{"type":398,"tag":450,"props":2956,"children":2957},{"style":479},[2958],{"type":403,"value":399},{"type":398,"tag":450,"props":2960,"children":2961},{"style":469},[2962],{"type":403,"value":1146},{"type":398,"tag":450,"props":2964,"children":2965},{"style":548},[2966],{"type":403,"value":551},{"type":398,"tag":450,"props":2968,"children":2969},{"style":548},[2970],{"type":403,"value":2971}," {",{"type":398,"tag":450,"props":2973,"children":2974},{"style":563},[2975],{"type":403,"value":2976}," attrs",{"type":398,"tag":450,"props":2978,"children":2979},{"style":548},[2980],{"type":403,"value":571},{"type":398,"tag":450,"props":2982,"children":2983},{"style":548},[2984],{"type":403,"value":2971},{"type":398,"tag":450,"props":2986,"children":2987},{"style":563},[2988],{"type":403,"value":2989}," hi",{"type":398,"tag":450,"props":2991,"children":2992},{"style":548},[2993],{"type":403,"value":571},{"type":398,"tag":450,"props":2995,"children":2996},{"style":463},[2997],{"type":403,"value":2998}," hello",{"type":398,"tag":450,"props":3000,"children":3001},{"style":642},[3002],{"type":403,"value":3003}," /* vm.hello */",{"type":398,"tag":450,"props":3005,"children":3006},{"style":548},[3007],{"type":403,"value":3008}," }",{"type":398,"tag":450,"props":3010,"children":3011},{"style":548},[3012],{"type":403,"value":3013}," },",{"type":398,"tag":450,"props":3015,"children":3016},{"style":563},[3017],{"type":403,"value":3018}," [\n",{"type":398,"tag":450,"props":3020,"children":3021},{"class":452,"line":494},[3022,3027,3031,3035,3040,3044,3048],{"type":398,"tag":450,"props":3023,"children":3024},{"style":457},[3025],{"type":403,"value":3026},"    createTextNode",{"type":398,"tag":450,"props":3028,"children":3029},{"style":563},[3030],{"type":403,"value":466},{"type":398,"tag":450,"props":3032,"children":3033},{"style":469},[3034],{"type":403,"value":1146},{"type":398,"tag":450,"props":3036,"children":3037},{"style":479},[3038],{"type":403,"value":3039},"Hello World",{"type":398,"tag":450,"props":3041,"children":3042},{"style":469},[3043],{"type":403,"value":1146},{"type":398,"tag":450,"props":3045,"children":3046},{"style":563},[3047],{"type":403,"value":898},{"type":398,"tag":450,"props":3049,"children":3050},{"style":548},[3051],{"type":403,"value":582},{"type":398,"tag":450,"props":3053,"children":3054},{"class":452,"line":503},[3055,3060],{"type":398,"tag":450,"props":3056,"children":3057},{"style":563},[3058],{"type":403,"value":3059},"  ])",{"type":398,"tag":450,"props":3061,"children":3062},{"style":548},[3063],{"type":403,"value":1781},{"type":398,"tag":450,"props":3065,"children":3066},{"class":452,"line":512},[3067],{"type":398,"tag":450,"props":3068,"children":3069},{"style":548},[3070],{"type":403,"value":3071},"}\n",{"type":398,"tag":399,"props":3073,"children":3074},{},[3075],{"type":403,"value":3076},"那如何解析呢？",{"type":398,"tag":399,"props":3078,"children":3079},{},[3080,3086,3088,3094],{"type":398,"tag":3081,"props":3082,"children":3083},"del",{},[3084],{"type":403,"value":3085},"我们知道",{"type":403,"value":3087},"曾写过经典字符串模板的佬应该知道，",{"type":398,"tag":3089,"props":3090,"children":3091},"strong",{},[3092],{"type":403,"value":3093},"模板字符串一般包含：字符串、变量及逻辑",{"type":403,"value":3095},"。",{"type":398,"tag":3097,"props":3098,"children":3099},"ul",{},[3100,3112,3123],{"type":398,"tag":3101,"props":3102,"children":3103},"li",{},[3104,3106],{"type":403,"value":3105},"字符串 ",{"type":398,"tag":414,"props":3107,"children":3109},{"className":3108},[],[3110],{"type":403,"value":3111},"\u003Chtml>Lionad\u003C/html>",{"type":398,"tag":3101,"props":3113,"children":3114},{},[3115,3117],{"type":403,"value":3116},"带变量 ",{"type":398,"tag":414,"props":3118,"children":3120},{"className":3119},[],[3121],{"type":403,"value":3122},"\u003Chtml>\u003C%=name%>\u003C/html>",{"type":398,"tag":3101,"props":3124,"children":3125},{},[3126,3128,3134],{"type":403,"value":3127},"带逻辑 ",{"type":398,"tag":414,"props":3129,"children":3131},{"className":3130},[],[3132],{"type":403,"value":3133},"\u003C% if(name){ %>\u003Chtml>\u003C%=name%>\u003C/html>\u003C% } %>",{"type":403,"value":3095},{"type":398,"tag":399,"props":3136,"children":3137},{},[3138],{"type":403,"value":3139},"所以解析模板，无非就是把这三种字符串替换成纯粹的 JS 逻辑，作为 new Function 的参数。其中所有中间变量，可以用一个数组来储存：",{"type":398,"tag":3097,"props":3141,"children":3142},{},[3143,3162,3180],{"type":398,"tag":3101,"props":3144,"children":3145},{},[3146,3148,3153,3155,3161],{"type":403,"value":3147},"将普通字符串直接推入作为结果的内容数组，比如 ",{"type":398,"tag":414,"props":3149,"children":3151},{"className":3150},[],[3152],{"type":403,"value":3111},{"type":403,"value":3154}," 应该被解析为 ",{"type":398,"tag":414,"props":3156,"children":3158},{"className":3157},[],[3159],{"type":403,"value":3160},"p.push('\u003Chtml>Lionad\u003C/html>')",{"type":403,"value":3095},{"type":398,"tag":3101,"props":3163,"children":3164},{},[3165,3167,3172,3173,3179],{"type":403,"value":3166},"如果碰到变量，则将变量拆分出来推入数组，如 ",{"type":398,"tag":414,"props":3168,"children":3170},{"className":3169},[],[3171],{"type":403,"value":3122},{"type":403,"value":3154},{"type":398,"tag":414,"props":3174,"children":3176},{"className":3175},[],[3177],{"type":403,"value":3178},"p.push('\u003Chtml>');p.push(name);p.push('\u003C/html>')",{"type":403,"value":3095},{"type":398,"tag":3101,"props":3181,"children":3182},{},[3183,3185,3191,3193,3198,3200,3206],{"type":403,"value":3184},"带逻辑的字符串，由于逻辑本身就是 JS 代码，所以不需要解析为字符串，只需要把两侧的 ",{"type":398,"tag":414,"props":3186,"children":3188},{"className":3187},[],[3189],{"type":403,"value":3190},"\u003C% %>",{"type":403,"value":3192}," 这种模板标志去掉就好了。如 ",{"type":398,"tag":414,"props":3194,"children":3196},{"className":3195},[],[3197],{"type":403,"value":3133},{"type":403,"value":3199}," 应该被解析为：",{"type":398,"tag":414,"props":3201,"children":3203},{"className":3202},[],[3204],{"type":403,"value":3205},"if(name){ p.push('\u003Chtml>');p.push(name);p.push('\u003C/html>') } ",{"type":403,"value":3095},{"type":398,"tag":399,"props":3208,"children":3209},{},[3210],{"type":403,"value":3211},"以下面这段模板为例，我们看看字符串具体的替换规则。",{"type":398,"tag":440,"props":3213,"children":3215},{"className":442,"code":3214,"language":444,"meta":392,"style":392},"str = `\u003C% if (true) { %>\n    \u003Cli>\u003C%=users[i]%>\u003C/li>\n\u003C% } %>`;\n",[3216],{"type":398,"tag":414,"props":3217,"children":3218},{"__ignoreMap":392},[3219,3241,3249],{"type":398,"tag":450,"props":3220,"children":3221},{"class":452,"line":453},[3222,3227,3231,3236],{"type":398,"tag":450,"props":3223,"children":3224},{"style":463},[3225],{"type":403,"value":3226},"str ",{"type":398,"tag":450,"props":3228,"children":3229},{"style":824},[3230],{"type":403,"value":1494},{"type":398,"tag":450,"props":3232,"children":3233},{"style":469},[3234],{"type":403,"value":3235}," `",{"type":398,"tag":450,"props":3237,"children":3238},{"style":479},[3239],{"type":403,"value":3240},"\u003C% if (true) { %>\n",{"type":398,"tag":450,"props":3242,"children":3243},{"class":452,"line":475},[3244],{"type":398,"tag":450,"props":3245,"children":3246},{"style":479},[3247],{"type":403,"value":3248},"    \u003Cli>\u003C%=users[i]%>\u003C/li>\n",{"type":398,"tag":450,"props":3250,"children":3251},{"class":452,"line":485},[3252,3257,3261],{"type":398,"tag":450,"props":3253,"children":3254},{"style":479},[3255],{"type":403,"value":3256},"\u003C% } %>",{"type":398,"tag":450,"props":3258,"children":3259},{"style":469},[3260],{"type":403,"value":545},{"type":398,"tag":450,"props":3262,"children":3263},{"style":548},[3264],{"type":403,"value":1781},{"type":398,"tag":440,"props":3266,"children":3268},{"className":442,"code":3267,"language":444,"meta":392,"style":392},"// with 的使用方法都知道了，with(obj = { a })，那么\n// 就能在内部直接读取 a，不需要写 obj.a\n\"with(obj){p.push('\" +\n  str\n    // 将换行等空白字符转换为空格，这样所有代码都在一行了\n    // '\u003C% if (true) { %>     \u003Cli>\u003C%=users[i]%>\u003C/li> \u003C% } %>'\n    .replace(/[\\r\\t\\n]/g, \" \")\n    // ['', 'if (true) { %>\u003Cli>', '=users[i]%>\u003C/li>', ' } %>']\n    .split(\"\u003C%\")\n    // 因为 \\t 刚才已经被替换成空格了，所以这里可以使用 \\t 用来将不同行的代码字符串“相加”，\n    // 一会儿再拆分时，不会和原先字符串里的字符混淆\n    .join(\"\\t\")\n    // 去掉模板标志两端的引号，在这个例子里不会用到\n    .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\n    // 以下三句最重要，将所有变量推入数组，生成结果形如 `push('xxx',x,'xxx')` 的字符串\n    // 首先，刚才匹配完了 \u003C%，所以 \\t= 开头后边接的就是变量，这里让它转换成 ',x,' 的形式\n    .replace(/\\t=(.*?)%>/g, \"',$1,'\")\n    .split(\"\\t\")\n    // 在刚刚跟 split('\u003C%') 的位置用括号还原，得到了 ',x,'xxx'); 的形式\n    .join(\"');\")\n    // 在 \\t=xxx 那次匹配，已经把变量模板对应的结束标志 %> 匹配完了，\n    // 所以这是处理剩余语句的结束标志，用 split 拆分行后相当于直接把结束标记舍弃了\n    .split(\"%>\")\n    // 最终在每行开头增加 push 方法，形成了 push('xxx',x,'xxx'); 的形式\n    .join(\"p.push('\")\n    // 处理剩余的换行符\n    .split(\"\\r\")\n    .join(\"\\\\'\") +\n  \"');}\";\n",[3269],{"type":398,"tag":414,"props":3270,"children":3271},{"__ignoreMap":392},[3272,3280,3288,3307,3315,3323,3331,3387,3395,3426,3434,3442,3473,3481,3580,3588,3596,3671,3702,3710,3741,3749,3757,3788,3796,3827,3835,3866,3905],{"type":398,"tag":450,"props":3273,"children":3274},{"class":452,"line":453},[3275],{"type":398,"tag":450,"props":3276,"children":3277},{"style":642},[3278],{"type":403,"value":3279},"// with 的使用方法都知道了，with(obj = { a })，那么\n",{"type":398,"tag":450,"props":3281,"children":3282},{"class":452,"line":475},[3283],{"type":398,"tag":450,"props":3284,"children":3285},{"style":642},[3286],{"type":403,"value":3287},"// 就能在内部直接读取 a，不需要写 obj.a\n",{"type":398,"tag":450,"props":3289,"children":3290},{"class":452,"line":485},[3291,3295,3299,3303],{"type":398,"tag":450,"props":3292,"children":3293},{"style":469},[3294],{"type":403,"value":1146},{"type":398,"tag":450,"props":3296,"children":3297},{"style":479},[3298],{"type":403,"value":1195},{"type":398,"tag":450,"props":3300,"children":3301},{"style":469},[3302],{"type":403,"value":1146},{"type":398,"tag":450,"props":3304,"children":3305},{"style":824},[3306],{"type":403,"value":1172},{"type":398,"tag":450,"props":3308,"children":3309},{"class":452,"line":494},[3310],{"type":398,"tag":450,"props":3311,"children":3312},{"style":463},[3313],{"type":403,"value":3314},"  str\n",{"type":398,"tag":450,"props":3316,"children":3317},{"class":452,"line":503},[3318],{"type":398,"tag":450,"props":3319,"children":3320},{"style":642},[3321],{"type":403,"value":3322},"    // 将换行等空白字符转换为空格，这样所有代码都在一行了\n",{"type":398,"tag":450,"props":3324,"children":3325},{"class":452,"line":512},[3326],{"type":398,"tag":450,"props":3327,"children":3328},{"style":642},[3329],{"type":403,"value":3330},"    // '\u003C% if (true) { %>     \u003Cli>\u003C%=users[i]%>\u003C/li> \u003C% } %>'\n",{"type":398,"tag":450,"props":3332,"children":3333},{"class":452,"line":521},[3334,3339,3343,3347,3351,3355,3359,3363,3367,3371,3375,3379,3383],{"type":398,"tag":450,"props":3335,"children":3336},{"style":548},[3337],{"type":403,"value":3338},"    .",{"type":398,"tag":450,"props":3340,"children":3341},{"style":457},[3342],{"type":403,"value":1235},{"type":398,"tag":450,"props":3344,"children":3345},{"style":463},[3346],{"type":403,"value":466},{"type":398,"tag":450,"props":3348,"children":3349},{"style":469},[3350],{"type":403,"value":945},{"type":398,"tag":450,"props":3352,"children":3353},{"style":1246},[3354],{"type":403,"value":999},{"type":398,"tag":450,"props":3356,"children":3357},{"style":948},[3358],{"type":403,"value":1253},{"type":398,"tag":450,"props":3360,"children":3361},{"style":1246},[3362],{"type":403,"value":1258},{"type":398,"tag":450,"props":3364,"children":3365},{"style":469},[3366],{"type":403,"value":945},{"type":398,"tag":450,"props":3368,"children":3369},{"style":1265},[3370],{"type":403,"value":1268},{"type":398,"tag":450,"props":3372,"children":3373},{"style":548},[3374],{"type":403,"value":551},{"type":398,"tag":450,"props":3376,"children":3377},{"style":469},[3378],{"type":403,"value":1277},{"type":398,"tag":450,"props":3380,"children":3381},{"style":469},[3382],{"type":403,"value":1277},{"type":398,"tag":450,"props":3384,"children":3385},{"style":463},[3386],{"type":403,"value":615},{"type":398,"tag":450,"props":3388,"children":3389},{"class":452,"line":530},[3390],{"type":398,"tag":450,"props":3391,"children":3392},{"style":642},[3393],{"type":403,"value":3394},"    // ['', 'if (true) { %>\u003Cli>', '=users[i]%>\u003C/li>', ' } %>']\n",{"type":398,"tag":450,"props":3396,"children":3397},{"class":452,"line":539},[3398,3402,3406,3410,3414,3418,3422],{"type":398,"tag":450,"props":3399,"children":3400},{"style":548},[3401],{"type":403,"value":3338},{"type":398,"tag":450,"props":3403,"children":3404},{"style":457},[3405],{"type":403,"value":1298},{"type":398,"tag":450,"props":3407,"children":3408},{"style":463},[3409],{"type":403,"value":466},{"type":398,"tag":450,"props":3411,"children":3412},{"style":469},[3413],{"type":403,"value":1146},{"type":398,"tag":450,"props":3415,"children":3416},{"style":479},[3417],{"type":403,"value":1311},{"type":398,"tag":450,"props":3419,"children":3420},{"style":469},[3421],{"type":403,"value":1146},{"type":398,"tag":450,"props":3423,"children":3424},{"style":463},[3425],{"type":403,"value":615},{"type":398,"tag":450,"props":3427,"children":3428},{"class":452,"line":559},[3429],{"type":398,"tag":450,"props":3430,"children":3431},{"style":642},[3432],{"type":403,"value":3433},"    // 因为 \\t 刚才已经被替换成空格了，所以这里可以使用 \\t 用来将不同行的代码字符串“相加”，\n",{"type":398,"tag":450,"props":3435,"children":3436},{"class":452,"line":585},[3437],{"type":398,"tag":450,"props":3438,"children":3439},{"style":642},[3440],{"type":403,"value":3441},"    // 一会儿再拆分时，不会和原先字符串里的字符混淆\n",{"type":398,"tag":450,"props":3443,"children":3444},{"class":452,"line":604},[3445,3449,3453,3457,3461,3465,3469],{"type":398,"tag":450,"props":3446,"children":3447},{"style":548},[3448],{"type":403,"value":3338},{"type":398,"tag":450,"props":3450,"children":3451},{"style":457},[3452],{"type":403,"value":1332},{"type":398,"tag":450,"props":3454,"children":3455},{"style":463},[3456],{"type":403,"value":466},{"type":398,"tag":450,"props":3458,"children":3459},{"style":469},[3460],{"type":403,"value":1146},{"type":398,"tag":450,"props":3462,"children":3463},{"style":1343},[3464],{"type":403,"value":1346},{"type":398,"tag":450,"props":3466,"children":3467},{"style":469},[3468],{"type":403,"value":1146},{"type":398,"tag":450,"props":3470,"children":3471},{"style":463},[3472],{"type":403,"value":615},{"type":398,"tag":450,"props":3474,"children":3475},{"class":452,"line":1102},[3476],{"type":398,"tag":450,"props":3477,"children":3478},{"style":642},[3479],{"type":403,"value":3480},"    // 去掉模板标志两端的引号，在这个例子里不会用到\n",{"type":398,"tag":450,"props":3482,"children":3483},{"class":452,"line":1111},[3484,3488,3492,3496,3500,3504,3508,3512,3516,3520,3524,3528,3532,3536,3540,3544,3548,3552,3556,3560,3564,3568,3572,3576],{"type":398,"tag":450,"props":3485,"children":3486},{"style":548},[3487],{"type":403,"value":3338},{"type":398,"tag":450,"props":3489,"children":3490},{"style":457},[3491],{"type":403,"value":1235},{"type":398,"tag":450,"props":3493,"children":3494},{"style":463},[3495],{"type":403,"value":466},{"type":398,"tag":450,"props":3497,"children":3498},{"style":469},[3499],{"type":403,"value":945},{"type":398,"tag":450,"props":3501,"children":3502},{"style":1377},[3503],{"type":403,"value":1380},{"type":398,"tag":450,"props":3505,"children":3506},{"style":1383},[3507],{"type":403,"value":1386},{"type":398,"tag":450,"props":3509,"children":3510},{"style":824},[3511],{"type":403,"value":1391},{"type":398,"tag":450,"props":3513,"children":3514},{"style":1394},[3515],{"type":403,"value":1397},{"type":398,"tag":450,"props":3517,"children":3518},{"style":1377},[3519],{"type":403,"value":898},{"type":398,"tag":450,"props":3521,"children":3522},{"style":1246},[3523],{"type":403,"value":999},{"type":398,"tag":450,"props":3525,"children":3526},{"style":824},[3527],{"type":403,"value":1386},{"type":398,"tag":450,"props":3529,"children":3530},{"style":948},[3531],{"type":403,"value":1346},{"type":398,"tag":450,"props":3533,"children":3534},{"style":1246},[3535],{"type":403,"value":1258},{"type":398,"tag":450,"props":3537,"children":3538},{"style":824},[3539],{"type":403,"value":1422},{"type":398,"tag":450,"props":3541,"children":3542},{"style":1377},[3543],{"type":403,"value":898},{"type":398,"tag":450,"props":3545,"children":3546},{"style":1394},[3547],{"type":403,"value":1431},{"type":398,"tag":450,"props":3549,"children":3550},{"style":469},[3551],{"type":403,"value":945},{"type":398,"tag":450,"props":3553,"children":3554},{"style":1265},[3555],{"type":403,"value":1268},{"type":398,"tag":450,"props":3557,"children":3558},{"style":548},[3559],{"type":403,"value":551},{"type":398,"tag":450,"props":3561,"children":3562},{"style":469},[3563],{"type":403,"value":1277},{"type":398,"tag":450,"props":3565,"children":3566},{"style":479},[3567],{"type":403,"value":1452},{"type":398,"tag":450,"props":3569,"children":3570},{"style":1343},[3571],{"type":403,"value":1457},{"type":398,"tag":450,"props":3573,"children":3574},{"style":469},[3575],{"type":403,"value":1146},{"type":398,"tag":450,"props":3577,"children":3578},{"style":463},[3579],{"type":403,"value":615},{"type":398,"tag":450,"props":3581,"children":3582},{"class":452,"line":1130},[3583],{"type":398,"tag":450,"props":3584,"children":3585},{"style":642},[3586],{"type":403,"value":3587},"    // 以下三句最重要，将所有变量推入数组，生成结果形如 `push('xxx',x,'xxx')` 的字符串\n",{"type":398,"tag":450,"props":3589,"children":3590},{"class":452,"line":1153},[3591],{"type":398,"tag":450,"props":3592,"children":3593},{"style":642},[3594],{"type":403,"value":3595},"    // 首先，刚才匹配完了 \u003C%，所以 \\t= 开头后边接的就是变量，这里让它转换成 ',x,' 的形式\n",{"type":398,"tag":450,"props":3597,"children":3598},{"class":452,"line":1175},[3599,3603,3607,3611,3615,3619,3623,3627,3631,3635,3639,3643,3647,3651,3655,3659,3663,3667],{"type":398,"tag":450,"props":3600,"children":3601},{"style":548},[3602],{"type":403,"value":3338},{"type":398,"tag":450,"props":3604,"children":3605},{"style":457},[3606],{"type":403,"value":1235},{"type":398,"tag":450,"props":3608,"children":3609},{"style":463},[3610],{"type":403,"value":466},{"type":398,"tag":450,"props":3612,"children":3613},{"style":469},[3614],{"type":403,"value":945},{"type":398,"tag":450,"props":3616,"children":3617},{"style":948},[3618],{"type":403,"value":1346},{"type":398,"tag":450,"props":3620,"children":3621},{"style":1394},[3622],{"type":403,"value":1494},{"type":398,"tag":450,"props":3624,"children":3625},{"style":1377},[3626],{"type":403,"value":466},{"type":398,"tag":450,"props":3628,"children":3629},{"style":948},[3630],{"type":403,"value":855},{"type":398,"tag":450,"props":3632,"children":3633},{"style":824},[3634],{"type":403,"value":1507},{"type":398,"tag":450,"props":3636,"children":3637},{"style":1377},[3638],{"type":403,"value":898},{"type":398,"tag":450,"props":3640,"children":3641},{"style":1394},[3642],{"type":403,"value":1397},{"type":398,"tag":450,"props":3644,"children":3645},{"style":469},[3646],{"type":403,"value":945},{"type":398,"tag":450,"props":3648,"children":3649},{"style":1265},[3650],{"type":403,"value":1268},{"type":398,"tag":450,"props":3652,"children":3653},{"style":548},[3654],{"type":403,"value":551},{"type":398,"tag":450,"props":3656,"children":3657},{"style":469},[3658],{"type":403,"value":1277},{"type":398,"tag":450,"props":3660,"children":3661},{"style":479},[3662],{"type":403,"value":1536},{"type":398,"tag":450,"props":3664,"children":3665},{"style":469},[3666],{"type":403,"value":1146},{"type":398,"tag":450,"props":3668,"children":3669},{"style":463},[3670],{"type":403,"value":615},{"type":398,"tag":450,"props":3672,"children":3673},{"class":452,"line":1184},[3674,3678,3682,3686,3690,3694,3698],{"type":398,"tag":450,"props":3675,"children":3676},{"style":548},[3677],{"type":403,"value":3338},{"type":398,"tag":450,"props":3679,"children":3680},{"style":457},[3681],{"type":403,"value":1298},{"type":398,"tag":450,"props":3683,"children":3684},{"style":463},[3685],{"type":403,"value":466},{"type":398,"tag":450,"props":3687,"children":3688},{"style":469},[3689],{"type":403,"value":1146},{"type":398,"tag":450,"props":3691,"children":3692},{"style":1343},[3693],{"type":403,"value":1346},{"type":398,"tag":450,"props":3695,"children":3696},{"style":469},[3697],{"type":403,"value":1146},{"type":398,"tag":450,"props":3699,"children":3700},{"style":463},[3701],{"type":403,"value":615},{"type":398,"tag":450,"props":3703,"children":3704},{"class":452,"line":1206},[3705],{"type":398,"tag":450,"props":3706,"children":3707},{"style":642},[3708],{"type":403,"value":3709},"    // 在刚刚跟 split('\u003C%') 的位置用括号还原，得到了 ',x,'xxx'); 的形式\n",{"type":398,"tag":450,"props":3711,"children":3712},{"class":452,"line":1215},[3713,3717,3721,3725,3729,3733,3737],{"type":398,"tag":450,"props":3714,"children":3715},{"style":548},[3716],{"type":403,"value":3338},{"type":398,"tag":450,"props":3718,"children":3719},{"style":457},[3720],{"type":403,"value":1332},{"type":398,"tag":450,"props":3722,"children":3723},{"style":463},[3724],{"type":403,"value":466},{"type":398,"tag":450,"props":3726,"children":3727},{"style":469},[3728],{"type":403,"value":1146},{"type":398,"tag":450,"props":3730,"children":3731},{"style":479},[3732],{"type":403,"value":1601},{"type":398,"tag":450,"props":3734,"children":3735},{"style":469},[3736],{"type":403,"value":1146},{"type":398,"tag":450,"props":3738,"children":3739},{"style":463},[3740],{"type":403,"value":615},{"type":398,"tag":450,"props":3742,"children":3743},{"class":452,"line":1224},[3744],{"type":398,"tag":450,"props":3745,"children":3746},{"style":642},[3747],{"type":403,"value":3748},"    // 在 \\t=xxx 那次匹配，已经把变量模板对应的结束标志 %> 匹配完了，\n",{"type":398,"tag":450,"props":3750,"children":3751},{"class":452,"line":1288},[3752],{"type":398,"tag":450,"props":3753,"children":3754},{"style":642},[3755],{"type":403,"value":3756},"    // 所以这是处理剩余语句的结束标志，用 split 拆分行后相当于直接把结束标记舍弃了\n",{"type":398,"tag":450,"props":3758,"children":3759},{"class":452,"line":1322},[3760,3764,3768,3772,3776,3780,3784],{"type":398,"tag":450,"props":3761,"children":3762},{"style":548},[3763],{"type":403,"value":3338},{"type":398,"tag":450,"props":3765,"children":3766},{"style":457},[3767],{"type":403,"value":1298},{"type":398,"tag":450,"props":3769,"children":3770},{"style":463},[3771],{"type":403,"value":466},{"type":398,"tag":450,"props":3773,"children":3774},{"style":469},[3775],{"type":403,"value":1146},{"type":398,"tag":450,"props":3777,"children":3778},{"style":479},[3779],{"type":403,"value":1397},{"type":398,"tag":450,"props":3781,"children":3782},{"style":469},[3783],{"type":403,"value":1146},{"type":398,"tag":450,"props":3785,"children":3786},{"style":463},[3787],{"type":403,"value":615},{"type":398,"tag":450,"props":3789,"children":3790},{"class":452,"line":1357},[3791],{"type":398,"tag":450,"props":3792,"children":3793},{"style":642},[3794],{"type":403,"value":3795},"    // 最终在每行开头增加 push 方法，形成了 push('xxx',x,'xxx'); 的形式\n",{"type":398,"tag":450,"props":3797,"children":3798},{"class":452,"line":1468},[3799,3803,3807,3811,3815,3819,3823],{"type":398,"tag":450,"props":3800,"children":3801},{"style":548},[3802],{"type":403,"value":3338},{"type":398,"tag":450,"props":3804,"children":3805},{"style":457},[3806],{"type":403,"value":1332},{"type":398,"tag":450,"props":3808,"children":3809},{"style":463},[3810],{"type":403,"value":466},{"type":398,"tag":450,"props":3812,"children":3813},{"style":469},[3814],{"type":403,"value":1146},{"type":398,"tag":450,"props":3816,"children":3817},{"style":479},[3818],{"type":403,"value":1666},{"type":398,"tag":450,"props":3820,"children":3821},{"style":469},[3822],{"type":403,"value":1146},{"type":398,"tag":450,"props":3824,"children":3825},{"style":463},[3826],{"type":403,"value":615},{"type":398,"tag":450,"props":3828,"children":3829},{"class":452,"line":1547},[3830],{"type":398,"tag":450,"props":3831,"children":3832},{"style":642},[3833],{"type":403,"value":3834},"    // 处理剩余的换行符\n",{"type":398,"tag":450,"props":3836,"children":3837},{"class":452,"line":1579},[3838,3842,3846,3850,3854,3858,3862],{"type":398,"tag":450,"props":3839,"children":3840},{"style":548},[3841],{"type":403,"value":3338},{"type":398,"tag":450,"props":3843,"children":3844},{"style":457},[3845],{"type":403,"value":1298},{"type":398,"tag":450,"props":3847,"children":3848},{"style":463},[3849],{"type":403,"value":466},{"type":398,"tag":450,"props":3851,"children":3852},{"style":469},[3853],{"type":403,"value":1146},{"type":398,"tag":450,"props":3855,"children":3856},{"style":1343},[3857],{"type":403,"value":1457},{"type":398,"tag":450,"props":3859,"children":3860},{"style":469},[3861],{"type":403,"value":1146},{"type":398,"tag":450,"props":3863,"children":3864},{"style":463},[3865],{"type":403,"value":615},{"type":398,"tag":450,"props":3867,"children":3868},{"class":452,"line":1612},[3869,3873,3877,3881,3885,3889,3893,3897,3901],{"type":398,"tag":450,"props":3870,"children":3871},{"style":548},[3872],{"type":403,"value":3338},{"type":398,"tag":450,"props":3874,"children":3875},{"style":457},[3876],{"type":403,"value":1332},{"type":398,"tag":450,"props":3878,"children":3879},{"style":463},[3880],{"type":403,"value":466},{"type":398,"tag":450,"props":3882,"children":3883},{"style":469},[3884],{"type":403,"value":1146},{"type":398,"tag":450,"props":3886,"children":3887},{"style":1343},[3888],{"type":403,"value":1731},{"type":398,"tag":450,"props":3890,"children":3891},{"style":479},[3892],{"type":403,"value":1431},{"type":398,"tag":450,"props":3894,"children":3895},{"style":469},[3896],{"type":403,"value":1146},{"type":398,"tag":450,"props":3898,"children":3899},{"style":463},[3900],{"type":403,"value":1744},{"type":398,"tag":450,"props":3902,"children":3903},{"style":824},[3904],{"type":403,"value":1749},{"type":398,"tag":450,"props":3906,"children":3907},{"class":452,"line":1644},[3908,3912,3917,3921],{"type":398,"tag":450,"props":3909,"children":3910},{"style":469},[3911],{"type":403,"value":2819},{"type":398,"tag":450,"props":3913,"children":3914},{"style":479},[3915],{"type":403,"value":3916},"');}",{"type":398,"tag":450,"props":3918,"children":3919},{"style":469},[3920],{"type":403,"value":1146},{"type":398,"tag":450,"props":3922,"children":3923},{"style":548},[3924],{"type":403,"value":1781},{"type":398,"tag":399,"props":3926,"children":3927},{},[3928,3930,3935,3937,3942,3944,3949,3950,3956,3958,3963,3965,3970],{"type":403,"value":3929},"有一个小细节，字符串替换时，所有逻辑语句的模板标志开头和结尾（",{"type":398,"tag":414,"props":3931,"children":3933},{"className":3932},[],[3934],{"type":403,"value":1311},{"type":403,"value":3936},"、",{"type":398,"tag":414,"props":3938,"children":3940},{"className":3939},[],[3941],{"type":403,"value":1397},{"type":403,"value":3943},"）分别被替换为 ",{"type":398,"tag":414,"props":3945,"children":3947},{"className":3946},[],[3948],{"type":403,"value":1601},{"type":403,"value":3936},{"type":398,"tag":414,"props":3951,"children":3953},{"className":3952},[],[3954],{"type":403,"value":3955},"push('",{"type":403,"value":3957},"，但是开头和结尾的那个标志，并没有对应的匹配。所以在代码中，能看 ",{"type":398,"tag":414,"props":3959,"children":3961},{"className":3960},[],[3962],{"type":403,"value":1195},{"type":403,"value":3964}," 和 ",{"type":398,"tag":414,"props":3966,"children":3968},{"className":3967},[],[3969],{"type":403,"value":1601},{"type":403,"value":3971}," 这种手动补全。",{"type":398,"tag":399,"props":3973,"children":3974},{},[3975],{"type":403,"value":3976},"最终生成的字符串如下（已格式化处理）：",{"type":398,"tag":440,"props":3978,"children":3980},{"className":442,"code":3979,"language":444,"meta":392,"style":392},"`with(obj){\n    p.push(''); \n    if (true) { \n        p.push('     \u003Cli>',users[i],'\u003C/li>   '); \n    } \n    p.push('');\n}`;\n",[3981],{"type":398,"tag":414,"props":3982,"children":3983},{"__ignoreMap":392},[3984,3996,4004,4012,4020,4028,4036],{"type":398,"tag":450,"props":3985,"children":3986},{"class":452,"line":453},[3987,3991],{"type":398,"tag":450,"props":3988,"children":3989},{"style":469},[3990],{"type":403,"value":545},{"type":398,"tag":450,"props":3992,"children":3993},{"style":479},[3994],{"type":403,"value":3995},"with(obj){\n",{"type":398,"tag":450,"props":3997,"children":3998},{"class":452,"line":475},[3999],{"type":398,"tag":450,"props":4000,"children":4001},{"style":479},[4002],{"type":403,"value":4003},"    p.push(''); \n",{"type":398,"tag":450,"props":4005,"children":4006},{"class":452,"line":485},[4007],{"type":398,"tag":450,"props":4008,"children":4009},{"style":479},[4010],{"type":403,"value":4011},"    if (true) { \n",{"type":398,"tag":450,"props":4013,"children":4014},{"class":452,"line":494},[4015],{"type":398,"tag":450,"props":4016,"children":4017},{"style":479},[4018],{"type":403,"value":4019},"        p.push('     \u003Cli>',users[i],'\u003C/li>   '); \n",{"type":398,"tag":450,"props":4021,"children":4022},{"class":452,"line":503},[4023],{"type":398,"tag":450,"props":4024,"children":4025},{"style":479},[4026],{"type":403,"value":4027},"    } \n",{"type":398,"tag":450,"props":4029,"children":4030},{"class":452,"line":512},[4031],{"type":398,"tag":450,"props":4032,"children":4033},{"style":479},[4034],{"type":403,"value":4035},"    p.push('');\n",{"type":398,"tag":450,"props":4037,"children":4038},{"class":452,"line":521},[4039,4043,4047],{"type":398,"tag":450,"props":4040,"children":4041},{"style":479},[4042],{"type":403,"value":610},{"type":398,"tag":450,"props":4044,"children":4045},{"style":469},[4046],{"type":403,"value":545},{"type":398,"tag":450,"props":4048,"children":4049},{"style":548},[4050],{"type":403,"value":1781},{"type":398,"tag":399,"props":4052,"children":4053},{},[4054,4056,4062],{"type":403,"value":4055},"为什么 with 语句里有一行空的 ",{"type":398,"tag":414,"props":4057,"children":4059},{"className":4058},[],[4060],{"type":403,"value":4061},"push('')",{"type":403,"value":4063}," 呢？",{"type":398,"tag":399,"props":4065,"children":4066},{},[4067],{"type":403,"value":4068},"还记得原始的模板吗？一开的模板是以“\u003C%”开头的，而“\u003C%”在替换过程被右括号取代了，此时正好和初始字符串结合形成了空 push。如果原始字符串开头是 \"123\u003C% if (true)\"，那这行空 push 会转换成“p.push('123');”，也是正确的代码。",{"type":398,"tag":399,"props":4070,"children":4071},{},[4072],{"type":403,"value":4073},"最后，micro-templating 需要返回这个新函数。如果不传参数 data 给模板函数，则会返回一个部分应用的函数等待用户输入 data 参数再执行模板解析；如果已经传了 data 那就会立即调用返回模板解析的结果。",{"type":398,"tag":440,"props":4075,"children":4077},{"className":442,"code":4076,"language":444,"meta":392,"style":392},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {\n    return data ? fn(data) : fn;\n  };\n})();\n",[4078],{"type":398,"tag":414,"props":4079,"children":4080},{"__ignoreMap":392},[4081,4100,4119,4170,4213,4220],{"type":398,"tag":450,"props":4082,"children":4083},{"class":452,"line":453},[4084,4088,4092,4096],{"type":398,"tag":450,"props":4085,"children":4086},{"style":463},[4087],{"type":403,"value":466},{"type":398,"tag":450,"props":4089,"children":4090},{"style":796},[4091],{"type":403,"value":799},{"type":398,"tag":450,"props":4093,"children":4094},{"style":548},[4095],{"type":403,"value":804},{"type":398,"tag":450,"props":4097,"children":4098},{"style":548},[4099],{"type":403,"value":556},{"type":398,"tag":450,"props":4101,"children":4102},{"class":452,"line":475},[4103,4107,4111,4115],{"type":398,"tag":450,"props":4104,"children":4105},{"style":796},[4106],{"type":403,"value":816},{"type":398,"tag":450,"props":4108,"children":4109},{"style":463},[4110],{"type":403,"value":821},{"type":398,"tag":450,"props":4112,"children":4113},{"style":824},[4114],{"type":403,"value":827},{"type":398,"tag":450,"props":4116,"children":4117},{"style":548},[4118],{"type":403,"value":832},{"type":398,"tag":450,"props":4120,"children":4121},{"class":452,"line":485},[4122,4126,4130,4134,4138,4142,4146,4150,4154,4158,4162,4166],{"type":398,"tag":450,"props":4123,"children":4124},{"style":847},[4125],{"type":403,"value":850},{"type":398,"tag":450,"props":4127,"children":4128},{"style":548},[4129],{"type":403,"value":855},{"type":398,"tag":450,"props":4131,"children":4132},{"style":457},[4133],{"type":403,"value":860},{"type":398,"tag":450,"props":4135,"children":4136},{"style":824},[4137],{"type":403,"value":827},{"type":398,"tag":450,"props":4139,"children":4140},{"style":796},[4141],{"type":403,"value":869},{"type":398,"tag":450,"props":4143,"children":4144},{"style":457},[4145],{"type":403,"value":874},{"type":398,"tag":450,"props":4147,"children":4148},{"style":548},[4149],{"type":403,"value":466},{"type":398,"tag":450,"props":4151,"children":4152},{"style":881},[4153],{"type":403,"value":884},{"type":398,"tag":450,"props":4155,"children":4156},{"style":548},[4157],{"type":403,"value":551},{"type":398,"tag":450,"props":4159,"children":4160},{"style":881},[4161],{"type":403,"value":893},{"type":398,"tag":450,"props":4163,"children":4164},{"style":548},[4165],{"type":403,"value":898},{"type":398,"tag":450,"props":4167,"children":4168},{"style":548},[4169],{"type":403,"value":556},{"type":398,"tag":450,"props":4171,"children":4172},{"class":452,"line":494},[4173,4177,4181,4185,4189,4193,4197,4201,4205,4209],{"type":398,"tag":450,"props":4174,"children":4175},{"style":1383},[4176],{"type":403,"value":1807},{"type":398,"tag":450,"props":4178,"children":4179},{"style":463},[4180],{"type":403,"value":893},{"type":398,"tag":450,"props":4182,"children":4183},{"style":824},[4184],{"type":403,"value":1816},{"type":398,"tag":450,"props":4186,"children":4187},{"style":457},[4188],{"type":403,"value":931},{"type":398,"tag":450,"props":4190,"children":4191},{"style":563},[4192],{"type":403,"value":466},{"type":398,"tag":450,"props":4194,"children":4195},{"style":463},[4196],{"type":403,"value":1829},{"type":398,"tag":450,"props":4198,"children":4199},{"style":563},[4200],{"type":403,"value":1744},{"type":398,"tag":450,"props":4202,"children":4203},{"style":824},[4204],{"type":403,"value":571},{"type":398,"tag":450,"props":4206,"children":4207},{"style":463},[4208],{"type":403,"value":931},{"type":398,"tag":450,"props":4210,"children":4211},{"style":548},[4212],{"type":403,"value":1781},{"type":398,"tag":450,"props":4214,"children":4215},{"class":452,"line":503},[4216],{"type":398,"tag":450,"props":4217,"children":4218},{"style":548},[4219],{"type":403,"value":1854},{"type":398,"tag":450,"props":4221,"children":4222},{"class":452,"line":512},[4223,4227,4231],{"type":398,"tag":450,"props":4224,"children":4225},{"style":548},[4226],{"type":403,"value":610},{"type":398,"tag":450,"props":4228,"children":4229},{"style":463},[4230],{"type":403,"value":1867},{"type":398,"tag":450,"props":4232,"children":4233},{"style":548},[4234],{"type":403,"value":1781},{"type":398,"tag":399,"props":4236,"children":4237},{},[4238],{"type":403,"value":4239},"终于结束了！这个函数不长，但一口气看下来还是蛮费力气的。如果一遍写测试用例以便看代码，很快能把这个函数跑通，如果你是纯靠脑力跑，还没被那个长长的字符串替换链给吓住，在此我赐你称号：“人肉编译器 - 2024 限定版”。",{"type":398,"tag":399,"props":4241,"children":4242},{},[4243,4245,4252,4254,4259],{"type":403,"value":4244},"额外提一句，Function 构造器和 eval 函数比，除了能传参数意外，还有一些细节不同，比如说声明变量的作用域不同，这个需要注意。这个编译器没有错误处理等代码完善，因此不可以上生产。此外，由于 ",{"type":398,"tag":406,"props":4246,"children":4250},{"href":4247,"rel":4248},"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/with",[4249],"nofollow",[4251],{"type":403,"value":2923},{"type":403,"value":4253}," 语句非常容易出错，且不利于静态优化，不应该在业务函数里使用",{"type":398,"tag":450,"props":4255,"children":4256},{},[4257],{"type":403,"value":4258},"^with-mdn",{"type":403,"value":4260},"。最后，阅读源码需要技巧，这几点希望能帮助到你：",{"type":398,"tag":3097,"props":4262,"children":4263},{},[4264,4269,4274,4279],{"type":398,"tag":3101,"props":4265,"children":4266},{},[4267],{"type":403,"value":4268},"从注释、测试用例，先搞清楚要看的代码的作用",{"type":398,"tag":3101,"props":4270,"children":4271},{},[4272],{"type":403,"value":4273},"使用编辑器的折叠代码，一次只看一部分源码",{"type":398,"tag":3101,"props":4275,"children":4276},{},[4277],{"type":403,"value":4278},"在 Git 提交记录中搜索，从简单的版本看起",{"type":398,"tag":3101,"props":4280,"children":4281},{},[4282],{"type":403,"value":4283},"复杂代码应该从高层结构看起，比如使用 IDE 各种插件或是 Madge 等代码分析工具",{"type":398,"tag":754,"props":4285,"children":4287},{"id":4286},"相关链接",[4288],{"type":403,"value":4286},{"type":398,"tag":3097,"props":4290,"children":4291},{},[4292],{"type":398,"tag":3101,"props":4293,"children":4294},{},[4295],{"type":398,"tag":406,"props":4296,"children":4299},{"href":4297,"rel":4298},"https://johnresig.com/blog/javascript-micro-templating/",[4249],[4300],{"type":403,"value":4301},"JavaScript Micro-Templating",{"type":398,"tag":4303,"props":4304,"children":4305},"style",{},[4306],{"type":403,"value":4307},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":392,"searchDepth":475,"depth":475,"links":4309},[4310,4311,4312],{"id":756,"depth":475,"text":756},{"id":1879,"depth":475,"text":1879},{"id":4286,"depth":475,"text":4286},"markdown","content:2.articles:1100.micro-templating.md","content","2.articles/1100.micro-templating.md","md",[4319,4321],{"_path":40,"title":39,"description":4320},"沉浸式翻译太贵辽，试试本地部署 LLM 用来翻译网页的可行性。",{"_path":46,"title":45,"description":4322},"我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。我碰到的问题是，如果 CSS 源码中带嵌套语法那么解析就会失败。今天借这个问题给大家简单介绍一下 CSS Parser 的基本流程。",1711806174634]