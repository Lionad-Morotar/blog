[{"data":1,"prerenderedAt":4320},["Reactive",2],{"navigation":3,"/articles/micro-templating":386,"/articles/micro-templating-surround":4315},[4,32,80,96,123,129,135,369,375,381],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":42,"_path":43},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":45,"_path":46},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":48,"_path":49},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":51,"_path":52},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":54,"_path":55},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":57,"_path":58},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":60,"_path":61},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":63,"_path":64},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":66,"_path":67},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":69,"_path":70},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":72,"_path":73},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":75,"_path":76},"🚝 四十二篇系列","/articles/fourty-two",{"title":78,"_path":79},"📝 技术博客归档","/articles/fold",{"title":81,"_path":82,"children":83},"造物 / Make","/tools",[84,87,90,93],{"title":85,"_path":86},"🌐 AnySort","/tools/anysort",{"title":88,"_path":89},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":91,"_path":92},"👓 Crapto","/tools/crypto-inline",{"title":94,"_path":95},"🖨️ any-to-base64","/tools/any-to-base64",{"title":97,"_path":98,"children":99},"吉他剧场 / Music","/music",[100,102,105,108,111,114,117,120],{"title":101,"_path":98},"🎸 FingerStyle！",{"title":103,"_path":104},"🌬️ 等待的风","/music/wind",{"title":106,"_path":107},"💕 约定的海洋","/music/ocean",{"title":109,"_path":110},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":112,"_path":113},"🌏 残酷天使的行动纲领","/music/eva",{"title":115,"_path":116},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":118,"_path":119},"🍷 Wu Wei","/music/wu-wei",{"title":121,"_path":122},"🌅 无题","/music/untitled",{"title":124,"_path":125,"children":126},"画点什么 / Paint","/paint",[127],{"title":128,"_path":125},"🚧 正在施工",{"title":130,"_path":131,"children":132},"知识地图 / Maps","/maps",[133],{"title":134,"_path":131},"🏁 知识地图",{"title":136,"_path":137,"children":138},"零散的笔记 / Gists","/gists",[139,141,144,147,150,153,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366],{"title":140,"_path":137},"🧊 Gists",{"title":142,"_path":143},"网站的可访问性","/gists/accessibility",{"title":145,"_path":146},"Bit","/gists/bit",{"title":148,"_path":149},"图片模糊","/gists/blur",{"title":151,"_path":152},"渲染相关笔记","/gists/c4d",{"title":154,"_path":155},"CDN 问题记录","/gists/cdn",{"title":157,"_path":158},"消毒剂","/gists/cleaner",{"title":160,"_path":161},"Windows Command","/gists/cmd",{"title":163,"_path":164},"Command","/gists/command",{"title":166,"_path":167},"复杂科学","/gists/complexity-science",{"title":169,"_path":170},"宇宙","/gists/cosmos",{"title":172,"_path":173},"C++","/gists/cpp",{"title":175,"_path":176},"Data Structure","/gists/data-structure",{"title":178,"_path":179},"DEPRESSION","/gists/depression",{"title":181,"_path":182},"设计模式","/gists/design-patterns",{"title":184,"_path":185},"Developer Experience","/gists/developer-experience",{"title":187,"_path":188},"Device Metrics","/gists/device-metrix",{"title":190,"_path":191},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":193,"_path":194},"正则表达式","/gists/eegex",{"title":196,"_path":197},"Emoji","/gists/emoji",{"title":199,"_path":200},"工程","/gists/engineering",{"title":202,"_path":203},"熵","/gists/entropy",{"title":205,"_path":206},"Environment","/gists/environment",{"title":208,"_path":209},"Erlang","/gists/erlang",{"title":211,"_path":212},"逃离塔克夫","/gists/escape-from-tarkov",{"title":214,"_path":215},"ESNext (ES6-ES11)","/gists/esnext",{"title":217,"_path":218},"Eval！","/gists/eval",{"title":220,"_path":221},"Flutter","/gists/flutter",{"title":223,"_path":224},"字体","/gists/font",{"title":226,"_path":227},"JS 函数式编程","/gists/functional",{"title":229,"_path":230},"Google C++ Standard","/gists/google-cpp-standard",{"title":232,"_path":233},"双向链接完全体","/gists/graph",{"title":235,"_path":236},"Hardwares","/gists/hardwares",{"title":238,"_path":239},"哈希冲突","/gists/hash-collision",{"title":241,"_path":242},"信息设计","/gists/information-design",{"title":244,"_path":245},"InstantPage","/gists/instant.page",{"title":247,"_path":248},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":250,"_path":251},"KVStore","/gists/key-value-db",{"title":253,"_path":254},"Kubernetes","/gists/kubernetes",{"title":256,"_path":257},"Makefile","/gists/makefile",{"title":259,"_path":260},"Markdown Inline Style","/gists/markdown-nice",{"title":262,"_path":263},"小程序","/gists/miniapp",{"title":265,"_path":266},"减小页面快照体积","/gists/minify-html",{"title":268,"_path":269},"mklink","/gists/mklink",{"title":271,"_path":272},"Mock","/gists/mock",{"title":274,"_path":275},"多端应用","/gists/multy-end-app",{"title":277,"_path":278},"神经科学","/gists/neuroscience",{"title":280,"_path":281},"OO","/gists/oo",{"title":283,"_path":284},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":286,"_path":287},"人物","/gists/person",{"title":289,"_path":290},"PInvoke","/gists/pinvoke",{"title":292,"_path":293},"像素","/gists/pixel",{"title":295,"_path":296},"PowerShell","/gists/powershell",{"title":298,"_path":299},"量子","/gists/quantum",{"title":301,"_path":302},"保持好奇心","/gists/questions",{"title":304,"_path":305},"React Native","/gists/react-native",{"title":307,"_path":308},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":310,"_path":311},"SEO","/gists/seo",{"title":313,"_path":314},"Shader","/gists/shader",{"title":316,"_path":317},"Shape Up","/gists/shape-up",{"title":319,"_path":320},"睡觉","/gists/sleep",{"title":322,"_path":323},"States","/gists/states",{"title":325,"_path":326},"Storage","/gists/storage",{"title":328,"_path":329},"音视频流处理","/gists/stream-cli",{"title":331,"_path":332},"Symbol","/gists/symbol",{"title":334,"_path":335},"系统论","/gists/systems-theory",{"title":337,"_path":338},"Taro","/gists/taro",{"title":340,"_path":341},"任务切片","/gists/task-slice",{"title":343,"_path":344},"技术偏好","/gists/tech-dudge",{"title":346,"_path":347},"Untitled","/gists/untitled",{"title":349,"_path":350},"可变字体","/gists/variable-font",{"title":352,"_path":353},"视觉错觉","/gists/visual-illusion",{"title":355,"_path":356},"SS(SSR)","/gists/vpn",{"title":358,"_path":359},"VS Code 插件开发","/gists/vscode-plugin",{"title":361,"_path":362},"Web Components","/gists/web-components",{"title":364,"_path":365},"Windows","/gists/windows",{"title":367,"_path":368},"查缺补漏","/gists/wrong",{"title":370,"_path":371,"children":372},"代码笔记 / Gists","/source-code",[373],{"title":374,"_path":371},"🚄 代码笔记",{"title":376,"_path":377,"children":378},"我 / Abount","/hire",[379],{"title":380,"_path":377},"📬 技术简历",{"title":382,"_path":383,"children":384},"todo","/todo",[385],{"title":382,"_path":383},{"_path":40,"_dir":387,"_draft":388,"_partial":388,"_locale":389,"title":39,"description":390,"body":391,"_type":4310,"_id":4311,"_source":4312,"_file":4313,"_extension":4314},"articles",false,"","忍者秘籍中提到的模板解析器，很短但支持变量和 if 等语句，还是 15 年前的代码！",{"type":392,"children":393,"toc":4305},"root",[394,419,431,436,613,625,745,750,756,761,1869,1874,1879,1884,1995,2008,2469,2775,2786,2885,2898,3069,3074,3093,3132,3137,3204,3209,3262,3922,3969,3974,4048,4061,4066,4071,4232,4237,4258,4281,4286,4299],{"type":395,"tag":396,"props":397,"children":398},"element","p",{},[399,402,408,410,417],{"type":400,"value":401},"text","上回我借着解决 CSS 嵌套解析问题聊到 micro-app 中实现的一个非常精简的 ",{"type":395,"tag":403,"props":404,"children":405},"a",{"href":43},[406],{"type":400,"value":407},"CSS 解析器",{"type":400,"value":409},"，还没过瘾。今天整理笔记的时候发现了角落里的这个模板解析器，那就赶紧擦擦灰尘拉出来聊一聊。这个模板解析器可是有年头了，它是 John Resig 佬 2008 年写的，叫 ",{"type":395,"tag":411,"props":412,"children":414},"code",{"className":413},[],[415],{"type":400,"value":416},"micro-templating",{"type":400,"value":418},"，距今十五年哩。（John Resig 就是写《JavaScript 忍者秘籍》那位）",{"type":395,"tag":396,"props":420,"children":421},{},[422,424,429],{"type":400,"value":423},"令人惊叹的地方是，",{"type":395,"tag":411,"props":425,"children":427},{"className":426},[],[428],{"type":400,"value":416},{"type":400,"value":430}," 的代码和它的名字一样 micro，它能用仅仅 30 行代码完成对模板的处理，并且还有读取 html 模板、缓存、柯里化等额外的高级功能！",{"type":395,"tag":396,"props":432,"children":433},{},[434],{"type":400,"value":435},"可能有些佬没接触过模板解析器，这里给出一个简单的示例。",{"type":395,"tag":437,"props":438,"children":442},"pre",{"className":439,"code":440,"language":441,"meta":389,"style":389},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","parse(`\n  \u003C% if (shouldCount) { %>\n    \u003C% for (var i = 1; i \u003C= 3; i++) { %>\n      \u003Cdiv>hello - \u003C%= i + count %>\u003C/div>\n    \u003C% } %>\n  \u003C% } else { %>\n    \u003Cdiv>noop\u003C/div>\n  \u003C% } %>\n`, {\n  shouldCount: true,\n  count: 1\n})\n","js",[443],{"type":395,"tag":411,"props":444,"children":445},{"__ignoreMap":389},[446,470,480,489,498,507,516,525,534,554,580,599],{"type":395,"tag":447,"props":448,"children":451},"span",{"class":449,"line":450},"line",1,[452,458,464],{"type":395,"tag":447,"props":453,"children":455},{"style":454},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[456],{"type":400,"value":457},"parse",{"type":395,"tag":447,"props":459,"children":461},{"style":460},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[462],{"type":400,"value":463},"(",{"type":395,"tag":447,"props":465,"children":467},{"style":466},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[468],{"type":400,"value":469},"`\n",{"type":395,"tag":447,"props":471,"children":473},{"class":449,"line":472},2,[474],{"type":395,"tag":447,"props":475,"children":477},{"style":476},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[478],{"type":400,"value":479},"  \u003C% if (shouldCount) { %>\n",{"type":395,"tag":447,"props":481,"children":483},{"class":449,"line":482},3,[484],{"type":395,"tag":447,"props":485,"children":486},{"style":476},[487],{"type":400,"value":488},"    \u003C% for (var i = 1; i \u003C= 3; i++) { %>\n",{"type":395,"tag":447,"props":490,"children":492},{"class":449,"line":491},4,[493],{"type":395,"tag":447,"props":494,"children":495},{"style":476},[496],{"type":400,"value":497},"      \u003Cdiv>hello - \u003C%= i + count %>\u003C/div>\n",{"type":395,"tag":447,"props":499,"children":501},{"class":449,"line":500},5,[502],{"type":395,"tag":447,"props":503,"children":504},{"style":476},[505],{"type":400,"value":506},"    \u003C% } %>\n",{"type":395,"tag":447,"props":508,"children":510},{"class":449,"line":509},6,[511],{"type":395,"tag":447,"props":512,"children":513},{"style":476},[514],{"type":400,"value":515},"  \u003C% } else { %>\n",{"type":395,"tag":447,"props":517,"children":519},{"class":449,"line":518},7,[520],{"type":395,"tag":447,"props":521,"children":522},{"style":476},[523],{"type":400,"value":524},"    \u003Cdiv>noop\u003C/div>\n",{"type":395,"tag":447,"props":526,"children":528},{"class":449,"line":527},8,[529],{"type":395,"tag":447,"props":530,"children":531},{"style":476},[532],{"type":400,"value":533},"  \u003C% } %>\n",{"type":395,"tag":447,"props":535,"children":537},{"class":449,"line":536},9,[538,543,549],{"type":395,"tag":447,"props":539,"children":540},{"style":466},[541],{"type":400,"value":542},"`",{"type":395,"tag":447,"props":544,"children":546},{"style":545},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[547],{"type":400,"value":548},",",{"type":395,"tag":447,"props":550,"children":551},{"style":545},[552],{"type":400,"value":553}," {\n",{"type":395,"tag":447,"props":555,"children":557},{"class":449,"line":556},10,[558,564,569,575],{"type":395,"tag":447,"props":559,"children":561},{"style":560},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[562],{"type":400,"value":563},"  shouldCount",{"type":395,"tag":447,"props":565,"children":566},{"style":545},[567],{"type":400,"value":568},":",{"type":395,"tag":447,"props":570,"children":572},{"style":571},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[573],{"type":400,"value":574}," true",{"type":395,"tag":447,"props":576,"children":577},{"style":545},[578],{"type":400,"value":579},",\n",{"type":395,"tag":447,"props":581,"children":583},{"class":449,"line":582},11,[584,589,593],{"type":395,"tag":447,"props":585,"children":586},{"style":560},[587],{"type":400,"value":588},"  count",{"type":395,"tag":447,"props":590,"children":591},{"style":545},[592],{"type":400,"value":568},{"type":395,"tag":447,"props":594,"children":596},{"style":595},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[597],{"type":400,"value":598}," 1\n",{"type":395,"tag":447,"props":600,"children":602},{"class":449,"line":601},12,[603,608],{"type":395,"tag":447,"props":604,"children":605},{"style":545},[606],{"type":400,"value":607},"}",{"type":395,"tag":447,"props":609,"children":610},{"style":460},[611],{"type":400,"value":612},")\n",{"type":395,"tag":396,"props":614,"children":615},{},[616,618,623],{"type":400,"value":617},"给 ",{"type":395,"tag":411,"props":619,"children":621},{"className":620},[],[622],{"type":400,"value":457},{"type":400,"value":624}," 函数传入模板字符串和数据后，自然也是输出字符串啦：",{"type":395,"tag":437,"props":626,"children":630},{"className":627,"code":628,"language":629,"meta":389,"style":389},"language-html shiki shiki-themes material-theme-lighter github-light github-dark monokai","\u003C!-- 以下经过格式化 -->\n\u003Cdiv>hello - 2\u003C/div>\n\u003Cdiv>hello - 3\u003C/div>\n\u003Cdiv>hello - 4\u003C/div>\n","html",[631],{"type":395,"tag":411,"props":632,"children":633},{"__ignoreMap":389},[634,643,681,713],{"type":395,"tag":447,"props":635,"children":636},{"class":449,"line":450},[637],{"type":395,"tag":447,"props":638,"children":640},{"style":639},"--shiki-light:#90A4AE;--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[641],{"type":400,"value":642},"\u003C!-- 以下经过格式化 -->\n",{"type":395,"tag":447,"props":644,"children":645},{"class":449,"line":472},[646,651,657,662,667,672,676],{"type":395,"tag":447,"props":647,"children":648},{"style":545},[649],{"type":400,"value":650},"\u003C",{"type":395,"tag":447,"props":652,"children":654},{"style":653},"--shiki-light:#E53935;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[655],{"type":400,"value":656},"div",{"type":395,"tag":447,"props":658,"children":659},{"style":545},[660],{"type":400,"value":661},">",{"type":395,"tag":447,"props":663,"children":664},{"style":460},[665],{"type":400,"value":666},"hello - 2",{"type":395,"tag":447,"props":668,"children":669},{"style":545},[670],{"type":400,"value":671},"\u003C/",{"type":395,"tag":447,"props":673,"children":674},{"style":653},[675],{"type":400,"value":656},{"type":395,"tag":447,"props":677,"children":678},{"style":545},[679],{"type":400,"value":680},">\n",{"type":395,"tag":447,"props":682,"children":683},{"class":449,"line":482},[684,688,692,696,701,705,709],{"type":395,"tag":447,"props":685,"children":686},{"style":545},[687],{"type":400,"value":650},{"type":395,"tag":447,"props":689,"children":690},{"style":653},[691],{"type":400,"value":656},{"type":395,"tag":447,"props":693,"children":694},{"style":545},[695],{"type":400,"value":661},{"type":395,"tag":447,"props":697,"children":698},{"style":460},[699],{"type":400,"value":700},"hello - 3",{"type":395,"tag":447,"props":702,"children":703},{"style":545},[704],{"type":400,"value":671},{"type":395,"tag":447,"props":706,"children":707},{"style":653},[708],{"type":400,"value":656},{"type":395,"tag":447,"props":710,"children":711},{"style":545},[712],{"type":400,"value":680},{"type":395,"tag":447,"props":714,"children":715},{"class":449,"line":491},[716,720,724,728,733,737,741],{"type":395,"tag":447,"props":717,"children":718},{"style":545},[719],{"type":400,"value":650},{"type":395,"tag":447,"props":721,"children":722},{"style":653},[723],{"type":400,"value":656},{"type":395,"tag":447,"props":725,"children":726},{"style":545},[727],{"type":400,"value":661},{"type":395,"tag":447,"props":729,"children":730},{"style":460},[731],{"type":400,"value":732},"hello - 4",{"type":395,"tag":447,"props":734,"children":735},{"style":545},[736],{"type":400,"value":671},{"type":395,"tag":447,"props":738,"children":739},{"style":653},[740],{"type":400,"value":656},{"type":395,"tag":447,"props":742,"children":743},{"style":545},[744],{"type":400,"value":680},{"type":395,"tag":396,"props":746,"children":747},{},[748],{"type":400,"value":749},"相比生态里现在动则 30kb 甚至 300kb 的库，仅 30 行代码完成这个功能，简直不可思议。",{"type":395,"tag":751,"props":752,"children":754},"h2",{"id":753},"完整实现",[755],{"type":400,"value":753},{"type":395,"tag":396,"props":757,"children":758},{},[759],{"type":400,"value":760},"因为代码真的非常短，先直接看一遍，这是带注释版本的。如果你能在第一遍 review 这段代码后脑袋还保持清醒的话，留下评论，我拜你为大哥。",{"type":395,"tag":437,"props":762,"children":764},{"className":439,"code":763,"language":441,"meta":389,"style":389},"// Simple JavaScript Templating\n// John Resig - https://johnresig.com/ - MIT Licensed\n(function () {\n  var cache = {};\n\n  this.tmpl = function tmpl(str, data) {\n    // Figure out if we're getting a template, or if we need to\n    // load the template - and be sure to cache the result.\n    var fn = !/\\W/.test(str)\n      ? (cache[str] =\n          cache[str] || tmpl(document.getElementById(str).innerHTML))\n      : // Generate a reusable function that will serve as a template\n        // generator (and which will be cached).\n        new Function(\n          \"obj\",\n          \"var p=[],print=function(){p.push.apply(p,arguments);};\" +\n            // Introduce the data as local variables using with(){}\n            \"with(obj){p.push('\" +\n            // Convert the template into pure JavaScript\n            str\n              .replace(/[\\r\\t\\n]/g, \" \")\n              .split(\"\u003C%\")\n              .join(\"\\t\")\n              .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\n              .replace(/\\t=(.*?)%>/g, \"',$1,'\")\n              .split(\"\\t\")\n              .join(\"');\")\n              .split(\"%>\")\n              .join(\"p.push('\")\n              .split(\"\\r\")\n              .join(\"\\\\'\") +\n            \"');}return p.join('');\"\n        );\n\n    // Provide some basic currying to the user\n    return data ? fn(data) : fn;\n  };\n})();\n",[765],{"type":395,"tag":411,"props":766,"children":767},{"__ignoreMap":389},[768,776,784,806,830,839,900,908,916,974,1011,1084,1097,1106,1125,1148,1170,1179,1201,1210,1219,1283,1317,1352,1463,1542,1574,1607,1639,1672,1704,1747,1765,1779,1787,1796,1843,1852],{"type":395,"tag":447,"props":769,"children":770},{"class":449,"line":450},[771],{"type":395,"tag":447,"props":772,"children":773},{"style":639},[774],{"type":400,"value":775},"// Simple JavaScript Templating\n",{"type":395,"tag":447,"props":777,"children":778},{"class":449,"line":472},[779],{"type":395,"tag":447,"props":780,"children":781},{"style":639},[782],{"type":400,"value":783},"// John Resig - https://johnresig.com/ - MIT Licensed\n",{"type":395,"tag":447,"props":785,"children":786},{"class":449,"line":482},[787,791,797,802],{"type":395,"tag":447,"props":788,"children":789},{"style":460},[790],{"type":400,"value":463},{"type":395,"tag":447,"props":792,"children":794},{"style":793},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-light-font-style:inherit;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[795],{"type":400,"value":796},"function",{"type":395,"tag":447,"props":798,"children":799},{"style":545},[800],{"type":400,"value":801}," ()",{"type":395,"tag":447,"props":803,"children":804},{"style":545},[805],{"type":400,"value":553},{"type":395,"tag":447,"props":807,"children":808},{"class":449,"line":491},[809,814,819,825],{"type":395,"tag":447,"props":810,"children":811},{"style":793},[812],{"type":400,"value":813},"  var",{"type":395,"tag":447,"props":815,"children":816},{"style":460},[817],{"type":400,"value":818}," cache",{"type":395,"tag":447,"props":820,"children":822},{"style":821},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[823],{"type":400,"value":824}," =",{"type":395,"tag":447,"props":826,"children":827},{"style":545},[828],{"type":400,"value":829}," {};\n",{"type":395,"tag":447,"props":831,"children":832},{"class":449,"line":500},[833],{"type":395,"tag":447,"props":834,"children":836},{"emptyLinePlaceholder":835},true,[837],{"type":400,"value":838},"\n",{"type":395,"tag":447,"props":840,"children":841},{"class":449,"line":509},[842,848,853,858,862,867,872,876,882,886,891,896],{"type":395,"tag":447,"props":843,"children":845},{"style":844},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[846],{"type":400,"value":847},"  this",{"type":395,"tag":447,"props":849,"children":850},{"style":545},[851],{"type":400,"value":852},".",{"type":395,"tag":447,"props":854,"children":855},{"style":454},[856],{"type":400,"value":857},"tmpl",{"type":395,"tag":447,"props":859,"children":860},{"style":821},[861],{"type":400,"value":824},{"type":395,"tag":447,"props":863,"children":864},{"style":793},[865],{"type":400,"value":866}," function",{"type":395,"tag":447,"props":868,"children":869},{"style":454},[870],{"type":400,"value":871}," tmpl",{"type":395,"tag":447,"props":873,"children":874},{"style":545},[875],{"type":400,"value":463},{"type":395,"tag":447,"props":877,"children":879},{"style":878},"--shiki-light:#90A4AE;--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[880],{"type":400,"value":881},"str",{"type":395,"tag":447,"props":883,"children":884},{"style":545},[885],{"type":400,"value":548},{"type":395,"tag":447,"props":887,"children":888},{"style":878},[889],{"type":400,"value":890}," data",{"type":395,"tag":447,"props":892,"children":893},{"style":545},[894],{"type":400,"value":895},")",{"type":395,"tag":447,"props":897,"children":898},{"style":545},[899],{"type":400,"value":553},{"type":395,"tag":447,"props":901,"children":902},{"class":449,"line":518},[903],{"type":395,"tag":447,"props":904,"children":905},{"style":639},[906],{"type":400,"value":907},"    // Figure out if we're getting a template, or if we need to\n",{"type":395,"tag":447,"props":909,"children":910},{"class":449,"line":527},[911],{"type":395,"tag":447,"props":912,"children":913},{"style":639},[914],{"type":400,"value":915},"    // load the template - and be sure to cache the result.\n",{"type":395,"tag":447,"props":917,"children":918},{"class":449,"line":536},[919,924,929,933,938,943,949,953,957,962,966,970],{"type":395,"tag":447,"props":920,"children":921},{"style":793},[922],{"type":400,"value":923},"    var",{"type":395,"tag":447,"props":925,"children":926},{"style":460},[927],{"type":400,"value":928}," fn",{"type":395,"tag":447,"props":930,"children":931},{"style":821},[932],{"type":400,"value":824},{"type":395,"tag":447,"props":934,"children":935},{"style":821},[936],{"type":400,"value":937}," !",{"type":395,"tag":447,"props":939,"children":940},{"style":466},[941],{"type":400,"value":942},"/",{"type":395,"tag":447,"props":944,"children":946},{"style":945},"--shiki-light:#91B859;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[947],{"type":400,"value":948},"\\W",{"type":395,"tag":447,"props":950,"children":951},{"style":466},[952],{"type":400,"value":942},{"type":395,"tag":447,"props":954,"children":955},{"style":545},[956],{"type":400,"value":852},{"type":395,"tag":447,"props":958,"children":959},{"style":454},[960],{"type":400,"value":961},"test",{"type":395,"tag":447,"props":963,"children":964},{"style":560},[965],{"type":400,"value":463},{"type":395,"tag":447,"props":967,"children":968},{"style":460},[969],{"type":400,"value":881},{"type":395,"tag":447,"props":971,"children":972},{"style":560},[973],{"type":400,"value":612},{"type":395,"tag":447,"props":975,"children":976},{"class":449,"line":556},[977,982,987,992,997,1001,1006],{"type":395,"tag":447,"props":978,"children":979},{"style":821},[980],{"type":400,"value":981},"      ?",{"type":395,"tag":447,"props":983,"children":984},{"style":560},[985],{"type":400,"value":986}," (",{"type":395,"tag":447,"props":988,"children":989},{"style":460},[990],{"type":400,"value":991},"cache",{"type":395,"tag":447,"props":993,"children":994},{"style":560},[995],{"type":400,"value":996},"[",{"type":395,"tag":447,"props":998,"children":999},{"style":460},[1000],{"type":400,"value":881},{"type":395,"tag":447,"props":1002,"children":1003},{"style":560},[1004],{"type":400,"value":1005},"] ",{"type":395,"tag":447,"props":1007,"children":1008},{"style":821},[1009],{"type":400,"value":1010},"=\n",{"type":395,"tag":447,"props":1012,"children":1013},{"class":449,"line":582},[1014,1019,1023,1027,1031,1036,1040,1044,1049,1053,1058,1062,1066,1070,1074,1079],{"type":395,"tag":447,"props":1015,"children":1016},{"style":460},[1017],{"type":400,"value":1018},"          cache",{"type":395,"tag":447,"props":1020,"children":1021},{"style":560},[1022],{"type":400,"value":996},{"type":395,"tag":447,"props":1024,"children":1025},{"style":460},[1026],{"type":400,"value":881},{"type":395,"tag":447,"props":1028,"children":1029},{"style":560},[1030],{"type":400,"value":1005},{"type":395,"tag":447,"props":1032,"children":1033},{"style":821},[1034],{"type":400,"value":1035},"||",{"type":395,"tag":447,"props":1037,"children":1038},{"style":454},[1039],{"type":400,"value":871},{"type":395,"tag":447,"props":1041,"children":1042},{"style":560},[1043],{"type":400,"value":463},{"type":395,"tag":447,"props":1045,"children":1046},{"style":460},[1047],{"type":400,"value":1048},"document",{"type":395,"tag":447,"props":1050,"children":1051},{"style":545},[1052],{"type":400,"value":852},{"type":395,"tag":447,"props":1054,"children":1055},{"style":454},[1056],{"type":400,"value":1057},"getElementById",{"type":395,"tag":447,"props":1059,"children":1060},{"style":560},[1061],{"type":400,"value":463},{"type":395,"tag":447,"props":1063,"children":1064},{"style":460},[1065],{"type":400,"value":881},{"type":395,"tag":447,"props":1067,"children":1068},{"style":560},[1069],{"type":400,"value":895},{"type":395,"tag":447,"props":1071,"children":1072},{"style":545},[1073],{"type":400,"value":852},{"type":395,"tag":447,"props":1075,"children":1076},{"style":460},[1077],{"type":400,"value":1078},"innerHTML",{"type":395,"tag":447,"props":1080,"children":1081},{"style":560},[1082],{"type":400,"value":1083},"))\n",{"type":395,"tag":447,"props":1085,"children":1086},{"class":449,"line":601},[1087,1092],{"type":395,"tag":447,"props":1088,"children":1089},{"style":821},[1090],{"type":400,"value":1091},"      :",{"type":395,"tag":447,"props":1093,"children":1094},{"style":639},[1095],{"type":400,"value":1096}," // Generate a reusable function that will serve as a template\n",{"type":395,"tag":447,"props":1098,"children":1100},{"class":449,"line":1099},13,[1101],{"type":395,"tag":447,"props":1102,"children":1103},{"style":639},[1104],{"type":400,"value":1105},"        // generator (and which will be cached).\n",{"type":395,"tag":447,"props":1107,"children":1109},{"class":449,"line":1108},14,[1110,1115,1120],{"type":395,"tag":447,"props":1111,"children":1112},{"style":821},[1113],{"type":400,"value":1114},"        new",{"type":395,"tag":447,"props":1116,"children":1117},{"style":454},[1118],{"type":400,"value":1119}," Function",{"type":395,"tag":447,"props":1121,"children":1122},{"style":560},[1123],{"type":400,"value":1124},"(\n",{"type":395,"tag":447,"props":1126,"children":1128},{"class":449,"line":1127},15,[1129,1134,1139,1144],{"type":395,"tag":447,"props":1130,"children":1131},{"style":466},[1132],{"type":400,"value":1133},"          \"",{"type":395,"tag":447,"props":1135,"children":1136},{"style":476},[1137],{"type":400,"value":1138},"obj",{"type":395,"tag":447,"props":1140,"children":1141},{"style":466},[1142],{"type":400,"value":1143},"\"",{"type":395,"tag":447,"props":1145,"children":1146},{"style":545},[1147],{"type":400,"value":579},{"type":395,"tag":447,"props":1149,"children":1151},{"class":449,"line":1150},16,[1152,1156,1161,1165],{"type":395,"tag":447,"props":1153,"children":1154},{"style":466},[1155],{"type":400,"value":1133},{"type":395,"tag":447,"props":1157,"children":1158},{"style":476},[1159],{"type":400,"value":1160},"var p=[],print=function(){p.push.apply(p,arguments);};",{"type":395,"tag":447,"props":1162,"children":1163},{"style":466},[1164],{"type":400,"value":1143},{"type":395,"tag":447,"props":1166,"children":1167},{"style":821},[1168],{"type":400,"value":1169}," +\n",{"type":395,"tag":447,"props":1171,"children":1173},{"class":449,"line":1172},17,[1174],{"type":395,"tag":447,"props":1175,"children":1176},{"style":639},[1177],{"type":400,"value":1178},"            // Introduce the data as local variables using with(){}\n",{"type":395,"tag":447,"props":1180,"children":1182},{"class":449,"line":1181},18,[1183,1188,1193,1197],{"type":395,"tag":447,"props":1184,"children":1185},{"style":466},[1186],{"type":400,"value":1187},"            \"",{"type":395,"tag":447,"props":1189,"children":1190},{"style":476},[1191],{"type":400,"value":1192},"with(obj){p.push('",{"type":395,"tag":447,"props":1194,"children":1195},{"style":466},[1196],{"type":400,"value":1143},{"type":395,"tag":447,"props":1198,"children":1199},{"style":821},[1200],{"type":400,"value":1169},{"type":395,"tag":447,"props":1202,"children":1204},{"class":449,"line":1203},19,[1205],{"type":395,"tag":447,"props":1206,"children":1207},{"style":639},[1208],{"type":400,"value":1209},"            // Convert the template into pure JavaScript\n",{"type":395,"tag":447,"props":1211,"children":1213},{"class":449,"line":1212},20,[1214],{"type":395,"tag":447,"props":1215,"children":1216},{"style":460},[1217],{"type":400,"value":1218},"            str\n",{"type":395,"tag":447,"props":1220,"children":1222},{"class":449,"line":1221},21,[1223,1228,1233,1237,1241,1246,1251,1256,1260,1266,1270,1275,1279],{"type":395,"tag":447,"props":1224,"children":1225},{"style":545},[1226],{"type":400,"value":1227},"              .",{"type":395,"tag":447,"props":1229,"children":1230},{"style":454},[1231],{"type":400,"value":1232},"replace",{"type":395,"tag":447,"props":1234,"children":1235},{"style":560},[1236],{"type":400,"value":463},{"type":395,"tag":447,"props":1238,"children":1239},{"style":466},[1240],{"type":400,"value":942},{"type":395,"tag":447,"props":1242,"children":1244},{"style":1243},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1245],{"type":400,"value":996},{"type":395,"tag":447,"props":1247,"children":1248},{"style":945},[1249],{"type":400,"value":1250},"\\r\\t\\n",{"type":395,"tag":447,"props":1252,"children":1253},{"style":1243},[1254],{"type":400,"value":1255},"]",{"type":395,"tag":447,"props":1257,"children":1258},{"style":466},[1259],{"type":400,"value":942},{"type":395,"tag":447,"props":1261,"children":1263},{"style":1262},"--shiki-light:#F76D47;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1264],{"type":400,"value":1265},"g",{"type":395,"tag":447,"props":1267,"children":1268},{"style":545},[1269],{"type":400,"value":548},{"type":395,"tag":447,"props":1271,"children":1272},{"style":466},[1273],{"type":400,"value":1274}," \"",{"type":395,"tag":447,"props":1276,"children":1277},{"style":466},[1278],{"type":400,"value":1274},{"type":395,"tag":447,"props":1280,"children":1281},{"style":560},[1282],{"type":400,"value":612},{"type":395,"tag":447,"props":1284,"children":1286},{"class":449,"line":1285},22,[1287,1291,1296,1300,1304,1309,1313],{"type":395,"tag":447,"props":1288,"children":1289},{"style":545},[1290],{"type":400,"value":1227},{"type":395,"tag":447,"props":1292,"children":1293},{"style":454},[1294],{"type":400,"value":1295},"split",{"type":395,"tag":447,"props":1297,"children":1298},{"style":560},[1299],{"type":400,"value":463},{"type":395,"tag":447,"props":1301,"children":1302},{"style":466},[1303],{"type":400,"value":1143},{"type":395,"tag":447,"props":1305,"children":1306},{"style":476},[1307],{"type":400,"value":1308},"\u003C%",{"type":395,"tag":447,"props":1310,"children":1311},{"style":466},[1312],{"type":400,"value":1143},{"type":395,"tag":447,"props":1314,"children":1315},{"style":560},[1316],{"type":400,"value":612},{"type":395,"tag":447,"props":1318,"children":1320},{"class":449,"line":1319},23,[1321,1325,1330,1334,1338,1344,1348],{"type":395,"tag":447,"props":1322,"children":1323},{"style":545},[1324],{"type":400,"value":1227},{"type":395,"tag":447,"props":1326,"children":1327},{"style":454},[1328],{"type":400,"value":1329},"join",{"type":395,"tag":447,"props":1331,"children":1332},{"style":560},[1333],{"type":400,"value":463},{"type":395,"tag":447,"props":1335,"children":1336},{"style":466},[1337],{"type":400,"value":1143},{"type":395,"tag":447,"props":1339,"children":1341},{"style":1340},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1342],{"type":400,"value":1343},"\\t",{"type":395,"tag":447,"props":1345,"children":1346},{"style":466},[1347],{"type":400,"value":1143},{"type":395,"tag":447,"props":1349,"children":1350},{"style":560},[1351],{"type":400,"value":612},{"type":395,"tag":447,"props":1353,"children":1355},{"class":449,"line":1354},24,[1356,1360,1364,1368,1372,1378,1384,1389,1395,1399,1403,1407,1411,1415,1420,1424,1429,1433,1437,1441,1445,1450,1455,1459],{"type":395,"tag":447,"props":1357,"children":1358},{"style":545},[1359],{"type":400,"value":1227},{"type":395,"tag":447,"props":1361,"children":1362},{"style":454},[1363],{"type":400,"value":1232},{"type":395,"tag":447,"props":1365,"children":1366},{"style":560},[1367],{"type":400,"value":463},{"type":395,"tag":447,"props":1369,"children":1370},{"style":466},[1371],{"type":400,"value":942},{"type":395,"tag":447,"props":1373,"children":1375},{"style":1374},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[1376],{"type":400,"value":1377},"((",{"type":395,"tag":447,"props":1379,"children":1381},{"style":1380},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[1382],{"type":400,"value":1383},"^",{"type":395,"tag":447,"props":1385,"children":1386},{"style":821},[1387],{"type":400,"value":1388},"|",{"type":395,"tag":447,"props":1390,"children":1392},{"style":1391},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[1393],{"type":400,"value":1394},"%>",{"type":395,"tag":447,"props":1396,"children":1397},{"style":1374},[1398],{"type":400,"value":895},{"type":395,"tag":447,"props":1400,"children":1401},{"style":1243},[1402],{"type":400,"value":996},{"type":395,"tag":447,"props":1404,"children":1405},{"style":821},[1406],{"type":400,"value":1383},{"type":395,"tag":447,"props":1408,"children":1409},{"style":945},[1410],{"type":400,"value":1343},{"type":395,"tag":447,"props":1412,"children":1413},{"style":1243},[1414],{"type":400,"value":1255},{"type":395,"tag":447,"props":1416,"children":1417},{"style":821},[1418],{"type":400,"value":1419},"*",{"type":395,"tag":447,"props":1421,"children":1422},{"style":1374},[1423],{"type":400,"value":895},{"type":395,"tag":447,"props":1425,"children":1426},{"style":1391},[1427],{"type":400,"value":1428},"'",{"type":395,"tag":447,"props":1430,"children":1431},{"style":466},[1432],{"type":400,"value":942},{"type":395,"tag":447,"props":1434,"children":1435},{"style":1262},[1436],{"type":400,"value":1265},{"type":395,"tag":447,"props":1438,"children":1439},{"style":545},[1440],{"type":400,"value":548},{"type":395,"tag":447,"props":1442,"children":1443},{"style":466},[1444],{"type":400,"value":1274},{"type":395,"tag":447,"props":1446,"children":1447},{"style":476},[1448],{"type":400,"value":1449},"$1",{"type":395,"tag":447,"props":1451,"children":1452},{"style":1340},[1453],{"type":400,"value":1454},"\\r",{"type":395,"tag":447,"props":1456,"children":1457},{"style":466},[1458],{"type":400,"value":1143},{"type":395,"tag":447,"props":1460,"children":1461},{"style":560},[1462],{"type":400,"value":612},{"type":395,"tag":447,"props":1464,"children":1466},{"class":449,"line":1465},25,[1467,1471,1475,1479,1483,1487,1492,1496,1500,1505,1509,1513,1517,1521,1525,1529,1534,1538],{"type":395,"tag":447,"props":1468,"children":1469},{"style":545},[1470],{"type":400,"value":1227},{"type":395,"tag":447,"props":1472,"children":1473},{"style":454},[1474],{"type":400,"value":1232},{"type":395,"tag":447,"props":1476,"children":1477},{"style":560},[1478],{"type":400,"value":463},{"type":395,"tag":447,"props":1480,"children":1481},{"style":466},[1482],{"type":400,"value":942},{"type":395,"tag":447,"props":1484,"children":1485},{"style":945},[1486],{"type":400,"value":1343},{"type":395,"tag":447,"props":1488,"children":1489},{"style":1391},[1490],{"type":400,"value":1491},"=",{"type":395,"tag":447,"props":1493,"children":1494},{"style":1374},[1495],{"type":400,"value":463},{"type":395,"tag":447,"props":1497,"children":1498},{"style":945},[1499],{"type":400,"value":852},{"type":395,"tag":447,"props":1501,"children":1502},{"style":821},[1503],{"type":400,"value":1504},"*?",{"type":395,"tag":447,"props":1506,"children":1507},{"style":1374},[1508],{"type":400,"value":895},{"type":395,"tag":447,"props":1510,"children":1511},{"style":1391},[1512],{"type":400,"value":1394},{"type":395,"tag":447,"props":1514,"children":1515},{"style":466},[1516],{"type":400,"value":942},{"type":395,"tag":447,"props":1518,"children":1519},{"style":1262},[1520],{"type":400,"value":1265},{"type":395,"tag":447,"props":1522,"children":1523},{"style":545},[1524],{"type":400,"value":548},{"type":395,"tag":447,"props":1526,"children":1527},{"style":466},[1528],{"type":400,"value":1274},{"type":395,"tag":447,"props":1530,"children":1531},{"style":476},[1532],{"type":400,"value":1533},"',$1,'",{"type":395,"tag":447,"props":1535,"children":1536},{"style":466},[1537],{"type":400,"value":1143},{"type":395,"tag":447,"props":1539,"children":1540},{"style":560},[1541],{"type":400,"value":612},{"type":395,"tag":447,"props":1543,"children":1545},{"class":449,"line":1544},26,[1546,1550,1554,1558,1562,1566,1570],{"type":395,"tag":447,"props":1547,"children":1548},{"style":545},[1549],{"type":400,"value":1227},{"type":395,"tag":447,"props":1551,"children":1552},{"style":454},[1553],{"type":400,"value":1295},{"type":395,"tag":447,"props":1555,"children":1556},{"style":560},[1557],{"type":400,"value":463},{"type":395,"tag":447,"props":1559,"children":1560},{"style":466},[1561],{"type":400,"value":1143},{"type":395,"tag":447,"props":1563,"children":1564},{"style":1340},[1565],{"type":400,"value":1343},{"type":395,"tag":447,"props":1567,"children":1568},{"style":466},[1569],{"type":400,"value":1143},{"type":395,"tag":447,"props":1571,"children":1572},{"style":560},[1573],{"type":400,"value":612},{"type":395,"tag":447,"props":1575,"children":1577},{"class":449,"line":1576},27,[1578,1582,1586,1590,1594,1599,1603],{"type":395,"tag":447,"props":1579,"children":1580},{"style":545},[1581],{"type":400,"value":1227},{"type":395,"tag":447,"props":1583,"children":1584},{"style":454},[1585],{"type":400,"value":1329},{"type":395,"tag":447,"props":1587,"children":1588},{"style":560},[1589],{"type":400,"value":463},{"type":395,"tag":447,"props":1591,"children":1592},{"style":466},[1593],{"type":400,"value":1143},{"type":395,"tag":447,"props":1595,"children":1596},{"style":476},[1597],{"type":400,"value":1598},"');",{"type":395,"tag":447,"props":1600,"children":1601},{"style":466},[1602],{"type":400,"value":1143},{"type":395,"tag":447,"props":1604,"children":1605},{"style":560},[1606],{"type":400,"value":612},{"type":395,"tag":447,"props":1608,"children":1610},{"class":449,"line":1609},28,[1611,1615,1619,1623,1627,1631,1635],{"type":395,"tag":447,"props":1612,"children":1613},{"style":545},[1614],{"type":400,"value":1227},{"type":395,"tag":447,"props":1616,"children":1617},{"style":454},[1618],{"type":400,"value":1295},{"type":395,"tag":447,"props":1620,"children":1621},{"style":560},[1622],{"type":400,"value":463},{"type":395,"tag":447,"props":1624,"children":1625},{"style":466},[1626],{"type":400,"value":1143},{"type":395,"tag":447,"props":1628,"children":1629},{"style":476},[1630],{"type":400,"value":1394},{"type":395,"tag":447,"props":1632,"children":1633},{"style":466},[1634],{"type":400,"value":1143},{"type":395,"tag":447,"props":1636,"children":1637},{"style":560},[1638],{"type":400,"value":612},{"type":395,"tag":447,"props":1640,"children":1642},{"class":449,"line":1641},29,[1643,1647,1651,1655,1659,1664,1668],{"type":395,"tag":447,"props":1644,"children":1645},{"style":545},[1646],{"type":400,"value":1227},{"type":395,"tag":447,"props":1648,"children":1649},{"style":454},[1650],{"type":400,"value":1329},{"type":395,"tag":447,"props":1652,"children":1653},{"style":560},[1654],{"type":400,"value":463},{"type":395,"tag":447,"props":1656,"children":1657},{"style":466},[1658],{"type":400,"value":1143},{"type":395,"tag":447,"props":1660,"children":1661},{"style":476},[1662],{"type":400,"value":1663},"p.push('",{"type":395,"tag":447,"props":1665,"children":1666},{"style":466},[1667],{"type":400,"value":1143},{"type":395,"tag":447,"props":1669,"children":1670},{"style":560},[1671],{"type":400,"value":612},{"type":395,"tag":447,"props":1673,"children":1675},{"class":449,"line":1674},30,[1676,1680,1684,1688,1692,1696,1700],{"type":395,"tag":447,"props":1677,"children":1678},{"style":545},[1679],{"type":400,"value":1227},{"type":395,"tag":447,"props":1681,"children":1682},{"style":454},[1683],{"type":400,"value":1295},{"type":395,"tag":447,"props":1685,"children":1686},{"style":560},[1687],{"type":400,"value":463},{"type":395,"tag":447,"props":1689,"children":1690},{"style":466},[1691],{"type":400,"value":1143},{"type":395,"tag":447,"props":1693,"children":1694},{"style":1340},[1695],{"type":400,"value":1454},{"type":395,"tag":447,"props":1697,"children":1698},{"style":466},[1699],{"type":400,"value":1143},{"type":395,"tag":447,"props":1701,"children":1702},{"style":560},[1703],{"type":400,"value":612},{"type":395,"tag":447,"props":1705,"children":1707},{"class":449,"line":1706},31,[1708,1712,1716,1720,1724,1729,1733,1737,1742],{"type":395,"tag":447,"props":1709,"children":1710},{"style":545},[1711],{"type":400,"value":1227},{"type":395,"tag":447,"props":1713,"children":1714},{"style":454},[1715],{"type":400,"value":1329},{"type":395,"tag":447,"props":1717,"children":1718},{"style":560},[1719],{"type":400,"value":463},{"type":395,"tag":447,"props":1721,"children":1722},{"style":466},[1723],{"type":400,"value":1143},{"type":395,"tag":447,"props":1725,"children":1726},{"style":1340},[1727],{"type":400,"value":1728},"\\\\",{"type":395,"tag":447,"props":1730,"children":1731},{"style":476},[1732],{"type":400,"value":1428},{"type":395,"tag":447,"props":1734,"children":1735},{"style":466},[1736],{"type":400,"value":1143},{"type":395,"tag":447,"props":1738,"children":1739},{"style":560},[1740],{"type":400,"value":1741},") ",{"type":395,"tag":447,"props":1743,"children":1744},{"style":821},[1745],{"type":400,"value":1746},"+\n",{"type":395,"tag":447,"props":1748,"children":1750},{"class":449,"line":1749},32,[1751,1755,1760],{"type":395,"tag":447,"props":1752,"children":1753},{"style":466},[1754],{"type":400,"value":1187},{"type":395,"tag":447,"props":1756,"children":1757},{"style":476},[1758],{"type":400,"value":1759},"');}return p.join('');",{"type":395,"tag":447,"props":1761,"children":1762},{"style":466},[1763],{"type":400,"value":1764},"\"\n",{"type":395,"tag":447,"props":1766,"children":1768},{"class":449,"line":1767},33,[1769,1774],{"type":395,"tag":447,"props":1770,"children":1771},{"style":560},[1772],{"type":400,"value":1773},"        )",{"type":395,"tag":447,"props":1775,"children":1776},{"style":545},[1777],{"type":400,"value":1778},";\n",{"type":395,"tag":447,"props":1780,"children":1782},{"class":449,"line":1781},34,[1783],{"type":395,"tag":447,"props":1784,"children":1785},{"emptyLinePlaceholder":835},[1786],{"type":400,"value":838},{"type":395,"tag":447,"props":1788,"children":1790},{"class":449,"line":1789},35,[1791],{"type":395,"tag":447,"props":1792,"children":1793},{"style":639},[1794],{"type":400,"value":1795},"    // Provide some basic currying to the user\n",{"type":395,"tag":447,"props":1797,"children":1799},{"class":449,"line":1798},36,[1800,1805,1809,1814,1818,1822,1827,1831,1835,1839],{"type":395,"tag":447,"props":1801,"children":1802},{"style":1380},[1803],{"type":400,"value":1804},"    return",{"type":395,"tag":447,"props":1806,"children":1807},{"style":460},[1808],{"type":400,"value":890},{"type":395,"tag":447,"props":1810,"children":1811},{"style":821},[1812],{"type":400,"value":1813}," ?",{"type":395,"tag":447,"props":1815,"children":1816},{"style":454},[1817],{"type":400,"value":928},{"type":395,"tag":447,"props":1819,"children":1820},{"style":560},[1821],{"type":400,"value":463},{"type":395,"tag":447,"props":1823,"children":1824},{"style":460},[1825],{"type":400,"value":1826},"data",{"type":395,"tag":447,"props":1828,"children":1829},{"style":560},[1830],{"type":400,"value":1741},{"type":395,"tag":447,"props":1832,"children":1833},{"style":821},[1834],{"type":400,"value":568},{"type":395,"tag":447,"props":1836,"children":1837},{"style":460},[1838],{"type":400,"value":928},{"type":395,"tag":447,"props":1840,"children":1841},{"style":545},[1842],{"type":400,"value":1778},{"type":395,"tag":447,"props":1844,"children":1846},{"class":449,"line":1845},37,[1847],{"type":395,"tag":447,"props":1848,"children":1849},{"style":545},[1850],{"type":400,"value":1851},"  };\n",{"type":395,"tag":447,"props":1853,"children":1855},{"class":449,"line":1854},38,[1856,1860,1865],{"type":395,"tag":447,"props":1857,"children":1858},{"style":545},[1859],{"type":400,"value":607},{"type":395,"tag":447,"props":1861,"children":1862},{"style":460},[1863],{"type":400,"value":1864},")()",{"type":395,"tag":447,"props":1866,"children":1867},{"style":545},[1868],{"type":400,"value":1778},{"type":395,"tag":396,"props":1870,"children":1871},{},[1872],{"type":400,"value":1873},"代码看完了，我知道你没看懂，因为曾经我也是。好了，留下三连，解析开始。",{"type":395,"tag":751,"props":1875,"children":1877},{"id":1876},"解析",[1878],{"type":400,"value":1876},{"type":395,"tag":396,"props":1880,"children":1881},{},[1882],{"type":400,"value":1883},"首先，代码最外层是一个 IIFE，给 this 对象挂载了 tmpl 函数，直接执行的话就是 window。内部通过局部变量保存了模板解析的缓存：",{"type":395,"tag":437,"props":1885,"children":1887},{"className":439,"code":1886,"language":441,"meta":389,"style":389},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {};\n})();\n",[1888],{"type":395,"tag":411,"props":1889,"children":1890},{"__ignoreMap":389},[1891,1910,1929,1980],{"type":395,"tag":447,"props":1892,"children":1893},{"class":449,"line":450},[1894,1898,1902,1906],{"type":395,"tag":447,"props":1895,"children":1896},{"style":460},[1897],{"type":400,"value":463},{"type":395,"tag":447,"props":1899,"children":1900},{"style":793},[1901],{"type":400,"value":796},{"type":395,"tag":447,"props":1903,"children":1904},{"style":545},[1905],{"type":400,"value":801},{"type":395,"tag":447,"props":1907,"children":1908},{"style":545},[1909],{"type":400,"value":553},{"type":395,"tag":447,"props":1911,"children":1912},{"class":449,"line":472},[1913,1917,1921,1925],{"type":395,"tag":447,"props":1914,"children":1915},{"style":793},[1916],{"type":400,"value":813},{"type":395,"tag":447,"props":1918,"children":1919},{"style":460},[1920],{"type":400,"value":818},{"type":395,"tag":447,"props":1922,"children":1923},{"style":821},[1924],{"type":400,"value":824},{"type":395,"tag":447,"props":1926,"children":1927},{"style":545},[1928],{"type":400,"value":829},{"type":395,"tag":447,"props":1930,"children":1931},{"class":449,"line":482},[1932,1936,1940,1944,1948,1952,1956,1960,1964,1968,1972,1976],{"type":395,"tag":447,"props":1933,"children":1934},{"style":844},[1935],{"type":400,"value":847},{"type":395,"tag":447,"props":1937,"children":1938},{"style":545},[1939],{"type":400,"value":852},{"type":395,"tag":447,"props":1941,"children":1942},{"style":454},[1943],{"type":400,"value":857},{"type":395,"tag":447,"props":1945,"children":1946},{"style":821},[1947],{"type":400,"value":824},{"type":395,"tag":447,"props":1949,"children":1950},{"style":793},[1951],{"type":400,"value":866},{"type":395,"tag":447,"props":1953,"children":1954},{"style":454},[1955],{"type":400,"value":871},{"type":395,"tag":447,"props":1957,"children":1958},{"style":545},[1959],{"type":400,"value":463},{"type":395,"tag":447,"props":1961,"children":1962},{"style":878},[1963],{"type":400,"value":881},{"type":395,"tag":447,"props":1965,"children":1966},{"style":545},[1967],{"type":400,"value":548},{"type":395,"tag":447,"props":1969,"children":1970},{"style":878},[1971],{"type":400,"value":890},{"type":395,"tag":447,"props":1973,"children":1974},{"style":545},[1975],{"type":400,"value":895},{"type":395,"tag":447,"props":1977,"children":1978},{"style":545},[1979],{"type":400,"value":829},{"type":395,"tag":447,"props":1981,"children":1982},{"class":449,"line":491},[1983,1987,1991],{"type":395,"tag":447,"props":1984,"children":1985},{"style":545},[1986],{"type":400,"value":607},{"type":395,"tag":447,"props":1988,"children":1989},{"style":460},[1990],{"type":400,"value":1864},{"type":395,"tag":447,"props":1992,"children":1993},{"style":545},[1994],{"type":400,"value":1778},{"type":395,"tag":396,"props":1996,"children":1997},{},[1998,2000,2006],{"type":400,"value":1999},"str 参数有两种两种用途，",{"type":395,"tag":411,"props":2001,"children":2003},{"className":2002},[],[2004],{"type":400,"value":2005},"/\\W/.test(str)",{"type":400,"value":2007}," 用来判断字符串中包不包含模板分隔符，如果不含分隔符，即普通字符串，那就当作 ID，从页面对应 ID 的节点中获取内容作为模板。比如，如果 str 为 'user_tmpl'，那么模板函数将会读取页面的以下脚本的内容作为输入：",{"type":395,"tag":437,"props":2009,"children":2011},{"className":627,"code":2010,"language":629,"meta":389,"style":389},"\u003C!-- type=\"text/html\"，所以浏览器并不会执行这串脚本。它只能由 tmpl 来读取... -->\n\u003Cscript type=\"text/html\" id=\"item_tmpl\">\n  \u003Cdiv id=\"\u003C%=id%>\" class=\"\u003C%=(i % 2 == 1 ? \" even\" : \"\")%>\">\n    \u003Cdiv class=\"grid_1 alpha right\">\n      \u003Cimg class=\"righted\" src=\"\u003C%=profile_image_url%>\"/>\n    \u003C/div>\n    \u003Cdiv class=\"grid_6 omega contents\">\n      \u003Cp>\u003Cb>\u003Ca href=\"/\u003C%=from_user%>\">\u003C%=from_user%>\u003C/a>:\u003C/b> \u003C%=text%>\u003C/p>\n    \u003C/div>\n  \u003C/div>\n\u003C/script>\n",[2012],{"type":395,"tag":411,"props":2013,"children":2014},{"__ignoreMap":389},[2015,2023,2084,2168,2205,2266,2282,2318,2423,2438,2454],{"type":395,"tag":447,"props":2016,"children":2017},{"class":449,"line":450},[2018],{"type":395,"tag":447,"props":2019,"children":2020},{"style":639},[2021],{"type":400,"value":2022},"\u003C!-- type=\"text/html\"，所以浏览器并不会执行这串脚本。它只能由 tmpl 来读取... -->\n",{"type":395,"tag":447,"props":2024,"children":2025},{"class":449,"line":472},[2026,2030,2035,2041,2045,2049,2054,2058,2063,2067,2071,2076,2080],{"type":395,"tag":447,"props":2027,"children":2028},{"style":545},[2029],{"type":400,"value":650},{"type":395,"tag":447,"props":2031,"children":2032},{"style":653},[2033],{"type":400,"value":2034},"script",{"type":395,"tag":447,"props":2036,"children":2038},{"style":2037},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[2039],{"type":400,"value":2040}," type",{"type":395,"tag":447,"props":2042,"children":2043},{"style":545},[2044],{"type":400,"value":1491},{"type":395,"tag":447,"props":2046,"children":2047},{"style":466},[2048],{"type":400,"value":1143},{"type":395,"tag":447,"props":2050,"children":2051},{"style":476},[2052],{"type":400,"value":2053},"text/html",{"type":395,"tag":447,"props":2055,"children":2056},{"style":466},[2057],{"type":400,"value":1143},{"type":395,"tag":447,"props":2059,"children":2060},{"style":2037},[2061],{"type":400,"value":2062}," id",{"type":395,"tag":447,"props":2064,"children":2065},{"style":545},[2066],{"type":400,"value":1491},{"type":395,"tag":447,"props":2068,"children":2069},{"style":466},[2070],{"type":400,"value":1143},{"type":395,"tag":447,"props":2072,"children":2073},{"style":476},[2074],{"type":400,"value":2075},"item_tmpl",{"type":395,"tag":447,"props":2077,"children":2078},{"style":466},[2079],{"type":400,"value":1143},{"type":395,"tag":447,"props":2081,"children":2082},{"style":545},[2083],{"type":400,"value":680},{"type":395,"tag":447,"props":2085,"children":2086},{"class":449,"line":482},[2087,2092,2096,2100,2104,2108,2113,2117,2122,2126,2130,2135,2139,2144,2149,2154,2159,2163],{"type":395,"tag":447,"props":2088,"children":2089},{"style":545},[2090],{"type":400,"value":2091},"  \u003C",{"type":395,"tag":447,"props":2093,"children":2094},{"style":653},[2095],{"type":400,"value":656},{"type":395,"tag":447,"props":2097,"children":2098},{"style":2037},[2099],{"type":400,"value":2062},{"type":395,"tag":447,"props":2101,"children":2102},{"style":545},[2103],{"type":400,"value":1491},{"type":395,"tag":447,"props":2105,"children":2106},{"style":466},[2107],{"type":400,"value":1143},{"type":395,"tag":447,"props":2109,"children":2110},{"style":476},[2111],{"type":400,"value":2112},"\u003C%=id%>",{"type":395,"tag":447,"props":2114,"children":2115},{"style":466},[2116],{"type":400,"value":1143},{"type":395,"tag":447,"props":2118,"children":2119},{"style":2037},[2120],{"type":400,"value":2121}," class",{"type":395,"tag":447,"props":2123,"children":2124},{"style":545},[2125],{"type":400,"value":1491},{"type":395,"tag":447,"props":2127,"children":2128},{"style":466},[2129],{"type":400,"value":1143},{"type":395,"tag":447,"props":2131,"children":2132},{"style":476},[2133],{"type":400,"value":2134},"\u003C%=(i % 2 == 1 ? ",{"type":395,"tag":447,"props":2136,"children":2137},{"style":466},[2138],{"type":400,"value":1143},{"type":395,"tag":447,"props":2140,"children":2141},{"style":2037},[2142],{"type":400,"value":2143}," even",{"type":395,"tag":447,"props":2145,"children":2147},{"style":2146},"--shiki-light:#39ADB5;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F44747;--shiki-light-font-style:inherit;--shiki-default-font-style:italic;--shiki-dark-font-style:italic;--shiki-sepia-font-style:inherit",[2148],{"type":400,"value":1143},{"type":395,"tag":447,"props":2150,"children":2151},{"style":2037},[2152],{"type":400,"value":2153}," :",{"type":395,"tag":447,"props":2155,"children":2156},{"style":2146},[2157],{"type":400,"value":2158}," \"\")%",{"type":395,"tag":447,"props":2160,"children":2161},{"style":545},[2162],{"type":400,"value":661},{"type":395,"tag":447,"props":2164,"children":2165},{"style":460},[2166],{"type":400,"value":2167},"\">\n",{"type":395,"tag":447,"props":2169,"children":2170},{"class":449,"line":491},[2171,2176,2180,2184,2188,2192,2197,2201],{"type":395,"tag":447,"props":2172,"children":2173},{"style":545},[2174],{"type":400,"value":2175},"    \u003C",{"type":395,"tag":447,"props":2177,"children":2178},{"style":653},[2179],{"type":400,"value":656},{"type":395,"tag":447,"props":2181,"children":2182},{"style":2037},[2183],{"type":400,"value":2121},{"type":395,"tag":447,"props":2185,"children":2186},{"style":545},[2187],{"type":400,"value":1491},{"type":395,"tag":447,"props":2189,"children":2190},{"style":466},[2191],{"type":400,"value":1143},{"type":395,"tag":447,"props":2193,"children":2194},{"style":476},[2195],{"type":400,"value":2196},"grid_1 alpha right",{"type":395,"tag":447,"props":2198,"children":2199},{"style":466},[2200],{"type":400,"value":1143},{"type":395,"tag":447,"props":2202,"children":2203},{"style":545},[2204],{"type":400,"value":680},{"type":395,"tag":447,"props":2206,"children":2207},{"class":449,"line":500},[2208,2213,2218,2222,2226,2230,2235,2239,2244,2248,2252,2257,2261],{"type":395,"tag":447,"props":2209,"children":2210},{"style":545},[2211],{"type":400,"value":2212},"      \u003C",{"type":395,"tag":447,"props":2214,"children":2215},{"style":653},[2216],{"type":400,"value":2217},"img",{"type":395,"tag":447,"props":2219,"children":2220},{"style":2037},[2221],{"type":400,"value":2121},{"type":395,"tag":447,"props":2223,"children":2224},{"style":545},[2225],{"type":400,"value":1491},{"type":395,"tag":447,"props":2227,"children":2228},{"style":466},[2229],{"type":400,"value":1143},{"type":395,"tag":447,"props":2231,"children":2232},{"style":476},[2233],{"type":400,"value":2234},"righted",{"type":395,"tag":447,"props":2236,"children":2237},{"style":466},[2238],{"type":400,"value":1143},{"type":395,"tag":447,"props":2240,"children":2241},{"style":2037},[2242],{"type":400,"value":2243}," src",{"type":395,"tag":447,"props":2245,"children":2246},{"style":545},[2247],{"type":400,"value":1491},{"type":395,"tag":447,"props":2249,"children":2250},{"style":466},[2251],{"type":400,"value":1143},{"type":395,"tag":447,"props":2253,"children":2254},{"style":476},[2255],{"type":400,"value":2256},"\u003C%=profile_image_url%>",{"type":395,"tag":447,"props":2258,"children":2259},{"style":466},[2260],{"type":400,"value":1143},{"type":395,"tag":447,"props":2262,"children":2263},{"style":545},[2264],{"type":400,"value":2265},"/>\n",{"type":395,"tag":447,"props":2267,"children":2268},{"class":449,"line":509},[2269,2274,2278],{"type":395,"tag":447,"props":2270,"children":2271},{"style":545},[2272],{"type":400,"value":2273},"    \u003C/",{"type":395,"tag":447,"props":2275,"children":2276},{"style":653},[2277],{"type":400,"value":656},{"type":395,"tag":447,"props":2279,"children":2280},{"style":545},[2281],{"type":400,"value":680},{"type":395,"tag":447,"props":2283,"children":2284},{"class":449,"line":518},[2285,2289,2293,2297,2301,2305,2310,2314],{"type":395,"tag":447,"props":2286,"children":2287},{"style":545},[2288],{"type":400,"value":2175},{"type":395,"tag":447,"props":2290,"children":2291},{"style":653},[2292],{"type":400,"value":656},{"type":395,"tag":447,"props":2294,"children":2295},{"style":2037},[2296],{"type":400,"value":2121},{"type":395,"tag":447,"props":2298,"children":2299},{"style":545},[2300],{"type":400,"value":1491},{"type":395,"tag":447,"props":2302,"children":2303},{"style":466},[2304],{"type":400,"value":1143},{"type":395,"tag":447,"props":2306,"children":2307},{"style":476},[2308],{"type":400,"value":2309},"grid_6 omega contents",{"type":395,"tag":447,"props":2311,"children":2312},{"style":466},[2313],{"type":400,"value":1143},{"type":395,"tag":447,"props":2315,"children":2316},{"style":545},[2317],{"type":400,"value":680},{"type":395,"tag":447,"props":2319,"children":2320},{"class":449,"line":527},[2321,2325,2329,2334,2339,2343,2347,2352,2356,2360,2365,2369,2373,2378,2382,2386,2390,2394,2398,2402,2406,2411,2415,2419],{"type":395,"tag":447,"props":2322,"children":2323},{"style":545},[2324],{"type":400,"value":2212},{"type":395,"tag":447,"props":2326,"children":2327},{"style":653},[2328],{"type":400,"value":396},{"type":395,"tag":447,"props":2330,"children":2331},{"style":545},[2332],{"type":400,"value":2333},">\u003C",{"type":395,"tag":447,"props":2335,"children":2336},{"style":653},[2337],{"type":400,"value":2338},"b",{"type":395,"tag":447,"props":2340,"children":2341},{"style":545},[2342],{"type":400,"value":2333},{"type":395,"tag":447,"props":2344,"children":2345},{"style":653},[2346],{"type":400,"value":403},{"type":395,"tag":447,"props":2348,"children":2349},{"style":2037},[2350],{"type":400,"value":2351}," href",{"type":395,"tag":447,"props":2353,"children":2354},{"style":545},[2355],{"type":400,"value":1491},{"type":395,"tag":447,"props":2357,"children":2358},{"style":466},[2359],{"type":400,"value":1143},{"type":395,"tag":447,"props":2361,"children":2362},{"style":476},[2363],{"type":400,"value":2364},"/\u003C%=from_user%>",{"type":395,"tag":447,"props":2366,"children":2367},{"style":466},[2368],{"type":400,"value":1143},{"type":395,"tag":447,"props":2370,"children":2371},{"style":545},[2372],{"type":400,"value":661},{"type":395,"tag":447,"props":2374,"children":2375},{"style":460},[2376],{"type":400,"value":2377},"\u003C%=from_user%>",{"type":395,"tag":447,"props":2379,"children":2380},{"style":545},[2381],{"type":400,"value":671},{"type":395,"tag":447,"props":2383,"children":2384},{"style":653},[2385],{"type":400,"value":403},{"type":395,"tag":447,"props":2387,"children":2388},{"style":545},[2389],{"type":400,"value":661},{"type":395,"tag":447,"props":2391,"children":2392},{"style":460},[2393],{"type":400,"value":568},{"type":395,"tag":447,"props":2395,"children":2396},{"style":545},[2397],{"type":400,"value":671},{"type":395,"tag":447,"props":2399,"children":2400},{"style":653},[2401],{"type":400,"value":2338},{"type":395,"tag":447,"props":2403,"children":2404},{"style":545},[2405],{"type":400,"value":661},{"type":395,"tag":447,"props":2407,"children":2408},{"style":460},[2409],{"type":400,"value":2410}," \u003C%=text%>",{"type":395,"tag":447,"props":2412,"children":2413},{"style":545},[2414],{"type":400,"value":671},{"type":395,"tag":447,"props":2416,"children":2417},{"style":653},[2418],{"type":400,"value":396},{"type":395,"tag":447,"props":2420,"children":2421},{"style":545},[2422],{"type":400,"value":680},{"type":395,"tag":447,"props":2424,"children":2425},{"class":449,"line":536},[2426,2430,2434],{"type":395,"tag":447,"props":2427,"children":2428},{"style":545},[2429],{"type":400,"value":2273},{"type":395,"tag":447,"props":2431,"children":2432},{"style":653},[2433],{"type":400,"value":656},{"type":395,"tag":447,"props":2435,"children":2436},{"style":545},[2437],{"type":400,"value":680},{"type":395,"tag":447,"props":2439,"children":2440},{"class":449,"line":556},[2441,2446,2450],{"type":395,"tag":447,"props":2442,"children":2443},{"style":545},[2444],{"type":400,"value":2445},"  \u003C/",{"type":395,"tag":447,"props":2447,"children":2448},{"style":653},[2449],{"type":400,"value":656},{"type":395,"tag":447,"props":2451,"children":2452},{"style":545},[2453],{"type":400,"value":680},{"type":395,"tag":447,"props":2455,"children":2456},{"class":449,"line":582},[2457,2461,2465],{"type":395,"tag":447,"props":2458,"children":2459},{"style":545},[2460],{"type":400,"value":671},{"type":395,"tag":447,"props":2462,"children":2463},{"style":653},[2464],{"type":400,"value":2034},{"type":395,"tag":447,"props":2466,"children":2467},{"style":545},[2468],{"type":400,"value":680},{"type":395,"tag":437,"props":2470,"children":2472},{"className":439,"code":2471,"language":441,"meta":389,"style":389},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {\n    return !/\\W/.test(str)\n      ? // 缓存会将读取脚本内容到模板解析这个过程的解析结果缓存下来\n        (cache[str] =\n          cache[str] ||\n          // 读取脚本内容\n          tmpl(document.getElementById(str).innerHTML))\n      : new Function();\n  };\n})();\n",[2473],{"type":395,"tag":411,"props":2474,"children":2475},{"__ignoreMap":389},[2476,2495,2514,2565,2608,2620,2648,2672,2680,2728,2753,2760],{"type":395,"tag":447,"props":2477,"children":2478},{"class":449,"line":450},[2479,2483,2487,2491],{"type":395,"tag":447,"props":2480,"children":2481},{"style":460},[2482],{"type":400,"value":463},{"type":395,"tag":447,"props":2484,"children":2485},{"style":793},[2486],{"type":400,"value":796},{"type":395,"tag":447,"props":2488,"children":2489},{"style":545},[2490],{"type":400,"value":801},{"type":395,"tag":447,"props":2492,"children":2493},{"style":545},[2494],{"type":400,"value":553},{"type":395,"tag":447,"props":2496,"children":2497},{"class":449,"line":472},[2498,2502,2506,2510],{"type":395,"tag":447,"props":2499,"children":2500},{"style":793},[2501],{"type":400,"value":813},{"type":395,"tag":447,"props":2503,"children":2504},{"style":460},[2505],{"type":400,"value":818},{"type":395,"tag":447,"props":2507,"children":2508},{"style":821},[2509],{"type":400,"value":824},{"type":395,"tag":447,"props":2511,"children":2512},{"style":545},[2513],{"type":400,"value":829},{"type":395,"tag":447,"props":2515,"children":2516},{"class":449,"line":482},[2517,2521,2525,2529,2533,2537,2541,2545,2549,2553,2557,2561],{"type":395,"tag":447,"props":2518,"children":2519},{"style":844},[2520],{"type":400,"value":847},{"type":395,"tag":447,"props":2522,"children":2523},{"style":545},[2524],{"type":400,"value":852},{"type":395,"tag":447,"props":2526,"children":2527},{"style":454},[2528],{"type":400,"value":857},{"type":395,"tag":447,"props":2530,"children":2531},{"style":821},[2532],{"type":400,"value":824},{"type":395,"tag":447,"props":2534,"children":2535},{"style":793},[2536],{"type":400,"value":866},{"type":395,"tag":447,"props":2538,"children":2539},{"style":454},[2540],{"type":400,"value":871},{"type":395,"tag":447,"props":2542,"children":2543},{"style":545},[2544],{"type":400,"value":463},{"type":395,"tag":447,"props":2546,"children":2547},{"style":878},[2548],{"type":400,"value":881},{"type":395,"tag":447,"props":2550,"children":2551},{"style":545},[2552],{"type":400,"value":548},{"type":395,"tag":447,"props":2554,"children":2555},{"style":878},[2556],{"type":400,"value":890},{"type":395,"tag":447,"props":2558,"children":2559},{"style":545},[2560],{"type":400,"value":895},{"type":395,"tag":447,"props":2562,"children":2563},{"style":545},[2564],{"type":400,"value":553},{"type":395,"tag":447,"props":2566,"children":2567},{"class":449,"line":491},[2568,2572,2576,2580,2584,2588,2592,2596,2600,2604],{"type":395,"tag":447,"props":2569,"children":2570},{"style":1380},[2571],{"type":400,"value":1804},{"type":395,"tag":447,"props":2573,"children":2574},{"style":821},[2575],{"type":400,"value":937},{"type":395,"tag":447,"props":2577,"children":2578},{"style":466},[2579],{"type":400,"value":942},{"type":395,"tag":447,"props":2581,"children":2582},{"style":945},[2583],{"type":400,"value":948},{"type":395,"tag":447,"props":2585,"children":2586},{"style":466},[2587],{"type":400,"value":942},{"type":395,"tag":447,"props":2589,"children":2590},{"style":545},[2591],{"type":400,"value":852},{"type":395,"tag":447,"props":2593,"children":2594},{"style":454},[2595],{"type":400,"value":961},{"type":395,"tag":447,"props":2597,"children":2598},{"style":560},[2599],{"type":400,"value":463},{"type":395,"tag":447,"props":2601,"children":2602},{"style":460},[2603],{"type":400,"value":881},{"type":395,"tag":447,"props":2605,"children":2606},{"style":560},[2607],{"type":400,"value":612},{"type":395,"tag":447,"props":2609,"children":2610},{"class":449,"line":500},[2611,2615],{"type":395,"tag":447,"props":2612,"children":2613},{"style":821},[2614],{"type":400,"value":981},{"type":395,"tag":447,"props":2616,"children":2617},{"style":639},[2618],{"type":400,"value":2619}," // 缓存会将读取脚本内容到模板解析这个过程的解析结果缓存下来\n",{"type":395,"tag":447,"props":2621,"children":2622},{"class":449,"line":509},[2623,2628,2632,2636,2640,2644],{"type":395,"tag":447,"props":2624,"children":2625},{"style":560},[2626],{"type":400,"value":2627},"        (",{"type":395,"tag":447,"props":2629,"children":2630},{"style":460},[2631],{"type":400,"value":991},{"type":395,"tag":447,"props":2633,"children":2634},{"style":560},[2635],{"type":400,"value":996},{"type":395,"tag":447,"props":2637,"children":2638},{"style":460},[2639],{"type":400,"value":881},{"type":395,"tag":447,"props":2641,"children":2642},{"style":560},[2643],{"type":400,"value":1005},{"type":395,"tag":447,"props":2645,"children":2646},{"style":821},[2647],{"type":400,"value":1010},{"type":395,"tag":447,"props":2649,"children":2650},{"class":449,"line":518},[2651,2655,2659,2663,2667],{"type":395,"tag":447,"props":2652,"children":2653},{"style":460},[2654],{"type":400,"value":1018},{"type":395,"tag":447,"props":2656,"children":2657},{"style":560},[2658],{"type":400,"value":996},{"type":395,"tag":447,"props":2660,"children":2661},{"style":460},[2662],{"type":400,"value":881},{"type":395,"tag":447,"props":2664,"children":2665},{"style":560},[2666],{"type":400,"value":1005},{"type":395,"tag":447,"props":2668,"children":2669},{"style":821},[2670],{"type":400,"value":2671},"||\n",{"type":395,"tag":447,"props":2673,"children":2674},{"class":449,"line":527},[2675],{"type":395,"tag":447,"props":2676,"children":2677},{"style":639},[2678],{"type":400,"value":2679},"          // 读取脚本内容\n",{"type":395,"tag":447,"props":2681,"children":2682},{"class":449,"line":536},[2683,2688,2692,2696,2700,2704,2708,2712,2716,2720,2724],{"type":395,"tag":447,"props":2684,"children":2685},{"style":454},[2686],{"type":400,"value":2687},"          tmpl",{"type":395,"tag":447,"props":2689,"children":2690},{"style":560},[2691],{"type":400,"value":463},{"type":395,"tag":447,"props":2693,"children":2694},{"style":460},[2695],{"type":400,"value":1048},{"type":395,"tag":447,"props":2697,"children":2698},{"style":545},[2699],{"type":400,"value":852},{"type":395,"tag":447,"props":2701,"children":2702},{"style":454},[2703],{"type":400,"value":1057},{"type":395,"tag":447,"props":2705,"children":2706},{"style":560},[2707],{"type":400,"value":463},{"type":395,"tag":447,"props":2709,"children":2710},{"style":460},[2711],{"type":400,"value":881},{"type":395,"tag":447,"props":2713,"children":2714},{"style":560},[2715],{"type":400,"value":895},{"type":395,"tag":447,"props":2717,"children":2718},{"style":545},[2719],{"type":400,"value":852},{"type":395,"tag":447,"props":2721,"children":2722},{"style":460},[2723],{"type":400,"value":1078},{"type":395,"tag":447,"props":2725,"children":2726},{"style":560},[2727],{"type":400,"value":1083},{"type":395,"tag":447,"props":2729,"children":2730},{"class":449,"line":556},[2731,2735,2740,2744,2749],{"type":395,"tag":447,"props":2732,"children":2733},{"style":821},[2734],{"type":400,"value":1091},{"type":395,"tag":447,"props":2736,"children":2737},{"style":821},[2738],{"type":400,"value":2739}," new",{"type":395,"tag":447,"props":2741,"children":2742},{"style":454},[2743],{"type":400,"value":1119},{"type":395,"tag":447,"props":2745,"children":2746},{"style":560},[2747],{"type":400,"value":2748},"()",{"type":395,"tag":447,"props":2750,"children":2751},{"style":545},[2752],{"type":400,"value":1778},{"type":395,"tag":447,"props":2754,"children":2755},{"class":449,"line":582},[2756],{"type":395,"tag":447,"props":2757,"children":2758},{"style":545},[2759],{"type":400,"value":1851},{"type":395,"tag":447,"props":2761,"children":2762},{"class":449,"line":601},[2763,2767,2771],{"type":395,"tag":447,"props":2764,"children":2765},{"style":545},[2766],{"type":400,"value":607},{"type":395,"tag":447,"props":2768,"children":2769},{"style":460},[2770],{"type":400,"value":1864},{"type":395,"tag":447,"props":2772,"children":2773},{"style":545},[2774],{"type":400,"value":1778},{"type":395,"tag":396,"props":2776,"children":2777},{},[2778,2784],{"type":395,"tag":411,"props":2779,"children":2781},{"className":2780},[],[2782],{"type":400,"value":2783},"new Function()",{"type":400,"value":2785}," 即模板解析的核心内容，原理是用一个数组，保存所有解析内容，再拼接回字符串，作为 JS 执行。类似 eval 函数。",{"type":395,"tag":437,"props":2787,"children":2789},{"className":439,"code":2788,"language":441,"meta":389,"style":389},"new Function(\n  \"obj\",\n  \"var p=[];\" +\n    // + '...'\n    \"return p.join('')\"\n);\n",[2790],{"type":395,"tag":411,"props":2791,"children":2792},{"__ignoreMap":389},[2793,2809,2829,2849,2857,2874],{"type":395,"tag":447,"props":2794,"children":2795},{"class":449,"line":450},[2796,2801,2805],{"type":395,"tag":447,"props":2797,"children":2798},{"style":821},[2799],{"type":400,"value":2800},"new",{"type":395,"tag":447,"props":2802,"children":2803},{"style":454},[2804],{"type":400,"value":1119},{"type":395,"tag":447,"props":2806,"children":2807},{"style":460},[2808],{"type":400,"value":1124},{"type":395,"tag":447,"props":2810,"children":2811},{"class":449,"line":472},[2812,2817,2821,2825],{"type":395,"tag":447,"props":2813,"children":2814},{"style":466},[2815],{"type":400,"value":2816},"  \"",{"type":395,"tag":447,"props":2818,"children":2819},{"style":476},[2820],{"type":400,"value":1138},{"type":395,"tag":447,"props":2822,"children":2823},{"style":466},[2824],{"type":400,"value":1143},{"type":395,"tag":447,"props":2826,"children":2827},{"style":545},[2828],{"type":400,"value":579},{"type":395,"tag":447,"props":2830,"children":2831},{"class":449,"line":482},[2832,2836,2841,2845],{"type":395,"tag":447,"props":2833,"children":2834},{"style":466},[2835],{"type":400,"value":2816},{"type":395,"tag":447,"props":2837,"children":2838},{"style":476},[2839],{"type":400,"value":2840},"var p=[];",{"type":395,"tag":447,"props":2842,"children":2843},{"style":466},[2844],{"type":400,"value":1143},{"type":395,"tag":447,"props":2846,"children":2847},{"style":821},[2848],{"type":400,"value":1169},{"type":395,"tag":447,"props":2850,"children":2851},{"class":449,"line":491},[2852],{"type":395,"tag":447,"props":2853,"children":2854},{"style":639},[2855],{"type":400,"value":2856},"    // + '...'\n",{"type":395,"tag":447,"props":2858,"children":2859},{"class":449,"line":500},[2860,2865,2870],{"type":395,"tag":447,"props":2861,"children":2862},{"style":466},[2863],{"type":400,"value":2864},"    \"",{"type":395,"tag":447,"props":2866,"children":2867},{"style":476},[2868],{"type":400,"value":2869},"return p.join('')",{"type":395,"tag":447,"props":2871,"children":2872},{"style":466},[2873],{"type":400,"value":1764},{"type":395,"tag":447,"props":2875,"children":2876},{"class":449,"line":509},[2877,2881],{"type":395,"tag":447,"props":2878,"children":2879},{"style":460},[2880],{"type":400,"value":895},{"type":395,"tag":447,"props":2882,"children":2883},{"style":545},[2884],{"type":400,"value":1778},{"type":395,"tag":396,"props":2886,"children":2887},{},[2888,2890,2896],{"type":400,"value":2889},"要解析什么内容呢？无非是 ",{"type":395,"tag":411,"props":2891,"children":2893},{"className":2892},[],[2894],{"type":400,"value":2895},"\u003C%=hello%>",{"type":400,"value":2897}," 这种模板字符串。执行过程中，通过 with 语句，将内部变量的求值（hello）转移到参数对象（data.hello）。这个玩意儿在 VueJS 的模板编译中也用到过：",{"type":395,"tag":437,"props":2899,"children":2901},{"className":439,"code":2900,"language":441,"meta":389,"style":389},"/* VueJS */\nwith (vm) {\n  return createVNode(\"p\", { attrs: { hi: hello /* vm.hello */ } }, [\n    createTextNode(\"Hello World\"),\n  ]);\n}\n",[2902],{"type":395,"tag":411,"props":2903,"children":2904},{"__ignoreMap":389},[2905,2913,2931,3016,3049,3061],{"type":395,"tag":447,"props":2906,"children":2907},{"class":449,"line":450},[2908],{"type":395,"tag":447,"props":2909,"children":2910},{"style":639},[2911],{"type":400,"value":2912},"/* VueJS */\n",{"type":395,"tag":447,"props":2914,"children":2915},{"class":449,"line":472},[2916,2921,2926],{"type":395,"tag":447,"props":2917,"children":2918},{"style":1380},[2919],{"type":400,"value":2920},"with",{"type":395,"tag":447,"props":2922,"children":2923},{"style":460},[2924],{"type":400,"value":2925}," (vm) ",{"type":395,"tag":447,"props":2927,"children":2928},{"style":545},[2929],{"type":400,"value":2930},"{\n",{"type":395,"tag":447,"props":2932,"children":2933},{"class":449,"line":482},[2934,2939,2944,2948,2952,2956,2960,2964,2969,2974,2978,2982,2987,2991,2996,3001,3006,3011],{"type":395,"tag":447,"props":2935,"children":2936},{"style":1380},[2937],{"type":400,"value":2938},"  return",{"type":395,"tag":447,"props":2940,"children":2941},{"style":454},[2942],{"type":400,"value":2943}," createVNode",{"type":395,"tag":447,"props":2945,"children":2946},{"style":560},[2947],{"type":400,"value":463},{"type":395,"tag":447,"props":2949,"children":2950},{"style":466},[2951],{"type":400,"value":1143},{"type":395,"tag":447,"props":2953,"children":2954},{"style":476},[2955],{"type":400,"value":396},{"type":395,"tag":447,"props":2957,"children":2958},{"style":466},[2959],{"type":400,"value":1143},{"type":395,"tag":447,"props":2961,"children":2962},{"style":545},[2963],{"type":400,"value":548},{"type":395,"tag":447,"props":2965,"children":2966},{"style":545},[2967],{"type":400,"value":2968}," {",{"type":395,"tag":447,"props":2970,"children":2971},{"style":560},[2972],{"type":400,"value":2973}," attrs",{"type":395,"tag":447,"props":2975,"children":2976},{"style":545},[2977],{"type":400,"value":568},{"type":395,"tag":447,"props":2979,"children":2980},{"style":545},[2981],{"type":400,"value":2968},{"type":395,"tag":447,"props":2983,"children":2984},{"style":560},[2985],{"type":400,"value":2986}," hi",{"type":395,"tag":447,"props":2988,"children":2989},{"style":545},[2990],{"type":400,"value":568},{"type":395,"tag":447,"props":2992,"children":2993},{"style":460},[2994],{"type":400,"value":2995}," hello",{"type":395,"tag":447,"props":2997,"children":2998},{"style":639},[2999],{"type":400,"value":3000}," /* vm.hello */",{"type":395,"tag":447,"props":3002,"children":3003},{"style":545},[3004],{"type":400,"value":3005}," }",{"type":395,"tag":447,"props":3007,"children":3008},{"style":545},[3009],{"type":400,"value":3010}," },",{"type":395,"tag":447,"props":3012,"children":3013},{"style":560},[3014],{"type":400,"value":3015}," [\n",{"type":395,"tag":447,"props":3017,"children":3018},{"class":449,"line":491},[3019,3024,3028,3032,3037,3041,3045],{"type":395,"tag":447,"props":3020,"children":3021},{"style":454},[3022],{"type":400,"value":3023},"    createTextNode",{"type":395,"tag":447,"props":3025,"children":3026},{"style":560},[3027],{"type":400,"value":463},{"type":395,"tag":447,"props":3029,"children":3030},{"style":466},[3031],{"type":400,"value":1143},{"type":395,"tag":447,"props":3033,"children":3034},{"style":476},[3035],{"type":400,"value":3036},"Hello World",{"type":395,"tag":447,"props":3038,"children":3039},{"style":466},[3040],{"type":400,"value":1143},{"type":395,"tag":447,"props":3042,"children":3043},{"style":560},[3044],{"type":400,"value":895},{"type":395,"tag":447,"props":3046,"children":3047},{"style":545},[3048],{"type":400,"value":579},{"type":395,"tag":447,"props":3050,"children":3051},{"class":449,"line":500},[3052,3057],{"type":395,"tag":447,"props":3053,"children":3054},{"style":560},[3055],{"type":400,"value":3056},"  ])",{"type":395,"tag":447,"props":3058,"children":3059},{"style":545},[3060],{"type":400,"value":1778},{"type":395,"tag":447,"props":3062,"children":3063},{"class":449,"line":509},[3064],{"type":395,"tag":447,"props":3065,"children":3066},{"style":545},[3067],{"type":400,"value":3068},"}\n",{"type":395,"tag":396,"props":3070,"children":3071},{},[3072],{"type":400,"value":3073},"那如何解析呢？",{"type":395,"tag":396,"props":3075,"children":3076},{},[3077,3083,3085,3091],{"type":395,"tag":3078,"props":3079,"children":3080},"del",{},[3081],{"type":400,"value":3082},"我们知道",{"type":400,"value":3084},"曾写过经典字符串模板的佬应该知道，",{"type":395,"tag":3086,"props":3087,"children":3088},"strong",{},[3089],{"type":400,"value":3090},"模板字符串一般包含：字符串、变量及逻辑",{"type":400,"value":3092},"。",{"type":395,"tag":3094,"props":3095,"children":3096},"ul",{},[3097,3109,3120],{"type":395,"tag":3098,"props":3099,"children":3100},"li",{},[3101,3103],{"type":400,"value":3102},"字符串 ",{"type":395,"tag":411,"props":3104,"children":3106},{"className":3105},[],[3107],{"type":400,"value":3108},"\u003Chtml>Lionad\u003C/html>",{"type":395,"tag":3098,"props":3110,"children":3111},{},[3112,3114],{"type":400,"value":3113},"带变量 ",{"type":395,"tag":411,"props":3115,"children":3117},{"className":3116},[],[3118],{"type":400,"value":3119},"\u003Chtml>\u003C%=name%>\u003C/html>",{"type":395,"tag":3098,"props":3121,"children":3122},{},[3123,3125,3131],{"type":400,"value":3124},"带逻辑 ",{"type":395,"tag":411,"props":3126,"children":3128},{"className":3127},[],[3129],{"type":400,"value":3130},"\u003C% if(name){ %>\u003Chtml>\u003C%=name%>\u003C/html>\u003C% } %>",{"type":400,"value":3092},{"type":395,"tag":396,"props":3133,"children":3134},{},[3135],{"type":400,"value":3136},"所以解析模板，无非就是把这三种字符串替换成纯粹的 JS 逻辑，作为 new Function 的参数。其中所有中间变量，可以用一个数组来储存：",{"type":395,"tag":3094,"props":3138,"children":3139},{},[3140,3159,3177],{"type":395,"tag":3098,"props":3141,"children":3142},{},[3143,3145,3150,3152,3158],{"type":400,"value":3144},"将普通字符串直接推入作为结果的内容数组，比如 ",{"type":395,"tag":411,"props":3146,"children":3148},{"className":3147},[],[3149],{"type":400,"value":3108},{"type":400,"value":3151}," 应该被解析为 ",{"type":395,"tag":411,"props":3153,"children":3155},{"className":3154},[],[3156],{"type":400,"value":3157},"p.push('\u003Chtml>Lionad\u003C/html>')",{"type":400,"value":3092},{"type":395,"tag":3098,"props":3160,"children":3161},{},[3162,3164,3169,3170,3176],{"type":400,"value":3163},"如果碰到变量，则将变量拆分出来推入数组，如 ",{"type":395,"tag":411,"props":3165,"children":3167},{"className":3166},[],[3168],{"type":400,"value":3119},{"type":400,"value":3151},{"type":395,"tag":411,"props":3171,"children":3173},{"className":3172},[],[3174],{"type":400,"value":3175},"p.push('\u003Chtml>');p.push(name);p.push('\u003C/html>')",{"type":400,"value":3092},{"type":395,"tag":3098,"props":3178,"children":3179},{},[3180,3182,3188,3190,3195,3197,3203],{"type":400,"value":3181},"带逻辑的字符串，由于逻辑本身就是 JS 代码，所以不需要解析为字符串，只需要把两侧的 ",{"type":395,"tag":411,"props":3183,"children":3185},{"className":3184},[],[3186],{"type":400,"value":3187},"\u003C% %>",{"type":400,"value":3189}," 这种模板标志去掉就好了。如 ",{"type":395,"tag":411,"props":3191,"children":3193},{"className":3192},[],[3194],{"type":400,"value":3130},{"type":400,"value":3196}," 应该被解析为：",{"type":395,"tag":411,"props":3198,"children":3200},{"className":3199},[],[3201],{"type":400,"value":3202},"if(name){ p.push('\u003Chtml>');p.push(name);p.push('\u003C/html>') } ",{"type":400,"value":3092},{"type":395,"tag":396,"props":3205,"children":3206},{},[3207],{"type":400,"value":3208},"以下面这段模板为例，我们看看字符串具体的替换规则。",{"type":395,"tag":437,"props":3210,"children":3212},{"className":439,"code":3211,"language":441,"meta":389,"style":389},"str = `\u003C% if (true) { %>\n    \u003Cli>\u003C%=users[i]%>\u003C/li>\n\u003C% } %>`;\n",[3213],{"type":395,"tag":411,"props":3214,"children":3215},{"__ignoreMap":389},[3216,3238,3246],{"type":395,"tag":447,"props":3217,"children":3218},{"class":449,"line":450},[3219,3224,3228,3233],{"type":395,"tag":447,"props":3220,"children":3221},{"style":460},[3222],{"type":400,"value":3223},"str ",{"type":395,"tag":447,"props":3225,"children":3226},{"style":821},[3227],{"type":400,"value":1491},{"type":395,"tag":447,"props":3229,"children":3230},{"style":466},[3231],{"type":400,"value":3232}," `",{"type":395,"tag":447,"props":3234,"children":3235},{"style":476},[3236],{"type":400,"value":3237},"\u003C% if (true) { %>\n",{"type":395,"tag":447,"props":3239,"children":3240},{"class":449,"line":472},[3241],{"type":395,"tag":447,"props":3242,"children":3243},{"style":476},[3244],{"type":400,"value":3245},"    \u003Cli>\u003C%=users[i]%>\u003C/li>\n",{"type":395,"tag":447,"props":3247,"children":3248},{"class":449,"line":482},[3249,3254,3258],{"type":395,"tag":447,"props":3250,"children":3251},{"style":476},[3252],{"type":400,"value":3253},"\u003C% } %>",{"type":395,"tag":447,"props":3255,"children":3256},{"style":466},[3257],{"type":400,"value":542},{"type":395,"tag":447,"props":3259,"children":3260},{"style":545},[3261],{"type":400,"value":1778},{"type":395,"tag":437,"props":3263,"children":3265},{"className":439,"code":3264,"language":441,"meta":389,"style":389},"// with 的使用方法都知道了，with(obj = { a })，那么\n// 就能在内部直接读取 a，不需要写 obj.a\n\"with(obj){p.push('\" +\n  str\n    // 将换行等空白字符转换为空格，这样所有代码都在一行了\n    // '\u003C% if (true) { %>     \u003Cli>\u003C%=users[i]%>\u003C/li> \u003C% } %>'\n    .replace(/[\\r\\t\\n]/g, \" \")\n    // ['', 'if (true) { %>\u003Cli>', '=users[i]%>\u003C/li>', ' } %>']\n    .split(\"\u003C%\")\n    // 因为 \\t 刚才已经被替换成空格了，所以这里可以使用 \\t 用来将不同行的代码字符串“相加”，\n    // 一会儿再拆分时，不会和原先字符串里的字符混淆\n    .join(\"\\t\")\n    // 去掉模板标志两端的引号，在这个例子里不会用到\n    .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\n    // 以下三句最重要，将所有变量推入数组，生成结果形如 `push('xxx',x,'xxx')` 的字符串\n    // 首先，刚才匹配完了 \u003C%，所以 \\t= 开头后边接的就是变量，这里让它转换成 ',x,' 的形式\n    .replace(/\\t=(.*?)%>/g, \"',$1,'\")\n    .split(\"\\t\")\n    // 在刚刚跟 split('\u003C%') 的位置用括号还原，得到了 ',x,'xxx'); 的形式\n    .join(\"');\")\n    // 在 \\t=xxx 那次匹配，已经把变量模板对应的结束标志 %> 匹配完了，\n    // 所以这是处理剩余语句的结束标志，用 split 拆分行后相当于直接把结束标记舍弃了\n    .split(\"%>\")\n    // 最终在每行开头增加 push 方法，形成了 push('xxx',x,'xxx'); 的形式\n    .join(\"p.push('\")\n    // 处理剩余的换行符\n    .split(\"\\r\")\n    .join(\"\\\\'\") +\n  \"');}\";\n",[3266],{"type":395,"tag":411,"props":3267,"children":3268},{"__ignoreMap":389},[3269,3277,3285,3304,3312,3320,3328,3384,3392,3423,3431,3439,3470,3478,3577,3585,3593,3668,3699,3707,3738,3746,3754,3785,3793,3824,3832,3863,3902],{"type":395,"tag":447,"props":3270,"children":3271},{"class":449,"line":450},[3272],{"type":395,"tag":447,"props":3273,"children":3274},{"style":639},[3275],{"type":400,"value":3276},"// with 的使用方法都知道了，with(obj = { a })，那么\n",{"type":395,"tag":447,"props":3278,"children":3279},{"class":449,"line":472},[3280],{"type":395,"tag":447,"props":3281,"children":3282},{"style":639},[3283],{"type":400,"value":3284},"// 就能在内部直接读取 a，不需要写 obj.a\n",{"type":395,"tag":447,"props":3286,"children":3287},{"class":449,"line":482},[3288,3292,3296,3300],{"type":395,"tag":447,"props":3289,"children":3290},{"style":466},[3291],{"type":400,"value":1143},{"type":395,"tag":447,"props":3293,"children":3294},{"style":476},[3295],{"type":400,"value":1192},{"type":395,"tag":447,"props":3297,"children":3298},{"style":466},[3299],{"type":400,"value":1143},{"type":395,"tag":447,"props":3301,"children":3302},{"style":821},[3303],{"type":400,"value":1169},{"type":395,"tag":447,"props":3305,"children":3306},{"class":449,"line":491},[3307],{"type":395,"tag":447,"props":3308,"children":3309},{"style":460},[3310],{"type":400,"value":3311},"  str\n",{"type":395,"tag":447,"props":3313,"children":3314},{"class":449,"line":500},[3315],{"type":395,"tag":447,"props":3316,"children":3317},{"style":639},[3318],{"type":400,"value":3319},"    // 将换行等空白字符转换为空格，这样所有代码都在一行了\n",{"type":395,"tag":447,"props":3321,"children":3322},{"class":449,"line":509},[3323],{"type":395,"tag":447,"props":3324,"children":3325},{"style":639},[3326],{"type":400,"value":3327},"    // '\u003C% if (true) { %>     \u003Cli>\u003C%=users[i]%>\u003C/li> \u003C% } %>'\n",{"type":395,"tag":447,"props":3329,"children":3330},{"class":449,"line":518},[3331,3336,3340,3344,3348,3352,3356,3360,3364,3368,3372,3376,3380],{"type":395,"tag":447,"props":3332,"children":3333},{"style":545},[3334],{"type":400,"value":3335},"    .",{"type":395,"tag":447,"props":3337,"children":3338},{"style":454},[3339],{"type":400,"value":1232},{"type":395,"tag":447,"props":3341,"children":3342},{"style":460},[3343],{"type":400,"value":463},{"type":395,"tag":447,"props":3345,"children":3346},{"style":466},[3347],{"type":400,"value":942},{"type":395,"tag":447,"props":3349,"children":3350},{"style":1243},[3351],{"type":400,"value":996},{"type":395,"tag":447,"props":3353,"children":3354},{"style":945},[3355],{"type":400,"value":1250},{"type":395,"tag":447,"props":3357,"children":3358},{"style":1243},[3359],{"type":400,"value":1255},{"type":395,"tag":447,"props":3361,"children":3362},{"style":466},[3363],{"type":400,"value":942},{"type":395,"tag":447,"props":3365,"children":3366},{"style":1262},[3367],{"type":400,"value":1265},{"type":395,"tag":447,"props":3369,"children":3370},{"style":545},[3371],{"type":400,"value":548},{"type":395,"tag":447,"props":3373,"children":3374},{"style":466},[3375],{"type":400,"value":1274},{"type":395,"tag":447,"props":3377,"children":3378},{"style":466},[3379],{"type":400,"value":1274},{"type":395,"tag":447,"props":3381,"children":3382},{"style":460},[3383],{"type":400,"value":612},{"type":395,"tag":447,"props":3385,"children":3386},{"class":449,"line":527},[3387],{"type":395,"tag":447,"props":3388,"children":3389},{"style":639},[3390],{"type":400,"value":3391},"    // ['', 'if (true) { %>\u003Cli>', '=users[i]%>\u003C/li>', ' } %>']\n",{"type":395,"tag":447,"props":3393,"children":3394},{"class":449,"line":536},[3395,3399,3403,3407,3411,3415,3419],{"type":395,"tag":447,"props":3396,"children":3397},{"style":545},[3398],{"type":400,"value":3335},{"type":395,"tag":447,"props":3400,"children":3401},{"style":454},[3402],{"type":400,"value":1295},{"type":395,"tag":447,"props":3404,"children":3405},{"style":460},[3406],{"type":400,"value":463},{"type":395,"tag":447,"props":3408,"children":3409},{"style":466},[3410],{"type":400,"value":1143},{"type":395,"tag":447,"props":3412,"children":3413},{"style":476},[3414],{"type":400,"value":1308},{"type":395,"tag":447,"props":3416,"children":3417},{"style":466},[3418],{"type":400,"value":1143},{"type":395,"tag":447,"props":3420,"children":3421},{"style":460},[3422],{"type":400,"value":612},{"type":395,"tag":447,"props":3424,"children":3425},{"class":449,"line":556},[3426],{"type":395,"tag":447,"props":3427,"children":3428},{"style":639},[3429],{"type":400,"value":3430},"    // 因为 \\t 刚才已经被替换成空格了，所以这里可以使用 \\t 用来将不同行的代码字符串“相加”，\n",{"type":395,"tag":447,"props":3432,"children":3433},{"class":449,"line":582},[3434],{"type":395,"tag":447,"props":3435,"children":3436},{"style":639},[3437],{"type":400,"value":3438},"    // 一会儿再拆分时，不会和原先字符串里的字符混淆\n",{"type":395,"tag":447,"props":3440,"children":3441},{"class":449,"line":601},[3442,3446,3450,3454,3458,3462,3466],{"type":395,"tag":447,"props":3443,"children":3444},{"style":545},[3445],{"type":400,"value":3335},{"type":395,"tag":447,"props":3447,"children":3448},{"style":454},[3449],{"type":400,"value":1329},{"type":395,"tag":447,"props":3451,"children":3452},{"style":460},[3453],{"type":400,"value":463},{"type":395,"tag":447,"props":3455,"children":3456},{"style":466},[3457],{"type":400,"value":1143},{"type":395,"tag":447,"props":3459,"children":3460},{"style":1340},[3461],{"type":400,"value":1343},{"type":395,"tag":447,"props":3463,"children":3464},{"style":466},[3465],{"type":400,"value":1143},{"type":395,"tag":447,"props":3467,"children":3468},{"style":460},[3469],{"type":400,"value":612},{"type":395,"tag":447,"props":3471,"children":3472},{"class":449,"line":1099},[3473],{"type":395,"tag":447,"props":3474,"children":3475},{"style":639},[3476],{"type":400,"value":3477},"    // 去掉模板标志两端的引号，在这个例子里不会用到\n",{"type":395,"tag":447,"props":3479,"children":3480},{"class":449,"line":1108},[3481,3485,3489,3493,3497,3501,3505,3509,3513,3517,3521,3525,3529,3533,3537,3541,3545,3549,3553,3557,3561,3565,3569,3573],{"type":395,"tag":447,"props":3482,"children":3483},{"style":545},[3484],{"type":400,"value":3335},{"type":395,"tag":447,"props":3486,"children":3487},{"style":454},[3488],{"type":400,"value":1232},{"type":395,"tag":447,"props":3490,"children":3491},{"style":460},[3492],{"type":400,"value":463},{"type":395,"tag":447,"props":3494,"children":3495},{"style":466},[3496],{"type":400,"value":942},{"type":395,"tag":447,"props":3498,"children":3499},{"style":1374},[3500],{"type":400,"value":1377},{"type":395,"tag":447,"props":3502,"children":3503},{"style":1380},[3504],{"type":400,"value":1383},{"type":395,"tag":447,"props":3506,"children":3507},{"style":821},[3508],{"type":400,"value":1388},{"type":395,"tag":447,"props":3510,"children":3511},{"style":1391},[3512],{"type":400,"value":1394},{"type":395,"tag":447,"props":3514,"children":3515},{"style":1374},[3516],{"type":400,"value":895},{"type":395,"tag":447,"props":3518,"children":3519},{"style":1243},[3520],{"type":400,"value":996},{"type":395,"tag":447,"props":3522,"children":3523},{"style":821},[3524],{"type":400,"value":1383},{"type":395,"tag":447,"props":3526,"children":3527},{"style":945},[3528],{"type":400,"value":1343},{"type":395,"tag":447,"props":3530,"children":3531},{"style":1243},[3532],{"type":400,"value":1255},{"type":395,"tag":447,"props":3534,"children":3535},{"style":821},[3536],{"type":400,"value":1419},{"type":395,"tag":447,"props":3538,"children":3539},{"style":1374},[3540],{"type":400,"value":895},{"type":395,"tag":447,"props":3542,"children":3543},{"style":1391},[3544],{"type":400,"value":1428},{"type":395,"tag":447,"props":3546,"children":3547},{"style":466},[3548],{"type":400,"value":942},{"type":395,"tag":447,"props":3550,"children":3551},{"style":1262},[3552],{"type":400,"value":1265},{"type":395,"tag":447,"props":3554,"children":3555},{"style":545},[3556],{"type":400,"value":548},{"type":395,"tag":447,"props":3558,"children":3559},{"style":466},[3560],{"type":400,"value":1274},{"type":395,"tag":447,"props":3562,"children":3563},{"style":476},[3564],{"type":400,"value":1449},{"type":395,"tag":447,"props":3566,"children":3567},{"style":1340},[3568],{"type":400,"value":1454},{"type":395,"tag":447,"props":3570,"children":3571},{"style":466},[3572],{"type":400,"value":1143},{"type":395,"tag":447,"props":3574,"children":3575},{"style":460},[3576],{"type":400,"value":612},{"type":395,"tag":447,"props":3578,"children":3579},{"class":449,"line":1127},[3580],{"type":395,"tag":447,"props":3581,"children":3582},{"style":639},[3583],{"type":400,"value":3584},"    // 以下三句最重要，将所有变量推入数组，生成结果形如 `push('xxx',x,'xxx')` 的字符串\n",{"type":395,"tag":447,"props":3586,"children":3587},{"class":449,"line":1150},[3588],{"type":395,"tag":447,"props":3589,"children":3590},{"style":639},[3591],{"type":400,"value":3592},"    // 首先，刚才匹配完了 \u003C%，所以 \\t= 开头后边接的就是变量，这里让它转换成 ',x,' 的形式\n",{"type":395,"tag":447,"props":3594,"children":3595},{"class":449,"line":1172},[3596,3600,3604,3608,3612,3616,3620,3624,3628,3632,3636,3640,3644,3648,3652,3656,3660,3664],{"type":395,"tag":447,"props":3597,"children":3598},{"style":545},[3599],{"type":400,"value":3335},{"type":395,"tag":447,"props":3601,"children":3602},{"style":454},[3603],{"type":400,"value":1232},{"type":395,"tag":447,"props":3605,"children":3606},{"style":460},[3607],{"type":400,"value":463},{"type":395,"tag":447,"props":3609,"children":3610},{"style":466},[3611],{"type":400,"value":942},{"type":395,"tag":447,"props":3613,"children":3614},{"style":945},[3615],{"type":400,"value":1343},{"type":395,"tag":447,"props":3617,"children":3618},{"style":1391},[3619],{"type":400,"value":1491},{"type":395,"tag":447,"props":3621,"children":3622},{"style":1374},[3623],{"type":400,"value":463},{"type":395,"tag":447,"props":3625,"children":3626},{"style":945},[3627],{"type":400,"value":852},{"type":395,"tag":447,"props":3629,"children":3630},{"style":821},[3631],{"type":400,"value":1504},{"type":395,"tag":447,"props":3633,"children":3634},{"style":1374},[3635],{"type":400,"value":895},{"type":395,"tag":447,"props":3637,"children":3638},{"style":1391},[3639],{"type":400,"value":1394},{"type":395,"tag":447,"props":3641,"children":3642},{"style":466},[3643],{"type":400,"value":942},{"type":395,"tag":447,"props":3645,"children":3646},{"style":1262},[3647],{"type":400,"value":1265},{"type":395,"tag":447,"props":3649,"children":3650},{"style":545},[3651],{"type":400,"value":548},{"type":395,"tag":447,"props":3653,"children":3654},{"style":466},[3655],{"type":400,"value":1274},{"type":395,"tag":447,"props":3657,"children":3658},{"style":476},[3659],{"type":400,"value":1533},{"type":395,"tag":447,"props":3661,"children":3662},{"style":466},[3663],{"type":400,"value":1143},{"type":395,"tag":447,"props":3665,"children":3666},{"style":460},[3667],{"type":400,"value":612},{"type":395,"tag":447,"props":3669,"children":3670},{"class":449,"line":1181},[3671,3675,3679,3683,3687,3691,3695],{"type":395,"tag":447,"props":3672,"children":3673},{"style":545},[3674],{"type":400,"value":3335},{"type":395,"tag":447,"props":3676,"children":3677},{"style":454},[3678],{"type":400,"value":1295},{"type":395,"tag":447,"props":3680,"children":3681},{"style":460},[3682],{"type":400,"value":463},{"type":395,"tag":447,"props":3684,"children":3685},{"style":466},[3686],{"type":400,"value":1143},{"type":395,"tag":447,"props":3688,"children":3689},{"style":1340},[3690],{"type":400,"value":1343},{"type":395,"tag":447,"props":3692,"children":3693},{"style":466},[3694],{"type":400,"value":1143},{"type":395,"tag":447,"props":3696,"children":3697},{"style":460},[3698],{"type":400,"value":612},{"type":395,"tag":447,"props":3700,"children":3701},{"class":449,"line":1203},[3702],{"type":395,"tag":447,"props":3703,"children":3704},{"style":639},[3705],{"type":400,"value":3706},"    // 在刚刚跟 split('\u003C%') 的位置用括号还原，得到了 ',x,'xxx'); 的形式\n",{"type":395,"tag":447,"props":3708,"children":3709},{"class":449,"line":1212},[3710,3714,3718,3722,3726,3730,3734],{"type":395,"tag":447,"props":3711,"children":3712},{"style":545},[3713],{"type":400,"value":3335},{"type":395,"tag":447,"props":3715,"children":3716},{"style":454},[3717],{"type":400,"value":1329},{"type":395,"tag":447,"props":3719,"children":3720},{"style":460},[3721],{"type":400,"value":463},{"type":395,"tag":447,"props":3723,"children":3724},{"style":466},[3725],{"type":400,"value":1143},{"type":395,"tag":447,"props":3727,"children":3728},{"style":476},[3729],{"type":400,"value":1598},{"type":395,"tag":447,"props":3731,"children":3732},{"style":466},[3733],{"type":400,"value":1143},{"type":395,"tag":447,"props":3735,"children":3736},{"style":460},[3737],{"type":400,"value":612},{"type":395,"tag":447,"props":3739,"children":3740},{"class":449,"line":1221},[3741],{"type":395,"tag":447,"props":3742,"children":3743},{"style":639},[3744],{"type":400,"value":3745},"    // 在 \\t=xxx 那次匹配，已经把变量模板对应的结束标志 %> 匹配完了，\n",{"type":395,"tag":447,"props":3747,"children":3748},{"class":449,"line":1285},[3749],{"type":395,"tag":447,"props":3750,"children":3751},{"style":639},[3752],{"type":400,"value":3753},"    // 所以这是处理剩余语句的结束标志，用 split 拆分行后相当于直接把结束标记舍弃了\n",{"type":395,"tag":447,"props":3755,"children":3756},{"class":449,"line":1319},[3757,3761,3765,3769,3773,3777,3781],{"type":395,"tag":447,"props":3758,"children":3759},{"style":545},[3760],{"type":400,"value":3335},{"type":395,"tag":447,"props":3762,"children":3763},{"style":454},[3764],{"type":400,"value":1295},{"type":395,"tag":447,"props":3766,"children":3767},{"style":460},[3768],{"type":400,"value":463},{"type":395,"tag":447,"props":3770,"children":3771},{"style":466},[3772],{"type":400,"value":1143},{"type":395,"tag":447,"props":3774,"children":3775},{"style":476},[3776],{"type":400,"value":1394},{"type":395,"tag":447,"props":3778,"children":3779},{"style":466},[3780],{"type":400,"value":1143},{"type":395,"tag":447,"props":3782,"children":3783},{"style":460},[3784],{"type":400,"value":612},{"type":395,"tag":447,"props":3786,"children":3787},{"class":449,"line":1354},[3788],{"type":395,"tag":447,"props":3789,"children":3790},{"style":639},[3791],{"type":400,"value":3792},"    // 最终在每行开头增加 push 方法，形成了 push('xxx',x,'xxx'); 的形式\n",{"type":395,"tag":447,"props":3794,"children":3795},{"class":449,"line":1465},[3796,3800,3804,3808,3812,3816,3820],{"type":395,"tag":447,"props":3797,"children":3798},{"style":545},[3799],{"type":400,"value":3335},{"type":395,"tag":447,"props":3801,"children":3802},{"style":454},[3803],{"type":400,"value":1329},{"type":395,"tag":447,"props":3805,"children":3806},{"style":460},[3807],{"type":400,"value":463},{"type":395,"tag":447,"props":3809,"children":3810},{"style":466},[3811],{"type":400,"value":1143},{"type":395,"tag":447,"props":3813,"children":3814},{"style":476},[3815],{"type":400,"value":1663},{"type":395,"tag":447,"props":3817,"children":3818},{"style":466},[3819],{"type":400,"value":1143},{"type":395,"tag":447,"props":3821,"children":3822},{"style":460},[3823],{"type":400,"value":612},{"type":395,"tag":447,"props":3825,"children":3826},{"class":449,"line":1544},[3827],{"type":395,"tag":447,"props":3828,"children":3829},{"style":639},[3830],{"type":400,"value":3831},"    // 处理剩余的换行符\n",{"type":395,"tag":447,"props":3833,"children":3834},{"class":449,"line":1576},[3835,3839,3843,3847,3851,3855,3859],{"type":395,"tag":447,"props":3836,"children":3837},{"style":545},[3838],{"type":400,"value":3335},{"type":395,"tag":447,"props":3840,"children":3841},{"style":454},[3842],{"type":400,"value":1295},{"type":395,"tag":447,"props":3844,"children":3845},{"style":460},[3846],{"type":400,"value":463},{"type":395,"tag":447,"props":3848,"children":3849},{"style":466},[3850],{"type":400,"value":1143},{"type":395,"tag":447,"props":3852,"children":3853},{"style":1340},[3854],{"type":400,"value":1454},{"type":395,"tag":447,"props":3856,"children":3857},{"style":466},[3858],{"type":400,"value":1143},{"type":395,"tag":447,"props":3860,"children":3861},{"style":460},[3862],{"type":400,"value":612},{"type":395,"tag":447,"props":3864,"children":3865},{"class":449,"line":1609},[3866,3870,3874,3878,3882,3886,3890,3894,3898],{"type":395,"tag":447,"props":3867,"children":3868},{"style":545},[3869],{"type":400,"value":3335},{"type":395,"tag":447,"props":3871,"children":3872},{"style":454},[3873],{"type":400,"value":1329},{"type":395,"tag":447,"props":3875,"children":3876},{"style":460},[3877],{"type":400,"value":463},{"type":395,"tag":447,"props":3879,"children":3880},{"style":466},[3881],{"type":400,"value":1143},{"type":395,"tag":447,"props":3883,"children":3884},{"style":1340},[3885],{"type":400,"value":1728},{"type":395,"tag":447,"props":3887,"children":3888},{"style":476},[3889],{"type":400,"value":1428},{"type":395,"tag":447,"props":3891,"children":3892},{"style":466},[3893],{"type":400,"value":1143},{"type":395,"tag":447,"props":3895,"children":3896},{"style":460},[3897],{"type":400,"value":1741},{"type":395,"tag":447,"props":3899,"children":3900},{"style":821},[3901],{"type":400,"value":1746},{"type":395,"tag":447,"props":3903,"children":3904},{"class":449,"line":1641},[3905,3909,3914,3918],{"type":395,"tag":447,"props":3906,"children":3907},{"style":466},[3908],{"type":400,"value":2816},{"type":395,"tag":447,"props":3910,"children":3911},{"style":476},[3912],{"type":400,"value":3913},"');}",{"type":395,"tag":447,"props":3915,"children":3916},{"style":466},[3917],{"type":400,"value":1143},{"type":395,"tag":447,"props":3919,"children":3920},{"style":545},[3921],{"type":400,"value":1778},{"type":395,"tag":396,"props":3923,"children":3924},{},[3925,3927,3932,3934,3939,3941,3946,3947,3953,3955,3960,3962,3967],{"type":400,"value":3926},"有一个小细节，字符串替换时，所有逻辑语句的模板标志开头和结尾（",{"type":395,"tag":411,"props":3928,"children":3930},{"className":3929},[],[3931],{"type":400,"value":1308},{"type":400,"value":3933},"、",{"type":395,"tag":411,"props":3935,"children":3937},{"className":3936},[],[3938],{"type":400,"value":1394},{"type":400,"value":3940},"）分别被替换为 ",{"type":395,"tag":411,"props":3942,"children":3944},{"className":3943},[],[3945],{"type":400,"value":1598},{"type":400,"value":3933},{"type":395,"tag":411,"props":3948,"children":3950},{"className":3949},[],[3951],{"type":400,"value":3952},"push('",{"type":400,"value":3954},"，但是开头和结尾的那个标志，并没有对应的匹配。所以在代码中，能看 ",{"type":395,"tag":411,"props":3956,"children":3958},{"className":3957},[],[3959],{"type":400,"value":1192},{"type":400,"value":3961}," 和 ",{"type":395,"tag":411,"props":3963,"children":3965},{"className":3964},[],[3966],{"type":400,"value":1598},{"type":400,"value":3968}," 这种手动补全。",{"type":395,"tag":396,"props":3970,"children":3971},{},[3972],{"type":400,"value":3973},"最终生成的字符串如下（已格式化处理）：",{"type":395,"tag":437,"props":3975,"children":3977},{"className":439,"code":3976,"language":441,"meta":389,"style":389},"`with(obj){\n    p.push(''); \n    if (true) { \n        p.push('     \u003Cli>',users[i],'\u003C/li>   '); \n    } \n    p.push('');\n}`;\n",[3978],{"type":395,"tag":411,"props":3979,"children":3980},{"__ignoreMap":389},[3981,3993,4001,4009,4017,4025,4033],{"type":395,"tag":447,"props":3982,"children":3983},{"class":449,"line":450},[3984,3988],{"type":395,"tag":447,"props":3985,"children":3986},{"style":466},[3987],{"type":400,"value":542},{"type":395,"tag":447,"props":3989,"children":3990},{"style":476},[3991],{"type":400,"value":3992},"with(obj){\n",{"type":395,"tag":447,"props":3994,"children":3995},{"class":449,"line":472},[3996],{"type":395,"tag":447,"props":3997,"children":3998},{"style":476},[3999],{"type":400,"value":4000},"    p.push(''); \n",{"type":395,"tag":447,"props":4002,"children":4003},{"class":449,"line":482},[4004],{"type":395,"tag":447,"props":4005,"children":4006},{"style":476},[4007],{"type":400,"value":4008},"    if (true) { \n",{"type":395,"tag":447,"props":4010,"children":4011},{"class":449,"line":491},[4012],{"type":395,"tag":447,"props":4013,"children":4014},{"style":476},[4015],{"type":400,"value":4016},"        p.push('     \u003Cli>',users[i],'\u003C/li>   '); \n",{"type":395,"tag":447,"props":4018,"children":4019},{"class":449,"line":500},[4020],{"type":395,"tag":447,"props":4021,"children":4022},{"style":476},[4023],{"type":400,"value":4024},"    } \n",{"type":395,"tag":447,"props":4026,"children":4027},{"class":449,"line":509},[4028],{"type":395,"tag":447,"props":4029,"children":4030},{"style":476},[4031],{"type":400,"value":4032},"    p.push('');\n",{"type":395,"tag":447,"props":4034,"children":4035},{"class":449,"line":518},[4036,4040,4044],{"type":395,"tag":447,"props":4037,"children":4038},{"style":476},[4039],{"type":400,"value":607},{"type":395,"tag":447,"props":4041,"children":4042},{"style":466},[4043],{"type":400,"value":542},{"type":395,"tag":447,"props":4045,"children":4046},{"style":545},[4047],{"type":400,"value":1778},{"type":395,"tag":396,"props":4049,"children":4050},{},[4051,4053,4059],{"type":400,"value":4052},"为什么 with 语句里有一行空的 ",{"type":395,"tag":411,"props":4054,"children":4056},{"className":4055},[],[4057],{"type":400,"value":4058},"push('')",{"type":400,"value":4060}," 呢？",{"type":395,"tag":396,"props":4062,"children":4063},{},[4064],{"type":400,"value":4065},"还记得原始的模板吗？一开的模板是以“\u003C%”开头的，而“\u003C%”在替换过程被右括号取代了，此时正好和初始字符串结合形成了空 push。如果原始字符串开头是 \"123\u003C% if (true)\"，那这行空 push 会转换成“p.push('123');”，也是正确的代码。",{"type":395,"tag":396,"props":4067,"children":4068},{},[4069],{"type":400,"value":4070},"最后，micro-templating 需要返回这个新函数。如果不传参数 data 给模板函数，则会返回一个部分应用的函数等待用户输入 data 参数再执行模板解析；如果已经传了 data 那就会立即调用返回模板解析的结果。",{"type":395,"tag":437,"props":4072,"children":4074},{"className":439,"code":4073,"language":441,"meta":389,"style":389},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {\n    return data ? fn(data) : fn;\n  };\n})();\n",[4075],{"type":395,"tag":411,"props":4076,"children":4077},{"__ignoreMap":389},[4078,4097,4116,4167,4210,4217],{"type":395,"tag":447,"props":4079,"children":4080},{"class":449,"line":450},[4081,4085,4089,4093],{"type":395,"tag":447,"props":4082,"children":4083},{"style":460},[4084],{"type":400,"value":463},{"type":395,"tag":447,"props":4086,"children":4087},{"style":793},[4088],{"type":400,"value":796},{"type":395,"tag":447,"props":4090,"children":4091},{"style":545},[4092],{"type":400,"value":801},{"type":395,"tag":447,"props":4094,"children":4095},{"style":545},[4096],{"type":400,"value":553},{"type":395,"tag":447,"props":4098,"children":4099},{"class":449,"line":472},[4100,4104,4108,4112],{"type":395,"tag":447,"props":4101,"children":4102},{"style":793},[4103],{"type":400,"value":813},{"type":395,"tag":447,"props":4105,"children":4106},{"style":460},[4107],{"type":400,"value":818},{"type":395,"tag":447,"props":4109,"children":4110},{"style":821},[4111],{"type":400,"value":824},{"type":395,"tag":447,"props":4113,"children":4114},{"style":545},[4115],{"type":400,"value":829},{"type":395,"tag":447,"props":4117,"children":4118},{"class":449,"line":482},[4119,4123,4127,4131,4135,4139,4143,4147,4151,4155,4159,4163],{"type":395,"tag":447,"props":4120,"children":4121},{"style":844},[4122],{"type":400,"value":847},{"type":395,"tag":447,"props":4124,"children":4125},{"style":545},[4126],{"type":400,"value":852},{"type":395,"tag":447,"props":4128,"children":4129},{"style":454},[4130],{"type":400,"value":857},{"type":395,"tag":447,"props":4132,"children":4133},{"style":821},[4134],{"type":400,"value":824},{"type":395,"tag":447,"props":4136,"children":4137},{"style":793},[4138],{"type":400,"value":866},{"type":395,"tag":447,"props":4140,"children":4141},{"style":454},[4142],{"type":400,"value":871},{"type":395,"tag":447,"props":4144,"children":4145},{"style":545},[4146],{"type":400,"value":463},{"type":395,"tag":447,"props":4148,"children":4149},{"style":878},[4150],{"type":400,"value":881},{"type":395,"tag":447,"props":4152,"children":4153},{"style":545},[4154],{"type":400,"value":548},{"type":395,"tag":447,"props":4156,"children":4157},{"style":878},[4158],{"type":400,"value":890},{"type":395,"tag":447,"props":4160,"children":4161},{"style":545},[4162],{"type":400,"value":895},{"type":395,"tag":447,"props":4164,"children":4165},{"style":545},[4166],{"type":400,"value":553},{"type":395,"tag":447,"props":4168,"children":4169},{"class":449,"line":491},[4170,4174,4178,4182,4186,4190,4194,4198,4202,4206],{"type":395,"tag":447,"props":4171,"children":4172},{"style":1380},[4173],{"type":400,"value":1804},{"type":395,"tag":447,"props":4175,"children":4176},{"style":460},[4177],{"type":400,"value":890},{"type":395,"tag":447,"props":4179,"children":4180},{"style":821},[4181],{"type":400,"value":1813},{"type":395,"tag":447,"props":4183,"children":4184},{"style":454},[4185],{"type":400,"value":928},{"type":395,"tag":447,"props":4187,"children":4188},{"style":560},[4189],{"type":400,"value":463},{"type":395,"tag":447,"props":4191,"children":4192},{"style":460},[4193],{"type":400,"value":1826},{"type":395,"tag":447,"props":4195,"children":4196},{"style":560},[4197],{"type":400,"value":1741},{"type":395,"tag":447,"props":4199,"children":4200},{"style":821},[4201],{"type":400,"value":568},{"type":395,"tag":447,"props":4203,"children":4204},{"style":460},[4205],{"type":400,"value":928},{"type":395,"tag":447,"props":4207,"children":4208},{"style":545},[4209],{"type":400,"value":1778},{"type":395,"tag":447,"props":4211,"children":4212},{"class":449,"line":500},[4213],{"type":395,"tag":447,"props":4214,"children":4215},{"style":545},[4216],{"type":400,"value":1851},{"type":395,"tag":447,"props":4218,"children":4219},{"class":449,"line":509},[4220,4224,4228],{"type":395,"tag":447,"props":4221,"children":4222},{"style":545},[4223],{"type":400,"value":607},{"type":395,"tag":447,"props":4225,"children":4226},{"style":460},[4227],{"type":400,"value":1864},{"type":395,"tag":447,"props":4229,"children":4230},{"style":545},[4231],{"type":400,"value":1778},{"type":395,"tag":396,"props":4233,"children":4234},{},[4235],{"type":400,"value":4236},"终于结束了！这个函数不长，但一口气看下来还是蛮费力气的。如果一遍写测试用例以便看代码，很快能把这个函数跑通，如果你是纯靠脑力跑，还没被那个长长的字符串替换链给吓住，在此我赐你称号：“人肉编译器 - 2024 限定版”。",{"type":395,"tag":396,"props":4238,"children":4239},{},[4240,4242,4249,4251,4256],{"type":400,"value":4241},"额外提一句，Function 构造器和 eval 函数比，除了能传参数意外，还有一些细节不同，比如说声明变量的作用域不同，这个需要注意。这个编译器没有错误处理等代码完善，因此不可以上生产。此外，由于 ",{"type":395,"tag":403,"props":4243,"children":4247},{"href":4244,"rel":4245},"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/with",[4246],"nofollow",[4248],{"type":400,"value":2920},{"type":400,"value":4250}," 语句非常容易出错，且不利于静态优化，不应该在业务函数里使用",{"type":395,"tag":447,"props":4252,"children":4253},{},[4254],{"type":400,"value":4255},"^with-mdn",{"type":400,"value":4257},"。最后，阅读源码需要技巧，这几点希望能帮助到你：",{"type":395,"tag":3094,"props":4259,"children":4260},{},[4261,4266,4271,4276],{"type":395,"tag":3098,"props":4262,"children":4263},{},[4264],{"type":400,"value":4265},"从注释、测试用例，先搞清楚要看的代码的作用",{"type":395,"tag":3098,"props":4267,"children":4268},{},[4269],{"type":400,"value":4270},"使用编辑器的折叠代码，一次只看一部分源码",{"type":395,"tag":3098,"props":4272,"children":4273},{},[4274],{"type":400,"value":4275},"在 Git 提交记录中搜索，从简单的版本看起",{"type":395,"tag":3098,"props":4277,"children":4278},{},[4279],{"type":400,"value":4280},"复杂代码应该从高层结构看起，比如使用 IDE 各种插件或是 Madge 等代码分析工具",{"type":395,"tag":751,"props":4282,"children":4284},{"id":4283},"相关链接",[4285],{"type":400,"value":4283},{"type":395,"tag":3094,"props":4287,"children":4288},{},[4289],{"type":395,"tag":3098,"props":4290,"children":4291},{},[4292],{"type":395,"tag":403,"props":4293,"children":4296},{"href":4294,"rel":4295},"https://johnresig.com/blog/javascript-micro-templating/",[4246],[4297],{"type":400,"value":4298},"JavaScript Micro-Templating",{"type":395,"tag":4300,"props":4301,"children":4302},"style",{},[4303],{"type":400,"value":4304},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":389,"searchDepth":472,"depth":472,"links":4306},[4307,4308,4309],{"id":753,"depth":472,"text":753},{"id":1876,"depth":472,"text":1876},{"id":4283,"depth":472,"text":4283},"markdown","content:2.articles:1.micro-templating.md","content","2.articles/1.micro-templating.md","md",[4316,4318],{"_path":34,"title":37,"description":4317},"简单介绍自己，以及建立博客的初衷",{"_path":43,"title":42,"description":4319},"我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。我碰到的问题是，如果 CSS 源码中带嵌套语法那么解析就会失败。今天借这个问题给大家简单介绍一下 CSS Parser 的基本流程。",1710257705285]