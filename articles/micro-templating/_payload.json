[{"data":1,"prerenderedAt":4317},["Reactive",2],{"navigation":3,"/articles/micro-templating":383,"/articles/micro-templating-surround":4312},[4,32,80,96,123,129,135,366,372,378],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":42,"_path":43},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":45,"_path":46},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":48,"_path":49},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":51,"_path":52},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":54,"_path":55},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":57,"_path":58},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":60,"_path":61},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":63,"_path":64},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":66,"_path":67},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":69,"_path":70},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":72,"_path":73},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":75,"_path":76},"🚝 四十二篇系列","/articles/fourty-two",{"title":78,"_path":79},"📝 技术博客归档","/articles/fold",{"title":81,"_path":82,"children":83},"造物 / Make","/tools",[84,87,90,93],{"title":85,"_path":86},"🌐 AnySort","/tools/anysort",{"title":88,"_path":89},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":91,"_path":92},"👓 Crapto","/tools/crypto-inline",{"title":94,"_path":95},"🖨️ any-to-base64","/tools/any-to-base64",{"title":97,"_path":98,"children":99},"吉他剧场 / Music","/music",[100,102,105,108,111,114,117,120],{"title":101,"_path":98},"🎸 FingerStyle！",{"title":103,"_path":104},"🌬️ 等待的风","/music/wind",{"title":106,"_path":107},"💕 约定的海洋","/music/ocean",{"title":109,"_path":110},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":112,"_path":113},"🌏 残酷天使的行动纲领","/music/eva",{"title":115,"_path":116},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":118,"_path":119},"🍷 Wu Wei","/music/wu-wei",{"title":121,"_path":122},"🌅 无题","/music/untitled",{"title":124,"_path":125,"children":126},"画点什么 / Paint","/paint",[127],{"title":128,"_path":125},"🚧 正在施工",{"title":130,"_path":131,"children":132},"知识地图 / Maps","/maps",[133],{"title":134,"_path":131},"🏁 知识地图",{"title":136,"_path":137,"children":138},"零散的笔记 / Gists","/gists",[139,141,144,147,150,153,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363],{"title":140,"_path":137},"🧊 Gists",{"title":142,"_path":143},"网站的可访问性","/gists/accessibility",{"title":145,"_path":146},"图片模糊","/gists/blur",{"title":148,"_path":149},"渲染相关笔记","/gists/c4d",{"title":151,"_path":152},"CDN 问题记录","/gists/cdn",{"title":154,"_path":155},"消毒剂","/gists/cleaner",{"title":157,"_path":158},"Windows Command","/gists/cmd",{"title":160,"_path":161},"Command","/gists/command",{"title":163,"_path":164},"复杂科学","/gists/complexity-science",{"title":166,"_path":167},"宇宙","/gists/cosmos",{"title":169,"_path":170},"C++","/gists/cpp",{"title":172,"_path":173},"Data Structure","/gists/data-structure",{"title":175,"_path":176},"DEPRESSION","/gists/depression",{"title":178,"_path":179},"设计模式","/gists/design-patterns",{"title":181,"_path":182},"Developer Experience","/gists/developer-experience",{"title":184,"_path":185},"Device Metrics","/gists/device-metrix",{"title":187,"_path":188},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":190,"_path":191},"正则表达式","/gists/eegex",{"title":193,"_path":194},"Emoji","/gists/emoji",{"title":196,"_path":197},"工程","/gists/engineering",{"title":199,"_path":200},"熵","/gists/entropy",{"title":202,"_path":203},"Environment","/gists/environment",{"title":205,"_path":206},"Erlang","/gists/erlang",{"title":208,"_path":209},"逃离塔克夫","/gists/escape-from-tarkov",{"title":211,"_path":212},"ESNext (ES6-ES11)","/gists/esnext",{"title":214,"_path":215},"Eval！","/gists/eval",{"title":217,"_path":218},"Flutter","/gists/flutter",{"title":220,"_path":221},"字体","/gists/font",{"title":223,"_path":224},"JS 函数式编程","/gists/functional",{"title":226,"_path":227},"Google C++ Standard","/gists/google-cpp-standard",{"title":229,"_path":230},"双向链接完全体","/gists/graph",{"title":232,"_path":233},"Hardwares","/gists/hardwares",{"title":235,"_path":236},"哈希冲突","/gists/hash-collision",{"title":238,"_path":239},"信息设计","/gists/information-design",{"title":241,"_path":242},"InstantPage","/gists/instant.page",{"title":244,"_path":245},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":247,"_path":248},"KVStore","/gists/key-value-db",{"title":250,"_path":251},"Kubernetes","/gists/kubernetes",{"title":253,"_path":254},"Makefile","/gists/makefile",{"title":256,"_path":257},"Markdown Inline Style","/gists/markdown-nice",{"title":259,"_path":260},"小程序","/gists/miniapp",{"title":262,"_path":263},"减小页面快照体积","/gists/minify-html",{"title":265,"_path":266},"mklink","/gists/mklink",{"title":268,"_path":269},"Mock","/gists/mock",{"title":271,"_path":272},"多端应用","/gists/multy-end-app",{"title":274,"_path":275},"神经科学","/gists/neuroscience",{"title":277,"_path":278},"OO","/gists/oo",{"title":280,"_path":281},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":283,"_path":284},"人物","/gists/person",{"title":286,"_path":287},"PInvoke","/gists/pinvoke",{"title":289,"_path":290},"像素","/gists/pixel",{"title":292,"_path":293},"PowerShell","/gists/powershell",{"title":295,"_path":296},"量子","/gists/quantum",{"title":298,"_path":299},"保持好奇心","/gists/questions",{"title":301,"_path":302},"React Native","/gists/react-native",{"title":304,"_path":305},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":307,"_path":308},"SEO","/gists/seo",{"title":310,"_path":311},"Shader","/gists/shader",{"title":313,"_path":314},"Shape Up","/gists/shape-up",{"title":316,"_path":317},"睡觉","/gists/sleep",{"title":319,"_path":320},"States","/gists/states",{"title":322,"_path":323},"Storage","/gists/storage",{"title":325,"_path":326},"音视频流处理","/gists/stream-cli",{"title":328,"_path":329},"Symbol","/gists/symbol",{"title":331,"_path":332},"系统论","/gists/systems-theory",{"title":334,"_path":335},"Taro","/gists/taro",{"title":337,"_path":338},"任务切片","/gists/task-slice",{"title":340,"_path":341},"技术偏好","/gists/tech-dudge",{"title":343,"_path":344},"Untitled","/gists/untitled",{"title":346,"_path":347},"可变字体","/gists/variable-font",{"title":349,"_path":350},"视觉错觉","/gists/visual-illusion",{"title":352,"_path":353},"SS(SSR)","/gists/vpn",{"title":355,"_path":356},"VS Code 插件开发","/gists/vscode-plugin",{"title":358,"_path":359},"Web Components","/gists/web-components",{"title":361,"_path":362},"Windows","/gists/windows",{"title":364,"_path":365},"查缺补漏","/gists/wrong",{"title":367,"_path":368,"children":369},"代码笔记 / Gists","/source-code",[370],{"title":371,"_path":368},"🚄 代码笔记",{"title":373,"_path":374,"children":375},"我 / Abount","/hire",[376],{"title":377,"_path":374},"📬 技术简历",{"title":379,"_path":380,"children":381},"todo","/todo",[382],{"title":379,"_path":380},{"_path":40,"_dir":384,"_draft":385,"_partial":385,"_locale":386,"title":39,"description":387,"body":388,"_type":4307,"_id":4308,"_source":4309,"_file":4310,"_extension":4311},"articles",false,"","忍者秘籍中提到的模板解析器，很短但支持变量和 if 等语句，还是 15 年前的代码！",{"type":389,"children":390,"toc":4302},"root",[391,416,428,433,610,622,742,747,753,758,1866,1871,1876,1881,1992,2005,2466,2772,2783,2882,2895,3066,3071,3090,3129,3134,3201,3206,3259,3919,3966,3971,4045,4058,4063,4068,4229,4234,4255,4278,4283,4296],{"type":392,"tag":393,"props":394,"children":395},"element","p",{},[396,399,405,407,414],{"type":397,"value":398},"text","上回我借着解决 CSS 嵌套解析问题聊到 micro-app 中实现的一个非常精简的 ",{"type":392,"tag":400,"props":401,"children":402},"a",{"href":43},[403],{"type":397,"value":404},"CSS 解析器",{"type":397,"value":406},"，还没过瘾。今天整理笔记的时候发现了角落里的这个模板解析器，那就赶紧擦擦灰尘拉出来聊一聊。这个模板解析器可是有年头了，它是 John Resig 佬 2008 年写的，叫 ",{"type":392,"tag":408,"props":409,"children":411},"code",{"className":410},[],[412],{"type":397,"value":413},"micro-templating",{"type":397,"value":415},"，距今十五年哩。（John Resig 就是写《JavaScript 忍者秘籍》那位）",{"type":392,"tag":393,"props":417,"children":418},{},[419,421,426],{"type":397,"value":420},"令人惊叹的地方是，",{"type":392,"tag":408,"props":422,"children":424},{"className":423},[],[425],{"type":397,"value":413},{"type":397,"value":427}," 的代码和它的名字一样 micro，它能用仅仅 30 行代码完成对模板的处理，并且还有读取 html 模板、缓存、柯里化等额外的高级功能！",{"type":392,"tag":393,"props":429,"children":430},{},[431],{"type":397,"value":432},"可能有些佬没接触过模板解析器，这里给出一个简单的示例。",{"type":392,"tag":434,"props":435,"children":439},"pre",{"className":436,"code":437,"language":438,"meta":386,"style":386},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","parse(`\n  \u003C% if (shouldCount) { %>\n    \u003C% for (var i = 1; i \u003C= 3; i++) { %>\n      \u003Cdiv>hello - \u003C%= i + count %>\u003C/div>\n    \u003C% } %>\n  \u003C% } else { %>\n    \u003Cdiv>noop\u003C/div>\n  \u003C% } %>\n`, {\n  shouldCount: true,\n  count: 1\n})\n","js",[440],{"type":392,"tag":408,"props":441,"children":442},{"__ignoreMap":386},[443,467,477,486,495,504,513,522,531,551,577,596],{"type":392,"tag":444,"props":445,"children":448},"span",{"class":446,"line":447},"line",1,[449,455,461],{"type":392,"tag":444,"props":450,"children":452},{"style":451},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[453],{"type":397,"value":454},"parse",{"type":392,"tag":444,"props":456,"children":458},{"style":457},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[459],{"type":397,"value":460},"(",{"type":392,"tag":444,"props":462,"children":464},{"style":463},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[465],{"type":397,"value":466},"`\n",{"type":392,"tag":444,"props":468,"children":470},{"class":446,"line":469},2,[471],{"type":392,"tag":444,"props":472,"children":474},{"style":473},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[475],{"type":397,"value":476},"  \u003C% if (shouldCount) { %>\n",{"type":392,"tag":444,"props":478,"children":480},{"class":446,"line":479},3,[481],{"type":392,"tag":444,"props":482,"children":483},{"style":473},[484],{"type":397,"value":485},"    \u003C% for (var i = 1; i \u003C= 3; i++) { %>\n",{"type":392,"tag":444,"props":487,"children":489},{"class":446,"line":488},4,[490],{"type":392,"tag":444,"props":491,"children":492},{"style":473},[493],{"type":397,"value":494},"      \u003Cdiv>hello - \u003C%= i + count %>\u003C/div>\n",{"type":392,"tag":444,"props":496,"children":498},{"class":446,"line":497},5,[499],{"type":392,"tag":444,"props":500,"children":501},{"style":473},[502],{"type":397,"value":503},"    \u003C% } %>\n",{"type":392,"tag":444,"props":505,"children":507},{"class":446,"line":506},6,[508],{"type":392,"tag":444,"props":509,"children":510},{"style":473},[511],{"type":397,"value":512},"  \u003C% } else { %>\n",{"type":392,"tag":444,"props":514,"children":516},{"class":446,"line":515},7,[517],{"type":392,"tag":444,"props":518,"children":519},{"style":473},[520],{"type":397,"value":521},"    \u003Cdiv>noop\u003C/div>\n",{"type":392,"tag":444,"props":523,"children":525},{"class":446,"line":524},8,[526],{"type":392,"tag":444,"props":527,"children":528},{"style":473},[529],{"type":397,"value":530},"  \u003C% } %>\n",{"type":392,"tag":444,"props":532,"children":534},{"class":446,"line":533},9,[535,540,546],{"type":392,"tag":444,"props":536,"children":537},{"style":463},[538],{"type":397,"value":539},"`",{"type":392,"tag":444,"props":541,"children":543},{"style":542},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[544],{"type":397,"value":545},",",{"type":392,"tag":444,"props":547,"children":548},{"style":542},[549],{"type":397,"value":550}," {\n",{"type":392,"tag":444,"props":552,"children":554},{"class":446,"line":553},10,[555,561,566,572],{"type":392,"tag":444,"props":556,"children":558},{"style":557},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[559],{"type":397,"value":560},"  shouldCount",{"type":392,"tag":444,"props":562,"children":563},{"style":542},[564],{"type":397,"value":565},":",{"type":392,"tag":444,"props":567,"children":569},{"style":568},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[570],{"type":397,"value":571}," true",{"type":392,"tag":444,"props":573,"children":574},{"style":542},[575],{"type":397,"value":576},",\n",{"type":392,"tag":444,"props":578,"children":580},{"class":446,"line":579},11,[581,586,590],{"type":392,"tag":444,"props":582,"children":583},{"style":557},[584],{"type":397,"value":585},"  count",{"type":392,"tag":444,"props":587,"children":588},{"style":542},[589],{"type":397,"value":565},{"type":392,"tag":444,"props":591,"children":593},{"style":592},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[594],{"type":397,"value":595}," 1\n",{"type":392,"tag":444,"props":597,"children":599},{"class":446,"line":598},12,[600,605],{"type":392,"tag":444,"props":601,"children":602},{"style":542},[603],{"type":397,"value":604},"}",{"type":392,"tag":444,"props":606,"children":607},{"style":457},[608],{"type":397,"value":609},")\n",{"type":392,"tag":393,"props":611,"children":612},{},[613,615,620],{"type":397,"value":614},"给 ",{"type":392,"tag":408,"props":616,"children":618},{"className":617},[],[619],{"type":397,"value":454},{"type":397,"value":621}," 函数传入模板字符串和数据后，自然也是输出字符串啦：",{"type":392,"tag":434,"props":623,"children":627},{"className":624,"code":625,"language":626,"meta":386,"style":386},"language-html shiki shiki-themes material-theme-lighter github-light github-dark monokai","\u003C!-- 以下经过格式化 -->\n\u003Cdiv>hello - 2\u003C/div>\n\u003Cdiv>hello - 3\u003C/div>\n\u003Cdiv>hello - 4\u003C/div>\n","html",[628],{"type":392,"tag":408,"props":629,"children":630},{"__ignoreMap":386},[631,640,678,710],{"type":392,"tag":444,"props":632,"children":633},{"class":446,"line":447},[634],{"type":392,"tag":444,"props":635,"children":637},{"style":636},"--shiki-light:#90A4AE;--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[638],{"type":397,"value":639},"\u003C!-- 以下经过格式化 -->\n",{"type":392,"tag":444,"props":641,"children":642},{"class":446,"line":469},[643,648,654,659,664,669,673],{"type":392,"tag":444,"props":644,"children":645},{"style":542},[646],{"type":397,"value":647},"\u003C",{"type":392,"tag":444,"props":649,"children":651},{"style":650},"--shiki-light:#E53935;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[652],{"type":397,"value":653},"div",{"type":392,"tag":444,"props":655,"children":656},{"style":542},[657],{"type":397,"value":658},">",{"type":392,"tag":444,"props":660,"children":661},{"style":457},[662],{"type":397,"value":663},"hello - 2",{"type":392,"tag":444,"props":665,"children":666},{"style":542},[667],{"type":397,"value":668},"\u003C/",{"type":392,"tag":444,"props":670,"children":671},{"style":650},[672],{"type":397,"value":653},{"type":392,"tag":444,"props":674,"children":675},{"style":542},[676],{"type":397,"value":677},">\n",{"type":392,"tag":444,"props":679,"children":680},{"class":446,"line":479},[681,685,689,693,698,702,706],{"type":392,"tag":444,"props":682,"children":683},{"style":542},[684],{"type":397,"value":647},{"type":392,"tag":444,"props":686,"children":687},{"style":650},[688],{"type":397,"value":653},{"type":392,"tag":444,"props":690,"children":691},{"style":542},[692],{"type":397,"value":658},{"type":392,"tag":444,"props":694,"children":695},{"style":457},[696],{"type":397,"value":697},"hello - 3",{"type":392,"tag":444,"props":699,"children":700},{"style":542},[701],{"type":397,"value":668},{"type":392,"tag":444,"props":703,"children":704},{"style":650},[705],{"type":397,"value":653},{"type":392,"tag":444,"props":707,"children":708},{"style":542},[709],{"type":397,"value":677},{"type":392,"tag":444,"props":711,"children":712},{"class":446,"line":488},[713,717,721,725,730,734,738],{"type":392,"tag":444,"props":714,"children":715},{"style":542},[716],{"type":397,"value":647},{"type":392,"tag":444,"props":718,"children":719},{"style":650},[720],{"type":397,"value":653},{"type":392,"tag":444,"props":722,"children":723},{"style":542},[724],{"type":397,"value":658},{"type":392,"tag":444,"props":726,"children":727},{"style":457},[728],{"type":397,"value":729},"hello - 4",{"type":392,"tag":444,"props":731,"children":732},{"style":542},[733],{"type":397,"value":668},{"type":392,"tag":444,"props":735,"children":736},{"style":650},[737],{"type":397,"value":653},{"type":392,"tag":444,"props":739,"children":740},{"style":542},[741],{"type":397,"value":677},{"type":392,"tag":393,"props":743,"children":744},{},[745],{"type":397,"value":746},"相比生态里现在动则 30kb 甚至 300kb 的库，仅 30 行代码完成这个功能，简直不可思议。",{"type":392,"tag":748,"props":749,"children":751},"h2",{"id":750},"完整实现",[752],{"type":397,"value":750},{"type":392,"tag":393,"props":754,"children":755},{},[756],{"type":397,"value":757},"因为代码真的非常短，先直接看一遍，这是带注释版本的。如果你能在第一遍 review 这段代码后脑袋还保持清醒的话，留下评论，我拜你为大哥。",{"type":392,"tag":434,"props":759,"children":761},{"className":436,"code":760,"language":438,"meta":386,"style":386},"// Simple JavaScript Templating\n// John Resig - https://johnresig.com/ - MIT Licensed\n(function () {\n  var cache = {};\n\n  this.tmpl = function tmpl(str, data) {\n    // Figure out if we're getting a template, or if we need to\n    // load the template - and be sure to cache the result.\n    var fn = !/\\W/.test(str)\n      ? (cache[str] =\n          cache[str] || tmpl(document.getElementById(str).innerHTML))\n      : // Generate a reusable function that will serve as a template\n        // generator (and which will be cached).\n        new Function(\n          \"obj\",\n          \"var p=[],print=function(){p.push.apply(p,arguments);};\" +\n            // Introduce the data as local variables using with(){}\n            \"with(obj){p.push('\" +\n            // Convert the template into pure JavaScript\n            str\n              .replace(/[\\r\\t\\n]/g, \" \")\n              .split(\"\u003C%\")\n              .join(\"\\t\")\n              .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\n              .replace(/\\t=(.*?)%>/g, \"',$1,'\")\n              .split(\"\\t\")\n              .join(\"');\")\n              .split(\"%>\")\n              .join(\"p.push('\")\n              .split(\"\\r\")\n              .join(\"\\\\'\") +\n            \"');}return p.join('');\"\n        );\n\n    // Provide some basic currying to the user\n    return data ? fn(data) : fn;\n  };\n})();\n",[762],{"type":392,"tag":408,"props":763,"children":764},{"__ignoreMap":386},[765,773,781,803,827,836,897,905,913,971,1008,1081,1094,1103,1122,1145,1167,1176,1198,1207,1216,1280,1314,1349,1460,1539,1571,1604,1636,1669,1701,1744,1762,1776,1784,1793,1840,1849],{"type":392,"tag":444,"props":766,"children":767},{"class":446,"line":447},[768],{"type":392,"tag":444,"props":769,"children":770},{"style":636},[771],{"type":397,"value":772},"// Simple JavaScript Templating\n",{"type":392,"tag":444,"props":774,"children":775},{"class":446,"line":469},[776],{"type":392,"tag":444,"props":777,"children":778},{"style":636},[779],{"type":397,"value":780},"// John Resig - https://johnresig.com/ - MIT Licensed\n",{"type":392,"tag":444,"props":782,"children":783},{"class":446,"line":479},[784,788,794,799],{"type":392,"tag":444,"props":785,"children":786},{"style":457},[787],{"type":397,"value":460},{"type":392,"tag":444,"props":789,"children":791},{"style":790},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-light-font-style:inherit;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[792],{"type":397,"value":793},"function",{"type":392,"tag":444,"props":795,"children":796},{"style":542},[797],{"type":397,"value":798}," ()",{"type":392,"tag":444,"props":800,"children":801},{"style":542},[802],{"type":397,"value":550},{"type":392,"tag":444,"props":804,"children":805},{"class":446,"line":488},[806,811,816,822],{"type":392,"tag":444,"props":807,"children":808},{"style":790},[809],{"type":397,"value":810},"  var",{"type":392,"tag":444,"props":812,"children":813},{"style":457},[814],{"type":397,"value":815}," cache",{"type":392,"tag":444,"props":817,"children":819},{"style":818},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[820],{"type":397,"value":821}," =",{"type":392,"tag":444,"props":823,"children":824},{"style":542},[825],{"type":397,"value":826}," {};\n",{"type":392,"tag":444,"props":828,"children":829},{"class":446,"line":497},[830],{"type":392,"tag":444,"props":831,"children":833},{"emptyLinePlaceholder":832},true,[834],{"type":397,"value":835},"\n",{"type":392,"tag":444,"props":837,"children":838},{"class":446,"line":506},[839,845,850,855,859,864,869,873,879,883,888,893],{"type":392,"tag":444,"props":840,"children":842},{"style":841},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[843],{"type":397,"value":844},"  this",{"type":392,"tag":444,"props":846,"children":847},{"style":542},[848],{"type":397,"value":849},".",{"type":392,"tag":444,"props":851,"children":852},{"style":451},[853],{"type":397,"value":854},"tmpl",{"type":392,"tag":444,"props":856,"children":857},{"style":818},[858],{"type":397,"value":821},{"type":392,"tag":444,"props":860,"children":861},{"style":790},[862],{"type":397,"value":863}," function",{"type":392,"tag":444,"props":865,"children":866},{"style":451},[867],{"type":397,"value":868}," tmpl",{"type":392,"tag":444,"props":870,"children":871},{"style":542},[872],{"type":397,"value":460},{"type":392,"tag":444,"props":874,"children":876},{"style":875},"--shiki-light:#90A4AE;--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[877],{"type":397,"value":878},"str",{"type":392,"tag":444,"props":880,"children":881},{"style":542},[882],{"type":397,"value":545},{"type":392,"tag":444,"props":884,"children":885},{"style":875},[886],{"type":397,"value":887}," data",{"type":392,"tag":444,"props":889,"children":890},{"style":542},[891],{"type":397,"value":892},")",{"type":392,"tag":444,"props":894,"children":895},{"style":542},[896],{"type":397,"value":550},{"type":392,"tag":444,"props":898,"children":899},{"class":446,"line":515},[900],{"type":392,"tag":444,"props":901,"children":902},{"style":636},[903],{"type":397,"value":904},"    // Figure out if we're getting a template, or if we need to\n",{"type":392,"tag":444,"props":906,"children":907},{"class":446,"line":524},[908],{"type":392,"tag":444,"props":909,"children":910},{"style":636},[911],{"type":397,"value":912},"    // load the template - and be sure to cache the result.\n",{"type":392,"tag":444,"props":914,"children":915},{"class":446,"line":533},[916,921,926,930,935,940,946,950,954,959,963,967],{"type":392,"tag":444,"props":917,"children":918},{"style":790},[919],{"type":397,"value":920},"    var",{"type":392,"tag":444,"props":922,"children":923},{"style":457},[924],{"type":397,"value":925}," fn",{"type":392,"tag":444,"props":927,"children":928},{"style":818},[929],{"type":397,"value":821},{"type":392,"tag":444,"props":931,"children":932},{"style":818},[933],{"type":397,"value":934}," !",{"type":392,"tag":444,"props":936,"children":937},{"style":463},[938],{"type":397,"value":939},"/",{"type":392,"tag":444,"props":941,"children":943},{"style":942},"--shiki-light:#91B859;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[944],{"type":397,"value":945},"\\W",{"type":392,"tag":444,"props":947,"children":948},{"style":463},[949],{"type":397,"value":939},{"type":392,"tag":444,"props":951,"children":952},{"style":542},[953],{"type":397,"value":849},{"type":392,"tag":444,"props":955,"children":956},{"style":451},[957],{"type":397,"value":958},"test",{"type":392,"tag":444,"props":960,"children":961},{"style":557},[962],{"type":397,"value":460},{"type":392,"tag":444,"props":964,"children":965},{"style":457},[966],{"type":397,"value":878},{"type":392,"tag":444,"props":968,"children":969},{"style":557},[970],{"type":397,"value":609},{"type":392,"tag":444,"props":972,"children":973},{"class":446,"line":553},[974,979,984,989,994,998,1003],{"type":392,"tag":444,"props":975,"children":976},{"style":818},[977],{"type":397,"value":978},"      ?",{"type":392,"tag":444,"props":980,"children":981},{"style":557},[982],{"type":397,"value":983}," (",{"type":392,"tag":444,"props":985,"children":986},{"style":457},[987],{"type":397,"value":988},"cache",{"type":392,"tag":444,"props":990,"children":991},{"style":557},[992],{"type":397,"value":993},"[",{"type":392,"tag":444,"props":995,"children":996},{"style":457},[997],{"type":397,"value":878},{"type":392,"tag":444,"props":999,"children":1000},{"style":557},[1001],{"type":397,"value":1002},"] ",{"type":392,"tag":444,"props":1004,"children":1005},{"style":818},[1006],{"type":397,"value":1007},"=\n",{"type":392,"tag":444,"props":1009,"children":1010},{"class":446,"line":579},[1011,1016,1020,1024,1028,1033,1037,1041,1046,1050,1055,1059,1063,1067,1071,1076],{"type":392,"tag":444,"props":1012,"children":1013},{"style":457},[1014],{"type":397,"value":1015},"          cache",{"type":392,"tag":444,"props":1017,"children":1018},{"style":557},[1019],{"type":397,"value":993},{"type":392,"tag":444,"props":1021,"children":1022},{"style":457},[1023],{"type":397,"value":878},{"type":392,"tag":444,"props":1025,"children":1026},{"style":557},[1027],{"type":397,"value":1002},{"type":392,"tag":444,"props":1029,"children":1030},{"style":818},[1031],{"type":397,"value":1032},"||",{"type":392,"tag":444,"props":1034,"children":1035},{"style":451},[1036],{"type":397,"value":868},{"type":392,"tag":444,"props":1038,"children":1039},{"style":557},[1040],{"type":397,"value":460},{"type":392,"tag":444,"props":1042,"children":1043},{"style":457},[1044],{"type":397,"value":1045},"document",{"type":392,"tag":444,"props":1047,"children":1048},{"style":542},[1049],{"type":397,"value":849},{"type":392,"tag":444,"props":1051,"children":1052},{"style":451},[1053],{"type":397,"value":1054},"getElementById",{"type":392,"tag":444,"props":1056,"children":1057},{"style":557},[1058],{"type":397,"value":460},{"type":392,"tag":444,"props":1060,"children":1061},{"style":457},[1062],{"type":397,"value":878},{"type":392,"tag":444,"props":1064,"children":1065},{"style":557},[1066],{"type":397,"value":892},{"type":392,"tag":444,"props":1068,"children":1069},{"style":542},[1070],{"type":397,"value":849},{"type":392,"tag":444,"props":1072,"children":1073},{"style":457},[1074],{"type":397,"value":1075},"innerHTML",{"type":392,"tag":444,"props":1077,"children":1078},{"style":557},[1079],{"type":397,"value":1080},"))\n",{"type":392,"tag":444,"props":1082,"children":1083},{"class":446,"line":598},[1084,1089],{"type":392,"tag":444,"props":1085,"children":1086},{"style":818},[1087],{"type":397,"value":1088},"      :",{"type":392,"tag":444,"props":1090,"children":1091},{"style":636},[1092],{"type":397,"value":1093}," // Generate a reusable function that will serve as a template\n",{"type":392,"tag":444,"props":1095,"children":1097},{"class":446,"line":1096},13,[1098],{"type":392,"tag":444,"props":1099,"children":1100},{"style":636},[1101],{"type":397,"value":1102},"        // generator (and which will be cached).\n",{"type":392,"tag":444,"props":1104,"children":1106},{"class":446,"line":1105},14,[1107,1112,1117],{"type":392,"tag":444,"props":1108,"children":1109},{"style":818},[1110],{"type":397,"value":1111},"        new",{"type":392,"tag":444,"props":1113,"children":1114},{"style":451},[1115],{"type":397,"value":1116}," Function",{"type":392,"tag":444,"props":1118,"children":1119},{"style":557},[1120],{"type":397,"value":1121},"(\n",{"type":392,"tag":444,"props":1123,"children":1125},{"class":446,"line":1124},15,[1126,1131,1136,1141],{"type":392,"tag":444,"props":1127,"children":1128},{"style":463},[1129],{"type":397,"value":1130},"          \"",{"type":392,"tag":444,"props":1132,"children":1133},{"style":473},[1134],{"type":397,"value":1135},"obj",{"type":392,"tag":444,"props":1137,"children":1138},{"style":463},[1139],{"type":397,"value":1140},"\"",{"type":392,"tag":444,"props":1142,"children":1143},{"style":542},[1144],{"type":397,"value":576},{"type":392,"tag":444,"props":1146,"children":1148},{"class":446,"line":1147},16,[1149,1153,1158,1162],{"type":392,"tag":444,"props":1150,"children":1151},{"style":463},[1152],{"type":397,"value":1130},{"type":392,"tag":444,"props":1154,"children":1155},{"style":473},[1156],{"type":397,"value":1157},"var p=[],print=function(){p.push.apply(p,arguments);};",{"type":392,"tag":444,"props":1159,"children":1160},{"style":463},[1161],{"type":397,"value":1140},{"type":392,"tag":444,"props":1163,"children":1164},{"style":818},[1165],{"type":397,"value":1166}," +\n",{"type":392,"tag":444,"props":1168,"children":1170},{"class":446,"line":1169},17,[1171],{"type":392,"tag":444,"props":1172,"children":1173},{"style":636},[1174],{"type":397,"value":1175},"            // Introduce the data as local variables using with(){}\n",{"type":392,"tag":444,"props":1177,"children":1179},{"class":446,"line":1178},18,[1180,1185,1190,1194],{"type":392,"tag":444,"props":1181,"children":1182},{"style":463},[1183],{"type":397,"value":1184},"            \"",{"type":392,"tag":444,"props":1186,"children":1187},{"style":473},[1188],{"type":397,"value":1189},"with(obj){p.push('",{"type":392,"tag":444,"props":1191,"children":1192},{"style":463},[1193],{"type":397,"value":1140},{"type":392,"tag":444,"props":1195,"children":1196},{"style":818},[1197],{"type":397,"value":1166},{"type":392,"tag":444,"props":1199,"children":1201},{"class":446,"line":1200},19,[1202],{"type":392,"tag":444,"props":1203,"children":1204},{"style":636},[1205],{"type":397,"value":1206},"            // Convert the template into pure JavaScript\n",{"type":392,"tag":444,"props":1208,"children":1210},{"class":446,"line":1209},20,[1211],{"type":392,"tag":444,"props":1212,"children":1213},{"style":457},[1214],{"type":397,"value":1215},"            str\n",{"type":392,"tag":444,"props":1217,"children":1219},{"class":446,"line":1218},21,[1220,1225,1230,1234,1238,1243,1248,1253,1257,1263,1267,1272,1276],{"type":392,"tag":444,"props":1221,"children":1222},{"style":542},[1223],{"type":397,"value":1224},"              .",{"type":392,"tag":444,"props":1226,"children":1227},{"style":451},[1228],{"type":397,"value":1229},"replace",{"type":392,"tag":444,"props":1231,"children":1232},{"style":557},[1233],{"type":397,"value":460},{"type":392,"tag":444,"props":1235,"children":1236},{"style":463},[1237],{"type":397,"value":939},{"type":392,"tag":444,"props":1239,"children":1241},{"style":1240},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1242],{"type":397,"value":993},{"type":392,"tag":444,"props":1244,"children":1245},{"style":942},[1246],{"type":397,"value":1247},"\\r\\t\\n",{"type":392,"tag":444,"props":1249,"children":1250},{"style":1240},[1251],{"type":397,"value":1252},"]",{"type":392,"tag":444,"props":1254,"children":1255},{"style":463},[1256],{"type":397,"value":939},{"type":392,"tag":444,"props":1258,"children":1260},{"style":1259},"--shiki-light:#F76D47;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1261],{"type":397,"value":1262},"g",{"type":392,"tag":444,"props":1264,"children":1265},{"style":542},[1266],{"type":397,"value":545},{"type":392,"tag":444,"props":1268,"children":1269},{"style":463},[1270],{"type":397,"value":1271}," \"",{"type":392,"tag":444,"props":1273,"children":1274},{"style":463},[1275],{"type":397,"value":1271},{"type":392,"tag":444,"props":1277,"children":1278},{"style":557},[1279],{"type":397,"value":609},{"type":392,"tag":444,"props":1281,"children":1283},{"class":446,"line":1282},22,[1284,1288,1293,1297,1301,1306,1310],{"type":392,"tag":444,"props":1285,"children":1286},{"style":542},[1287],{"type":397,"value":1224},{"type":392,"tag":444,"props":1289,"children":1290},{"style":451},[1291],{"type":397,"value":1292},"split",{"type":392,"tag":444,"props":1294,"children":1295},{"style":557},[1296],{"type":397,"value":460},{"type":392,"tag":444,"props":1298,"children":1299},{"style":463},[1300],{"type":397,"value":1140},{"type":392,"tag":444,"props":1302,"children":1303},{"style":473},[1304],{"type":397,"value":1305},"\u003C%",{"type":392,"tag":444,"props":1307,"children":1308},{"style":463},[1309],{"type":397,"value":1140},{"type":392,"tag":444,"props":1311,"children":1312},{"style":557},[1313],{"type":397,"value":609},{"type":392,"tag":444,"props":1315,"children":1317},{"class":446,"line":1316},23,[1318,1322,1327,1331,1335,1341,1345],{"type":392,"tag":444,"props":1319,"children":1320},{"style":542},[1321],{"type":397,"value":1224},{"type":392,"tag":444,"props":1323,"children":1324},{"style":451},[1325],{"type":397,"value":1326},"join",{"type":392,"tag":444,"props":1328,"children":1329},{"style":557},[1330],{"type":397,"value":460},{"type":392,"tag":444,"props":1332,"children":1333},{"style":463},[1334],{"type":397,"value":1140},{"type":392,"tag":444,"props":1336,"children":1338},{"style":1337},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1339],{"type":397,"value":1340},"\\t",{"type":392,"tag":444,"props":1342,"children":1343},{"style":463},[1344],{"type":397,"value":1140},{"type":392,"tag":444,"props":1346,"children":1347},{"style":557},[1348],{"type":397,"value":609},{"type":392,"tag":444,"props":1350,"children":1352},{"class":446,"line":1351},24,[1353,1357,1361,1365,1369,1375,1381,1386,1392,1396,1400,1404,1408,1412,1417,1421,1426,1430,1434,1438,1442,1447,1452,1456],{"type":392,"tag":444,"props":1354,"children":1355},{"style":542},[1356],{"type":397,"value":1224},{"type":392,"tag":444,"props":1358,"children":1359},{"style":451},[1360],{"type":397,"value":1229},{"type":392,"tag":444,"props":1362,"children":1363},{"style":557},[1364],{"type":397,"value":460},{"type":392,"tag":444,"props":1366,"children":1367},{"style":463},[1368],{"type":397,"value":939},{"type":392,"tag":444,"props":1370,"children":1372},{"style":1371},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[1373],{"type":397,"value":1374},"((",{"type":392,"tag":444,"props":1376,"children":1378},{"style":1377},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672;--shiki-light-font-style:italic;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[1379],{"type":397,"value":1380},"^",{"type":392,"tag":444,"props":1382,"children":1383},{"style":818},[1384],{"type":397,"value":1385},"|",{"type":392,"tag":444,"props":1387,"children":1389},{"style":1388},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[1390],{"type":397,"value":1391},"%>",{"type":392,"tag":444,"props":1393,"children":1394},{"style":1371},[1395],{"type":397,"value":892},{"type":392,"tag":444,"props":1397,"children":1398},{"style":1240},[1399],{"type":397,"value":993},{"type":392,"tag":444,"props":1401,"children":1402},{"style":818},[1403],{"type":397,"value":1380},{"type":392,"tag":444,"props":1405,"children":1406},{"style":942},[1407],{"type":397,"value":1340},{"type":392,"tag":444,"props":1409,"children":1410},{"style":1240},[1411],{"type":397,"value":1252},{"type":392,"tag":444,"props":1413,"children":1414},{"style":818},[1415],{"type":397,"value":1416},"*",{"type":392,"tag":444,"props":1418,"children":1419},{"style":1371},[1420],{"type":397,"value":892},{"type":392,"tag":444,"props":1422,"children":1423},{"style":1388},[1424],{"type":397,"value":1425},"'",{"type":392,"tag":444,"props":1427,"children":1428},{"style":463},[1429],{"type":397,"value":939},{"type":392,"tag":444,"props":1431,"children":1432},{"style":1259},[1433],{"type":397,"value":1262},{"type":392,"tag":444,"props":1435,"children":1436},{"style":542},[1437],{"type":397,"value":545},{"type":392,"tag":444,"props":1439,"children":1440},{"style":463},[1441],{"type":397,"value":1271},{"type":392,"tag":444,"props":1443,"children":1444},{"style":473},[1445],{"type":397,"value":1446},"$1",{"type":392,"tag":444,"props":1448,"children":1449},{"style":1337},[1450],{"type":397,"value":1451},"\\r",{"type":392,"tag":444,"props":1453,"children":1454},{"style":463},[1455],{"type":397,"value":1140},{"type":392,"tag":444,"props":1457,"children":1458},{"style":557},[1459],{"type":397,"value":609},{"type":392,"tag":444,"props":1461,"children":1463},{"class":446,"line":1462},25,[1464,1468,1472,1476,1480,1484,1489,1493,1497,1502,1506,1510,1514,1518,1522,1526,1531,1535],{"type":392,"tag":444,"props":1465,"children":1466},{"style":542},[1467],{"type":397,"value":1224},{"type":392,"tag":444,"props":1469,"children":1470},{"style":451},[1471],{"type":397,"value":1229},{"type":392,"tag":444,"props":1473,"children":1474},{"style":557},[1475],{"type":397,"value":460},{"type":392,"tag":444,"props":1477,"children":1478},{"style":463},[1479],{"type":397,"value":939},{"type":392,"tag":444,"props":1481,"children":1482},{"style":942},[1483],{"type":397,"value":1340},{"type":392,"tag":444,"props":1485,"children":1486},{"style":1388},[1487],{"type":397,"value":1488},"=",{"type":392,"tag":444,"props":1490,"children":1491},{"style":1371},[1492],{"type":397,"value":460},{"type":392,"tag":444,"props":1494,"children":1495},{"style":942},[1496],{"type":397,"value":849},{"type":392,"tag":444,"props":1498,"children":1499},{"style":818},[1500],{"type":397,"value":1501},"*?",{"type":392,"tag":444,"props":1503,"children":1504},{"style":1371},[1505],{"type":397,"value":892},{"type":392,"tag":444,"props":1507,"children":1508},{"style":1388},[1509],{"type":397,"value":1391},{"type":392,"tag":444,"props":1511,"children":1512},{"style":463},[1513],{"type":397,"value":939},{"type":392,"tag":444,"props":1515,"children":1516},{"style":1259},[1517],{"type":397,"value":1262},{"type":392,"tag":444,"props":1519,"children":1520},{"style":542},[1521],{"type":397,"value":545},{"type":392,"tag":444,"props":1523,"children":1524},{"style":463},[1525],{"type":397,"value":1271},{"type":392,"tag":444,"props":1527,"children":1528},{"style":473},[1529],{"type":397,"value":1530},"',$1,'",{"type":392,"tag":444,"props":1532,"children":1533},{"style":463},[1534],{"type":397,"value":1140},{"type":392,"tag":444,"props":1536,"children":1537},{"style":557},[1538],{"type":397,"value":609},{"type":392,"tag":444,"props":1540,"children":1542},{"class":446,"line":1541},26,[1543,1547,1551,1555,1559,1563,1567],{"type":392,"tag":444,"props":1544,"children":1545},{"style":542},[1546],{"type":397,"value":1224},{"type":392,"tag":444,"props":1548,"children":1549},{"style":451},[1550],{"type":397,"value":1292},{"type":392,"tag":444,"props":1552,"children":1553},{"style":557},[1554],{"type":397,"value":460},{"type":392,"tag":444,"props":1556,"children":1557},{"style":463},[1558],{"type":397,"value":1140},{"type":392,"tag":444,"props":1560,"children":1561},{"style":1337},[1562],{"type":397,"value":1340},{"type":392,"tag":444,"props":1564,"children":1565},{"style":463},[1566],{"type":397,"value":1140},{"type":392,"tag":444,"props":1568,"children":1569},{"style":557},[1570],{"type":397,"value":609},{"type":392,"tag":444,"props":1572,"children":1574},{"class":446,"line":1573},27,[1575,1579,1583,1587,1591,1596,1600],{"type":392,"tag":444,"props":1576,"children":1577},{"style":542},[1578],{"type":397,"value":1224},{"type":392,"tag":444,"props":1580,"children":1581},{"style":451},[1582],{"type":397,"value":1326},{"type":392,"tag":444,"props":1584,"children":1585},{"style":557},[1586],{"type":397,"value":460},{"type":392,"tag":444,"props":1588,"children":1589},{"style":463},[1590],{"type":397,"value":1140},{"type":392,"tag":444,"props":1592,"children":1593},{"style":473},[1594],{"type":397,"value":1595},"');",{"type":392,"tag":444,"props":1597,"children":1598},{"style":463},[1599],{"type":397,"value":1140},{"type":392,"tag":444,"props":1601,"children":1602},{"style":557},[1603],{"type":397,"value":609},{"type":392,"tag":444,"props":1605,"children":1607},{"class":446,"line":1606},28,[1608,1612,1616,1620,1624,1628,1632],{"type":392,"tag":444,"props":1609,"children":1610},{"style":542},[1611],{"type":397,"value":1224},{"type":392,"tag":444,"props":1613,"children":1614},{"style":451},[1615],{"type":397,"value":1292},{"type":392,"tag":444,"props":1617,"children":1618},{"style":557},[1619],{"type":397,"value":460},{"type":392,"tag":444,"props":1621,"children":1622},{"style":463},[1623],{"type":397,"value":1140},{"type":392,"tag":444,"props":1625,"children":1626},{"style":473},[1627],{"type":397,"value":1391},{"type":392,"tag":444,"props":1629,"children":1630},{"style":463},[1631],{"type":397,"value":1140},{"type":392,"tag":444,"props":1633,"children":1634},{"style":557},[1635],{"type":397,"value":609},{"type":392,"tag":444,"props":1637,"children":1639},{"class":446,"line":1638},29,[1640,1644,1648,1652,1656,1661,1665],{"type":392,"tag":444,"props":1641,"children":1642},{"style":542},[1643],{"type":397,"value":1224},{"type":392,"tag":444,"props":1645,"children":1646},{"style":451},[1647],{"type":397,"value":1326},{"type":392,"tag":444,"props":1649,"children":1650},{"style":557},[1651],{"type":397,"value":460},{"type":392,"tag":444,"props":1653,"children":1654},{"style":463},[1655],{"type":397,"value":1140},{"type":392,"tag":444,"props":1657,"children":1658},{"style":473},[1659],{"type":397,"value":1660},"p.push('",{"type":392,"tag":444,"props":1662,"children":1663},{"style":463},[1664],{"type":397,"value":1140},{"type":392,"tag":444,"props":1666,"children":1667},{"style":557},[1668],{"type":397,"value":609},{"type":392,"tag":444,"props":1670,"children":1672},{"class":446,"line":1671},30,[1673,1677,1681,1685,1689,1693,1697],{"type":392,"tag":444,"props":1674,"children":1675},{"style":542},[1676],{"type":397,"value":1224},{"type":392,"tag":444,"props":1678,"children":1679},{"style":451},[1680],{"type":397,"value":1292},{"type":392,"tag":444,"props":1682,"children":1683},{"style":557},[1684],{"type":397,"value":460},{"type":392,"tag":444,"props":1686,"children":1687},{"style":463},[1688],{"type":397,"value":1140},{"type":392,"tag":444,"props":1690,"children":1691},{"style":1337},[1692],{"type":397,"value":1451},{"type":392,"tag":444,"props":1694,"children":1695},{"style":463},[1696],{"type":397,"value":1140},{"type":392,"tag":444,"props":1698,"children":1699},{"style":557},[1700],{"type":397,"value":609},{"type":392,"tag":444,"props":1702,"children":1704},{"class":446,"line":1703},31,[1705,1709,1713,1717,1721,1726,1730,1734,1739],{"type":392,"tag":444,"props":1706,"children":1707},{"style":542},[1708],{"type":397,"value":1224},{"type":392,"tag":444,"props":1710,"children":1711},{"style":451},[1712],{"type":397,"value":1326},{"type":392,"tag":444,"props":1714,"children":1715},{"style":557},[1716],{"type":397,"value":460},{"type":392,"tag":444,"props":1718,"children":1719},{"style":463},[1720],{"type":397,"value":1140},{"type":392,"tag":444,"props":1722,"children":1723},{"style":1337},[1724],{"type":397,"value":1725},"\\\\",{"type":392,"tag":444,"props":1727,"children":1728},{"style":473},[1729],{"type":397,"value":1425},{"type":392,"tag":444,"props":1731,"children":1732},{"style":463},[1733],{"type":397,"value":1140},{"type":392,"tag":444,"props":1735,"children":1736},{"style":557},[1737],{"type":397,"value":1738},") ",{"type":392,"tag":444,"props":1740,"children":1741},{"style":818},[1742],{"type":397,"value":1743},"+\n",{"type":392,"tag":444,"props":1745,"children":1747},{"class":446,"line":1746},32,[1748,1752,1757],{"type":392,"tag":444,"props":1749,"children":1750},{"style":463},[1751],{"type":397,"value":1184},{"type":392,"tag":444,"props":1753,"children":1754},{"style":473},[1755],{"type":397,"value":1756},"');}return p.join('');",{"type":392,"tag":444,"props":1758,"children":1759},{"style":463},[1760],{"type":397,"value":1761},"\"\n",{"type":392,"tag":444,"props":1763,"children":1765},{"class":446,"line":1764},33,[1766,1771],{"type":392,"tag":444,"props":1767,"children":1768},{"style":557},[1769],{"type":397,"value":1770},"        )",{"type":392,"tag":444,"props":1772,"children":1773},{"style":542},[1774],{"type":397,"value":1775},";\n",{"type":392,"tag":444,"props":1777,"children":1779},{"class":446,"line":1778},34,[1780],{"type":392,"tag":444,"props":1781,"children":1782},{"emptyLinePlaceholder":832},[1783],{"type":397,"value":835},{"type":392,"tag":444,"props":1785,"children":1787},{"class":446,"line":1786},35,[1788],{"type":392,"tag":444,"props":1789,"children":1790},{"style":636},[1791],{"type":397,"value":1792},"    // Provide some basic currying to the user\n",{"type":392,"tag":444,"props":1794,"children":1796},{"class":446,"line":1795},36,[1797,1802,1806,1811,1815,1819,1824,1828,1832,1836],{"type":392,"tag":444,"props":1798,"children":1799},{"style":1377},[1800],{"type":397,"value":1801},"    return",{"type":392,"tag":444,"props":1803,"children":1804},{"style":457},[1805],{"type":397,"value":887},{"type":392,"tag":444,"props":1807,"children":1808},{"style":818},[1809],{"type":397,"value":1810}," ?",{"type":392,"tag":444,"props":1812,"children":1813},{"style":451},[1814],{"type":397,"value":925},{"type":392,"tag":444,"props":1816,"children":1817},{"style":557},[1818],{"type":397,"value":460},{"type":392,"tag":444,"props":1820,"children":1821},{"style":457},[1822],{"type":397,"value":1823},"data",{"type":392,"tag":444,"props":1825,"children":1826},{"style":557},[1827],{"type":397,"value":1738},{"type":392,"tag":444,"props":1829,"children":1830},{"style":818},[1831],{"type":397,"value":565},{"type":392,"tag":444,"props":1833,"children":1834},{"style":457},[1835],{"type":397,"value":925},{"type":392,"tag":444,"props":1837,"children":1838},{"style":542},[1839],{"type":397,"value":1775},{"type":392,"tag":444,"props":1841,"children":1843},{"class":446,"line":1842},37,[1844],{"type":392,"tag":444,"props":1845,"children":1846},{"style":542},[1847],{"type":397,"value":1848},"  };\n",{"type":392,"tag":444,"props":1850,"children":1852},{"class":446,"line":1851},38,[1853,1857,1862],{"type":392,"tag":444,"props":1854,"children":1855},{"style":542},[1856],{"type":397,"value":604},{"type":392,"tag":444,"props":1858,"children":1859},{"style":457},[1860],{"type":397,"value":1861},")()",{"type":392,"tag":444,"props":1863,"children":1864},{"style":542},[1865],{"type":397,"value":1775},{"type":392,"tag":393,"props":1867,"children":1868},{},[1869],{"type":397,"value":1870},"代码看完了，我知道你没看懂，因为曾经我也是。好了，留下三连，解析开始。",{"type":392,"tag":748,"props":1872,"children":1874},{"id":1873},"解析",[1875],{"type":397,"value":1873},{"type":392,"tag":393,"props":1877,"children":1878},{},[1879],{"type":397,"value":1880},"首先，代码最外层是一个 IIFE，给 this 对象挂载了 tmpl 函数，直接执行的话就是 window。内部通过局部变量保存了模板解析的缓存：",{"type":392,"tag":434,"props":1882,"children":1884},{"className":436,"code":1883,"language":438,"meta":386,"style":386},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {};\n})();\n",[1885],{"type":392,"tag":408,"props":1886,"children":1887},{"__ignoreMap":386},[1888,1907,1926,1977],{"type":392,"tag":444,"props":1889,"children":1890},{"class":446,"line":447},[1891,1895,1899,1903],{"type":392,"tag":444,"props":1892,"children":1893},{"style":457},[1894],{"type":397,"value":460},{"type":392,"tag":444,"props":1896,"children":1897},{"style":790},[1898],{"type":397,"value":793},{"type":392,"tag":444,"props":1900,"children":1901},{"style":542},[1902],{"type":397,"value":798},{"type":392,"tag":444,"props":1904,"children":1905},{"style":542},[1906],{"type":397,"value":550},{"type":392,"tag":444,"props":1908,"children":1909},{"class":446,"line":469},[1910,1914,1918,1922],{"type":392,"tag":444,"props":1911,"children":1912},{"style":790},[1913],{"type":397,"value":810},{"type":392,"tag":444,"props":1915,"children":1916},{"style":457},[1917],{"type":397,"value":815},{"type":392,"tag":444,"props":1919,"children":1920},{"style":818},[1921],{"type":397,"value":821},{"type":392,"tag":444,"props":1923,"children":1924},{"style":542},[1925],{"type":397,"value":826},{"type":392,"tag":444,"props":1927,"children":1928},{"class":446,"line":479},[1929,1933,1937,1941,1945,1949,1953,1957,1961,1965,1969,1973],{"type":392,"tag":444,"props":1930,"children":1931},{"style":841},[1932],{"type":397,"value":844},{"type":392,"tag":444,"props":1934,"children":1935},{"style":542},[1936],{"type":397,"value":849},{"type":392,"tag":444,"props":1938,"children":1939},{"style":451},[1940],{"type":397,"value":854},{"type":392,"tag":444,"props":1942,"children":1943},{"style":818},[1944],{"type":397,"value":821},{"type":392,"tag":444,"props":1946,"children":1947},{"style":790},[1948],{"type":397,"value":863},{"type":392,"tag":444,"props":1950,"children":1951},{"style":451},[1952],{"type":397,"value":868},{"type":392,"tag":444,"props":1954,"children":1955},{"style":542},[1956],{"type":397,"value":460},{"type":392,"tag":444,"props":1958,"children":1959},{"style":875},[1960],{"type":397,"value":878},{"type":392,"tag":444,"props":1962,"children":1963},{"style":542},[1964],{"type":397,"value":545},{"type":392,"tag":444,"props":1966,"children":1967},{"style":875},[1968],{"type":397,"value":887},{"type":392,"tag":444,"props":1970,"children":1971},{"style":542},[1972],{"type":397,"value":892},{"type":392,"tag":444,"props":1974,"children":1975},{"style":542},[1976],{"type":397,"value":826},{"type":392,"tag":444,"props":1978,"children":1979},{"class":446,"line":488},[1980,1984,1988],{"type":392,"tag":444,"props":1981,"children":1982},{"style":542},[1983],{"type":397,"value":604},{"type":392,"tag":444,"props":1985,"children":1986},{"style":457},[1987],{"type":397,"value":1861},{"type":392,"tag":444,"props":1989,"children":1990},{"style":542},[1991],{"type":397,"value":1775},{"type":392,"tag":393,"props":1993,"children":1994},{},[1995,1997,2003],{"type":397,"value":1996},"str 参数有两种两种用途，",{"type":392,"tag":408,"props":1998,"children":2000},{"className":1999},[],[2001],{"type":397,"value":2002},"/\\W/.test(str)",{"type":397,"value":2004}," 用来判断字符串中包不包含模板分隔符，如果不含分隔符，即普通字符串，那就当作 ID，从页面对应 ID 的节点中获取内容作为模板。比如，如果 str 为 'user_tmpl'，那么模板函数将会读取页面的以下脚本的内容作为输入：",{"type":392,"tag":434,"props":2006,"children":2008},{"className":624,"code":2007,"language":626,"meta":386,"style":386},"\u003C!-- type=\"text/html\"，所以浏览器并不会执行这串脚本。它只能由 tmpl 来读取... -->\n\u003Cscript type=\"text/html\" id=\"item_tmpl\">\n  \u003Cdiv id=\"\u003C%=id%>\" class=\"\u003C%=(i % 2 == 1 ? \" even\" : \"\")%>\">\n    \u003Cdiv class=\"grid_1 alpha right\">\n      \u003Cimg class=\"righted\" src=\"\u003C%=profile_image_url%>\"/>\n    \u003C/div>\n    \u003Cdiv class=\"grid_6 omega contents\">\n      \u003Cp>\u003Cb>\u003Ca href=\"/\u003C%=from_user%>\">\u003C%=from_user%>\u003C/a>:\u003C/b> \u003C%=text%>\u003C/p>\n    \u003C/div>\n  \u003C/div>\n\u003C/script>\n",[2009],{"type":392,"tag":408,"props":2010,"children":2011},{"__ignoreMap":386},[2012,2020,2081,2165,2202,2263,2279,2315,2420,2435,2451],{"type":392,"tag":444,"props":2013,"children":2014},{"class":446,"line":447},[2015],{"type":392,"tag":444,"props":2016,"children":2017},{"style":636},[2018],{"type":397,"value":2019},"\u003C!-- type=\"text/html\"，所以浏览器并不会执行这串脚本。它只能由 tmpl 来读取... -->\n",{"type":392,"tag":444,"props":2021,"children":2022},{"class":446,"line":469},[2023,2027,2032,2038,2042,2046,2051,2055,2060,2064,2068,2073,2077],{"type":392,"tag":444,"props":2024,"children":2025},{"style":542},[2026],{"type":397,"value":647},{"type":392,"tag":444,"props":2028,"children":2029},{"style":650},[2030],{"type":397,"value":2031},"script",{"type":392,"tag":444,"props":2033,"children":2035},{"style":2034},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[2036],{"type":397,"value":2037}," type",{"type":392,"tag":444,"props":2039,"children":2040},{"style":542},[2041],{"type":397,"value":1488},{"type":392,"tag":444,"props":2043,"children":2044},{"style":463},[2045],{"type":397,"value":1140},{"type":392,"tag":444,"props":2047,"children":2048},{"style":473},[2049],{"type":397,"value":2050},"text/html",{"type":392,"tag":444,"props":2052,"children":2053},{"style":463},[2054],{"type":397,"value":1140},{"type":392,"tag":444,"props":2056,"children":2057},{"style":2034},[2058],{"type":397,"value":2059}," id",{"type":392,"tag":444,"props":2061,"children":2062},{"style":542},[2063],{"type":397,"value":1488},{"type":392,"tag":444,"props":2065,"children":2066},{"style":463},[2067],{"type":397,"value":1140},{"type":392,"tag":444,"props":2069,"children":2070},{"style":473},[2071],{"type":397,"value":2072},"item_tmpl",{"type":392,"tag":444,"props":2074,"children":2075},{"style":463},[2076],{"type":397,"value":1140},{"type":392,"tag":444,"props":2078,"children":2079},{"style":542},[2080],{"type":397,"value":677},{"type":392,"tag":444,"props":2082,"children":2083},{"class":446,"line":479},[2084,2089,2093,2097,2101,2105,2110,2114,2119,2123,2127,2132,2136,2141,2146,2151,2156,2160],{"type":392,"tag":444,"props":2085,"children":2086},{"style":542},[2087],{"type":397,"value":2088},"  \u003C",{"type":392,"tag":444,"props":2090,"children":2091},{"style":650},[2092],{"type":397,"value":653},{"type":392,"tag":444,"props":2094,"children":2095},{"style":2034},[2096],{"type":397,"value":2059},{"type":392,"tag":444,"props":2098,"children":2099},{"style":542},[2100],{"type":397,"value":1488},{"type":392,"tag":444,"props":2102,"children":2103},{"style":463},[2104],{"type":397,"value":1140},{"type":392,"tag":444,"props":2106,"children":2107},{"style":473},[2108],{"type":397,"value":2109},"\u003C%=id%>",{"type":392,"tag":444,"props":2111,"children":2112},{"style":463},[2113],{"type":397,"value":1140},{"type":392,"tag":444,"props":2115,"children":2116},{"style":2034},[2117],{"type":397,"value":2118}," class",{"type":392,"tag":444,"props":2120,"children":2121},{"style":542},[2122],{"type":397,"value":1488},{"type":392,"tag":444,"props":2124,"children":2125},{"style":463},[2126],{"type":397,"value":1140},{"type":392,"tag":444,"props":2128,"children":2129},{"style":473},[2130],{"type":397,"value":2131},"\u003C%=(i % 2 == 1 ? ",{"type":392,"tag":444,"props":2133,"children":2134},{"style":463},[2135],{"type":397,"value":1140},{"type":392,"tag":444,"props":2137,"children":2138},{"style":2034},[2139],{"type":397,"value":2140}," even",{"type":392,"tag":444,"props":2142,"children":2144},{"style":2143},"--shiki-light:#39ADB5;--shiki-default:#B31D28;--shiki-dark:#FDAEB7;--shiki-sepia:#F44747;--shiki-light-font-style:inherit;--shiki-default-font-style:italic;--shiki-dark-font-style:italic;--shiki-sepia-font-style:inherit",[2145],{"type":397,"value":1140},{"type":392,"tag":444,"props":2147,"children":2148},{"style":2034},[2149],{"type":397,"value":2150}," :",{"type":392,"tag":444,"props":2152,"children":2153},{"style":2143},[2154],{"type":397,"value":2155}," \"\")%",{"type":392,"tag":444,"props":2157,"children":2158},{"style":542},[2159],{"type":397,"value":658},{"type":392,"tag":444,"props":2161,"children":2162},{"style":457},[2163],{"type":397,"value":2164},"\">\n",{"type":392,"tag":444,"props":2166,"children":2167},{"class":446,"line":488},[2168,2173,2177,2181,2185,2189,2194,2198],{"type":392,"tag":444,"props":2169,"children":2170},{"style":542},[2171],{"type":397,"value":2172},"    \u003C",{"type":392,"tag":444,"props":2174,"children":2175},{"style":650},[2176],{"type":397,"value":653},{"type":392,"tag":444,"props":2178,"children":2179},{"style":2034},[2180],{"type":397,"value":2118},{"type":392,"tag":444,"props":2182,"children":2183},{"style":542},[2184],{"type":397,"value":1488},{"type":392,"tag":444,"props":2186,"children":2187},{"style":463},[2188],{"type":397,"value":1140},{"type":392,"tag":444,"props":2190,"children":2191},{"style":473},[2192],{"type":397,"value":2193},"grid_1 alpha right",{"type":392,"tag":444,"props":2195,"children":2196},{"style":463},[2197],{"type":397,"value":1140},{"type":392,"tag":444,"props":2199,"children":2200},{"style":542},[2201],{"type":397,"value":677},{"type":392,"tag":444,"props":2203,"children":2204},{"class":446,"line":497},[2205,2210,2215,2219,2223,2227,2232,2236,2241,2245,2249,2254,2258],{"type":392,"tag":444,"props":2206,"children":2207},{"style":542},[2208],{"type":397,"value":2209},"      \u003C",{"type":392,"tag":444,"props":2211,"children":2212},{"style":650},[2213],{"type":397,"value":2214},"img",{"type":392,"tag":444,"props":2216,"children":2217},{"style":2034},[2218],{"type":397,"value":2118},{"type":392,"tag":444,"props":2220,"children":2221},{"style":542},[2222],{"type":397,"value":1488},{"type":392,"tag":444,"props":2224,"children":2225},{"style":463},[2226],{"type":397,"value":1140},{"type":392,"tag":444,"props":2228,"children":2229},{"style":473},[2230],{"type":397,"value":2231},"righted",{"type":392,"tag":444,"props":2233,"children":2234},{"style":463},[2235],{"type":397,"value":1140},{"type":392,"tag":444,"props":2237,"children":2238},{"style":2034},[2239],{"type":397,"value":2240}," src",{"type":392,"tag":444,"props":2242,"children":2243},{"style":542},[2244],{"type":397,"value":1488},{"type":392,"tag":444,"props":2246,"children":2247},{"style":463},[2248],{"type":397,"value":1140},{"type":392,"tag":444,"props":2250,"children":2251},{"style":473},[2252],{"type":397,"value":2253},"\u003C%=profile_image_url%>",{"type":392,"tag":444,"props":2255,"children":2256},{"style":463},[2257],{"type":397,"value":1140},{"type":392,"tag":444,"props":2259,"children":2260},{"style":542},[2261],{"type":397,"value":2262},"/>\n",{"type":392,"tag":444,"props":2264,"children":2265},{"class":446,"line":506},[2266,2271,2275],{"type":392,"tag":444,"props":2267,"children":2268},{"style":542},[2269],{"type":397,"value":2270},"    \u003C/",{"type":392,"tag":444,"props":2272,"children":2273},{"style":650},[2274],{"type":397,"value":653},{"type":392,"tag":444,"props":2276,"children":2277},{"style":542},[2278],{"type":397,"value":677},{"type":392,"tag":444,"props":2280,"children":2281},{"class":446,"line":515},[2282,2286,2290,2294,2298,2302,2307,2311],{"type":392,"tag":444,"props":2283,"children":2284},{"style":542},[2285],{"type":397,"value":2172},{"type":392,"tag":444,"props":2287,"children":2288},{"style":650},[2289],{"type":397,"value":653},{"type":392,"tag":444,"props":2291,"children":2292},{"style":2034},[2293],{"type":397,"value":2118},{"type":392,"tag":444,"props":2295,"children":2296},{"style":542},[2297],{"type":397,"value":1488},{"type":392,"tag":444,"props":2299,"children":2300},{"style":463},[2301],{"type":397,"value":1140},{"type":392,"tag":444,"props":2303,"children":2304},{"style":473},[2305],{"type":397,"value":2306},"grid_6 omega contents",{"type":392,"tag":444,"props":2308,"children":2309},{"style":463},[2310],{"type":397,"value":1140},{"type":392,"tag":444,"props":2312,"children":2313},{"style":542},[2314],{"type":397,"value":677},{"type":392,"tag":444,"props":2316,"children":2317},{"class":446,"line":524},[2318,2322,2326,2331,2336,2340,2344,2349,2353,2357,2362,2366,2370,2375,2379,2383,2387,2391,2395,2399,2403,2408,2412,2416],{"type":392,"tag":444,"props":2319,"children":2320},{"style":542},[2321],{"type":397,"value":2209},{"type":392,"tag":444,"props":2323,"children":2324},{"style":650},[2325],{"type":397,"value":393},{"type":392,"tag":444,"props":2327,"children":2328},{"style":542},[2329],{"type":397,"value":2330},">\u003C",{"type":392,"tag":444,"props":2332,"children":2333},{"style":650},[2334],{"type":397,"value":2335},"b",{"type":392,"tag":444,"props":2337,"children":2338},{"style":542},[2339],{"type":397,"value":2330},{"type":392,"tag":444,"props":2341,"children":2342},{"style":650},[2343],{"type":397,"value":400},{"type":392,"tag":444,"props":2345,"children":2346},{"style":2034},[2347],{"type":397,"value":2348}," href",{"type":392,"tag":444,"props":2350,"children":2351},{"style":542},[2352],{"type":397,"value":1488},{"type":392,"tag":444,"props":2354,"children":2355},{"style":463},[2356],{"type":397,"value":1140},{"type":392,"tag":444,"props":2358,"children":2359},{"style":473},[2360],{"type":397,"value":2361},"/\u003C%=from_user%>",{"type":392,"tag":444,"props":2363,"children":2364},{"style":463},[2365],{"type":397,"value":1140},{"type":392,"tag":444,"props":2367,"children":2368},{"style":542},[2369],{"type":397,"value":658},{"type":392,"tag":444,"props":2371,"children":2372},{"style":457},[2373],{"type":397,"value":2374},"\u003C%=from_user%>",{"type":392,"tag":444,"props":2376,"children":2377},{"style":542},[2378],{"type":397,"value":668},{"type":392,"tag":444,"props":2380,"children":2381},{"style":650},[2382],{"type":397,"value":400},{"type":392,"tag":444,"props":2384,"children":2385},{"style":542},[2386],{"type":397,"value":658},{"type":392,"tag":444,"props":2388,"children":2389},{"style":457},[2390],{"type":397,"value":565},{"type":392,"tag":444,"props":2392,"children":2393},{"style":542},[2394],{"type":397,"value":668},{"type":392,"tag":444,"props":2396,"children":2397},{"style":650},[2398],{"type":397,"value":2335},{"type":392,"tag":444,"props":2400,"children":2401},{"style":542},[2402],{"type":397,"value":658},{"type":392,"tag":444,"props":2404,"children":2405},{"style":457},[2406],{"type":397,"value":2407}," \u003C%=text%>",{"type":392,"tag":444,"props":2409,"children":2410},{"style":542},[2411],{"type":397,"value":668},{"type":392,"tag":444,"props":2413,"children":2414},{"style":650},[2415],{"type":397,"value":393},{"type":392,"tag":444,"props":2417,"children":2418},{"style":542},[2419],{"type":397,"value":677},{"type":392,"tag":444,"props":2421,"children":2422},{"class":446,"line":533},[2423,2427,2431],{"type":392,"tag":444,"props":2424,"children":2425},{"style":542},[2426],{"type":397,"value":2270},{"type":392,"tag":444,"props":2428,"children":2429},{"style":650},[2430],{"type":397,"value":653},{"type":392,"tag":444,"props":2432,"children":2433},{"style":542},[2434],{"type":397,"value":677},{"type":392,"tag":444,"props":2436,"children":2437},{"class":446,"line":553},[2438,2443,2447],{"type":392,"tag":444,"props":2439,"children":2440},{"style":542},[2441],{"type":397,"value":2442},"  \u003C/",{"type":392,"tag":444,"props":2444,"children":2445},{"style":650},[2446],{"type":397,"value":653},{"type":392,"tag":444,"props":2448,"children":2449},{"style":542},[2450],{"type":397,"value":677},{"type":392,"tag":444,"props":2452,"children":2453},{"class":446,"line":579},[2454,2458,2462],{"type":392,"tag":444,"props":2455,"children":2456},{"style":542},[2457],{"type":397,"value":668},{"type":392,"tag":444,"props":2459,"children":2460},{"style":650},[2461],{"type":397,"value":2031},{"type":392,"tag":444,"props":2463,"children":2464},{"style":542},[2465],{"type":397,"value":677},{"type":392,"tag":434,"props":2467,"children":2469},{"className":436,"code":2468,"language":438,"meta":386,"style":386},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {\n    return !/\\W/.test(str)\n      ? // 缓存会将读取脚本内容到模板解析这个过程的解析结果缓存下来\n        (cache[str] =\n          cache[str] ||\n          // 读取脚本内容\n          tmpl(document.getElementById(str).innerHTML))\n      : new Function();\n  };\n})();\n",[2470],{"type":392,"tag":408,"props":2471,"children":2472},{"__ignoreMap":386},[2473,2492,2511,2562,2605,2617,2645,2669,2677,2725,2750,2757],{"type":392,"tag":444,"props":2474,"children":2475},{"class":446,"line":447},[2476,2480,2484,2488],{"type":392,"tag":444,"props":2477,"children":2478},{"style":457},[2479],{"type":397,"value":460},{"type":392,"tag":444,"props":2481,"children":2482},{"style":790},[2483],{"type":397,"value":793},{"type":392,"tag":444,"props":2485,"children":2486},{"style":542},[2487],{"type":397,"value":798},{"type":392,"tag":444,"props":2489,"children":2490},{"style":542},[2491],{"type":397,"value":550},{"type":392,"tag":444,"props":2493,"children":2494},{"class":446,"line":469},[2495,2499,2503,2507],{"type":392,"tag":444,"props":2496,"children":2497},{"style":790},[2498],{"type":397,"value":810},{"type":392,"tag":444,"props":2500,"children":2501},{"style":457},[2502],{"type":397,"value":815},{"type":392,"tag":444,"props":2504,"children":2505},{"style":818},[2506],{"type":397,"value":821},{"type":392,"tag":444,"props":2508,"children":2509},{"style":542},[2510],{"type":397,"value":826},{"type":392,"tag":444,"props":2512,"children":2513},{"class":446,"line":479},[2514,2518,2522,2526,2530,2534,2538,2542,2546,2550,2554,2558],{"type":392,"tag":444,"props":2515,"children":2516},{"style":841},[2517],{"type":397,"value":844},{"type":392,"tag":444,"props":2519,"children":2520},{"style":542},[2521],{"type":397,"value":849},{"type":392,"tag":444,"props":2523,"children":2524},{"style":451},[2525],{"type":397,"value":854},{"type":392,"tag":444,"props":2527,"children":2528},{"style":818},[2529],{"type":397,"value":821},{"type":392,"tag":444,"props":2531,"children":2532},{"style":790},[2533],{"type":397,"value":863},{"type":392,"tag":444,"props":2535,"children":2536},{"style":451},[2537],{"type":397,"value":868},{"type":392,"tag":444,"props":2539,"children":2540},{"style":542},[2541],{"type":397,"value":460},{"type":392,"tag":444,"props":2543,"children":2544},{"style":875},[2545],{"type":397,"value":878},{"type":392,"tag":444,"props":2547,"children":2548},{"style":542},[2549],{"type":397,"value":545},{"type":392,"tag":444,"props":2551,"children":2552},{"style":875},[2553],{"type":397,"value":887},{"type":392,"tag":444,"props":2555,"children":2556},{"style":542},[2557],{"type":397,"value":892},{"type":392,"tag":444,"props":2559,"children":2560},{"style":542},[2561],{"type":397,"value":550},{"type":392,"tag":444,"props":2563,"children":2564},{"class":446,"line":488},[2565,2569,2573,2577,2581,2585,2589,2593,2597,2601],{"type":392,"tag":444,"props":2566,"children":2567},{"style":1377},[2568],{"type":397,"value":1801},{"type":392,"tag":444,"props":2570,"children":2571},{"style":818},[2572],{"type":397,"value":934},{"type":392,"tag":444,"props":2574,"children":2575},{"style":463},[2576],{"type":397,"value":939},{"type":392,"tag":444,"props":2578,"children":2579},{"style":942},[2580],{"type":397,"value":945},{"type":392,"tag":444,"props":2582,"children":2583},{"style":463},[2584],{"type":397,"value":939},{"type":392,"tag":444,"props":2586,"children":2587},{"style":542},[2588],{"type":397,"value":849},{"type":392,"tag":444,"props":2590,"children":2591},{"style":451},[2592],{"type":397,"value":958},{"type":392,"tag":444,"props":2594,"children":2595},{"style":557},[2596],{"type":397,"value":460},{"type":392,"tag":444,"props":2598,"children":2599},{"style":457},[2600],{"type":397,"value":878},{"type":392,"tag":444,"props":2602,"children":2603},{"style":557},[2604],{"type":397,"value":609},{"type":392,"tag":444,"props":2606,"children":2607},{"class":446,"line":497},[2608,2612],{"type":392,"tag":444,"props":2609,"children":2610},{"style":818},[2611],{"type":397,"value":978},{"type":392,"tag":444,"props":2613,"children":2614},{"style":636},[2615],{"type":397,"value":2616}," // 缓存会将读取脚本内容到模板解析这个过程的解析结果缓存下来\n",{"type":392,"tag":444,"props":2618,"children":2619},{"class":446,"line":506},[2620,2625,2629,2633,2637,2641],{"type":392,"tag":444,"props":2621,"children":2622},{"style":557},[2623],{"type":397,"value":2624},"        (",{"type":392,"tag":444,"props":2626,"children":2627},{"style":457},[2628],{"type":397,"value":988},{"type":392,"tag":444,"props":2630,"children":2631},{"style":557},[2632],{"type":397,"value":993},{"type":392,"tag":444,"props":2634,"children":2635},{"style":457},[2636],{"type":397,"value":878},{"type":392,"tag":444,"props":2638,"children":2639},{"style":557},[2640],{"type":397,"value":1002},{"type":392,"tag":444,"props":2642,"children":2643},{"style":818},[2644],{"type":397,"value":1007},{"type":392,"tag":444,"props":2646,"children":2647},{"class":446,"line":515},[2648,2652,2656,2660,2664],{"type":392,"tag":444,"props":2649,"children":2650},{"style":457},[2651],{"type":397,"value":1015},{"type":392,"tag":444,"props":2653,"children":2654},{"style":557},[2655],{"type":397,"value":993},{"type":392,"tag":444,"props":2657,"children":2658},{"style":457},[2659],{"type":397,"value":878},{"type":392,"tag":444,"props":2661,"children":2662},{"style":557},[2663],{"type":397,"value":1002},{"type":392,"tag":444,"props":2665,"children":2666},{"style":818},[2667],{"type":397,"value":2668},"||\n",{"type":392,"tag":444,"props":2670,"children":2671},{"class":446,"line":524},[2672],{"type":392,"tag":444,"props":2673,"children":2674},{"style":636},[2675],{"type":397,"value":2676},"          // 读取脚本内容\n",{"type":392,"tag":444,"props":2678,"children":2679},{"class":446,"line":533},[2680,2685,2689,2693,2697,2701,2705,2709,2713,2717,2721],{"type":392,"tag":444,"props":2681,"children":2682},{"style":451},[2683],{"type":397,"value":2684},"          tmpl",{"type":392,"tag":444,"props":2686,"children":2687},{"style":557},[2688],{"type":397,"value":460},{"type":392,"tag":444,"props":2690,"children":2691},{"style":457},[2692],{"type":397,"value":1045},{"type":392,"tag":444,"props":2694,"children":2695},{"style":542},[2696],{"type":397,"value":849},{"type":392,"tag":444,"props":2698,"children":2699},{"style":451},[2700],{"type":397,"value":1054},{"type":392,"tag":444,"props":2702,"children":2703},{"style":557},[2704],{"type":397,"value":460},{"type":392,"tag":444,"props":2706,"children":2707},{"style":457},[2708],{"type":397,"value":878},{"type":392,"tag":444,"props":2710,"children":2711},{"style":557},[2712],{"type":397,"value":892},{"type":392,"tag":444,"props":2714,"children":2715},{"style":542},[2716],{"type":397,"value":849},{"type":392,"tag":444,"props":2718,"children":2719},{"style":457},[2720],{"type":397,"value":1075},{"type":392,"tag":444,"props":2722,"children":2723},{"style":557},[2724],{"type":397,"value":1080},{"type":392,"tag":444,"props":2726,"children":2727},{"class":446,"line":553},[2728,2732,2737,2741,2746],{"type":392,"tag":444,"props":2729,"children":2730},{"style":818},[2731],{"type":397,"value":1088},{"type":392,"tag":444,"props":2733,"children":2734},{"style":818},[2735],{"type":397,"value":2736}," new",{"type":392,"tag":444,"props":2738,"children":2739},{"style":451},[2740],{"type":397,"value":1116},{"type":392,"tag":444,"props":2742,"children":2743},{"style":557},[2744],{"type":397,"value":2745},"()",{"type":392,"tag":444,"props":2747,"children":2748},{"style":542},[2749],{"type":397,"value":1775},{"type":392,"tag":444,"props":2751,"children":2752},{"class":446,"line":579},[2753],{"type":392,"tag":444,"props":2754,"children":2755},{"style":542},[2756],{"type":397,"value":1848},{"type":392,"tag":444,"props":2758,"children":2759},{"class":446,"line":598},[2760,2764,2768],{"type":392,"tag":444,"props":2761,"children":2762},{"style":542},[2763],{"type":397,"value":604},{"type":392,"tag":444,"props":2765,"children":2766},{"style":457},[2767],{"type":397,"value":1861},{"type":392,"tag":444,"props":2769,"children":2770},{"style":542},[2771],{"type":397,"value":1775},{"type":392,"tag":393,"props":2773,"children":2774},{},[2775,2781],{"type":392,"tag":408,"props":2776,"children":2778},{"className":2777},[],[2779],{"type":397,"value":2780},"new Function()",{"type":397,"value":2782}," 即模板解析的核心内容，原理是用一个数组，保存所有解析内容，再拼接回字符串，作为 JS 执行。类似 eval 函数。",{"type":392,"tag":434,"props":2784,"children":2786},{"className":436,"code":2785,"language":438,"meta":386,"style":386},"new Function(\n  \"obj\",\n  \"var p=[];\" +\n    // + '...'\n    \"return p.join('')\"\n);\n",[2787],{"type":392,"tag":408,"props":2788,"children":2789},{"__ignoreMap":386},[2790,2806,2826,2846,2854,2871],{"type":392,"tag":444,"props":2791,"children":2792},{"class":446,"line":447},[2793,2798,2802],{"type":392,"tag":444,"props":2794,"children":2795},{"style":818},[2796],{"type":397,"value":2797},"new",{"type":392,"tag":444,"props":2799,"children":2800},{"style":451},[2801],{"type":397,"value":1116},{"type":392,"tag":444,"props":2803,"children":2804},{"style":457},[2805],{"type":397,"value":1121},{"type":392,"tag":444,"props":2807,"children":2808},{"class":446,"line":469},[2809,2814,2818,2822],{"type":392,"tag":444,"props":2810,"children":2811},{"style":463},[2812],{"type":397,"value":2813},"  \"",{"type":392,"tag":444,"props":2815,"children":2816},{"style":473},[2817],{"type":397,"value":1135},{"type":392,"tag":444,"props":2819,"children":2820},{"style":463},[2821],{"type":397,"value":1140},{"type":392,"tag":444,"props":2823,"children":2824},{"style":542},[2825],{"type":397,"value":576},{"type":392,"tag":444,"props":2827,"children":2828},{"class":446,"line":479},[2829,2833,2838,2842],{"type":392,"tag":444,"props":2830,"children":2831},{"style":463},[2832],{"type":397,"value":2813},{"type":392,"tag":444,"props":2834,"children":2835},{"style":473},[2836],{"type":397,"value":2837},"var p=[];",{"type":392,"tag":444,"props":2839,"children":2840},{"style":463},[2841],{"type":397,"value":1140},{"type":392,"tag":444,"props":2843,"children":2844},{"style":818},[2845],{"type":397,"value":1166},{"type":392,"tag":444,"props":2847,"children":2848},{"class":446,"line":488},[2849],{"type":392,"tag":444,"props":2850,"children":2851},{"style":636},[2852],{"type":397,"value":2853},"    // + '...'\n",{"type":392,"tag":444,"props":2855,"children":2856},{"class":446,"line":497},[2857,2862,2867],{"type":392,"tag":444,"props":2858,"children":2859},{"style":463},[2860],{"type":397,"value":2861},"    \"",{"type":392,"tag":444,"props":2863,"children":2864},{"style":473},[2865],{"type":397,"value":2866},"return p.join('')",{"type":392,"tag":444,"props":2868,"children":2869},{"style":463},[2870],{"type":397,"value":1761},{"type":392,"tag":444,"props":2872,"children":2873},{"class":446,"line":506},[2874,2878],{"type":392,"tag":444,"props":2875,"children":2876},{"style":457},[2877],{"type":397,"value":892},{"type":392,"tag":444,"props":2879,"children":2880},{"style":542},[2881],{"type":397,"value":1775},{"type":392,"tag":393,"props":2883,"children":2884},{},[2885,2887,2893],{"type":397,"value":2886},"要解析什么内容呢？无非是 ",{"type":392,"tag":408,"props":2888,"children":2890},{"className":2889},[],[2891],{"type":397,"value":2892},"\u003C%=hello%>",{"type":397,"value":2894}," 这种模板字符串。执行过程中，通过 with 语句，将内部变量的求值（hello）转移到参数对象（data.hello）。这个玩意儿在 VueJS 的模板编译中也用到过：",{"type":392,"tag":434,"props":2896,"children":2898},{"className":436,"code":2897,"language":438,"meta":386,"style":386},"/* VueJS */\nwith (vm) {\n  return createVNode(\"p\", { attrs: { hi: hello /* vm.hello */ } }, [\n    createTextNode(\"Hello World\"),\n  ]);\n}\n",[2899],{"type":392,"tag":408,"props":2900,"children":2901},{"__ignoreMap":386},[2902,2910,2928,3013,3046,3058],{"type":392,"tag":444,"props":2903,"children":2904},{"class":446,"line":447},[2905],{"type":392,"tag":444,"props":2906,"children":2907},{"style":636},[2908],{"type":397,"value":2909},"/* VueJS */\n",{"type":392,"tag":444,"props":2911,"children":2912},{"class":446,"line":469},[2913,2918,2923],{"type":392,"tag":444,"props":2914,"children":2915},{"style":1377},[2916],{"type":397,"value":2917},"with",{"type":392,"tag":444,"props":2919,"children":2920},{"style":457},[2921],{"type":397,"value":2922}," (vm) ",{"type":392,"tag":444,"props":2924,"children":2925},{"style":542},[2926],{"type":397,"value":2927},"{\n",{"type":392,"tag":444,"props":2929,"children":2930},{"class":446,"line":479},[2931,2936,2941,2945,2949,2953,2957,2961,2966,2971,2975,2979,2984,2988,2993,2998,3003,3008],{"type":392,"tag":444,"props":2932,"children":2933},{"style":1377},[2934],{"type":397,"value":2935},"  return",{"type":392,"tag":444,"props":2937,"children":2938},{"style":451},[2939],{"type":397,"value":2940}," createVNode",{"type":392,"tag":444,"props":2942,"children":2943},{"style":557},[2944],{"type":397,"value":460},{"type":392,"tag":444,"props":2946,"children":2947},{"style":463},[2948],{"type":397,"value":1140},{"type":392,"tag":444,"props":2950,"children":2951},{"style":473},[2952],{"type":397,"value":393},{"type":392,"tag":444,"props":2954,"children":2955},{"style":463},[2956],{"type":397,"value":1140},{"type":392,"tag":444,"props":2958,"children":2959},{"style":542},[2960],{"type":397,"value":545},{"type":392,"tag":444,"props":2962,"children":2963},{"style":542},[2964],{"type":397,"value":2965}," {",{"type":392,"tag":444,"props":2967,"children":2968},{"style":557},[2969],{"type":397,"value":2970}," attrs",{"type":392,"tag":444,"props":2972,"children":2973},{"style":542},[2974],{"type":397,"value":565},{"type":392,"tag":444,"props":2976,"children":2977},{"style":542},[2978],{"type":397,"value":2965},{"type":392,"tag":444,"props":2980,"children":2981},{"style":557},[2982],{"type":397,"value":2983}," hi",{"type":392,"tag":444,"props":2985,"children":2986},{"style":542},[2987],{"type":397,"value":565},{"type":392,"tag":444,"props":2989,"children":2990},{"style":457},[2991],{"type":397,"value":2992}," hello",{"type":392,"tag":444,"props":2994,"children":2995},{"style":636},[2996],{"type":397,"value":2997}," /* vm.hello */",{"type":392,"tag":444,"props":2999,"children":3000},{"style":542},[3001],{"type":397,"value":3002}," }",{"type":392,"tag":444,"props":3004,"children":3005},{"style":542},[3006],{"type":397,"value":3007}," },",{"type":392,"tag":444,"props":3009,"children":3010},{"style":557},[3011],{"type":397,"value":3012}," [\n",{"type":392,"tag":444,"props":3014,"children":3015},{"class":446,"line":488},[3016,3021,3025,3029,3034,3038,3042],{"type":392,"tag":444,"props":3017,"children":3018},{"style":451},[3019],{"type":397,"value":3020},"    createTextNode",{"type":392,"tag":444,"props":3022,"children":3023},{"style":557},[3024],{"type":397,"value":460},{"type":392,"tag":444,"props":3026,"children":3027},{"style":463},[3028],{"type":397,"value":1140},{"type":392,"tag":444,"props":3030,"children":3031},{"style":473},[3032],{"type":397,"value":3033},"Hello World",{"type":392,"tag":444,"props":3035,"children":3036},{"style":463},[3037],{"type":397,"value":1140},{"type":392,"tag":444,"props":3039,"children":3040},{"style":557},[3041],{"type":397,"value":892},{"type":392,"tag":444,"props":3043,"children":3044},{"style":542},[3045],{"type":397,"value":576},{"type":392,"tag":444,"props":3047,"children":3048},{"class":446,"line":497},[3049,3054],{"type":392,"tag":444,"props":3050,"children":3051},{"style":557},[3052],{"type":397,"value":3053},"  ])",{"type":392,"tag":444,"props":3055,"children":3056},{"style":542},[3057],{"type":397,"value":1775},{"type":392,"tag":444,"props":3059,"children":3060},{"class":446,"line":506},[3061],{"type":392,"tag":444,"props":3062,"children":3063},{"style":542},[3064],{"type":397,"value":3065},"}\n",{"type":392,"tag":393,"props":3067,"children":3068},{},[3069],{"type":397,"value":3070},"那如何解析呢？",{"type":392,"tag":393,"props":3072,"children":3073},{},[3074,3080,3082,3088],{"type":392,"tag":3075,"props":3076,"children":3077},"del",{},[3078],{"type":397,"value":3079},"我们知道",{"type":397,"value":3081},"曾写过经典字符串模板的佬应该知道，",{"type":392,"tag":3083,"props":3084,"children":3085},"strong",{},[3086],{"type":397,"value":3087},"模板字符串一般包含：字符串、变量及逻辑",{"type":397,"value":3089},"。",{"type":392,"tag":3091,"props":3092,"children":3093},"ul",{},[3094,3106,3117],{"type":392,"tag":3095,"props":3096,"children":3097},"li",{},[3098,3100],{"type":397,"value":3099},"字符串 ",{"type":392,"tag":408,"props":3101,"children":3103},{"className":3102},[],[3104],{"type":397,"value":3105},"\u003Chtml>Lionad\u003C/html>",{"type":392,"tag":3095,"props":3107,"children":3108},{},[3109,3111],{"type":397,"value":3110},"带变量 ",{"type":392,"tag":408,"props":3112,"children":3114},{"className":3113},[],[3115],{"type":397,"value":3116},"\u003Chtml>\u003C%=name%>\u003C/html>",{"type":392,"tag":3095,"props":3118,"children":3119},{},[3120,3122,3128],{"type":397,"value":3121},"带逻辑 ",{"type":392,"tag":408,"props":3123,"children":3125},{"className":3124},[],[3126],{"type":397,"value":3127},"\u003C% if(name){ %>\u003Chtml>\u003C%=name%>\u003C/html>\u003C% } %>",{"type":397,"value":3089},{"type":392,"tag":393,"props":3130,"children":3131},{},[3132],{"type":397,"value":3133},"所以解析模板，无非就是把这三种字符串替换成纯粹的 JS 逻辑，作为 new Function 的参数。其中所有中间变量，可以用一个数组来储存：",{"type":392,"tag":3091,"props":3135,"children":3136},{},[3137,3156,3174],{"type":392,"tag":3095,"props":3138,"children":3139},{},[3140,3142,3147,3149,3155],{"type":397,"value":3141},"将普通字符串直接推入作为结果的内容数组，比如 ",{"type":392,"tag":408,"props":3143,"children":3145},{"className":3144},[],[3146],{"type":397,"value":3105},{"type":397,"value":3148}," 应该被解析为 ",{"type":392,"tag":408,"props":3150,"children":3152},{"className":3151},[],[3153],{"type":397,"value":3154},"p.push('\u003Chtml>Lionad\u003C/html>')",{"type":397,"value":3089},{"type":392,"tag":3095,"props":3157,"children":3158},{},[3159,3161,3166,3167,3173],{"type":397,"value":3160},"如果碰到变量，则将变量拆分出来推入数组，如 ",{"type":392,"tag":408,"props":3162,"children":3164},{"className":3163},[],[3165],{"type":397,"value":3116},{"type":397,"value":3148},{"type":392,"tag":408,"props":3168,"children":3170},{"className":3169},[],[3171],{"type":397,"value":3172},"p.push('\u003Chtml>');p.push(name);p.push('\u003C/html>')",{"type":397,"value":3089},{"type":392,"tag":3095,"props":3175,"children":3176},{},[3177,3179,3185,3187,3192,3194,3200],{"type":397,"value":3178},"带逻辑的字符串，由于逻辑本身就是 JS 代码，所以不需要解析为字符串，只需要把两侧的 ",{"type":392,"tag":408,"props":3180,"children":3182},{"className":3181},[],[3183],{"type":397,"value":3184},"\u003C% %>",{"type":397,"value":3186}," 这种模板标志去掉就好了。如 ",{"type":392,"tag":408,"props":3188,"children":3190},{"className":3189},[],[3191],{"type":397,"value":3127},{"type":397,"value":3193}," 应该被解析为：",{"type":392,"tag":408,"props":3195,"children":3197},{"className":3196},[],[3198],{"type":397,"value":3199},"if(name){ p.push('\u003Chtml>');p.push(name);p.push('\u003C/html>') } ",{"type":397,"value":3089},{"type":392,"tag":393,"props":3202,"children":3203},{},[3204],{"type":397,"value":3205},"以下面这段模板为例，我们看看字符串具体的替换规则。",{"type":392,"tag":434,"props":3207,"children":3209},{"className":436,"code":3208,"language":438,"meta":386,"style":386},"str = `\u003C% if (true) { %>\n    \u003Cli>\u003C%=users[i]%>\u003C/li>\n\u003C% } %>`;\n",[3210],{"type":392,"tag":408,"props":3211,"children":3212},{"__ignoreMap":386},[3213,3235,3243],{"type":392,"tag":444,"props":3214,"children":3215},{"class":446,"line":447},[3216,3221,3225,3230],{"type":392,"tag":444,"props":3217,"children":3218},{"style":457},[3219],{"type":397,"value":3220},"str ",{"type":392,"tag":444,"props":3222,"children":3223},{"style":818},[3224],{"type":397,"value":1488},{"type":392,"tag":444,"props":3226,"children":3227},{"style":463},[3228],{"type":397,"value":3229}," `",{"type":392,"tag":444,"props":3231,"children":3232},{"style":473},[3233],{"type":397,"value":3234},"\u003C% if (true) { %>\n",{"type":392,"tag":444,"props":3236,"children":3237},{"class":446,"line":469},[3238],{"type":392,"tag":444,"props":3239,"children":3240},{"style":473},[3241],{"type":397,"value":3242},"    \u003Cli>\u003C%=users[i]%>\u003C/li>\n",{"type":392,"tag":444,"props":3244,"children":3245},{"class":446,"line":479},[3246,3251,3255],{"type":392,"tag":444,"props":3247,"children":3248},{"style":473},[3249],{"type":397,"value":3250},"\u003C% } %>",{"type":392,"tag":444,"props":3252,"children":3253},{"style":463},[3254],{"type":397,"value":539},{"type":392,"tag":444,"props":3256,"children":3257},{"style":542},[3258],{"type":397,"value":1775},{"type":392,"tag":434,"props":3260,"children":3262},{"className":436,"code":3261,"language":438,"meta":386,"style":386},"// with 的使用方法都知道了，with(obj = { a })，那么\n// 就能在内部直接读取 a，不需要写 obj.a\n\"with(obj){p.push('\" +\n  str\n    // 将换行等空白字符转换为空格，这样所有代码都在一行了\n    // '\u003C% if (true) { %>     \u003Cli>\u003C%=users[i]%>\u003C/li> \u003C% } %>'\n    .replace(/[\\r\\t\\n]/g, \" \")\n    // ['', 'if (true) { %>\u003Cli>', '=users[i]%>\u003C/li>', ' } %>']\n    .split(\"\u003C%\")\n    // 因为 \\t 刚才已经被替换成空格了，所以这里可以使用 \\t 用来将不同行的代码字符串“相加”，\n    // 一会儿再拆分时，不会和原先字符串里的字符混淆\n    .join(\"\\t\")\n    // 去掉模板标志两端的引号，在这个例子里不会用到\n    .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\n    // 以下三句最重要，将所有变量推入数组，生成结果形如 `push('xxx',x,'xxx')` 的字符串\n    // 首先，刚才匹配完了 \u003C%，所以 \\t= 开头后边接的就是变量，这里让它转换成 ',x,' 的形式\n    .replace(/\\t=(.*?)%>/g, \"',$1,'\")\n    .split(\"\\t\")\n    // 在刚刚跟 split('\u003C%') 的位置用括号还原，得到了 ',x,'xxx'); 的形式\n    .join(\"');\")\n    // 在 \\t=xxx 那次匹配，已经把变量模板对应的结束标志 %> 匹配完了，\n    // 所以这是处理剩余语句的结束标志，用 split 拆分行后相当于直接把结束标记舍弃了\n    .split(\"%>\")\n    // 最终在每行开头增加 push 方法，形成了 push('xxx',x,'xxx'); 的形式\n    .join(\"p.push('\")\n    // 处理剩余的换行符\n    .split(\"\\r\")\n    .join(\"\\\\'\") +\n  \"');}\";\n",[3263],{"type":392,"tag":408,"props":3264,"children":3265},{"__ignoreMap":386},[3266,3274,3282,3301,3309,3317,3325,3381,3389,3420,3428,3436,3467,3475,3574,3582,3590,3665,3696,3704,3735,3743,3751,3782,3790,3821,3829,3860,3899],{"type":392,"tag":444,"props":3267,"children":3268},{"class":446,"line":447},[3269],{"type":392,"tag":444,"props":3270,"children":3271},{"style":636},[3272],{"type":397,"value":3273},"// with 的使用方法都知道了，with(obj = { a })，那么\n",{"type":392,"tag":444,"props":3275,"children":3276},{"class":446,"line":469},[3277],{"type":392,"tag":444,"props":3278,"children":3279},{"style":636},[3280],{"type":397,"value":3281},"// 就能在内部直接读取 a，不需要写 obj.a\n",{"type":392,"tag":444,"props":3283,"children":3284},{"class":446,"line":479},[3285,3289,3293,3297],{"type":392,"tag":444,"props":3286,"children":3287},{"style":463},[3288],{"type":397,"value":1140},{"type":392,"tag":444,"props":3290,"children":3291},{"style":473},[3292],{"type":397,"value":1189},{"type":392,"tag":444,"props":3294,"children":3295},{"style":463},[3296],{"type":397,"value":1140},{"type":392,"tag":444,"props":3298,"children":3299},{"style":818},[3300],{"type":397,"value":1166},{"type":392,"tag":444,"props":3302,"children":3303},{"class":446,"line":488},[3304],{"type":392,"tag":444,"props":3305,"children":3306},{"style":457},[3307],{"type":397,"value":3308},"  str\n",{"type":392,"tag":444,"props":3310,"children":3311},{"class":446,"line":497},[3312],{"type":392,"tag":444,"props":3313,"children":3314},{"style":636},[3315],{"type":397,"value":3316},"    // 将换行等空白字符转换为空格，这样所有代码都在一行了\n",{"type":392,"tag":444,"props":3318,"children":3319},{"class":446,"line":506},[3320],{"type":392,"tag":444,"props":3321,"children":3322},{"style":636},[3323],{"type":397,"value":3324},"    // '\u003C% if (true) { %>     \u003Cli>\u003C%=users[i]%>\u003C/li> \u003C% } %>'\n",{"type":392,"tag":444,"props":3326,"children":3327},{"class":446,"line":515},[3328,3333,3337,3341,3345,3349,3353,3357,3361,3365,3369,3373,3377],{"type":392,"tag":444,"props":3329,"children":3330},{"style":542},[3331],{"type":397,"value":3332},"    .",{"type":392,"tag":444,"props":3334,"children":3335},{"style":451},[3336],{"type":397,"value":1229},{"type":392,"tag":444,"props":3338,"children":3339},{"style":457},[3340],{"type":397,"value":460},{"type":392,"tag":444,"props":3342,"children":3343},{"style":463},[3344],{"type":397,"value":939},{"type":392,"tag":444,"props":3346,"children":3347},{"style":1240},[3348],{"type":397,"value":993},{"type":392,"tag":444,"props":3350,"children":3351},{"style":942},[3352],{"type":397,"value":1247},{"type":392,"tag":444,"props":3354,"children":3355},{"style":1240},[3356],{"type":397,"value":1252},{"type":392,"tag":444,"props":3358,"children":3359},{"style":463},[3360],{"type":397,"value":939},{"type":392,"tag":444,"props":3362,"children":3363},{"style":1259},[3364],{"type":397,"value":1262},{"type":392,"tag":444,"props":3366,"children":3367},{"style":542},[3368],{"type":397,"value":545},{"type":392,"tag":444,"props":3370,"children":3371},{"style":463},[3372],{"type":397,"value":1271},{"type":392,"tag":444,"props":3374,"children":3375},{"style":463},[3376],{"type":397,"value":1271},{"type":392,"tag":444,"props":3378,"children":3379},{"style":457},[3380],{"type":397,"value":609},{"type":392,"tag":444,"props":3382,"children":3383},{"class":446,"line":524},[3384],{"type":392,"tag":444,"props":3385,"children":3386},{"style":636},[3387],{"type":397,"value":3388},"    // ['', 'if (true) { %>\u003Cli>', '=users[i]%>\u003C/li>', ' } %>']\n",{"type":392,"tag":444,"props":3390,"children":3391},{"class":446,"line":533},[3392,3396,3400,3404,3408,3412,3416],{"type":392,"tag":444,"props":3393,"children":3394},{"style":542},[3395],{"type":397,"value":3332},{"type":392,"tag":444,"props":3397,"children":3398},{"style":451},[3399],{"type":397,"value":1292},{"type":392,"tag":444,"props":3401,"children":3402},{"style":457},[3403],{"type":397,"value":460},{"type":392,"tag":444,"props":3405,"children":3406},{"style":463},[3407],{"type":397,"value":1140},{"type":392,"tag":444,"props":3409,"children":3410},{"style":473},[3411],{"type":397,"value":1305},{"type":392,"tag":444,"props":3413,"children":3414},{"style":463},[3415],{"type":397,"value":1140},{"type":392,"tag":444,"props":3417,"children":3418},{"style":457},[3419],{"type":397,"value":609},{"type":392,"tag":444,"props":3421,"children":3422},{"class":446,"line":553},[3423],{"type":392,"tag":444,"props":3424,"children":3425},{"style":636},[3426],{"type":397,"value":3427},"    // 因为 \\t 刚才已经被替换成空格了，所以这里可以使用 \\t 用来将不同行的代码字符串“相加”，\n",{"type":392,"tag":444,"props":3429,"children":3430},{"class":446,"line":579},[3431],{"type":392,"tag":444,"props":3432,"children":3433},{"style":636},[3434],{"type":397,"value":3435},"    // 一会儿再拆分时，不会和原先字符串里的字符混淆\n",{"type":392,"tag":444,"props":3437,"children":3438},{"class":446,"line":598},[3439,3443,3447,3451,3455,3459,3463],{"type":392,"tag":444,"props":3440,"children":3441},{"style":542},[3442],{"type":397,"value":3332},{"type":392,"tag":444,"props":3444,"children":3445},{"style":451},[3446],{"type":397,"value":1326},{"type":392,"tag":444,"props":3448,"children":3449},{"style":457},[3450],{"type":397,"value":460},{"type":392,"tag":444,"props":3452,"children":3453},{"style":463},[3454],{"type":397,"value":1140},{"type":392,"tag":444,"props":3456,"children":3457},{"style":1337},[3458],{"type":397,"value":1340},{"type":392,"tag":444,"props":3460,"children":3461},{"style":463},[3462],{"type":397,"value":1140},{"type":392,"tag":444,"props":3464,"children":3465},{"style":457},[3466],{"type":397,"value":609},{"type":392,"tag":444,"props":3468,"children":3469},{"class":446,"line":1096},[3470],{"type":392,"tag":444,"props":3471,"children":3472},{"style":636},[3473],{"type":397,"value":3474},"    // 去掉模板标志两端的引号，在这个例子里不会用到\n",{"type":392,"tag":444,"props":3476,"children":3477},{"class":446,"line":1105},[3478,3482,3486,3490,3494,3498,3502,3506,3510,3514,3518,3522,3526,3530,3534,3538,3542,3546,3550,3554,3558,3562,3566,3570],{"type":392,"tag":444,"props":3479,"children":3480},{"style":542},[3481],{"type":397,"value":3332},{"type":392,"tag":444,"props":3483,"children":3484},{"style":451},[3485],{"type":397,"value":1229},{"type":392,"tag":444,"props":3487,"children":3488},{"style":457},[3489],{"type":397,"value":460},{"type":392,"tag":444,"props":3491,"children":3492},{"style":463},[3493],{"type":397,"value":939},{"type":392,"tag":444,"props":3495,"children":3496},{"style":1371},[3497],{"type":397,"value":1374},{"type":392,"tag":444,"props":3499,"children":3500},{"style":1377},[3501],{"type":397,"value":1380},{"type":392,"tag":444,"props":3503,"children":3504},{"style":818},[3505],{"type":397,"value":1385},{"type":392,"tag":444,"props":3507,"children":3508},{"style":1388},[3509],{"type":397,"value":1391},{"type":392,"tag":444,"props":3511,"children":3512},{"style":1371},[3513],{"type":397,"value":892},{"type":392,"tag":444,"props":3515,"children":3516},{"style":1240},[3517],{"type":397,"value":993},{"type":392,"tag":444,"props":3519,"children":3520},{"style":818},[3521],{"type":397,"value":1380},{"type":392,"tag":444,"props":3523,"children":3524},{"style":942},[3525],{"type":397,"value":1340},{"type":392,"tag":444,"props":3527,"children":3528},{"style":1240},[3529],{"type":397,"value":1252},{"type":392,"tag":444,"props":3531,"children":3532},{"style":818},[3533],{"type":397,"value":1416},{"type":392,"tag":444,"props":3535,"children":3536},{"style":1371},[3537],{"type":397,"value":892},{"type":392,"tag":444,"props":3539,"children":3540},{"style":1388},[3541],{"type":397,"value":1425},{"type":392,"tag":444,"props":3543,"children":3544},{"style":463},[3545],{"type":397,"value":939},{"type":392,"tag":444,"props":3547,"children":3548},{"style":1259},[3549],{"type":397,"value":1262},{"type":392,"tag":444,"props":3551,"children":3552},{"style":542},[3553],{"type":397,"value":545},{"type":392,"tag":444,"props":3555,"children":3556},{"style":463},[3557],{"type":397,"value":1271},{"type":392,"tag":444,"props":3559,"children":3560},{"style":473},[3561],{"type":397,"value":1446},{"type":392,"tag":444,"props":3563,"children":3564},{"style":1337},[3565],{"type":397,"value":1451},{"type":392,"tag":444,"props":3567,"children":3568},{"style":463},[3569],{"type":397,"value":1140},{"type":392,"tag":444,"props":3571,"children":3572},{"style":457},[3573],{"type":397,"value":609},{"type":392,"tag":444,"props":3575,"children":3576},{"class":446,"line":1124},[3577],{"type":392,"tag":444,"props":3578,"children":3579},{"style":636},[3580],{"type":397,"value":3581},"    // 以下三句最重要，将所有变量推入数组，生成结果形如 `push('xxx',x,'xxx')` 的字符串\n",{"type":392,"tag":444,"props":3583,"children":3584},{"class":446,"line":1147},[3585],{"type":392,"tag":444,"props":3586,"children":3587},{"style":636},[3588],{"type":397,"value":3589},"    // 首先，刚才匹配完了 \u003C%，所以 \\t= 开头后边接的就是变量，这里让它转换成 ',x,' 的形式\n",{"type":392,"tag":444,"props":3591,"children":3592},{"class":446,"line":1169},[3593,3597,3601,3605,3609,3613,3617,3621,3625,3629,3633,3637,3641,3645,3649,3653,3657,3661],{"type":392,"tag":444,"props":3594,"children":3595},{"style":542},[3596],{"type":397,"value":3332},{"type":392,"tag":444,"props":3598,"children":3599},{"style":451},[3600],{"type":397,"value":1229},{"type":392,"tag":444,"props":3602,"children":3603},{"style":457},[3604],{"type":397,"value":460},{"type":392,"tag":444,"props":3606,"children":3607},{"style":463},[3608],{"type":397,"value":939},{"type":392,"tag":444,"props":3610,"children":3611},{"style":942},[3612],{"type":397,"value":1340},{"type":392,"tag":444,"props":3614,"children":3615},{"style":1388},[3616],{"type":397,"value":1488},{"type":392,"tag":444,"props":3618,"children":3619},{"style":1371},[3620],{"type":397,"value":460},{"type":392,"tag":444,"props":3622,"children":3623},{"style":942},[3624],{"type":397,"value":849},{"type":392,"tag":444,"props":3626,"children":3627},{"style":818},[3628],{"type":397,"value":1501},{"type":392,"tag":444,"props":3630,"children":3631},{"style":1371},[3632],{"type":397,"value":892},{"type":392,"tag":444,"props":3634,"children":3635},{"style":1388},[3636],{"type":397,"value":1391},{"type":392,"tag":444,"props":3638,"children":3639},{"style":463},[3640],{"type":397,"value":939},{"type":392,"tag":444,"props":3642,"children":3643},{"style":1259},[3644],{"type":397,"value":1262},{"type":392,"tag":444,"props":3646,"children":3647},{"style":542},[3648],{"type":397,"value":545},{"type":392,"tag":444,"props":3650,"children":3651},{"style":463},[3652],{"type":397,"value":1271},{"type":392,"tag":444,"props":3654,"children":3655},{"style":473},[3656],{"type":397,"value":1530},{"type":392,"tag":444,"props":3658,"children":3659},{"style":463},[3660],{"type":397,"value":1140},{"type":392,"tag":444,"props":3662,"children":3663},{"style":457},[3664],{"type":397,"value":609},{"type":392,"tag":444,"props":3666,"children":3667},{"class":446,"line":1178},[3668,3672,3676,3680,3684,3688,3692],{"type":392,"tag":444,"props":3669,"children":3670},{"style":542},[3671],{"type":397,"value":3332},{"type":392,"tag":444,"props":3673,"children":3674},{"style":451},[3675],{"type":397,"value":1292},{"type":392,"tag":444,"props":3677,"children":3678},{"style":457},[3679],{"type":397,"value":460},{"type":392,"tag":444,"props":3681,"children":3682},{"style":463},[3683],{"type":397,"value":1140},{"type":392,"tag":444,"props":3685,"children":3686},{"style":1337},[3687],{"type":397,"value":1340},{"type":392,"tag":444,"props":3689,"children":3690},{"style":463},[3691],{"type":397,"value":1140},{"type":392,"tag":444,"props":3693,"children":3694},{"style":457},[3695],{"type":397,"value":609},{"type":392,"tag":444,"props":3697,"children":3698},{"class":446,"line":1200},[3699],{"type":392,"tag":444,"props":3700,"children":3701},{"style":636},[3702],{"type":397,"value":3703},"    // 在刚刚跟 split('\u003C%') 的位置用括号还原，得到了 ',x,'xxx'); 的形式\n",{"type":392,"tag":444,"props":3705,"children":3706},{"class":446,"line":1209},[3707,3711,3715,3719,3723,3727,3731],{"type":392,"tag":444,"props":3708,"children":3709},{"style":542},[3710],{"type":397,"value":3332},{"type":392,"tag":444,"props":3712,"children":3713},{"style":451},[3714],{"type":397,"value":1326},{"type":392,"tag":444,"props":3716,"children":3717},{"style":457},[3718],{"type":397,"value":460},{"type":392,"tag":444,"props":3720,"children":3721},{"style":463},[3722],{"type":397,"value":1140},{"type":392,"tag":444,"props":3724,"children":3725},{"style":473},[3726],{"type":397,"value":1595},{"type":392,"tag":444,"props":3728,"children":3729},{"style":463},[3730],{"type":397,"value":1140},{"type":392,"tag":444,"props":3732,"children":3733},{"style":457},[3734],{"type":397,"value":609},{"type":392,"tag":444,"props":3736,"children":3737},{"class":446,"line":1218},[3738],{"type":392,"tag":444,"props":3739,"children":3740},{"style":636},[3741],{"type":397,"value":3742},"    // 在 \\t=xxx 那次匹配，已经把变量模板对应的结束标志 %> 匹配完了，\n",{"type":392,"tag":444,"props":3744,"children":3745},{"class":446,"line":1282},[3746],{"type":392,"tag":444,"props":3747,"children":3748},{"style":636},[3749],{"type":397,"value":3750},"    // 所以这是处理剩余语句的结束标志，用 split 拆分行后相当于直接把结束标记舍弃了\n",{"type":392,"tag":444,"props":3752,"children":3753},{"class":446,"line":1316},[3754,3758,3762,3766,3770,3774,3778],{"type":392,"tag":444,"props":3755,"children":3756},{"style":542},[3757],{"type":397,"value":3332},{"type":392,"tag":444,"props":3759,"children":3760},{"style":451},[3761],{"type":397,"value":1292},{"type":392,"tag":444,"props":3763,"children":3764},{"style":457},[3765],{"type":397,"value":460},{"type":392,"tag":444,"props":3767,"children":3768},{"style":463},[3769],{"type":397,"value":1140},{"type":392,"tag":444,"props":3771,"children":3772},{"style":473},[3773],{"type":397,"value":1391},{"type":392,"tag":444,"props":3775,"children":3776},{"style":463},[3777],{"type":397,"value":1140},{"type":392,"tag":444,"props":3779,"children":3780},{"style":457},[3781],{"type":397,"value":609},{"type":392,"tag":444,"props":3783,"children":3784},{"class":446,"line":1351},[3785],{"type":392,"tag":444,"props":3786,"children":3787},{"style":636},[3788],{"type":397,"value":3789},"    // 最终在每行开头增加 push 方法，形成了 push('xxx',x,'xxx'); 的形式\n",{"type":392,"tag":444,"props":3791,"children":3792},{"class":446,"line":1462},[3793,3797,3801,3805,3809,3813,3817],{"type":392,"tag":444,"props":3794,"children":3795},{"style":542},[3796],{"type":397,"value":3332},{"type":392,"tag":444,"props":3798,"children":3799},{"style":451},[3800],{"type":397,"value":1326},{"type":392,"tag":444,"props":3802,"children":3803},{"style":457},[3804],{"type":397,"value":460},{"type":392,"tag":444,"props":3806,"children":3807},{"style":463},[3808],{"type":397,"value":1140},{"type":392,"tag":444,"props":3810,"children":3811},{"style":473},[3812],{"type":397,"value":1660},{"type":392,"tag":444,"props":3814,"children":3815},{"style":463},[3816],{"type":397,"value":1140},{"type":392,"tag":444,"props":3818,"children":3819},{"style":457},[3820],{"type":397,"value":609},{"type":392,"tag":444,"props":3822,"children":3823},{"class":446,"line":1541},[3824],{"type":392,"tag":444,"props":3825,"children":3826},{"style":636},[3827],{"type":397,"value":3828},"    // 处理剩余的换行符\n",{"type":392,"tag":444,"props":3830,"children":3831},{"class":446,"line":1573},[3832,3836,3840,3844,3848,3852,3856],{"type":392,"tag":444,"props":3833,"children":3834},{"style":542},[3835],{"type":397,"value":3332},{"type":392,"tag":444,"props":3837,"children":3838},{"style":451},[3839],{"type":397,"value":1292},{"type":392,"tag":444,"props":3841,"children":3842},{"style":457},[3843],{"type":397,"value":460},{"type":392,"tag":444,"props":3845,"children":3846},{"style":463},[3847],{"type":397,"value":1140},{"type":392,"tag":444,"props":3849,"children":3850},{"style":1337},[3851],{"type":397,"value":1451},{"type":392,"tag":444,"props":3853,"children":3854},{"style":463},[3855],{"type":397,"value":1140},{"type":392,"tag":444,"props":3857,"children":3858},{"style":457},[3859],{"type":397,"value":609},{"type":392,"tag":444,"props":3861,"children":3862},{"class":446,"line":1606},[3863,3867,3871,3875,3879,3883,3887,3891,3895],{"type":392,"tag":444,"props":3864,"children":3865},{"style":542},[3866],{"type":397,"value":3332},{"type":392,"tag":444,"props":3868,"children":3869},{"style":451},[3870],{"type":397,"value":1326},{"type":392,"tag":444,"props":3872,"children":3873},{"style":457},[3874],{"type":397,"value":460},{"type":392,"tag":444,"props":3876,"children":3877},{"style":463},[3878],{"type":397,"value":1140},{"type":392,"tag":444,"props":3880,"children":3881},{"style":1337},[3882],{"type":397,"value":1725},{"type":392,"tag":444,"props":3884,"children":3885},{"style":473},[3886],{"type":397,"value":1425},{"type":392,"tag":444,"props":3888,"children":3889},{"style":463},[3890],{"type":397,"value":1140},{"type":392,"tag":444,"props":3892,"children":3893},{"style":457},[3894],{"type":397,"value":1738},{"type":392,"tag":444,"props":3896,"children":3897},{"style":818},[3898],{"type":397,"value":1743},{"type":392,"tag":444,"props":3900,"children":3901},{"class":446,"line":1638},[3902,3906,3911,3915],{"type":392,"tag":444,"props":3903,"children":3904},{"style":463},[3905],{"type":397,"value":2813},{"type":392,"tag":444,"props":3907,"children":3908},{"style":473},[3909],{"type":397,"value":3910},"');}",{"type":392,"tag":444,"props":3912,"children":3913},{"style":463},[3914],{"type":397,"value":1140},{"type":392,"tag":444,"props":3916,"children":3917},{"style":542},[3918],{"type":397,"value":1775},{"type":392,"tag":393,"props":3920,"children":3921},{},[3922,3924,3929,3931,3936,3938,3943,3944,3950,3952,3957,3959,3964],{"type":397,"value":3923},"有一个小细节，字符串替换时，所有逻辑语句的模板标志开头和结尾（",{"type":392,"tag":408,"props":3925,"children":3927},{"className":3926},[],[3928],{"type":397,"value":1305},{"type":397,"value":3930},"、",{"type":392,"tag":408,"props":3932,"children":3934},{"className":3933},[],[3935],{"type":397,"value":1391},{"type":397,"value":3937},"）分别被替换为 ",{"type":392,"tag":408,"props":3939,"children":3941},{"className":3940},[],[3942],{"type":397,"value":1595},{"type":397,"value":3930},{"type":392,"tag":408,"props":3945,"children":3947},{"className":3946},[],[3948],{"type":397,"value":3949},"push('",{"type":397,"value":3951},"，但是开头和结尾的那个标志，并没有对应的匹配。所以在代码中，能看 ",{"type":392,"tag":408,"props":3953,"children":3955},{"className":3954},[],[3956],{"type":397,"value":1189},{"type":397,"value":3958}," 和 ",{"type":392,"tag":408,"props":3960,"children":3962},{"className":3961},[],[3963],{"type":397,"value":1595},{"type":397,"value":3965}," 这种手动补全。",{"type":392,"tag":393,"props":3967,"children":3968},{},[3969],{"type":397,"value":3970},"最终生成的字符串如下（已格式化处理）：",{"type":392,"tag":434,"props":3972,"children":3974},{"className":436,"code":3973,"language":438,"meta":386,"style":386},"`with(obj){\n    p.push(''); \n    if (true) { \n        p.push('     \u003Cli>',users[i],'\u003C/li>   '); \n    } \n    p.push('');\n}`;\n",[3975],{"type":392,"tag":408,"props":3976,"children":3977},{"__ignoreMap":386},[3978,3990,3998,4006,4014,4022,4030],{"type":392,"tag":444,"props":3979,"children":3980},{"class":446,"line":447},[3981,3985],{"type":392,"tag":444,"props":3982,"children":3983},{"style":463},[3984],{"type":397,"value":539},{"type":392,"tag":444,"props":3986,"children":3987},{"style":473},[3988],{"type":397,"value":3989},"with(obj){\n",{"type":392,"tag":444,"props":3991,"children":3992},{"class":446,"line":469},[3993],{"type":392,"tag":444,"props":3994,"children":3995},{"style":473},[3996],{"type":397,"value":3997},"    p.push(''); \n",{"type":392,"tag":444,"props":3999,"children":4000},{"class":446,"line":479},[4001],{"type":392,"tag":444,"props":4002,"children":4003},{"style":473},[4004],{"type":397,"value":4005},"    if (true) { \n",{"type":392,"tag":444,"props":4007,"children":4008},{"class":446,"line":488},[4009],{"type":392,"tag":444,"props":4010,"children":4011},{"style":473},[4012],{"type":397,"value":4013},"        p.push('     \u003Cli>',users[i],'\u003C/li>   '); \n",{"type":392,"tag":444,"props":4015,"children":4016},{"class":446,"line":497},[4017],{"type":392,"tag":444,"props":4018,"children":4019},{"style":473},[4020],{"type":397,"value":4021},"    } \n",{"type":392,"tag":444,"props":4023,"children":4024},{"class":446,"line":506},[4025],{"type":392,"tag":444,"props":4026,"children":4027},{"style":473},[4028],{"type":397,"value":4029},"    p.push('');\n",{"type":392,"tag":444,"props":4031,"children":4032},{"class":446,"line":515},[4033,4037,4041],{"type":392,"tag":444,"props":4034,"children":4035},{"style":473},[4036],{"type":397,"value":604},{"type":392,"tag":444,"props":4038,"children":4039},{"style":463},[4040],{"type":397,"value":539},{"type":392,"tag":444,"props":4042,"children":4043},{"style":542},[4044],{"type":397,"value":1775},{"type":392,"tag":393,"props":4046,"children":4047},{},[4048,4050,4056],{"type":397,"value":4049},"为什么 with 语句里有一行空的 ",{"type":392,"tag":408,"props":4051,"children":4053},{"className":4052},[],[4054],{"type":397,"value":4055},"push('')",{"type":397,"value":4057}," 呢？",{"type":392,"tag":393,"props":4059,"children":4060},{},[4061],{"type":397,"value":4062},"还记得原始的模板吗？一开的模板是以“\u003C%”开头的，而“\u003C%”在替换过程被右括号取代了，此时正好和初始字符串结合形成了空 push。如果原始字符串开头是 \"123\u003C% if (true)\"，那这行空 push 会转换成“p.push('123');”，也是正确的代码。",{"type":392,"tag":393,"props":4064,"children":4065},{},[4066],{"type":397,"value":4067},"最后，micro-templating 需要返回这个新函数。如果不传参数 data 给模板函数，则会返回一个部分应用的函数等待用户输入 data 参数再执行模板解析；如果已经传了 data 那就会立即调用返回模板解析的结果。",{"type":392,"tag":434,"props":4069,"children":4071},{"className":436,"code":4070,"language":438,"meta":386,"style":386},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {\n    return data ? fn(data) : fn;\n  };\n})();\n",[4072],{"type":392,"tag":408,"props":4073,"children":4074},{"__ignoreMap":386},[4075,4094,4113,4164,4207,4214],{"type":392,"tag":444,"props":4076,"children":4077},{"class":446,"line":447},[4078,4082,4086,4090],{"type":392,"tag":444,"props":4079,"children":4080},{"style":457},[4081],{"type":397,"value":460},{"type":392,"tag":444,"props":4083,"children":4084},{"style":790},[4085],{"type":397,"value":793},{"type":392,"tag":444,"props":4087,"children":4088},{"style":542},[4089],{"type":397,"value":798},{"type":392,"tag":444,"props":4091,"children":4092},{"style":542},[4093],{"type":397,"value":550},{"type":392,"tag":444,"props":4095,"children":4096},{"class":446,"line":469},[4097,4101,4105,4109],{"type":392,"tag":444,"props":4098,"children":4099},{"style":790},[4100],{"type":397,"value":810},{"type":392,"tag":444,"props":4102,"children":4103},{"style":457},[4104],{"type":397,"value":815},{"type":392,"tag":444,"props":4106,"children":4107},{"style":818},[4108],{"type":397,"value":821},{"type":392,"tag":444,"props":4110,"children":4111},{"style":542},[4112],{"type":397,"value":826},{"type":392,"tag":444,"props":4114,"children":4115},{"class":446,"line":479},[4116,4120,4124,4128,4132,4136,4140,4144,4148,4152,4156,4160],{"type":392,"tag":444,"props":4117,"children":4118},{"style":841},[4119],{"type":397,"value":844},{"type":392,"tag":444,"props":4121,"children":4122},{"style":542},[4123],{"type":397,"value":849},{"type":392,"tag":444,"props":4125,"children":4126},{"style":451},[4127],{"type":397,"value":854},{"type":392,"tag":444,"props":4129,"children":4130},{"style":818},[4131],{"type":397,"value":821},{"type":392,"tag":444,"props":4133,"children":4134},{"style":790},[4135],{"type":397,"value":863},{"type":392,"tag":444,"props":4137,"children":4138},{"style":451},[4139],{"type":397,"value":868},{"type":392,"tag":444,"props":4141,"children":4142},{"style":542},[4143],{"type":397,"value":460},{"type":392,"tag":444,"props":4145,"children":4146},{"style":875},[4147],{"type":397,"value":878},{"type":392,"tag":444,"props":4149,"children":4150},{"style":542},[4151],{"type":397,"value":545},{"type":392,"tag":444,"props":4153,"children":4154},{"style":875},[4155],{"type":397,"value":887},{"type":392,"tag":444,"props":4157,"children":4158},{"style":542},[4159],{"type":397,"value":892},{"type":392,"tag":444,"props":4161,"children":4162},{"style":542},[4163],{"type":397,"value":550},{"type":392,"tag":444,"props":4165,"children":4166},{"class":446,"line":488},[4167,4171,4175,4179,4183,4187,4191,4195,4199,4203],{"type":392,"tag":444,"props":4168,"children":4169},{"style":1377},[4170],{"type":397,"value":1801},{"type":392,"tag":444,"props":4172,"children":4173},{"style":457},[4174],{"type":397,"value":887},{"type":392,"tag":444,"props":4176,"children":4177},{"style":818},[4178],{"type":397,"value":1810},{"type":392,"tag":444,"props":4180,"children":4181},{"style":451},[4182],{"type":397,"value":925},{"type":392,"tag":444,"props":4184,"children":4185},{"style":557},[4186],{"type":397,"value":460},{"type":392,"tag":444,"props":4188,"children":4189},{"style":457},[4190],{"type":397,"value":1823},{"type":392,"tag":444,"props":4192,"children":4193},{"style":557},[4194],{"type":397,"value":1738},{"type":392,"tag":444,"props":4196,"children":4197},{"style":818},[4198],{"type":397,"value":565},{"type":392,"tag":444,"props":4200,"children":4201},{"style":457},[4202],{"type":397,"value":925},{"type":392,"tag":444,"props":4204,"children":4205},{"style":542},[4206],{"type":397,"value":1775},{"type":392,"tag":444,"props":4208,"children":4209},{"class":446,"line":497},[4210],{"type":392,"tag":444,"props":4211,"children":4212},{"style":542},[4213],{"type":397,"value":1848},{"type":392,"tag":444,"props":4215,"children":4216},{"class":446,"line":506},[4217,4221,4225],{"type":392,"tag":444,"props":4218,"children":4219},{"style":542},[4220],{"type":397,"value":604},{"type":392,"tag":444,"props":4222,"children":4223},{"style":457},[4224],{"type":397,"value":1861},{"type":392,"tag":444,"props":4226,"children":4227},{"style":542},[4228],{"type":397,"value":1775},{"type":392,"tag":393,"props":4230,"children":4231},{},[4232],{"type":397,"value":4233},"终于结束了！这个函数不长，但一口气看下来还是蛮费力气的。如果一遍写测试用例以便看代码，很快能把这个函数跑通，如果你是纯靠脑力跑，还没被那个长长的字符串替换链给吓住，在此我赐你称号：“人肉编译器 - 2024 限定版”。",{"type":392,"tag":393,"props":4235,"children":4236},{},[4237,4239,4246,4248,4253],{"type":397,"value":4238},"额外提一句，Function 构造器和 eval 函数比，除了能传参数意外，还有一些细节不同，比如说声明变量的作用域不同，这个需要注意。这个编译器没有错误处理等代码完善，因此不可以上生产。此外，由于 ",{"type":392,"tag":400,"props":4240,"children":4244},{"href":4241,"rel":4242},"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/with",[4243],"nofollow",[4245],{"type":397,"value":2917},{"type":397,"value":4247}," 语句非常容易出错，且不利于静态优化，不应该在业务函数里使用",{"type":392,"tag":444,"props":4249,"children":4250},{},[4251],{"type":397,"value":4252},"^with-mdn",{"type":397,"value":4254},"。最后，阅读源码需要技巧，这几点希望能帮助到你：",{"type":392,"tag":3091,"props":4256,"children":4257},{},[4258,4263,4268,4273],{"type":392,"tag":3095,"props":4259,"children":4260},{},[4261],{"type":397,"value":4262},"从注释、测试用例，先搞清楚要看的代码的作用",{"type":392,"tag":3095,"props":4264,"children":4265},{},[4266],{"type":397,"value":4267},"使用编辑器的折叠代码，一次只看一部分源码",{"type":392,"tag":3095,"props":4269,"children":4270},{},[4271],{"type":397,"value":4272},"在 Git 提交记录中搜索，从简单的版本看起",{"type":392,"tag":3095,"props":4274,"children":4275},{},[4276],{"type":397,"value":4277},"复杂代码应该从高层结构看起，比如使用 IDE 各种插件或是 Madge 等代码分析工具",{"type":392,"tag":748,"props":4279,"children":4281},{"id":4280},"相关链接",[4282],{"type":397,"value":4280},{"type":392,"tag":3091,"props":4284,"children":4285},{},[4286],{"type":392,"tag":3095,"props":4287,"children":4288},{},[4289],{"type":392,"tag":400,"props":4290,"children":4293},{"href":4291,"rel":4292},"https://johnresig.com/blog/javascript-micro-templating/",[4243],[4294],{"type":397,"value":4295},"JavaScript Micro-Templating",{"type":392,"tag":4297,"props":4298,"children":4299},"style",{},[4300],{"type":397,"value":4301},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":386,"searchDepth":469,"depth":469,"links":4303},[4304,4305,4306],{"id":750,"depth":469,"text":750},{"id":1873,"depth":469,"text":1873},{"id":4280,"depth":469,"text":4280},"markdown","content:2.articles:1.micro-templating.md","content","2.articles/1.micro-templating.md","md",[4313,4315],{"_path":34,"title":37,"description":4314},"简单介绍自己，以及建立博客的初衷",{"_path":43,"title":42,"description":4316},"我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。我碰到的问题是，如果 CSS 源码中带嵌套语法那么解析就会失败。今天借这个问题给大家简单介绍一下 CSS Parser 的基本流程。",1708107553982]