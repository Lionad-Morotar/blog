[{"data":1,"prerenderedAt":4319},["ShallowReactive",2],{"navigation":3,"/articles/micro-templating":384,"/articles/micro-templating-surround":4314},[4,35,86,105,132,138,144,150,378],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":45,"_path":46},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":48,"_path":49},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":51,"_path":52},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":54,"_path":55},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":57,"_path":58},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":60,"_path":61},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":63,"_path":64},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":66,"_path":67},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":69,"_path":70},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":72,"_path":73},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":75,"_path":76},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":78,"_path":79},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":81,"_path":82},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":84,"_path":85},"📝 技术博客归档","/articles/archive",{"title":87,"_path":88,"children":89},"造物 / Make","/tools",[90,93,96,99,102],{"title":91,"_path":92},"🥥 Coconut","/tools/coconut",{"title":94,"_path":95},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":97,"_path":98},"🌐 AnySort","/tools/anysort",{"title":100,"_path":101},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":103,"_path":104},"👓 Crapto","/tools/crypto-inline",{"title":106,"_path":107,"children":108},"吉他剧场 / Music","/music",[109,111,114,117,120,123,126,129],{"title":110,"_path":107},"🎸 FingerStyle！",{"title":112,"_path":113},"🌬️ 等待的风","/music/wind",{"title":115,"_path":116},"💕 约定的海洋","/music/ocean",{"title":118,"_path":119},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":121,"_path":122},"🌏 残酷天使的行动纲领","/music/eva",{"title":124,"_path":125},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":127,"_path":128},"🍷 Wu Wei","/music/wu-wei",{"title":130,"_path":131},"🌅 无题","/music/untitled",{"title":133,"_path":134,"children":135},"画点什么 / Paint","/paint",[136],{"title":137,"_path":134},"🚧 正在施工",{"title":139,"_path":140,"children":141},"读书笔记 / Notes","/books",[142],{"title":143,"_path":140},"📕 读书笔记",{"title":145,"_path":146,"children":147},"知识地图 / Maps","/maps",[148],{"title":149,"_path":146},"🏁 知识地图",{"title":151,"_path":152,"children":153},"零散的笔记 / Gists","/gists",[154,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375],{"title":155,"_path":152},"🧊 Gists",{"title":157,"_path":158},"网站的可访问性","/gists/accessibility",{"title":160,"_path":161},"Bit","/gists/bit",{"title":163,"_path":164},"图片模糊","/gists/blur",{"title":166,"_path":167},"渲染相关笔记","/gists/c4d",{"title":169,"_path":170},"CDN 问题记录","/gists/cdn",{"title":172,"_path":173},"消毒剂","/gists/cleaner",{"title":175,"_path":176},"Windows Command","/gists/cmd",{"title":178,"_path":179},"Command","/gists/command",{"title":181,"_path":182},"复杂科学","/gists/complexity-science",{"title":184,"_path":185},"GitHub Copilot","/gists/copilot",{"title":187,"_path":188},"宇宙","/gists/cosmos",{"title":190,"_path":191},"C++","/gists/cpp",{"title":193,"_path":194},"DEPRESSION","/gists/depression",{"title":196,"_path":197},"Developer Experience","/gists/developer-experience",{"title":199,"_path":200},"Device Metrics","/gists/device-metrix",{"title":202,"_path":203},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":205,"_path":206},"正则表达式","/gists/eegex",{"title":208,"_path":209},"Emoji","/gists/emoji",{"title":211,"_path":212},"工程","/gists/engineering",{"title":214,"_path":215},"熵","/gists/entropy",{"title":217,"_path":218},"Environment","/gists/environment",{"title":220,"_path":221},"Erlang","/gists/erlang",{"title":223,"_path":224},"逃离塔克夫","/gists/escape-from-tarkov",{"title":226,"_path":227},"ESNext (ES6-ES11)","/gists/esnext",{"title":229,"_path":230},"Eval！","/gists/eval",{"title":232,"_path":233},"Flutter","/gists/flutter",{"title":235,"_path":236},"字体","/gists/font",{"title":238,"_path":239},"JS 函数式编程","/gists/functional",{"title":241,"_path":242},"游戏化","/gists/gamification",{"title":244,"_path":245},"Google C++ Standard","/gists/google-cpp-standard",{"title":247,"_path":248},"双向链接完全体","/gists/graph",{"title":250,"_path":251},"Hardwares","/gists/hardwares",{"title":253,"_path":254},"哈希冲突","/gists/hash-collision",{"title":256,"_path":257},"信息设计","/gists/information-design",{"title":259,"_path":260},"InstantPage","/gists/instant.page",{"title":262,"_path":263},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":265,"_path":266},"KVStore","/gists/key-value-db",{"title":268,"_path":269},"Kubernetes","/gists/kubernetes",{"title":271,"_path":272},"Makefile","/gists/makefile",{"title":274,"_path":275},"Markdown Inline Style","/gists/markdown-nice",{"title":277,"_path":278},"减小页面快照体积","/gists/minify-html",{"title":280,"_path":281},"mklink","/gists/mklink",{"title":283,"_path":284},"Mock","/gists/mock",{"title":286,"_path":287},"多人协作系统","/gists/multiplayer",{"title":289,"_path":290},"多端应用","/gists/multy-end-app",{"title":292,"_path":293},"神经科学","/gists/neuroscience",{"title":295,"_path":296},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":298,"_path":299},"PInvoke","/gists/pinvoke",{"title":301,"_path":302},"像素","/gists/pixel",{"title":304,"_path":305},"PowerShell","/gists/powershell",{"title":307,"_path":308},"量子","/gists/quantum",{"title":310,"_path":311},"保持好奇心","/gists/questions",{"title":313,"_path":314},"React Native","/gists/react-native",{"title":316,"_path":317},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":319,"_path":320},"SEO","/gists/seo",{"title":322,"_path":323},"Shader","/gists/shader",{"title":325,"_path":326},"Shape Up","/gists/shape-up",{"title":328,"_path":329},"睡觉","/gists/sleep",{"title":331,"_path":332},"记录奇怪的问题","/gists/solved",{"title":334,"_path":335},"States","/gists/states",{"title":337,"_path":338},"Storage","/gists/storage",{"title":340,"_path":341},"音视频流处理","/gists/stream-cli",{"title":343,"_path":344},"Symbol","/gists/symbol",{"title":346,"_path":347},"系统论","/gists/systems-theory",{"title":349,"_path":350},"任务切片","/gists/task-slice",{"title":352,"_path":353},"技术偏好","/gists/tech-dudge",{"title":355,"_path":356},"Untitled","/gists/untitled",{"title":358,"_path":359},"可变字体","/gists/variable-font",{"title":361,"_path":362},"视觉错觉","/gists/visual-illusion",{"title":364,"_path":365},"SS(SSR)","/gists/vpn",{"title":367,"_path":368},"VS Code 插件开发","/gists/vscode-plugin",{"title":370,"_path":371},"Web Components","/gists/web-components",{"title":373,"_path":374},"Windows","/gists/windows",{"title":376,"_path":377},"查缺补漏","/gists/wrong",{"title":379,"_path":380,"children":381},"我 / About","/hire",[382],{"title":383,"_path":380},"📬 技术简历",{"_path":49,"_dir":385,"_draft":386,"_partial":386,"_locale":387,"title":48,"description":388,"body":389,"_type":4308,"_id":4309,"_source":4310,"_file":4311,"_stem":4312,"_extension":4313},"articles",false,"","忍者秘籍中提到的模板解析器，很短但支持变量和 if 等语句，还是 15 年前的代码！",{"type":390,"children":391,"toc":4303},"root",[392,417,429,434,611,623,743,748,754,759,1867,1872,1877,1882,1993,2006,2467,2773,2784,2883,2896,3067,3072,3091,3130,3135,3202,3207,3260,3920,3967,3972,4046,4059,4064,4069,4230,4235,4256,4279,4284,4297],{"type":393,"tag":394,"props":395,"children":396},"element","p",{},[397,400,406,408,415],{"type":398,"value":399},"text","上回我借着解决 CSS 嵌套解析问题聊到 micro-app 中实现的一个非常精简的 ",{"type":393,"tag":401,"props":402,"children":403},"a",{"href":52},[404],{"type":398,"value":405},"CSS 解析器",{"type":398,"value":407},"，还没过瘾。今天整理笔记的时候发现了角落里的这个模板解析器，那就赶紧擦擦灰尘拉出来聊一聊。这个模板解析器可是有年头了，它是 John Resig 佬 2008 年写的，叫 ",{"type":393,"tag":409,"props":410,"children":412},"code",{"className":411},[],[413],{"type":398,"value":414},"micro-templating",{"type":398,"value":416},"，距今十五年哩。（John Resig 就是写《JavaScript 忍者秘籍》那位）",{"type":393,"tag":394,"props":418,"children":419},{},[420,422,427],{"type":398,"value":421},"令人惊叹的地方是，",{"type":393,"tag":409,"props":423,"children":425},{"className":424},[],[426],{"type":398,"value":414},{"type":398,"value":428}," 的代码和它的名字一样 micro，它能用仅仅 30 行代码完成对模板的处理，并且还有读取 html 模板、缓存、柯里化等额外的高级功能！",{"type":393,"tag":394,"props":430,"children":431},{},[432],{"type":398,"value":433},"可能有些佬没接触过模板解析器，这里给出一个简单的示例。",{"type":393,"tag":435,"props":436,"children":440},"pre",{"className":437,"code":438,"language":439,"meta":387,"style":387},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","parse(`\n  \u003C% if (shouldCount) { %>\n    \u003C% for (var i = 1; i \u003C= 3; i++) { %>\n      \u003Cdiv>hello - \u003C%= i + count %>\u003C/div>\n    \u003C% } %>\n  \u003C% } else { %>\n    \u003Cdiv>noop\u003C/div>\n  \u003C% } %>\n`, {\n  shouldCount: true,\n  count: 1\n})\n","js",[441],{"type":393,"tag":409,"props":442,"children":443},{"__ignoreMap":387},[444,468,478,487,496,505,514,523,532,552,578,597],{"type":393,"tag":445,"props":446,"children":449},"span",{"class":447,"line":448},"line",1,[450,456,462],{"type":393,"tag":445,"props":451,"children":453},{"style":452},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[454],{"type":398,"value":455},"parse",{"type":393,"tag":445,"props":457,"children":459},{"style":458},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[460],{"type":398,"value":461},"(",{"type":393,"tag":445,"props":463,"children":465},{"style":464},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[466],{"type":398,"value":467},"`\n",{"type":393,"tag":445,"props":469,"children":471},{"class":447,"line":470},2,[472],{"type":393,"tag":445,"props":473,"children":475},{"style":474},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[476],{"type":398,"value":477},"  \u003C% if (shouldCount) { %>\n",{"type":393,"tag":445,"props":479,"children":481},{"class":447,"line":480},3,[482],{"type":393,"tag":445,"props":483,"children":484},{"style":474},[485],{"type":398,"value":486},"    \u003C% for (var i = 1; i \u003C= 3; i++) { %>\n",{"type":393,"tag":445,"props":488,"children":490},{"class":447,"line":489},4,[491],{"type":393,"tag":445,"props":492,"children":493},{"style":474},[494],{"type":398,"value":495},"      \u003Cdiv>hello - \u003C%= i + count %>\u003C/div>\n",{"type":393,"tag":445,"props":497,"children":499},{"class":447,"line":498},5,[500],{"type":393,"tag":445,"props":501,"children":502},{"style":474},[503],{"type":398,"value":504},"    \u003C% } %>\n",{"type":393,"tag":445,"props":506,"children":508},{"class":447,"line":507},6,[509],{"type":393,"tag":445,"props":510,"children":511},{"style":474},[512],{"type":398,"value":513},"  \u003C% } else { %>\n",{"type":393,"tag":445,"props":515,"children":517},{"class":447,"line":516},7,[518],{"type":393,"tag":445,"props":519,"children":520},{"style":474},[521],{"type":398,"value":522},"    \u003Cdiv>noop\u003C/div>\n",{"type":393,"tag":445,"props":524,"children":526},{"class":447,"line":525},8,[527],{"type":393,"tag":445,"props":528,"children":529},{"style":474},[530],{"type":398,"value":531},"  \u003C% } %>\n",{"type":393,"tag":445,"props":533,"children":535},{"class":447,"line":534},9,[536,541,547],{"type":393,"tag":445,"props":537,"children":538},{"style":464},[539],{"type":398,"value":540},"`",{"type":393,"tag":445,"props":542,"children":544},{"style":543},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[545],{"type":398,"value":546},",",{"type":393,"tag":445,"props":548,"children":549},{"style":543},[550],{"type":398,"value":551}," {\n",{"type":393,"tag":445,"props":553,"children":555},{"class":447,"line":554},10,[556,562,567,573],{"type":393,"tag":445,"props":557,"children":559},{"style":558},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[560],{"type":398,"value":561},"  shouldCount",{"type":393,"tag":445,"props":563,"children":564},{"style":543},[565],{"type":398,"value":566},":",{"type":393,"tag":445,"props":568,"children":570},{"style":569},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[571],{"type":398,"value":572}," true",{"type":393,"tag":445,"props":574,"children":575},{"style":543},[576],{"type":398,"value":577},",\n",{"type":393,"tag":445,"props":579,"children":581},{"class":447,"line":580},11,[582,587,591],{"type":393,"tag":445,"props":583,"children":584},{"style":558},[585],{"type":398,"value":586},"  count",{"type":393,"tag":445,"props":588,"children":589},{"style":543},[590],{"type":398,"value":566},{"type":393,"tag":445,"props":592,"children":594},{"style":593},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[595],{"type":398,"value":596}," 1\n",{"type":393,"tag":445,"props":598,"children":600},{"class":447,"line":599},12,[601,606],{"type":393,"tag":445,"props":602,"children":603},{"style":543},[604],{"type":398,"value":605},"}",{"type":393,"tag":445,"props":607,"children":608},{"style":458},[609],{"type":398,"value":610},")\n",{"type":393,"tag":394,"props":612,"children":613},{},[614,616,621],{"type":398,"value":615},"给 ",{"type":393,"tag":409,"props":617,"children":619},{"className":618},[],[620],{"type":398,"value":455},{"type":398,"value":622}," 函数传入模板字符串和数据后，自然也是输出字符串啦：",{"type":393,"tag":435,"props":624,"children":628},{"className":625,"code":626,"language":627,"meta":387,"style":387},"language-html shiki shiki-themes material-theme-lighter github-light github-dark monokai","\u003C!-- 以下经过格式化 -->\n\u003Cdiv>hello - 2\u003C/div>\n\u003Cdiv>hello - 3\u003C/div>\n\u003Cdiv>hello - 4\u003C/div>\n","html",[629],{"type":393,"tag":409,"props":630,"children":631},{"__ignoreMap":387},[632,641,679,711],{"type":393,"tag":445,"props":633,"children":634},{"class":447,"line":448},[635],{"type":393,"tag":445,"props":636,"children":638},{"style":637},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[639],{"type":398,"value":640},"\u003C!-- 以下经过格式化 -->\n",{"type":393,"tag":445,"props":642,"children":643},{"class":447,"line":470},[644,649,655,660,665,670,674],{"type":393,"tag":445,"props":645,"children":646},{"style":543},[647],{"type":398,"value":648},"\u003C",{"type":393,"tag":445,"props":650,"children":652},{"style":651},"--shiki-light:#E53935;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[653],{"type":398,"value":654},"div",{"type":393,"tag":445,"props":656,"children":657},{"style":543},[658],{"type":398,"value":659},">",{"type":393,"tag":445,"props":661,"children":662},{"style":458},[663],{"type":398,"value":664},"hello - 2",{"type":393,"tag":445,"props":666,"children":667},{"style":543},[668],{"type":398,"value":669},"\u003C/",{"type":393,"tag":445,"props":671,"children":672},{"style":651},[673],{"type":398,"value":654},{"type":393,"tag":445,"props":675,"children":676},{"style":543},[677],{"type":398,"value":678},">\n",{"type":393,"tag":445,"props":680,"children":681},{"class":447,"line":480},[682,686,690,694,699,703,707],{"type":393,"tag":445,"props":683,"children":684},{"style":543},[685],{"type":398,"value":648},{"type":393,"tag":445,"props":687,"children":688},{"style":651},[689],{"type":398,"value":654},{"type":393,"tag":445,"props":691,"children":692},{"style":543},[693],{"type":398,"value":659},{"type":393,"tag":445,"props":695,"children":696},{"style":458},[697],{"type":398,"value":698},"hello - 3",{"type":393,"tag":445,"props":700,"children":701},{"style":543},[702],{"type":398,"value":669},{"type":393,"tag":445,"props":704,"children":705},{"style":651},[706],{"type":398,"value":654},{"type":393,"tag":445,"props":708,"children":709},{"style":543},[710],{"type":398,"value":678},{"type":393,"tag":445,"props":712,"children":713},{"class":447,"line":489},[714,718,722,726,731,735,739],{"type":393,"tag":445,"props":715,"children":716},{"style":543},[717],{"type":398,"value":648},{"type":393,"tag":445,"props":719,"children":720},{"style":651},[721],{"type":398,"value":654},{"type":393,"tag":445,"props":723,"children":724},{"style":543},[725],{"type":398,"value":659},{"type":393,"tag":445,"props":727,"children":728},{"style":458},[729],{"type":398,"value":730},"hello - 4",{"type":393,"tag":445,"props":732,"children":733},{"style":543},[734],{"type":398,"value":669},{"type":393,"tag":445,"props":736,"children":737},{"style":651},[738],{"type":398,"value":654},{"type":393,"tag":445,"props":740,"children":741},{"style":543},[742],{"type":398,"value":678},{"type":393,"tag":394,"props":744,"children":745},{},[746],{"type":398,"value":747},"相比生态里现在动则 30kb 甚至 300kb 的库，仅 30 行代码完成这个功能，简直不可思议。",{"type":393,"tag":749,"props":750,"children":752},"h2",{"id":751},"完整实现",[753],{"type":398,"value":751},{"type":393,"tag":394,"props":755,"children":756},{},[757],{"type":398,"value":758},"因为代码真的非常短，先直接看一遍，这是带注释版本的。如果你能在第一遍 review 这段代码后脑袋还保持清醒的话，留下评论，我拜你为大哥。",{"type":393,"tag":435,"props":760,"children":762},{"className":437,"code":761,"language":439,"meta":387,"style":387},"// Simple JavaScript Templating\n// John Resig - https://johnresig.com/ - MIT Licensed\n(function () {\n  var cache = {};\n\n  this.tmpl = function tmpl(str, data) {\n    // Figure out if we're getting a template, or if we need to\n    // load the template - and be sure to cache the result.\n    var fn = !/\\W/.test(str)\n      ? (cache[str] =\n          cache[str] || tmpl(document.getElementById(str).innerHTML))\n      : // Generate a reusable function that will serve as a template\n        // generator (and which will be cached).\n        new Function(\n          \"obj\",\n          \"var p=[],print=function(){p.push.apply(p,arguments);};\" +\n            // Introduce the data as local variables using with(){}\n            \"with(obj){p.push('\" +\n            // Convert the template into pure JavaScript\n            str\n              .replace(/[\\r\\t\\n]/g, \" \")\n              .split(\"\u003C%\")\n              .join(\"\\t\")\n              .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\n              .replace(/\\t=(.*?)%>/g, \"',$1,'\")\n              .split(\"\\t\")\n              .join(\"');\")\n              .split(\"%>\")\n              .join(\"p.push('\")\n              .split(\"\\r\")\n              .join(\"\\\\'\") +\n            \"');}return p.join('');\"\n        );\n\n    // Provide some basic currying to the user\n    return data ? fn(data) : fn;\n  };\n})();\n",[763],{"type":393,"tag":409,"props":764,"children":765},{"__ignoreMap":387},[766,774,782,804,828,837,898,906,914,972,1009,1082,1095,1104,1123,1146,1168,1177,1199,1208,1217,1281,1315,1350,1461,1540,1572,1605,1637,1670,1702,1745,1763,1777,1785,1794,1841,1850],{"type":393,"tag":445,"props":767,"children":768},{"class":447,"line":448},[769],{"type":393,"tag":445,"props":770,"children":771},{"style":637},[772],{"type":398,"value":773},"// Simple JavaScript Templating\n",{"type":393,"tag":445,"props":775,"children":776},{"class":447,"line":470},[777],{"type":393,"tag":445,"props":778,"children":779},{"style":637},[780],{"type":398,"value":781},"// John Resig - https://johnresig.com/ - MIT Licensed\n",{"type":393,"tag":445,"props":783,"children":784},{"class":447,"line":480},[785,789,795,800],{"type":393,"tag":445,"props":786,"children":787},{"style":458},[788],{"type":398,"value":461},{"type":393,"tag":445,"props":790,"children":792},{"style":791},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[793],{"type":398,"value":794},"function",{"type":393,"tag":445,"props":796,"children":797},{"style":543},[798],{"type":398,"value":799}," ()",{"type":393,"tag":445,"props":801,"children":802},{"style":543},[803],{"type":398,"value":551},{"type":393,"tag":445,"props":805,"children":806},{"class":447,"line":489},[807,812,817,823],{"type":393,"tag":445,"props":808,"children":809},{"style":791},[810],{"type":398,"value":811},"  var",{"type":393,"tag":445,"props":813,"children":814},{"style":458},[815],{"type":398,"value":816}," cache",{"type":393,"tag":445,"props":818,"children":820},{"style":819},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[821],{"type":398,"value":822}," =",{"type":393,"tag":445,"props":824,"children":825},{"style":543},[826],{"type":398,"value":827}," {};\n",{"type":393,"tag":445,"props":829,"children":830},{"class":447,"line":498},[831],{"type":393,"tag":445,"props":832,"children":834},{"emptyLinePlaceholder":833},true,[835],{"type":398,"value":836},"\n",{"type":393,"tag":445,"props":838,"children":839},{"class":447,"line":507},[840,846,851,856,860,865,870,874,880,884,889,894],{"type":393,"tag":445,"props":841,"children":843},{"style":842},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[844],{"type":398,"value":845},"  this",{"type":393,"tag":445,"props":847,"children":848},{"style":543},[849],{"type":398,"value":850},".",{"type":393,"tag":445,"props":852,"children":853},{"style":452},[854],{"type":398,"value":855},"tmpl",{"type":393,"tag":445,"props":857,"children":858},{"style":819},[859],{"type":398,"value":822},{"type":393,"tag":445,"props":861,"children":862},{"style":791},[863],{"type":398,"value":864}," function",{"type":393,"tag":445,"props":866,"children":867},{"style":452},[868],{"type":398,"value":869}," tmpl",{"type":393,"tag":445,"props":871,"children":872},{"style":543},[873],{"type":398,"value":461},{"type":393,"tag":445,"props":875,"children":877},{"style":876},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[878],{"type":398,"value":879},"str",{"type":393,"tag":445,"props":881,"children":882},{"style":543},[883],{"type":398,"value":546},{"type":393,"tag":445,"props":885,"children":886},{"style":876},[887],{"type":398,"value":888}," data",{"type":393,"tag":445,"props":890,"children":891},{"style":543},[892],{"type":398,"value":893},")",{"type":393,"tag":445,"props":895,"children":896},{"style":543},[897],{"type":398,"value":551},{"type":393,"tag":445,"props":899,"children":900},{"class":447,"line":516},[901],{"type":393,"tag":445,"props":902,"children":903},{"style":637},[904],{"type":398,"value":905},"    // Figure out if we're getting a template, or if we need to\n",{"type":393,"tag":445,"props":907,"children":908},{"class":447,"line":525},[909],{"type":393,"tag":445,"props":910,"children":911},{"style":637},[912],{"type":398,"value":913},"    // load the template - and be sure to cache the result.\n",{"type":393,"tag":445,"props":915,"children":916},{"class":447,"line":534},[917,922,927,931,936,941,947,951,955,960,964,968],{"type":393,"tag":445,"props":918,"children":919},{"style":791},[920],{"type":398,"value":921},"    var",{"type":393,"tag":445,"props":923,"children":924},{"style":458},[925],{"type":398,"value":926}," fn",{"type":393,"tag":445,"props":928,"children":929},{"style":819},[930],{"type":398,"value":822},{"type":393,"tag":445,"props":932,"children":933},{"style":819},[934],{"type":398,"value":935}," !",{"type":393,"tag":445,"props":937,"children":938},{"style":464},[939],{"type":398,"value":940},"/",{"type":393,"tag":445,"props":942,"children":944},{"style":943},"--shiki-light:#91B859;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[945],{"type":398,"value":946},"\\W",{"type":393,"tag":445,"props":948,"children":949},{"style":464},[950],{"type":398,"value":940},{"type":393,"tag":445,"props":952,"children":953},{"style":543},[954],{"type":398,"value":850},{"type":393,"tag":445,"props":956,"children":957},{"style":452},[958],{"type":398,"value":959},"test",{"type":393,"tag":445,"props":961,"children":962},{"style":558},[963],{"type":398,"value":461},{"type":393,"tag":445,"props":965,"children":966},{"style":458},[967],{"type":398,"value":879},{"type":393,"tag":445,"props":969,"children":970},{"style":558},[971],{"type":398,"value":610},{"type":393,"tag":445,"props":973,"children":974},{"class":447,"line":554},[975,980,985,990,995,999,1004],{"type":393,"tag":445,"props":976,"children":977},{"style":819},[978],{"type":398,"value":979},"      ?",{"type":393,"tag":445,"props":981,"children":982},{"style":558},[983],{"type":398,"value":984}," (",{"type":393,"tag":445,"props":986,"children":987},{"style":458},[988],{"type":398,"value":989},"cache",{"type":393,"tag":445,"props":991,"children":992},{"style":558},[993],{"type":398,"value":994},"[",{"type":393,"tag":445,"props":996,"children":997},{"style":458},[998],{"type":398,"value":879},{"type":393,"tag":445,"props":1000,"children":1001},{"style":558},[1002],{"type":398,"value":1003},"] ",{"type":393,"tag":445,"props":1005,"children":1006},{"style":819},[1007],{"type":398,"value":1008},"=\n",{"type":393,"tag":445,"props":1010,"children":1011},{"class":447,"line":580},[1012,1017,1021,1025,1029,1034,1038,1042,1047,1051,1056,1060,1064,1068,1072,1077],{"type":393,"tag":445,"props":1013,"children":1014},{"style":458},[1015],{"type":398,"value":1016},"          cache",{"type":393,"tag":445,"props":1018,"children":1019},{"style":558},[1020],{"type":398,"value":994},{"type":393,"tag":445,"props":1022,"children":1023},{"style":458},[1024],{"type":398,"value":879},{"type":393,"tag":445,"props":1026,"children":1027},{"style":558},[1028],{"type":398,"value":1003},{"type":393,"tag":445,"props":1030,"children":1031},{"style":819},[1032],{"type":398,"value":1033},"||",{"type":393,"tag":445,"props":1035,"children":1036},{"style":452},[1037],{"type":398,"value":869},{"type":393,"tag":445,"props":1039,"children":1040},{"style":558},[1041],{"type":398,"value":461},{"type":393,"tag":445,"props":1043,"children":1044},{"style":458},[1045],{"type":398,"value":1046},"document",{"type":393,"tag":445,"props":1048,"children":1049},{"style":543},[1050],{"type":398,"value":850},{"type":393,"tag":445,"props":1052,"children":1053},{"style":452},[1054],{"type":398,"value":1055},"getElementById",{"type":393,"tag":445,"props":1057,"children":1058},{"style":558},[1059],{"type":398,"value":461},{"type":393,"tag":445,"props":1061,"children":1062},{"style":458},[1063],{"type":398,"value":879},{"type":393,"tag":445,"props":1065,"children":1066},{"style":558},[1067],{"type":398,"value":893},{"type":393,"tag":445,"props":1069,"children":1070},{"style":543},[1071],{"type":398,"value":850},{"type":393,"tag":445,"props":1073,"children":1074},{"style":458},[1075],{"type":398,"value":1076},"innerHTML",{"type":393,"tag":445,"props":1078,"children":1079},{"style":558},[1080],{"type":398,"value":1081},"))\n",{"type":393,"tag":445,"props":1083,"children":1084},{"class":447,"line":599},[1085,1090],{"type":393,"tag":445,"props":1086,"children":1087},{"style":819},[1088],{"type":398,"value":1089},"      :",{"type":393,"tag":445,"props":1091,"children":1092},{"style":637},[1093],{"type":398,"value":1094}," // Generate a reusable function that will serve as a template\n",{"type":393,"tag":445,"props":1096,"children":1098},{"class":447,"line":1097},13,[1099],{"type":393,"tag":445,"props":1100,"children":1101},{"style":637},[1102],{"type":398,"value":1103},"        // generator (and which will be cached).\n",{"type":393,"tag":445,"props":1105,"children":1107},{"class":447,"line":1106},14,[1108,1113,1118],{"type":393,"tag":445,"props":1109,"children":1110},{"style":819},[1111],{"type":398,"value":1112},"        new",{"type":393,"tag":445,"props":1114,"children":1115},{"style":452},[1116],{"type":398,"value":1117}," Function",{"type":393,"tag":445,"props":1119,"children":1120},{"style":558},[1121],{"type":398,"value":1122},"(\n",{"type":393,"tag":445,"props":1124,"children":1126},{"class":447,"line":1125},15,[1127,1132,1137,1142],{"type":393,"tag":445,"props":1128,"children":1129},{"style":464},[1130],{"type":398,"value":1131},"          \"",{"type":393,"tag":445,"props":1133,"children":1134},{"style":474},[1135],{"type":398,"value":1136},"obj",{"type":393,"tag":445,"props":1138,"children":1139},{"style":464},[1140],{"type":398,"value":1141},"\"",{"type":393,"tag":445,"props":1143,"children":1144},{"style":543},[1145],{"type":398,"value":577},{"type":393,"tag":445,"props":1147,"children":1149},{"class":447,"line":1148},16,[1150,1154,1159,1163],{"type":393,"tag":445,"props":1151,"children":1152},{"style":464},[1153],{"type":398,"value":1131},{"type":393,"tag":445,"props":1155,"children":1156},{"style":474},[1157],{"type":398,"value":1158},"var p=[],print=function(){p.push.apply(p,arguments);};",{"type":393,"tag":445,"props":1160,"children":1161},{"style":464},[1162],{"type":398,"value":1141},{"type":393,"tag":445,"props":1164,"children":1165},{"style":819},[1166],{"type":398,"value":1167}," +\n",{"type":393,"tag":445,"props":1169,"children":1171},{"class":447,"line":1170},17,[1172],{"type":393,"tag":445,"props":1173,"children":1174},{"style":637},[1175],{"type":398,"value":1176},"            // Introduce the data as local variables using with(){}\n",{"type":393,"tag":445,"props":1178,"children":1180},{"class":447,"line":1179},18,[1181,1186,1191,1195],{"type":393,"tag":445,"props":1182,"children":1183},{"style":464},[1184],{"type":398,"value":1185},"            \"",{"type":393,"tag":445,"props":1187,"children":1188},{"style":474},[1189],{"type":398,"value":1190},"with(obj){p.push('",{"type":393,"tag":445,"props":1192,"children":1193},{"style":464},[1194],{"type":398,"value":1141},{"type":393,"tag":445,"props":1196,"children":1197},{"style":819},[1198],{"type":398,"value":1167},{"type":393,"tag":445,"props":1200,"children":1202},{"class":447,"line":1201},19,[1203],{"type":393,"tag":445,"props":1204,"children":1205},{"style":637},[1206],{"type":398,"value":1207},"            // Convert the template into pure JavaScript\n",{"type":393,"tag":445,"props":1209,"children":1211},{"class":447,"line":1210},20,[1212],{"type":393,"tag":445,"props":1213,"children":1214},{"style":458},[1215],{"type":398,"value":1216},"            str\n",{"type":393,"tag":445,"props":1218,"children":1220},{"class":447,"line":1219},21,[1221,1226,1231,1235,1239,1244,1249,1254,1258,1264,1268,1273,1277],{"type":393,"tag":445,"props":1222,"children":1223},{"style":543},[1224],{"type":398,"value":1225},"              .",{"type":393,"tag":445,"props":1227,"children":1228},{"style":452},[1229],{"type":398,"value":1230},"replace",{"type":393,"tag":445,"props":1232,"children":1233},{"style":558},[1234],{"type":398,"value":461},{"type":393,"tag":445,"props":1236,"children":1237},{"style":464},[1238],{"type":398,"value":940},{"type":393,"tag":445,"props":1240,"children":1242},{"style":1241},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1243],{"type":398,"value":994},{"type":393,"tag":445,"props":1245,"children":1246},{"style":943},[1247],{"type":398,"value":1248},"\\r\\t\\n",{"type":393,"tag":445,"props":1250,"children":1251},{"style":1241},[1252],{"type":398,"value":1253},"]",{"type":393,"tag":445,"props":1255,"children":1256},{"style":464},[1257],{"type":398,"value":940},{"type":393,"tag":445,"props":1259,"children":1261},{"style":1260},"--shiki-light:#F76D47;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1262],{"type":398,"value":1263},"g",{"type":393,"tag":445,"props":1265,"children":1266},{"style":543},[1267],{"type":398,"value":546},{"type":393,"tag":445,"props":1269,"children":1270},{"style":464},[1271],{"type":398,"value":1272}," \"",{"type":393,"tag":445,"props":1274,"children":1275},{"style":464},[1276],{"type":398,"value":1272},{"type":393,"tag":445,"props":1278,"children":1279},{"style":558},[1280],{"type":398,"value":610},{"type":393,"tag":445,"props":1282,"children":1284},{"class":447,"line":1283},22,[1285,1289,1294,1298,1302,1307,1311],{"type":393,"tag":445,"props":1286,"children":1287},{"style":543},[1288],{"type":398,"value":1225},{"type":393,"tag":445,"props":1290,"children":1291},{"style":452},[1292],{"type":398,"value":1293},"split",{"type":393,"tag":445,"props":1295,"children":1296},{"style":558},[1297],{"type":398,"value":461},{"type":393,"tag":445,"props":1299,"children":1300},{"style":464},[1301],{"type":398,"value":1141},{"type":393,"tag":445,"props":1303,"children":1304},{"style":474},[1305],{"type":398,"value":1306},"\u003C%",{"type":393,"tag":445,"props":1308,"children":1309},{"style":464},[1310],{"type":398,"value":1141},{"type":393,"tag":445,"props":1312,"children":1313},{"style":558},[1314],{"type":398,"value":610},{"type":393,"tag":445,"props":1316,"children":1318},{"class":447,"line":1317},23,[1319,1323,1328,1332,1336,1342,1346],{"type":393,"tag":445,"props":1320,"children":1321},{"style":543},[1322],{"type":398,"value":1225},{"type":393,"tag":445,"props":1324,"children":1325},{"style":452},[1326],{"type":398,"value":1327},"join",{"type":393,"tag":445,"props":1329,"children":1330},{"style":558},[1331],{"type":398,"value":461},{"type":393,"tag":445,"props":1333,"children":1334},{"style":464},[1335],{"type":398,"value":1141},{"type":393,"tag":445,"props":1337,"children":1339},{"style":1338},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1340],{"type":398,"value":1341},"\\t",{"type":393,"tag":445,"props":1343,"children":1344},{"style":464},[1345],{"type":398,"value":1141},{"type":393,"tag":445,"props":1347,"children":1348},{"style":558},[1349],{"type":398,"value":610},{"type":393,"tag":445,"props":1351,"children":1353},{"class":447,"line":1352},24,[1354,1358,1362,1366,1370,1376,1382,1387,1393,1397,1401,1405,1409,1413,1418,1422,1427,1431,1435,1439,1443,1448,1453,1457],{"type":393,"tag":445,"props":1355,"children":1356},{"style":543},[1357],{"type":398,"value":1225},{"type":393,"tag":445,"props":1359,"children":1360},{"style":452},[1361],{"type":398,"value":1230},{"type":393,"tag":445,"props":1363,"children":1364},{"style":558},[1365],{"type":398,"value":461},{"type":393,"tag":445,"props":1367,"children":1368},{"style":464},[1369],{"type":398,"value":940},{"type":393,"tag":445,"props":1371,"children":1373},{"style":1372},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[1374],{"type":398,"value":1375},"((",{"type":393,"tag":445,"props":1377,"children":1379},{"style":1378},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[1380],{"type":398,"value":1381},"^",{"type":393,"tag":445,"props":1383,"children":1384},{"style":819},[1385],{"type":398,"value":1386},"|",{"type":393,"tag":445,"props":1388,"children":1390},{"style":1389},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[1391],{"type":398,"value":1392},"%>",{"type":393,"tag":445,"props":1394,"children":1395},{"style":1372},[1396],{"type":398,"value":893},{"type":393,"tag":445,"props":1398,"children":1399},{"style":1241},[1400],{"type":398,"value":994},{"type":393,"tag":445,"props":1402,"children":1403},{"style":819},[1404],{"type":398,"value":1381},{"type":393,"tag":445,"props":1406,"children":1407},{"style":943},[1408],{"type":398,"value":1341},{"type":393,"tag":445,"props":1410,"children":1411},{"style":1241},[1412],{"type":398,"value":1253},{"type":393,"tag":445,"props":1414,"children":1415},{"style":819},[1416],{"type":398,"value":1417},"*",{"type":393,"tag":445,"props":1419,"children":1420},{"style":1372},[1421],{"type":398,"value":893},{"type":393,"tag":445,"props":1423,"children":1424},{"style":1389},[1425],{"type":398,"value":1426},"'",{"type":393,"tag":445,"props":1428,"children":1429},{"style":464},[1430],{"type":398,"value":940},{"type":393,"tag":445,"props":1432,"children":1433},{"style":1260},[1434],{"type":398,"value":1263},{"type":393,"tag":445,"props":1436,"children":1437},{"style":543},[1438],{"type":398,"value":546},{"type":393,"tag":445,"props":1440,"children":1441},{"style":464},[1442],{"type":398,"value":1272},{"type":393,"tag":445,"props":1444,"children":1445},{"style":474},[1446],{"type":398,"value":1447},"$1",{"type":393,"tag":445,"props":1449,"children":1450},{"style":1338},[1451],{"type":398,"value":1452},"\\r",{"type":393,"tag":445,"props":1454,"children":1455},{"style":464},[1456],{"type":398,"value":1141},{"type":393,"tag":445,"props":1458,"children":1459},{"style":558},[1460],{"type":398,"value":610},{"type":393,"tag":445,"props":1462,"children":1464},{"class":447,"line":1463},25,[1465,1469,1473,1477,1481,1485,1490,1494,1498,1503,1507,1511,1515,1519,1523,1527,1532,1536],{"type":393,"tag":445,"props":1466,"children":1467},{"style":543},[1468],{"type":398,"value":1225},{"type":393,"tag":445,"props":1470,"children":1471},{"style":452},[1472],{"type":398,"value":1230},{"type":393,"tag":445,"props":1474,"children":1475},{"style":558},[1476],{"type":398,"value":461},{"type":393,"tag":445,"props":1478,"children":1479},{"style":464},[1480],{"type":398,"value":940},{"type":393,"tag":445,"props":1482,"children":1483},{"style":943},[1484],{"type":398,"value":1341},{"type":393,"tag":445,"props":1486,"children":1487},{"style":1389},[1488],{"type":398,"value":1489},"=",{"type":393,"tag":445,"props":1491,"children":1492},{"style":1372},[1493],{"type":398,"value":461},{"type":393,"tag":445,"props":1495,"children":1496},{"style":943},[1497],{"type":398,"value":850},{"type":393,"tag":445,"props":1499,"children":1500},{"style":819},[1501],{"type":398,"value":1502},"*?",{"type":393,"tag":445,"props":1504,"children":1505},{"style":1372},[1506],{"type":398,"value":893},{"type":393,"tag":445,"props":1508,"children":1509},{"style":1389},[1510],{"type":398,"value":1392},{"type":393,"tag":445,"props":1512,"children":1513},{"style":464},[1514],{"type":398,"value":940},{"type":393,"tag":445,"props":1516,"children":1517},{"style":1260},[1518],{"type":398,"value":1263},{"type":393,"tag":445,"props":1520,"children":1521},{"style":543},[1522],{"type":398,"value":546},{"type":393,"tag":445,"props":1524,"children":1525},{"style":464},[1526],{"type":398,"value":1272},{"type":393,"tag":445,"props":1528,"children":1529},{"style":474},[1530],{"type":398,"value":1531},"',$1,'",{"type":393,"tag":445,"props":1533,"children":1534},{"style":464},[1535],{"type":398,"value":1141},{"type":393,"tag":445,"props":1537,"children":1538},{"style":558},[1539],{"type":398,"value":610},{"type":393,"tag":445,"props":1541,"children":1543},{"class":447,"line":1542},26,[1544,1548,1552,1556,1560,1564,1568],{"type":393,"tag":445,"props":1545,"children":1546},{"style":543},[1547],{"type":398,"value":1225},{"type":393,"tag":445,"props":1549,"children":1550},{"style":452},[1551],{"type":398,"value":1293},{"type":393,"tag":445,"props":1553,"children":1554},{"style":558},[1555],{"type":398,"value":461},{"type":393,"tag":445,"props":1557,"children":1558},{"style":464},[1559],{"type":398,"value":1141},{"type":393,"tag":445,"props":1561,"children":1562},{"style":1338},[1563],{"type":398,"value":1341},{"type":393,"tag":445,"props":1565,"children":1566},{"style":464},[1567],{"type":398,"value":1141},{"type":393,"tag":445,"props":1569,"children":1570},{"style":558},[1571],{"type":398,"value":610},{"type":393,"tag":445,"props":1573,"children":1575},{"class":447,"line":1574},27,[1576,1580,1584,1588,1592,1597,1601],{"type":393,"tag":445,"props":1577,"children":1578},{"style":543},[1579],{"type":398,"value":1225},{"type":393,"tag":445,"props":1581,"children":1582},{"style":452},[1583],{"type":398,"value":1327},{"type":393,"tag":445,"props":1585,"children":1586},{"style":558},[1587],{"type":398,"value":461},{"type":393,"tag":445,"props":1589,"children":1590},{"style":464},[1591],{"type":398,"value":1141},{"type":393,"tag":445,"props":1593,"children":1594},{"style":474},[1595],{"type":398,"value":1596},"');",{"type":393,"tag":445,"props":1598,"children":1599},{"style":464},[1600],{"type":398,"value":1141},{"type":393,"tag":445,"props":1602,"children":1603},{"style":558},[1604],{"type":398,"value":610},{"type":393,"tag":445,"props":1606,"children":1608},{"class":447,"line":1607},28,[1609,1613,1617,1621,1625,1629,1633],{"type":393,"tag":445,"props":1610,"children":1611},{"style":543},[1612],{"type":398,"value":1225},{"type":393,"tag":445,"props":1614,"children":1615},{"style":452},[1616],{"type":398,"value":1293},{"type":393,"tag":445,"props":1618,"children":1619},{"style":558},[1620],{"type":398,"value":461},{"type":393,"tag":445,"props":1622,"children":1623},{"style":464},[1624],{"type":398,"value":1141},{"type":393,"tag":445,"props":1626,"children":1627},{"style":474},[1628],{"type":398,"value":1392},{"type":393,"tag":445,"props":1630,"children":1631},{"style":464},[1632],{"type":398,"value":1141},{"type":393,"tag":445,"props":1634,"children":1635},{"style":558},[1636],{"type":398,"value":610},{"type":393,"tag":445,"props":1638,"children":1640},{"class":447,"line":1639},29,[1641,1645,1649,1653,1657,1662,1666],{"type":393,"tag":445,"props":1642,"children":1643},{"style":543},[1644],{"type":398,"value":1225},{"type":393,"tag":445,"props":1646,"children":1647},{"style":452},[1648],{"type":398,"value":1327},{"type":393,"tag":445,"props":1650,"children":1651},{"style":558},[1652],{"type":398,"value":461},{"type":393,"tag":445,"props":1654,"children":1655},{"style":464},[1656],{"type":398,"value":1141},{"type":393,"tag":445,"props":1658,"children":1659},{"style":474},[1660],{"type":398,"value":1661},"p.push('",{"type":393,"tag":445,"props":1663,"children":1664},{"style":464},[1665],{"type":398,"value":1141},{"type":393,"tag":445,"props":1667,"children":1668},{"style":558},[1669],{"type":398,"value":610},{"type":393,"tag":445,"props":1671,"children":1673},{"class":447,"line":1672},30,[1674,1678,1682,1686,1690,1694,1698],{"type":393,"tag":445,"props":1675,"children":1676},{"style":543},[1677],{"type":398,"value":1225},{"type":393,"tag":445,"props":1679,"children":1680},{"style":452},[1681],{"type":398,"value":1293},{"type":393,"tag":445,"props":1683,"children":1684},{"style":558},[1685],{"type":398,"value":461},{"type":393,"tag":445,"props":1687,"children":1688},{"style":464},[1689],{"type":398,"value":1141},{"type":393,"tag":445,"props":1691,"children":1692},{"style":1338},[1693],{"type":398,"value":1452},{"type":393,"tag":445,"props":1695,"children":1696},{"style":464},[1697],{"type":398,"value":1141},{"type":393,"tag":445,"props":1699,"children":1700},{"style":558},[1701],{"type":398,"value":610},{"type":393,"tag":445,"props":1703,"children":1705},{"class":447,"line":1704},31,[1706,1710,1714,1718,1722,1727,1731,1735,1740],{"type":393,"tag":445,"props":1707,"children":1708},{"style":543},[1709],{"type":398,"value":1225},{"type":393,"tag":445,"props":1711,"children":1712},{"style":452},[1713],{"type":398,"value":1327},{"type":393,"tag":445,"props":1715,"children":1716},{"style":558},[1717],{"type":398,"value":461},{"type":393,"tag":445,"props":1719,"children":1720},{"style":464},[1721],{"type":398,"value":1141},{"type":393,"tag":445,"props":1723,"children":1724},{"style":1338},[1725],{"type":398,"value":1726},"\\\\",{"type":393,"tag":445,"props":1728,"children":1729},{"style":474},[1730],{"type":398,"value":1426},{"type":393,"tag":445,"props":1732,"children":1733},{"style":464},[1734],{"type":398,"value":1141},{"type":393,"tag":445,"props":1736,"children":1737},{"style":558},[1738],{"type":398,"value":1739},") ",{"type":393,"tag":445,"props":1741,"children":1742},{"style":819},[1743],{"type":398,"value":1744},"+\n",{"type":393,"tag":445,"props":1746,"children":1748},{"class":447,"line":1747},32,[1749,1753,1758],{"type":393,"tag":445,"props":1750,"children":1751},{"style":464},[1752],{"type":398,"value":1185},{"type":393,"tag":445,"props":1754,"children":1755},{"style":474},[1756],{"type":398,"value":1757},"');}return p.join('');",{"type":393,"tag":445,"props":1759,"children":1760},{"style":464},[1761],{"type":398,"value":1762},"\"\n",{"type":393,"tag":445,"props":1764,"children":1766},{"class":447,"line":1765},33,[1767,1772],{"type":393,"tag":445,"props":1768,"children":1769},{"style":558},[1770],{"type":398,"value":1771},"        )",{"type":393,"tag":445,"props":1773,"children":1774},{"style":543},[1775],{"type":398,"value":1776},";\n",{"type":393,"tag":445,"props":1778,"children":1780},{"class":447,"line":1779},34,[1781],{"type":393,"tag":445,"props":1782,"children":1783},{"emptyLinePlaceholder":833},[1784],{"type":398,"value":836},{"type":393,"tag":445,"props":1786,"children":1788},{"class":447,"line":1787},35,[1789],{"type":393,"tag":445,"props":1790,"children":1791},{"style":637},[1792],{"type":398,"value":1793},"    // Provide some basic currying to the user\n",{"type":393,"tag":445,"props":1795,"children":1797},{"class":447,"line":1796},36,[1798,1803,1807,1812,1816,1820,1825,1829,1833,1837],{"type":393,"tag":445,"props":1799,"children":1800},{"style":1378},[1801],{"type":398,"value":1802},"    return",{"type":393,"tag":445,"props":1804,"children":1805},{"style":458},[1806],{"type":398,"value":888},{"type":393,"tag":445,"props":1808,"children":1809},{"style":819},[1810],{"type":398,"value":1811}," ?",{"type":393,"tag":445,"props":1813,"children":1814},{"style":452},[1815],{"type":398,"value":926},{"type":393,"tag":445,"props":1817,"children":1818},{"style":558},[1819],{"type":398,"value":461},{"type":393,"tag":445,"props":1821,"children":1822},{"style":458},[1823],{"type":398,"value":1824},"data",{"type":393,"tag":445,"props":1826,"children":1827},{"style":558},[1828],{"type":398,"value":1739},{"type":393,"tag":445,"props":1830,"children":1831},{"style":819},[1832],{"type":398,"value":566},{"type":393,"tag":445,"props":1834,"children":1835},{"style":458},[1836],{"type":398,"value":926},{"type":393,"tag":445,"props":1838,"children":1839},{"style":543},[1840],{"type":398,"value":1776},{"type":393,"tag":445,"props":1842,"children":1844},{"class":447,"line":1843},37,[1845],{"type":393,"tag":445,"props":1846,"children":1847},{"style":543},[1848],{"type":398,"value":1849},"  };\n",{"type":393,"tag":445,"props":1851,"children":1853},{"class":447,"line":1852},38,[1854,1858,1863],{"type":393,"tag":445,"props":1855,"children":1856},{"style":543},[1857],{"type":398,"value":605},{"type":393,"tag":445,"props":1859,"children":1860},{"style":458},[1861],{"type":398,"value":1862},")()",{"type":393,"tag":445,"props":1864,"children":1865},{"style":543},[1866],{"type":398,"value":1776},{"type":393,"tag":394,"props":1868,"children":1869},{},[1870],{"type":398,"value":1871},"代码看完了，我知道你没看懂，因为曾经我也是。好了，留下三连，解析开始。",{"type":393,"tag":749,"props":1873,"children":1875},{"id":1874},"解析",[1876],{"type":398,"value":1874},{"type":393,"tag":394,"props":1878,"children":1879},{},[1880],{"type":398,"value":1881},"首先，代码最外层是一个 IIFE，给 this 对象挂载了 tmpl 函数，直接执行的话就是 window。内部通过局部变量保存了模板解析的缓存：",{"type":393,"tag":435,"props":1883,"children":1885},{"className":437,"code":1884,"language":439,"meta":387,"style":387},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {};\n})();\n",[1886],{"type":393,"tag":409,"props":1887,"children":1888},{"__ignoreMap":387},[1889,1908,1927,1978],{"type":393,"tag":445,"props":1890,"children":1891},{"class":447,"line":448},[1892,1896,1900,1904],{"type":393,"tag":445,"props":1893,"children":1894},{"style":458},[1895],{"type":398,"value":461},{"type":393,"tag":445,"props":1897,"children":1898},{"style":791},[1899],{"type":398,"value":794},{"type":393,"tag":445,"props":1901,"children":1902},{"style":543},[1903],{"type":398,"value":799},{"type":393,"tag":445,"props":1905,"children":1906},{"style":543},[1907],{"type":398,"value":551},{"type":393,"tag":445,"props":1909,"children":1910},{"class":447,"line":470},[1911,1915,1919,1923],{"type":393,"tag":445,"props":1912,"children":1913},{"style":791},[1914],{"type":398,"value":811},{"type":393,"tag":445,"props":1916,"children":1917},{"style":458},[1918],{"type":398,"value":816},{"type":393,"tag":445,"props":1920,"children":1921},{"style":819},[1922],{"type":398,"value":822},{"type":393,"tag":445,"props":1924,"children":1925},{"style":543},[1926],{"type":398,"value":827},{"type":393,"tag":445,"props":1928,"children":1929},{"class":447,"line":480},[1930,1934,1938,1942,1946,1950,1954,1958,1962,1966,1970,1974],{"type":393,"tag":445,"props":1931,"children":1932},{"style":842},[1933],{"type":398,"value":845},{"type":393,"tag":445,"props":1935,"children":1936},{"style":543},[1937],{"type":398,"value":850},{"type":393,"tag":445,"props":1939,"children":1940},{"style":452},[1941],{"type":398,"value":855},{"type":393,"tag":445,"props":1943,"children":1944},{"style":819},[1945],{"type":398,"value":822},{"type":393,"tag":445,"props":1947,"children":1948},{"style":791},[1949],{"type":398,"value":864},{"type":393,"tag":445,"props":1951,"children":1952},{"style":452},[1953],{"type":398,"value":869},{"type":393,"tag":445,"props":1955,"children":1956},{"style":543},[1957],{"type":398,"value":461},{"type":393,"tag":445,"props":1959,"children":1960},{"style":876},[1961],{"type":398,"value":879},{"type":393,"tag":445,"props":1963,"children":1964},{"style":543},[1965],{"type":398,"value":546},{"type":393,"tag":445,"props":1967,"children":1968},{"style":876},[1969],{"type":398,"value":888},{"type":393,"tag":445,"props":1971,"children":1972},{"style":543},[1973],{"type":398,"value":893},{"type":393,"tag":445,"props":1975,"children":1976},{"style":543},[1977],{"type":398,"value":827},{"type":393,"tag":445,"props":1979,"children":1980},{"class":447,"line":489},[1981,1985,1989],{"type":393,"tag":445,"props":1982,"children":1983},{"style":543},[1984],{"type":398,"value":605},{"type":393,"tag":445,"props":1986,"children":1987},{"style":458},[1988],{"type":398,"value":1862},{"type":393,"tag":445,"props":1990,"children":1991},{"style":543},[1992],{"type":398,"value":1776},{"type":393,"tag":394,"props":1994,"children":1995},{},[1996,1998,2004],{"type":398,"value":1997},"str 参数有两种两种用途，",{"type":393,"tag":409,"props":1999,"children":2001},{"className":2000},[],[2002],{"type":398,"value":2003},"/\\W/.test(str)",{"type":398,"value":2005}," 用来判断字符串中包不包含模板分隔符，如果不含分隔符，即普通字符串，那就当作 ID，从页面对应 ID 的节点中获取内容作为模板。比如，如果 str 为 'user_tmpl'，那么模板函数将会读取页面的以下脚本的内容作为输入：",{"type":393,"tag":435,"props":2007,"children":2009},{"className":625,"code":2008,"language":627,"meta":387,"style":387},"\u003C!-- type=\"text/html\"，所以浏览器并不会执行这串脚本。它只能由 tmpl 来读取... -->\n\u003Cscript type=\"text/html\" id=\"item_tmpl\">\n  \u003Cdiv id=\"\u003C%=id%>\" class=\"\u003C%=(i % 2 == 1 ? \" even\" : \"\")%>\">\n    \u003Cdiv class=\"grid_1 alpha right\">\n      \u003Cimg class=\"righted\" src=\"\u003C%=profile_image_url%>\"/>\n    \u003C/div>\n    \u003Cdiv class=\"grid_6 omega contents\">\n      \u003Cp>\u003Cb>\u003Ca href=\"/\u003C%=from_user%>\">\u003C%=from_user%>\u003C/a>:\u003C/b> \u003C%=text%>\u003C/p>\n    \u003C/div>\n  \u003C/div>\n\u003C/script>\n",[2010],{"type":393,"tag":409,"props":2011,"children":2012},{"__ignoreMap":387},[2013,2021,2082,2166,2203,2264,2280,2316,2421,2436,2452],{"type":393,"tag":445,"props":2014,"children":2015},{"class":447,"line":448},[2016],{"type":393,"tag":445,"props":2017,"children":2018},{"style":637},[2019],{"type":398,"value":2020},"\u003C!-- type=\"text/html\"，所以浏览器并不会执行这串脚本。它只能由 tmpl 来读取... -->\n",{"type":393,"tag":445,"props":2022,"children":2023},{"class":447,"line":470},[2024,2028,2033,2039,2043,2047,2052,2056,2061,2065,2069,2074,2078],{"type":393,"tag":445,"props":2025,"children":2026},{"style":543},[2027],{"type":398,"value":648},{"type":393,"tag":445,"props":2029,"children":2030},{"style":651},[2031],{"type":398,"value":2032},"script",{"type":393,"tag":445,"props":2034,"children":2036},{"style":2035},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[2037],{"type":398,"value":2038}," type",{"type":393,"tag":445,"props":2040,"children":2041},{"style":543},[2042],{"type":398,"value":1489},{"type":393,"tag":445,"props":2044,"children":2045},{"style":464},[2046],{"type":398,"value":1141},{"type":393,"tag":445,"props":2048,"children":2049},{"style":474},[2050],{"type":398,"value":2051},"text/html",{"type":393,"tag":445,"props":2053,"children":2054},{"style":464},[2055],{"type":398,"value":1141},{"type":393,"tag":445,"props":2057,"children":2058},{"style":2035},[2059],{"type":398,"value":2060}," id",{"type":393,"tag":445,"props":2062,"children":2063},{"style":543},[2064],{"type":398,"value":1489},{"type":393,"tag":445,"props":2066,"children":2067},{"style":464},[2068],{"type":398,"value":1141},{"type":393,"tag":445,"props":2070,"children":2071},{"style":474},[2072],{"type":398,"value":2073},"item_tmpl",{"type":393,"tag":445,"props":2075,"children":2076},{"style":464},[2077],{"type":398,"value":1141},{"type":393,"tag":445,"props":2079,"children":2080},{"style":543},[2081],{"type":398,"value":678},{"type":393,"tag":445,"props":2083,"children":2084},{"class":447,"line":480},[2085,2090,2094,2098,2102,2106,2111,2115,2120,2124,2128,2133,2137,2142,2147,2152,2157,2161],{"type":393,"tag":445,"props":2086,"children":2087},{"style":543},[2088],{"type":398,"value":2089},"  \u003C",{"type":393,"tag":445,"props":2091,"children":2092},{"style":651},[2093],{"type":398,"value":654},{"type":393,"tag":445,"props":2095,"children":2096},{"style":2035},[2097],{"type":398,"value":2060},{"type":393,"tag":445,"props":2099,"children":2100},{"style":543},[2101],{"type":398,"value":1489},{"type":393,"tag":445,"props":2103,"children":2104},{"style":464},[2105],{"type":398,"value":1141},{"type":393,"tag":445,"props":2107,"children":2108},{"style":474},[2109],{"type":398,"value":2110},"\u003C%=id%>",{"type":393,"tag":445,"props":2112,"children":2113},{"style":464},[2114],{"type":398,"value":1141},{"type":393,"tag":445,"props":2116,"children":2117},{"style":2035},[2118],{"type":398,"value":2119}," class",{"type":393,"tag":445,"props":2121,"children":2122},{"style":543},[2123],{"type":398,"value":1489},{"type":393,"tag":445,"props":2125,"children":2126},{"style":464},[2127],{"type":398,"value":1141},{"type":393,"tag":445,"props":2129,"children":2130},{"style":474},[2131],{"type":398,"value":2132},"\u003C%=(i % 2 == 1 ? ",{"type":393,"tag":445,"props":2134,"children":2135},{"style":464},[2136],{"type":398,"value":1141},{"type":393,"tag":445,"props":2138,"children":2139},{"style":2035},[2140],{"type":398,"value":2141}," even",{"type":393,"tag":445,"props":2143,"children":2145},{"style":2144},"--shiki-light:#39ADB5;--shiki-light-font-style:inherit;--shiki-default:#B31D28;--shiki-default-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;--shiki-sepia:#F44747;--shiki-sepia-font-style:inherit",[2146],{"type":398,"value":1141},{"type":393,"tag":445,"props":2148,"children":2149},{"style":2035},[2150],{"type":398,"value":2151}," :",{"type":393,"tag":445,"props":2153,"children":2154},{"style":2144},[2155],{"type":398,"value":2156}," \"\")%",{"type":393,"tag":445,"props":2158,"children":2159},{"style":543},[2160],{"type":398,"value":659},{"type":393,"tag":445,"props":2162,"children":2163},{"style":458},[2164],{"type":398,"value":2165},"\">\n",{"type":393,"tag":445,"props":2167,"children":2168},{"class":447,"line":489},[2169,2174,2178,2182,2186,2190,2195,2199],{"type":393,"tag":445,"props":2170,"children":2171},{"style":543},[2172],{"type":398,"value":2173},"    \u003C",{"type":393,"tag":445,"props":2175,"children":2176},{"style":651},[2177],{"type":398,"value":654},{"type":393,"tag":445,"props":2179,"children":2180},{"style":2035},[2181],{"type":398,"value":2119},{"type":393,"tag":445,"props":2183,"children":2184},{"style":543},[2185],{"type":398,"value":1489},{"type":393,"tag":445,"props":2187,"children":2188},{"style":464},[2189],{"type":398,"value":1141},{"type":393,"tag":445,"props":2191,"children":2192},{"style":474},[2193],{"type":398,"value":2194},"grid_1 alpha right",{"type":393,"tag":445,"props":2196,"children":2197},{"style":464},[2198],{"type":398,"value":1141},{"type":393,"tag":445,"props":2200,"children":2201},{"style":543},[2202],{"type":398,"value":678},{"type":393,"tag":445,"props":2204,"children":2205},{"class":447,"line":498},[2206,2211,2216,2220,2224,2228,2233,2237,2242,2246,2250,2255,2259],{"type":393,"tag":445,"props":2207,"children":2208},{"style":543},[2209],{"type":398,"value":2210},"      \u003C",{"type":393,"tag":445,"props":2212,"children":2213},{"style":651},[2214],{"type":398,"value":2215},"img",{"type":393,"tag":445,"props":2217,"children":2218},{"style":2035},[2219],{"type":398,"value":2119},{"type":393,"tag":445,"props":2221,"children":2222},{"style":543},[2223],{"type":398,"value":1489},{"type":393,"tag":445,"props":2225,"children":2226},{"style":464},[2227],{"type":398,"value":1141},{"type":393,"tag":445,"props":2229,"children":2230},{"style":474},[2231],{"type":398,"value":2232},"righted",{"type":393,"tag":445,"props":2234,"children":2235},{"style":464},[2236],{"type":398,"value":1141},{"type":393,"tag":445,"props":2238,"children":2239},{"style":2035},[2240],{"type":398,"value":2241}," src",{"type":393,"tag":445,"props":2243,"children":2244},{"style":543},[2245],{"type":398,"value":1489},{"type":393,"tag":445,"props":2247,"children":2248},{"style":464},[2249],{"type":398,"value":1141},{"type":393,"tag":445,"props":2251,"children":2252},{"style":474},[2253],{"type":398,"value":2254},"\u003C%=profile_image_url%>",{"type":393,"tag":445,"props":2256,"children":2257},{"style":464},[2258],{"type":398,"value":1141},{"type":393,"tag":445,"props":2260,"children":2261},{"style":543},[2262],{"type":398,"value":2263},"/>\n",{"type":393,"tag":445,"props":2265,"children":2266},{"class":447,"line":507},[2267,2272,2276],{"type":393,"tag":445,"props":2268,"children":2269},{"style":543},[2270],{"type":398,"value":2271},"    \u003C/",{"type":393,"tag":445,"props":2273,"children":2274},{"style":651},[2275],{"type":398,"value":654},{"type":393,"tag":445,"props":2277,"children":2278},{"style":543},[2279],{"type":398,"value":678},{"type":393,"tag":445,"props":2281,"children":2282},{"class":447,"line":516},[2283,2287,2291,2295,2299,2303,2308,2312],{"type":393,"tag":445,"props":2284,"children":2285},{"style":543},[2286],{"type":398,"value":2173},{"type":393,"tag":445,"props":2288,"children":2289},{"style":651},[2290],{"type":398,"value":654},{"type":393,"tag":445,"props":2292,"children":2293},{"style":2035},[2294],{"type":398,"value":2119},{"type":393,"tag":445,"props":2296,"children":2297},{"style":543},[2298],{"type":398,"value":1489},{"type":393,"tag":445,"props":2300,"children":2301},{"style":464},[2302],{"type":398,"value":1141},{"type":393,"tag":445,"props":2304,"children":2305},{"style":474},[2306],{"type":398,"value":2307},"grid_6 omega contents",{"type":393,"tag":445,"props":2309,"children":2310},{"style":464},[2311],{"type":398,"value":1141},{"type":393,"tag":445,"props":2313,"children":2314},{"style":543},[2315],{"type":398,"value":678},{"type":393,"tag":445,"props":2317,"children":2318},{"class":447,"line":525},[2319,2323,2327,2332,2337,2341,2345,2350,2354,2358,2363,2367,2371,2376,2380,2384,2388,2392,2396,2400,2404,2409,2413,2417],{"type":393,"tag":445,"props":2320,"children":2321},{"style":543},[2322],{"type":398,"value":2210},{"type":393,"tag":445,"props":2324,"children":2325},{"style":651},[2326],{"type":398,"value":394},{"type":393,"tag":445,"props":2328,"children":2329},{"style":543},[2330],{"type":398,"value":2331},">\u003C",{"type":393,"tag":445,"props":2333,"children":2334},{"style":651},[2335],{"type":398,"value":2336},"b",{"type":393,"tag":445,"props":2338,"children":2339},{"style":543},[2340],{"type":398,"value":2331},{"type":393,"tag":445,"props":2342,"children":2343},{"style":651},[2344],{"type":398,"value":401},{"type":393,"tag":445,"props":2346,"children":2347},{"style":2035},[2348],{"type":398,"value":2349}," href",{"type":393,"tag":445,"props":2351,"children":2352},{"style":543},[2353],{"type":398,"value":1489},{"type":393,"tag":445,"props":2355,"children":2356},{"style":464},[2357],{"type":398,"value":1141},{"type":393,"tag":445,"props":2359,"children":2360},{"style":474},[2361],{"type":398,"value":2362},"/\u003C%=from_user%>",{"type":393,"tag":445,"props":2364,"children":2365},{"style":464},[2366],{"type":398,"value":1141},{"type":393,"tag":445,"props":2368,"children":2369},{"style":543},[2370],{"type":398,"value":659},{"type":393,"tag":445,"props":2372,"children":2373},{"style":458},[2374],{"type":398,"value":2375},"\u003C%=from_user%>",{"type":393,"tag":445,"props":2377,"children":2378},{"style":543},[2379],{"type":398,"value":669},{"type":393,"tag":445,"props":2381,"children":2382},{"style":651},[2383],{"type":398,"value":401},{"type":393,"tag":445,"props":2385,"children":2386},{"style":543},[2387],{"type":398,"value":659},{"type":393,"tag":445,"props":2389,"children":2390},{"style":458},[2391],{"type":398,"value":566},{"type":393,"tag":445,"props":2393,"children":2394},{"style":543},[2395],{"type":398,"value":669},{"type":393,"tag":445,"props":2397,"children":2398},{"style":651},[2399],{"type":398,"value":2336},{"type":393,"tag":445,"props":2401,"children":2402},{"style":543},[2403],{"type":398,"value":659},{"type":393,"tag":445,"props":2405,"children":2406},{"style":458},[2407],{"type":398,"value":2408}," \u003C%=text%>",{"type":393,"tag":445,"props":2410,"children":2411},{"style":543},[2412],{"type":398,"value":669},{"type":393,"tag":445,"props":2414,"children":2415},{"style":651},[2416],{"type":398,"value":394},{"type":393,"tag":445,"props":2418,"children":2419},{"style":543},[2420],{"type":398,"value":678},{"type":393,"tag":445,"props":2422,"children":2423},{"class":447,"line":534},[2424,2428,2432],{"type":393,"tag":445,"props":2425,"children":2426},{"style":543},[2427],{"type":398,"value":2271},{"type":393,"tag":445,"props":2429,"children":2430},{"style":651},[2431],{"type":398,"value":654},{"type":393,"tag":445,"props":2433,"children":2434},{"style":543},[2435],{"type":398,"value":678},{"type":393,"tag":445,"props":2437,"children":2438},{"class":447,"line":554},[2439,2444,2448],{"type":393,"tag":445,"props":2440,"children":2441},{"style":543},[2442],{"type":398,"value":2443},"  \u003C/",{"type":393,"tag":445,"props":2445,"children":2446},{"style":651},[2447],{"type":398,"value":654},{"type":393,"tag":445,"props":2449,"children":2450},{"style":543},[2451],{"type":398,"value":678},{"type":393,"tag":445,"props":2453,"children":2454},{"class":447,"line":580},[2455,2459,2463],{"type":393,"tag":445,"props":2456,"children":2457},{"style":543},[2458],{"type":398,"value":669},{"type":393,"tag":445,"props":2460,"children":2461},{"style":651},[2462],{"type":398,"value":2032},{"type":393,"tag":445,"props":2464,"children":2465},{"style":543},[2466],{"type":398,"value":678},{"type":393,"tag":435,"props":2468,"children":2470},{"className":437,"code":2469,"language":439,"meta":387,"style":387},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {\n    return !/\\W/.test(str)\n      ? // 缓存会将读取脚本内容到模板解析这个过程的解析结果缓存下来\n        (cache[str] =\n          cache[str] ||\n          // 读取脚本内容\n          tmpl(document.getElementById(str).innerHTML))\n      : new Function();\n  };\n})();\n",[2471],{"type":393,"tag":409,"props":2472,"children":2473},{"__ignoreMap":387},[2474,2493,2512,2563,2606,2618,2646,2670,2678,2726,2751,2758],{"type":393,"tag":445,"props":2475,"children":2476},{"class":447,"line":448},[2477,2481,2485,2489],{"type":393,"tag":445,"props":2478,"children":2479},{"style":458},[2480],{"type":398,"value":461},{"type":393,"tag":445,"props":2482,"children":2483},{"style":791},[2484],{"type":398,"value":794},{"type":393,"tag":445,"props":2486,"children":2487},{"style":543},[2488],{"type":398,"value":799},{"type":393,"tag":445,"props":2490,"children":2491},{"style":543},[2492],{"type":398,"value":551},{"type":393,"tag":445,"props":2494,"children":2495},{"class":447,"line":470},[2496,2500,2504,2508],{"type":393,"tag":445,"props":2497,"children":2498},{"style":791},[2499],{"type":398,"value":811},{"type":393,"tag":445,"props":2501,"children":2502},{"style":458},[2503],{"type":398,"value":816},{"type":393,"tag":445,"props":2505,"children":2506},{"style":819},[2507],{"type":398,"value":822},{"type":393,"tag":445,"props":2509,"children":2510},{"style":543},[2511],{"type":398,"value":827},{"type":393,"tag":445,"props":2513,"children":2514},{"class":447,"line":480},[2515,2519,2523,2527,2531,2535,2539,2543,2547,2551,2555,2559],{"type":393,"tag":445,"props":2516,"children":2517},{"style":842},[2518],{"type":398,"value":845},{"type":393,"tag":445,"props":2520,"children":2521},{"style":543},[2522],{"type":398,"value":850},{"type":393,"tag":445,"props":2524,"children":2525},{"style":452},[2526],{"type":398,"value":855},{"type":393,"tag":445,"props":2528,"children":2529},{"style":819},[2530],{"type":398,"value":822},{"type":393,"tag":445,"props":2532,"children":2533},{"style":791},[2534],{"type":398,"value":864},{"type":393,"tag":445,"props":2536,"children":2537},{"style":452},[2538],{"type":398,"value":869},{"type":393,"tag":445,"props":2540,"children":2541},{"style":543},[2542],{"type":398,"value":461},{"type":393,"tag":445,"props":2544,"children":2545},{"style":876},[2546],{"type":398,"value":879},{"type":393,"tag":445,"props":2548,"children":2549},{"style":543},[2550],{"type":398,"value":546},{"type":393,"tag":445,"props":2552,"children":2553},{"style":876},[2554],{"type":398,"value":888},{"type":393,"tag":445,"props":2556,"children":2557},{"style":543},[2558],{"type":398,"value":893},{"type":393,"tag":445,"props":2560,"children":2561},{"style":543},[2562],{"type":398,"value":551},{"type":393,"tag":445,"props":2564,"children":2565},{"class":447,"line":489},[2566,2570,2574,2578,2582,2586,2590,2594,2598,2602],{"type":393,"tag":445,"props":2567,"children":2568},{"style":1378},[2569],{"type":398,"value":1802},{"type":393,"tag":445,"props":2571,"children":2572},{"style":819},[2573],{"type":398,"value":935},{"type":393,"tag":445,"props":2575,"children":2576},{"style":464},[2577],{"type":398,"value":940},{"type":393,"tag":445,"props":2579,"children":2580},{"style":943},[2581],{"type":398,"value":946},{"type":393,"tag":445,"props":2583,"children":2584},{"style":464},[2585],{"type":398,"value":940},{"type":393,"tag":445,"props":2587,"children":2588},{"style":543},[2589],{"type":398,"value":850},{"type":393,"tag":445,"props":2591,"children":2592},{"style":452},[2593],{"type":398,"value":959},{"type":393,"tag":445,"props":2595,"children":2596},{"style":558},[2597],{"type":398,"value":461},{"type":393,"tag":445,"props":2599,"children":2600},{"style":458},[2601],{"type":398,"value":879},{"type":393,"tag":445,"props":2603,"children":2604},{"style":558},[2605],{"type":398,"value":610},{"type":393,"tag":445,"props":2607,"children":2608},{"class":447,"line":498},[2609,2613],{"type":393,"tag":445,"props":2610,"children":2611},{"style":819},[2612],{"type":398,"value":979},{"type":393,"tag":445,"props":2614,"children":2615},{"style":637},[2616],{"type":398,"value":2617}," // 缓存会将读取脚本内容到模板解析这个过程的解析结果缓存下来\n",{"type":393,"tag":445,"props":2619,"children":2620},{"class":447,"line":507},[2621,2626,2630,2634,2638,2642],{"type":393,"tag":445,"props":2622,"children":2623},{"style":558},[2624],{"type":398,"value":2625},"        (",{"type":393,"tag":445,"props":2627,"children":2628},{"style":458},[2629],{"type":398,"value":989},{"type":393,"tag":445,"props":2631,"children":2632},{"style":558},[2633],{"type":398,"value":994},{"type":393,"tag":445,"props":2635,"children":2636},{"style":458},[2637],{"type":398,"value":879},{"type":393,"tag":445,"props":2639,"children":2640},{"style":558},[2641],{"type":398,"value":1003},{"type":393,"tag":445,"props":2643,"children":2644},{"style":819},[2645],{"type":398,"value":1008},{"type":393,"tag":445,"props":2647,"children":2648},{"class":447,"line":516},[2649,2653,2657,2661,2665],{"type":393,"tag":445,"props":2650,"children":2651},{"style":458},[2652],{"type":398,"value":1016},{"type":393,"tag":445,"props":2654,"children":2655},{"style":558},[2656],{"type":398,"value":994},{"type":393,"tag":445,"props":2658,"children":2659},{"style":458},[2660],{"type":398,"value":879},{"type":393,"tag":445,"props":2662,"children":2663},{"style":558},[2664],{"type":398,"value":1003},{"type":393,"tag":445,"props":2666,"children":2667},{"style":819},[2668],{"type":398,"value":2669},"||\n",{"type":393,"tag":445,"props":2671,"children":2672},{"class":447,"line":525},[2673],{"type":393,"tag":445,"props":2674,"children":2675},{"style":637},[2676],{"type":398,"value":2677},"          // 读取脚本内容\n",{"type":393,"tag":445,"props":2679,"children":2680},{"class":447,"line":534},[2681,2686,2690,2694,2698,2702,2706,2710,2714,2718,2722],{"type":393,"tag":445,"props":2682,"children":2683},{"style":452},[2684],{"type":398,"value":2685},"          tmpl",{"type":393,"tag":445,"props":2687,"children":2688},{"style":558},[2689],{"type":398,"value":461},{"type":393,"tag":445,"props":2691,"children":2692},{"style":458},[2693],{"type":398,"value":1046},{"type":393,"tag":445,"props":2695,"children":2696},{"style":543},[2697],{"type":398,"value":850},{"type":393,"tag":445,"props":2699,"children":2700},{"style":452},[2701],{"type":398,"value":1055},{"type":393,"tag":445,"props":2703,"children":2704},{"style":558},[2705],{"type":398,"value":461},{"type":393,"tag":445,"props":2707,"children":2708},{"style":458},[2709],{"type":398,"value":879},{"type":393,"tag":445,"props":2711,"children":2712},{"style":558},[2713],{"type":398,"value":893},{"type":393,"tag":445,"props":2715,"children":2716},{"style":543},[2717],{"type":398,"value":850},{"type":393,"tag":445,"props":2719,"children":2720},{"style":458},[2721],{"type":398,"value":1076},{"type":393,"tag":445,"props":2723,"children":2724},{"style":558},[2725],{"type":398,"value":1081},{"type":393,"tag":445,"props":2727,"children":2728},{"class":447,"line":554},[2729,2733,2738,2742,2747],{"type":393,"tag":445,"props":2730,"children":2731},{"style":819},[2732],{"type":398,"value":1089},{"type":393,"tag":445,"props":2734,"children":2735},{"style":819},[2736],{"type":398,"value":2737}," new",{"type":393,"tag":445,"props":2739,"children":2740},{"style":452},[2741],{"type":398,"value":1117},{"type":393,"tag":445,"props":2743,"children":2744},{"style":558},[2745],{"type":398,"value":2746},"()",{"type":393,"tag":445,"props":2748,"children":2749},{"style":543},[2750],{"type":398,"value":1776},{"type":393,"tag":445,"props":2752,"children":2753},{"class":447,"line":580},[2754],{"type":393,"tag":445,"props":2755,"children":2756},{"style":543},[2757],{"type":398,"value":1849},{"type":393,"tag":445,"props":2759,"children":2760},{"class":447,"line":599},[2761,2765,2769],{"type":393,"tag":445,"props":2762,"children":2763},{"style":543},[2764],{"type":398,"value":605},{"type":393,"tag":445,"props":2766,"children":2767},{"style":458},[2768],{"type":398,"value":1862},{"type":393,"tag":445,"props":2770,"children":2771},{"style":543},[2772],{"type":398,"value":1776},{"type":393,"tag":394,"props":2774,"children":2775},{},[2776,2782],{"type":393,"tag":409,"props":2777,"children":2779},{"className":2778},[],[2780],{"type":398,"value":2781},"new Function()",{"type":398,"value":2783}," 即模板解析的核心内容，原理是用一个数组，保存所有解析内容，再拼接回字符串，作为 JS 执行。类似 eval 函数。",{"type":393,"tag":435,"props":2785,"children":2787},{"className":437,"code":2786,"language":439,"meta":387,"style":387},"new Function(\n  \"obj\",\n  \"var p=[];\" +\n    // + '...'\n    \"return p.join('')\"\n);\n",[2788],{"type":393,"tag":409,"props":2789,"children":2790},{"__ignoreMap":387},[2791,2807,2827,2847,2855,2872],{"type":393,"tag":445,"props":2792,"children":2793},{"class":447,"line":448},[2794,2799,2803],{"type":393,"tag":445,"props":2795,"children":2796},{"style":819},[2797],{"type":398,"value":2798},"new",{"type":393,"tag":445,"props":2800,"children":2801},{"style":452},[2802],{"type":398,"value":1117},{"type":393,"tag":445,"props":2804,"children":2805},{"style":458},[2806],{"type":398,"value":1122},{"type":393,"tag":445,"props":2808,"children":2809},{"class":447,"line":470},[2810,2815,2819,2823],{"type":393,"tag":445,"props":2811,"children":2812},{"style":464},[2813],{"type":398,"value":2814},"  \"",{"type":393,"tag":445,"props":2816,"children":2817},{"style":474},[2818],{"type":398,"value":1136},{"type":393,"tag":445,"props":2820,"children":2821},{"style":464},[2822],{"type":398,"value":1141},{"type":393,"tag":445,"props":2824,"children":2825},{"style":543},[2826],{"type":398,"value":577},{"type":393,"tag":445,"props":2828,"children":2829},{"class":447,"line":480},[2830,2834,2839,2843],{"type":393,"tag":445,"props":2831,"children":2832},{"style":464},[2833],{"type":398,"value":2814},{"type":393,"tag":445,"props":2835,"children":2836},{"style":474},[2837],{"type":398,"value":2838},"var p=[];",{"type":393,"tag":445,"props":2840,"children":2841},{"style":464},[2842],{"type":398,"value":1141},{"type":393,"tag":445,"props":2844,"children":2845},{"style":819},[2846],{"type":398,"value":1167},{"type":393,"tag":445,"props":2848,"children":2849},{"class":447,"line":489},[2850],{"type":393,"tag":445,"props":2851,"children":2852},{"style":637},[2853],{"type":398,"value":2854},"    // + '...'\n",{"type":393,"tag":445,"props":2856,"children":2857},{"class":447,"line":498},[2858,2863,2868],{"type":393,"tag":445,"props":2859,"children":2860},{"style":464},[2861],{"type":398,"value":2862},"    \"",{"type":393,"tag":445,"props":2864,"children":2865},{"style":474},[2866],{"type":398,"value":2867},"return p.join('')",{"type":393,"tag":445,"props":2869,"children":2870},{"style":464},[2871],{"type":398,"value":1762},{"type":393,"tag":445,"props":2873,"children":2874},{"class":447,"line":507},[2875,2879],{"type":393,"tag":445,"props":2876,"children":2877},{"style":458},[2878],{"type":398,"value":893},{"type":393,"tag":445,"props":2880,"children":2881},{"style":543},[2882],{"type":398,"value":1776},{"type":393,"tag":394,"props":2884,"children":2885},{},[2886,2888,2894],{"type":398,"value":2887},"要解析什么内容呢？无非是 ",{"type":393,"tag":409,"props":2889,"children":2891},{"className":2890},[],[2892],{"type":398,"value":2893},"\u003C%=hello%>",{"type":398,"value":2895}," 这种模板字符串。执行过程中，通过 with 语句，将内部变量的求值（hello）转移到参数对象（data.hello）。这个玩意儿在 VueJS 的模板编译中也用到过：",{"type":393,"tag":435,"props":2897,"children":2899},{"className":437,"code":2898,"language":439,"meta":387,"style":387},"/* VueJS */\nwith (vm) {\n  return createVNode(\"p\", { attrs: { hi: hello /* vm.hello */ } }, [\n    createTextNode(\"Hello World\"),\n  ]);\n}\n",[2900],{"type":393,"tag":409,"props":2901,"children":2902},{"__ignoreMap":387},[2903,2911,2929,3014,3047,3059],{"type":393,"tag":445,"props":2904,"children":2905},{"class":447,"line":448},[2906],{"type":393,"tag":445,"props":2907,"children":2908},{"style":637},[2909],{"type":398,"value":2910},"/* VueJS */\n",{"type":393,"tag":445,"props":2912,"children":2913},{"class":447,"line":470},[2914,2919,2924],{"type":393,"tag":445,"props":2915,"children":2916},{"style":1378},[2917],{"type":398,"value":2918},"with",{"type":393,"tag":445,"props":2920,"children":2921},{"style":458},[2922],{"type":398,"value":2923}," (vm) ",{"type":393,"tag":445,"props":2925,"children":2926},{"style":543},[2927],{"type":398,"value":2928},"{\n",{"type":393,"tag":445,"props":2930,"children":2931},{"class":447,"line":480},[2932,2937,2942,2946,2950,2954,2958,2962,2967,2972,2976,2980,2985,2989,2994,2999,3004,3009],{"type":393,"tag":445,"props":2933,"children":2934},{"style":1378},[2935],{"type":398,"value":2936},"  return",{"type":393,"tag":445,"props":2938,"children":2939},{"style":452},[2940],{"type":398,"value":2941}," createVNode",{"type":393,"tag":445,"props":2943,"children":2944},{"style":558},[2945],{"type":398,"value":461},{"type":393,"tag":445,"props":2947,"children":2948},{"style":464},[2949],{"type":398,"value":1141},{"type":393,"tag":445,"props":2951,"children":2952},{"style":474},[2953],{"type":398,"value":394},{"type":393,"tag":445,"props":2955,"children":2956},{"style":464},[2957],{"type":398,"value":1141},{"type":393,"tag":445,"props":2959,"children":2960},{"style":543},[2961],{"type":398,"value":546},{"type":393,"tag":445,"props":2963,"children":2964},{"style":543},[2965],{"type":398,"value":2966}," {",{"type":393,"tag":445,"props":2968,"children":2969},{"style":558},[2970],{"type":398,"value":2971}," attrs",{"type":393,"tag":445,"props":2973,"children":2974},{"style":543},[2975],{"type":398,"value":566},{"type":393,"tag":445,"props":2977,"children":2978},{"style":543},[2979],{"type":398,"value":2966},{"type":393,"tag":445,"props":2981,"children":2982},{"style":558},[2983],{"type":398,"value":2984}," hi",{"type":393,"tag":445,"props":2986,"children":2987},{"style":543},[2988],{"type":398,"value":566},{"type":393,"tag":445,"props":2990,"children":2991},{"style":458},[2992],{"type":398,"value":2993}," hello",{"type":393,"tag":445,"props":2995,"children":2996},{"style":637},[2997],{"type":398,"value":2998}," /* vm.hello */",{"type":393,"tag":445,"props":3000,"children":3001},{"style":543},[3002],{"type":398,"value":3003}," }",{"type":393,"tag":445,"props":3005,"children":3006},{"style":543},[3007],{"type":398,"value":3008}," },",{"type":393,"tag":445,"props":3010,"children":3011},{"style":558},[3012],{"type":398,"value":3013}," [\n",{"type":393,"tag":445,"props":3015,"children":3016},{"class":447,"line":489},[3017,3022,3026,3030,3035,3039,3043],{"type":393,"tag":445,"props":3018,"children":3019},{"style":452},[3020],{"type":398,"value":3021},"    createTextNode",{"type":393,"tag":445,"props":3023,"children":3024},{"style":558},[3025],{"type":398,"value":461},{"type":393,"tag":445,"props":3027,"children":3028},{"style":464},[3029],{"type":398,"value":1141},{"type":393,"tag":445,"props":3031,"children":3032},{"style":474},[3033],{"type":398,"value":3034},"Hello World",{"type":393,"tag":445,"props":3036,"children":3037},{"style":464},[3038],{"type":398,"value":1141},{"type":393,"tag":445,"props":3040,"children":3041},{"style":558},[3042],{"type":398,"value":893},{"type":393,"tag":445,"props":3044,"children":3045},{"style":543},[3046],{"type":398,"value":577},{"type":393,"tag":445,"props":3048,"children":3049},{"class":447,"line":498},[3050,3055],{"type":393,"tag":445,"props":3051,"children":3052},{"style":558},[3053],{"type":398,"value":3054},"  ])",{"type":393,"tag":445,"props":3056,"children":3057},{"style":543},[3058],{"type":398,"value":1776},{"type":393,"tag":445,"props":3060,"children":3061},{"class":447,"line":507},[3062],{"type":393,"tag":445,"props":3063,"children":3064},{"style":543},[3065],{"type":398,"value":3066},"}\n",{"type":393,"tag":394,"props":3068,"children":3069},{},[3070],{"type":398,"value":3071},"那如何解析呢？",{"type":393,"tag":394,"props":3073,"children":3074},{},[3075,3081,3083,3089],{"type":393,"tag":3076,"props":3077,"children":3078},"del",{},[3079],{"type":398,"value":3080},"我们知道",{"type":398,"value":3082},"曾写过经典字符串模板的佬应该知道，",{"type":393,"tag":3084,"props":3085,"children":3086},"strong",{},[3087],{"type":398,"value":3088},"模板字符串一般包含：字符串、变量及逻辑",{"type":398,"value":3090},"。",{"type":393,"tag":3092,"props":3093,"children":3094},"ul",{},[3095,3107,3118],{"type":393,"tag":3096,"props":3097,"children":3098},"li",{},[3099,3101],{"type":398,"value":3100},"字符串 ",{"type":393,"tag":409,"props":3102,"children":3104},{"className":3103},[],[3105],{"type":398,"value":3106},"\u003Chtml>Lionad\u003C/html>",{"type":393,"tag":3096,"props":3108,"children":3109},{},[3110,3112],{"type":398,"value":3111},"带变量 ",{"type":393,"tag":409,"props":3113,"children":3115},{"className":3114},[],[3116],{"type":398,"value":3117},"\u003Chtml>\u003C%=name%>\u003C/html>",{"type":393,"tag":3096,"props":3119,"children":3120},{},[3121,3123,3129],{"type":398,"value":3122},"带逻辑 ",{"type":393,"tag":409,"props":3124,"children":3126},{"className":3125},[],[3127],{"type":398,"value":3128},"\u003C% if(name){ %>\u003Chtml>\u003C%=name%>\u003C/html>\u003C% } %>",{"type":398,"value":3090},{"type":393,"tag":394,"props":3131,"children":3132},{},[3133],{"type":398,"value":3134},"所以解析模板，无非就是把这三种字符串替换成纯粹的 JS 逻辑，作为 new Function 的参数。其中所有中间变量，可以用一个数组来储存：",{"type":393,"tag":3092,"props":3136,"children":3137},{},[3138,3157,3175],{"type":393,"tag":3096,"props":3139,"children":3140},{},[3141,3143,3148,3150,3156],{"type":398,"value":3142},"将普通字符串直接推入作为结果的内容数组，比如 ",{"type":393,"tag":409,"props":3144,"children":3146},{"className":3145},[],[3147],{"type":398,"value":3106},{"type":398,"value":3149}," 应该被解析为 ",{"type":393,"tag":409,"props":3151,"children":3153},{"className":3152},[],[3154],{"type":398,"value":3155},"p.push('\u003Chtml>Lionad\u003C/html>')",{"type":398,"value":3090},{"type":393,"tag":3096,"props":3158,"children":3159},{},[3160,3162,3167,3168,3174],{"type":398,"value":3161},"如果碰到变量，则将变量拆分出来推入数组，如 ",{"type":393,"tag":409,"props":3163,"children":3165},{"className":3164},[],[3166],{"type":398,"value":3117},{"type":398,"value":3149},{"type":393,"tag":409,"props":3169,"children":3171},{"className":3170},[],[3172],{"type":398,"value":3173},"p.push('\u003Chtml>');p.push(name);p.push('\u003C/html>')",{"type":398,"value":3090},{"type":393,"tag":3096,"props":3176,"children":3177},{},[3178,3180,3186,3188,3193,3195,3201],{"type":398,"value":3179},"带逻辑的字符串，由于逻辑本身就是 JS 代码，所以不需要解析为字符串，只需要把两侧的 ",{"type":393,"tag":409,"props":3181,"children":3183},{"className":3182},[],[3184],{"type":398,"value":3185},"\u003C% %>",{"type":398,"value":3187}," 这种模板标志去掉就好了。如 ",{"type":393,"tag":409,"props":3189,"children":3191},{"className":3190},[],[3192],{"type":398,"value":3128},{"type":398,"value":3194}," 应该被解析为：",{"type":393,"tag":409,"props":3196,"children":3198},{"className":3197},[],[3199],{"type":398,"value":3200},"if(name){ p.push('\u003Chtml>');p.push(name);p.push('\u003C/html>') } ",{"type":398,"value":3090},{"type":393,"tag":394,"props":3203,"children":3204},{},[3205],{"type":398,"value":3206},"以下面这段模板为例，我们看看字符串具体的替换规则。",{"type":393,"tag":435,"props":3208,"children":3210},{"className":437,"code":3209,"language":439,"meta":387,"style":387},"str = `\u003C% if (true) { %>\n    \u003Cli>\u003C%=users[i]%>\u003C/li>\n\u003C% } %>`;\n",[3211],{"type":393,"tag":409,"props":3212,"children":3213},{"__ignoreMap":387},[3214,3236,3244],{"type":393,"tag":445,"props":3215,"children":3216},{"class":447,"line":448},[3217,3222,3226,3231],{"type":393,"tag":445,"props":3218,"children":3219},{"style":458},[3220],{"type":398,"value":3221},"str ",{"type":393,"tag":445,"props":3223,"children":3224},{"style":819},[3225],{"type":398,"value":1489},{"type":393,"tag":445,"props":3227,"children":3228},{"style":464},[3229],{"type":398,"value":3230}," `",{"type":393,"tag":445,"props":3232,"children":3233},{"style":474},[3234],{"type":398,"value":3235},"\u003C% if (true) { %>\n",{"type":393,"tag":445,"props":3237,"children":3238},{"class":447,"line":470},[3239],{"type":393,"tag":445,"props":3240,"children":3241},{"style":474},[3242],{"type":398,"value":3243},"    \u003Cli>\u003C%=users[i]%>\u003C/li>\n",{"type":393,"tag":445,"props":3245,"children":3246},{"class":447,"line":480},[3247,3252,3256],{"type":393,"tag":445,"props":3248,"children":3249},{"style":474},[3250],{"type":398,"value":3251},"\u003C% } %>",{"type":393,"tag":445,"props":3253,"children":3254},{"style":464},[3255],{"type":398,"value":540},{"type":393,"tag":445,"props":3257,"children":3258},{"style":543},[3259],{"type":398,"value":1776},{"type":393,"tag":435,"props":3261,"children":3263},{"className":437,"code":3262,"language":439,"meta":387,"style":387},"// with 的使用方法都知道了，with(obj = { a })，那么\n// 就能在内部直接读取 a，不需要写 obj.a\n\"with(obj){p.push('\" +\n  str\n    // 将换行等空白字符转换为空格，这样所有代码都在一行了\n    // '\u003C% if (true) { %>     \u003Cli>\u003C%=users[i]%>\u003C/li> \u003C% } %>'\n    .replace(/[\\r\\t\\n]/g, \" \")\n    // ['', 'if (true) { %>\u003Cli>', '=users[i]%>\u003C/li>', ' } %>']\n    .split(\"\u003C%\")\n    // 因为 \\t 刚才已经被替换成空格了，所以这里可以使用 \\t 用来将不同行的代码字符串“相加”，\n    // 一会儿再拆分时，不会和原先字符串里的字符混淆\n    .join(\"\\t\")\n    // 去掉模板标志两端的引号，在这个例子里不会用到\n    .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\n    // 以下三句最重要，将所有变量推入数组，生成结果形如 `push('xxx',x,'xxx')` 的字符串\n    // 首先，刚才匹配完了 \u003C%，所以 \\t= 开头后边接的就是变量，这里让它转换成 ',x,' 的形式\n    .replace(/\\t=(.*?)%>/g, \"',$1,'\")\n    .split(\"\\t\")\n    // 在刚刚跟 split('\u003C%') 的位置用括号还原，得到了 ',x,'xxx'); 的形式\n    .join(\"');\")\n    // 在 \\t=xxx 那次匹配，已经把变量模板对应的结束标志 %> 匹配完了，\n    // 所以这是处理剩余语句的结束标志，用 split 拆分行后相当于直接把结束标记舍弃了\n    .split(\"%>\")\n    // 最终在每行开头增加 push 方法，形成了 push('xxx',x,'xxx'); 的形式\n    .join(\"p.push('\")\n    // 处理剩余的换行符\n    .split(\"\\r\")\n    .join(\"\\\\'\") +\n  \"');}\";\n",[3264],{"type":393,"tag":409,"props":3265,"children":3266},{"__ignoreMap":387},[3267,3275,3283,3302,3310,3318,3326,3382,3390,3421,3429,3437,3468,3476,3575,3583,3591,3666,3697,3705,3736,3744,3752,3783,3791,3822,3830,3861,3900],{"type":393,"tag":445,"props":3268,"children":3269},{"class":447,"line":448},[3270],{"type":393,"tag":445,"props":3271,"children":3272},{"style":637},[3273],{"type":398,"value":3274},"// with 的使用方法都知道了，with(obj = { a })，那么\n",{"type":393,"tag":445,"props":3276,"children":3277},{"class":447,"line":470},[3278],{"type":393,"tag":445,"props":3279,"children":3280},{"style":637},[3281],{"type":398,"value":3282},"// 就能在内部直接读取 a，不需要写 obj.a\n",{"type":393,"tag":445,"props":3284,"children":3285},{"class":447,"line":480},[3286,3290,3294,3298],{"type":393,"tag":445,"props":3287,"children":3288},{"style":464},[3289],{"type":398,"value":1141},{"type":393,"tag":445,"props":3291,"children":3292},{"style":474},[3293],{"type":398,"value":1190},{"type":393,"tag":445,"props":3295,"children":3296},{"style":464},[3297],{"type":398,"value":1141},{"type":393,"tag":445,"props":3299,"children":3300},{"style":819},[3301],{"type":398,"value":1167},{"type":393,"tag":445,"props":3303,"children":3304},{"class":447,"line":489},[3305],{"type":393,"tag":445,"props":3306,"children":3307},{"style":458},[3308],{"type":398,"value":3309},"  str\n",{"type":393,"tag":445,"props":3311,"children":3312},{"class":447,"line":498},[3313],{"type":393,"tag":445,"props":3314,"children":3315},{"style":637},[3316],{"type":398,"value":3317},"    // 将换行等空白字符转换为空格，这样所有代码都在一行了\n",{"type":393,"tag":445,"props":3319,"children":3320},{"class":447,"line":507},[3321],{"type":393,"tag":445,"props":3322,"children":3323},{"style":637},[3324],{"type":398,"value":3325},"    // '\u003C% if (true) { %>     \u003Cli>\u003C%=users[i]%>\u003C/li> \u003C% } %>'\n",{"type":393,"tag":445,"props":3327,"children":3328},{"class":447,"line":516},[3329,3334,3338,3342,3346,3350,3354,3358,3362,3366,3370,3374,3378],{"type":393,"tag":445,"props":3330,"children":3331},{"style":543},[3332],{"type":398,"value":3333},"    .",{"type":393,"tag":445,"props":3335,"children":3336},{"style":452},[3337],{"type":398,"value":1230},{"type":393,"tag":445,"props":3339,"children":3340},{"style":458},[3341],{"type":398,"value":461},{"type":393,"tag":445,"props":3343,"children":3344},{"style":464},[3345],{"type":398,"value":940},{"type":393,"tag":445,"props":3347,"children":3348},{"style":1241},[3349],{"type":398,"value":994},{"type":393,"tag":445,"props":3351,"children":3352},{"style":943},[3353],{"type":398,"value":1248},{"type":393,"tag":445,"props":3355,"children":3356},{"style":1241},[3357],{"type":398,"value":1253},{"type":393,"tag":445,"props":3359,"children":3360},{"style":464},[3361],{"type":398,"value":940},{"type":393,"tag":445,"props":3363,"children":3364},{"style":1260},[3365],{"type":398,"value":1263},{"type":393,"tag":445,"props":3367,"children":3368},{"style":543},[3369],{"type":398,"value":546},{"type":393,"tag":445,"props":3371,"children":3372},{"style":464},[3373],{"type":398,"value":1272},{"type":393,"tag":445,"props":3375,"children":3376},{"style":464},[3377],{"type":398,"value":1272},{"type":393,"tag":445,"props":3379,"children":3380},{"style":458},[3381],{"type":398,"value":610},{"type":393,"tag":445,"props":3383,"children":3384},{"class":447,"line":525},[3385],{"type":393,"tag":445,"props":3386,"children":3387},{"style":637},[3388],{"type":398,"value":3389},"    // ['', 'if (true) { %>\u003Cli>', '=users[i]%>\u003C/li>', ' } %>']\n",{"type":393,"tag":445,"props":3391,"children":3392},{"class":447,"line":534},[3393,3397,3401,3405,3409,3413,3417],{"type":393,"tag":445,"props":3394,"children":3395},{"style":543},[3396],{"type":398,"value":3333},{"type":393,"tag":445,"props":3398,"children":3399},{"style":452},[3400],{"type":398,"value":1293},{"type":393,"tag":445,"props":3402,"children":3403},{"style":458},[3404],{"type":398,"value":461},{"type":393,"tag":445,"props":3406,"children":3407},{"style":464},[3408],{"type":398,"value":1141},{"type":393,"tag":445,"props":3410,"children":3411},{"style":474},[3412],{"type":398,"value":1306},{"type":393,"tag":445,"props":3414,"children":3415},{"style":464},[3416],{"type":398,"value":1141},{"type":393,"tag":445,"props":3418,"children":3419},{"style":458},[3420],{"type":398,"value":610},{"type":393,"tag":445,"props":3422,"children":3423},{"class":447,"line":554},[3424],{"type":393,"tag":445,"props":3425,"children":3426},{"style":637},[3427],{"type":398,"value":3428},"    // 因为 \\t 刚才已经被替换成空格了，所以这里可以使用 \\t 用来将不同行的代码字符串“相加”，\n",{"type":393,"tag":445,"props":3430,"children":3431},{"class":447,"line":580},[3432],{"type":393,"tag":445,"props":3433,"children":3434},{"style":637},[3435],{"type":398,"value":3436},"    // 一会儿再拆分时，不会和原先字符串里的字符混淆\n",{"type":393,"tag":445,"props":3438,"children":3439},{"class":447,"line":599},[3440,3444,3448,3452,3456,3460,3464],{"type":393,"tag":445,"props":3441,"children":3442},{"style":543},[3443],{"type":398,"value":3333},{"type":393,"tag":445,"props":3445,"children":3446},{"style":452},[3447],{"type":398,"value":1327},{"type":393,"tag":445,"props":3449,"children":3450},{"style":458},[3451],{"type":398,"value":461},{"type":393,"tag":445,"props":3453,"children":3454},{"style":464},[3455],{"type":398,"value":1141},{"type":393,"tag":445,"props":3457,"children":3458},{"style":1338},[3459],{"type":398,"value":1341},{"type":393,"tag":445,"props":3461,"children":3462},{"style":464},[3463],{"type":398,"value":1141},{"type":393,"tag":445,"props":3465,"children":3466},{"style":458},[3467],{"type":398,"value":610},{"type":393,"tag":445,"props":3469,"children":3470},{"class":447,"line":1097},[3471],{"type":393,"tag":445,"props":3472,"children":3473},{"style":637},[3474],{"type":398,"value":3475},"    // 去掉模板标志两端的引号，在这个例子里不会用到\n",{"type":393,"tag":445,"props":3477,"children":3478},{"class":447,"line":1106},[3479,3483,3487,3491,3495,3499,3503,3507,3511,3515,3519,3523,3527,3531,3535,3539,3543,3547,3551,3555,3559,3563,3567,3571],{"type":393,"tag":445,"props":3480,"children":3481},{"style":543},[3482],{"type":398,"value":3333},{"type":393,"tag":445,"props":3484,"children":3485},{"style":452},[3486],{"type":398,"value":1230},{"type":393,"tag":445,"props":3488,"children":3489},{"style":458},[3490],{"type":398,"value":461},{"type":393,"tag":445,"props":3492,"children":3493},{"style":464},[3494],{"type":398,"value":940},{"type":393,"tag":445,"props":3496,"children":3497},{"style":1372},[3498],{"type":398,"value":1375},{"type":393,"tag":445,"props":3500,"children":3501},{"style":1378},[3502],{"type":398,"value":1381},{"type":393,"tag":445,"props":3504,"children":3505},{"style":819},[3506],{"type":398,"value":1386},{"type":393,"tag":445,"props":3508,"children":3509},{"style":1389},[3510],{"type":398,"value":1392},{"type":393,"tag":445,"props":3512,"children":3513},{"style":1372},[3514],{"type":398,"value":893},{"type":393,"tag":445,"props":3516,"children":3517},{"style":1241},[3518],{"type":398,"value":994},{"type":393,"tag":445,"props":3520,"children":3521},{"style":819},[3522],{"type":398,"value":1381},{"type":393,"tag":445,"props":3524,"children":3525},{"style":943},[3526],{"type":398,"value":1341},{"type":393,"tag":445,"props":3528,"children":3529},{"style":1241},[3530],{"type":398,"value":1253},{"type":393,"tag":445,"props":3532,"children":3533},{"style":819},[3534],{"type":398,"value":1417},{"type":393,"tag":445,"props":3536,"children":3537},{"style":1372},[3538],{"type":398,"value":893},{"type":393,"tag":445,"props":3540,"children":3541},{"style":1389},[3542],{"type":398,"value":1426},{"type":393,"tag":445,"props":3544,"children":3545},{"style":464},[3546],{"type":398,"value":940},{"type":393,"tag":445,"props":3548,"children":3549},{"style":1260},[3550],{"type":398,"value":1263},{"type":393,"tag":445,"props":3552,"children":3553},{"style":543},[3554],{"type":398,"value":546},{"type":393,"tag":445,"props":3556,"children":3557},{"style":464},[3558],{"type":398,"value":1272},{"type":393,"tag":445,"props":3560,"children":3561},{"style":474},[3562],{"type":398,"value":1447},{"type":393,"tag":445,"props":3564,"children":3565},{"style":1338},[3566],{"type":398,"value":1452},{"type":393,"tag":445,"props":3568,"children":3569},{"style":464},[3570],{"type":398,"value":1141},{"type":393,"tag":445,"props":3572,"children":3573},{"style":458},[3574],{"type":398,"value":610},{"type":393,"tag":445,"props":3576,"children":3577},{"class":447,"line":1125},[3578],{"type":393,"tag":445,"props":3579,"children":3580},{"style":637},[3581],{"type":398,"value":3582},"    // 以下三句最重要，将所有变量推入数组，生成结果形如 `push('xxx',x,'xxx')` 的字符串\n",{"type":393,"tag":445,"props":3584,"children":3585},{"class":447,"line":1148},[3586],{"type":393,"tag":445,"props":3587,"children":3588},{"style":637},[3589],{"type":398,"value":3590},"    // 首先，刚才匹配完了 \u003C%，所以 \\t= 开头后边接的就是变量，这里让它转换成 ',x,' 的形式\n",{"type":393,"tag":445,"props":3592,"children":3593},{"class":447,"line":1170},[3594,3598,3602,3606,3610,3614,3618,3622,3626,3630,3634,3638,3642,3646,3650,3654,3658,3662],{"type":393,"tag":445,"props":3595,"children":3596},{"style":543},[3597],{"type":398,"value":3333},{"type":393,"tag":445,"props":3599,"children":3600},{"style":452},[3601],{"type":398,"value":1230},{"type":393,"tag":445,"props":3603,"children":3604},{"style":458},[3605],{"type":398,"value":461},{"type":393,"tag":445,"props":3607,"children":3608},{"style":464},[3609],{"type":398,"value":940},{"type":393,"tag":445,"props":3611,"children":3612},{"style":943},[3613],{"type":398,"value":1341},{"type":393,"tag":445,"props":3615,"children":3616},{"style":1389},[3617],{"type":398,"value":1489},{"type":393,"tag":445,"props":3619,"children":3620},{"style":1372},[3621],{"type":398,"value":461},{"type":393,"tag":445,"props":3623,"children":3624},{"style":943},[3625],{"type":398,"value":850},{"type":393,"tag":445,"props":3627,"children":3628},{"style":819},[3629],{"type":398,"value":1502},{"type":393,"tag":445,"props":3631,"children":3632},{"style":1372},[3633],{"type":398,"value":893},{"type":393,"tag":445,"props":3635,"children":3636},{"style":1389},[3637],{"type":398,"value":1392},{"type":393,"tag":445,"props":3639,"children":3640},{"style":464},[3641],{"type":398,"value":940},{"type":393,"tag":445,"props":3643,"children":3644},{"style":1260},[3645],{"type":398,"value":1263},{"type":393,"tag":445,"props":3647,"children":3648},{"style":543},[3649],{"type":398,"value":546},{"type":393,"tag":445,"props":3651,"children":3652},{"style":464},[3653],{"type":398,"value":1272},{"type":393,"tag":445,"props":3655,"children":3656},{"style":474},[3657],{"type":398,"value":1531},{"type":393,"tag":445,"props":3659,"children":3660},{"style":464},[3661],{"type":398,"value":1141},{"type":393,"tag":445,"props":3663,"children":3664},{"style":458},[3665],{"type":398,"value":610},{"type":393,"tag":445,"props":3667,"children":3668},{"class":447,"line":1179},[3669,3673,3677,3681,3685,3689,3693],{"type":393,"tag":445,"props":3670,"children":3671},{"style":543},[3672],{"type":398,"value":3333},{"type":393,"tag":445,"props":3674,"children":3675},{"style":452},[3676],{"type":398,"value":1293},{"type":393,"tag":445,"props":3678,"children":3679},{"style":458},[3680],{"type":398,"value":461},{"type":393,"tag":445,"props":3682,"children":3683},{"style":464},[3684],{"type":398,"value":1141},{"type":393,"tag":445,"props":3686,"children":3687},{"style":1338},[3688],{"type":398,"value":1341},{"type":393,"tag":445,"props":3690,"children":3691},{"style":464},[3692],{"type":398,"value":1141},{"type":393,"tag":445,"props":3694,"children":3695},{"style":458},[3696],{"type":398,"value":610},{"type":393,"tag":445,"props":3698,"children":3699},{"class":447,"line":1201},[3700],{"type":393,"tag":445,"props":3701,"children":3702},{"style":637},[3703],{"type":398,"value":3704},"    // 在刚刚跟 split('\u003C%') 的位置用括号还原，得到了 ',x,'xxx'); 的形式\n",{"type":393,"tag":445,"props":3706,"children":3707},{"class":447,"line":1210},[3708,3712,3716,3720,3724,3728,3732],{"type":393,"tag":445,"props":3709,"children":3710},{"style":543},[3711],{"type":398,"value":3333},{"type":393,"tag":445,"props":3713,"children":3714},{"style":452},[3715],{"type":398,"value":1327},{"type":393,"tag":445,"props":3717,"children":3718},{"style":458},[3719],{"type":398,"value":461},{"type":393,"tag":445,"props":3721,"children":3722},{"style":464},[3723],{"type":398,"value":1141},{"type":393,"tag":445,"props":3725,"children":3726},{"style":474},[3727],{"type":398,"value":1596},{"type":393,"tag":445,"props":3729,"children":3730},{"style":464},[3731],{"type":398,"value":1141},{"type":393,"tag":445,"props":3733,"children":3734},{"style":458},[3735],{"type":398,"value":610},{"type":393,"tag":445,"props":3737,"children":3738},{"class":447,"line":1219},[3739],{"type":393,"tag":445,"props":3740,"children":3741},{"style":637},[3742],{"type":398,"value":3743},"    // 在 \\t=xxx 那次匹配，已经把变量模板对应的结束标志 %> 匹配完了，\n",{"type":393,"tag":445,"props":3745,"children":3746},{"class":447,"line":1283},[3747],{"type":393,"tag":445,"props":3748,"children":3749},{"style":637},[3750],{"type":398,"value":3751},"    // 所以这是处理剩余语句的结束标志，用 split 拆分行后相当于直接把结束标记舍弃了\n",{"type":393,"tag":445,"props":3753,"children":3754},{"class":447,"line":1317},[3755,3759,3763,3767,3771,3775,3779],{"type":393,"tag":445,"props":3756,"children":3757},{"style":543},[3758],{"type":398,"value":3333},{"type":393,"tag":445,"props":3760,"children":3761},{"style":452},[3762],{"type":398,"value":1293},{"type":393,"tag":445,"props":3764,"children":3765},{"style":458},[3766],{"type":398,"value":461},{"type":393,"tag":445,"props":3768,"children":3769},{"style":464},[3770],{"type":398,"value":1141},{"type":393,"tag":445,"props":3772,"children":3773},{"style":474},[3774],{"type":398,"value":1392},{"type":393,"tag":445,"props":3776,"children":3777},{"style":464},[3778],{"type":398,"value":1141},{"type":393,"tag":445,"props":3780,"children":3781},{"style":458},[3782],{"type":398,"value":610},{"type":393,"tag":445,"props":3784,"children":3785},{"class":447,"line":1352},[3786],{"type":393,"tag":445,"props":3787,"children":3788},{"style":637},[3789],{"type":398,"value":3790},"    // 最终在每行开头增加 push 方法，形成了 push('xxx',x,'xxx'); 的形式\n",{"type":393,"tag":445,"props":3792,"children":3793},{"class":447,"line":1463},[3794,3798,3802,3806,3810,3814,3818],{"type":393,"tag":445,"props":3795,"children":3796},{"style":543},[3797],{"type":398,"value":3333},{"type":393,"tag":445,"props":3799,"children":3800},{"style":452},[3801],{"type":398,"value":1327},{"type":393,"tag":445,"props":3803,"children":3804},{"style":458},[3805],{"type":398,"value":461},{"type":393,"tag":445,"props":3807,"children":3808},{"style":464},[3809],{"type":398,"value":1141},{"type":393,"tag":445,"props":3811,"children":3812},{"style":474},[3813],{"type":398,"value":1661},{"type":393,"tag":445,"props":3815,"children":3816},{"style":464},[3817],{"type":398,"value":1141},{"type":393,"tag":445,"props":3819,"children":3820},{"style":458},[3821],{"type":398,"value":610},{"type":393,"tag":445,"props":3823,"children":3824},{"class":447,"line":1542},[3825],{"type":393,"tag":445,"props":3826,"children":3827},{"style":637},[3828],{"type":398,"value":3829},"    // 处理剩余的换行符\n",{"type":393,"tag":445,"props":3831,"children":3832},{"class":447,"line":1574},[3833,3837,3841,3845,3849,3853,3857],{"type":393,"tag":445,"props":3834,"children":3835},{"style":543},[3836],{"type":398,"value":3333},{"type":393,"tag":445,"props":3838,"children":3839},{"style":452},[3840],{"type":398,"value":1293},{"type":393,"tag":445,"props":3842,"children":3843},{"style":458},[3844],{"type":398,"value":461},{"type":393,"tag":445,"props":3846,"children":3847},{"style":464},[3848],{"type":398,"value":1141},{"type":393,"tag":445,"props":3850,"children":3851},{"style":1338},[3852],{"type":398,"value":1452},{"type":393,"tag":445,"props":3854,"children":3855},{"style":464},[3856],{"type":398,"value":1141},{"type":393,"tag":445,"props":3858,"children":3859},{"style":458},[3860],{"type":398,"value":610},{"type":393,"tag":445,"props":3862,"children":3863},{"class":447,"line":1607},[3864,3868,3872,3876,3880,3884,3888,3892,3896],{"type":393,"tag":445,"props":3865,"children":3866},{"style":543},[3867],{"type":398,"value":3333},{"type":393,"tag":445,"props":3869,"children":3870},{"style":452},[3871],{"type":398,"value":1327},{"type":393,"tag":445,"props":3873,"children":3874},{"style":458},[3875],{"type":398,"value":461},{"type":393,"tag":445,"props":3877,"children":3878},{"style":464},[3879],{"type":398,"value":1141},{"type":393,"tag":445,"props":3881,"children":3882},{"style":1338},[3883],{"type":398,"value":1726},{"type":393,"tag":445,"props":3885,"children":3886},{"style":474},[3887],{"type":398,"value":1426},{"type":393,"tag":445,"props":3889,"children":3890},{"style":464},[3891],{"type":398,"value":1141},{"type":393,"tag":445,"props":3893,"children":3894},{"style":458},[3895],{"type":398,"value":1739},{"type":393,"tag":445,"props":3897,"children":3898},{"style":819},[3899],{"type":398,"value":1744},{"type":393,"tag":445,"props":3901,"children":3902},{"class":447,"line":1639},[3903,3907,3912,3916],{"type":393,"tag":445,"props":3904,"children":3905},{"style":464},[3906],{"type":398,"value":2814},{"type":393,"tag":445,"props":3908,"children":3909},{"style":474},[3910],{"type":398,"value":3911},"');}",{"type":393,"tag":445,"props":3913,"children":3914},{"style":464},[3915],{"type":398,"value":1141},{"type":393,"tag":445,"props":3917,"children":3918},{"style":543},[3919],{"type":398,"value":1776},{"type":393,"tag":394,"props":3921,"children":3922},{},[3923,3925,3930,3932,3937,3939,3944,3945,3951,3953,3958,3960,3965],{"type":398,"value":3924},"有一个小细节，字符串替换时，所有逻辑语句的模板标志开头和结尾（",{"type":393,"tag":409,"props":3926,"children":3928},{"className":3927},[],[3929],{"type":398,"value":1306},{"type":398,"value":3931},"、",{"type":393,"tag":409,"props":3933,"children":3935},{"className":3934},[],[3936],{"type":398,"value":1392},{"type":398,"value":3938},"）分别被替换为 ",{"type":393,"tag":409,"props":3940,"children":3942},{"className":3941},[],[3943],{"type":398,"value":1596},{"type":398,"value":3931},{"type":393,"tag":409,"props":3946,"children":3948},{"className":3947},[],[3949],{"type":398,"value":3950},"push('",{"type":398,"value":3952},"，但是开头和结尾的那个标志，并没有对应的匹配。所以在代码中，能看 ",{"type":393,"tag":409,"props":3954,"children":3956},{"className":3955},[],[3957],{"type":398,"value":1190},{"type":398,"value":3959}," 和 ",{"type":393,"tag":409,"props":3961,"children":3963},{"className":3962},[],[3964],{"type":398,"value":1596},{"type":398,"value":3966}," 这种手动补全。",{"type":393,"tag":394,"props":3968,"children":3969},{},[3970],{"type":398,"value":3971},"最终生成的字符串如下（已格式化处理）：",{"type":393,"tag":435,"props":3973,"children":3975},{"className":437,"code":3974,"language":439,"meta":387,"style":387},"`with(obj){\n    p.push(''); \n    if (true) { \n        p.push('     \u003Cli>',users[i],'\u003C/li>   '); \n    } \n    p.push('');\n}`;\n",[3976],{"type":393,"tag":409,"props":3977,"children":3978},{"__ignoreMap":387},[3979,3991,3999,4007,4015,4023,4031],{"type":393,"tag":445,"props":3980,"children":3981},{"class":447,"line":448},[3982,3986],{"type":393,"tag":445,"props":3983,"children":3984},{"style":464},[3985],{"type":398,"value":540},{"type":393,"tag":445,"props":3987,"children":3988},{"style":474},[3989],{"type":398,"value":3990},"with(obj){\n",{"type":393,"tag":445,"props":3992,"children":3993},{"class":447,"line":470},[3994],{"type":393,"tag":445,"props":3995,"children":3996},{"style":474},[3997],{"type":398,"value":3998},"    p.push(''); \n",{"type":393,"tag":445,"props":4000,"children":4001},{"class":447,"line":480},[4002],{"type":393,"tag":445,"props":4003,"children":4004},{"style":474},[4005],{"type":398,"value":4006},"    if (true) { \n",{"type":393,"tag":445,"props":4008,"children":4009},{"class":447,"line":489},[4010],{"type":393,"tag":445,"props":4011,"children":4012},{"style":474},[4013],{"type":398,"value":4014},"        p.push('     \u003Cli>',users[i],'\u003C/li>   '); \n",{"type":393,"tag":445,"props":4016,"children":4017},{"class":447,"line":498},[4018],{"type":393,"tag":445,"props":4019,"children":4020},{"style":474},[4021],{"type":398,"value":4022},"    } \n",{"type":393,"tag":445,"props":4024,"children":4025},{"class":447,"line":507},[4026],{"type":393,"tag":445,"props":4027,"children":4028},{"style":474},[4029],{"type":398,"value":4030},"    p.push('');\n",{"type":393,"tag":445,"props":4032,"children":4033},{"class":447,"line":516},[4034,4038,4042],{"type":393,"tag":445,"props":4035,"children":4036},{"style":474},[4037],{"type":398,"value":605},{"type":393,"tag":445,"props":4039,"children":4040},{"style":464},[4041],{"type":398,"value":540},{"type":393,"tag":445,"props":4043,"children":4044},{"style":543},[4045],{"type":398,"value":1776},{"type":393,"tag":394,"props":4047,"children":4048},{},[4049,4051,4057],{"type":398,"value":4050},"为什么 with 语句里有一行空的 ",{"type":393,"tag":409,"props":4052,"children":4054},{"className":4053},[],[4055],{"type":398,"value":4056},"push('')",{"type":398,"value":4058}," 呢？",{"type":393,"tag":394,"props":4060,"children":4061},{},[4062],{"type":398,"value":4063},"还记得原始的模板吗？一开的模板是以“\u003C%”开头的，而“\u003C%”在替换过程被右括号取代了，此时正好和初始字符串结合形成了空 push。如果原始字符串开头是 \"123\u003C% if (true)\"，那这行空 push 会转换成“p.push('123');”，也是正确的代码。",{"type":393,"tag":394,"props":4065,"children":4066},{},[4067],{"type":398,"value":4068},"最后，micro-templating 需要返回这个新函数。如果不传参数 data 给模板函数，则会返回一个部分应用的函数等待用户输入 data 参数再执行模板解析；如果已经传了 data 那就会立即调用返回模板解析的结果。",{"type":393,"tag":435,"props":4070,"children":4072},{"className":437,"code":4071,"language":439,"meta":387,"style":387},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {\n    return data ? fn(data) : fn;\n  };\n})();\n",[4073],{"type":393,"tag":409,"props":4074,"children":4075},{"__ignoreMap":387},[4076,4095,4114,4165,4208,4215],{"type":393,"tag":445,"props":4077,"children":4078},{"class":447,"line":448},[4079,4083,4087,4091],{"type":393,"tag":445,"props":4080,"children":4081},{"style":458},[4082],{"type":398,"value":461},{"type":393,"tag":445,"props":4084,"children":4085},{"style":791},[4086],{"type":398,"value":794},{"type":393,"tag":445,"props":4088,"children":4089},{"style":543},[4090],{"type":398,"value":799},{"type":393,"tag":445,"props":4092,"children":4093},{"style":543},[4094],{"type":398,"value":551},{"type":393,"tag":445,"props":4096,"children":4097},{"class":447,"line":470},[4098,4102,4106,4110],{"type":393,"tag":445,"props":4099,"children":4100},{"style":791},[4101],{"type":398,"value":811},{"type":393,"tag":445,"props":4103,"children":4104},{"style":458},[4105],{"type":398,"value":816},{"type":393,"tag":445,"props":4107,"children":4108},{"style":819},[4109],{"type":398,"value":822},{"type":393,"tag":445,"props":4111,"children":4112},{"style":543},[4113],{"type":398,"value":827},{"type":393,"tag":445,"props":4115,"children":4116},{"class":447,"line":480},[4117,4121,4125,4129,4133,4137,4141,4145,4149,4153,4157,4161],{"type":393,"tag":445,"props":4118,"children":4119},{"style":842},[4120],{"type":398,"value":845},{"type":393,"tag":445,"props":4122,"children":4123},{"style":543},[4124],{"type":398,"value":850},{"type":393,"tag":445,"props":4126,"children":4127},{"style":452},[4128],{"type":398,"value":855},{"type":393,"tag":445,"props":4130,"children":4131},{"style":819},[4132],{"type":398,"value":822},{"type":393,"tag":445,"props":4134,"children":4135},{"style":791},[4136],{"type":398,"value":864},{"type":393,"tag":445,"props":4138,"children":4139},{"style":452},[4140],{"type":398,"value":869},{"type":393,"tag":445,"props":4142,"children":4143},{"style":543},[4144],{"type":398,"value":461},{"type":393,"tag":445,"props":4146,"children":4147},{"style":876},[4148],{"type":398,"value":879},{"type":393,"tag":445,"props":4150,"children":4151},{"style":543},[4152],{"type":398,"value":546},{"type":393,"tag":445,"props":4154,"children":4155},{"style":876},[4156],{"type":398,"value":888},{"type":393,"tag":445,"props":4158,"children":4159},{"style":543},[4160],{"type":398,"value":893},{"type":393,"tag":445,"props":4162,"children":4163},{"style":543},[4164],{"type":398,"value":551},{"type":393,"tag":445,"props":4166,"children":4167},{"class":447,"line":489},[4168,4172,4176,4180,4184,4188,4192,4196,4200,4204],{"type":393,"tag":445,"props":4169,"children":4170},{"style":1378},[4171],{"type":398,"value":1802},{"type":393,"tag":445,"props":4173,"children":4174},{"style":458},[4175],{"type":398,"value":888},{"type":393,"tag":445,"props":4177,"children":4178},{"style":819},[4179],{"type":398,"value":1811},{"type":393,"tag":445,"props":4181,"children":4182},{"style":452},[4183],{"type":398,"value":926},{"type":393,"tag":445,"props":4185,"children":4186},{"style":558},[4187],{"type":398,"value":461},{"type":393,"tag":445,"props":4189,"children":4190},{"style":458},[4191],{"type":398,"value":1824},{"type":393,"tag":445,"props":4193,"children":4194},{"style":558},[4195],{"type":398,"value":1739},{"type":393,"tag":445,"props":4197,"children":4198},{"style":819},[4199],{"type":398,"value":566},{"type":393,"tag":445,"props":4201,"children":4202},{"style":458},[4203],{"type":398,"value":926},{"type":393,"tag":445,"props":4205,"children":4206},{"style":543},[4207],{"type":398,"value":1776},{"type":393,"tag":445,"props":4209,"children":4210},{"class":447,"line":498},[4211],{"type":393,"tag":445,"props":4212,"children":4213},{"style":543},[4214],{"type":398,"value":1849},{"type":393,"tag":445,"props":4216,"children":4217},{"class":447,"line":507},[4218,4222,4226],{"type":393,"tag":445,"props":4219,"children":4220},{"style":543},[4221],{"type":398,"value":605},{"type":393,"tag":445,"props":4223,"children":4224},{"style":458},[4225],{"type":398,"value":1862},{"type":393,"tag":445,"props":4227,"children":4228},{"style":543},[4229],{"type":398,"value":1776},{"type":393,"tag":394,"props":4231,"children":4232},{},[4233],{"type":398,"value":4234},"终于结束了！这个函数不长，但一口气看下来还是蛮费力气的。如果一遍写测试用例以便看代码，很快能把这个函数跑通，如果你是纯靠脑力跑，还没被那个长长的字符串替换链给吓住，在此我赐你称号：“Micro Templating 人肉编译器 - 十五周年限定版”。",{"type":393,"tag":394,"props":4236,"children":4237},{},[4238,4240,4247,4249,4254],{"type":398,"value":4239},"额外提一句，Function 构造器和 eval 函数比，除了能传参数意外，还有一些细节不同，比如说声明变量的作用域不同，这个需要注意。这个编译器没有错误处理等代码完善，因此不可以上生产。此外，由于 ",{"type":393,"tag":401,"props":4241,"children":4245},{"href":4242,"rel":4243},"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/with",[4244],"nofollow",[4246],{"type":398,"value":2918},{"type":398,"value":4248}," 语句非常容易出错，且不利于静态优化，不应该在业务函数里使用",{"type":393,"tag":445,"props":4250,"children":4251},{},[4252],{"type":398,"value":4253},"^with-mdn",{"type":398,"value":4255},"。最后，阅读源码需要技巧，这几点希望能帮助到你：",{"type":393,"tag":3092,"props":4257,"children":4258},{},[4259,4264,4269,4274],{"type":393,"tag":3096,"props":4260,"children":4261},{},[4262],{"type":398,"value":4263},"从注释、测试用例，先搞清楚要看的代码的作用",{"type":393,"tag":3096,"props":4265,"children":4266},{},[4267],{"type":398,"value":4268},"使用编辑器的折叠代码，一次只看一部分源码",{"type":393,"tag":3096,"props":4270,"children":4271},{},[4272],{"type":398,"value":4273},"在 Git 提交记录中搜索，从简单的版本看起",{"type":393,"tag":3096,"props":4275,"children":4276},{},[4277],{"type":398,"value":4278},"复杂代码应该从高层结构看起，比如使用 IDE 各种插件或是 Madge 等代码分析工具",{"type":393,"tag":749,"props":4280,"children":4282},{"id":4281},"相关链接",[4283],{"type":398,"value":4281},{"type":393,"tag":3092,"props":4285,"children":4286},{},[4287],{"type":393,"tag":3096,"props":4288,"children":4289},{},[4290],{"type":393,"tag":401,"props":4291,"children":4294},{"href":4292,"rel":4293},"https://johnresig.com/blog/javascript-micro-templating/",[4244],[4295],{"type":398,"value":4296},"JavaScript Micro-Templating",{"type":393,"tag":4298,"props":4299,"children":4300},"style",{},[4301],{"type":398,"value":4302},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":387,"searchDepth":470,"depth":470,"links":4304},[4305,4306,4307],{"id":751,"depth":470,"text":751},{"id":1874,"depth":470,"text":1874},{"id":4281,"depth":470,"text":4281},"markdown","content:2.articles:1100.micro-templating.md","content","2.articles/1100.micro-templating.md","2.articles/1100.micro-templating","md",[4315,4317],{"_path":46,"title":45,"description":4316},"沉浸式翻译太贵辽，试试本地部署 LLM 用来翻译网页的可行性。",{"_path":52,"title":51,"description":4318},"我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。我碰到的问题是，如果 CSS 源码中带嵌套语法那么解析就会失败。今天借这个问题给大家简单介绍一下 CSS Parser 的基本流程。",1741914065676]