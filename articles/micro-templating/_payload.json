[{"data":1,"prerenderedAt":4328},["ShallowReactive",2],{"navigation":3,"/articles/micro-templating":393,"/articles/micro-templating-surround":4323},[4,35,86,105,132,138,144,150,387],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":45,"_path":46},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":48,"_path":49},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":51,"_path":52},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":54,"_path":55},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":57,"_path":58},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":60,"_path":61},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":63,"_path":64},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":66,"_path":67},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":69,"_path":70},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":72,"_path":73},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":75,"_path":76},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":78,"_path":79},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":81,"_path":82},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":84,"_path":85},"📝 技术博客归档","/articles/archive",{"title":87,"_path":88,"children":89},"造物 / Make","/tools",[90,93,96,99,102],{"title":91,"_path":92},"🥥 Coconut","/tools/coconut",{"title":94,"_path":95},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":97,"_path":98},"🌐 AnySort","/tools/anysort",{"title":100,"_path":101},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":103,"_path":104},"👓 Crapto","/tools/crypto-inline",{"title":106,"_path":107,"children":108},"吉他剧场 / Music","/music",[109,111,114,117,120,123,126,129],{"title":110,"_path":107},"🎸 FingerStyle！",{"title":112,"_path":113},"🌬️ 等待的风","/music/wind",{"title":115,"_path":116},"💕 约定的海洋","/music/ocean",{"title":118,"_path":119},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":121,"_path":122},"🌏 残酷天使的行动纲领","/music/eva",{"title":124,"_path":125},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":127,"_path":128},"🍷 Wu Wei","/music/wu-wei",{"title":130,"_path":131},"🌅 无题","/music/untitled",{"title":133,"_path":134,"children":135},"画点什么 / Paint","/paint",[136],{"title":137,"_path":134},"🚧 正在施工",{"title":139,"_path":140,"children":141},"读书笔记 / Notes","/books",[142],{"title":143,"_path":140},"📕 读书笔记",{"title":145,"_path":146,"children":147},"知识地图 / Maps","/maps",[148],{"title":149,"_path":146},"🏁 知识地图",{"title":151,"_path":152,"children":153},"零散的笔记 / Gists","/gists",[154,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375,378,381,384],{"title":155,"_path":152},"🧊 Gists",{"title":157,"_path":158},"网站的可访问性","/gists/accessibility",{"title":160,"_path":161},"Bit","/gists/bit",{"title":163,"_path":164},"图片模糊","/gists/blur",{"title":166,"_path":167},"渲染相关笔记","/gists/c4d",{"title":169,"_path":170},"CDN 问题记录","/gists/cdn",{"title":172,"_path":173},"消毒剂","/gists/cleaner",{"title":175,"_path":176},"Windows Command","/gists/cmd",{"title":178,"_path":179},"Command","/gists/command",{"title":181,"_path":182},"复杂科学","/gists/complexity-science",{"title":184,"_path":185},"GitHub Copilot","/gists/copilot",{"title":187,"_path":188},"宇宙","/gists/cosmos",{"title":190,"_path":191},"C++","/gists/cpp",{"title":193,"_path":194},"DEPRESSION","/gists/depression",{"title":196,"_path":197},"Developer Experience","/gists/developer-experience",{"title":199,"_path":200},"Device Metrics","/gists/device-metrix",{"title":202,"_path":203},"数字化转型","/gists/digital-transformation",{"title":205,"_path":206},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":208,"_path":209},"正则表达式","/gists/eegex",{"title":211,"_path":212},"Emoji","/gists/emoji",{"title":214,"_path":215},"工程","/gists/engineering",{"title":217,"_path":218},"熵","/gists/entropy",{"title":220,"_path":221},"Environment","/gists/environment",{"title":223,"_path":224},"Erlang","/gists/erlang",{"title":226,"_path":227},"逃离塔克夫","/gists/escape-from-tarkov",{"title":229,"_path":230},"ESNext (ES6-ES11)","/gists/esnext",{"title":232,"_path":233},"Eval！","/gists/eval",{"title":235,"_path":236},"Flutter","/gists/flutter",{"title":238,"_path":239},"字体","/gists/font",{"title":241,"_path":242},"JS 函数式编程","/gists/functional",{"title":244,"_path":245},"游戏化","/gists/gamification",{"title":247,"_path":248},"Google C++ Standard","/gists/google-cpp-standard",{"title":250,"_path":251},"双向链接完全体","/gists/graph",{"title":253,"_path":254},"Hardwares","/gists/hardwares",{"title":256,"_path":257},"哈希冲突","/gists/hash-collision",{"title":259,"_path":260},"信息设计","/gists/information-design",{"title":262,"_path":263},"InstantPage","/gists/instant.page",{"title":265,"_path":266},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":268,"_path":269},"KVStore","/gists/key-value-db",{"title":271,"_path":272},"Kubernetes","/gists/kubernetes",{"title":274,"_path":275},"Makefile","/gists/makefile",{"title":277,"_path":278},"Markdown Inline Style","/gists/markdown-nice",{"title":280,"_path":281},"小程序","/gists/miniapp",{"title":283,"_path":284},"减小页面快照体积","/gists/minify-html",{"title":286,"_path":287},"mklink","/gists/mklink",{"title":289,"_path":290},"Mock","/gists/mock",{"title":292,"_path":293},"多人协作系统","/gists/multiplayer",{"title":295,"_path":296},"多端应用","/gists/multy-end-app",{"title":298,"_path":299},"神经科学","/gists/neuroscience",{"title":301,"_path":302},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":304,"_path":305},"PInvoke","/gists/pinvoke",{"title":307,"_path":308},"像素","/gists/pixel",{"title":310,"_path":311},"PowerShell","/gists/powershell",{"title":313,"_path":314},"量子","/gists/quantum",{"title":316,"_path":317},"保持好奇心","/gists/questions",{"title":319,"_path":320},"React Native","/gists/react-native",{"title":322,"_path":323},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":325,"_path":326},"SEO","/gists/seo",{"title":328,"_path":329},"Shader","/gists/shader",{"title":331,"_path":332},"Shape Up","/gists/shape-up",{"title":334,"_path":335},"睡觉","/gists/sleep",{"title":337,"_path":338},"记录奇怪的问题","/gists/solved",{"title":340,"_path":341},"States","/gists/states",{"title":343,"_path":344},"Storage","/gists/storage",{"title":346,"_path":347},"音视频流处理","/gists/stream-cli",{"title":349,"_path":350},"Symbol","/gists/symbol",{"title":352,"_path":353},"系统论","/gists/systems-theory",{"title":355,"_path":356},"Taro","/gists/taro",{"title":358,"_path":359},"任务切片","/gists/task-slice",{"title":361,"_path":362},"技术偏好","/gists/tech-dudge",{"title":364,"_path":365},"Untitled","/gists/untitled",{"title":367,"_path":368},"可变字体","/gists/variable-font",{"title":370,"_path":371},"视觉错觉","/gists/visual-illusion",{"title":373,"_path":374},"SS(SSR)","/gists/vpn",{"title":376,"_path":377},"VS Code 插件开发","/gists/vscode-plugin",{"title":379,"_path":380},"Web Components","/gists/web-components",{"title":382,"_path":383},"Windows","/gists/windows",{"title":385,"_path":386},"查缺补漏","/gists/wrong",{"title":388,"_path":389,"children":390},"我 / About","/hire",[391],{"title":392,"_path":389},"📬 技术简历",{"_path":49,"_dir":394,"_draft":395,"_partial":395,"_locale":396,"title":48,"description":397,"body":398,"_type":4317,"_id":4318,"_source":4319,"_file":4320,"_stem":4321,"_extension":4322},"articles",false,"","忍者秘籍中提到的模板解析器，很短但支持变量和 if 等语句，还是 15 年前的代码！",{"type":399,"children":400,"toc":4312},"root",[401,426,438,443,620,632,752,757,763,768,1876,1881,1886,1891,2002,2015,2476,2782,2793,2892,2905,3076,3081,3100,3139,3144,3211,3216,3269,3929,3976,3981,4055,4068,4073,4078,4239,4244,4265,4288,4293,4306],{"type":402,"tag":403,"props":404,"children":405},"element","p",{},[406,409,415,417,424],{"type":407,"value":408},"text","上回我借着解决 CSS 嵌套解析问题聊到 micro-app 中实现的一个非常精简的 ",{"type":402,"tag":410,"props":411,"children":412},"a",{"href":52},[413],{"type":407,"value":414},"CSS 解析器",{"type":407,"value":416},"，还没过瘾。今天整理笔记的时候发现了角落里的这个模板解析器，那就赶紧擦擦灰尘拉出来聊一聊。这个模板解析器可是有年头了，它是 John Resig 佬 2008 年写的，叫 ",{"type":402,"tag":418,"props":419,"children":421},"code",{"className":420},[],[422],{"type":407,"value":423},"micro-templating",{"type":407,"value":425},"，距今十五年哩。（John Resig 就是写《JavaScript 忍者秘籍》那位）",{"type":402,"tag":403,"props":427,"children":428},{},[429,431,436],{"type":407,"value":430},"令人惊叹的地方是，",{"type":402,"tag":418,"props":432,"children":434},{"className":433},[],[435],{"type":407,"value":423},{"type":407,"value":437}," 的代码和它的名字一样 micro，它能用仅仅 30 行代码完成对模板的处理，并且还有读取 html 模板、缓存、柯里化等额外的高级功能！",{"type":402,"tag":403,"props":439,"children":440},{},[441],{"type":407,"value":442},"可能有些佬没接触过模板解析器，这里给出一个简单的示例。",{"type":402,"tag":444,"props":445,"children":449},"pre",{"className":446,"code":447,"language":448,"meta":396,"style":396},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","parse(`\n  \u003C% if (shouldCount) { %>\n    \u003C% for (var i = 1; i \u003C= 3; i++) { %>\n      \u003Cdiv>hello - \u003C%= i + count %>\u003C/div>\n    \u003C% } %>\n  \u003C% } else { %>\n    \u003Cdiv>noop\u003C/div>\n  \u003C% } %>\n`, {\n  shouldCount: true,\n  count: 1\n})\n","js",[450],{"type":402,"tag":418,"props":451,"children":452},{"__ignoreMap":396},[453,477,487,496,505,514,523,532,541,561,587,606],{"type":402,"tag":454,"props":455,"children":458},"span",{"class":456,"line":457},"line",1,[459,465,471],{"type":402,"tag":454,"props":460,"children":462},{"style":461},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[463],{"type":407,"value":464},"parse",{"type":402,"tag":454,"props":466,"children":468},{"style":467},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[469],{"type":407,"value":470},"(",{"type":402,"tag":454,"props":472,"children":474},{"style":473},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[475],{"type":407,"value":476},"`\n",{"type":402,"tag":454,"props":478,"children":480},{"class":456,"line":479},2,[481],{"type":402,"tag":454,"props":482,"children":484},{"style":483},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[485],{"type":407,"value":486},"  \u003C% if (shouldCount) { %>\n",{"type":402,"tag":454,"props":488,"children":490},{"class":456,"line":489},3,[491],{"type":402,"tag":454,"props":492,"children":493},{"style":483},[494],{"type":407,"value":495},"    \u003C% for (var i = 1; i \u003C= 3; i++) { %>\n",{"type":402,"tag":454,"props":497,"children":499},{"class":456,"line":498},4,[500],{"type":402,"tag":454,"props":501,"children":502},{"style":483},[503],{"type":407,"value":504},"      \u003Cdiv>hello - \u003C%= i + count %>\u003C/div>\n",{"type":402,"tag":454,"props":506,"children":508},{"class":456,"line":507},5,[509],{"type":402,"tag":454,"props":510,"children":511},{"style":483},[512],{"type":407,"value":513},"    \u003C% } %>\n",{"type":402,"tag":454,"props":515,"children":517},{"class":456,"line":516},6,[518],{"type":402,"tag":454,"props":519,"children":520},{"style":483},[521],{"type":407,"value":522},"  \u003C% } else { %>\n",{"type":402,"tag":454,"props":524,"children":526},{"class":456,"line":525},7,[527],{"type":402,"tag":454,"props":528,"children":529},{"style":483},[530],{"type":407,"value":531},"    \u003Cdiv>noop\u003C/div>\n",{"type":402,"tag":454,"props":533,"children":535},{"class":456,"line":534},8,[536],{"type":402,"tag":454,"props":537,"children":538},{"style":483},[539],{"type":407,"value":540},"  \u003C% } %>\n",{"type":402,"tag":454,"props":542,"children":544},{"class":456,"line":543},9,[545,550,556],{"type":402,"tag":454,"props":546,"children":547},{"style":473},[548],{"type":407,"value":549},"`",{"type":402,"tag":454,"props":551,"children":553},{"style":552},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[554],{"type":407,"value":555},",",{"type":402,"tag":454,"props":557,"children":558},{"style":552},[559],{"type":407,"value":560}," {\n",{"type":402,"tag":454,"props":562,"children":564},{"class":456,"line":563},10,[565,571,576,582],{"type":402,"tag":454,"props":566,"children":568},{"style":567},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[569],{"type":407,"value":570},"  shouldCount",{"type":402,"tag":454,"props":572,"children":573},{"style":552},[574],{"type":407,"value":575},":",{"type":402,"tag":454,"props":577,"children":579},{"style":578},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[580],{"type":407,"value":581}," true",{"type":402,"tag":454,"props":583,"children":584},{"style":552},[585],{"type":407,"value":586},",\n",{"type":402,"tag":454,"props":588,"children":590},{"class":456,"line":589},11,[591,596,600],{"type":402,"tag":454,"props":592,"children":593},{"style":567},[594],{"type":407,"value":595},"  count",{"type":402,"tag":454,"props":597,"children":598},{"style":552},[599],{"type":407,"value":575},{"type":402,"tag":454,"props":601,"children":603},{"style":602},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[604],{"type":407,"value":605}," 1\n",{"type":402,"tag":454,"props":607,"children":609},{"class":456,"line":608},12,[610,615],{"type":402,"tag":454,"props":611,"children":612},{"style":552},[613],{"type":407,"value":614},"}",{"type":402,"tag":454,"props":616,"children":617},{"style":467},[618],{"type":407,"value":619},")\n",{"type":402,"tag":403,"props":621,"children":622},{},[623,625,630],{"type":407,"value":624},"给 ",{"type":402,"tag":418,"props":626,"children":628},{"className":627},[],[629],{"type":407,"value":464},{"type":407,"value":631}," 函数传入模板字符串和数据后，自然也是输出字符串啦：",{"type":402,"tag":444,"props":633,"children":637},{"className":634,"code":635,"language":636,"meta":396,"style":396},"language-html shiki shiki-themes material-theme-lighter github-light github-dark monokai","\u003C!-- 以下经过格式化 -->\n\u003Cdiv>hello - 2\u003C/div>\n\u003Cdiv>hello - 3\u003C/div>\n\u003Cdiv>hello - 4\u003C/div>\n","html",[638],{"type":402,"tag":418,"props":639,"children":640},{"__ignoreMap":396},[641,650,688,720],{"type":402,"tag":454,"props":642,"children":643},{"class":456,"line":457},[644],{"type":402,"tag":454,"props":645,"children":647},{"style":646},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[648],{"type":407,"value":649},"\u003C!-- 以下经过格式化 -->\n",{"type":402,"tag":454,"props":651,"children":652},{"class":456,"line":479},[653,658,664,669,674,679,683],{"type":402,"tag":454,"props":654,"children":655},{"style":552},[656],{"type":407,"value":657},"\u003C",{"type":402,"tag":454,"props":659,"children":661},{"style":660},"--shiki-light:#E53935;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[662],{"type":407,"value":663},"div",{"type":402,"tag":454,"props":665,"children":666},{"style":552},[667],{"type":407,"value":668},">",{"type":402,"tag":454,"props":670,"children":671},{"style":467},[672],{"type":407,"value":673},"hello - 2",{"type":402,"tag":454,"props":675,"children":676},{"style":552},[677],{"type":407,"value":678},"\u003C/",{"type":402,"tag":454,"props":680,"children":681},{"style":660},[682],{"type":407,"value":663},{"type":402,"tag":454,"props":684,"children":685},{"style":552},[686],{"type":407,"value":687},">\n",{"type":402,"tag":454,"props":689,"children":690},{"class":456,"line":489},[691,695,699,703,708,712,716],{"type":402,"tag":454,"props":692,"children":693},{"style":552},[694],{"type":407,"value":657},{"type":402,"tag":454,"props":696,"children":697},{"style":660},[698],{"type":407,"value":663},{"type":402,"tag":454,"props":700,"children":701},{"style":552},[702],{"type":407,"value":668},{"type":402,"tag":454,"props":704,"children":705},{"style":467},[706],{"type":407,"value":707},"hello - 3",{"type":402,"tag":454,"props":709,"children":710},{"style":552},[711],{"type":407,"value":678},{"type":402,"tag":454,"props":713,"children":714},{"style":660},[715],{"type":407,"value":663},{"type":402,"tag":454,"props":717,"children":718},{"style":552},[719],{"type":407,"value":687},{"type":402,"tag":454,"props":721,"children":722},{"class":456,"line":498},[723,727,731,735,740,744,748],{"type":402,"tag":454,"props":724,"children":725},{"style":552},[726],{"type":407,"value":657},{"type":402,"tag":454,"props":728,"children":729},{"style":660},[730],{"type":407,"value":663},{"type":402,"tag":454,"props":732,"children":733},{"style":552},[734],{"type":407,"value":668},{"type":402,"tag":454,"props":736,"children":737},{"style":467},[738],{"type":407,"value":739},"hello - 4",{"type":402,"tag":454,"props":741,"children":742},{"style":552},[743],{"type":407,"value":678},{"type":402,"tag":454,"props":745,"children":746},{"style":660},[747],{"type":407,"value":663},{"type":402,"tag":454,"props":749,"children":750},{"style":552},[751],{"type":407,"value":687},{"type":402,"tag":403,"props":753,"children":754},{},[755],{"type":407,"value":756},"相比生态里现在动则 30kb 甚至 300kb 的库，仅 30 行代码完成这个功能，简直不可思议。",{"type":402,"tag":758,"props":759,"children":761},"h2",{"id":760},"完整实现",[762],{"type":407,"value":760},{"type":402,"tag":403,"props":764,"children":765},{},[766],{"type":407,"value":767},"因为代码真的非常短，先直接看一遍，这是带注释版本的。如果你能在第一遍 review 这段代码后脑袋还保持清醒的话，留下评论，我拜你为大哥。",{"type":402,"tag":444,"props":769,"children":771},{"className":446,"code":770,"language":448,"meta":396,"style":396},"// Simple JavaScript Templating\n// John Resig - https://johnresig.com/ - MIT Licensed\n(function () {\n  var cache = {};\n\n  this.tmpl = function tmpl(str, data) {\n    // Figure out if we're getting a template, or if we need to\n    // load the template - and be sure to cache the result.\n    var fn = !/\\W/.test(str)\n      ? (cache[str] =\n          cache[str] || tmpl(document.getElementById(str).innerHTML))\n      : // Generate a reusable function that will serve as a template\n        // generator (and which will be cached).\n        new Function(\n          \"obj\",\n          \"var p=[],print=function(){p.push.apply(p,arguments);};\" +\n            // Introduce the data as local variables using with(){}\n            \"with(obj){p.push('\" +\n            // Convert the template into pure JavaScript\n            str\n              .replace(/[\\r\\t\\n]/g, \" \")\n              .split(\"\u003C%\")\n              .join(\"\\t\")\n              .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\n              .replace(/\\t=(.*?)%>/g, \"',$1,'\")\n              .split(\"\\t\")\n              .join(\"');\")\n              .split(\"%>\")\n              .join(\"p.push('\")\n              .split(\"\\r\")\n              .join(\"\\\\'\") +\n            \"');}return p.join('');\"\n        );\n\n    // Provide some basic currying to the user\n    return data ? fn(data) : fn;\n  };\n})();\n",[772],{"type":402,"tag":418,"props":773,"children":774},{"__ignoreMap":396},[775,783,791,813,837,846,907,915,923,981,1018,1091,1104,1113,1132,1155,1177,1186,1208,1217,1226,1290,1324,1359,1470,1549,1581,1614,1646,1679,1711,1754,1772,1786,1794,1803,1850,1859],{"type":402,"tag":454,"props":776,"children":777},{"class":456,"line":457},[778],{"type":402,"tag":454,"props":779,"children":780},{"style":646},[781],{"type":407,"value":782},"// Simple JavaScript Templating\n",{"type":402,"tag":454,"props":784,"children":785},{"class":456,"line":479},[786],{"type":402,"tag":454,"props":787,"children":788},{"style":646},[789],{"type":407,"value":790},"// John Resig - https://johnresig.com/ - MIT Licensed\n",{"type":402,"tag":454,"props":792,"children":793},{"class":456,"line":489},[794,798,804,809],{"type":402,"tag":454,"props":795,"children":796},{"style":467},[797],{"type":407,"value":470},{"type":402,"tag":454,"props":799,"children":801},{"style":800},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[802],{"type":407,"value":803},"function",{"type":402,"tag":454,"props":805,"children":806},{"style":552},[807],{"type":407,"value":808}," ()",{"type":402,"tag":454,"props":810,"children":811},{"style":552},[812],{"type":407,"value":560},{"type":402,"tag":454,"props":814,"children":815},{"class":456,"line":498},[816,821,826,832],{"type":402,"tag":454,"props":817,"children":818},{"style":800},[819],{"type":407,"value":820},"  var",{"type":402,"tag":454,"props":822,"children":823},{"style":467},[824],{"type":407,"value":825}," cache",{"type":402,"tag":454,"props":827,"children":829},{"style":828},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[830],{"type":407,"value":831}," =",{"type":402,"tag":454,"props":833,"children":834},{"style":552},[835],{"type":407,"value":836}," {};\n",{"type":402,"tag":454,"props":838,"children":839},{"class":456,"line":507},[840],{"type":402,"tag":454,"props":841,"children":843},{"emptyLinePlaceholder":842},true,[844],{"type":407,"value":845},"\n",{"type":402,"tag":454,"props":847,"children":848},{"class":456,"line":516},[849,855,860,865,869,874,879,883,889,893,898,903],{"type":402,"tag":454,"props":850,"children":852},{"style":851},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[853],{"type":407,"value":854},"  this",{"type":402,"tag":454,"props":856,"children":857},{"style":552},[858],{"type":407,"value":859},".",{"type":402,"tag":454,"props":861,"children":862},{"style":461},[863],{"type":407,"value":864},"tmpl",{"type":402,"tag":454,"props":866,"children":867},{"style":828},[868],{"type":407,"value":831},{"type":402,"tag":454,"props":870,"children":871},{"style":800},[872],{"type":407,"value":873}," function",{"type":402,"tag":454,"props":875,"children":876},{"style":461},[877],{"type":407,"value":878}," tmpl",{"type":402,"tag":454,"props":880,"children":881},{"style":552},[882],{"type":407,"value":470},{"type":402,"tag":454,"props":884,"children":886},{"style":885},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[887],{"type":407,"value":888},"str",{"type":402,"tag":454,"props":890,"children":891},{"style":552},[892],{"type":407,"value":555},{"type":402,"tag":454,"props":894,"children":895},{"style":885},[896],{"type":407,"value":897}," data",{"type":402,"tag":454,"props":899,"children":900},{"style":552},[901],{"type":407,"value":902},")",{"type":402,"tag":454,"props":904,"children":905},{"style":552},[906],{"type":407,"value":560},{"type":402,"tag":454,"props":908,"children":909},{"class":456,"line":525},[910],{"type":402,"tag":454,"props":911,"children":912},{"style":646},[913],{"type":407,"value":914},"    // Figure out if we're getting a template, or if we need to\n",{"type":402,"tag":454,"props":916,"children":917},{"class":456,"line":534},[918],{"type":402,"tag":454,"props":919,"children":920},{"style":646},[921],{"type":407,"value":922},"    // load the template - and be sure to cache the result.\n",{"type":402,"tag":454,"props":924,"children":925},{"class":456,"line":543},[926,931,936,940,945,950,956,960,964,969,973,977],{"type":402,"tag":454,"props":927,"children":928},{"style":800},[929],{"type":407,"value":930},"    var",{"type":402,"tag":454,"props":932,"children":933},{"style":467},[934],{"type":407,"value":935}," fn",{"type":402,"tag":454,"props":937,"children":938},{"style":828},[939],{"type":407,"value":831},{"type":402,"tag":454,"props":941,"children":942},{"style":828},[943],{"type":407,"value":944}," !",{"type":402,"tag":454,"props":946,"children":947},{"style":473},[948],{"type":407,"value":949},"/",{"type":402,"tag":454,"props":951,"children":953},{"style":952},"--shiki-light:#91B859;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[954],{"type":407,"value":955},"\\W",{"type":402,"tag":454,"props":957,"children":958},{"style":473},[959],{"type":407,"value":949},{"type":402,"tag":454,"props":961,"children":962},{"style":552},[963],{"type":407,"value":859},{"type":402,"tag":454,"props":965,"children":966},{"style":461},[967],{"type":407,"value":968},"test",{"type":402,"tag":454,"props":970,"children":971},{"style":567},[972],{"type":407,"value":470},{"type":402,"tag":454,"props":974,"children":975},{"style":467},[976],{"type":407,"value":888},{"type":402,"tag":454,"props":978,"children":979},{"style":567},[980],{"type":407,"value":619},{"type":402,"tag":454,"props":982,"children":983},{"class":456,"line":563},[984,989,994,999,1004,1008,1013],{"type":402,"tag":454,"props":985,"children":986},{"style":828},[987],{"type":407,"value":988},"      ?",{"type":402,"tag":454,"props":990,"children":991},{"style":567},[992],{"type":407,"value":993}," (",{"type":402,"tag":454,"props":995,"children":996},{"style":467},[997],{"type":407,"value":998},"cache",{"type":402,"tag":454,"props":1000,"children":1001},{"style":567},[1002],{"type":407,"value":1003},"[",{"type":402,"tag":454,"props":1005,"children":1006},{"style":467},[1007],{"type":407,"value":888},{"type":402,"tag":454,"props":1009,"children":1010},{"style":567},[1011],{"type":407,"value":1012},"] ",{"type":402,"tag":454,"props":1014,"children":1015},{"style":828},[1016],{"type":407,"value":1017},"=\n",{"type":402,"tag":454,"props":1019,"children":1020},{"class":456,"line":589},[1021,1026,1030,1034,1038,1043,1047,1051,1056,1060,1065,1069,1073,1077,1081,1086],{"type":402,"tag":454,"props":1022,"children":1023},{"style":467},[1024],{"type":407,"value":1025},"          cache",{"type":402,"tag":454,"props":1027,"children":1028},{"style":567},[1029],{"type":407,"value":1003},{"type":402,"tag":454,"props":1031,"children":1032},{"style":467},[1033],{"type":407,"value":888},{"type":402,"tag":454,"props":1035,"children":1036},{"style":567},[1037],{"type":407,"value":1012},{"type":402,"tag":454,"props":1039,"children":1040},{"style":828},[1041],{"type":407,"value":1042},"||",{"type":402,"tag":454,"props":1044,"children":1045},{"style":461},[1046],{"type":407,"value":878},{"type":402,"tag":454,"props":1048,"children":1049},{"style":567},[1050],{"type":407,"value":470},{"type":402,"tag":454,"props":1052,"children":1053},{"style":467},[1054],{"type":407,"value":1055},"document",{"type":402,"tag":454,"props":1057,"children":1058},{"style":552},[1059],{"type":407,"value":859},{"type":402,"tag":454,"props":1061,"children":1062},{"style":461},[1063],{"type":407,"value":1064},"getElementById",{"type":402,"tag":454,"props":1066,"children":1067},{"style":567},[1068],{"type":407,"value":470},{"type":402,"tag":454,"props":1070,"children":1071},{"style":467},[1072],{"type":407,"value":888},{"type":402,"tag":454,"props":1074,"children":1075},{"style":567},[1076],{"type":407,"value":902},{"type":402,"tag":454,"props":1078,"children":1079},{"style":552},[1080],{"type":407,"value":859},{"type":402,"tag":454,"props":1082,"children":1083},{"style":467},[1084],{"type":407,"value":1085},"innerHTML",{"type":402,"tag":454,"props":1087,"children":1088},{"style":567},[1089],{"type":407,"value":1090},"))\n",{"type":402,"tag":454,"props":1092,"children":1093},{"class":456,"line":608},[1094,1099],{"type":402,"tag":454,"props":1095,"children":1096},{"style":828},[1097],{"type":407,"value":1098},"      :",{"type":402,"tag":454,"props":1100,"children":1101},{"style":646},[1102],{"type":407,"value":1103}," // Generate a reusable function that will serve as a template\n",{"type":402,"tag":454,"props":1105,"children":1107},{"class":456,"line":1106},13,[1108],{"type":402,"tag":454,"props":1109,"children":1110},{"style":646},[1111],{"type":407,"value":1112},"        // generator (and which will be cached).\n",{"type":402,"tag":454,"props":1114,"children":1116},{"class":456,"line":1115},14,[1117,1122,1127],{"type":402,"tag":454,"props":1118,"children":1119},{"style":828},[1120],{"type":407,"value":1121},"        new",{"type":402,"tag":454,"props":1123,"children":1124},{"style":461},[1125],{"type":407,"value":1126}," Function",{"type":402,"tag":454,"props":1128,"children":1129},{"style":567},[1130],{"type":407,"value":1131},"(\n",{"type":402,"tag":454,"props":1133,"children":1135},{"class":456,"line":1134},15,[1136,1141,1146,1151],{"type":402,"tag":454,"props":1137,"children":1138},{"style":473},[1139],{"type":407,"value":1140},"          \"",{"type":402,"tag":454,"props":1142,"children":1143},{"style":483},[1144],{"type":407,"value":1145},"obj",{"type":402,"tag":454,"props":1147,"children":1148},{"style":473},[1149],{"type":407,"value":1150},"\"",{"type":402,"tag":454,"props":1152,"children":1153},{"style":552},[1154],{"type":407,"value":586},{"type":402,"tag":454,"props":1156,"children":1158},{"class":456,"line":1157},16,[1159,1163,1168,1172],{"type":402,"tag":454,"props":1160,"children":1161},{"style":473},[1162],{"type":407,"value":1140},{"type":402,"tag":454,"props":1164,"children":1165},{"style":483},[1166],{"type":407,"value":1167},"var p=[],print=function(){p.push.apply(p,arguments);};",{"type":402,"tag":454,"props":1169,"children":1170},{"style":473},[1171],{"type":407,"value":1150},{"type":402,"tag":454,"props":1173,"children":1174},{"style":828},[1175],{"type":407,"value":1176}," +\n",{"type":402,"tag":454,"props":1178,"children":1180},{"class":456,"line":1179},17,[1181],{"type":402,"tag":454,"props":1182,"children":1183},{"style":646},[1184],{"type":407,"value":1185},"            // Introduce the data as local variables using with(){}\n",{"type":402,"tag":454,"props":1187,"children":1189},{"class":456,"line":1188},18,[1190,1195,1200,1204],{"type":402,"tag":454,"props":1191,"children":1192},{"style":473},[1193],{"type":407,"value":1194},"            \"",{"type":402,"tag":454,"props":1196,"children":1197},{"style":483},[1198],{"type":407,"value":1199},"with(obj){p.push('",{"type":402,"tag":454,"props":1201,"children":1202},{"style":473},[1203],{"type":407,"value":1150},{"type":402,"tag":454,"props":1205,"children":1206},{"style":828},[1207],{"type":407,"value":1176},{"type":402,"tag":454,"props":1209,"children":1211},{"class":456,"line":1210},19,[1212],{"type":402,"tag":454,"props":1213,"children":1214},{"style":646},[1215],{"type":407,"value":1216},"            // Convert the template into pure JavaScript\n",{"type":402,"tag":454,"props":1218,"children":1220},{"class":456,"line":1219},20,[1221],{"type":402,"tag":454,"props":1222,"children":1223},{"style":467},[1224],{"type":407,"value":1225},"            str\n",{"type":402,"tag":454,"props":1227,"children":1229},{"class":456,"line":1228},21,[1230,1235,1240,1244,1248,1253,1258,1263,1267,1273,1277,1282,1286],{"type":402,"tag":454,"props":1231,"children":1232},{"style":552},[1233],{"type":407,"value":1234},"              .",{"type":402,"tag":454,"props":1236,"children":1237},{"style":461},[1238],{"type":407,"value":1239},"replace",{"type":402,"tag":454,"props":1241,"children":1242},{"style":567},[1243],{"type":407,"value":470},{"type":402,"tag":454,"props":1245,"children":1246},{"style":473},[1247],{"type":407,"value":949},{"type":402,"tag":454,"props":1249,"children":1251},{"style":1250},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1252],{"type":407,"value":1003},{"type":402,"tag":454,"props":1254,"children":1255},{"style":952},[1256],{"type":407,"value":1257},"\\r\\t\\n",{"type":402,"tag":454,"props":1259,"children":1260},{"style":1250},[1261],{"type":407,"value":1262},"]",{"type":402,"tag":454,"props":1264,"children":1265},{"style":473},[1266],{"type":407,"value":949},{"type":402,"tag":454,"props":1268,"children":1270},{"style":1269},"--shiki-light:#F76D47;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1271],{"type":407,"value":1272},"g",{"type":402,"tag":454,"props":1274,"children":1275},{"style":552},[1276],{"type":407,"value":555},{"type":402,"tag":454,"props":1278,"children":1279},{"style":473},[1280],{"type":407,"value":1281}," \"",{"type":402,"tag":454,"props":1283,"children":1284},{"style":473},[1285],{"type":407,"value":1281},{"type":402,"tag":454,"props":1287,"children":1288},{"style":567},[1289],{"type":407,"value":619},{"type":402,"tag":454,"props":1291,"children":1293},{"class":456,"line":1292},22,[1294,1298,1303,1307,1311,1316,1320],{"type":402,"tag":454,"props":1295,"children":1296},{"style":552},[1297],{"type":407,"value":1234},{"type":402,"tag":454,"props":1299,"children":1300},{"style":461},[1301],{"type":407,"value":1302},"split",{"type":402,"tag":454,"props":1304,"children":1305},{"style":567},[1306],{"type":407,"value":470},{"type":402,"tag":454,"props":1308,"children":1309},{"style":473},[1310],{"type":407,"value":1150},{"type":402,"tag":454,"props":1312,"children":1313},{"style":483},[1314],{"type":407,"value":1315},"\u003C%",{"type":402,"tag":454,"props":1317,"children":1318},{"style":473},[1319],{"type":407,"value":1150},{"type":402,"tag":454,"props":1321,"children":1322},{"style":567},[1323],{"type":407,"value":619},{"type":402,"tag":454,"props":1325,"children":1327},{"class":456,"line":1326},23,[1328,1332,1337,1341,1345,1351,1355],{"type":402,"tag":454,"props":1329,"children":1330},{"style":552},[1331],{"type":407,"value":1234},{"type":402,"tag":454,"props":1333,"children":1334},{"style":461},[1335],{"type":407,"value":1336},"join",{"type":402,"tag":454,"props":1338,"children":1339},{"style":567},[1340],{"type":407,"value":470},{"type":402,"tag":454,"props":1342,"children":1343},{"style":473},[1344],{"type":407,"value":1150},{"type":402,"tag":454,"props":1346,"children":1348},{"style":1347},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1349],{"type":407,"value":1350},"\\t",{"type":402,"tag":454,"props":1352,"children":1353},{"style":473},[1354],{"type":407,"value":1150},{"type":402,"tag":454,"props":1356,"children":1357},{"style":567},[1358],{"type":407,"value":619},{"type":402,"tag":454,"props":1360,"children":1362},{"class":456,"line":1361},24,[1363,1367,1371,1375,1379,1385,1391,1396,1402,1406,1410,1414,1418,1422,1427,1431,1436,1440,1444,1448,1452,1457,1462,1466],{"type":402,"tag":454,"props":1364,"children":1365},{"style":552},[1366],{"type":407,"value":1234},{"type":402,"tag":454,"props":1368,"children":1369},{"style":461},[1370],{"type":407,"value":1239},{"type":402,"tag":454,"props":1372,"children":1373},{"style":567},[1374],{"type":407,"value":470},{"type":402,"tag":454,"props":1376,"children":1377},{"style":473},[1378],{"type":407,"value":949},{"type":402,"tag":454,"props":1380,"children":1382},{"style":1381},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[1383],{"type":407,"value":1384},"((",{"type":402,"tag":454,"props":1386,"children":1388},{"style":1387},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[1389],{"type":407,"value":1390},"^",{"type":402,"tag":454,"props":1392,"children":1393},{"style":828},[1394],{"type":407,"value":1395},"|",{"type":402,"tag":454,"props":1397,"children":1399},{"style":1398},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[1400],{"type":407,"value":1401},"%>",{"type":402,"tag":454,"props":1403,"children":1404},{"style":1381},[1405],{"type":407,"value":902},{"type":402,"tag":454,"props":1407,"children":1408},{"style":1250},[1409],{"type":407,"value":1003},{"type":402,"tag":454,"props":1411,"children":1412},{"style":828},[1413],{"type":407,"value":1390},{"type":402,"tag":454,"props":1415,"children":1416},{"style":952},[1417],{"type":407,"value":1350},{"type":402,"tag":454,"props":1419,"children":1420},{"style":1250},[1421],{"type":407,"value":1262},{"type":402,"tag":454,"props":1423,"children":1424},{"style":828},[1425],{"type":407,"value":1426},"*",{"type":402,"tag":454,"props":1428,"children":1429},{"style":1381},[1430],{"type":407,"value":902},{"type":402,"tag":454,"props":1432,"children":1433},{"style":1398},[1434],{"type":407,"value":1435},"'",{"type":402,"tag":454,"props":1437,"children":1438},{"style":473},[1439],{"type":407,"value":949},{"type":402,"tag":454,"props":1441,"children":1442},{"style":1269},[1443],{"type":407,"value":1272},{"type":402,"tag":454,"props":1445,"children":1446},{"style":552},[1447],{"type":407,"value":555},{"type":402,"tag":454,"props":1449,"children":1450},{"style":473},[1451],{"type":407,"value":1281},{"type":402,"tag":454,"props":1453,"children":1454},{"style":483},[1455],{"type":407,"value":1456},"$1",{"type":402,"tag":454,"props":1458,"children":1459},{"style":1347},[1460],{"type":407,"value":1461},"\\r",{"type":402,"tag":454,"props":1463,"children":1464},{"style":473},[1465],{"type":407,"value":1150},{"type":402,"tag":454,"props":1467,"children":1468},{"style":567},[1469],{"type":407,"value":619},{"type":402,"tag":454,"props":1471,"children":1473},{"class":456,"line":1472},25,[1474,1478,1482,1486,1490,1494,1499,1503,1507,1512,1516,1520,1524,1528,1532,1536,1541,1545],{"type":402,"tag":454,"props":1475,"children":1476},{"style":552},[1477],{"type":407,"value":1234},{"type":402,"tag":454,"props":1479,"children":1480},{"style":461},[1481],{"type":407,"value":1239},{"type":402,"tag":454,"props":1483,"children":1484},{"style":567},[1485],{"type":407,"value":470},{"type":402,"tag":454,"props":1487,"children":1488},{"style":473},[1489],{"type":407,"value":949},{"type":402,"tag":454,"props":1491,"children":1492},{"style":952},[1493],{"type":407,"value":1350},{"type":402,"tag":454,"props":1495,"children":1496},{"style":1398},[1497],{"type":407,"value":1498},"=",{"type":402,"tag":454,"props":1500,"children":1501},{"style":1381},[1502],{"type":407,"value":470},{"type":402,"tag":454,"props":1504,"children":1505},{"style":952},[1506],{"type":407,"value":859},{"type":402,"tag":454,"props":1508,"children":1509},{"style":828},[1510],{"type":407,"value":1511},"*?",{"type":402,"tag":454,"props":1513,"children":1514},{"style":1381},[1515],{"type":407,"value":902},{"type":402,"tag":454,"props":1517,"children":1518},{"style":1398},[1519],{"type":407,"value":1401},{"type":402,"tag":454,"props":1521,"children":1522},{"style":473},[1523],{"type":407,"value":949},{"type":402,"tag":454,"props":1525,"children":1526},{"style":1269},[1527],{"type":407,"value":1272},{"type":402,"tag":454,"props":1529,"children":1530},{"style":552},[1531],{"type":407,"value":555},{"type":402,"tag":454,"props":1533,"children":1534},{"style":473},[1535],{"type":407,"value":1281},{"type":402,"tag":454,"props":1537,"children":1538},{"style":483},[1539],{"type":407,"value":1540},"',$1,'",{"type":402,"tag":454,"props":1542,"children":1543},{"style":473},[1544],{"type":407,"value":1150},{"type":402,"tag":454,"props":1546,"children":1547},{"style":567},[1548],{"type":407,"value":619},{"type":402,"tag":454,"props":1550,"children":1552},{"class":456,"line":1551},26,[1553,1557,1561,1565,1569,1573,1577],{"type":402,"tag":454,"props":1554,"children":1555},{"style":552},[1556],{"type":407,"value":1234},{"type":402,"tag":454,"props":1558,"children":1559},{"style":461},[1560],{"type":407,"value":1302},{"type":402,"tag":454,"props":1562,"children":1563},{"style":567},[1564],{"type":407,"value":470},{"type":402,"tag":454,"props":1566,"children":1567},{"style":473},[1568],{"type":407,"value":1150},{"type":402,"tag":454,"props":1570,"children":1571},{"style":1347},[1572],{"type":407,"value":1350},{"type":402,"tag":454,"props":1574,"children":1575},{"style":473},[1576],{"type":407,"value":1150},{"type":402,"tag":454,"props":1578,"children":1579},{"style":567},[1580],{"type":407,"value":619},{"type":402,"tag":454,"props":1582,"children":1584},{"class":456,"line":1583},27,[1585,1589,1593,1597,1601,1606,1610],{"type":402,"tag":454,"props":1586,"children":1587},{"style":552},[1588],{"type":407,"value":1234},{"type":402,"tag":454,"props":1590,"children":1591},{"style":461},[1592],{"type":407,"value":1336},{"type":402,"tag":454,"props":1594,"children":1595},{"style":567},[1596],{"type":407,"value":470},{"type":402,"tag":454,"props":1598,"children":1599},{"style":473},[1600],{"type":407,"value":1150},{"type":402,"tag":454,"props":1602,"children":1603},{"style":483},[1604],{"type":407,"value":1605},"');",{"type":402,"tag":454,"props":1607,"children":1608},{"style":473},[1609],{"type":407,"value":1150},{"type":402,"tag":454,"props":1611,"children":1612},{"style":567},[1613],{"type":407,"value":619},{"type":402,"tag":454,"props":1615,"children":1617},{"class":456,"line":1616},28,[1618,1622,1626,1630,1634,1638,1642],{"type":402,"tag":454,"props":1619,"children":1620},{"style":552},[1621],{"type":407,"value":1234},{"type":402,"tag":454,"props":1623,"children":1624},{"style":461},[1625],{"type":407,"value":1302},{"type":402,"tag":454,"props":1627,"children":1628},{"style":567},[1629],{"type":407,"value":470},{"type":402,"tag":454,"props":1631,"children":1632},{"style":473},[1633],{"type":407,"value":1150},{"type":402,"tag":454,"props":1635,"children":1636},{"style":483},[1637],{"type":407,"value":1401},{"type":402,"tag":454,"props":1639,"children":1640},{"style":473},[1641],{"type":407,"value":1150},{"type":402,"tag":454,"props":1643,"children":1644},{"style":567},[1645],{"type":407,"value":619},{"type":402,"tag":454,"props":1647,"children":1649},{"class":456,"line":1648},29,[1650,1654,1658,1662,1666,1671,1675],{"type":402,"tag":454,"props":1651,"children":1652},{"style":552},[1653],{"type":407,"value":1234},{"type":402,"tag":454,"props":1655,"children":1656},{"style":461},[1657],{"type":407,"value":1336},{"type":402,"tag":454,"props":1659,"children":1660},{"style":567},[1661],{"type":407,"value":470},{"type":402,"tag":454,"props":1663,"children":1664},{"style":473},[1665],{"type":407,"value":1150},{"type":402,"tag":454,"props":1667,"children":1668},{"style":483},[1669],{"type":407,"value":1670},"p.push('",{"type":402,"tag":454,"props":1672,"children":1673},{"style":473},[1674],{"type":407,"value":1150},{"type":402,"tag":454,"props":1676,"children":1677},{"style":567},[1678],{"type":407,"value":619},{"type":402,"tag":454,"props":1680,"children":1682},{"class":456,"line":1681},30,[1683,1687,1691,1695,1699,1703,1707],{"type":402,"tag":454,"props":1684,"children":1685},{"style":552},[1686],{"type":407,"value":1234},{"type":402,"tag":454,"props":1688,"children":1689},{"style":461},[1690],{"type":407,"value":1302},{"type":402,"tag":454,"props":1692,"children":1693},{"style":567},[1694],{"type":407,"value":470},{"type":402,"tag":454,"props":1696,"children":1697},{"style":473},[1698],{"type":407,"value":1150},{"type":402,"tag":454,"props":1700,"children":1701},{"style":1347},[1702],{"type":407,"value":1461},{"type":402,"tag":454,"props":1704,"children":1705},{"style":473},[1706],{"type":407,"value":1150},{"type":402,"tag":454,"props":1708,"children":1709},{"style":567},[1710],{"type":407,"value":619},{"type":402,"tag":454,"props":1712,"children":1714},{"class":456,"line":1713},31,[1715,1719,1723,1727,1731,1736,1740,1744,1749],{"type":402,"tag":454,"props":1716,"children":1717},{"style":552},[1718],{"type":407,"value":1234},{"type":402,"tag":454,"props":1720,"children":1721},{"style":461},[1722],{"type":407,"value":1336},{"type":402,"tag":454,"props":1724,"children":1725},{"style":567},[1726],{"type":407,"value":470},{"type":402,"tag":454,"props":1728,"children":1729},{"style":473},[1730],{"type":407,"value":1150},{"type":402,"tag":454,"props":1732,"children":1733},{"style":1347},[1734],{"type":407,"value":1735},"\\\\",{"type":402,"tag":454,"props":1737,"children":1738},{"style":483},[1739],{"type":407,"value":1435},{"type":402,"tag":454,"props":1741,"children":1742},{"style":473},[1743],{"type":407,"value":1150},{"type":402,"tag":454,"props":1745,"children":1746},{"style":567},[1747],{"type":407,"value":1748},") ",{"type":402,"tag":454,"props":1750,"children":1751},{"style":828},[1752],{"type":407,"value":1753},"+\n",{"type":402,"tag":454,"props":1755,"children":1757},{"class":456,"line":1756},32,[1758,1762,1767],{"type":402,"tag":454,"props":1759,"children":1760},{"style":473},[1761],{"type":407,"value":1194},{"type":402,"tag":454,"props":1763,"children":1764},{"style":483},[1765],{"type":407,"value":1766},"');}return p.join('');",{"type":402,"tag":454,"props":1768,"children":1769},{"style":473},[1770],{"type":407,"value":1771},"\"\n",{"type":402,"tag":454,"props":1773,"children":1775},{"class":456,"line":1774},33,[1776,1781],{"type":402,"tag":454,"props":1777,"children":1778},{"style":567},[1779],{"type":407,"value":1780},"        )",{"type":402,"tag":454,"props":1782,"children":1783},{"style":552},[1784],{"type":407,"value":1785},";\n",{"type":402,"tag":454,"props":1787,"children":1789},{"class":456,"line":1788},34,[1790],{"type":402,"tag":454,"props":1791,"children":1792},{"emptyLinePlaceholder":842},[1793],{"type":407,"value":845},{"type":402,"tag":454,"props":1795,"children":1797},{"class":456,"line":1796},35,[1798],{"type":402,"tag":454,"props":1799,"children":1800},{"style":646},[1801],{"type":407,"value":1802},"    // Provide some basic currying to the user\n",{"type":402,"tag":454,"props":1804,"children":1806},{"class":456,"line":1805},36,[1807,1812,1816,1821,1825,1829,1834,1838,1842,1846],{"type":402,"tag":454,"props":1808,"children":1809},{"style":1387},[1810],{"type":407,"value":1811},"    return",{"type":402,"tag":454,"props":1813,"children":1814},{"style":467},[1815],{"type":407,"value":897},{"type":402,"tag":454,"props":1817,"children":1818},{"style":828},[1819],{"type":407,"value":1820}," ?",{"type":402,"tag":454,"props":1822,"children":1823},{"style":461},[1824],{"type":407,"value":935},{"type":402,"tag":454,"props":1826,"children":1827},{"style":567},[1828],{"type":407,"value":470},{"type":402,"tag":454,"props":1830,"children":1831},{"style":467},[1832],{"type":407,"value":1833},"data",{"type":402,"tag":454,"props":1835,"children":1836},{"style":567},[1837],{"type":407,"value":1748},{"type":402,"tag":454,"props":1839,"children":1840},{"style":828},[1841],{"type":407,"value":575},{"type":402,"tag":454,"props":1843,"children":1844},{"style":467},[1845],{"type":407,"value":935},{"type":402,"tag":454,"props":1847,"children":1848},{"style":552},[1849],{"type":407,"value":1785},{"type":402,"tag":454,"props":1851,"children":1853},{"class":456,"line":1852},37,[1854],{"type":402,"tag":454,"props":1855,"children":1856},{"style":552},[1857],{"type":407,"value":1858},"  };\n",{"type":402,"tag":454,"props":1860,"children":1862},{"class":456,"line":1861},38,[1863,1867,1872],{"type":402,"tag":454,"props":1864,"children":1865},{"style":552},[1866],{"type":407,"value":614},{"type":402,"tag":454,"props":1868,"children":1869},{"style":467},[1870],{"type":407,"value":1871},")()",{"type":402,"tag":454,"props":1873,"children":1874},{"style":552},[1875],{"type":407,"value":1785},{"type":402,"tag":403,"props":1877,"children":1878},{},[1879],{"type":407,"value":1880},"代码看完了，我知道你没看懂，因为曾经我也是。好了，留下三连，解析开始。",{"type":402,"tag":758,"props":1882,"children":1884},{"id":1883},"解析",[1885],{"type":407,"value":1883},{"type":402,"tag":403,"props":1887,"children":1888},{},[1889],{"type":407,"value":1890},"首先，代码最外层是一个 IIFE，给 this 对象挂载了 tmpl 函数，直接执行的话就是 window。内部通过局部变量保存了模板解析的缓存：",{"type":402,"tag":444,"props":1892,"children":1894},{"className":446,"code":1893,"language":448,"meta":396,"style":396},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {};\n})();\n",[1895],{"type":402,"tag":418,"props":1896,"children":1897},{"__ignoreMap":396},[1898,1917,1936,1987],{"type":402,"tag":454,"props":1899,"children":1900},{"class":456,"line":457},[1901,1905,1909,1913],{"type":402,"tag":454,"props":1902,"children":1903},{"style":467},[1904],{"type":407,"value":470},{"type":402,"tag":454,"props":1906,"children":1907},{"style":800},[1908],{"type":407,"value":803},{"type":402,"tag":454,"props":1910,"children":1911},{"style":552},[1912],{"type":407,"value":808},{"type":402,"tag":454,"props":1914,"children":1915},{"style":552},[1916],{"type":407,"value":560},{"type":402,"tag":454,"props":1918,"children":1919},{"class":456,"line":479},[1920,1924,1928,1932],{"type":402,"tag":454,"props":1921,"children":1922},{"style":800},[1923],{"type":407,"value":820},{"type":402,"tag":454,"props":1925,"children":1926},{"style":467},[1927],{"type":407,"value":825},{"type":402,"tag":454,"props":1929,"children":1930},{"style":828},[1931],{"type":407,"value":831},{"type":402,"tag":454,"props":1933,"children":1934},{"style":552},[1935],{"type":407,"value":836},{"type":402,"tag":454,"props":1937,"children":1938},{"class":456,"line":489},[1939,1943,1947,1951,1955,1959,1963,1967,1971,1975,1979,1983],{"type":402,"tag":454,"props":1940,"children":1941},{"style":851},[1942],{"type":407,"value":854},{"type":402,"tag":454,"props":1944,"children":1945},{"style":552},[1946],{"type":407,"value":859},{"type":402,"tag":454,"props":1948,"children":1949},{"style":461},[1950],{"type":407,"value":864},{"type":402,"tag":454,"props":1952,"children":1953},{"style":828},[1954],{"type":407,"value":831},{"type":402,"tag":454,"props":1956,"children":1957},{"style":800},[1958],{"type":407,"value":873},{"type":402,"tag":454,"props":1960,"children":1961},{"style":461},[1962],{"type":407,"value":878},{"type":402,"tag":454,"props":1964,"children":1965},{"style":552},[1966],{"type":407,"value":470},{"type":402,"tag":454,"props":1968,"children":1969},{"style":885},[1970],{"type":407,"value":888},{"type":402,"tag":454,"props":1972,"children":1973},{"style":552},[1974],{"type":407,"value":555},{"type":402,"tag":454,"props":1976,"children":1977},{"style":885},[1978],{"type":407,"value":897},{"type":402,"tag":454,"props":1980,"children":1981},{"style":552},[1982],{"type":407,"value":902},{"type":402,"tag":454,"props":1984,"children":1985},{"style":552},[1986],{"type":407,"value":836},{"type":402,"tag":454,"props":1988,"children":1989},{"class":456,"line":498},[1990,1994,1998],{"type":402,"tag":454,"props":1991,"children":1992},{"style":552},[1993],{"type":407,"value":614},{"type":402,"tag":454,"props":1995,"children":1996},{"style":467},[1997],{"type":407,"value":1871},{"type":402,"tag":454,"props":1999,"children":2000},{"style":552},[2001],{"type":407,"value":1785},{"type":402,"tag":403,"props":2003,"children":2004},{},[2005,2007,2013],{"type":407,"value":2006},"str 参数有两种两种用途，",{"type":402,"tag":418,"props":2008,"children":2010},{"className":2009},[],[2011],{"type":407,"value":2012},"/\\W/.test(str)",{"type":407,"value":2014}," 用来判断字符串中包不包含模板分隔符，如果不含分隔符，即普通字符串，那就当作 ID，从页面对应 ID 的节点中获取内容作为模板。比如，如果 str 为 'user_tmpl'，那么模板函数将会读取页面的以下脚本的内容作为输入：",{"type":402,"tag":444,"props":2016,"children":2018},{"className":634,"code":2017,"language":636,"meta":396,"style":396},"\u003C!-- type=\"text/html\"，所以浏览器并不会执行这串脚本。它只能由 tmpl 来读取... -->\n\u003Cscript type=\"text/html\" id=\"item_tmpl\">\n  \u003Cdiv id=\"\u003C%=id%>\" class=\"\u003C%=(i % 2 == 1 ? \" even\" : \"\")%>\">\n    \u003Cdiv class=\"grid_1 alpha right\">\n      \u003Cimg class=\"righted\" src=\"\u003C%=profile_image_url%>\"/>\n    \u003C/div>\n    \u003Cdiv class=\"grid_6 omega contents\">\n      \u003Cp>\u003Cb>\u003Ca href=\"/\u003C%=from_user%>\">\u003C%=from_user%>\u003C/a>:\u003C/b> \u003C%=text%>\u003C/p>\n    \u003C/div>\n  \u003C/div>\n\u003C/script>\n",[2019],{"type":402,"tag":418,"props":2020,"children":2021},{"__ignoreMap":396},[2022,2030,2091,2175,2212,2273,2289,2325,2430,2445,2461],{"type":402,"tag":454,"props":2023,"children":2024},{"class":456,"line":457},[2025],{"type":402,"tag":454,"props":2026,"children":2027},{"style":646},[2028],{"type":407,"value":2029},"\u003C!-- type=\"text/html\"，所以浏览器并不会执行这串脚本。它只能由 tmpl 来读取... -->\n",{"type":402,"tag":454,"props":2031,"children":2032},{"class":456,"line":479},[2033,2037,2042,2048,2052,2056,2061,2065,2070,2074,2078,2083,2087],{"type":402,"tag":454,"props":2034,"children":2035},{"style":552},[2036],{"type":407,"value":657},{"type":402,"tag":454,"props":2038,"children":2039},{"style":660},[2040],{"type":407,"value":2041},"script",{"type":402,"tag":454,"props":2043,"children":2045},{"style":2044},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[2046],{"type":407,"value":2047}," type",{"type":402,"tag":454,"props":2049,"children":2050},{"style":552},[2051],{"type":407,"value":1498},{"type":402,"tag":454,"props":2053,"children":2054},{"style":473},[2055],{"type":407,"value":1150},{"type":402,"tag":454,"props":2057,"children":2058},{"style":483},[2059],{"type":407,"value":2060},"text/html",{"type":402,"tag":454,"props":2062,"children":2063},{"style":473},[2064],{"type":407,"value":1150},{"type":402,"tag":454,"props":2066,"children":2067},{"style":2044},[2068],{"type":407,"value":2069}," id",{"type":402,"tag":454,"props":2071,"children":2072},{"style":552},[2073],{"type":407,"value":1498},{"type":402,"tag":454,"props":2075,"children":2076},{"style":473},[2077],{"type":407,"value":1150},{"type":402,"tag":454,"props":2079,"children":2080},{"style":483},[2081],{"type":407,"value":2082},"item_tmpl",{"type":402,"tag":454,"props":2084,"children":2085},{"style":473},[2086],{"type":407,"value":1150},{"type":402,"tag":454,"props":2088,"children":2089},{"style":552},[2090],{"type":407,"value":687},{"type":402,"tag":454,"props":2092,"children":2093},{"class":456,"line":489},[2094,2099,2103,2107,2111,2115,2120,2124,2129,2133,2137,2142,2146,2151,2156,2161,2166,2170],{"type":402,"tag":454,"props":2095,"children":2096},{"style":552},[2097],{"type":407,"value":2098},"  \u003C",{"type":402,"tag":454,"props":2100,"children":2101},{"style":660},[2102],{"type":407,"value":663},{"type":402,"tag":454,"props":2104,"children":2105},{"style":2044},[2106],{"type":407,"value":2069},{"type":402,"tag":454,"props":2108,"children":2109},{"style":552},[2110],{"type":407,"value":1498},{"type":402,"tag":454,"props":2112,"children":2113},{"style":473},[2114],{"type":407,"value":1150},{"type":402,"tag":454,"props":2116,"children":2117},{"style":483},[2118],{"type":407,"value":2119},"\u003C%=id%>",{"type":402,"tag":454,"props":2121,"children":2122},{"style":473},[2123],{"type":407,"value":1150},{"type":402,"tag":454,"props":2125,"children":2126},{"style":2044},[2127],{"type":407,"value":2128}," class",{"type":402,"tag":454,"props":2130,"children":2131},{"style":552},[2132],{"type":407,"value":1498},{"type":402,"tag":454,"props":2134,"children":2135},{"style":473},[2136],{"type":407,"value":1150},{"type":402,"tag":454,"props":2138,"children":2139},{"style":483},[2140],{"type":407,"value":2141},"\u003C%=(i % 2 == 1 ? ",{"type":402,"tag":454,"props":2143,"children":2144},{"style":473},[2145],{"type":407,"value":1150},{"type":402,"tag":454,"props":2147,"children":2148},{"style":2044},[2149],{"type":407,"value":2150}," even",{"type":402,"tag":454,"props":2152,"children":2154},{"style":2153},"--shiki-light:#39ADB5;--shiki-light-font-style:inherit;--shiki-default:#B31D28;--shiki-default-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;--shiki-sepia:#F44747;--shiki-sepia-font-style:inherit",[2155],{"type":407,"value":1150},{"type":402,"tag":454,"props":2157,"children":2158},{"style":2044},[2159],{"type":407,"value":2160}," :",{"type":402,"tag":454,"props":2162,"children":2163},{"style":2153},[2164],{"type":407,"value":2165}," \"\")%",{"type":402,"tag":454,"props":2167,"children":2168},{"style":552},[2169],{"type":407,"value":668},{"type":402,"tag":454,"props":2171,"children":2172},{"style":467},[2173],{"type":407,"value":2174},"\">\n",{"type":402,"tag":454,"props":2176,"children":2177},{"class":456,"line":498},[2178,2183,2187,2191,2195,2199,2204,2208],{"type":402,"tag":454,"props":2179,"children":2180},{"style":552},[2181],{"type":407,"value":2182},"    \u003C",{"type":402,"tag":454,"props":2184,"children":2185},{"style":660},[2186],{"type":407,"value":663},{"type":402,"tag":454,"props":2188,"children":2189},{"style":2044},[2190],{"type":407,"value":2128},{"type":402,"tag":454,"props":2192,"children":2193},{"style":552},[2194],{"type":407,"value":1498},{"type":402,"tag":454,"props":2196,"children":2197},{"style":473},[2198],{"type":407,"value":1150},{"type":402,"tag":454,"props":2200,"children":2201},{"style":483},[2202],{"type":407,"value":2203},"grid_1 alpha right",{"type":402,"tag":454,"props":2205,"children":2206},{"style":473},[2207],{"type":407,"value":1150},{"type":402,"tag":454,"props":2209,"children":2210},{"style":552},[2211],{"type":407,"value":687},{"type":402,"tag":454,"props":2213,"children":2214},{"class":456,"line":507},[2215,2220,2225,2229,2233,2237,2242,2246,2251,2255,2259,2264,2268],{"type":402,"tag":454,"props":2216,"children":2217},{"style":552},[2218],{"type":407,"value":2219},"      \u003C",{"type":402,"tag":454,"props":2221,"children":2222},{"style":660},[2223],{"type":407,"value":2224},"img",{"type":402,"tag":454,"props":2226,"children":2227},{"style":2044},[2228],{"type":407,"value":2128},{"type":402,"tag":454,"props":2230,"children":2231},{"style":552},[2232],{"type":407,"value":1498},{"type":402,"tag":454,"props":2234,"children":2235},{"style":473},[2236],{"type":407,"value":1150},{"type":402,"tag":454,"props":2238,"children":2239},{"style":483},[2240],{"type":407,"value":2241},"righted",{"type":402,"tag":454,"props":2243,"children":2244},{"style":473},[2245],{"type":407,"value":1150},{"type":402,"tag":454,"props":2247,"children":2248},{"style":2044},[2249],{"type":407,"value":2250}," src",{"type":402,"tag":454,"props":2252,"children":2253},{"style":552},[2254],{"type":407,"value":1498},{"type":402,"tag":454,"props":2256,"children":2257},{"style":473},[2258],{"type":407,"value":1150},{"type":402,"tag":454,"props":2260,"children":2261},{"style":483},[2262],{"type":407,"value":2263},"\u003C%=profile_image_url%>",{"type":402,"tag":454,"props":2265,"children":2266},{"style":473},[2267],{"type":407,"value":1150},{"type":402,"tag":454,"props":2269,"children":2270},{"style":552},[2271],{"type":407,"value":2272},"/>\n",{"type":402,"tag":454,"props":2274,"children":2275},{"class":456,"line":516},[2276,2281,2285],{"type":402,"tag":454,"props":2277,"children":2278},{"style":552},[2279],{"type":407,"value":2280},"    \u003C/",{"type":402,"tag":454,"props":2282,"children":2283},{"style":660},[2284],{"type":407,"value":663},{"type":402,"tag":454,"props":2286,"children":2287},{"style":552},[2288],{"type":407,"value":687},{"type":402,"tag":454,"props":2290,"children":2291},{"class":456,"line":525},[2292,2296,2300,2304,2308,2312,2317,2321],{"type":402,"tag":454,"props":2293,"children":2294},{"style":552},[2295],{"type":407,"value":2182},{"type":402,"tag":454,"props":2297,"children":2298},{"style":660},[2299],{"type":407,"value":663},{"type":402,"tag":454,"props":2301,"children":2302},{"style":2044},[2303],{"type":407,"value":2128},{"type":402,"tag":454,"props":2305,"children":2306},{"style":552},[2307],{"type":407,"value":1498},{"type":402,"tag":454,"props":2309,"children":2310},{"style":473},[2311],{"type":407,"value":1150},{"type":402,"tag":454,"props":2313,"children":2314},{"style":483},[2315],{"type":407,"value":2316},"grid_6 omega contents",{"type":402,"tag":454,"props":2318,"children":2319},{"style":473},[2320],{"type":407,"value":1150},{"type":402,"tag":454,"props":2322,"children":2323},{"style":552},[2324],{"type":407,"value":687},{"type":402,"tag":454,"props":2326,"children":2327},{"class":456,"line":534},[2328,2332,2336,2341,2346,2350,2354,2359,2363,2367,2372,2376,2380,2385,2389,2393,2397,2401,2405,2409,2413,2418,2422,2426],{"type":402,"tag":454,"props":2329,"children":2330},{"style":552},[2331],{"type":407,"value":2219},{"type":402,"tag":454,"props":2333,"children":2334},{"style":660},[2335],{"type":407,"value":403},{"type":402,"tag":454,"props":2337,"children":2338},{"style":552},[2339],{"type":407,"value":2340},">\u003C",{"type":402,"tag":454,"props":2342,"children":2343},{"style":660},[2344],{"type":407,"value":2345},"b",{"type":402,"tag":454,"props":2347,"children":2348},{"style":552},[2349],{"type":407,"value":2340},{"type":402,"tag":454,"props":2351,"children":2352},{"style":660},[2353],{"type":407,"value":410},{"type":402,"tag":454,"props":2355,"children":2356},{"style":2044},[2357],{"type":407,"value":2358}," href",{"type":402,"tag":454,"props":2360,"children":2361},{"style":552},[2362],{"type":407,"value":1498},{"type":402,"tag":454,"props":2364,"children":2365},{"style":473},[2366],{"type":407,"value":1150},{"type":402,"tag":454,"props":2368,"children":2369},{"style":483},[2370],{"type":407,"value":2371},"/\u003C%=from_user%>",{"type":402,"tag":454,"props":2373,"children":2374},{"style":473},[2375],{"type":407,"value":1150},{"type":402,"tag":454,"props":2377,"children":2378},{"style":552},[2379],{"type":407,"value":668},{"type":402,"tag":454,"props":2381,"children":2382},{"style":467},[2383],{"type":407,"value":2384},"\u003C%=from_user%>",{"type":402,"tag":454,"props":2386,"children":2387},{"style":552},[2388],{"type":407,"value":678},{"type":402,"tag":454,"props":2390,"children":2391},{"style":660},[2392],{"type":407,"value":410},{"type":402,"tag":454,"props":2394,"children":2395},{"style":552},[2396],{"type":407,"value":668},{"type":402,"tag":454,"props":2398,"children":2399},{"style":467},[2400],{"type":407,"value":575},{"type":402,"tag":454,"props":2402,"children":2403},{"style":552},[2404],{"type":407,"value":678},{"type":402,"tag":454,"props":2406,"children":2407},{"style":660},[2408],{"type":407,"value":2345},{"type":402,"tag":454,"props":2410,"children":2411},{"style":552},[2412],{"type":407,"value":668},{"type":402,"tag":454,"props":2414,"children":2415},{"style":467},[2416],{"type":407,"value":2417}," \u003C%=text%>",{"type":402,"tag":454,"props":2419,"children":2420},{"style":552},[2421],{"type":407,"value":678},{"type":402,"tag":454,"props":2423,"children":2424},{"style":660},[2425],{"type":407,"value":403},{"type":402,"tag":454,"props":2427,"children":2428},{"style":552},[2429],{"type":407,"value":687},{"type":402,"tag":454,"props":2431,"children":2432},{"class":456,"line":543},[2433,2437,2441],{"type":402,"tag":454,"props":2434,"children":2435},{"style":552},[2436],{"type":407,"value":2280},{"type":402,"tag":454,"props":2438,"children":2439},{"style":660},[2440],{"type":407,"value":663},{"type":402,"tag":454,"props":2442,"children":2443},{"style":552},[2444],{"type":407,"value":687},{"type":402,"tag":454,"props":2446,"children":2447},{"class":456,"line":563},[2448,2453,2457],{"type":402,"tag":454,"props":2449,"children":2450},{"style":552},[2451],{"type":407,"value":2452},"  \u003C/",{"type":402,"tag":454,"props":2454,"children":2455},{"style":660},[2456],{"type":407,"value":663},{"type":402,"tag":454,"props":2458,"children":2459},{"style":552},[2460],{"type":407,"value":687},{"type":402,"tag":454,"props":2462,"children":2463},{"class":456,"line":589},[2464,2468,2472],{"type":402,"tag":454,"props":2465,"children":2466},{"style":552},[2467],{"type":407,"value":678},{"type":402,"tag":454,"props":2469,"children":2470},{"style":660},[2471],{"type":407,"value":2041},{"type":402,"tag":454,"props":2473,"children":2474},{"style":552},[2475],{"type":407,"value":687},{"type":402,"tag":444,"props":2477,"children":2479},{"className":446,"code":2478,"language":448,"meta":396,"style":396},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {\n    return !/\\W/.test(str)\n      ? // 缓存会将读取脚本内容到模板解析这个过程的解析结果缓存下来\n        (cache[str] =\n          cache[str] ||\n          // 读取脚本内容\n          tmpl(document.getElementById(str).innerHTML))\n      : new Function();\n  };\n})();\n",[2480],{"type":402,"tag":418,"props":2481,"children":2482},{"__ignoreMap":396},[2483,2502,2521,2572,2615,2627,2655,2679,2687,2735,2760,2767],{"type":402,"tag":454,"props":2484,"children":2485},{"class":456,"line":457},[2486,2490,2494,2498],{"type":402,"tag":454,"props":2487,"children":2488},{"style":467},[2489],{"type":407,"value":470},{"type":402,"tag":454,"props":2491,"children":2492},{"style":800},[2493],{"type":407,"value":803},{"type":402,"tag":454,"props":2495,"children":2496},{"style":552},[2497],{"type":407,"value":808},{"type":402,"tag":454,"props":2499,"children":2500},{"style":552},[2501],{"type":407,"value":560},{"type":402,"tag":454,"props":2503,"children":2504},{"class":456,"line":479},[2505,2509,2513,2517],{"type":402,"tag":454,"props":2506,"children":2507},{"style":800},[2508],{"type":407,"value":820},{"type":402,"tag":454,"props":2510,"children":2511},{"style":467},[2512],{"type":407,"value":825},{"type":402,"tag":454,"props":2514,"children":2515},{"style":828},[2516],{"type":407,"value":831},{"type":402,"tag":454,"props":2518,"children":2519},{"style":552},[2520],{"type":407,"value":836},{"type":402,"tag":454,"props":2522,"children":2523},{"class":456,"line":489},[2524,2528,2532,2536,2540,2544,2548,2552,2556,2560,2564,2568],{"type":402,"tag":454,"props":2525,"children":2526},{"style":851},[2527],{"type":407,"value":854},{"type":402,"tag":454,"props":2529,"children":2530},{"style":552},[2531],{"type":407,"value":859},{"type":402,"tag":454,"props":2533,"children":2534},{"style":461},[2535],{"type":407,"value":864},{"type":402,"tag":454,"props":2537,"children":2538},{"style":828},[2539],{"type":407,"value":831},{"type":402,"tag":454,"props":2541,"children":2542},{"style":800},[2543],{"type":407,"value":873},{"type":402,"tag":454,"props":2545,"children":2546},{"style":461},[2547],{"type":407,"value":878},{"type":402,"tag":454,"props":2549,"children":2550},{"style":552},[2551],{"type":407,"value":470},{"type":402,"tag":454,"props":2553,"children":2554},{"style":885},[2555],{"type":407,"value":888},{"type":402,"tag":454,"props":2557,"children":2558},{"style":552},[2559],{"type":407,"value":555},{"type":402,"tag":454,"props":2561,"children":2562},{"style":885},[2563],{"type":407,"value":897},{"type":402,"tag":454,"props":2565,"children":2566},{"style":552},[2567],{"type":407,"value":902},{"type":402,"tag":454,"props":2569,"children":2570},{"style":552},[2571],{"type":407,"value":560},{"type":402,"tag":454,"props":2573,"children":2574},{"class":456,"line":498},[2575,2579,2583,2587,2591,2595,2599,2603,2607,2611],{"type":402,"tag":454,"props":2576,"children":2577},{"style":1387},[2578],{"type":407,"value":1811},{"type":402,"tag":454,"props":2580,"children":2581},{"style":828},[2582],{"type":407,"value":944},{"type":402,"tag":454,"props":2584,"children":2585},{"style":473},[2586],{"type":407,"value":949},{"type":402,"tag":454,"props":2588,"children":2589},{"style":952},[2590],{"type":407,"value":955},{"type":402,"tag":454,"props":2592,"children":2593},{"style":473},[2594],{"type":407,"value":949},{"type":402,"tag":454,"props":2596,"children":2597},{"style":552},[2598],{"type":407,"value":859},{"type":402,"tag":454,"props":2600,"children":2601},{"style":461},[2602],{"type":407,"value":968},{"type":402,"tag":454,"props":2604,"children":2605},{"style":567},[2606],{"type":407,"value":470},{"type":402,"tag":454,"props":2608,"children":2609},{"style":467},[2610],{"type":407,"value":888},{"type":402,"tag":454,"props":2612,"children":2613},{"style":567},[2614],{"type":407,"value":619},{"type":402,"tag":454,"props":2616,"children":2617},{"class":456,"line":507},[2618,2622],{"type":402,"tag":454,"props":2619,"children":2620},{"style":828},[2621],{"type":407,"value":988},{"type":402,"tag":454,"props":2623,"children":2624},{"style":646},[2625],{"type":407,"value":2626}," // 缓存会将读取脚本内容到模板解析这个过程的解析结果缓存下来\n",{"type":402,"tag":454,"props":2628,"children":2629},{"class":456,"line":516},[2630,2635,2639,2643,2647,2651],{"type":402,"tag":454,"props":2631,"children":2632},{"style":567},[2633],{"type":407,"value":2634},"        (",{"type":402,"tag":454,"props":2636,"children":2637},{"style":467},[2638],{"type":407,"value":998},{"type":402,"tag":454,"props":2640,"children":2641},{"style":567},[2642],{"type":407,"value":1003},{"type":402,"tag":454,"props":2644,"children":2645},{"style":467},[2646],{"type":407,"value":888},{"type":402,"tag":454,"props":2648,"children":2649},{"style":567},[2650],{"type":407,"value":1012},{"type":402,"tag":454,"props":2652,"children":2653},{"style":828},[2654],{"type":407,"value":1017},{"type":402,"tag":454,"props":2656,"children":2657},{"class":456,"line":525},[2658,2662,2666,2670,2674],{"type":402,"tag":454,"props":2659,"children":2660},{"style":467},[2661],{"type":407,"value":1025},{"type":402,"tag":454,"props":2663,"children":2664},{"style":567},[2665],{"type":407,"value":1003},{"type":402,"tag":454,"props":2667,"children":2668},{"style":467},[2669],{"type":407,"value":888},{"type":402,"tag":454,"props":2671,"children":2672},{"style":567},[2673],{"type":407,"value":1012},{"type":402,"tag":454,"props":2675,"children":2676},{"style":828},[2677],{"type":407,"value":2678},"||\n",{"type":402,"tag":454,"props":2680,"children":2681},{"class":456,"line":534},[2682],{"type":402,"tag":454,"props":2683,"children":2684},{"style":646},[2685],{"type":407,"value":2686},"          // 读取脚本内容\n",{"type":402,"tag":454,"props":2688,"children":2689},{"class":456,"line":543},[2690,2695,2699,2703,2707,2711,2715,2719,2723,2727,2731],{"type":402,"tag":454,"props":2691,"children":2692},{"style":461},[2693],{"type":407,"value":2694},"          tmpl",{"type":402,"tag":454,"props":2696,"children":2697},{"style":567},[2698],{"type":407,"value":470},{"type":402,"tag":454,"props":2700,"children":2701},{"style":467},[2702],{"type":407,"value":1055},{"type":402,"tag":454,"props":2704,"children":2705},{"style":552},[2706],{"type":407,"value":859},{"type":402,"tag":454,"props":2708,"children":2709},{"style":461},[2710],{"type":407,"value":1064},{"type":402,"tag":454,"props":2712,"children":2713},{"style":567},[2714],{"type":407,"value":470},{"type":402,"tag":454,"props":2716,"children":2717},{"style":467},[2718],{"type":407,"value":888},{"type":402,"tag":454,"props":2720,"children":2721},{"style":567},[2722],{"type":407,"value":902},{"type":402,"tag":454,"props":2724,"children":2725},{"style":552},[2726],{"type":407,"value":859},{"type":402,"tag":454,"props":2728,"children":2729},{"style":467},[2730],{"type":407,"value":1085},{"type":402,"tag":454,"props":2732,"children":2733},{"style":567},[2734],{"type":407,"value":1090},{"type":402,"tag":454,"props":2736,"children":2737},{"class":456,"line":563},[2738,2742,2747,2751,2756],{"type":402,"tag":454,"props":2739,"children":2740},{"style":828},[2741],{"type":407,"value":1098},{"type":402,"tag":454,"props":2743,"children":2744},{"style":828},[2745],{"type":407,"value":2746}," new",{"type":402,"tag":454,"props":2748,"children":2749},{"style":461},[2750],{"type":407,"value":1126},{"type":402,"tag":454,"props":2752,"children":2753},{"style":567},[2754],{"type":407,"value":2755},"()",{"type":402,"tag":454,"props":2757,"children":2758},{"style":552},[2759],{"type":407,"value":1785},{"type":402,"tag":454,"props":2761,"children":2762},{"class":456,"line":589},[2763],{"type":402,"tag":454,"props":2764,"children":2765},{"style":552},[2766],{"type":407,"value":1858},{"type":402,"tag":454,"props":2768,"children":2769},{"class":456,"line":608},[2770,2774,2778],{"type":402,"tag":454,"props":2771,"children":2772},{"style":552},[2773],{"type":407,"value":614},{"type":402,"tag":454,"props":2775,"children":2776},{"style":467},[2777],{"type":407,"value":1871},{"type":402,"tag":454,"props":2779,"children":2780},{"style":552},[2781],{"type":407,"value":1785},{"type":402,"tag":403,"props":2783,"children":2784},{},[2785,2791],{"type":402,"tag":418,"props":2786,"children":2788},{"className":2787},[],[2789],{"type":407,"value":2790},"new Function()",{"type":407,"value":2792}," 即模板解析的核心内容，原理是用一个数组，保存所有解析内容，再拼接回字符串，作为 JS 执行。类似 eval 函数。",{"type":402,"tag":444,"props":2794,"children":2796},{"className":446,"code":2795,"language":448,"meta":396,"style":396},"new Function(\n  \"obj\",\n  \"var p=[];\" +\n    // + '...'\n    \"return p.join('')\"\n);\n",[2797],{"type":402,"tag":418,"props":2798,"children":2799},{"__ignoreMap":396},[2800,2816,2836,2856,2864,2881],{"type":402,"tag":454,"props":2801,"children":2802},{"class":456,"line":457},[2803,2808,2812],{"type":402,"tag":454,"props":2804,"children":2805},{"style":828},[2806],{"type":407,"value":2807},"new",{"type":402,"tag":454,"props":2809,"children":2810},{"style":461},[2811],{"type":407,"value":1126},{"type":402,"tag":454,"props":2813,"children":2814},{"style":467},[2815],{"type":407,"value":1131},{"type":402,"tag":454,"props":2817,"children":2818},{"class":456,"line":479},[2819,2824,2828,2832],{"type":402,"tag":454,"props":2820,"children":2821},{"style":473},[2822],{"type":407,"value":2823},"  \"",{"type":402,"tag":454,"props":2825,"children":2826},{"style":483},[2827],{"type":407,"value":1145},{"type":402,"tag":454,"props":2829,"children":2830},{"style":473},[2831],{"type":407,"value":1150},{"type":402,"tag":454,"props":2833,"children":2834},{"style":552},[2835],{"type":407,"value":586},{"type":402,"tag":454,"props":2837,"children":2838},{"class":456,"line":489},[2839,2843,2848,2852],{"type":402,"tag":454,"props":2840,"children":2841},{"style":473},[2842],{"type":407,"value":2823},{"type":402,"tag":454,"props":2844,"children":2845},{"style":483},[2846],{"type":407,"value":2847},"var p=[];",{"type":402,"tag":454,"props":2849,"children":2850},{"style":473},[2851],{"type":407,"value":1150},{"type":402,"tag":454,"props":2853,"children":2854},{"style":828},[2855],{"type":407,"value":1176},{"type":402,"tag":454,"props":2857,"children":2858},{"class":456,"line":498},[2859],{"type":402,"tag":454,"props":2860,"children":2861},{"style":646},[2862],{"type":407,"value":2863},"    // + '...'\n",{"type":402,"tag":454,"props":2865,"children":2866},{"class":456,"line":507},[2867,2872,2877],{"type":402,"tag":454,"props":2868,"children":2869},{"style":473},[2870],{"type":407,"value":2871},"    \"",{"type":402,"tag":454,"props":2873,"children":2874},{"style":483},[2875],{"type":407,"value":2876},"return p.join('')",{"type":402,"tag":454,"props":2878,"children":2879},{"style":473},[2880],{"type":407,"value":1771},{"type":402,"tag":454,"props":2882,"children":2883},{"class":456,"line":516},[2884,2888],{"type":402,"tag":454,"props":2885,"children":2886},{"style":467},[2887],{"type":407,"value":902},{"type":402,"tag":454,"props":2889,"children":2890},{"style":552},[2891],{"type":407,"value":1785},{"type":402,"tag":403,"props":2893,"children":2894},{},[2895,2897,2903],{"type":407,"value":2896},"要解析什么内容呢？无非是 ",{"type":402,"tag":418,"props":2898,"children":2900},{"className":2899},[],[2901],{"type":407,"value":2902},"\u003C%=hello%>",{"type":407,"value":2904}," 这种模板字符串。执行过程中，通过 with 语句，将内部变量的求值（hello）转移到参数对象（data.hello）。这个玩意儿在 VueJS 的模板编译中也用到过：",{"type":402,"tag":444,"props":2906,"children":2908},{"className":446,"code":2907,"language":448,"meta":396,"style":396},"/* VueJS */\nwith (vm) {\n  return createVNode(\"p\", { attrs: { hi: hello /* vm.hello */ } }, [\n    createTextNode(\"Hello World\"),\n  ]);\n}\n",[2909],{"type":402,"tag":418,"props":2910,"children":2911},{"__ignoreMap":396},[2912,2920,2938,3023,3056,3068],{"type":402,"tag":454,"props":2913,"children":2914},{"class":456,"line":457},[2915],{"type":402,"tag":454,"props":2916,"children":2917},{"style":646},[2918],{"type":407,"value":2919},"/* VueJS */\n",{"type":402,"tag":454,"props":2921,"children":2922},{"class":456,"line":479},[2923,2928,2933],{"type":402,"tag":454,"props":2924,"children":2925},{"style":1387},[2926],{"type":407,"value":2927},"with",{"type":402,"tag":454,"props":2929,"children":2930},{"style":467},[2931],{"type":407,"value":2932}," (vm) ",{"type":402,"tag":454,"props":2934,"children":2935},{"style":552},[2936],{"type":407,"value":2937},"{\n",{"type":402,"tag":454,"props":2939,"children":2940},{"class":456,"line":489},[2941,2946,2951,2955,2959,2963,2967,2971,2976,2981,2985,2989,2994,2998,3003,3008,3013,3018],{"type":402,"tag":454,"props":2942,"children":2943},{"style":1387},[2944],{"type":407,"value":2945},"  return",{"type":402,"tag":454,"props":2947,"children":2948},{"style":461},[2949],{"type":407,"value":2950}," createVNode",{"type":402,"tag":454,"props":2952,"children":2953},{"style":567},[2954],{"type":407,"value":470},{"type":402,"tag":454,"props":2956,"children":2957},{"style":473},[2958],{"type":407,"value":1150},{"type":402,"tag":454,"props":2960,"children":2961},{"style":483},[2962],{"type":407,"value":403},{"type":402,"tag":454,"props":2964,"children":2965},{"style":473},[2966],{"type":407,"value":1150},{"type":402,"tag":454,"props":2968,"children":2969},{"style":552},[2970],{"type":407,"value":555},{"type":402,"tag":454,"props":2972,"children":2973},{"style":552},[2974],{"type":407,"value":2975}," {",{"type":402,"tag":454,"props":2977,"children":2978},{"style":567},[2979],{"type":407,"value":2980}," attrs",{"type":402,"tag":454,"props":2982,"children":2983},{"style":552},[2984],{"type":407,"value":575},{"type":402,"tag":454,"props":2986,"children":2987},{"style":552},[2988],{"type":407,"value":2975},{"type":402,"tag":454,"props":2990,"children":2991},{"style":567},[2992],{"type":407,"value":2993}," hi",{"type":402,"tag":454,"props":2995,"children":2996},{"style":552},[2997],{"type":407,"value":575},{"type":402,"tag":454,"props":2999,"children":3000},{"style":467},[3001],{"type":407,"value":3002}," hello",{"type":402,"tag":454,"props":3004,"children":3005},{"style":646},[3006],{"type":407,"value":3007}," /* vm.hello */",{"type":402,"tag":454,"props":3009,"children":3010},{"style":552},[3011],{"type":407,"value":3012}," }",{"type":402,"tag":454,"props":3014,"children":3015},{"style":552},[3016],{"type":407,"value":3017}," },",{"type":402,"tag":454,"props":3019,"children":3020},{"style":567},[3021],{"type":407,"value":3022}," [\n",{"type":402,"tag":454,"props":3024,"children":3025},{"class":456,"line":498},[3026,3031,3035,3039,3044,3048,3052],{"type":402,"tag":454,"props":3027,"children":3028},{"style":461},[3029],{"type":407,"value":3030},"    createTextNode",{"type":402,"tag":454,"props":3032,"children":3033},{"style":567},[3034],{"type":407,"value":470},{"type":402,"tag":454,"props":3036,"children":3037},{"style":473},[3038],{"type":407,"value":1150},{"type":402,"tag":454,"props":3040,"children":3041},{"style":483},[3042],{"type":407,"value":3043},"Hello World",{"type":402,"tag":454,"props":3045,"children":3046},{"style":473},[3047],{"type":407,"value":1150},{"type":402,"tag":454,"props":3049,"children":3050},{"style":567},[3051],{"type":407,"value":902},{"type":402,"tag":454,"props":3053,"children":3054},{"style":552},[3055],{"type":407,"value":586},{"type":402,"tag":454,"props":3057,"children":3058},{"class":456,"line":507},[3059,3064],{"type":402,"tag":454,"props":3060,"children":3061},{"style":567},[3062],{"type":407,"value":3063},"  ])",{"type":402,"tag":454,"props":3065,"children":3066},{"style":552},[3067],{"type":407,"value":1785},{"type":402,"tag":454,"props":3069,"children":3070},{"class":456,"line":516},[3071],{"type":402,"tag":454,"props":3072,"children":3073},{"style":552},[3074],{"type":407,"value":3075},"}\n",{"type":402,"tag":403,"props":3077,"children":3078},{},[3079],{"type":407,"value":3080},"那如何解析呢？",{"type":402,"tag":403,"props":3082,"children":3083},{},[3084,3090,3092,3098],{"type":402,"tag":3085,"props":3086,"children":3087},"del",{},[3088],{"type":407,"value":3089},"我们知道",{"type":407,"value":3091},"曾写过经典字符串模板的佬应该知道，",{"type":402,"tag":3093,"props":3094,"children":3095},"strong",{},[3096],{"type":407,"value":3097},"模板字符串一般包含：字符串、变量及逻辑",{"type":407,"value":3099},"。",{"type":402,"tag":3101,"props":3102,"children":3103},"ul",{},[3104,3116,3127],{"type":402,"tag":3105,"props":3106,"children":3107},"li",{},[3108,3110],{"type":407,"value":3109},"字符串 ",{"type":402,"tag":418,"props":3111,"children":3113},{"className":3112},[],[3114],{"type":407,"value":3115},"\u003Chtml>Lionad\u003C/html>",{"type":402,"tag":3105,"props":3117,"children":3118},{},[3119,3121],{"type":407,"value":3120},"带变量 ",{"type":402,"tag":418,"props":3122,"children":3124},{"className":3123},[],[3125],{"type":407,"value":3126},"\u003Chtml>\u003C%=name%>\u003C/html>",{"type":402,"tag":3105,"props":3128,"children":3129},{},[3130,3132,3138],{"type":407,"value":3131},"带逻辑 ",{"type":402,"tag":418,"props":3133,"children":3135},{"className":3134},[],[3136],{"type":407,"value":3137},"\u003C% if(name){ %>\u003Chtml>\u003C%=name%>\u003C/html>\u003C% } %>",{"type":407,"value":3099},{"type":402,"tag":403,"props":3140,"children":3141},{},[3142],{"type":407,"value":3143},"所以解析模板，无非就是把这三种字符串替换成纯粹的 JS 逻辑，作为 new Function 的参数。其中所有中间变量，可以用一个数组来储存：",{"type":402,"tag":3101,"props":3145,"children":3146},{},[3147,3166,3184],{"type":402,"tag":3105,"props":3148,"children":3149},{},[3150,3152,3157,3159,3165],{"type":407,"value":3151},"将普通字符串直接推入作为结果的内容数组，比如 ",{"type":402,"tag":418,"props":3153,"children":3155},{"className":3154},[],[3156],{"type":407,"value":3115},{"type":407,"value":3158}," 应该被解析为 ",{"type":402,"tag":418,"props":3160,"children":3162},{"className":3161},[],[3163],{"type":407,"value":3164},"p.push('\u003Chtml>Lionad\u003C/html>')",{"type":407,"value":3099},{"type":402,"tag":3105,"props":3167,"children":3168},{},[3169,3171,3176,3177,3183],{"type":407,"value":3170},"如果碰到变量，则将变量拆分出来推入数组，如 ",{"type":402,"tag":418,"props":3172,"children":3174},{"className":3173},[],[3175],{"type":407,"value":3126},{"type":407,"value":3158},{"type":402,"tag":418,"props":3178,"children":3180},{"className":3179},[],[3181],{"type":407,"value":3182},"p.push('\u003Chtml>');p.push(name);p.push('\u003C/html>')",{"type":407,"value":3099},{"type":402,"tag":3105,"props":3185,"children":3186},{},[3187,3189,3195,3197,3202,3204,3210],{"type":407,"value":3188},"带逻辑的字符串，由于逻辑本身就是 JS 代码，所以不需要解析为字符串，只需要把两侧的 ",{"type":402,"tag":418,"props":3190,"children":3192},{"className":3191},[],[3193],{"type":407,"value":3194},"\u003C% %>",{"type":407,"value":3196}," 这种模板标志去掉就好了。如 ",{"type":402,"tag":418,"props":3198,"children":3200},{"className":3199},[],[3201],{"type":407,"value":3137},{"type":407,"value":3203}," 应该被解析为：",{"type":402,"tag":418,"props":3205,"children":3207},{"className":3206},[],[3208],{"type":407,"value":3209},"if(name){ p.push('\u003Chtml>');p.push(name);p.push('\u003C/html>') } ",{"type":407,"value":3099},{"type":402,"tag":403,"props":3212,"children":3213},{},[3214],{"type":407,"value":3215},"以下面这段模板为例，我们看看字符串具体的替换规则。",{"type":402,"tag":444,"props":3217,"children":3219},{"className":446,"code":3218,"language":448,"meta":396,"style":396},"str = `\u003C% if (true) { %>\n    \u003Cli>\u003C%=users[i]%>\u003C/li>\n\u003C% } %>`;\n",[3220],{"type":402,"tag":418,"props":3221,"children":3222},{"__ignoreMap":396},[3223,3245,3253],{"type":402,"tag":454,"props":3224,"children":3225},{"class":456,"line":457},[3226,3231,3235,3240],{"type":402,"tag":454,"props":3227,"children":3228},{"style":467},[3229],{"type":407,"value":3230},"str ",{"type":402,"tag":454,"props":3232,"children":3233},{"style":828},[3234],{"type":407,"value":1498},{"type":402,"tag":454,"props":3236,"children":3237},{"style":473},[3238],{"type":407,"value":3239}," `",{"type":402,"tag":454,"props":3241,"children":3242},{"style":483},[3243],{"type":407,"value":3244},"\u003C% if (true) { %>\n",{"type":402,"tag":454,"props":3246,"children":3247},{"class":456,"line":479},[3248],{"type":402,"tag":454,"props":3249,"children":3250},{"style":483},[3251],{"type":407,"value":3252},"    \u003Cli>\u003C%=users[i]%>\u003C/li>\n",{"type":402,"tag":454,"props":3254,"children":3255},{"class":456,"line":489},[3256,3261,3265],{"type":402,"tag":454,"props":3257,"children":3258},{"style":483},[3259],{"type":407,"value":3260},"\u003C% } %>",{"type":402,"tag":454,"props":3262,"children":3263},{"style":473},[3264],{"type":407,"value":549},{"type":402,"tag":454,"props":3266,"children":3267},{"style":552},[3268],{"type":407,"value":1785},{"type":402,"tag":444,"props":3270,"children":3272},{"className":446,"code":3271,"language":448,"meta":396,"style":396},"// with 的使用方法都知道了，with(obj = { a })，那么\n// 就能在内部直接读取 a，不需要写 obj.a\n\"with(obj){p.push('\" +\n  str\n    // 将换行等空白字符转换为空格，这样所有代码都在一行了\n    // '\u003C% if (true) { %>     \u003Cli>\u003C%=users[i]%>\u003C/li> \u003C% } %>'\n    .replace(/[\\r\\t\\n]/g, \" \")\n    // ['', 'if (true) { %>\u003Cli>', '=users[i]%>\u003C/li>', ' } %>']\n    .split(\"\u003C%\")\n    // 因为 \\t 刚才已经被替换成空格了，所以这里可以使用 \\t 用来将不同行的代码字符串“相加”，\n    // 一会儿再拆分时，不会和原先字符串里的字符混淆\n    .join(\"\\t\")\n    // 去掉模板标志两端的引号，在这个例子里不会用到\n    .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\n    // 以下三句最重要，将所有变量推入数组，生成结果形如 `push('xxx',x,'xxx')` 的字符串\n    // 首先，刚才匹配完了 \u003C%，所以 \\t= 开头后边接的就是变量，这里让它转换成 ',x,' 的形式\n    .replace(/\\t=(.*?)%>/g, \"',$1,'\")\n    .split(\"\\t\")\n    // 在刚刚跟 split('\u003C%') 的位置用括号还原，得到了 ',x,'xxx'); 的形式\n    .join(\"');\")\n    // 在 \\t=xxx 那次匹配，已经把变量模板对应的结束标志 %> 匹配完了，\n    // 所以这是处理剩余语句的结束标志，用 split 拆分行后相当于直接把结束标记舍弃了\n    .split(\"%>\")\n    // 最终在每行开头增加 push 方法，形成了 push('xxx',x,'xxx'); 的形式\n    .join(\"p.push('\")\n    // 处理剩余的换行符\n    .split(\"\\r\")\n    .join(\"\\\\'\") +\n  \"');}\";\n",[3273],{"type":402,"tag":418,"props":3274,"children":3275},{"__ignoreMap":396},[3276,3284,3292,3311,3319,3327,3335,3391,3399,3430,3438,3446,3477,3485,3584,3592,3600,3675,3706,3714,3745,3753,3761,3792,3800,3831,3839,3870,3909],{"type":402,"tag":454,"props":3277,"children":3278},{"class":456,"line":457},[3279],{"type":402,"tag":454,"props":3280,"children":3281},{"style":646},[3282],{"type":407,"value":3283},"// with 的使用方法都知道了，with(obj = { a })，那么\n",{"type":402,"tag":454,"props":3285,"children":3286},{"class":456,"line":479},[3287],{"type":402,"tag":454,"props":3288,"children":3289},{"style":646},[3290],{"type":407,"value":3291},"// 就能在内部直接读取 a，不需要写 obj.a\n",{"type":402,"tag":454,"props":3293,"children":3294},{"class":456,"line":489},[3295,3299,3303,3307],{"type":402,"tag":454,"props":3296,"children":3297},{"style":473},[3298],{"type":407,"value":1150},{"type":402,"tag":454,"props":3300,"children":3301},{"style":483},[3302],{"type":407,"value":1199},{"type":402,"tag":454,"props":3304,"children":3305},{"style":473},[3306],{"type":407,"value":1150},{"type":402,"tag":454,"props":3308,"children":3309},{"style":828},[3310],{"type":407,"value":1176},{"type":402,"tag":454,"props":3312,"children":3313},{"class":456,"line":498},[3314],{"type":402,"tag":454,"props":3315,"children":3316},{"style":467},[3317],{"type":407,"value":3318},"  str\n",{"type":402,"tag":454,"props":3320,"children":3321},{"class":456,"line":507},[3322],{"type":402,"tag":454,"props":3323,"children":3324},{"style":646},[3325],{"type":407,"value":3326},"    // 将换行等空白字符转换为空格，这样所有代码都在一行了\n",{"type":402,"tag":454,"props":3328,"children":3329},{"class":456,"line":516},[3330],{"type":402,"tag":454,"props":3331,"children":3332},{"style":646},[3333],{"type":407,"value":3334},"    // '\u003C% if (true) { %>     \u003Cli>\u003C%=users[i]%>\u003C/li> \u003C% } %>'\n",{"type":402,"tag":454,"props":3336,"children":3337},{"class":456,"line":525},[3338,3343,3347,3351,3355,3359,3363,3367,3371,3375,3379,3383,3387],{"type":402,"tag":454,"props":3339,"children":3340},{"style":552},[3341],{"type":407,"value":3342},"    .",{"type":402,"tag":454,"props":3344,"children":3345},{"style":461},[3346],{"type":407,"value":1239},{"type":402,"tag":454,"props":3348,"children":3349},{"style":467},[3350],{"type":407,"value":470},{"type":402,"tag":454,"props":3352,"children":3353},{"style":473},[3354],{"type":407,"value":949},{"type":402,"tag":454,"props":3356,"children":3357},{"style":1250},[3358],{"type":407,"value":1003},{"type":402,"tag":454,"props":3360,"children":3361},{"style":952},[3362],{"type":407,"value":1257},{"type":402,"tag":454,"props":3364,"children":3365},{"style":1250},[3366],{"type":407,"value":1262},{"type":402,"tag":454,"props":3368,"children":3369},{"style":473},[3370],{"type":407,"value":949},{"type":402,"tag":454,"props":3372,"children":3373},{"style":1269},[3374],{"type":407,"value":1272},{"type":402,"tag":454,"props":3376,"children":3377},{"style":552},[3378],{"type":407,"value":555},{"type":402,"tag":454,"props":3380,"children":3381},{"style":473},[3382],{"type":407,"value":1281},{"type":402,"tag":454,"props":3384,"children":3385},{"style":473},[3386],{"type":407,"value":1281},{"type":402,"tag":454,"props":3388,"children":3389},{"style":467},[3390],{"type":407,"value":619},{"type":402,"tag":454,"props":3392,"children":3393},{"class":456,"line":534},[3394],{"type":402,"tag":454,"props":3395,"children":3396},{"style":646},[3397],{"type":407,"value":3398},"    // ['', 'if (true) { %>\u003Cli>', '=users[i]%>\u003C/li>', ' } %>']\n",{"type":402,"tag":454,"props":3400,"children":3401},{"class":456,"line":543},[3402,3406,3410,3414,3418,3422,3426],{"type":402,"tag":454,"props":3403,"children":3404},{"style":552},[3405],{"type":407,"value":3342},{"type":402,"tag":454,"props":3407,"children":3408},{"style":461},[3409],{"type":407,"value":1302},{"type":402,"tag":454,"props":3411,"children":3412},{"style":467},[3413],{"type":407,"value":470},{"type":402,"tag":454,"props":3415,"children":3416},{"style":473},[3417],{"type":407,"value":1150},{"type":402,"tag":454,"props":3419,"children":3420},{"style":483},[3421],{"type":407,"value":1315},{"type":402,"tag":454,"props":3423,"children":3424},{"style":473},[3425],{"type":407,"value":1150},{"type":402,"tag":454,"props":3427,"children":3428},{"style":467},[3429],{"type":407,"value":619},{"type":402,"tag":454,"props":3431,"children":3432},{"class":456,"line":563},[3433],{"type":402,"tag":454,"props":3434,"children":3435},{"style":646},[3436],{"type":407,"value":3437},"    // 因为 \\t 刚才已经被替换成空格了，所以这里可以使用 \\t 用来将不同行的代码字符串“相加”，\n",{"type":402,"tag":454,"props":3439,"children":3440},{"class":456,"line":589},[3441],{"type":402,"tag":454,"props":3442,"children":3443},{"style":646},[3444],{"type":407,"value":3445},"    // 一会儿再拆分时，不会和原先字符串里的字符混淆\n",{"type":402,"tag":454,"props":3447,"children":3448},{"class":456,"line":608},[3449,3453,3457,3461,3465,3469,3473],{"type":402,"tag":454,"props":3450,"children":3451},{"style":552},[3452],{"type":407,"value":3342},{"type":402,"tag":454,"props":3454,"children":3455},{"style":461},[3456],{"type":407,"value":1336},{"type":402,"tag":454,"props":3458,"children":3459},{"style":467},[3460],{"type":407,"value":470},{"type":402,"tag":454,"props":3462,"children":3463},{"style":473},[3464],{"type":407,"value":1150},{"type":402,"tag":454,"props":3466,"children":3467},{"style":1347},[3468],{"type":407,"value":1350},{"type":402,"tag":454,"props":3470,"children":3471},{"style":473},[3472],{"type":407,"value":1150},{"type":402,"tag":454,"props":3474,"children":3475},{"style":467},[3476],{"type":407,"value":619},{"type":402,"tag":454,"props":3478,"children":3479},{"class":456,"line":1106},[3480],{"type":402,"tag":454,"props":3481,"children":3482},{"style":646},[3483],{"type":407,"value":3484},"    // 去掉模板标志两端的引号，在这个例子里不会用到\n",{"type":402,"tag":454,"props":3486,"children":3487},{"class":456,"line":1115},[3488,3492,3496,3500,3504,3508,3512,3516,3520,3524,3528,3532,3536,3540,3544,3548,3552,3556,3560,3564,3568,3572,3576,3580],{"type":402,"tag":454,"props":3489,"children":3490},{"style":552},[3491],{"type":407,"value":3342},{"type":402,"tag":454,"props":3493,"children":3494},{"style":461},[3495],{"type":407,"value":1239},{"type":402,"tag":454,"props":3497,"children":3498},{"style":467},[3499],{"type":407,"value":470},{"type":402,"tag":454,"props":3501,"children":3502},{"style":473},[3503],{"type":407,"value":949},{"type":402,"tag":454,"props":3505,"children":3506},{"style":1381},[3507],{"type":407,"value":1384},{"type":402,"tag":454,"props":3509,"children":3510},{"style":1387},[3511],{"type":407,"value":1390},{"type":402,"tag":454,"props":3513,"children":3514},{"style":828},[3515],{"type":407,"value":1395},{"type":402,"tag":454,"props":3517,"children":3518},{"style":1398},[3519],{"type":407,"value":1401},{"type":402,"tag":454,"props":3521,"children":3522},{"style":1381},[3523],{"type":407,"value":902},{"type":402,"tag":454,"props":3525,"children":3526},{"style":1250},[3527],{"type":407,"value":1003},{"type":402,"tag":454,"props":3529,"children":3530},{"style":828},[3531],{"type":407,"value":1390},{"type":402,"tag":454,"props":3533,"children":3534},{"style":952},[3535],{"type":407,"value":1350},{"type":402,"tag":454,"props":3537,"children":3538},{"style":1250},[3539],{"type":407,"value":1262},{"type":402,"tag":454,"props":3541,"children":3542},{"style":828},[3543],{"type":407,"value":1426},{"type":402,"tag":454,"props":3545,"children":3546},{"style":1381},[3547],{"type":407,"value":902},{"type":402,"tag":454,"props":3549,"children":3550},{"style":1398},[3551],{"type":407,"value":1435},{"type":402,"tag":454,"props":3553,"children":3554},{"style":473},[3555],{"type":407,"value":949},{"type":402,"tag":454,"props":3557,"children":3558},{"style":1269},[3559],{"type":407,"value":1272},{"type":402,"tag":454,"props":3561,"children":3562},{"style":552},[3563],{"type":407,"value":555},{"type":402,"tag":454,"props":3565,"children":3566},{"style":473},[3567],{"type":407,"value":1281},{"type":402,"tag":454,"props":3569,"children":3570},{"style":483},[3571],{"type":407,"value":1456},{"type":402,"tag":454,"props":3573,"children":3574},{"style":1347},[3575],{"type":407,"value":1461},{"type":402,"tag":454,"props":3577,"children":3578},{"style":473},[3579],{"type":407,"value":1150},{"type":402,"tag":454,"props":3581,"children":3582},{"style":467},[3583],{"type":407,"value":619},{"type":402,"tag":454,"props":3585,"children":3586},{"class":456,"line":1134},[3587],{"type":402,"tag":454,"props":3588,"children":3589},{"style":646},[3590],{"type":407,"value":3591},"    // 以下三句最重要，将所有变量推入数组，生成结果形如 `push('xxx',x,'xxx')` 的字符串\n",{"type":402,"tag":454,"props":3593,"children":3594},{"class":456,"line":1157},[3595],{"type":402,"tag":454,"props":3596,"children":3597},{"style":646},[3598],{"type":407,"value":3599},"    // 首先，刚才匹配完了 \u003C%，所以 \\t= 开头后边接的就是变量，这里让它转换成 ',x,' 的形式\n",{"type":402,"tag":454,"props":3601,"children":3602},{"class":456,"line":1179},[3603,3607,3611,3615,3619,3623,3627,3631,3635,3639,3643,3647,3651,3655,3659,3663,3667,3671],{"type":402,"tag":454,"props":3604,"children":3605},{"style":552},[3606],{"type":407,"value":3342},{"type":402,"tag":454,"props":3608,"children":3609},{"style":461},[3610],{"type":407,"value":1239},{"type":402,"tag":454,"props":3612,"children":3613},{"style":467},[3614],{"type":407,"value":470},{"type":402,"tag":454,"props":3616,"children":3617},{"style":473},[3618],{"type":407,"value":949},{"type":402,"tag":454,"props":3620,"children":3621},{"style":952},[3622],{"type":407,"value":1350},{"type":402,"tag":454,"props":3624,"children":3625},{"style":1398},[3626],{"type":407,"value":1498},{"type":402,"tag":454,"props":3628,"children":3629},{"style":1381},[3630],{"type":407,"value":470},{"type":402,"tag":454,"props":3632,"children":3633},{"style":952},[3634],{"type":407,"value":859},{"type":402,"tag":454,"props":3636,"children":3637},{"style":828},[3638],{"type":407,"value":1511},{"type":402,"tag":454,"props":3640,"children":3641},{"style":1381},[3642],{"type":407,"value":902},{"type":402,"tag":454,"props":3644,"children":3645},{"style":1398},[3646],{"type":407,"value":1401},{"type":402,"tag":454,"props":3648,"children":3649},{"style":473},[3650],{"type":407,"value":949},{"type":402,"tag":454,"props":3652,"children":3653},{"style":1269},[3654],{"type":407,"value":1272},{"type":402,"tag":454,"props":3656,"children":3657},{"style":552},[3658],{"type":407,"value":555},{"type":402,"tag":454,"props":3660,"children":3661},{"style":473},[3662],{"type":407,"value":1281},{"type":402,"tag":454,"props":3664,"children":3665},{"style":483},[3666],{"type":407,"value":1540},{"type":402,"tag":454,"props":3668,"children":3669},{"style":473},[3670],{"type":407,"value":1150},{"type":402,"tag":454,"props":3672,"children":3673},{"style":467},[3674],{"type":407,"value":619},{"type":402,"tag":454,"props":3676,"children":3677},{"class":456,"line":1188},[3678,3682,3686,3690,3694,3698,3702],{"type":402,"tag":454,"props":3679,"children":3680},{"style":552},[3681],{"type":407,"value":3342},{"type":402,"tag":454,"props":3683,"children":3684},{"style":461},[3685],{"type":407,"value":1302},{"type":402,"tag":454,"props":3687,"children":3688},{"style":467},[3689],{"type":407,"value":470},{"type":402,"tag":454,"props":3691,"children":3692},{"style":473},[3693],{"type":407,"value":1150},{"type":402,"tag":454,"props":3695,"children":3696},{"style":1347},[3697],{"type":407,"value":1350},{"type":402,"tag":454,"props":3699,"children":3700},{"style":473},[3701],{"type":407,"value":1150},{"type":402,"tag":454,"props":3703,"children":3704},{"style":467},[3705],{"type":407,"value":619},{"type":402,"tag":454,"props":3707,"children":3708},{"class":456,"line":1210},[3709],{"type":402,"tag":454,"props":3710,"children":3711},{"style":646},[3712],{"type":407,"value":3713},"    // 在刚刚跟 split('\u003C%') 的位置用括号还原，得到了 ',x,'xxx'); 的形式\n",{"type":402,"tag":454,"props":3715,"children":3716},{"class":456,"line":1219},[3717,3721,3725,3729,3733,3737,3741],{"type":402,"tag":454,"props":3718,"children":3719},{"style":552},[3720],{"type":407,"value":3342},{"type":402,"tag":454,"props":3722,"children":3723},{"style":461},[3724],{"type":407,"value":1336},{"type":402,"tag":454,"props":3726,"children":3727},{"style":467},[3728],{"type":407,"value":470},{"type":402,"tag":454,"props":3730,"children":3731},{"style":473},[3732],{"type":407,"value":1150},{"type":402,"tag":454,"props":3734,"children":3735},{"style":483},[3736],{"type":407,"value":1605},{"type":402,"tag":454,"props":3738,"children":3739},{"style":473},[3740],{"type":407,"value":1150},{"type":402,"tag":454,"props":3742,"children":3743},{"style":467},[3744],{"type":407,"value":619},{"type":402,"tag":454,"props":3746,"children":3747},{"class":456,"line":1228},[3748],{"type":402,"tag":454,"props":3749,"children":3750},{"style":646},[3751],{"type":407,"value":3752},"    // 在 \\t=xxx 那次匹配，已经把变量模板对应的结束标志 %> 匹配完了，\n",{"type":402,"tag":454,"props":3754,"children":3755},{"class":456,"line":1292},[3756],{"type":402,"tag":454,"props":3757,"children":3758},{"style":646},[3759],{"type":407,"value":3760},"    // 所以这是处理剩余语句的结束标志，用 split 拆分行后相当于直接把结束标记舍弃了\n",{"type":402,"tag":454,"props":3762,"children":3763},{"class":456,"line":1326},[3764,3768,3772,3776,3780,3784,3788],{"type":402,"tag":454,"props":3765,"children":3766},{"style":552},[3767],{"type":407,"value":3342},{"type":402,"tag":454,"props":3769,"children":3770},{"style":461},[3771],{"type":407,"value":1302},{"type":402,"tag":454,"props":3773,"children":3774},{"style":467},[3775],{"type":407,"value":470},{"type":402,"tag":454,"props":3777,"children":3778},{"style":473},[3779],{"type":407,"value":1150},{"type":402,"tag":454,"props":3781,"children":3782},{"style":483},[3783],{"type":407,"value":1401},{"type":402,"tag":454,"props":3785,"children":3786},{"style":473},[3787],{"type":407,"value":1150},{"type":402,"tag":454,"props":3789,"children":3790},{"style":467},[3791],{"type":407,"value":619},{"type":402,"tag":454,"props":3793,"children":3794},{"class":456,"line":1361},[3795],{"type":402,"tag":454,"props":3796,"children":3797},{"style":646},[3798],{"type":407,"value":3799},"    // 最终在每行开头增加 push 方法，形成了 push('xxx',x,'xxx'); 的形式\n",{"type":402,"tag":454,"props":3801,"children":3802},{"class":456,"line":1472},[3803,3807,3811,3815,3819,3823,3827],{"type":402,"tag":454,"props":3804,"children":3805},{"style":552},[3806],{"type":407,"value":3342},{"type":402,"tag":454,"props":3808,"children":3809},{"style":461},[3810],{"type":407,"value":1336},{"type":402,"tag":454,"props":3812,"children":3813},{"style":467},[3814],{"type":407,"value":470},{"type":402,"tag":454,"props":3816,"children":3817},{"style":473},[3818],{"type":407,"value":1150},{"type":402,"tag":454,"props":3820,"children":3821},{"style":483},[3822],{"type":407,"value":1670},{"type":402,"tag":454,"props":3824,"children":3825},{"style":473},[3826],{"type":407,"value":1150},{"type":402,"tag":454,"props":3828,"children":3829},{"style":467},[3830],{"type":407,"value":619},{"type":402,"tag":454,"props":3832,"children":3833},{"class":456,"line":1551},[3834],{"type":402,"tag":454,"props":3835,"children":3836},{"style":646},[3837],{"type":407,"value":3838},"    // 处理剩余的换行符\n",{"type":402,"tag":454,"props":3840,"children":3841},{"class":456,"line":1583},[3842,3846,3850,3854,3858,3862,3866],{"type":402,"tag":454,"props":3843,"children":3844},{"style":552},[3845],{"type":407,"value":3342},{"type":402,"tag":454,"props":3847,"children":3848},{"style":461},[3849],{"type":407,"value":1302},{"type":402,"tag":454,"props":3851,"children":3852},{"style":467},[3853],{"type":407,"value":470},{"type":402,"tag":454,"props":3855,"children":3856},{"style":473},[3857],{"type":407,"value":1150},{"type":402,"tag":454,"props":3859,"children":3860},{"style":1347},[3861],{"type":407,"value":1461},{"type":402,"tag":454,"props":3863,"children":3864},{"style":473},[3865],{"type":407,"value":1150},{"type":402,"tag":454,"props":3867,"children":3868},{"style":467},[3869],{"type":407,"value":619},{"type":402,"tag":454,"props":3871,"children":3872},{"class":456,"line":1616},[3873,3877,3881,3885,3889,3893,3897,3901,3905],{"type":402,"tag":454,"props":3874,"children":3875},{"style":552},[3876],{"type":407,"value":3342},{"type":402,"tag":454,"props":3878,"children":3879},{"style":461},[3880],{"type":407,"value":1336},{"type":402,"tag":454,"props":3882,"children":3883},{"style":467},[3884],{"type":407,"value":470},{"type":402,"tag":454,"props":3886,"children":3887},{"style":473},[3888],{"type":407,"value":1150},{"type":402,"tag":454,"props":3890,"children":3891},{"style":1347},[3892],{"type":407,"value":1735},{"type":402,"tag":454,"props":3894,"children":3895},{"style":483},[3896],{"type":407,"value":1435},{"type":402,"tag":454,"props":3898,"children":3899},{"style":473},[3900],{"type":407,"value":1150},{"type":402,"tag":454,"props":3902,"children":3903},{"style":467},[3904],{"type":407,"value":1748},{"type":402,"tag":454,"props":3906,"children":3907},{"style":828},[3908],{"type":407,"value":1753},{"type":402,"tag":454,"props":3910,"children":3911},{"class":456,"line":1648},[3912,3916,3921,3925],{"type":402,"tag":454,"props":3913,"children":3914},{"style":473},[3915],{"type":407,"value":2823},{"type":402,"tag":454,"props":3917,"children":3918},{"style":483},[3919],{"type":407,"value":3920},"');}",{"type":402,"tag":454,"props":3922,"children":3923},{"style":473},[3924],{"type":407,"value":1150},{"type":402,"tag":454,"props":3926,"children":3927},{"style":552},[3928],{"type":407,"value":1785},{"type":402,"tag":403,"props":3930,"children":3931},{},[3932,3934,3939,3941,3946,3948,3953,3954,3960,3962,3967,3969,3974],{"type":407,"value":3933},"有一个小细节，字符串替换时，所有逻辑语句的模板标志开头和结尾（",{"type":402,"tag":418,"props":3935,"children":3937},{"className":3936},[],[3938],{"type":407,"value":1315},{"type":407,"value":3940},"、",{"type":402,"tag":418,"props":3942,"children":3944},{"className":3943},[],[3945],{"type":407,"value":1401},{"type":407,"value":3947},"）分别被替换为 ",{"type":402,"tag":418,"props":3949,"children":3951},{"className":3950},[],[3952],{"type":407,"value":1605},{"type":407,"value":3940},{"type":402,"tag":418,"props":3955,"children":3957},{"className":3956},[],[3958],{"type":407,"value":3959},"push('",{"type":407,"value":3961},"，但是开头和结尾的那个标志，并没有对应的匹配。所以在代码中，能看 ",{"type":402,"tag":418,"props":3963,"children":3965},{"className":3964},[],[3966],{"type":407,"value":1199},{"type":407,"value":3968}," 和 ",{"type":402,"tag":418,"props":3970,"children":3972},{"className":3971},[],[3973],{"type":407,"value":1605},{"type":407,"value":3975}," 这种手动补全。",{"type":402,"tag":403,"props":3977,"children":3978},{},[3979],{"type":407,"value":3980},"最终生成的字符串如下（已格式化处理）：",{"type":402,"tag":444,"props":3982,"children":3984},{"className":446,"code":3983,"language":448,"meta":396,"style":396},"`with(obj){\n    p.push(''); \n    if (true) { \n        p.push('     \u003Cli>',users[i],'\u003C/li>   '); \n    } \n    p.push('');\n}`;\n",[3985],{"type":402,"tag":418,"props":3986,"children":3987},{"__ignoreMap":396},[3988,4000,4008,4016,4024,4032,4040],{"type":402,"tag":454,"props":3989,"children":3990},{"class":456,"line":457},[3991,3995],{"type":402,"tag":454,"props":3992,"children":3993},{"style":473},[3994],{"type":407,"value":549},{"type":402,"tag":454,"props":3996,"children":3997},{"style":483},[3998],{"type":407,"value":3999},"with(obj){\n",{"type":402,"tag":454,"props":4001,"children":4002},{"class":456,"line":479},[4003],{"type":402,"tag":454,"props":4004,"children":4005},{"style":483},[4006],{"type":407,"value":4007},"    p.push(''); \n",{"type":402,"tag":454,"props":4009,"children":4010},{"class":456,"line":489},[4011],{"type":402,"tag":454,"props":4012,"children":4013},{"style":483},[4014],{"type":407,"value":4015},"    if (true) { \n",{"type":402,"tag":454,"props":4017,"children":4018},{"class":456,"line":498},[4019],{"type":402,"tag":454,"props":4020,"children":4021},{"style":483},[4022],{"type":407,"value":4023},"        p.push('     \u003Cli>',users[i],'\u003C/li>   '); \n",{"type":402,"tag":454,"props":4025,"children":4026},{"class":456,"line":507},[4027],{"type":402,"tag":454,"props":4028,"children":4029},{"style":483},[4030],{"type":407,"value":4031},"    } \n",{"type":402,"tag":454,"props":4033,"children":4034},{"class":456,"line":516},[4035],{"type":402,"tag":454,"props":4036,"children":4037},{"style":483},[4038],{"type":407,"value":4039},"    p.push('');\n",{"type":402,"tag":454,"props":4041,"children":4042},{"class":456,"line":525},[4043,4047,4051],{"type":402,"tag":454,"props":4044,"children":4045},{"style":483},[4046],{"type":407,"value":614},{"type":402,"tag":454,"props":4048,"children":4049},{"style":473},[4050],{"type":407,"value":549},{"type":402,"tag":454,"props":4052,"children":4053},{"style":552},[4054],{"type":407,"value":1785},{"type":402,"tag":403,"props":4056,"children":4057},{},[4058,4060,4066],{"type":407,"value":4059},"为什么 with 语句里有一行空的 ",{"type":402,"tag":418,"props":4061,"children":4063},{"className":4062},[],[4064],{"type":407,"value":4065},"push('')",{"type":407,"value":4067}," 呢？",{"type":402,"tag":403,"props":4069,"children":4070},{},[4071],{"type":407,"value":4072},"还记得原始的模板吗？一开的模板是以“\u003C%”开头的，而“\u003C%”在替换过程被右括号取代了，此时正好和初始字符串结合形成了空 push。如果原始字符串开头是 \"123\u003C% if (true)\"，那这行空 push 会转换成“p.push('123');”，也是正确的代码。",{"type":402,"tag":403,"props":4074,"children":4075},{},[4076],{"type":407,"value":4077},"最后，micro-templating 需要返回这个新函数。如果不传参数 data 给模板函数，则会返回一个部分应用的函数等待用户输入 data 参数再执行模板解析；如果已经传了 data 那就会立即调用返回模板解析的结果。",{"type":402,"tag":444,"props":4079,"children":4081},{"className":446,"code":4080,"language":448,"meta":396,"style":396},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {\n    return data ? fn(data) : fn;\n  };\n})();\n",[4082],{"type":402,"tag":418,"props":4083,"children":4084},{"__ignoreMap":396},[4085,4104,4123,4174,4217,4224],{"type":402,"tag":454,"props":4086,"children":4087},{"class":456,"line":457},[4088,4092,4096,4100],{"type":402,"tag":454,"props":4089,"children":4090},{"style":467},[4091],{"type":407,"value":470},{"type":402,"tag":454,"props":4093,"children":4094},{"style":800},[4095],{"type":407,"value":803},{"type":402,"tag":454,"props":4097,"children":4098},{"style":552},[4099],{"type":407,"value":808},{"type":402,"tag":454,"props":4101,"children":4102},{"style":552},[4103],{"type":407,"value":560},{"type":402,"tag":454,"props":4105,"children":4106},{"class":456,"line":479},[4107,4111,4115,4119],{"type":402,"tag":454,"props":4108,"children":4109},{"style":800},[4110],{"type":407,"value":820},{"type":402,"tag":454,"props":4112,"children":4113},{"style":467},[4114],{"type":407,"value":825},{"type":402,"tag":454,"props":4116,"children":4117},{"style":828},[4118],{"type":407,"value":831},{"type":402,"tag":454,"props":4120,"children":4121},{"style":552},[4122],{"type":407,"value":836},{"type":402,"tag":454,"props":4124,"children":4125},{"class":456,"line":489},[4126,4130,4134,4138,4142,4146,4150,4154,4158,4162,4166,4170],{"type":402,"tag":454,"props":4127,"children":4128},{"style":851},[4129],{"type":407,"value":854},{"type":402,"tag":454,"props":4131,"children":4132},{"style":552},[4133],{"type":407,"value":859},{"type":402,"tag":454,"props":4135,"children":4136},{"style":461},[4137],{"type":407,"value":864},{"type":402,"tag":454,"props":4139,"children":4140},{"style":828},[4141],{"type":407,"value":831},{"type":402,"tag":454,"props":4143,"children":4144},{"style":800},[4145],{"type":407,"value":873},{"type":402,"tag":454,"props":4147,"children":4148},{"style":461},[4149],{"type":407,"value":878},{"type":402,"tag":454,"props":4151,"children":4152},{"style":552},[4153],{"type":407,"value":470},{"type":402,"tag":454,"props":4155,"children":4156},{"style":885},[4157],{"type":407,"value":888},{"type":402,"tag":454,"props":4159,"children":4160},{"style":552},[4161],{"type":407,"value":555},{"type":402,"tag":454,"props":4163,"children":4164},{"style":885},[4165],{"type":407,"value":897},{"type":402,"tag":454,"props":4167,"children":4168},{"style":552},[4169],{"type":407,"value":902},{"type":402,"tag":454,"props":4171,"children":4172},{"style":552},[4173],{"type":407,"value":560},{"type":402,"tag":454,"props":4175,"children":4176},{"class":456,"line":498},[4177,4181,4185,4189,4193,4197,4201,4205,4209,4213],{"type":402,"tag":454,"props":4178,"children":4179},{"style":1387},[4180],{"type":407,"value":1811},{"type":402,"tag":454,"props":4182,"children":4183},{"style":467},[4184],{"type":407,"value":897},{"type":402,"tag":454,"props":4186,"children":4187},{"style":828},[4188],{"type":407,"value":1820},{"type":402,"tag":454,"props":4190,"children":4191},{"style":461},[4192],{"type":407,"value":935},{"type":402,"tag":454,"props":4194,"children":4195},{"style":567},[4196],{"type":407,"value":470},{"type":402,"tag":454,"props":4198,"children":4199},{"style":467},[4200],{"type":407,"value":1833},{"type":402,"tag":454,"props":4202,"children":4203},{"style":567},[4204],{"type":407,"value":1748},{"type":402,"tag":454,"props":4206,"children":4207},{"style":828},[4208],{"type":407,"value":575},{"type":402,"tag":454,"props":4210,"children":4211},{"style":467},[4212],{"type":407,"value":935},{"type":402,"tag":454,"props":4214,"children":4215},{"style":552},[4216],{"type":407,"value":1785},{"type":402,"tag":454,"props":4218,"children":4219},{"class":456,"line":507},[4220],{"type":402,"tag":454,"props":4221,"children":4222},{"style":552},[4223],{"type":407,"value":1858},{"type":402,"tag":454,"props":4225,"children":4226},{"class":456,"line":516},[4227,4231,4235],{"type":402,"tag":454,"props":4228,"children":4229},{"style":552},[4230],{"type":407,"value":614},{"type":402,"tag":454,"props":4232,"children":4233},{"style":467},[4234],{"type":407,"value":1871},{"type":402,"tag":454,"props":4236,"children":4237},{"style":552},[4238],{"type":407,"value":1785},{"type":402,"tag":403,"props":4240,"children":4241},{},[4242],{"type":407,"value":4243},"终于结束了！这个函数不长，但一口气看下来还是蛮费力气的。如果一遍写测试用例以便看代码，很快能把这个函数跑通，如果你是纯靠脑力跑，还没被那个长长的字符串替换链给吓住，在此我赐你称号：“Micro Templating 人肉编译器 - 十五周年限定版”。",{"type":402,"tag":403,"props":4245,"children":4246},{},[4247,4249,4256,4258,4263],{"type":407,"value":4248},"额外提一句，Function 构造器和 eval 函数比，除了能传参数意外，还有一些细节不同，比如说声明变量的作用域不同，这个需要注意。这个编译器没有错误处理等代码完善，因此不可以上生产。此外，由于 ",{"type":402,"tag":410,"props":4250,"children":4254},{"href":4251,"rel":4252},"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/with",[4253],"nofollow",[4255],{"type":407,"value":2927},{"type":407,"value":4257}," 语句非常容易出错，且不利于静态优化，不应该在业务函数里使用",{"type":402,"tag":454,"props":4259,"children":4260},{},[4261],{"type":407,"value":4262},"^with-mdn",{"type":407,"value":4264},"。最后，阅读源码需要技巧，这几点希望能帮助到你：",{"type":402,"tag":3101,"props":4266,"children":4267},{},[4268,4273,4278,4283],{"type":402,"tag":3105,"props":4269,"children":4270},{},[4271],{"type":407,"value":4272},"从注释、测试用例，先搞清楚要看的代码的作用",{"type":402,"tag":3105,"props":4274,"children":4275},{},[4276],{"type":407,"value":4277},"使用编辑器的折叠代码，一次只看一部分源码",{"type":402,"tag":3105,"props":4279,"children":4280},{},[4281],{"type":407,"value":4282},"在 Git 提交记录中搜索，从简单的版本看起",{"type":402,"tag":3105,"props":4284,"children":4285},{},[4286],{"type":407,"value":4287},"复杂代码应该从高层结构看起，比如使用 IDE 各种插件或是 Madge 等代码分析工具",{"type":402,"tag":758,"props":4289,"children":4291},{"id":4290},"相关链接",[4292],{"type":407,"value":4290},{"type":402,"tag":3101,"props":4294,"children":4295},{},[4296],{"type":402,"tag":3105,"props":4297,"children":4298},{},[4299],{"type":402,"tag":410,"props":4300,"children":4303},{"href":4301,"rel":4302},"https://johnresig.com/blog/javascript-micro-templating/",[4253],[4304],{"type":407,"value":4305},"JavaScript Micro-Templating",{"type":402,"tag":4307,"props":4308,"children":4309},"style",{},[4310],{"type":407,"value":4311},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":396,"searchDepth":479,"depth":479,"links":4313},[4314,4315,4316],{"id":760,"depth":479,"text":760},{"id":1883,"depth":479,"text":1883},{"id":4290,"depth":479,"text":4290},"markdown","content:2.articles:1100.micro-templating.md","content","2.articles/1100.micro-templating.md","2.articles/1100.micro-templating","md",[4324,4326],{"_path":46,"title":45,"description":4325},"沉浸式翻译太贵辽，试试本地部署 LLM 用来翻译网页的可行性。",{"_path":52,"title":51,"description":4327},"我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。我碰到的问题是，如果 CSS 源码中带嵌套语法那么解析就会失败。今天借这个问题给大家简单介绍一下 CSS Parser 的基本流程。",1741604940709]