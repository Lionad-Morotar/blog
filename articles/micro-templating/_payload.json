[{"data":1,"prerenderedAt":4345},["ShallowReactive",2],{"navigation":3,"/articles/micro-templating":410,"/articles/micro-templating-surround":4340},[4,32,83,102,129,135,141,147,393,399,405],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🌃 长夜梦","/flows/long-night-dream",{"title":15,"_path":16},"🌌 万物联结与幸福感","/flows/everything",{"title":18,"_path":19},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":21,"_path":22},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":24,"_path":25},"🌧️ 我的腼腆","/flows/shy",{"title":27,"_path":28},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":30,"_path":31},"📝 心流归档","/flows/fold",{"title":33,"_path":34,"children":35},"技术博客 / Coder","/articles",[36,38,41,44,47,50,53,56,59,62,65,68,71,74,77,80],{"title":37,"_path":34},"🦁 为什么我要写博客",{"title":39,"_path":40},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":42,"_path":43},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":45,"_path":46},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":48,"_path":49},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":51,"_path":52},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":54,"_path":55},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":57,"_path":58},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":60,"_path":61},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":63,"_path":64},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":66,"_path":67},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":69,"_path":70},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":72,"_path":73},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":75,"_path":76},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":78,"_path":79},"🚝 四十二篇系列","/articles/fourty-two",{"title":81,"_path":82},"📝 技术博客归档","/articles/fold",{"title":84,"_path":85,"children":86},"造物 / Make","/tools",[87,90,93,96,99],{"title":88,"_path":89},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":91,"_path":92},"🌐 AnySort","/tools/anysort",{"title":94,"_path":95},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":97,"_path":98},"👓 Crapto","/tools/crypto-inline",{"title":100,"_path":101},"🖨️ any-to-base64","/tools/any-to-base64",{"title":103,"_path":104,"children":105},"吉他剧场 / Music","/music",[106,108,111,114,117,120,123,126],{"title":107,"_path":104},"🎸 FingerStyle！",{"title":109,"_path":110},"🌬️ 等待的风","/music/wind",{"title":112,"_path":113},"💕 约定的海洋","/music/ocean",{"title":115,"_path":116},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":118,"_path":119},"🌏 残酷天使的行动纲领","/music/eva",{"title":121,"_path":122},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":124,"_path":125},"🍷 Wu Wei","/music/wu-wei",{"title":127,"_path":128},"🌅 无题","/music/untitled",{"title":130,"_path":131,"children":132},"画点什么 / Paint","/paint",[133],{"title":134,"_path":131},"🚧 正在施工",{"title":136,"_path":137,"children":138},"读书笔记 / Notes","/books",[139],{"title":140,"_path":137},"📕 读书笔记",{"title":142,"_path":143,"children":144},"知识地图 / Maps","/maps",[145],{"title":146,"_path":143},"🏁 知识地图",{"title":148,"_path":149,"children":150},"零散的笔记 / Gists","/gists",[151,153,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375,378,381,384,387,390],{"title":152,"_path":149},"🧊 Gists",{"title":154,"_path":155},"网站的可访问性","/gists/accessibility",{"title":157,"_path":158},"Bit","/gists/bit",{"title":160,"_path":161},"图片模糊","/gists/blur",{"title":163,"_path":164},"渲染相关笔记","/gists/c4d",{"title":166,"_path":167},"CDN 问题记录","/gists/cdn",{"title":169,"_path":170},"消毒剂","/gists/cleaner",{"title":172,"_path":173},"Windows Command","/gists/cmd",{"title":175,"_path":176},"Command","/gists/command",{"title":178,"_path":179},"复杂科学","/gists/complexity-science",{"title":181,"_path":182},"GitHub Copilot","/gists/copilot",{"title":184,"_path":185},"宇宙","/gists/cosmos",{"title":187,"_path":188},"C++","/gists/cpp",{"title":190,"_path":191},"Data Structure","/gists/data-structure",{"title":193,"_path":194},"DEPRESSION","/gists/depression",{"title":196,"_path":197},"设计模式","/gists/design-patterns",{"title":199,"_path":200},"Developer Experience","/gists/developer-experience",{"title":202,"_path":203},"Device Metrics","/gists/device-metrix",{"title":205,"_path":206},"数字化转型","/gists/digital-transformation",{"title":208,"_path":209},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":211,"_path":212},"正则表达式","/gists/eegex",{"title":214,"_path":215},"Emoji","/gists/emoji",{"title":217,"_path":218},"工程","/gists/engineering",{"title":220,"_path":221},"熵","/gists/entropy",{"title":223,"_path":224},"Environment","/gists/environment",{"title":226,"_path":227},"Erlang","/gists/erlang",{"title":229,"_path":230},"逃离塔克夫","/gists/escape-from-tarkov",{"title":232,"_path":233},"ESNext (ES6-ES11)","/gists/esnext",{"title":235,"_path":236},"Eval！","/gists/eval",{"title":238,"_path":239},"Flutter","/gists/flutter",{"title":241,"_path":242},"字体","/gists/font",{"title":244,"_path":245},"JS 函数式编程","/gists/functional",{"title":247,"_path":248},"游戏化","/gists/gamification",{"title":250,"_path":251},"Google C++ Standard","/gists/google-cpp-standard",{"title":253,"_path":254},"双向链接完全体","/gists/graph",{"title":256,"_path":257},"Hardwares","/gists/hardwares",{"title":259,"_path":260},"哈希冲突","/gists/hash-collision",{"title":262,"_path":263},"信息设计","/gists/information-design",{"title":265,"_path":266},"InstantPage","/gists/instant.page",{"title":268,"_path":269},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":271,"_path":272},"KVStore","/gists/key-value-db",{"title":274,"_path":275},"Kubernetes","/gists/kubernetes",{"title":277,"_path":278},"Makefile","/gists/makefile",{"title":280,"_path":281},"Markdown Inline Style","/gists/markdown-nice",{"title":283,"_path":284},"小程序","/gists/miniapp",{"title":286,"_path":287},"减小页面快照体积","/gists/minify-html",{"title":289,"_path":290},"mklink","/gists/mklink",{"title":292,"_path":293},"Mock","/gists/mock",{"title":295,"_path":296},"多人协作系统","/gists/multiplayer",{"title":298,"_path":299},"多端应用","/gists/multy-end-app",{"title":301,"_path":302},"神经科学","/gists/neuroscience",{"title":304,"_path":305},"OO","/gists/oo",{"title":307,"_path":308},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":310,"_path":311},"PInvoke","/gists/pinvoke",{"title":313,"_path":314},"像素","/gists/pixel",{"title":316,"_path":317},"PowerShell","/gists/powershell",{"title":319,"_path":320},"量子","/gists/quantum",{"title":322,"_path":323},"保持好奇心","/gists/questions",{"title":325,"_path":326},"React Native","/gists/react-native",{"title":328,"_path":329},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":331,"_path":332},"SEO","/gists/seo",{"title":334,"_path":335},"Shader","/gists/shader",{"title":337,"_path":338},"Shape Up","/gists/shape-up",{"title":340,"_path":341},"睡觉","/gists/sleep",{"title":343,"_path":344},"记录奇怪的问题","/gists/solved",{"title":346,"_path":347},"States","/gists/states",{"title":349,"_path":350},"Storage","/gists/storage",{"title":352,"_path":353},"音视频流处理","/gists/stream-cli",{"title":355,"_path":356},"Symbol","/gists/symbol",{"title":358,"_path":359},"系统论","/gists/systems-theory",{"title":361,"_path":362},"Taro","/gists/taro",{"title":364,"_path":365},"任务切片","/gists/task-slice",{"title":367,"_path":368},"技术偏好","/gists/tech-dudge",{"title":370,"_path":371},"Untitled","/gists/untitled",{"title":373,"_path":374},"可变字体","/gists/variable-font",{"title":376,"_path":377},"视觉错觉","/gists/visual-illusion",{"title":379,"_path":380},"SS(SSR)","/gists/vpn",{"title":382,"_path":383},"VS Code 插件开发","/gists/vscode-plugin",{"title":385,"_path":386},"Web Components","/gists/web-components",{"title":388,"_path":389},"Windows","/gists/windows",{"title":391,"_path":392},"查缺补漏","/gists/wrong",{"title":394,"_path":395,"children":396},"代码笔记 / Gists","/source-code",[397],{"title":398,"_path":395},"🚄 代码笔记",{"title":400,"_path":401,"children":402},"我 / Abount","/hire",[403],{"title":404,"_path":401},"📬 技术简历",{"title":406,"_path":407,"children":408},"todo","/todo",[409],{"title":406,"_path":407},{"_path":43,"_dir":411,"_draft":412,"_partial":412,"_locale":413,"title":42,"description":414,"body":415,"_type":4334,"_id":4335,"_source":4336,"_file":4337,"_stem":4338,"_extension":4339},"articles",false,"","忍者秘籍中提到的模板解析器，很短但支持变量和 if 等语句，还是 15 年前的代码！",{"type":416,"children":417,"toc":4329},"root",[418,443,455,460,637,649,769,774,780,785,1893,1898,1903,1908,2019,2032,2493,2799,2810,2909,2922,3093,3098,3117,3156,3161,3228,3233,3286,3946,3993,3998,4072,4085,4090,4095,4256,4261,4282,4305,4310,4323],{"type":419,"tag":420,"props":421,"children":422},"element","p",{},[423,426,432,434,441],{"type":424,"value":425},"text","上回我借着解决 CSS 嵌套解析问题聊到 micro-app 中实现的一个非常精简的 ",{"type":419,"tag":427,"props":428,"children":429},"a",{"href":46},[430],{"type":424,"value":431},"CSS 解析器",{"type":424,"value":433},"，还没过瘾。今天整理笔记的时候发现了角落里的这个模板解析器，那就赶紧擦擦灰尘拉出来聊一聊。这个模板解析器可是有年头了，它是 John Resig 佬 2008 年写的，叫 ",{"type":419,"tag":435,"props":436,"children":438},"code",{"className":437},[],[439],{"type":424,"value":440},"micro-templating",{"type":424,"value":442},"，距今十五年哩。（John Resig 就是写《JavaScript 忍者秘籍》那位）",{"type":419,"tag":420,"props":444,"children":445},{},[446,448,453],{"type":424,"value":447},"令人惊叹的地方是，",{"type":419,"tag":435,"props":449,"children":451},{"className":450},[],[452],{"type":424,"value":440},{"type":424,"value":454}," 的代码和它的名字一样 micro，它能用仅仅 30 行代码完成对模板的处理，并且还有读取 html 模板、缓存、柯里化等额外的高级功能！",{"type":419,"tag":420,"props":456,"children":457},{},[458],{"type":424,"value":459},"可能有些佬没接触过模板解析器，这里给出一个简单的示例。",{"type":419,"tag":461,"props":462,"children":466},"pre",{"className":463,"code":464,"language":465,"meta":413,"style":413},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","parse(`\n  \u003C% if (shouldCount) { %>\n    \u003C% for (var i = 1; i \u003C= 3; i++) { %>\n      \u003Cdiv>hello - \u003C%= i + count %>\u003C/div>\n    \u003C% } %>\n  \u003C% } else { %>\n    \u003Cdiv>noop\u003C/div>\n  \u003C% } %>\n`, {\n  shouldCount: true,\n  count: 1\n})\n","js",[467],{"type":419,"tag":435,"props":468,"children":469},{"__ignoreMap":413},[470,494,504,513,522,531,540,549,558,578,604,623],{"type":419,"tag":471,"props":472,"children":475},"span",{"class":473,"line":474},"line",1,[476,482,488],{"type":419,"tag":471,"props":477,"children":479},{"style":478},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[480],{"type":424,"value":481},"parse",{"type":419,"tag":471,"props":483,"children":485},{"style":484},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[486],{"type":424,"value":487},"(",{"type":419,"tag":471,"props":489,"children":491},{"style":490},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[492],{"type":424,"value":493},"`\n",{"type":419,"tag":471,"props":495,"children":497},{"class":473,"line":496},2,[498],{"type":419,"tag":471,"props":499,"children":501},{"style":500},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[502],{"type":424,"value":503},"  \u003C% if (shouldCount) { %>\n",{"type":419,"tag":471,"props":505,"children":507},{"class":473,"line":506},3,[508],{"type":419,"tag":471,"props":509,"children":510},{"style":500},[511],{"type":424,"value":512},"    \u003C% for (var i = 1; i \u003C= 3; i++) { %>\n",{"type":419,"tag":471,"props":514,"children":516},{"class":473,"line":515},4,[517],{"type":419,"tag":471,"props":518,"children":519},{"style":500},[520],{"type":424,"value":521},"      \u003Cdiv>hello - \u003C%= i + count %>\u003C/div>\n",{"type":419,"tag":471,"props":523,"children":525},{"class":473,"line":524},5,[526],{"type":419,"tag":471,"props":527,"children":528},{"style":500},[529],{"type":424,"value":530},"    \u003C% } %>\n",{"type":419,"tag":471,"props":532,"children":534},{"class":473,"line":533},6,[535],{"type":419,"tag":471,"props":536,"children":537},{"style":500},[538],{"type":424,"value":539},"  \u003C% } else { %>\n",{"type":419,"tag":471,"props":541,"children":543},{"class":473,"line":542},7,[544],{"type":419,"tag":471,"props":545,"children":546},{"style":500},[547],{"type":424,"value":548},"    \u003Cdiv>noop\u003C/div>\n",{"type":419,"tag":471,"props":550,"children":552},{"class":473,"line":551},8,[553],{"type":419,"tag":471,"props":554,"children":555},{"style":500},[556],{"type":424,"value":557},"  \u003C% } %>\n",{"type":419,"tag":471,"props":559,"children":561},{"class":473,"line":560},9,[562,567,573],{"type":419,"tag":471,"props":563,"children":564},{"style":490},[565],{"type":424,"value":566},"`",{"type":419,"tag":471,"props":568,"children":570},{"style":569},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[571],{"type":424,"value":572},",",{"type":419,"tag":471,"props":574,"children":575},{"style":569},[576],{"type":424,"value":577}," {\n",{"type":419,"tag":471,"props":579,"children":581},{"class":473,"line":580},10,[582,588,593,599],{"type":419,"tag":471,"props":583,"children":585},{"style":584},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[586],{"type":424,"value":587},"  shouldCount",{"type":419,"tag":471,"props":589,"children":590},{"style":569},[591],{"type":424,"value":592},":",{"type":419,"tag":471,"props":594,"children":596},{"style":595},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[597],{"type":424,"value":598}," true",{"type":419,"tag":471,"props":600,"children":601},{"style":569},[602],{"type":424,"value":603},",\n",{"type":419,"tag":471,"props":605,"children":607},{"class":473,"line":606},11,[608,613,617],{"type":419,"tag":471,"props":609,"children":610},{"style":584},[611],{"type":424,"value":612},"  count",{"type":419,"tag":471,"props":614,"children":615},{"style":569},[616],{"type":424,"value":592},{"type":419,"tag":471,"props":618,"children":620},{"style":619},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[621],{"type":424,"value":622}," 1\n",{"type":419,"tag":471,"props":624,"children":626},{"class":473,"line":625},12,[627,632],{"type":419,"tag":471,"props":628,"children":629},{"style":569},[630],{"type":424,"value":631},"}",{"type":419,"tag":471,"props":633,"children":634},{"style":484},[635],{"type":424,"value":636},")\n",{"type":419,"tag":420,"props":638,"children":639},{},[640,642,647],{"type":424,"value":641},"给 ",{"type":419,"tag":435,"props":643,"children":645},{"className":644},[],[646],{"type":424,"value":481},{"type":424,"value":648}," 函数传入模板字符串和数据后，自然也是输出字符串啦：",{"type":419,"tag":461,"props":650,"children":654},{"className":651,"code":652,"language":653,"meta":413,"style":413},"language-html shiki shiki-themes material-theme-lighter github-light github-dark monokai","\u003C!-- 以下经过格式化 -->\n\u003Cdiv>hello - 2\u003C/div>\n\u003Cdiv>hello - 3\u003C/div>\n\u003Cdiv>hello - 4\u003C/div>\n","html",[655],{"type":419,"tag":435,"props":656,"children":657},{"__ignoreMap":413},[658,667,705,737],{"type":419,"tag":471,"props":659,"children":660},{"class":473,"line":474},[661],{"type":419,"tag":471,"props":662,"children":664},{"style":663},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[665],{"type":424,"value":666},"\u003C!-- 以下经过格式化 -->\n",{"type":419,"tag":471,"props":668,"children":669},{"class":473,"line":496},[670,675,681,686,691,696,700],{"type":419,"tag":471,"props":671,"children":672},{"style":569},[673],{"type":424,"value":674},"\u003C",{"type":419,"tag":471,"props":676,"children":678},{"style":677},"--shiki-light:#E53935;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[679],{"type":424,"value":680},"div",{"type":419,"tag":471,"props":682,"children":683},{"style":569},[684],{"type":424,"value":685},">",{"type":419,"tag":471,"props":687,"children":688},{"style":484},[689],{"type":424,"value":690},"hello - 2",{"type":419,"tag":471,"props":692,"children":693},{"style":569},[694],{"type":424,"value":695},"\u003C/",{"type":419,"tag":471,"props":697,"children":698},{"style":677},[699],{"type":424,"value":680},{"type":419,"tag":471,"props":701,"children":702},{"style":569},[703],{"type":424,"value":704},">\n",{"type":419,"tag":471,"props":706,"children":707},{"class":473,"line":506},[708,712,716,720,725,729,733],{"type":419,"tag":471,"props":709,"children":710},{"style":569},[711],{"type":424,"value":674},{"type":419,"tag":471,"props":713,"children":714},{"style":677},[715],{"type":424,"value":680},{"type":419,"tag":471,"props":717,"children":718},{"style":569},[719],{"type":424,"value":685},{"type":419,"tag":471,"props":721,"children":722},{"style":484},[723],{"type":424,"value":724},"hello - 3",{"type":419,"tag":471,"props":726,"children":727},{"style":569},[728],{"type":424,"value":695},{"type":419,"tag":471,"props":730,"children":731},{"style":677},[732],{"type":424,"value":680},{"type":419,"tag":471,"props":734,"children":735},{"style":569},[736],{"type":424,"value":704},{"type":419,"tag":471,"props":738,"children":739},{"class":473,"line":515},[740,744,748,752,757,761,765],{"type":419,"tag":471,"props":741,"children":742},{"style":569},[743],{"type":424,"value":674},{"type":419,"tag":471,"props":745,"children":746},{"style":677},[747],{"type":424,"value":680},{"type":419,"tag":471,"props":749,"children":750},{"style":569},[751],{"type":424,"value":685},{"type":419,"tag":471,"props":753,"children":754},{"style":484},[755],{"type":424,"value":756},"hello - 4",{"type":419,"tag":471,"props":758,"children":759},{"style":569},[760],{"type":424,"value":695},{"type":419,"tag":471,"props":762,"children":763},{"style":677},[764],{"type":424,"value":680},{"type":419,"tag":471,"props":766,"children":767},{"style":569},[768],{"type":424,"value":704},{"type":419,"tag":420,"props":770,"children":771},{},[772],{"type":424,"value":773},"相比生态里现在动则 30kb 甚至 300kb 的库，仅 30 行代码完成这个功能，简直不可思议。",{"type":419,"tag":775,"props":776,"children":778},"h2",{"id":777},"完整实现",[779],{"type":424,"value":777},{"type":419,"tag":420,"props":781,"children":782},{},[783],{"type":424,"value":784},"因为代码真的非常短，先直接看一遍，这是带注释版本的。如果你能在第一遍 review 这段代码后脑袋还保持清醒的话，留下评论，我拜你为大哥。",{"type":419,"tag":461,"props":786,"children":788},{"className":463,"code":787,"language":465,"meta":413,"style":413},"// Simple JavaScript Templating\n// John Resig - https://johnresig.com/ - MIT Licensed\n(function () {\n  var cache = {};\n\n  this.tmpl = function tmpl(str, data) {\n    // Figure out if we're getting a template, or if we need to\n    // load the template - and be sure to cache the result.\n    var fn = !/\\W/.test(str)\n      ? (cache[str] =\n          cache[str] || tmpl(document.getElementById(str).innerHTML))\n      : // Generate a reusable function that will serve as a template\n        // generator (and which will be cached).\n        new Function(\n          \"obj\",\n          \"var p=[],print=function(){p.push.apply(p,arguments);};\" +\n            // Introduce the data as local variables using with(){}\n            \"with(obj){p.push('\" +\n            // Convert the template into pure JavaScript\n            str\n              .replace(/[\\r\\t\\n]/g, \" \")\n              .split(\"\u003C%\")\n              .join(\"\\t\")\n              .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\n              .replace(/\\t=(.*?)%>/g, \"',$1,'\")\n              .split(\"\\t\")\n              .join(\"');\")\n              .split(\"%>\")\n              .join(\"p.push('\")\n              .split(\"\\r\")\n              .join(\"\\\\'\") +\n            \"');}return p.join('');\"\n        );\n\n    // Provide some basic currying to the user\n    return data ? fn(data) : fn;\n  };\n})();\n",[789],{"type":419,"tag":435,"props":790,"children":791},{"__ignoreMap":413},[792,800,808,830,854,863,924,932,940,998,1035,1108,1121,1130,1149,1172,1194,1203,1225,1234,1243,1307,1341,1376,1487,1566,1598,1631,1663,1696,1728,1771,1789,1803,1811,1820,1867,1876],{"type":419,"tag":471,"props":793,"children":794},{"class":473,"line":474},[795],{"type":419,"tag":471,"props":796,"children":797},{"style":663},[798],{"type":424,"value":799},"// Simple JavaScript Templating\n",{"type":419,"tag":471,"props":801,"children":802},{"class":473,"line":496},[803],{"type":419,"tag":471,"props":804,"children":805},{"style":663},[806],{"type":424,"value":807},"// John Resig - https://johnresig.com/ - MIT Licensed\n",{"type":419,"tag":471,"props":809,"children":810},{"class":473,"line":506},[811,815,821,826],{"type":419,"tag":471,"props":812,"children":813},{"style":484},[814],{"type":424,"value":487},{"type":419,"tag":471,"props":816,"children":818},{"style":817},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[819],{"type":424,"value":820},"function",{"type":419,"tag":471,"props":822,"children":823},{"style":569},[824],{"type":424,"value":825}," ()",{"type":419,"tag":471,"props":827,"children":828},{"style":569},[829],{"type":424,"value":577},{"type":419,"tag":471,"props":831,"children":832},{"class":473,"line":515},[833,838,843,849],{"type":419,"tag":471,"props":834,"children":835},{"style":817},[836],{"type":424,"value":837},"  var",{"type":419,"tag":471,"props":839,"children":840},{"style":484},[841],{"type":424,"value":842}," cache",{"type":419,"tag":471,"props":844,"children":846},{"style":845},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[847],{"type":424,"value":848}," =",{"type":419,"tag":471,"props":850,"children":851},{"style":569},[852],{"type":424,"value":853}," {};\n",{"type":419,"tag":471,"props":855,"children":856},{"class":473,"line":524},[857],{"type":419,"tag":471,"props":858,"children":860},{"emptyLinePlaceholder":859},true,[861],{"type":424,"value":862},"\n",{"type":419,"tag":471,"props":864,"children":865},{"class":473,"line":533},[866,872,877,882,886,891,896,900,906,910,915,920],{"type":419,"tag":471,"props":867,"children":869},{"style":868},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[870],{"type":424,"value":871},"  this",{"type":419,"tag":471,"props":873,"children":874},{"style":569},[875],{"type":424,"value":876},".",{"type":419,"tag":471,"props":878,"children":879},{"style":478},[880],{"type":424,"value":881},"tmpl",{"type":419,"tag":471,"props":883,"children":884},{"style":845},[885],{"type":424,"value":848},{"type":419,"tag":471,"props":887,"children":888},{"style":817},[889],{"type":424,"value":890}," function",{"type":419,"tag":471,"props":892,"children":893},{"style":478},[894],{"type":424,"value":895}," tmpl",{"type":419,"tag":471,"props":897,"children":898},{"style":569},[899],{"type":424,"value":487},{"type":419,"tag":471,"props":901,"children":903},{"style":902},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[904],{"type":424,"value":905},"str",{"type":419,"tag":471,"props":907,"children":908},{"style":569},[909],{"type":424,"value":572},{"type":419,"tag":471,"props":911,"children":912},{"style":902},[913],{"type":424,"value":914}," data",{"type":419,"tag":471,"props":916,"children":917},{"style":569},[918],{"type":424,"value":919},")",{"type":419,"tag":471,"props":921,"children":922},{"style":569},[923],{"type":424,"value":577},{"type":419,"tag":471,"props":925,"children":926},{"class":473,"line":542},[927],{"type":419,"tag":471,"props":928,"children":929},{"style":663},[930],{"type":424,"value":931},"    // Figure out if we're getting a template, or if we need to\n",{"type":419,"tag":471,"props":933,"children":934},{"class":473,"line":551},[935],{"type":419,"tag":471,"props":936,"children":937},{"style":663},[938],{"type":424,"value":939},"    // load the template - and be sure to cache the result.\n",{"type":419,"tag":471,"props":941,"children":942},{"class":473,"line":560},[943,948,953,957,962,967,973,977,981,986,990,994],{"type":419,"tag":471,"props":944,"children":945},{"style":817},[946],{"type":424,"value":947},"    var",{"type":419,"tag":471,"props":949,"children":950},{"style":484},[951],{"type":424,"value":952}," fn",{"type":419,"tag":471,"props":954,"children":955},{"style":845},[956],{"type":424,"value":848},{"type":419,"tag":471,"props":958,"children":959},{"style":845},[960],{"type":424,"value":961}," !",{"type":419,"tag":471,"props":963,"children":964},{"style":490},[965],{"type":424,"value":966},"/",{"type":419,"tag":471,"props":968,"children":970},{"style":969},"--shiki-light:#91B859;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[971],{"type":424,"value":972},"\\W",{"type":419,"tag":471,"props":974,"children":975},{"style":490},[976],{"type":424,"value":966},{"type":419,"tag":471,"props":978,"children":979},{"style":569},[980],{"type":424,"value":876},{"type":419,"tag":471,"props":982,"children":983},{"style":478},[984],{"type":424,"value":985},"test",{"type":419,"tag":471,"props":987,"children":988},{"style":584},[989],{"type":424,"value":487},{"type":419,"tag":471,"props":991,"children":992},{"style":484},[993],{"type":424,"value":905},{"type":419,"tag":471,"props":995,"children":996},{"style":584},[997],{"type":424,"value":636},{"type":419,"tag":471,"props":999,"children":1000},{"class":473,"line":580},[1001,1006,1011,1016,1021,1025,1030],{"type":419,"tag":471,"props":1002,"children":1003},{"style":845},[1004],{"type":424,"value":1005},"      ?",{"type":419,"tag":471,"props":1007,"children":1008},{"style":584},[1009],{"type":424,"value":1010}," (",{"type":419,"tag":471,"props":1012,"children":1013},{"style":484},[1014],{"type":424,"value":1015},"cache",{"type":419,"tag":471,"props":1017,"children":1018},{"style":584},[1019],{"type":424,"value":1020},"[",{"type":419,"tag":471,"props":1022,"children":1023},{"style":484},[1024],{"type":424,"value":905},{"type":419,"tag":471,"props":1026,"children":1027},{"style":584},[1028],{"type":424,"value":1029},"] ",{"type":419,"tag":471,"props":1031,"children":1032},{"style":845},[1033],{"type":424,"value":1034},"=\n",{"type":419,"tag":471,"props":1036,"children":1037},{"class":473,"line":606},[1038,1043,1047,1051,1055,1060,1064,1068,1073,1077,1082,1086,1090,1094,1098,1103],{"type":419,"tag":471,"props":1039,"children":1040},{"style":484},[1041],{"type":424,"value":1042},"          cache",{"type":419,"tag":471,"props":1044,"children":1045},{"style":584},[1046],{"type":424,"value":1020},{"type":419,"tag":471,"props":1048,"children":1049},{"style":484},[1050],{"type":424,"value":905},{"type":419,"tag":471,"props":1052,"children":1053},{"style":584},[1054],{"type":424,"value":1029},{"type":419,"tag":471,"props":1056,"children":1057},{"style":845},[1058],{"type":424,"value":1059},"||",{"type":419,"tag":471,"props":1061,"children":1062},{"style":478},[1063],{"type":424,"value":895},{"type":419,"tag":471,"props":1065,"children":1066},{"style":584},[1067],{"type":424,"value":487},{"type":419,"tag":471,"props":1069,"children":1070},{"style":484},[1071],{"type":424,"value":1072},"document",{"type":419,"tag":471,"props":1074,"children":1075},{"style":569},[1076],{"type":424,"value":876},{"type":419,"tag":471,"props":1078,"children":1079},{"style":478},[1080],{"type":424,"value":1081},"getElementById",{"type":419,"tag":471,"props":1083,"children":1084},{"style":584},[1085],{"type":424,"value":487},{"type":419,"tag":471,"props":1087,"children":1088},{"style":484},[1089],{"type":424,"value":905},{"type":419,"tag":471,"props":1091,"children":1092},{"style":584},[1093],{"type":424,"value":919},{"type":419,"tag":471,"props":1095,"children":1096},{"style":569},[1097],{"type":424,"value":876},{"type":419,"tag":471,"props":1099,"children":1100},{"style":484},[1101],{"type":424,"value":1102},"innerHTML",{"type":419,"tag":471,"props":1104,"children":1105},{"style":584},[1106],{"type":424,"value":1107},"))\n",{"type":419,"tag":471,"props":1109,"children":1110},{"class":473,"line":625},[1111,1116],{"type":419,"tag":471,"props":1112,"children":1113},{"style":845},[1114],{"type":424,"value":1115},"      :",{"type":419,"tag":471,"props":1117,"children":1118},{"style":663},[1119],{"type":424,"value":1120}," // Generate a reusable function that will serve as a template\n",{"type":419,"tag":471,"props":1122,"children":1124},{"class":473,"line":1123},13,[1125],{"type":419,"tag":471,"props":1126,"children":1127},{"style":663},[1128],{"type":424,"value":1129},"        // generator (and which will be cached).\n",{"type":419,"tag":471,"props":1131,"children":1133},{"class":473,"line":1132},14,[1134,1139,1144],{"type":419,"tag":471,"props":1135,"children":1136},{"style":845},[1137],{"type":424,"value":1138},"        new",{"type":419,"tag":471,"props":1140,"children":1141},{"style":478},[1142],{"type":424,"value":1143}," Function",{"type":419,"tag":471,"props":1145,"children":1146},{"style":584},[1147],{"type":424,"value":1148},"(\n",{"type":419,"tag":471,"props":1150,"children":1152},{"class":473,"line":1151},15,[1153,1158,1163,1168],{"type":419,"tag":471,"props":1154,"children":1155},{"style":490},[1156],{"type":424,"value":1157},"          \"",{"type":419,"tag":471,"props":1159,"children":1160},{"style":500},[1161],{"type":424,"value":1162},"obj",{"type":419,"tag":471,"props":1164,"children":1165},{"style":490},[1166],{"type":424,"value":1167},"\"",{"type":419,"tag":471,"props":1169,"children":1170},{"style":569},[1171],{"type":424,"value":603},{"type":419,"tag":471,"props":1173,"children":1175},{"class":473,"line":1174},16,[1176,1180,1185,1189],{"type":419,"tag":471,"props":1177,"children":1178},{"style":490},[1179],{"type":424,"value":1157},{"type":419,"tag":471,"props":1181,"children":1182},{"style":500},[1183],{"type":424,"value":1184},"var p=[],print=function(){p.push.apply(p,arguments);};",{"type":419,"tag":471,"props":1186,"children":1187},{"style":490},[1188],{"type":424,"value":1167},{"type":419,"tag":471,"props":1190,"children":1191},{"style":845},[1192],{"type":424,"value":1193}," +\n",{"type":419,"tag":471,"props":1195,"children":1197},{"class":473,"line":1196},17,[1198],{"type":419,"tag":471,"props":1199,"children":1200},{"style":663},[1201],{"type":424,"value":1202},"            // Introduce the data as local variables using with(){}\n",{"type":419,"tag":471,"props":1204,"children":1206},{"class":473,"line":1205},18,[1207,1212,1217,1221],{"type":419,"tag":471,"props":1208,"children":1209},{"style":490},[1210],{"type":424,"value":1211},"            \"",{"type":419,"tag":471,"props":1213,"children":1214},{"style":500},[1215],{"type":424,"value":1216},"with(obj){p.push('",{"type":419,"tag":471,"props":1218,"children":1219},{"style":490},[1220],{"type":424,"value":1167},{"type":419,"tag":471,"props":1222,"children":1223},{"style":845},[1224],{"type":424,"value":1193},{"type":419,"tag":471,"props":1226,"children":1228},{"class":473,"line":1227},19,[1229],{"type":419,"tag":471,"props":1230,"children":1231},{"style":663},[1232],{"type":424,"value":1233},"            // Convert the template into pure JavaScript\n",{"type":419,"tag":471,"props":1235,"children":1237},{"class":473,"line":1236},20,[1238],{"type":419,"tag":471,"props":1239,"children":1240},{"style":484},[1241],{"type":424,"value":1242},"            str\n",{"type":419,"tag":471,"props":1244,"children":1246},{"class":473,"line":1245},21,[1247,1252,1257,1261,1265,1270,1275,1280,1284,1290,1294,1299,1303],{"type":419,"tag":471,"props":1248,"children":1249},{"style":569},[1250],{"type":424,"value":1251},"              .",{"type":419,"tag":471,"props":1253,"children":1254},{"style":478},[1255],{"type":424,"value":1256},"replace",{"type":419,"tag":471,"props":1258,"children":1259},{"style":584},[1260],{"type":424,"value":487},{"type":419,"tag":471,"props":1262,"children":1263},{"style":490},[1264],{"type":424,"value":966},{"type":419,"tag":471,"props":1266,"children":1268},{"style":1267},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1269],{"type":424,"value":1020},{"type":419,"tag":471,"props":1271,"children":1272},{"style":969},[1273],{"type":424,"value":1274},"\\r\\t\\n",{"type":419,"tag":471,"props":1276,"children":1277},{"style":1267},[1278],{"type":424,"value":1279},"]",{"type":419,"tag":471,"props":1281,"children":1282},{"style":490},[1283],{"type":424,"value":966},{"type":419,"tag":471,"props":1285,"children":1287},{"style":1286},"--shiki-light:#F76D47;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[1288],{"type":424,"value":1289},"g",{"type":419,"tag":471,"props":1291,"children":1292},{"style":569},[1293],{"type":424,"value":572},{"type":419,"tag":471,"props":1295,"children":1296},{"style":490},[1297],{"type":424,"value":1298}," \"",{"type":419,"tag":471,"props":1300,"children":1301},{"style":490},[1302],{"type":424,"value":1298},{"type":419,"tag":471,"props":1304,"children":1305},{"style":584},[1306],{"type":424,"value":636},{"type":419,"tag":471,"props":1308,"children":1310},{"class":473,"line":1309},22,[1311,1315,1320,1324,1328,1333,1337],{"type":419,"tag":471,"props":1312,"children":1313},{"style":569},[1314],{"type":424,"value":1251},{"type":419,"tag":471,"props":1316,"children":1317},{"style":478},[1318],{"type":424,"value":1319},"split",{"type":419,"tag":471,"props":1321,"children":1322},{"style":584},[1323],{"type":424,"value":487},{"type":419,"tag":471,"props":1325,"children":1326},{"style":490},[1327],{"type":424,"value":1167},{"type":419,"tag":471,"props":1329,"children":1330},{"style":500},[1331],{"type":424,"value":1332},"\u003C%",{"type":419,"tag":471,"props":1334,"children":1335},{"style":490},[1336],{"type":424,"value":1167},{"type":419,"tag":471,"props":1338,"children":1339},{"style":584},[1340],{"type":424,"value":636},{"type":419,"tag":471,"props":1342,"children":1344},{"class":473,"line":1343},23,[1345,1349,1354,1358,1362,1368,1372],{"type":419,"tag":471,"props":1346,"children":1347},{"style":569},[1348],{"type":424,"value":1251},{"type":419,"tag":471,"props":1350,"children":1351},{"style":478},[1352],{"type":424,"value":1353},"join",{"type":419,"tag":471,"props":1355,"children":1356},{"style":584},[1357],{"type":424,"value":487},{"type":419,"tag":471,"props":1359,"children":1360},{"style":490},[1361],{"type":424,"value":1167},{"type":419,"tag":471,"props":1363,"children":1365},{"style":1364},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1366],{"type":424,"value":1367},"\\t",{"type":419,"tag":471,"props":1369,"children":1370},{"style":490},[1371],{"type":424,"value":1167},{"type":419,"tag":471,"props":1373,"children":1374},{"style":584},[1375],{"type":424,"value":636},{"type":419,"tag":471,"props":1377,"children":1379},{"class":473,"line":1378},24,[1380,1384,1388,1392,1396,1402,1408,1413,1419,1423,1427,1431,1435,1439,1444,1448,1453,1457,1461,1465,1469,1474,1479,1483],{"type":419,"tag":471,"props":1381,"children":1382},{"style":569},[1383],{"type":424,"value":1251},{"type":419,"tag":471,"props":1385,"children":1386},{"style":478},[1387],{"type":424,"value":1256},{"type":419,"tag":471,"props":1389,"children":1390},{"style":584},[1391],{"type":424,"value":487},{"type":419,"tag":471,"props":1393,"children":1394},{"style":490},[1395],{"type":424,"value":966},{"type":419,"tag":471,"props":1397,"children":1399},{"style":1398},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[1400],{"type":424,"value":1401},"((",{"type":419,"tag":471,"props":1403,"children":1405},{"style":1404},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[1406],{"type":424,"value":1407},"^",{"type":419,"tag":471,"props":1409,"children":1410},{"style":845},[1411],{"type":424,"value":1412},"|",{"type":419,"tag":471,"props":1414,"children":1416},{"style":1415},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#DBEDFF;--shiki-sepia:#E6DB74",[1417],{"type":424,"value":1418},"%>",{"type":419,"tag":471,"props":1420,"children":1421},{"style":1398},[1422],{"type":424,"value":919},{"type":419,"tag":471,"props":1424,"children":1425},{"style":1267},[1426],{"type":424,"value":1020},{"type":419,"tag":471,"props":1428,"children":1429},{"style":845},[1430],{"type":424,"value":1407},{"type":419,"tag":471,"props":1432,"children":1433},{"style":969},[1434],{"type":424,"value":1367},{"type":419,"tag":471,"props":1436,"children":1437},{"style":1267},[1438],{"type":424,"value":1279},{"type":419,"tag":471,"props":1440,"children":1441},{"style":845},[1442],{"type":424,"value":1443},"*",{"type":419,"tag":471,"props":1445,"children":1446},{"style":1398},[1447],{"type":424,"value":919},{"type":419,"tag":471,"props":1449,"children":1450},{"style":1415},[1451],{"type":424,"value":1452},"'",{"type":419,"tag":471,"props":1454,"children":1455},{"style":490},[1456],{"type":424,"value":966},{"type":419,"tag":471,"props":1458,"children":1459},{"style":1286},[1460],{"type":424,"value":1289},{"type":419,"tag":471,"props":1462,"children":1463},{"style":569},[1464],{"type":424,"value":572},{"type":419,"tag":471,"props":1466,"children":1467},{"style":490},[1468],{"type":424,"value":1298},{"type":419,"tag":471,"props":1470,"children":1471},{"style":500},[1472],{"type":424,"value":1473},"$1",{"type":419,"tag":471,"props":1475,"children":1476},{"style":1364},[1477],{"type":424,"value":1478},"\\r",{"type":419,"tag":471,"props":1480,"children":1481},{"style":490},[1482],{"type":424,"value":1167},{"type":419,"tag":471,"props":1484,"children":1485},{"style":584},[1486],{"type":424,"value":636},{"type":419,"tag":471,"props":1488,"children":1490},{"class":473,"line":1489},25,[1491,1495,1499,1503,1507,1511,1516,1520,1524,1529,1533,1537,1541,1545,1549,1553,1558,1562],{"type":419,"tag":471,"props":1492,"children":1493},{"style":569},[1494],{"type":424,"value":1251},{"type":419,"tag":471,"props":1496,"children":1497},{"style":478},[1498],{"type":424,"value":1256},{"type":419,"tag":471,"props":1500,"children":1501},{"style":584},[1502],{"type":424,"value":487},{"type":419,"tag":471,"props":1504,"children":1505},{"style":490},[1506],{"type":424,"value":966},{"type":419,"tag":471,"props":1508,"children":1509},{"style":969},[1510],{"type":424,"value":1367},{"type":419,"tag":471,"props":1512,"children":1513},{"style":1415},[1514],{"type":424,"value":1515},"=",{"type":419,"tag":471,"props":1517,"children":1518},{"style":1398},[1519],{"type":424,"value":487},{"type":419,"tag":471,"props":1521,"children":1522},{"style":969},[1523],{"type":424,"value":876},{"type":419,"tag":471,"props":1525,"children":1526},{"style":845},[1527],{"type":424,"value":1528},"*?",{"type":419,"tag":471,"props":1530,"children":1531},{"style":1398},[1532],{"type":424,"value":919},{"type":419,"tag":471,"props":1534,"children":1535},{"style":1415},[1536],{"type":424,"value":1418},{"type":419,"tag":471,"props":1538,"children":1539},{"style":490},[1540],{"type":424,"value":966},{"type":419,"tag":471,"props":1542,"children":1543},{"style":1286},[1544],{"type":424,"value":1289},{"type":419,"tag":471,"props":1546,"children":1547},{"style":569},[1548],{"type":424,"value":572},{"type":419,"tag":471,"props":1550,"children":1551},{"style":490},[1552],{"type":424,"value":1298},{"type":419,"tag":471,"props":1554,"children":1555},{"style":500},[1556],{"type":424,"value":1557},"',$1,'",{"type":419,"tag":471,"props":1559,"children":1560},{"style":490},[1561],{"type":424,"value":1167},{"type":419,"tag":471,"props":1563,"children":1564},{"style":584},[1565],{"type":424,"value":636},{"type":419,"tag":471,"props":1567,"children":1569},{"class":473,"line":1568},26,[1570,1574,1578,1582,1586,1590,1594],{"type":419,"tag":471,"props":1571,"children":1572},{"style":569},[1573],{"type":424,"value":1251},{"type":419,"tag":471,"props":1575,"children":1576},{"style":478},[1577],{"type":424,"value":1319},{"type":419,"tag":471,"props":1579,"children":1580},{"style":584},[1581],{"type":424,"value":487},{"type":419,"tag":471,"props":1583,"children":1584},{"style":490},[1585],{"type":424,"value":1167},{"type":419,"tag":471,"props":1587,"children":1588},{"style":1364},[1589],{"type":424,"value":1367},{"type":419,"tag":471,"props":1591,"children":1592},{"style":490},[1593],{"type":424,"value":1167},{"type":419,"tag":471,"props":1595,"children":1596},{"style":584},[1597],{"type":424,"value":636},{"type":419,"tag":471,"props":1599,"children":1601},{"class":473,"line":1600},27,[1602,1606,1610,1614,1618,1623,1627],{"type":419,"tag":471,"props":1603,"children":1604},{"style":569},[1605],{"type":424,"value":1251},{"type":419,"tag":471,"props":1607,"children":1608},{"style":478},[1609],{"type":424,"value":1353},{"type":419,"tag":471,"props":1611,"children":1612},{"style":584},[1613],{"type":424,"value":487},{"type":419,"tag":471,"props":1615,"children":1616},{"style":490},[1617],{"type":424,"value":1167},{"type":419,"tag":471,"props":1619,"children":1620},{"style":500},[1621],{"type":424,"value":1622},"');",{"type":419,"tag":471,"props":1624,"children":1625},{"style":490},[1626],{"type":424,"value":1167},{"type":419,"tag":471,"props":1628,"children":1629},{"style":584},[1630],{"type":424,"value":636},{"type":419,"tag":471,"props":1632,"children":1634},{"class":473,"line":1633},28,[1635,1639,1643,1647,1651,1655,1659],{"type":419,"tag":471,"props":1636,"children":1637},{"style":569},[1638],{"type":424,"value":1251},{"type":419,"tag":471,"props":1640,"children":1641},{"style":478},[1642],{"type":424,"value":1319},{"type":419,"tag":471,"props":1644,"children":1645},{"style":584},[1646],{"type":424,"value":487},{"type":419,"tag":471,"props":1648,"children":1649},{"style":490},[1650],{"type":424,"value":1167},{"type":419,"tag":471,"props":1652,"children":1653},{"style":500},[1654],{"type":424,"value":1418},{"type":419,"tag":471,"props":1656,"children":1657},{"style":490},[1658],{"type":424,"value":1167},{"type":419,"tag":471,"props":1660,"children":1661},{"style":584},[1662],{"type":424,"value":636},{"type":419,"tag":471,"props":1664,"children":1666},{"class":473,"line":1665},29,[1667,1671,1675,1679,1683,1688,1692],{"type":419,"tag":471,"props":1668,"children":1669},{"style":569},[1670],{"type":424,"value":1251},{"type":419,"tag":471,"props":1672,"children":1673},{"style":478},[1674],{"type":424,"value":1353},{"type":419,"tag":471,"props":1676,"children":1677},{"style":584},[1678],{"type":424,"value":487},{"type":419,"tag":471,"props":1680,"children":1681},{"style":490},[1682],{"type":424,"value":1167},{"type":419,"tag":471,"props":1684,"children":1685},{"style":500},[1686],{"type":424,"value":1687},"p.push('",{"type":419,"tag":471,"props":1689,"children":1690},{"style":490},[1691],{"type":424,"value":1167},{"type":419,"tag":471,"props":1693,"children":1694},{"style":584},[1695],{"type":424,"value":636},{"type":419,"tag":471,"props":1697,"children":1699},{"class":473,"line":1698},30,[1700,1704,1708,1712,1716,1720,1724],{"type":419,"tag":471,"props":1701,"children":1702},{"style":569},[1703],{"type":424,"value":1251},{"type":419,"tag":471,"props":1705,"children":1706},{"style":478},[1707],{"type":424,"value":1319},{"type":419,"tag":471,"props":1709,"children":1710},{"style":584},[1711],{"type":424,"value":487},{"type":419,"tag":471,"props":1713,"children":1714},{"style":490},[1715],{"type":424,"value":1167},{"type":419,"tag":471,"props":1717,"children":1718},{"style":1364},[1719],{"type":424,"value":1478},{"type":419,"tag":471,"props":1721,"children":1722},{"style":490},[1723],{"type":424,"value":1167},{"type":419,"tag":471,"props":1725,"children":1726},{"style":584},[1727],{"type":424,"value":636},{"type":419,"tag":471,"props":1729,"children":1731},{"class":473,"line":1730},31,[1732,1736,1740,1744,1748,1753,1757,1761,1766],{"type":419,"tag":471,"props":1733,"children":1734},{"style":569},[1735],{"type":424,"value":1251},{"type":419,"tag":471,"props":1737,"children":1738},{"style":478},[1739],{"type":424,"value":1353},{"type":419,"tag":471,"props":1741,"children":1742},{"style":584},[1743],{"type":424,"value":487},{"type":419,"tag":471,"props":1745,"children":1746},{"style":490},[1747],{"type":424,"value":1167},{"type":419,"tag":471,"props":1749,"children":1750},{"style":1364},[1751],{"type":424,"value":1752},"\\\\",{"type":419,"tag":471,"props":1754,"children":1755},{"style":500},[1756],{"type":424,"value":1452},{"type":419,"tag":471,"props":1758,"children":1759},{"style":490},[1760],{"type":424,"value":1167},{"type":419,"tag":471,"props":1762,"children":1763},{"style":584},[1764],{"type":424,"value":1765},") ",{"type":419,"tag":471,"props":1767,"children":1768},{"style":845},[1769],{"type":424,"value":1770},"+\n",{"type":419,"tag":471,"props":1772,"children":1774},{"class":473,"line":1773},32,[1775,1779,1784],{"type":419,"tag":471,"props":1776,"children":1777},{"style":490},[1778],{"type":424,"value":1211},{"type":419,"tag":471,"props":1780,"children":1781},{"style":500},[1782],{"type":424,"value":1783},"');}return p.join('');",{"type":419,"tag":471,"props":1785,"children":1786},{"style":490},[1787],{"type":424,"value":1788},"\"\n",{"type":419,"tag":471,"props":1790,"children":1792},{"class":473,"line":1791},33,[1793,1798],{"type":419,"tag":471,"props":1794,"children":1795},{"style":584},[1796],{"type":424,"value":1797},"        )",{"type":419,"tag":471,"props":1799,"children":1800},{"style":569},[1801],{"type":424,"value":1802},";\n",{"type":419,"tag":471,"props":1804,"children":1806},{"class":473,"line":1805},34,[1807],{"type":419,"tag":471,"props":1808,"children":1809},{"emptyLinePlaceholder":859},[1810],{"type":424,"value":862},{"type":419,"tag":471,"props":1812,"children":1814},{"class":473,"line":1813},35,[1815],{"type":419,"tag":471,"props":1816,"children":1817},{"style":663},[1818],{"type":424,"value":1819},"    // Provide some basic currying to the user\n",{"type":419,"tag":471,"props":1821,"children":1823},{"class":473,"line":1822},36,[1824,1829,1833,1838,1842,1846,1851,1855,1859,1863],{"type":419,"tag":471,"props":1825,"children":1826},{"style":1404},[1827],{"type":424,"value":1828},"    return",{"type":419,"tag":471,"props":1830,"children":1831},{"style":484},[1832],{"type":424,"value":914},{"type":419,"tag":471,"props":1834,"children":1835},{"style":845},[1836],{"type":424,"value":1837}," ?",{"type":419,"tag":471,"props":1839,"children":1840},{"style":478},[1841],{"type":424,"value":952},{"type":419,"tag":471,"props":1843,"children":1844},{"style":584},[1845],{"type":424,"value":487},{"type":419,"tag":471,"props":1847,"children":1848},{"style":484},[1849],{"type":424,"value":1850},"data",{"type":419,"tag":471,"props":1852,"children":1853},{"style":584},[1854],{"type":424,"value":1765},{"type":419,"tag":471,"props":1856,"children":1857},{"style":845},[1858],{"type":424,"value":592},{"type":419,"tag":471,"props":1860,"children":1861},{"style":484},[1862],{"type":424,"value":952},{"type":419,"tag":471,"props":1864,"children":1865},{"style":569},[1866],{"type":424,"value":1802},{"type":419,"tag":471,"props":1868,"children":1870},{"class":473,"line":1869},37,[1871],{"type":419,"tag":471,"props":1872,"children":1873},{"style":569},[1874],{"type":424,"value":1875},"  };\n",{"type":419,"tag":471,"props":1877,"children":1879},{"class":473,"line":1878},38,[1880,1884,1889],{"type":419,"tag":471,"props":1881,"children":1882},{"style":569},[1883],{"type":424,"value":631},{"type":419,"tag":471,"props":1885,"children":1886},{"style":484},[1887],{"type":424,"value":1888},")()",{"type":419,"tag":471,"props":1890,"children":1891},{"style":569},[1892],{"type":424,"value":1802},{"type":419,"tag":420,"props":1894,"children":1895},{},[1896],{"type":424,"value":1897},"代码看完了，我知道你没看懂，因为曾经我也是。好了，留下三连，解析开始。",{"type":419,"tag":775,"props":1899,"children":1901},{"id":1900},"解析",[1902],{"type":424,"value":1900},{"type":419,"tag":420,"props":1904,"children":1905},{},[1906],{"type":424,"value":1907},"首先，代码最外层是一个 IIFE，给 this 对象挂载了 tmpl 函数，直接执行的话就是 window。内部通过局部变量保存了模板解析的缓存：",{"type":419,"tag":461,"props":1909,"children":1911},{"className":463,"code":1910,"language":465,"meta":413,"style":413},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {};\n})();\n",[1912],{"type":419,"tag":435,"props":1913,"children":1914},{"__ignoreMap":413},[1915,1934,1953,2004],{"type":419,"tag":471,"props":1916,"children":1917},{"class":473,"line":474},[1918,1922,1926,1930],{"type":419,"tag":471,"props":1919,"children":1920},{"style":484},[1921],{"type":424,"value":487},{"type":419,"tag":471,"props":1923,"children":1924},{"style":817},[1925],{"type":424,"value":820},{"type":419,"tag":471,"props":1927,"children":1928},{"style":569},[1929],{"type":424,"value":825},{"type":419,"tag":471,"props":1931,"children":1932},{"style":569},[1933],{"type":424,"value":577},{"type":419,"tag":471,"props":1935,"children":1936},{"class":473,"line":496},[1937,1941,1945,1949],{"type":419,"tag":471,"props":1938,"children":1939},{"style":817},[1940],{"type":424,"value":837},{"type":419,"tag":471,"props":1942,"children":1943},{"style":484},[1944],{"type":424,"value":842},{"type":419,"tag":471,"props":1946,"children":1947},{"style":845},[1948],{"type":424,"value":848},{"type":419,"tag":471,"props":1950,"children":1951},{"style":569},[1952],{"type":424,"value":853},{"type":419,"tag":471,"props":1954,"children":1955},{"class":473,"line":506},[1956,1960,1964,1968,1972,1976,1980,1984,1988,1992,1996,2000],{"type":419,"tag":471,"props":1957,"children":1958},{"style":868},[1959],{"type":424,"value":871},{"type":419,"tag":471,"props":1961,"children":1962},{"style":569},[1963],{"type":424,"value":876},{"type":419,"tag":471,"props":1965,"children":1966},{"style":478},[1967],{"type":424,"value":881},{"type":419,"tag":471,"props":1969,"children":1970},{"style":845},[1971],{"type":424,"value":848},{"type":419,"tag":471,"props":1973,"children":1974},{"style":817},[1975],{"type":424,"value":890},{"type":419,"tag":471,"props":1977,"children":1978},{"style":478},[1979],{"type":424,"value":895},{"type":419,"tag":471,"props":1981,"children":1982},{"style":569},[1983],{"type":424,"value":487},{"type":419,"tag":471,"props":1985,"children":1986},{"style":902},[1987],{"type":424,"value":905},{"type":419,"tag":471,"props":1989,"children":1990},{"style":569},[1991],{"type":424,"value":572},{"type":419,"tag":471,"props":1993,"children":1994},{"style":902},[1995],{"type":424,"value":914},{"type":419,"tag":471,"props":1997,"children":1998},{"style":569},[1999],{"type":424,"value":919},{"type":419,"tag":471,"props":2001,"children":2002},{"style":569},[2003],{"type":424,"value":853},{"type":419,"tag":471,"props":2005,"children":2006},{"class":473,"line":515},[2007,2011,2015],{"type":419,"tag":471,"props":2008,"children":2009},{"style":569},[2010],{"type":424,"value":631},{"type":419,"tag":471,"props":2012,"children":2013},{"style":484},[2014],{"type":424,"value":1888},{"type":419,"tag":471,"props":2016,"children":2017},{"style":569},[2018],{"type":424,"value":1802},{"type":419,"tag":420,"props":2020,"children":2021},{},[2022,2024,2030],{"type":424,"value":2023},"str 参数有两种两种用途，",{"type":419,"tag":435,"props":2025,"children":2027},{"className":2026},[],[2028],{"type":424,"value":2029},"/\\W/.test(str)",{"type":424,"value":2031}," 用来判断字符串中包不包含模板分隔符，如果不含分隔符，即普通字符串，那就当作 ID，从页面对应 ID 的节点中获取内容作为模板。比如，如果 str 为 'user_tmpl'，那么模板函数将会读取页面的以下脚本的内容作为输入：",{"type":419,"tag":461,"props":2033,"children":2035},{"className":651,"code":2034,"language":653,"meta":413,"style":413},"\u003C!-- type=\"text/html\"，所以浏览器并不会执行这串脚本。它只能由 tmpl 来读取... -->\n\u003Cscript type=\"text/html\" id=\"item_tmpl\">\n  \u003Cdiv id=\"\u003C%=id%>\" class=\"\u003C%=(i % 2 == 1 ? \" even\" : \"\")%>\">\n    \u003Cdiv class=\"grid_1 alpha right\">\n      \u003Cimg class=\"righted\" src=\"\u003C%=profile_image_url%>\"/>\n    \u003C/div>\n    \u003Cdiv class=\"grid_6 omega contents\">\n      \u003Cp>\u003Cb>\u003Ca href=\"/\u003C%=from_user%>\">\u003C%=from_user%>\u003C/a>:\u003C/b> \u003C%=text%>\u003C/p>\n    \u003C/div>\n  \u003C/div>\n\u003C/script>\n",[2036],{"type":419,"tag":435,"props":2037,"children":2038},{"__ignoreMap":413},[2039,2047,2108,2192,2229,2290,2306,2342,2447,2462,2478],{"type":419,"tag":471,"props":2040,"children":2041},{"class":473,"line":474},[2042],{"type":419,"tag":471,"props":2043,"children":2044},{"style":663},[2045],{"type":424,"value":2046},"\u003C!-- type=\"text/html\"，所以浏览器并不会执行这串脚本。它只能由 tmpl 来读取... -->\n",{"type":419,"tag":471,"props":2048,"children":2049},{"class":473,"line":496},[2050,2054,2059,2065,2069,2073,2078,2082,2087,2091,2095,2100,2104],{"type":419,"tag":471,"props":2051,"children":2052},{"style":569},[2053],{"type":424,"value":674},{"type":419,"tag":471,"props":2055,"children":2056},{"style":677},[2057],{"type":424,"value":2058},"script",{"type":419,"tag":471,"props":2060,"children":2062},{"style":2061},"--shiki-light:#9C3EDA;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[2063],{"type":424,"value":2064}," type",{"type":419,"tag":471,"props":2066,"children":2067},{"style":569},[2068],{"type":424,"value":1515},{"type":419,"tag":471,"props":2070,"children":2071},{"style":490},[2072],{"type":424,"value":1167},{"type":419,"tag":471,"props":2074,"children":2075},{"style":500},[2076],{"type":424,"value":2077},"text/html",{"type":419,"tag":471,"props":2079,"children":2080},{"style":490},[2081],{"type":424,"value":1167},{"type":419,"tag":471,"props":2083,"children":2084},{"style":2061},[2085],{"type":424,"value":2086}," id",{"type":419,"tag":471,"props":2088,"children":2089},{"style":569},[2090],{"type":424,"value":1515},{"type":419,"tag":471,"props":2092,"children":2093},{"style":490},[2094],{"type":424,"value":1167},{"type":419,"tag":471,"props":2096,"children":2097},{"style":500},[2098],{"type":424,"value":2099},"item_tmpl",{"type":419,"tag":471,"props":2101,"children":2102},{"style":490},[2103],{"type":424,"value":1167},{"type":419,"tag":471,"props":2105,"children":2106},{"style":569},[2107],{"type":424,"value":704},{"type":419,"tag":471,"props":2109,"children":2110},{"class":473,"line":506},[2111,2116,2120,2124,2128,2132,2137,2141,2146,2150,2154,2159,2163,2168,2173,2178,2183,2187],{"type":419,"tag":471,"props":2112,"children":2113},{"style":569},[2114],{"type":424,"value":2115},"  \u003C",{"type":419,"tag":471,"props":2117,"children":2118},{"style":677},[2119],{"type":424,"value":680},{"type":419,"tag":471,"props":2121,"children":2122},{"style":2061},[2123],{"type":424,"value":2086},{"type":419,"tag":471,"props":2125,"children":2126},{"style":569},[2127],{"type":424,"value":1515},{"type":419,"tag":471,"props":2129,"children":2130},{"style":490},[2131],{"type":424,"value":1167},{"type":419,"tag":471,"props":2133,"children":2134},{"style":500},[2135],{"type":424,"value":2136},"\u003C%=id%>",{"type":419,"tag":471,"props":2138,"children":2139},{"style":490},[2140],{"type":424,"value":1167},{"type":419,"tag":471,"props":2142,"children":2143},{"style":2061},[2144],{"type":424,"value":2145}," class",{"type":419,"tag":471,"props":2147,"children":2148},{"style":569},[2149],{"type":424,"value":1515},{"type":419,"tag":471,"props":2151,"children":2152},{"style":490},[2153],{"type":424,"value":1167},{"type":419,"tag":471,"props":2155,"children":2156},{"style":500},[2157],{"type":424,"value":2158},"\u003C%=(i % 2 == 1 ? ",{"type":419,"tag":471,"props":2160,"children":2161},{"style":490},[2162],{"type":424,"value":1167},{"type":419,"tag":471,"props":2164,"children":2165},{"style":2061},[2166],{"type":424,"value":2167}," even",{"type":419,"tag":471,"props":2169,"children":2171},{"style":2170},"--shiki-light:#39ADB5;--shiki-light-font-style:inherit;--shiki-default:#B31D28;--shiki-default-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;--shiki-sepia:#F44747;--shiki-sepia-font-style:inherit",[2172],{"type":424,"value":1167},{"type":419,"tag":471,"props":2174,"children":2175},{"style":2061},[2176],{"type":424,"value":2177}," :",{"type":419,"tag":471,"props":2179,"children":2180},{"style":2170},[2181],{"type":424,"value":2182}," \"\")%",{"type":419,"tag":471,"props":2184,"children":2185},{"style":569},[2186],{"type":424,"value":685},{"type":419,"tag":471,"props":2188,"children":2189},{"style":484},[2190],{"type":424,"value":2191},"\">\n",{"type":419,"tag":471,"props":2193,"children":2194},{"class":473,"line":515},[2195,2200,2204,2208,2212,2216,2221,2225],{"type":419,"tag":471,"props":2196,"children":2197},{"style":569},[2198],{"type":424,"value":2199},"    \u003C",{"type":419,"tag":471,"props":2201,"children":2202},{"style":677},[2203],{"type":424,"value":680},{"type":419,"tag":471,"props":2205,"children":2206},{"style":2061},[2207],{"type":424,"value":2145},{"type":419,"tag":471,"props":2209,"children":2210},{"style":569},[2211],{"type":424,"value":1515},{"type":419,"tag":471,"props":2213,"children":2214},{"style":490},[2215],{"type":424,"value":1167},{"type":419,"tag":471,"props":2217,"children":2218},{"style":500},[2219],{"type":424,"value":2220},"grid_1 alpha right",{"type":419,"tag":471,"props":2222,"children":2223},{"style":490},[2224],{"type":424,"value":1167},{"type":419,"tag":471,"props":2226,"children":2227},{"style":569},[2228],{"type":424,"value":704},{"type":419,"tag":471,"props":2230,"children":2231},{"class":473,"line":524},[2232,2237,2242,2246,2250,2254,2259,2263,2268,2272,2276,2281,2285],{"type":419,"tag":471,"props":2233,"children":2234},{"style":569},[2235],{"type":424,"value":2236},"      \u003C",{"type":419,"tag":471,"props":2238,"children":2239},{"style":677},[2240],{"type":424,"value":2241},"img",{"type":419,"tag":471,"props":2243,"children":2244},{"style":2061},[2245],{"type":424,"value":2145},{"type":419,"tag":471,"props":2247,"children":2248},{"style":569},[2249],{"type":424,"value":1515},{"type":419,"tag":471,"props":2251,"children":2252},{"style":490},[2253],{"type":424,"value":1167},{"type":419,"tag":471,"props":2255,"children":2256},{"style":500},[2257],{"type":424,"value":2258},"righted",{"type":419,"tag":471,"props":2260,"children":2261},{"style":490},[2262],{"type":424,"value":1167},{"type":419,"tag":471,"props":2264,"children":2265},{"style":2061},[2266],{"type":424,"value":2267}," src",{"type":419,"tag":471,"props":2269,"children":2270},{"style":569},[2271],{"type":424,"value":1515},{"type":419,"tag":471,"props":2273,"children":2274},{"style":490},[2275],{"type":424,"value":1167},{"type":419,"tag":471,"props":2277,"children":2278},{"style":500},[2279],{"type":424,"value":2280},"\u003C%=profile_image_url%>",{"type":419,"tag":471,"props":2282,"children":2283},{"style":490},[2284],{"type":424,"value":1167},{"type":419,"tag":471,"props":2286,"children":2287},{"style":569},[2288],{"type":424,"value":2289},"/>\n",{"type":419,"tag":471,"props":2291,"children":2292},{"class":473,"line":533},[2293,2298,2302],{"type":419,"tag":471,"props":2294,"children":2295},{"style":569},[2296],{"type":424,"value":2297},"    \u003C/",{"type":419,"tag":471,"props":2299,"children":2300},{"style":677},[2301],{"type":424,"value":680},{"type":419,"tag":471,"props":2303,"children":2304},{"style":569},[2305],{"type":424,"value":704},{"type":419,"tag":471,"props":2307,"children":2308},{"class":473,"line":542},[2309,2313,2317,2321,2325,2329,2334,2338],{"type":419,"tag":471,"props":2310,"children":2311},{"style":569},[2312],{"type":424,"value":2199},{"type":419,"tag":471,"props":2314,"children":2315},{"style":677},[2316],{"type":424,"value":680},{"type":419,"tag":471,"props":2318,"children":2319},{"style":2061},[2320],{"type":424,"value":2145},{"type":419,"tag":471,"props":2322,"children":2323},{"style":569},[2324],{"type":424,"value":1515},{"type":419,"tag":471,"props":2326,"children":2327},{"style":490},[2328],{"type":424,"value":1167},{"type":419,"tag":471,"props":2330,"children":2331},{"style":500},[2332],{"type":424,"value":2333},"grid_6 omega contents",{"type":419,"tag":471,"props":2335,"children":2336},{"style":490},[2337],{"type":424,"value":1167},{"type":419,"tag":471,"props":2339,"children":2340},{"style":569},[2341],{"type":424,"value":704},{"type":419,"tag":471,"props":2343,"children":2344},{"class":473,"line":551},[2345,2349,2353,2358,2363,2367,2371,2376,2380,2384,2389,2393,2397,2402,2406,2410,2414,2418,2422,2426,2430,2435,2439,2443],{"type":419,"tag":471,"props":2346,"children":2347},{"style":569},[2348],{"type":424,"value":2236},{"type":419,"tag":471,"props":2350,"children":2351},{"style":677},[2352],{"type":424,"value":420},{"type":419,"tag":471,"props":2354,"children":2355},{"style":569},[2356],{"type":424,"value":2357},">\u003C",{"type":419,"tag":471,"props":2359,"children":2360},{"style":677},[2361],{"type":424,"value":2362},"b",{"type":419,"tag":471,"props":2364,"children":2365},{"style":569},[2366],{"type":424,"value":2357},{"type":419,"tag":471,"props":2368,"children":2369},{"style":677},[2370],{"type":424,"value":427},{"type":419,"tag":471,"props":2372,"children":2373},{"style":2061},[2374],{"type":424,"value":2375}," href",{"type":419,"tag":471,"props":2377,"children":2378},{"style":569},[2379],{"type":424,"value":1515},{"type":419,"tag":471,"props":2381,"children":2382},{"style":490},[2383],{"type":424,"value":1167},{"type":419,"tag":471,"props":2385,"children":2386},{"style":500},[2387],{"type":424,"value":2388},"/\u003C%=from_user%>",{"type":419,"tag":471,"props":2390,"children":2391},{"style":490},[2392],{"type":424,"value":1167},{"type":419,"tag":471,"props":2394,"children":2395},{"style":569},[2396],{"type":424,"value":685},{"type":419,"tag":471,"props":2398,"children":2399},{"style":484},[2400],{"type":424,"value":2401},"\u003C%=from_user%>",{"type":419,"tag":471,"props":2403,"children":2404},{"style":569},[2405],{"type":424,"value":695},{"type":419,"tag":471,"props":2407,"children":2408},{"style":677},[2409],{"type":424,"value":427},{"type":419,"tag":471,"props":2411,"children":2412},{"style":569},[2413],{"type":424,"value":685},{"type":419,"tag":471,"props":2415,"children":2416},{"style":484},[2417],{"type":424,"value":592},{"type":419,"tag":471,"props":2419,"children":2420},{"style":569},[2421],{"type":424,"value":695},{"type":419,"tag":471,"props":2423,"children":2424},{"style":677},[2425],{"type":424,"value":2362},{"type":419,"tag":471,"props":2427,"children":2428},{"style":569},[2429],{"type":424,"value":685},{"type":419,"tag":471,"props":2431,"children":2432},{"style":484},[2433],{"type":424,"value":2434}," \u003C%=text%>",{"type":419,"tag":471,"props":2436,"children":2437},{"style":569},[2438],{"type":424,"value":695},{"type":419,"tag":471,"props":2440,"children":2441},{"style":677},[2442],{"type":424,"value":420},{"type":419,"tag":471,"props":2444,"children":2445},{"style":569},[2446],{"type":424,"value":704},{"type":419,"tag":471,"props":2448,"children":2449},{"class":473,"line":560},[2450,2454,2458],{"type":419,"tag":471,"props":2451,"children":2452},{"style":569},[2453],{"type":424,"value":2297},{"type":419,"tag":471,"props":2455,"children":2456},{"style":677},[2457],{"type":424,"value":680},{"type":419,"tag":471,"props":2459,"children":2460},{"style":569},[2461],{"type":424,"value":704},{"type":419,"tag":471,"props":2463,"children":2464},{"class":473,"line":580},[2465,2470,2474],{"type":419,"tag":471,"props":2466,"children":2467},{"style":569},[2468],{"type":424,"value":2469},"  \u003C/",{"type":419,"tag":471,"props":2471,"children":2472},{"style":677},[2473],{"type":424,"value":680},{"type":419,"tag":471,"props":2475,"children":2476},{"style":569},[2477],{"type":424,"value":704},{"type":419,"tag":471,"props":2479,"children":2480},{"class":473,"line":606},[2481,2485,2489],{"type":419,"tag":471,"props":2482,"children":2483},{"style":569},[2484],{"type":424,"value":695},{"type":419,"tag":471,"props":2486,"children":2487},{"style":677},[2488],{"type":424,"value":2058},{"type":419,"tag":471,"props":2490,"children":2491},{"style":569},[2492],{"type":424,"value":704},{"type":419,"tag":461,"props":2494,"children":2496},{"className":463,"code":2495,"language":465,"meta":413,"style":413},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {\n    return !/\\W/.test(str)\n      ? // 缓存会将读取脚本内容到模板解析这个过程的解析结果缓存下来\n        (cache[str] =\n          cache[str] ||\n          // 读取脚本内容\n          tmpl(document.getElementById(str).innerHTML))\n      : new Function();\n  };\n})();\n",[2497],{"type":419,"tag":435,"props":2498,"children":2499},{"__ignoreMap":413},[2500,2519,2538,2589,2632,2644,2672,2696,2704,2752,2777,2784],{"type":419,"tag":471,"props":2501,"children":2502},{"class":473,"line":474},[2503,2507,2511,2515],{"type":419,"tag":471,"props":2504,"children":2505},{"style":484},[2506],{"type":424,"value":487},{"type":419,"tag":471,"props":2508,"children":2509},{"style":817},[2510],{"type":424,"value":820},{"type":419,"tag":471,"props":2512,"children":2513},{"style":569},[2514],{"type":424,"value":825},{"type":419,"tag":471,"props":2516,"children":2517},{"style":569},[2518],{"type":424,"value":577},{"type":419,"tag":471,"props":2520,"children":2521},{"class":473,"line":496},[2522,2526,2530,2534],{"type":419,"tag":471,"props":2523,"children":2524},{"style":817},[2525],{"type":424,"value":837},{"type":419,"tag":471,"props":2527,"children":2528},{"style":484},[2529],{"type":424,"value":842},{"type":419,"tag":471,"props":2531,"children":2532},{"style":845},[2533],{"type":424,"value":848},{"type":419,"tag":471,"props":2535,"children":2536},{"style":569},[2537],{"type":424,"value":853},{"type":419,"tag":471,"props":2539,"children":2540},{"class":473,"line":506},[2541,2545,2549,2553,2557,2561,2565,2569,2573,2577,2581,2585],{"type":419,"tag":471,"props":2542,"children":2543},{"style":868},[2544],{"type":424,"value":871},{"type":419,"tag":471,"props":2546,"children":2547},{"style":569},[2548],{"type":424,"value":876},{"type":419,"tag":471,"props":2550,"children":2551},{"style":478},[2552],{"type":424,"value":881},{"type":419,"tag":471,"props":2554,"children":2555},{"style":845},[2556],{"type":424,"value":848},{"type":419,"tag":471,"props":2558,"children":2559},{"style":817},[2560],{"type":424,"value":890},{"type":419,"tag":471,"props":2562,"children":2563},{"style":478},[2564],{"type":424,"value":895},{"type":419,"tag":471,"props":2566,"children":2567},{"style":569},[2568],{"type":424,"value":487},{"type":419,"tag":471,"props":2570,"children":2571},{"style":902},[2572],{"type":424,"value":905},{"type":419,"tag":471,"props":2574,"children":2575},{"style":569},[2576],{"type":424,"value":572},{"type":419,"tag":471,"props":2578,"children":2579},{"style":902},[2580],{"type":424,"value":914},{"type":419,"tag":471,"props":2582,"children":2583},{"style":569},[2584],{"type":424,"value":919},{"type":419,"tag":471,"props":2586,"children":2587},{"style":569},[2588],{"type":424,"value":577},{"type":419,"tag":471,"props":2590,"children":2591},{"class":473,"line":515},[2592,2596,2600,2604,2608,2612,2616,2620,2624,2628],{"type":419,"tag":471,"props":2593,"children":2594},{"style":1404},[2595],{"type":424,"value":1828},{"type":419,"tag":471,"props":2597,"children":2598},{"style":845},[2599],{"type":424,"value":961},{"type":419,"tag":471,"props":2601,"children":2602},{"style":490},[2603],{"type":424,"value":966},{"type":419,"tag":471,"props":2605,"children":2606},{"style":969},[2607],{"type":424,"value":972},{"type":419,"tag":471,"props":2609,"children":2610},{"style":490},[2611],{"type":424,"value":966},{"type":419,"tag":471,"props":2613,"children":2614},{"style":569},[2615],{"type":424,"value":876},{"type":419,"tag":471,"props":2617,"children":2618},{"style":478},[2619],{"type":424,"value":985},{"type":419,"tag":471,"props":2621,"children":2622},{"style":584},[2623],{"type":424,"value":487},{"type":419,"tag":471,"props":2625,"children":2626},{"style":484},[2627],{"type":424,"value":905},{"type":419,"tag":471,"props":2629,"children":2630},{"style":584},[2631],{"type":424,"value":636},{"type":419,"tag":471,"props":2633,"children":2634},{"class":473,"line":524},[2635,2639],{"type":419,"tag":471,"props":2636,"children":2637},{"style":845},[2638],{"type":424,"value":1005},{"type":419,"tag":471,"props":2640,"children":2641},{"style":663},[2642],{"type":424,"value":2643}," // 缓存会将读取脚本内容到模板解析这个过程的解析结果缓存下来\n",{"type":419,"tag":471,"props":2645,"children":2646},{"class":473,"line":533},[2647,2652,2656,2660,2664,2668],{"type":419,"tag":471,"props":2648,"children":2649},{"style":584},[2650],{"type":424,"value":2651},"        (",{"type":419,"tag":471,"props":2653,"children":2654},{"style":484},[2655],{"type":424,"value":1015},{"type":419,"tag":471,"props":2657,"children":2658},{"style":584},[2659],{"type":424,"value":1020},{"type":419,"tag":471,"props":2661,"children":2662},{"style":484},[2663],{"type":424,"value":905},{"type":419,"tag":471,"props":2665,"children":2666},{"style":584},[2667],{"type":424,"value":1029},{"type":419,"tag":471,"props":2669,"children":2670},{"style":845},[2671],{"type":424,"value":1034},{"type":419,"tag":471,"props":2673,"children":2674},{"class":473,"line":542},[2675,2679,2683,2687,2691],{"type":419,"tag":471,"props":2676,"children":2677},{"style":484},[2678],{"type":424,"value":1042},{"type":419,"tag":471,"props":2680,"children":2681},{"style":584},[2682],{"type":424,"value":1020},{"type":419,"tag":471,"props":2684,"children":2685},{"style":484},[2686],{"type":424,"value":905},{"type":419,"tag":471,"props":2688,"children":2689},{"style":584},[2690],{"type":424,"value":1029},{"type":419,"tag":471,"props":2692,"children":2693},{"style":845},[2694],{"type":424,"value":2695},"||\n",{"type":419,"tag":471,"props":2697,"children":2698},{"class":473,"line":551},[2699],{"type":419,"tag":471,"props":2700,"children":2701},{"style":663},[2702],{"type":424,"value":2703},"          // 读取脚本内容\n",{"type":419,"tag":471,"props":2705,"children":2706},{"class":473,"line":560},[2707,2712,2716,2720,2724,2728,2732,2736,2740,2744,2748],{"type":419,"tag":471,"props":2708,"children":2709},{"style":478},[2710],{"type":424,"value":2711},"          tmpl",{"type":419,"tag":471,"props":2713,"children":2714},{"style":584},[2715],{"type":424,"value":487},{"type":419,"tag":471,"props":2717,"children":2718},{"style":484},[2719],{"type":424,"value":1072},{"type":419,"tag":471,"props":2721,"children":2722},{"style":569},[2723],{"type":424,"value":876},{"type":419,"tag":471,"props":2725,"children":2726},{"style":478},[2727],{"type":424,"value":1081},{"type":419,"tag":471,"props":2729,"children":2730},{"style":584},[2731],{"type":424,"value":487},{"type":419,"tag":471,"props":2733,"children":2734},{"style":484},[2735],{"type":424,"value":905},{"type":419,"tag":471,"props":2737,"children":2738},{"style":584},[2739],{"type":424,"value":919},{"type":419,"tag":471,"props":2741,"children":2742},{"style":569},[2743],{"type":424,"value":876},{"type":419,"tag":471,"props":2745,"children":2746},{"style":484},[2747],{"type":424,"value":1102},{"type":419,"tag":471,"props":2749,"children":2750},{"style":584},[2751],{"type":424,"value":1107},{"type":419,"tag":471,"props":2753,"children":2754},{"class":473,"line":580},[2755,2759,2764,2768,2773],{"type":419,"tag":471,"props":2756,"children":2757},{"style":845},[2758],{"type":424,"value":1115},{"type":419,"tag":471,"props":2760,"children":2761},{"style":845},[2762],{"type":424,"value":2763}," new",{"type":419,"tag":471,"props":2765,"children":2766},{"style":478},[2767],{"type":424,"value":1143},{"type":419,"tag":471,"props":2769,"children":2770},{"style":584},[2771],{"type":424,"value":2772},"()",{"type":419,"tag":471,"props":2774,"children":2775},{"style":569},[2776],{"type":424,"value":1802},{"type":419,"tag":471,"props":2778,"children":2779},{"class":473,"line":606},[2780],{"type":419,"tag":471,"props":2781,"children":2782},{"style":569},[2783],{"type":424,"value":1875},{"type":419,"tag":471,"props":2785,"children":2786},{"class":473,"line":625},[2787,2791,2795],{"type":419,"tag":471,"props":2788,"children":2789},{"style":569},[2790],{"type":424,"value":631},{"type":419,"tag":471,"props":2792,"children":2793},{"style":484},[2794],{"type":424,"value":1888},{"type":419,"tag":471,"props":2796,"children":2797},{"style":569},[2798],{"type":424,"value":1802},{"type":419,"tag":420,"props":2800,"children":2801},{},[2802,2808],{"type":419,"tag":435,"props":2803,"children":2805},{"className":2804},[],[2806],{"type":424,"value":2807},"new Function()",{"type":424,"value":2809}," 即模板解析的核心内容，原理是用一个数组，保存所有解析内容，再拼接回字符串，作为 JS 执行。类似 eval 函数。",{"type":419,"tag":461,"props":2811,"children":2813},{"className":463,"code":2812,"language":465,"meta":413,"style":413},"new Function(\n  \"obj\",\n  \"var p=[];\" +\n    // + '...'\n    \"return p.join('')\"\n);\n",[2814],{"type":419,"tag":435,"props":2815,"children":2816},{"__ignoreMap":413},[2817,2833,2853,2873,2881,2898],{"type":419,"tag":471,"props":2818,"children":2819},{"class":473,"line":474},[2820,2825,2829],{"type":419,"tag":471,"props":2821,"children":2822},{"style":845},[2823],{"type":424,"value":2824},"new",{"type":419,"tag":471,"props":2826,"children":2827},{"style":478},[2828],{"type":424,"value":1143},{"type":419,"tag":471,"props":2830,"children":2831},{"style":484},[2832],{"type":424,"value":1148},{"type":419,"tag":471,"props":2834,"children":2835},{"class":473,"line":496},[2836,2841,2845,2849],{"type":419,"tag":471,"props":2837,"children":2838},{"style":490},[2839],{"type":424,"value":2840},"  \"",{"type":419,"tag":471,"props":2842,"children":2843},{"style":500},[2844],{"type":424,"value":1162},{"type":419,"tag":471,"props":2846,"children":2847},{"style":490},[2848],{"type":424,"value":1167},{"type":419,"tag":471,"props":2850,"children":2851},{"style":569},[2852],{"type":424,"value":603},{"type":419,"tag":471,"props":2854,"children":2855},{"class":473,"line":506},[2856,2860,2865,2869],{"type":419,"tag":471,"props":2857,"children":2858},{"style":490},[2859],{"type":424,"value":2840},{"type":419,"tag":471,"props":2861,"children":2862},{"style":500},[2863],{"type":424,"value":2864},"var p=[];",{"type":419,"tag":471,"props":2866,"children":2867},{"style":490},[2868],{"type":424,"value":1167},{"type":419,"tag":471,"props":2870,"children":2871},{"style":845},[2872],{"type":424,"value":1193},{"type":419,"tag":471,"props":2874,"children":2875},{"class":473,"line":515},[2876],{"type":419,"tag":471,"props":2877,"children":2878},{"style":663},[2879],{"type":424,"value":2880},"    // + '...'\n",{"type":419,"tag":471,"props":2882,"children":2883},{"class":473,"line":524},[2884,2889,2894],{"type":419,"tag":471,"props":2885,"children":2886},{"style":490},[2887],{"type":424,"value":2888},"    \"",{"type":419,"tag":471,"props":2890,"children":2891},{"style":500},[2892],{"type":424,"value":2893},"return p.join('')",{"type":419,"tag":471,"props":2895,"children":2896},{"style":490},[2897],{"type":424,"value":1788},{"type":419,"tag":471,"props":2899,"children":2900},{"class":473,"line":533},[2901,2905],{"type":419,"tag":471,"props":2902,"children":2903},{"style":484},[2904],{"type":424,"value":919},{"type":419,"tag":471,"props":2906,"children":2907},{"style":569},[2908],{"type":424,"value":1802},{"type":419,"tag":420,"props":2910,"children":2911},{},[2912,2914,2920],{"type":424,"value":2913},"要解析什么内容呢？无非是 ",{"type":419,"tag":435,"props":2915,"children":2917},{"className":2916},[],[2918],{"type":424,"value":2919},"\u003C%=hello%>",{"type":424,"value":2921}," 这种模板字符串。执行过程中，通过 with 语句，将内部变量的求值（hello）转移到参数对象（data.hello）。这个玩意儿在 VueJS 的模板编译中也用到过：",{"type":419,"tag":461,"props":2923,"children":2925},{"className":463,"code":2924,"language":465,"meta":413,"style":413},"/* VueJS */\nwith (vm) {\n  return createVNode(\"p\", { attrs: { hi: hello /* vm.hello */ } }, [\n    createTextNode(\"Hello World\"),\n  ]);\n}\n",[2926],{"type":419,"tag":435,"props":2927,"children":2928},{"__ignoreMap":413},[2929,2937,2955,3040,3073,3085],{"type":419,"tag":471,"props":2930,"children":2931},{"class":473,"line":474},[2932],{"type":419,"tag":471,"props":2933,"children":2934},{"style":663},[2935],{"type":424,"value":2936},"/* VueJS */\n",{"type":419,"tag":471,"props":2938,"children":2939},{"class":473,"line":496},[2940,2945,2950],{"type":419,"tag":471,"props":2941,"children":2942},{"style":1404},[2943],{"type":424,"value":2944},"with",{"type":419,"tag":471,"props":2946,"children":2947},{"style":484},[2948],{"type":424,"value":2949}," (vm) ",{"type":419,"tag":471,"props":2951,"children":2952},{"style":569},[2953],{"type":424,"value":2954},"{\n",{"type":419,"tag":471,"props":2956,"children":2957},{"class":473,"line":506},[2958,2963,2968,2972,2976,2980,2984,2988,2993,2998,3002,3006,3011,3015,3020,3025,3030,3035],{"type":419,"tag":471,"props":2959,"children":2960},{"style":1404},[2961],{"type":424,"value":2962},"  return",{"type":419,"tag":471,"props":2964,"children":2965},{"style":478},[2966],{"type":424,"value":2967}," createVNode",{"type":419,"tag":471,"props":2969,"children":2970},{"style":584},[2971],{"type":424,"value":487},{"type":419,"tag":471,"props":2973,"children":2974},{"style":490},[2975],{"type":424,"value":1167},{"type":419,"tag":471,"props":2977,"children":2978},{"style":500},[2979],{"type":424,"value":420},{"type":419,"tag":471,"props":2981,"children":2982},{"style":490},[2983],{"type":424,"value":1167},{"type":419,"tag":471,"props":2985,"children":2986},{"style":569},[2987],{"type":424,"value":572},{"type":419,"tag":471,"props":2989,"children":2990},{"style":569},[2991],{"type":424,"value":2992}," {",{"type":419,"tag":471,"props":2994,"children":2995},{"style":584},[2996],{"type":424,"value":2997}," attrs",{"type":419,"tag":471,"props":2999,"children":3000},{"style":569},[3001],{"type":424,"value":592},{"type":419,"tag":471,"props":3003,"children":3004},{"style":569},[3005],{"type":424,"value":2992},{"type":419,"tag":471,"props":3007,"children":3008},{"style":584},[3009],{"type":424,"value":3010}," hi",{"type":419,"tag":471,"props":3012,"children":3013},{"style":569},[3014],{"type":424,"value":592},{"type":419,"tag":471,"props":3016,"children":3017},{"style":484},[3018],{"type":424,"value":3019}," hello",{"type":419,"tag":471,"props":3021,"children":3022},{"style":663},[3023],{"type":424,"value":3024}," /* vm.hello */",{"type":419,"tag":471,"props":3026,"children":3027},{"style":569},[3028],{"type":424,"value":3029}," }",{"type":419,"tag":471,"props":3031,"children":3032},{"style":569},[3033],{"type":424,"value":3034}," },",{"type":419,"tag":471,"props":3036,"children":3037},{"style":584},[3038],{"type":424,"value":3039}," [\n",{"type":419,"tag":471,"props":3041,"children":3042},{"class":473,"line":515},[3043,3048,3052,3056,3061,3065,3069],{"type":419,"tag":471,"props":3044,"children":3045},{"style":478},[3046],{"type":424,"value":3047},"    createTextNode",{"type":419,"tag":471,"props":3049,"children":3050},{"style":584},[3051],{"type":424,"value":487},{"type":419,"tag":471,"props":3053,"children":3054},{"style":490},[3055],{"type":424,"value":1167},{"type":419,"tag":471,"props":3057,"children":3058},{"style":500},[3059],{"type":424,"value":3060},"Hello World",{"type":419,"tag":471,"props":3062,"children":3063},{"style":490},[3064],{"type":424,"value":1167},{"type":419,"tag":471,"props":3066,"children":3067},{"style":584},[3068],{"type":424,"value":919},{"type":419,"tag":471,"props":3070,"children":3071},{"style":569},[3072],{"type":424,"value":603},{"type":419,"tag":471,"props":3074,"children":3075},{"class":473,"line":524},[3076,3081],{"type":419,"tag":471,"props":3077,"children":3078},{"style":584},[3079],{"type":424,"value":3080},"  ])",{"type":419,"tag":471,"props":3082,"children":3083},{"style":569},[3084],{"type":424,"value":1802},{"type":419,"tag":471,"props":3086,"children":3087},{"class":473,"line":533},[3088],{"type":419,"tag":471,"props":3089,"children":3090},{"style":569},[3091],{"type":424,"value":3092},"}\n",{"type":419,"tag":420,"props":3094,"children":3095},{},[3096],{"type":424,"value":3097},"那如何解析呢？",{"type":419,"tag":420,"props":3099,"children":3100},{},[3101,3107,3109,3115],{"type":419,"tag":3102,"props":3103,"children":3104},"del",{},[3105],{"type":424,"value":3106},"我们知道",{"type":424,"value":3108},"曾写过经典字符串模板的佬应该知道，",{"type":419,"tag":3110,"props":3111,"children":3112},"strong",{},[3113],{"type":424,"value":3114},"模板字符串一般包含：字符串、变量及逻辑",{"type":424,"value":3116},"。",{"type":419,"tag":3118,"props":3119,"children":3120},"ul",{},[3121,3133,3144],{"type":419,"tag":3122,"props":3123,"children":3124},"li",{},[3125,3127],{"type":424,"value":3126},"字符串 ",{"type":419,"tag":435,"props":3128,"children":3130},{"className":3129},[],[3131],{"type":424,"value":3132},"\u003Chtml>Lionad\u003C/html>",{"type":419,"tag":3122,"props":3134,"children":3135},{},[3136,3138],{"type":424,"value":3137},"带变量 ",{"type":419,"tag":435,"props":3139,"children":3141},{"className":3140},[],[3142],{"type":424,"value":3143},"\u003Chtml>\u003C%=name%>\u003C/html>",{"type":419,"tag":3122,"props":3145,"children":3146},{},[3147,3149,3155],{"type":424,"value":3148},"带逻辑 ",{"type":419,"tag":435,"props":3150,"children":3152},{"className":3151},[],[3153],{"type":424,"value":3154},"\u003C% if(name){ %>\u003Chtml>\u003C%=name%>\u003C/html>\u003C% } %>",{"type":424,"value":3116},{"type":419,"tag":420,"props":3157,"children":3158},{},[3159],{"type":424,"value":3160},"所以解析模板，无非就是把这三种字符串替换成纯粹的 JS 逻辑，作为 new Function 的参数。其中所有中间变量，可以用一个数组来储存：",{"type":419,"tag":3118,"props":3162,"children":3163},{},[3164,3183,3201],{"type":419,"tag":3122,"props":3165,"children":3166},{},[3167,3169,3174,3176,3182],{"type":424,"value":3168},"将普通字符串直接推入作为结果的内容数组，比如 ",{"type":419,"tag":435,"props":3170,"children":3172},{"className":3171},[],[3173],{"type":424,"value":3132},{"type":424,"value":3175}," 应该被解析为 ",{"type":419,"tag":435,"props":3177,"children":3179},{"className":3178},[],[3180],{"type":424,"value":3181},"p.push('\u003Chtml>Lionad\u003C/html>')",{"type":424,"value":3116},{"type":419,"tag":3122,"props":3184,"children":3185},{},[3186,3188,3193,3194,3200],{"type":424,"value":3187},"如果碰到变量，则将变量拆分出来推入数组，如 ",{"type":419,"tag":435,"props":3189,"children":3191},{"className":3190},[],[3192],{"type":424,"value":3143},{"type":424,"value":3175},{"type":419,"tag":435,"props":3195,"children":3197},{"className":3196},[],[3198],{"type":424,"value":3199},"p.push('\u003Chtml>');p.push(name);p.push('\u003C/html>')",{"type":424,"value":3116},{"type":419,"tag":3122,"props":3202,"children":3203},{},[3204,3206,3212,3214,3219,3221,3227],{"type":424,"value":3205},"带逻辑的字符串，由于逻辑本身就是 JS 代码，所以不需要解析为字符串，只需要把两侧的 ",{"type":419,"tag":435,"props":3207,"children":3209},{"className":3208},[],[3210],{"type":424,"value":3211},"\u003C% %>",{"type":424,"value":3213}," 这种模板标志去掉就好了。如 ",{"type":419,"tag":435,"props":3215,"children":3217},{"className":3216},[],[3218],{"type":424,"value":3154},{"type":424,"value":3220}," 应该被解析为：",{"type":419,"tag":435,"props":3222,"children":3224},{"className":3223},[],[3225],{"type":424,"value":3226},"if(name){ p.push('\u003Chtml>');p.push(name);p.push('\u003C/html>') } ",{"type":424,"value":3116},{"type":419,"tag":420,"props":3229,"children":3230},{},[3231],{"type":424,"value":3232},"以下面这段模板为例，我们看看字符串具体的替换规则。",{"type":419,"tag":461,"props":3234,"children":3236},{"className":463,"code":3235,"language":465,"meta":413,"style":413},"str = `\u003C% if (true) { %>\n    \u003Cli>\u003C%=users[i]%>\u003C/li>\n\u003C% } %>`;\n",[3237],{"type":419,"tag":435,"props":3238,"children":3239},{"__ignoreMap":413},[3240,3262,3270],{"type":419,"tag":471,"props":3241,"children":3242},{"class":473,"line":474},[3243,3248,3252,3257],{"type":419,"tag":471,"props":3244,"children":3245},{"style":484},[3246],{"type":424,"value":3247},"str ",{"type":419,"tag":471,"props":3249,"children":3250},{"style":845},[3251],{"type":424,"value":1515},{"type":419,"tag":471,"props":3253,"children":3254},{"style":490},[3255],{"type":424,"value":3256}," `",{"type":419,"tag":471,"props":3258,"children":3259},{"style":500},[3260],{"type":424,"value":3261},"\u003C% if (true) { %>\n",{"type":419,"tag":471,"props":3263,"children":3264},{"class":473,"line":496},[3265],{"type":419,"tag":471,"props":3266,"children":3267},{"style":500},[3268],{"type":424,"value":3269},"    \u003Cli>\u003C%=users[i]%>\u003C/li>\n",{"type":419,"tag":471,"props":3271,"children":3272},{"class":473,"line":506},[3273,3278,3282],{"type":419,"tag":471,"props":3274,"children":3275},{"style":500},[3276],{"type":424,"value":3277},"\u003C% } %>",{"type":419,"tag":471,"props":3279,"children":3280},{"style":490},[3281],{"type":424,"value":566},{"type":419,"tag":471,"props":3283,"children":3284},{"style":569},[3285],{"type":424,"value":1802},{"type":419,"tag":461,"props":3287,"children":3289},{"className":463,"code":3288,"language":465,"meta":413,"style":413},"// with 的使用方法都知道了，with(obj = { a })，那么\n// 就能在内部直接读取 a，不需要写 obj.a\n\"with(obj){p.push('\" +\n  str\n    // 将换行等空白字符转换为空格，这样所有代码都在一行了\n    // '\u003C% if (true) { %>     \u003Cli>\u003C%=users[i]%>\u003C/li> \u003C% } %>'\n    .replace(/[\\r\\t\\n]/g, \" \")\n    // ['', 'if (true) { %>\u003Cli>', '=users[i]%>\u003C/li>', ' } %>']\n    .split(\"\u003C%\")\n    // 因为 \\t 刚才已经被替换成空格了，所以这里可以使用 \\t 用来将不同行的代码字符串“相加”，\n    // 一会儿再拆分时，不会和原先字符串里的字符混淆\n    .join(\"\\t\")\n    // 去掉模板标志两端的引号，在这个例子里不会用到\n    .replace(/((^|%>)[^\\t]*)'/g, \"$1\\r\")\n    // 以下三句最重要，将所有变量推入数组，生成结果形如 `push('xxx',x,'xxx')` 的字符串\n    // 首先，刚才匹配完了 \u003C%，所以 \\t= 开头后边接的就是变量，这里让它转换成 ',x,' 的形式\n    .replace(/\\t=(.*?)%>/g, \"',$1,'\")\n    .split(\"\\t\")\n    // 在刚刚跟 split('\u003C%') 的位置用括号还原，得到了 ',x,'xxx'); 的形式\n    .join(\"');\")\n    // 在 \\t=xxx 那次匹配，已经把变量模板对应的结束标志 %> 匹配完了，\n    // 所以这是处理剩余语句的结束标志，用 split 拆分行后相当于直接把结束标记舍弃了\n    .split(\"%>\")\n    // 最终在每行开头增加 push 方法，形成了 push('xxx',x,'xxx'); 的形式\n    .join(\"p.push('\")\n    // 处理剩余的换行符\n    .split(\"\\r\")\n    .join(\"\\\\'\") +\n  \"');}\";\n",[3290],{"type":419,"tag":435,"props":3291,"children":3292},{"__ignoreMap":413},[3293,3301,3309,3328,3336,3344,3352,3408,3416,3447,3455,3463,3494,3502,3601,3609,3617,3692,3723,3731,3762,3770,3778,3809,3817,3848,3856,3887,3926],{"type":419,"tag":471,"props":3294,"children":3295},{"class":473,"line":474},[3296],{"type":419,"tag":471,"props":3297,"children":3298},{"style":663},[3299],{"type":424,"value":3300},"// with 的使用方法都知道了，with(obj = { a })，那么\n",{"type":419,"tag":471,"props":3302,"children":3303},{"class":473,"line":496},[3304],{"type":419,"tag":471,"props":3305,"children":3306},{"style":663},[3307],{"type":424,"value":3308},"// 就能在内部直接读取 a，不需要写 obj.a\n",{"type":419,"tag":471,"props":3310,"children":3311},{"class":473,"line":506},[3312,3316,3320,3324],{"type":419,"tag":471,"props":3313,"children":3314},{"style":490},[3315],{"type":424,"value":1167},{"type":419,"tag":471,"props":3317,"children":3318},{"style":500},[3319],{"type":424,"value":1216},{"type":419,"tag":471,"props":3321,"children":3322},{"style":490},[3323],{"type":424,"value":1167},{"type":419,"tag":471,"props":3325,"children":3326},{"style":845},[3327],{"type":424,"value":1193},{"type":419,"tag":471,"props":3329,"children":3330},{"class":473,"line":515},[3331],{"type":419,"tag":471,"props":3332,"children":3333},{"style":484},[3334],{"type":424,"value":3335},"  str\n",{"type":419,"tag":471,"props":3337,"children":3338},{"class":473,"line":524},[3339],{"type":419,"tag":471,"props":3340,"children":3341},{"style":663},[3342],{"type":424,"value":3343},"    // 将换行等空白字符转换为空格，这样所有代码都在一行了\n",{"type":419,"tag":471,"props":3345,"children":3346},{"class":473,"line":533},[3347],{"type":419,"tag":471,"props":3348,"children":3349},{"style":663},[3350],{"type":424,"value":3351},"    // '\u003C% if (true) { %>     \u003Cli>\u003C%=users[i]%>\u003C/li> \u003C% } %>'\n",{"type":419,"tag":471,"props":3353,"children":3354},{"class":473,"line":542},[3355,3360,3364,3368,3372,3376,3380,3384,3388,3392,3396,3400,3404],{"type":419,"tag":471,"props":3356,"children":3357},{"style":569},[3358],{"type":424,"value":3359},"    .",{"type":419,"tag":471,"props":3361,"children":3362},{"style":478},[3363],{"type":424,"value":1256},{"type":419,"tag":471,"props":3365,"children":3366},{"style":484},[3367],{"type":424,"value":487},{"type":419,"tag":471,"props":3369,"children":3370},{"style":490},[3371],{"type":424,"value":966},{"type":419,"tag":471,"props":3373,"children":3374},{"style":1267},[3375],{"type":424,"value":1020},{"type":419,"tag":471,"props":3377,"children":3378},{"style":969},[3379],{"type":424,"value":1274},{"type":419,"tag":471,"props":3381,"children":3382},{"style":1267},[3383],{"type":424,"value":1279},{"type":419,"tag":471,"props":3385,"children":3386},{"style":490},[3387],{"type":424,"value":966},{"type":419,"tag":471,"props":3389,"children":3390},{"style":1286},[3391],{"type":424,"value":1289},{"type":419,"tag":471,"props":3393,"children":3394},{"style":569},[3395],{"type":424,"value":572},{"type":419,"tag":471,"props":3397,"children":3398},{"style":490},[3399],{"type":424,"value":1298},{"type":419,"tag":471,"props":3401,"children":3402},{"style":490},[3403],{"type":424,"value":1298},{"type":419,"tag":471,"props":3405,"children":3406},{"style":484},[3407],{"type":424,"value":636},{"type":419,"tag":471,"props":3409,"children":3410},{"class":473,"line":551},[3411],{"type":419,"tag":471,"props":3412,"children":3413},{"style":663},[3414],{"type":424,"value":3415},"    // ['', 'if (true) { %>\u003Cli>', '=users[i]%>\u003C/li>', ' } %>']\n",{"type":419,"tag":471,"props":3417,"children":3418},{"class":473,"line":560},[3419,3423,3427,3431,3435,3439,3443],{"type":419,"tag":471,"props":3420,"children":3421},{"style":569},[3422],{"type":424,"value":3359},{"type":419,"tag":471,"props":3424,"children":3425},{"style":478},[3426],{"type":424,"value":1319},{"type":419,"tag":471,"props":3428,"children":3429},{"style":484},[3430],{"type":424,"value":487},{"type":419,"tag":471,"props":3432,"children":3433},{"style":490},[3434],{"type":424,"value":1167},{"type":419,"tag":471,"props":3436,"children":3437},{"style":500},[3438],{"type":424,"value":1332},{"type":419,"tag":471,"props":3440,"children":3441},{"style":490},[3442],{"type":424,"value":1167},{"type":419,"tag":471,"props":3444,"children":3445},{"style":484},[3446],{"type":424,"value":636},{"type":419,"tag":471,"props":3448,"children":3449},{"class":473,"line":580},[3450],{"type":419,"tag":471,"props":3451,"children":3452},{"style":663},[3453],{"type":424,"value":3454},"    // 因为 \\t 刚才已经被替换成空格了，所以这里可以使用 \\t 用来将不同行的代码字符串“相加”，\n",{"type":419,"tag":471,"props":3456,"children":3457},{"class":473,"line":606},[3458],{"type":419,"tag":471,"props":3459,"children":3460},{"style":663},[3461],{"type":424,"value":3462},"    // 一会儿再拆分时，不会和原先字符串里的字符混淆\n",{"type":419,"tag":471,"props":3464,"children":3465},{"class":473,"line":625},[3466,3470,3474,3478,3482,3486,3490],{"type":419,"tag":471,"props":3467,"children":3468},{"style":569},[3469],{"type":424,"value":3359},{"type":419,"tag":471,"props":3471,"children":3472},{"style":478},[3473],{"type":424,"value":1353},{"type":419,"tag":471,"props":3475,"children":3476},{"style":484},[3477],{"type":424,"value":487},{"type":419,"tag":471,"props":3479,"children":3480},{"style":490},[3481],{"type":424,"value":1167},{"type":419,"tag":471,"props":3483,"children":3484},{"style":1364},[3485],{"type":424,"value":1367},{"type":419,"tag":471,"props":3487,"children":3488},{"style":490},[3489],{"type":424,"value":1167},{"type":419,"tag":471,"props":3491,"children":3492},{"style":484},[3493],{"type":424,"value":636},{"type":419,"tag":471,"props":3495,"children":3496},{"class":473,"line":1123},[3497],{"type":419,"tag":471,"props":3498,"children":3499},{"style":663},[3500],{"type":424,"value":3501},"    // 去掉模板标志两端的引号，在这个例子里不会用到\n",{"type":419,"tag":471,"props":3503,"children":3504},{"class":473,"line":1132},[3505,3509,3513,3517,3521,3525,3529,3533,3537,3541,3545,3549,3553,3557,3561,3565,3569,3573,3577,3581,3585,3589,3593,3597],{"type":419,"tag":471,"props":3506,"children":3507},{"style":569},[3508],{"type":424,"value":3359},{"type":419,"tag":471,"props":3510,"children":3511},{"style":478},[3512],{"type":424,"value":1256},{"type":419,"tag":471,"props":3514,"children":3515},{"style":484},[3516],{"type":424,"value":487},{"type":419,"tag":471,"props":3518,"children":3519},{"style":490},[3520],{"type":424,"value":966},{"type":419,"tag":471,"props":3522,"children":3523},{"style":1398},[3524],{"type":424,"value":1401},{"type":419,"tag":471,"props":3526,"children":3527},{"style":1404},[3528],{"type":424,"value":1407},{"type":419,"tag":471,"props":3530,"children":3531},{"style":845},[3532],{"type":424,"value":1412},{"type":419,"tag":471,"props":3534,"children":3535},{"style":1415},[3536],{"type":424,"value":1418},{"type":419,"tag":471,"props":3538,"children":3539},{"style":1398},[3540],{"type":424,"value":919},{"type":419,"tag":471,"props":3542,"children":3543},{"style":1267},[3544],{"type":424,"value":1020},{"type":419,"tag":471,"props":3546,"children":3547},{"style":845},[3548],{"type":424,"value":1407},{"type":419,"tag":471,"props":3550,"children":3551},{"style":969},[3552],{"type":424,"value":1367},{"type":419,"tag":471,"props":3554,"children":3555},{"style":1267},[3556],{"type":424,"value":1279},{"type":419,"tag":471,"props":3558,"children":3559},{"style":845},[3560],{"type":424,"value":1443},{"type":419,"tag":471,"props":3562,"children":3563},{"style":1398},[3564],{"type":424,"value":919},{"type":419,"tag":471,"props":3566,"children":3567},{"style":1415},[3568],{"type":424,"value":1452},{"type":419,"tag":471,"props":3570,"children":3571},{"style":490},[3572],{"type":424,"value":966},{"type":419,"tag":471,"props":3574,"children":3575},{"style":1286},[3576],{"type":424,"value":1289},{"type":419,"tag":471,"props":3578,"children":3579},{"style":569},[3580],{"type":424,"value":572},{"type":419,"tag":471,"props":3582,"children":3583},{"style":490},[3584],{"type":424,"value":1298},{"type":419,"tag":471,"props":3586,"children":3587},{"style":500},[3588],{"type":424,"value":1473},{"type":419,"tag":471,"props":3590,"children":3591},{"style":1364},[3592],{"type":424,"value":1478},{"type":419,"tag":471,"props":3594,"children":3595},{"style":490},[3596],{"type":424,"value":1167},{"type":419,"tag":471,"props":3598,"children":3599},{"style":484},[3600],{"type":424,"value":636},{"type":419,"tag":471,"props":3602,"children":3603},{"class":473,"line":1151},[3604],{"type":419,"tag":471,"props":3605,"children":3606},{"style":663},[3607],{"type":424,"value":3608},"    // 以下三句最重要，将所有变量推入数组，生成结果形如 `push('xxx',x,'xxx')` 的字符串\n",{"type":419,"tag":471,"props":3610,"children":3611},{"class":473,"line":1174},[3612],{"type":419,"tag":471,"props":3613,"children":3614},{"style":663},[3615],{"type":424,"value":3616},"    // 首先，刚才匹配完了 \u003C%，所以 \\t= 开头后边接的就是变量，这里让它转换成 ',x,' 的形式\n",{"type":419,"tag":471,"props":3618,"children":3619},{"class":473,"line":1196},[3620,3624,3628,3632,3636,3640,3644,3648,3652,3656,3660,3664,3668,3672,3676,3680,3684,3688],{"type":419,"tag":471,"props":3621,"children":3622},{"style":569},[3623],{"type":424,"value":3359},{"type":419,"tag":471,"props":3625,"children":3626},{"style":478},[3627],{"type":424,"value":1256},{"type":419,"tag":471,"props":3629,"children":3630},{"style":484},[3631],{"type":424,"value":487},{"type":419,"tag":471,"props":3633,"children":3634},{"style":490},[3635],{"type":424,"value":966},{"type":419,"tag":471,"props":3637,"children":3638},{"style":969},[3639],{"type":424,"value":1367},{"type":419,"tag":471,"props":3641,"children":3642},{"style":1415},[3643],{"type":424,"value":1515},{"type":419,"tag":471,"props":3645,"children":3646},{"style":1398},[3647],{"type":424,"value":487},{"type":419,"tag":471,"props":3649,"children":3650},{"style":969},[3651],{"type":424,"value":876},{"type":419,"tag":471,"props":3653,"children":3654},{"style":845},[3655],{"type":424,"value":1528},{"type":419,"tag":471,"props":3657,"children":3658},{"style":1398},[3659],{"type":424,"value":919},{"type":419,"tag":471,"props":3661,"children":3662},{"style":1415},[3663],{"type":424,"value":1418},{"type":419,"tag":471,"props":3665,"children":3666},{"style":490},[3667],{"type":424,"value":966},{"type":419,"tag":471,"props":3669,"children":3670},{"style":1286},[3671],{"type":424,"value":1289},{"type":419,"tag":471,"props":3673,"children":3674},{"style":569},[3675],{"type":424,"value":572},{"type":419,"tag":471,"props":3677,"children":3678},{"style":490},[3679],{"type":424,"value":1298},{"type":419,"tag":471,"props":3681,"children":3682},{"style":500},[3683],{"type":424,"value":1557},{"type":419,"tag":471,"props":3685,"children":3686},{"style":490},[3687],{"type":424,"value":1167},{"type":419,"tag":471,"props":3689,"children":3690},{"style":484},[3691],{"type":424,"value":636},{"type":419,"tag":471,"props":3693,"children":3694},{"class":473,"line":1205},[3695,3699,3703,3707,3711,3715,3719],{"type":419,"tag":471,"props":3696,"children":3697},{"style":569},[3698],{"type":424,"value":3359},{"type":419,"tag":471,"props":3700,"children":3701},{"style":478},[3702],{"type":424,"value":1319},{"type":419,"tag":471,"props":3704,"children":3705},{"style":484},[3706],{"type":424,"value":487},{"type":419,"tag":471,"props":3708,"children":3709},{"style":490},[3710],{"type":424,"value":1167},{"type":419,"tag":471,"props":3712,"children":3713},{"style":1364},[3714],{"type":424,"value":1367},{"type":419,"tag":471,"props":3716,"children":3717},{"style":490},[3718],{"type":424,"value":1167},{"type":419,"tag":471,"props":3720,"children":3721},{"style":484},[3722],{"type":424,"value":636},{"type":419,"tag":471,"props":3724,"children":3725},{"class":473,"line":1227},[3726],{"type":419,"tag":471,"props":3727,"children":3728},{"style":663},[3729],{"type":424,"value":3730},"    // 在刚刚跟 split('\u003C%') 的位置用括号还原，得到了 ',x,'xxx'); 的形式\n",{"type":419,"tag":471,"props":3732,"children":3733},{"class":473,"line":1236},[3734,3738,3742,3746,3750,3754,3758],{"type":419,"tag":471,"props":3735,"children":3736},{"style":569},[3737],{"type":424,"value":3359},{"type":419,"tag":471,"props":3739,"children":3740},{"style":478},[3741],{"type":424,"value":1353},{"type":419,"tag":471,"props":3743,"children":3744},{"style":484},[3745],{"type":424,"value":487},{"type":419,"tag":471,"props":3747,"children":3748},{"style":490},[3749],{"type":424,"value":1167},{"type":419,"tag":471,"props":3751,"children":3752},{"style":500},[3753],{"type":424,"value":1622},{"type":419,"tag":471,"props":3755,"children":3756},{"style":490},[3757],{"type":424,"value":1167},{"type":419,"tag":471,"props":3759,"children":3760},{"style":484},[3761],{"type":424,"value":636},{"type":419,"tag":471,"props":3763,"children":3764},{"class":473,"line":1245},[3765],{"type":419,"tag":471,"props":3766,"children":3767},{"style":663},[3768],{"type":424,"value":3769},"    // 在 \\t=xxx 那次匹配，已经把变量模板对应的结束标志 %> 匹配完了，\n",{"type":419,"tag":471,"props":3771,"children":3772},{"class":473,"line":1309},[3773],{"type":419,"tag":471,"props":3774,"children":3775},{"style":663},[3776],{"type":424,"value":3777},"    // 所以这是处理剩余语句的结束标志，用 split 拆分行后相当于直接把结束标记舍弃了\n",{"type":419,"tag":471,"props":3779,"children":3780},{"class":473,"line":1343},[3781,3785,3789,3793,3797,3801,3805],{"type":419,"tag":471,"props":3782,"children":3783},{"style":569},[3784],{"type":424,"value":3359},{"type":419,"tag":471,"props":3786,"children":3787},{"style":478},[3788],{"type":424,"value":1319},{"type":419,"tag":471,"props":3790,"children":3791},{"style":484},[3792],{"type":424,"value":487},{"type":419,"tag":471,"props":3794,"children":3795},{"style":490},[3796],{"type":424,"value":1167},{"type":419,"tag":471,"props":3798,"children":3799},{"style":500},[3800],{"type":424,"value":1418},{"type":419,"tag":471,"props":3802,"children":3803},{"style":490},[3804],{"type":424,"value":1167},{"type":419,"tag":471,"props":3806,"children":3807},{"style":484},[3808],{"type":424,"value":636},{"type":419,"tag":471,"props":3810,"children":3811},{"class":473,"line":1378},[3812],{"type":419,"tag":471,"props":3813,"children":3814},{"style":663},[3815],{"type":424,"value":3816},"    // 最终在每行开头增加 push 方法，形成了 push('xxx',x,'xxx'); 的形式\n",{"type":419,"tag":471,"props":3818,"children":3819},{"class":473,"line":1489},[3820,3824,3828,3832,3836,3840,3844],{"type":419,"tag":471,"props":3821,"children":3822},{"style":569},[3823],{"type":424,"value":3359},{"type":419,"tag":471,"props":3825,"children":3826},{"style":478},[3827],{"type":424,"value":1353},{"type":419,"tag":471,"props":3829,"children":3830},{"style":484},[3831],{"type":424,"value":487},{"type":419,"tag":471,"props":3833,"children":3834},{"style":490},[3835],{"type":424,"value":1167},{"type":419,"tag":471,"props":3837,"children":3838},{"style":500},[3839],{"type":424,"value":1687},{"type":419,"tag":471,"props":3841,"children":3842},{"style":490},[3843],{"type":424,"value":1167},{"type":419,"tag":471,"props":3845,"children":3846},{"style":484},[3847],{"type":424,"value":636},{"type":419,"tag":471,"props":3849,"children":3850},{"class":473,"line":1568},[3851],{"type":419,"tag":471,"props":3852,"children":3853},{"style":663},[3854],{"type":424,"value":3855},"    // 处理剩余的换行符\n",{"type":419,"tag":471,"props":3857,"children":3858},{"class":473,"line":1600},[3859,3863,3867,3871,3875,3879,3883],{"type":419,"tag":471,"props":3860,"children":3861},{"style":569},[3862],{"type":424,"value":3359},{"type":419,"tag":471,"props":3864,"children":3865},{"style":478},[3866],{"type":424,"value":1319},{"type":419,"tag":471,"props":3868,"children":3869},{"style":484},[3870],{"type":424,"value":487},{"type":419,"tag":471,"props":3872,"children":3873},{"style":490},[3874],{"type":424,"value":1167},{"type":419,"tag":471,"props":3876,"children":3877},{"style":1364},[3878],{"type":424,"value":1478},{"type":419,"tag":471,"props":3880,"children":3881},{"style":490},[3882],{"type":424,"value":1167},{"type":419,"tag":471,"props":3884,"children":3885},{"style":484},[3886],{"type":424,"value":636},{"type":419,"tag":471,"props":3888,"children":3889},{"class":473,"line":1633},[3890,3894,3898,3902,3906,3910,3914,3918,3922],{"type":419,"tag":471,"props":3891,"children":3892},{"style":569},[3893],{"type":424,"value":3359},{"type":419,"tag":471,"props":3895,"children":3896},{"style":478},[3897],{"type":424,"value":1353},{"type":419,"tag":471,"props":3899,"children":3900},{"style":484},[3901],{"type":424,"value":487},{"type":419,"tag":471,"props":3903,"children":3904},{"style":490},[3905],{"type":424,"value":1167},{"type":419,"tag":471,"props":3907,"children":3908},{"style":1364},[3909],{"type":424,"value":1752},{"type":419,"tag":471,"props":3911,"children":3912},{"style":500},[3913],{"type":424,"value":1452},{"type":419,"tag":471,"props":3915,"children":3916},{"style":490},[3917],{"type":424,"value":1167},{"type":419,"tag":471,"props":3919,"children":3920},{"style":484},[3921],{"type":424,"value":1765},{"type":419,"tag":471,"props":3923,"children":3924},{"style":845},[3925],{"type":424,"value":1770},{"type":419,"tag":471,"props":3927,"children":3928},{"class":473,"line":1665},[3929,3933,3938,3942],{"type":419,"tag":471,"props":3930,"children":3931},{"style":490},[3932],{"type":424,"value":2840},{"type":419,"tag":471,"props":3934,"children":3935},{"style":500},[3936],{"type":424,"value":3937},"');}",{"type":419,"tag":471,"props":3939,"children":3940},{"style":490},[3941],{"type":424,"value":1167},{"type":419,"tag":471,"props":3943,"children":3944},{"style":569},[3945],{"type":424,"value":1802},{"type":419,"tag":420,"props":3947,"children":3948},{},[3949,3951,3956,3958,3963,3965,3970,3971,3977,3979,3984,3986,3991],{"type":424,"value":3950},"有一个小细节，字符串替换时，所有逻辑语句的模板标志开头和结尾（",{"type":419,"tag":435,"props":3952,"children":3954},{"className":3953},[],[3955],{"type":424,"value":1332},{"type":424,"value":3957},"、",{"type":419,"tag":435,"props":3959,"children":3961},{"className":3960},[],[3962],{"type":424,"value":1418},{"type":424,"value":3964},"）分别被替换为 ",{"type":419,"tag":435,"props":3966,"children":3968},{"className":3967},[],[3969],{"type":424,"value":1622},{"type":424,"value":3957},{"type":419,"tag":435,"props":3972,"children":3974},{"className":3973},[],[3975],{"type":424,"value":3976},"push('",{"type":424,"value":3978},"，但是开头和结尾的那个标志，并没有对应的匹配。所以在代码中，能看 ",{"type":419,"tag":435,"props":3980,"children":3982},{"className":3981},[],[3983],{"type":424,"value":1216},{"type":424,"value":3985}," 和 ",{"type":419,"tag":435,"props":3987,"children":3989},{"className":3988},[],[3990],{"type":424,"value":1622},{"type":424,"value":3992}," 这种手动补全。",{"type":419,"tag":420,"props":3994,"children":3995},{},[3996],{"type":424,"value":3997},"最终生成的字符串如下（已格式化处理）：",{"type":419,"tag":461,"props":3999,"children":4001},{"className":463,"code":4000,"language":465,"meta":413,"style":413},"`with(obj){\n    p.push(''); \n    if (true) { \n        p.push('     \u003Cli>',users[i],'\u003C/li>   '); \n    } \n    p.push('');\n}`;\n",[4002],{"type":419,"tag":435,"props":4003,"children":4004},{"__ignoreMap":413},[4005,4017,4025,4033,4041,4049,4057],{"type":419,"tag":471,"props":4006,"children":4007},{"class":473,"line":474},[4008,4012],{"type":419,"tag":471,"props":4009,"children":4010},{"style":490},[4011],{"type":424,"value":566},{"type":419,"tag":471,"props":4013,"children":4014},{"style":500},[4015],{"type":424,"value":4016},"with(obj){\n",{"type":419,"tag":471,"props":4018,"children":4019},{"class":473,"line":496},[4020],{"type":419,"tag":471,"props":4021,"children":4022},{"style":500},[4023],{"type":424,"value":4024},"    p.push(''); \n",{"type":419,"tag":471,"props":4026,"children":4027},{"class":473,"line":506},[4028],{"type":419,"tag":471,"props":4029,"children":4030},{"style":500},[4031],{"type":424,"value":4032},"    if (true) { \n",{"type":419,"tag":471,"props":4034,"children":4035},{"class":473,"line":515},[4036],{"type":419,"tag":471,"props":4037,"children":4038},{"style":500},[4039],{"type":424,"value":4040},"        p.push('     \u003Cli>',users[i],'\u003C/li>   '); \n",{"type":419,"tag":471,"props":4042,"children":4043},{"class":473,"line":524},[4044],{"type":419,"tag":471,"props":4045,"children":4046},{"style":500},[4047],{"type":424,"value":4048},"    } \n",{"type":419,"tag":471,"props":4050,"children":4051},{"class":473,"line":533},[4052],{"type":419,"tag":471,"props":4053,"children":4054},{"style":500},[4055],{"type":424,"value":4056},"    p.push('');\n",{"type":419,"tag":471,"props":4058,"children":4059},{"class":473,"line":542},[4060,4064,4068],{"type":419,"tag":471,"props":4061,"children":4062},{"style":500},[4063],{"type":424,"value":631},{"type":419,"tag":471,"props":4065,"children":4066},{"style":490},[4067],{"type":424,"value":566},{"type":419,"tag":471,"props":4069,"children":4070},{"style":569},[4071],{"type":424,"value":1802},{"type":419,"tag":420,"props":4073,"children":4074},{},[4075,4077,4083],{"type":424,"value":4076},"为什么 with 语句里有一行空的 ",{"type":419,"tag":435,"props":4078,"children":4080},{"className":4079},[],[4081],{"type":424,"value":4082},"push('')",{"type":424,"value":4084}," 呢？",{"type":419,"tag":420,"props":4086,"children":4087},{},[4088],{"type":424,"value":4089},"还记得原始的模板吗？一开的模板是以“\u003C%”开头的，而“\u003C%”在替换过程被右括号取代了，此时正好和初始字符串结合形成了空 push。如果原始字符串开头是 \"123\u003C% if (true)\"，那这行空 push 会转换成“p.push('123');”，也是正确的代码。",{"type":419,"tag":420,"props":4091,"children":4092},{},[4093],{"type":424,"value":4094},"最后，micro-templating 需要返回这个新函数。如果不传参数 data 给模板函数，则会返回一个部分应用的函数等待用户输入 data 参数再执行模板解析；如果已经传了 data 那就会立即调用返回模板解析的结果。",{"type":419,"tag":461,"props":4096,"children":4098},{"className":463,"code":4097,"language":465,"meta":413,"style":413},"(function () {\n  var cache = {};\n  this.tmpl = function tmpl(str, data) {\n    return data ? fn(data) : fn;\n  };\n})();\n",[4099],{"type":419,"tag":435,"props":4100,"children":4101},{"__ignoreMap":413},[4102,4121,4140,4191,4234,4241],{"type":419,"tag":471,"props":4103,"children":4104},{"class":473,"line":474},[4105,4109,4113,4117],{"type":419,"tag":471,"props":4106,"children":4107},{"style":484},[4108],{"type":424,"value":487},{"type":419,"tag":471,"props":4110,"children":4111},{"style":817},[4112],{"type":424,"value":820},{"type":419,"tag":471,"props":4114,"children":4115},{"style":569},[4116],{"type":424,"value":825},{"type":419,"tag":471,"props":4118,"children":4119},{"style":569},[4120],{"type":424,"value":577},{"type":419,"tag":471,"props":4122,"children":4123},{"class":473,"line":496},[4124,4128,4132,4136],{"type":419,"tag":471,"props":4125,"children":4126},{"style":817},[4127],{"type":424,"value":837},{"type":419,"tag":471,"props":4129,"children":4130},{"style":484},[4131],{"type":424,"value":842},{"type":419,"tag":471,"props":4133,"children":4134},{"style":845},[4135],{"type":424,"value":848},{"type":419,"tag":471,"props":4137,"children":4138},{"style":569},[4139],{"type":424,"value":853},{"type":419,"tag":471,"props":4141,"children":4142},{"class":473,"line":506},[4143,4147,4151,4155,4159,4163,4167,4171,4175,4179,4183,4187],{"type":419,"tag":471,"props":4144,"children":4145},{"style":868},[4146],{"type":424,"value":871},{"type":419,"tag":471,"props":4148,"children":4149},{"style":569},[4150],{"type":424,"value":876},{"type":419,"tag":471,"props":4152,"children":4153},{"style":478},[4154],{"type":424,"value":881},{"type":419,"tag":471,"props":4156,"children":4157},{"style":845},[4158],{"type":424,"value":848},{"type":419,"tag":471,"props":4160,"children":4161},{"style":817},[4162],{"type":424,"value":890},{"type":419,"tag":471,"props":4164,"children":4165},{"style":478},[4166],{"type":424,"value":895},{"type":419,"tag":471,"props":4168,"children":4169},{"style":569},[4170],{"type":424,"value":487},{"type":419,"tag":471,"props":4172,"children":4173},{"style":902},[4174],{"type":424,"value":905},{"type":419,"tag":471,"props":4176,"children":4177},{"style":569},[4178],{"type":424,"value":572},{"type":419,"tag":471,"props":4180,"children":4181},{"style":902},[4182],{"type":424,"value":914},{"type":419,"tag":471,"props":4184,"children":4185},{"style":569},[4186],{"type":424,"value":919},{"type":419,"tag":471,"props":4188,"children":4189},{"style":569},[4190],{"type":424,"value":577},{"type":419,"tag":471,"props":4192,"children":4193},{"class":473,"line":515},[4194,4198,4202,4206,4210,4214,4218,4222,4226,4230],{"type":419,"tag":471,"props":4195,"children":4196},{"style":1404},[4197],{"type":424,"value":1828},{"type":419,"tag":471,"props":4199,"children":4200},{"style":484},[4201],{"type":424,"value":914},{"type":419,"tag":471,"props":4203,"children":4204},{"style":845},[4205],{"type":424,"value":1837},{"type":419,"tag":471,"props":4207,"children":4208},{"style":478},[4209],{"type":424,"value":952},{"type":419,"tag":471,"props":4211,"children":4212},{"style":584},[4213],{"type":424,"value":487},{"type":419,"tag":471,"props":4215,"children":4216},{"style":484},[4217],{"type":424,"value":1850},{"type":419,"tag":471,"props":4219,"children":4220},{"style":584},[4221],{"type":424,"value":1765},{"type":419,"tag":471,"props":4223,"children":4224},{"style":845},[4225],{"type":424,"value":592},{"type":419,"tag":471,"props":4227,"children":4228},{"style":484},[4229],{"type":424,"value":952},{"type":419,"tag":471,"props":4231,"children":4232},{"style":569},[4233],{"type":424,"value":1802},{"type":419,"tag":471,"props":4235,"children":4236},{"class":473,"line":524},[4237],{"type":419,"tag":471,"props":4238,"children":4239},{"style":569},[4240],{"type":424,"value":1875},{"type":419,"tag":471,"props":4242,"children":4243},{"class":473,"line":533},[4244,4248,4252],{"type":419,"tag":471,"props":4245,"children":4246},{"style":569},[4247],{"type":424,"value":631},{"type":419,"tag":471,"props":4249,"children":4250},{"style":484},[4251],{"type":424,"value":1888},{"type":419,"tag":471,"props":4253,"children":4254},{"style":569},[4255],{"type":424,"value":1802},{"type":419,"tag":420,"props":4257,"children":4258},{},[4259],{"type":424,"value":4260},"终于结束了！这个函数不长，但一口气看下来还是蛮费力气的。如果一遍写测试用例以便看代码，很快能把这个函数跑通，如果你是纯靠脑力跑，还没被那个长长的字符串替换链给吓住，在此我赐你称号：“Micro Templating 人肉编译器 - 十五周年限定版”。",{"type":419,"tag":420,"props":4262,"children":4263},{},[4264,4266,4273,4275,4280],{"type":424,"value":4265},"额外提一句，Function 构造器和 eval 函数比，除了能传参数意外，还有一些细节不同，比如说声明变量的作用域不同，这个需要注意。这个编译器没有错误处理等代码完善，因此不可以上生产。此外，由于 ",{"type":419,"tag":427,"props":4267,"children":4271},{"href":4268,"rel":4269},"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/with",[4270],"nofollow",[4272],{"type":424,"value":2944},{"type":424,"value":4274}," 语句非常容易出错，且不利于静态优化，不应该在业务函数里使用",{"type":419,"tag":471,"props":4276,"children":4277},{},[4278],{"type":424,"value":4279},"^with-mdn",{"type":424,"value":4281},"。最后，阅读源码需要技巧，这几点希望能帮助到你：",{"type":419,"tag":3118,"props":4283,"children":4284},{},[4285,4290,4295,4300],{"type":419,"tag":3122,"props":4286,"children":4287},{},[4288],{"type":424,"value":4289},"从注释、测试用例，先搞清楚要看的代码的作用",{"type":419,"tag":3122,"props":4291,"children":4292},{},[4293],{"type":424,"value":4294},"使用编辑器的折叠代码，一次只看一部分源码",{"type":419,"tag":3122,"props":4296,"children":4297},{},[4298],{"type":424,"value":4299},"在 Git 提交记录中搜索，从简单的版本看起",{"type":419,"tag":3122,"props":4301,"children":4302},{},[4303],{"type":424,"value":4304},"复杂代码应该从高层结构看起，比如使用 IDE 各种插件或是 Madge 等代码分析工具",{"type":419,"tag":775,"props":4306,"children":4308},{"id":4307},"相关链接",[4309],{"type":424,"value":4307},{"type":419,"tag":3118,"props":4311,"children":4312},{},[4313],{"type":419,"tag":3122,"props":4314,"children":4315},{},[4316],{"type":419,"tag":427,"props":4317,"children":4320},{"href":4318,"rel":4319},"https://johnresig.com/blog/javascript-micro-templating/",[4270],[4321],{"type":424,"value":4322},"JavaScript Micro-Templating",{"type":419,"tag":4324,"props":4325,"children":4326},"style",{},[4327],{"type":424,"value":4328},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":413,"searchDepth":496,"depth":496,"links":4330},[4331,4332,4333],{"id":777,"depth":496,"text":777},{"id":1900,"depth":496,"text":1900},{"id":4307,"depth":496,"text":4307},"markdown","content:2.articles:1100.micro-templating.md","content","2.articles/1100.micro-templating.md","2.articles/1100.micro-templating","md",[4341,4343],{"_path":40,"title":39,"description":4342},"沉浸式翻译太贵辽，试试本地部署 LLM 用来翻译网页的可行性。",{"_path":46,"title":45,"description":4344},"我的项目使用 micro-app 框架作为微前端框架。使用 micro-app 时，由于开启了样式隔离功能，子应用加载的 CSS 会被解析器解析，在选择器前增加一个子应用属性选择器前缀。我碰到的问题是，如果 CSS 源码中带嵌套语法那么解析就会失败。今天借这个问题给大家简单介绍一下 CSS Parser 的基本流程。",1732808103708]