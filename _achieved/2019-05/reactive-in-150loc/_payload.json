[{"data":1,"prerenderedAt":5655},["ShallowReactive",2],{"navigation":3,"/_achieved/2019-05/reactive-in-150loc":158,"/_achieved/2019-05/reactive-in-150loc-surround":5648},[4,35,89,95,122,128,152],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83,86],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🌪️ tailwind4 如何兼容预处理器","/articles/tailwind4-with-sass",{"title":45,"_path":46},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":48,"_path":49},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":51,"_path":52},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":54,"_path":55},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":57,"_path":58},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":60,"_path":61},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":63,"_path":64},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":66,"_path":67},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":69,"_path":70},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":72,"_path":73},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":75,"_path":76},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":78,"_path":79},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":81,"_path":82},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":84,"_path":85},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":87,"_path":88},"📝 技术博客归档","/articles/archive",{"title":90,"_path":91,"children":92},"读书笔记 / Notes","/books",[93],{"title":94,"_path":91},"📕 读书笔记",{"title":96,"_path":97,"children":98},"吉他剧场 / Music","/music",[99,101,104,107,110,113,116,119],{"title":100,"_path":97},"🎸 FingerStyle！",{"title":102,"_path":103},"🌬️ 等待的风","/music/wind",{"title":105,"_path":106},"💕 约定的海洋","/music/ocean",{"title":108,"_path":109},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":111,"_path":112},"🌏 残酷天使的行动纲领","/music/eva",{"title":114,"_path":115},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":117,"_path":118},"🍷 Wu Wei","/music/wu-wei",{"title":120,"_path":121},"🌅 无题","/music/untitled",{"title":123,"_path":124,"children":125},"知识地图 / Maps","/maps",[126],{"title":127,"_path":124},"🏁 知识地图",{"title":129,"_path":130,"children":131},"造物 / Make","/tools",[132,134,137,140,143,146,149],{"title":133,"_path":130},"🧰 工具收集",{"title":135,"_path":136},"📕 博客","/tools/blog",{"title":138,"_path":139},"🥥 Coconut","/tools/coconut",{"title":141,"_path":142},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":144,"_path":145},"🌐 AnySort","/tools/anysort",{"title":147,"_path":148},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":150,"_path":151},"👓 Crapto","/tools/crypto-inline",{"title":153,"_path":154,"children":155},"我 / About","/hire",[156],{"title":157,"_path":154},"📬 技术简历",{"_path":159,"_dir":160,"_draft":161,"_partial":162,"_locale":163,"title":164,"description":165,"body":166,"_type":5642,"_id":5643,"_source":5644,"_file":5645,"_stem":5646,"_extension":5647},"/_achieved/2019-05/reactive-in-150loc","2019-05",false,true,"","🚀 150 行代码带你实现小程序中的数据侦听","本文介绍了在 150 行代码内使用 defineProperty 实现一个简单的拥有事件发布订阅能力的状态管理库的思路。",{"type":167,"children":168,"toc":5620},"root",[169,177,192,197,476,488,493,498,503,508,521,802,815,820,827,839,1093,1098,1481,1486,1491,1496,1653,1795,1800,1806,1811,1816,1825,1830,1838,1844,1849,2105,2110,2115,2588,2593,2622,3397,3403,3416,3752,3765,3778,4300,4305,4310,4315,4320,4333,4849,4854,4860,4865,4870,5094,5100,5105,5325,5449,5461,5591,5596,5601,5614],{"type":170,"tag":171,"props":172,"children":174},"element","h2",{"id":173},"前言",[175],{"type":176,"value":173},"text",{"type":170,"tag":178,"props":179,"children":180},"p",{},[181,183,190],{"type":176,"value":182},"在小程序项目中, 我们的通常会使用到使用到一个全局对象作为各个页面通用的数据存储容器, 将它绑定到 app 对象后, 就能在每一个页面都自由的操纵这个对象. 然而在实践中, 由于这个对象及其属性不具备响应式条件, 它不能直接参与业务逻辑的编写, 能力仅仅局限于数据储存. 若是在 VueJS 项目中, 我们可能经常使用到",{"type":170,"tag":184,"props":185,"children":187},"code",{"className":186},[],[188],{"type":176,"value":189},"Vue.$watch",{"type":176,"value":191},"去侦听某个数据是否发生变化, 小程序却缺乏这种能力.",{"type":170,"tag":178,"props":193,"children":194},{},[195],{"type":176,"value":196},"在这篇文章中, 我将用 150 行代码, 手把手带你打造一个小程序也可以使用的侦听器(下简称 VX):",{"type":170,"tag":198,"props":199,"children":203},"pre",{"className":200,"code":201,"language":202,"meta":163,"style":163},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","// 一个快速赋值的语法糖函数, 可以创建结构为 { value: a { b: { val: ''} } } 的对象\nvx.set('value.a.d', { val: '' })\n// 对某个属性进行侦听, 如果发生改变, 则执行相应函数(可多次watch以执行多个函数)\nvx.watch('value.a.d.val', newVal => {\n  console.log(`val改变为 : `, newVal)\n})\nvalue.a.d.val = 3 // val改编为 : 3\n","js",[204],{"type":170,"tag":184,"props":205,"children":206},{"__ignoreMap":163},[207,219,298,307,362,410,423],{"type":170,"tag":208,"props":209,"children":212},"span",{"class":210,"line":211},"line",1,[213],{"type":170,"tag":208,"props":214,"children":216},{"style":215},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[217],{"type":176,"value":218},"// 一个快速赋值的语法糖函数, 可以创建结构为 { value: a { b: { val: ''} } } 的对象\n",{"type":170,"tag":208,"props":220,"children":222},{"class":210,"line":221},2,[223,229,235,241,246,252,258,262,267,272,278,283,288,293],{"type":170,"tag":208,"props":224,"children":226},{"style":225},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[227],{"type":176,"value":228},"vx",{"type":170,"tag":208,"props":230,"children":232},{"style":231},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[233],{"type":176,"value":234},".",{"type":170,"tag":208,"props":236,"children":238},{"style":237},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[239],{"type":176,"value":240},"set",{"type":170,"tag":208,"props":242,"children":243},{"style":225},[244],{"type":176,"value":245},"(",{"type":170,"tag":208,"props":247,"children":249},{"style":248},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[250],{"type":176,"value":251},"'",{"type":170,"tag":208,"props":253,"children":255},{"style":254},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[256],{"type":176,"value":257},"value.a.d",{"type":170,"tag":208,"props":259,"children":260},{"style":248},[261],{"type":176,"value":251},{"type":170,"tag":208,"props":263,"children":264},{"style":231},[265],{"type":176,"value":266},",",{"type":170,"tag":208,"props":268,"children":269},{"style":231},[270],{"type":176,"value":271}," {",{"type":170,"tag":208,"props":273,"children":275},{"style":274},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[276],{"type":176,"value":277}," val",{"type":170,"tag":208,"props":279,"children":280},{"style":231},[281],{"type":176,"value":282},":",{"type":170,"tag":208,"props":284,"children":285},{"style":248},[286],{"type":176,"value":287}," ''",{"type":170,"tag":208,"props":289,"children":290},{"style":231},[291],{"type":176,"value":292}," }",{"type":170,"tag":208,"props":294,"children":295},{"style":225},[296],{"type":176,"value":297},")\n",{"type":170,"tag":208,"props":299,"children":301},{"class":210,"line":300},3,[302],{"type":170,"tag":208,"props":303,"children":304},{"style":215},[305],{"type":176,"value":306},"// 对某个属性进行侦听, 如果发生改变, 则执行相应函数(可多次watch以执行多个函数)\n",{"type":170,"tag":208,"props":308,"children":310},{"class":210,"line":309},4,[311,315,319,324,328,332,337,341,345,351,357],{"type":170,"tag":208,"props":312,"children":313},{"style":225},[314],{"type":176,"value":228},{"type":170,"tag":208,"props":316,"children":317},{"style":231},[318],{"type":176,"value":234},{"type":170,"tag":208,"props":320,"children":321},{"style":237},[322],{"type":176,"value":323},"watch",{"type":170,"tag":208,"props":325,"children":326},{"style":225},[327],{"type":176,"value":245},{"type":170,"tag":208,"props":329,"children":330},{"style":248},[331],{"type":176,"value":251},{"type":170,"tag":208,"props":333,"children":334},{"style":254},[335],{"type":176,"value":336},"value.a.d.val",{"type":170,"tag":208,"props":338,"children":339},{"style":248},[340],{"type":176,"value":251},{"type":170,"tag":208,"props":342,"children":343},{"style":231},[344],{"type":176,"value":266},{"type":170,"tag":208,"props":346,"children":348},{"style":347},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[349],{"type":176,"value":350}," newVal",{"type":170,"tag":208,"props":352,"children":354},{"style":353},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[355],{"type":176,"value":356}," =>",{"type":170,"tag":208,"props":358,"children":359},{"style":231},[360],{"type":176,"value":361}," {\n",{"type":170,"tag":208,"props":363,"children":365},{"class":210,"line":364},5,[366,371,375,380,384,389,394,398,402,406],{"type":170,"tag":208,"props":367,"children":368},{"style":225},[369],{"type":176,"value":370},"  console",{"type":170,"tag":208,"props":372,"children":373},{"style":231},[374],{"type":176,"value":234},{"type":170,"tag":208,"props":376,"children":377},{"style":237},[378],{"type":176,"value":379},"log",{"type":170,"tag":208,"props":381,"children":382},{"style":274},[383],{"type":176,"value":245},{"type":170,"tag":208,"props":385,"children":386},{"style":248},[387],{"type":176,"value":388},"`",{"type":170,"tag":208,"props":390,"children":391},{"style":254},[392],{"type":176,"value":393},"val改变为 : ",{"type":170,"tag":208,"props":395,"children":396},{"style":248},[397],{"type":176,"value":388},{"type":170,"tag":208,"props":399,"children":400},{"style":231},[401],{"type":176,"value":266},{"type":170,"tag":208,"props":403,"children":404},{"style":225},[405],{"type":176,"value":350},{"type":170,"tag":208,"props":407,"children":408},{"style":274},[409],{"type":176,"value":297},{"type":170,"tag":208,"props":411,"children":413},{"class":210,"line":412},6,[414,419],{"type":170,"tag":208,"props":415,"children":416},{"style":231},[417],{"type":176,"value":418},"}",{"type":170,"tag":208,"props":420,"children":421},{"style":225},[422],{"type":176,"value":297},{"type":170,"tag":208,"props":424,"children":426},{"class":210,"line":425},7,[427,432,436,441,445,450,454,459,465,471],{"type":170,"tag":208,"props":428,"children":429},{"style":225},[430],{"type":176,"value":431},"value",{"type":170,"tag":208,"props":433,"children":434},{"style":231},[435],{"type":176,"value":234},{"type":170,"tag":208,"props":437,"children":438},{"style":225},[439],{"type":176,"value":440},"a",{"type":170,"tag":208,"props":442,"children":443},{"style":231},[444],{"type":176,"value":234},{"type":170,"tag":208,"props":446,"children":447},{"style":225},[448],{"type":176,"value":449},"d",{"type":170,"tag":208,"props":451,"children":452},{"style":231},[453],{"type":176,"value":234},{"type":170,"tag":208,"props":455,"children":456},{"style":225},[457],{"type":176,"value":458},"val ",{"type":170,"tag":208,"props":460,"children":462},{"style":461},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[463],{"type":176,"value":464},"=",{"type":170,"tag":208,"props":466,"children":468},{"style":467},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[469],{"type":176,"value":470}," 3",{"type":170,"tag":208,"props":472,"children":473},{"style":215},[474],{"type":176,"value":475}," // val改编为 : 3\n",{"type":170,"tag":178,"props":477,"children":478},{},[479,481,486],{"type":176,"value":480},"使用 VX 侦听器, 我们可以更加方便的管理各个页面的状态. 同时, 我们凭借",{"type":170,"tag":184,"props":482,"children":484},{"className":483},[],[485],{"type":176,"value":323},{"type":176,"value":487},"语法, 可以更优雅地编写业务逻辑.",{"type":170,"tag":178,"props":489,"children":490},{},[491],{"type":176,"value":492},"坐稳了, 三轮车准备启动了~ 各位评论见~ 😋",{"type":170,"tag":171,"props":494,"children":496},{"id":495},"稍微理一理思路",[497],{"type":176,"value":495},{"type":170,"tag":178,"props":499,"children":500},{},[501],{"type":176,"value":502},"在全局对象中, 我们不一定要对每一个属性都进行侦听, 所以 VX 主要的功能就是通过 set 去设置某个具体属性的 setter/getter, 同时通过 watch 向添加该属性添加需要订阅的回调函数.",{"type":170,"tag":171,"props":504,"children":506},{"id":505},"依赖对象的实现",[507],{"type":176,"value":505},{"type":170,"tag":178,"props":509,"children":510},{},[511,513,519],{"type":176,"value":512},"首先我们需要造一个通用的",{"type":170,"tag":514,"props":515,"children":516},"strong",{},[517],{"type":176,"value":518},"依赖对象",{"type":176,"value":520},", 依赖对象携带一个订阅数组用于存放一组回调函数, 同时它还应该包括一些操作订阅数组能力(如添加订阅, 清空订阅)的函数",{"type":170,"tag":198,"props":522,"children":524},{"className":200,"code":523,"language":202,"meta":163,"style":163},"class Dep {\n  constructor () {\n    this.subs = []\n  }\n  // 将回调添加到数组中\n  addSub (fn) { /*...*/ }\n  delSub (fn) { /*...*/ }\n  // 执行数组中每一项函数\n  notify (newVal, oldVal) {\n    this.subs.forEach(func => func(newVal, oldVal))\n  }\n}\n",[525],{"type":170,"tag":184,"props":526,"children":527},{"__ignoreMap":163},[528,546,563,591,599,607,645,677,686,721,785,793],{"type":170,"tag":208,"props":529,"children":530},{"class":210,"line":211},[531,536,542],{"type":170,"tag":208,"props":532,"children":533},{"style":353},[534],{"type":176,"value":535},"class",{"type":170,"tag":208,"props":537,"children":539},{"style":538},"--shiki-light:#E2931D;--shiki-light-text-decoration:inherit;--shiki-default:#6F42C1;--shiki-default-text-decoration:inherit;--shiki-dark:#B392F0;--shiki-dark-text-decoration:inherit;--shiki-sepia:#A6E22E;--shiki-sepia-text-decoration:underline",[540],{"type":176,"value":541}," Dep",{"type":170,"tag":208,"props":543,"children":544},{"style":231},[545],{"type":176,"value":361},{"type":170,"tag":208,"props":547,"children":548},{"class":210,"line":221},[549,554,559],{"type":170,"tag":208,"props":550,"children":551},{"style":353},[552],{"type":176,"value":553},"  constructor",{"type":170,"tag":208,"props":555,"children":556},{"style":231},[557],{"type":176,"value":558}," ()",{"type":170,"tag":208,"props":560,"children":561},{"style":231},[562],{"type":176,"value":361},{"type":170,"tag":208,"props":564,"children":565},{"class":210,"line":300},[566,572,576,581,586],{"type":170,"tag":208,"props":567,"children":569},{"style":568},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[570],{"type":176,"value":571},"    this",{"type":170,"tag":208,"props":573,"children":574},{"style":231},[575],{"type":176,"value":234},{"type":170,"tag":208,"props":577,"children":578},{"style":225},[579],{"type":176,"value":580},"subs",{"type":170,"tag":208,"props":582,"children":583},{"style":461},[584],{"type":176,"value":585}," =",{"type":170,"tag":208,"props":587,"children":588},{"style":274},[589],{"type":176,"value":590}," []\n",{"type":170,"tag":208,"props":592,"children":593},{"class":210,"line":309},[594],{"type":170,"tag":208,"props":595,"children":596},{"style":231},[597],{"type":176,"value":598},"  }\n",{"type":170,"tag":208,"props":600,"children":601},{"class":210,"line":364},[602],{"type":170,"tag":208,"props":603,"children":604},{"style":215},[605],{"type":176,"value":606},"  // 将回调添加到数组中\n",{"type":170,"tag":208,"props":608,"children":609},{"class":210,"line":412},[610,616,621,626,631,635,640],{"type":170,"tag":208,"props":611,"children":613},{"style":612},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[614],{"type":176,"value":615},"  addSub",{"type":170,"tag":208,"props":617,"children":618},{"style":231},[619],{"type":176,"value":620}," (",{"type":170,"tag":208,"props":622,"children":623},{"style":347},[624],{"type":176,"value":625},"fn",{"type":170,"tag":208,"props":627,"children":628},{"style":231},[629],{"type":176,"value":630},")",{"type":170,"tag":208,"props":632,"children":633},{"style":231},[634],{"type":176,"value":271},{"type":170,"tag":208,"props":636,"children":637},{"style":215},[638],{"type":176,"value":639}," /*...*/",{"type":170,"tag":208,"props":641,"children":642},{"style":231},[643],{"type":176,"value":644}," }\n",{"type":170,"tag":208,"props":646,"children":647},{"class":210,"line":425},[648,653,657,661,665,669,673],{"type":170,"tag":208,"props":649,"children":650},{"style":612},[651],{"type":176,"value":652},"  delSub",{"type":170,"tag":208,"props":654,"children":655},{"style":231},[656],{"type":176,"value":620},{"type":170,"tag":208,"props":658,"children":659},{"style":347},[660],{"type":176,"value":625},{"type":170,"tag":208,"props":662,"children":663},{"style":231},[664],{"type":176,"value":630},{"type":170,"tag":208,"props":666,"children":667},{"style":231},[668],{"type":176,"value":271},{"type":170,"tag":208,"props":670,"children":671},{"style":215},[672],{"type":176,"value":639},{"type":170,"tag":208,"props":674,"children":675},{"style":231},[676],{"type":176,"value":644},{"type":170,"tag":208,"props":678,"children":680},{"class":210,"line":679},8,[681],{"type":170,"tag":208,"props":682,"children":683},{"style":215},[684],{"type":176,"value":685},"  // 执行数组中每一项函数\n",{"type":170,"tag":208,"props":687,"children":689},{"class":210,"line":688},9,[690,695,699,704,708,713,717],{"type":170,"tag":208,"props":691,"children":692},{"style":612},[693],{"type":176,"value":694},"  notify",{"type":170,"tag":208,"props":696,"children":697},{"style":231},[698],{"type":176,"value":620},{"type":170,"tag":208,"props":700,"children":701},{"style":347},[702],{"type":176,"value":703},"newVal",{"type":170,"tag":208,"props":705,"children":706},{"style":231},[707],{"type":176,"value":266},{"type":170,"tag":208,"props":709,"children":710},{"style":347},[711],{"type":176,"value":712}," oldVal",{"type":170,"tag":208,"props":714,"children":715},{"style":231},[716],{"type":176,"value":630},{"type":170,"tag":208,"props":718,"children":719},{"style":231},[720],{"type":176,"value":361},{"type":170,"tag":208,"props":722,"children":724},{"class":210,"line":723},10,[725,729,733,737,741,746,750,755,759,764,768,772,776,780],{"type":170,"tag":208,"props":726,"children":727},{"style":568},[728],{"type":176,"value":571},{"type":170,"tag":208,"props":730,"children":731},{"style":231},[732],{"type":176,"value":234},{"type":170,"tag":208,"props":734,"children":735},{"style":225},[736],{"type":176,"value":580},{"type":170,"tag":208,"props":738,"children":739},{"style":231},[740],{"type":176,"value":234},{"type":170,"tag":208,"props":742,"children":743},{"style":237},[744],{"type":176,"value":745},"forEach",{"type":170,"tag":208,"props":747,"children":748},{"style":274},[749],{"type":176,"value":245},{"type":170,"tag":208,"props":751,"children":752},{"style":347},[753],{"type":176,"value":754},"func",{"type":170,"tag":208,"props":756,"children":757},{"style":353},[758],{"type":176,"value":356},{"type":170,"tag":208,"props":760,"children":761},{"style":237},[762],{"type":176,"value":763}," func",{"type":170,"tag":208,"props":765,"children":766},{"style":274},[767],{"type":176,"value":245},{"type":170,"tag":208,"props":769,"children":770},{"style":225},[771],{"type":176,"value":703},{"type":170,"tag":208,"props":773,"children":774},{"style":231},[775],{"type":176,"value":266},{"type":170,"tag":208,"props":777,"children":778},{"style":225},[779],{"type":176,"value":712},{"type":170,"tag":208,"props":781,"children":782},{"style":274},[783],{"type":176,"value":784},"))\n",{"type":170,"tag":208,"props":786,"children":788},{"class":210,"line":787},11,[789],{"type":170,"tag":208,"props":790,"children":791},{"style":231},[792],{"type":176,"value":598},{"type":170,"tag":208,"props":794,"children":796},{"class":210,"line":795},12,[797],{"type":170,"tag":208,"props":798,"children":799},{"style":231},[800],{"type":176,"value":801},"}\n",{"type":170,"tag":178,"props":803,"children":804},{},[805,807,813],{"type":176,"value":806},"全局对象中每一个响应式属性(及其每一个子属性), 都应该和一个新的 Dep 实例保持一一对应的关系, 这样我们进行侦听变化, 执行订阅的回调函数时, 只需要找到对应的实例执行",{"type":170,"tag":184,"props":808,"children":810},{"className":809},[],[811],{"type":176,"value":812},"notify",{"type":176,"value":814},"通知更新即可.",{"type":170,"tag":171,"props":816,"children":818},{"id":817},"设置响应式属性",[819],{"type":176,"value":817},{"type":170,"tag":821,"props":822,"children":824},"h3",{"id":823},"defineproperty",[825],{"type":176,"value":826},"defineProperty",{"type":170,"tag":178,"props":828,"children":829},{},[830,832,837],{"type":176,"value":831},"可能是因为接触 DefineProperty 要比接触 Proxy 早一些的缘故, 代码使用了前者进行响应式的实现, Object.defineProperty 方法会直接在一个对象上定义一个新属性, 这里快速过一遍",{"type":170,"tag":184,"props":833,"children":835},{"className":834},[],[836],{"type":176,"value":826},{"type":176,"value":838},"具体配置:",{"type":170,"tag":198,"props":840,"children":842},{"className":200,"code":841,"language":202,"meta":163,"style":163},"// @param obj 要在其上定义属性的对象\n// @param key 要定义或修改的属性的名称\nObject.defineProperty(obj, key, {\n  // 该属性是否能被枚举\n  enumerable: true,\n  // 该属性能否被删除\n  configurable: true,\n  // 访问该属性则会执行此方法\n  get: () => {\n    return val\n  },\n  // 修改该属性时会执行此方法\n  set: newVal => {\n    val = newVal\n  },\n  // value & writeble 不能和 getter/setter 同时出现\n})\n",[843],{"type":170,"tag":184,"props":844,"children":845},{"__ignoreMap":163},[846,854,862,900,908,931,939,959,967,991,1005,1013,1021,1046,1064,1072,1081],{"type":170,"tag":208,"props":847,"children":848},{"class":210,"line":211},[849],{"type":170,"tag":208,"props":850,"children":851},{"style":215},[852],{"type":176,"value":853},"// @param obj 要在其上定义属性的对象\n",{"type":170,"tag":208,"props":855,"children":856},{"class":210,"line":221},[857],{"type":170,"tag":208,"props":858,"children":859},{"style":215},[860],{"type":176,"value":861},"// @param key 要定义或修改的属性的名称\n",{"type":170,"tag":208,"props":863,"children":864},{"class":210,"line":300},[865,870,874,878,883,887,892,896],{"type":170,"tag":208,"props":866,"children":867},{"style":225},[868],{"type":176,"value":869},"Object",{"type":170,"tag":208,"props":871,"children":872},{"style":231},[873],{"type":176,"value":234},{"type":170,"tag":208,"props":875,"children":876},{"style":237},[877],{"type":176,"value":826},{"type":170,"tag":208,"props":879,"children":880},{"style":225},[881],{"type":176,"value":882},"(obj",{"type":170,"tag":208,"props":884,"children":885},{"style":231},[886],{"type":176,"value":266},{"type":170,"tag":208,"props":888,"children":889},{"style":225},[890],{"type":176,"value":891}," key",{"type":170,"tag":208,"props":893,"children":894},{"style":231},[895],{"type":176,"value":266},{"type":170,"tag":208,"props":897,"children":898},{"style":231},[899],{"type":176,"value":361},{"type":170,"tag":208,"props":901,"children":902},{"class":210,"line":309},[903],{"type":170,"tag":208,"props":904,"children":905},{"style":215},[906],{"type":176,"value":907},"  // 该属性是否能被枚举\n",{"type":170,"tag":208,"props":909,"children":910},{"class":210,"line":364},[911,916,920,926],{"type":170,"tag":208,"props":912,"children":913},{"style":274},[914],{"type":176,"value":915},"  enumerable",{"type":170,"tag":208,"props":917,"children":918},{"style":231},[919],{"type":176,"value":282},{"type":170,"tag":208,"props":921,"children":923},{"style":922},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[924],{"type":176,"value":925}," true",{"type":170,"tag":208,"props":927,"children":928},{"style":231},[929],{"type":176,"value":930},",\n",{"type":170,"tag":208,"props":932,"children":933},{"class":210,"line":412},[934],{"type":170,"tag":208,"props":935,"children":936},{"style":215},[937],{"type":176,"value":938},"  // 该属性能否被删除\n",{"type":170,"tag":208,"props":940,"children":941},{"class":210,"line":425},[942,947,951,955],{"type":170,"tag":208,"props":943,"children":944},{"style":274},[945],{"type":176,"value":946},"  configurable",{"type":170,"tag":208,"props":948,"children":949},{"style":231},[950],{"type":176,"value":282},{"type":170,"tag":208,"props":952,"children":953},{"style":922},[954],{"type":176,"value":925},{"type":170,"tag":208,"props":956,"children":957},{"style":231},[958],{"type":176,"value":930},{"type":170,"tag":208,"props":960,"children":961},{"class":210,"line":679},[962],{"type":170,"tag":208,"props":963,"children":964},{"style":215},[965],{"type":176,"value":966},"  // 访问该属性则会执行此方法\n",{"type":170,"tag":208,"props":968,"children":969},{"class":210,"line":688},[970,975,979,983,987],{"type":170,"tag":208,"props":971,"children":972},{"style":237},[973],{"type":176,"value":974},"  get",{"type":170,"tag":208,"props":976,"children":977},{"style":231},[978],{"type":176,"value":282},{"type":170,"tag":208,"props":980,"children":981},{"style":231},[982],{"type":176,"value":558},{"type":170,"tag":208,"props":984,"children":985},{"style":353},[986],{"type":176,"value":356},{"type":170,"tag":208,"props":988,"children":989},{"style":231},[990],{"type":176,"value":361},{"type":170,"tag":208,"props":992,"children":993},{"class":210,"line":723},[994,1000],{"type":170,"tag":208,"props":995,"children":997},{"style":996},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[998],{"type":176,"value":999},"    return",{"type":170,"tag":208,"props":1001,"children":1002},{"style":225},[1003],{"type":176,"value":1004}," val\n",{"type":170,"tag":208,"props":1006,"children":1007},{"class":210,"line":787},[1008],{"type":170,"tag":208,"props":1009,"children":1010},{"style":231},[1011],{"type":176,"value":1012},"  },\n",{"type":170,"tag":208,"props":1014,"children":1015},{"class":210,"line":795},[1016],{"type":170,"tag":208,"props":1017,"children":1018},{"style":215},[1019],{"type":176,"value":1020},"  // 修改该属性时会执行此方法\n",{"type":170,"tag":208,"props":1022,"children":1024},{"class":210,"line":1023},13,[1025,1030,1034,1038,1042],{"type":170,"tag":208,"props":1026,"children":1027},{"style":237},[1028],{"type":176,"value":1029},"  set",{"type":170,"tag":208,"props":1031,"children":1032},{"style":231},[1033],{"type":176,"value":282},{"type":170,"tag":208,"props":1035,"children":1036},{"style":347},[1037],{"type":176,"value":350},{"type":170,"tag":208,"props":1039,"children":1040},{"style":353},[1041],{"type":176,"value":356},{"type":170,"tag":208,"props":1043,"children":1044},{"style":231},[1045],{"type":176,"value":361},{"type":170,"tag":208,"props":1047,"children":1049},{"class":210,"line":1048},14,[1050,1055,1059],{"type":170,"tag":208,"props":1051,"children":1052},{"style":225},[1053],{"type":176,"value":1054},"    val",{"type":170,"tag":208,"props":1056,"children":1057},{"style":461},[1058],{"type":176,"value":585},{"type":170,"tag":208,"props":1060,"children":1061},{"style":225},[1062],{"type":176,"value":1063}," newVal\n",{"type":170,"tag":208,"props":1065,"children":1067},{"class":210,"line":1066},15,[1068],{"type":170,"tag":208,"props":1069,"children":1070},{"style":231},[1071],{"type":176,"value":1012},{"type":170,"tag":208,"props":1073,"children":1075},{"class":210,"line":1074},16,[1076],{"type":170,"tag":208,"props":1077,"children":1078},{"style":215},[1079],{"type":176,"value":1080},"  // value & writeble 不能和 getter/setter 同时出现\n",{"type":170,"tag":208,"props":1082,"children":1084},{"class":210,"line":1083},17,[1085,1089],{"type":170,"tag":208,"props":1086,"children":1087},{"style":231},[1088],{"type":176,"value":418},{"type":170,"tag":208,"props":1090,"children":1091},{"style":225},[1092],{"type":176,"value":297},{"type":170,"tag":178,"props":1094,"children":1095},{},[1096],{"type":176,"value":1097},"通过对 defineProperty 进行上层封装, 我们可以轻松的实现在全局对象上设置响应式属性功能, 在此, 我们结合刚才定义的 Dep 对象, 将一个新的 dep 实例绑定到新增属性的 setter 中:",{"type":170,"tag":198,"props":1099,"children":1101},{"className":200,"code":1100,"language":202,"meta":163,"style":163},"set (key, val, options = {}, obj = this.store) {\n  const dep = new Dep()\n  Object.defineProperty(obj, key, {\n    enumerable: true,\n    configurable: true,\n    get: () => {\n      return val\n    },\n    set: newVal => {\n      if (newVal === val) {\n        return\n      }\n      dep.notify(newVal, val)\n      val = newVal\n    }\n  })\n}\n",[1102],{"type":170,"tag":184,"props":1103,"children":1104},{"__ignoreMap":163},[1105,1171,1203,1244,1264,1284,1308,1320,1328,1352,1386,1394,1402,1438,1454,1462,1474],{"type":170,"tag":208,"props":1106,"children":1107},{"class":210,"line":211},[1108,1112,1117,1121,1125,1129,1134,1138,1143,1148,1152,1157,1161,1166],{"type":170,"tag":208,"props":1109,"children":1110},{"style":237},[1111],{"type":176,"value":240},{"type":170,"tag":208,"props":1113,"children":1114},{"style":225},[1115],{"type":176,"value":1116}," (key",{"type":170,"tag":208,"props":1118,"children":1119},{"style":231},[1120],{"type":176,"value":266},{"type":170,"tag":208,"props":1122,"children":1123},{"style":225},[1124],{"type":176,"value":277},{"type":170,"tag":208,"props":1126,"children":1127},{"style":231},[1128],{"type":176,"value":266},{"type":170,"tag":208,"props":1130,"children":1131},{"style":225},[1132],{"type":176,"value":1133}," options ",{"type":170,"tag":208,"props":1135,"children":1136},{"style":461},[1137],{"type":176,"value":464},{"type":170,"tag":208,"props":1139,"children":1140},{"style":231},[1141],{"type":176,"value":1142}," {},",{"type":170,"tag":208,"props":1144,"children":1145},{"style":225},[1146],{"type":176,"value":1147}," obj ",{"type":170,"tag":208,"props":1149,"children":1150},{"style":461},[1151],{"type":176,"value":464},{"type":170,"tag":208,"props":1153,"children":1154},{"style":568},[1155],{"type":176,"value":1156}," this",{"type":170,"tag":208,"props":1158,"children":1159},{"style":231},[1160],{"type":176,"value":234},{"type":170,"tag":208,"props":1162,"children":1163},{"style":225},[1164],{"type":176,"value":1165},"store) ",{"type":170,"tag":208,"props":1167,"children":1168},{"style":231},[1169],{"type":176,"value":1170},"{\n",{"type":170,"tag":208,"props":1172,"children":1173},{"class":210,"line":221},[1174,1179,1185,1189,1194,1198],{"type":170,"tag":208,"props":1175,"children":1176},{"style":353},[1177],{"type":176,"value":1178},"  const",{"type":170,"tag":208,"props":1180,"children":1182},{"style":1181},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[1183],{"type":176,"value":1184}," dep",{"type":170,"tag":208,"props":1186,"children":1187},{"style":461},[1188],{"type":176,"value":585},{"type":170,"tag":208,"props":1190,"children":1191},{"style":461},[1192],{"type":176,"value":1193}," new",{"type":170,"tag":208,"props":1195,"children":1196},{"style":237},[1197],{"type":176,"value":541},{"type":170,"tag":208,"props":1199,"children":1200},{"style":274},[1201],{"type":176,"value":1202},"()\n",{"type":170,"tag":208,"props":1204,"children":1205},{"class":210,"line":300},[1206,1211,1215,1219,1223,1228,1232,1236,1240],{"type":170,"tag":208,"props":1207,"children":1208},{"style":225},[1209],{"type":176,"value":1210},"  Object",{"type":170,"tag":208,"props":1212,"children":1213},{"style":231},[1214],{"type":176,"value":234},{"type":170,"tag":208,"props":1216,"children":1217},{"style":237},[1218],{"type":176,"value":826},{"type":170,"tag":208,"props":1220,"children":1221},{"style":274},[1222],{"type":176,"value":245},{"type":170,"tag":208,"props":1224,"children":1225},{"style":225},[1226],{"type":176,"value":1227},"obj",{"type":170,"tag":208,"props":1229,"children":1230},{"style":231},[1231],{"type":176,"value":266},{"type":170,"tag":208,"props":1233,"children":1234},{"style":225},[1235],{"type":176,"value":891},{"type":170,"tag":208,"props":1237,"children":1238},{"style":231},[1239],{"type":176,"value":266},{"type":170,"tag":208,"props":1241,"children":1242},{"style":231},[1243],{"type":176,"value":361},{"type":170,"tag":208,"props":1245,"children":1246},{"class":210,"line":309},[1247,1252,1256,1260],{"type":170,"tag":208,"props":1248,"children":1249},{"style":274},[1250],{"type":176,"value":1251},"    enumerable",{"type":170,"tag":208,"props":1253,"children":1254},{"style":231},[1255],{"type":176,"value":282},{"type":170,"tag":208,"props":1257,"children":1258},{"style":922},[1259],{"type":176,"value":925},{"type":170,"tag":208,"props":1261,"children":1262},{"style":231},[1263],{"type":176,"value":930},{"type":170,"tag":208,"props":1265,"children":1266},{"class":210,"line":364},[1267,1272,1276,1280],{"type":170,"tag":208,"props":1268,"children":1269},{"style":274},[1270],{"type":176,"value":1271},"    configurable",{"type":170,"tag":208,"props":1273,"children":1274},{"style":231},[1275],{"type":176,"value":282},{"type":170,"tag":208,"props":1277,"children":1278},{"style":922},[1279],{"type":176,"value":925},{"type":170,"tag":208,"props":1281,"children":1282},{"style":231},[1283],{"type":176,"value":930},{"type":170,"tag":208,"props":1285,"children":1286},{"class":210,"line":412},[1287,1292,1296,1300,1304],{"type":170,"tag":208,"props":1288,"children":1289},{"style":237},[1290],{"type":176,"value":1291},"    get",{"type":170,"tag":208,"props":1293,"children":1294},{"style":231},[1295],{"type":176,"value":282},{"type":170,"tag":208,"props":1297,"children":1298},{"style":231},[1299],{"type":176,"value":558},{"type":170,"tag":208,"props":1301,"children":1302},{"style":353},[1303],{"type":176,"value":356},{"type":170,"tag":208,"props":1305,"children":1306},{"style":231},[1307],{"type":176,"value":361},{"type":170,"tag":208,"props":1309,"children":1310},{"class":210,"line":425},[1311,1316],{"type":170,"tag":208,"props":1312,"children":1313},{"style":996},[1314],{"type":176,"value":1315},"      return",{"type":170,"tag":208,"props":1317,"children":1318},{"style":225},[1319],{"type":176,"value":1004},{"type":170,"tag":208,"props":1321,"children":1322},{"class":210,"line":679},[1323],{"type":170,"tag":208,"props":1324,"children":1325},{"style":231},[1326],{"type":176,"value":1327},"    },\n",{"type":170,"tag":208,"props":1329,"children":1330},{"class":210,"line":688},[1331,1336,1340,1344,1348],{"type":170,"tag":208,"props":1332,"children":1333},{"style":237},[1334],{"type":176,"value":1335},"    set",{"type":170,"tag":208,"props":1337,"children":1338},{"style":231},[1339],{"type":176,"value":282},{"type":170,"tag":208,"props":1341,"children":1342},{"style":347},[1343],{"type":176,"value":350},{"type":170,"tag":208,"props":1345,"children":1346},{"style":353},[1347],{"type":176,"value":356},{"type":170,"tag":208,"props":1349,"children":1350},{"style":231},[1351],{"type":176,"value":361},{"type":170,"tag":208,"props":1353,"children":1354},{"class":210,"line":723},[1355,1360,1364,1368,1373,1377,1382],{"type":170,"tag":208,"props":1356,"children":1357},{"style":996},[1358],{"type":176,"value":1359},"      if",{"type":170,"tag":208,"props":1361,"children":1362},{"style":274},[1363],{"type":176,"value":620},{"type":170,"tag":208,"props":1365,"children":1366},{"style":225},[1367],{"type":176,"value":703},{"type":170,"tag":208,"props":1369,"children":1370},{"style":461},[1371],{"type":176,"value":1372}," ===",{"type":170,"tag":208,"props":1374,"children":1375},{"style":225},[1376],{"type":176,"value":277},{"type":170,"tag":208,"props":1378,"children":1379},{"style":274},[1380],{"type":176,"value":1381},") ",{"type":170,"tag":208,"props":1383,"children":1384},{"style":231},[1385],{"type":176,"value":1170},{"type":170,"tag":208,"props":1387,"children":1388},{"class":210,"line":787},[1389],{"type":170,"tag":208,"props":1390,"children":1391},{"style":996},[1392],{"type":176,"value":1393},"        return\n",{"type":170,"tag":208,"props":1395,"children":1396},{"class":210,"line":795},[1397],{"type":170,"tag":208,"props":1398,"children":1399},{"style":231},[1400],{"type":176,"value":1401},"      }\n",{"type":170,"tag":208,"props":1403,"children":1404},{"class":210,"line":1023},[1405,1410,1414,1418,1422,1426,1430,1434],{"type":170,"tag":208,"props":1406,"children":1407},{"style":225},[1408],{"type":176,"value":1409},"      dep",{"type":170,"tag":208,"props":1411,"children":1412},{"style":231},[1413],{"type":176,"value":234},{"type":170,"tag":208,"props":1415,"children":1416},{"style":237},[1417],{"type":176,"value":812},{"type":170,"tag":208,"props":1419,"children":1420},{"style":274},[1421],{"type":176,"value":245},{"type":170,"tag":208,"props":1423,"children":1424},{"style":225},[1425],{"type":176,"value":703},{"type":170,"tag":208,"props":1427,"children":1428},{"style":231},[1429],{"type":176,"value":266},{"type":170,"tag":208,"props":1431,"children":1432},{"style":225},[1433],{"type":176,"value":277},{"type":170,"tag":208,"props":1435,"children":1436},{"style":274},[1437],{"type":176,"value":297},{"type":170,"tag":208,"props":1439,"children":1440},{"class":210,"line":1048},[1441,1446,1450],{"type":170,"tag":208,"props":1442,"children":1443},{"style":225},[1444],{"type":176,"value":1445},"      val",{"type":170,"tag":208,"props":1447,"children":1448},{"style":461},[1449],{"type":176,"value":585},{"type":170,"tag":208,"props":1451,"children":1452},{"style":225},[1453],{"type":176,"value":1063},{"type":170,"tag":208,"props":1455,"children":1456},{"class":210,"line":1066},[1457],{"type":170,"tag":208,"props":1458,"children":1459},{"style":231},[1460],{"type":176,"value":1461},"    }\n",{"type":170,"tag":208,"props":1463,"children":1464},{"class":210,"line":1074},[1465,1470],{"type":170,"tag":208,"props":1466,"children":1467},{"style":231},[1468],{"type":176,"value":1469},"  }",{"type":170,"tag":208,"props":1471,"children":1472},{"style":274},[1473],{"type":176,"value":297},{"type":170,"tag":208,"props":1475,"children":1476},{"class":210,"line":1083},[1477],{"type":170,"tag":208,"props":1478,"children":1479},{"style":231},[1480],{"type":176,"value":801},{"type":170,"tag":178,"props":1482,"children":1483},{},[1484],{"type":176,"value":1485},"每当对应属性被赋值, 就会执行依赖数组中的回调函数.",{"type":170,"tag":178,"props":1487,"children":1488},{},[1489],{"type":176,"value":1490},"不过这样还不够, 我们还得想办法获取到这个 dep 实例, 才能给它的依赖数组填充函数.",{"type":170,"tag":178,"props":1492,"children":1493},{},[1494],{"type":176,"value":1495},"这边提供一个很简单的思路, 并不推荐实践中这么做:",{"type":170,"tag":198,"props":1497,"children":1499},{"className":200,"code":1498,"language":202,"meta":163,"style":163},"set (key, val, options = {}, obj = this.store) {\n  const dep = new Dep()\n  Object.defineProperty(obj, key, {})\n  return dep\n}\n",[1500],{"type":170,"tag":184,"props":1501,"children":1502},{"__ignoreMap":163},[1503,1562,1589,1633,1646],{"type":170,"tag":208,"props":1504,"children":1505},{"class":210,"line":211},[1506,1510,1514,1518,1522,1526,1530,1534,1538,1542,1546,1550,1554,1558],{"type":170,"tag":208,"props":1507,"children":1508},{"style":237},[1509],{"type":176,"value":240},{"type":170,"tag":208,"props":1511,"children":1512},{"style":225},[1513],{"type":176,"value":1116},{"type":170,"tag":208,"props":1515,"children":1516},{"style":231},[1517],{"type":176,"value":266},{"type":170,"tag":208,"props":1519,"children":1520},{"style":225},[1521],{"type":176,"value":277},{"type":170,"tag":208,"props":1523,"children":1524},{"style":231},[1525],{"type":176,"value":266},{"type":170,"tag":208,"props":1527,"children":1528},{"style":225},[1529],{"type":176,"value":1133},{"type":170,"tag":208,"props":1531,"children":1532},{"style":461},[1533],{"type":176,"value":464},{"type":170,"tag":208,"props":1535,"children":1536},{"style":231},[1537],{"type":176,"value":1142},{"type":170,"tag":208,"props":1539,"children":1540},{"style":225},[1541],{"type":176,"value":1147},{"type":170,"tag":208,"props":1543,"children":1544},{"style":461},[1545],{"type":176,"value":464},{"type":170,"tag":208,"props":1547,"children":1548},{"style":568},[1549],{"type":176,"value":1156},{"type":170,"tag":208,"props":1551,"children":1552},{"style":231},[1553],{"type":176,"value":234},{"type":170,"tag":208,"props":1555,"children":1556},{"style":225},[1557],{"type":176,"value":1165},{"type":170,"tag":208,"props":1559,"children":1560},{"style":231},[1561],{"type":176,"value":1170},{"type":170,"tag":208,"props":1563,"children":1564},{"class":210,"line":221},[1565,1569,1573,1577,1581,1585],{"type":170,"tag":208,"props":1566,"children":1567},{"style":353},[1568],{"type":176,"value":1178},{"type":170,"tag":208,"props":1570,"children":1571},{"style":1181},[1572],{"type":176,"value":1184},{"type":170,"tag":208,"props":1574,"children":1575},{"style":461},[1576],{"type":176,"value":585},{"type":170,"tag":208,"props":1578,"children":1579},{"style":461},[1580],{"type":176,"value":1193},{"type":170,"tag":208,"props":1582,"children":1583},{"style":237},[1584],{"type":176,"value":541},{"type":170,"tag":208,"props":1586,"children":1587},{"style":274},[1588],{"type":176,"value":1202},{"type":170,"tag":208,"props":1590,"children":1591},{"class":210,"line":300},[1592,1596,1600,1604,1608,1612,1616,1620,1624,1629],{"type":170,"tag":208,"props":1593,"children":1594},{"style":225},[1595],{"type":176,"value":1210},{"type":170,"tag":208,"props":1597,"children":1598},{"style":231},[1599],{"type":176,"value":234},{"type":170,"tag":208,"props":1601,"children":1602},{"style":237},[1603],{"type":176,"value":826},{"type":170,"tag":208,"props":1605,"children":1606},{"style":274},[1607],{"type":176,"value":245},{"type":170,"tag":208,"props":1609,"children":1610},{"style":225},[1611],{"type":176,"value":1227},{"type":170,"tag":208,"props":1613,"children":1614},{"style":231},[1615],{"type":176,"value":266},{"type":170,"tag":208,"props":1617,"children":1618},{"style":225},[1619],{"type":176,"value":891},{"type":170,"tag":208,"props":1621,"children":1622},{"style":231},[1623],{"type":176,"value":266},{"type":170,"tag":208,"props":1625,"children":1626},{"style":231},[1627],{"type":176,"value":1628}," {}",{"type":170,"tag":208,"props":1630,"children":1631},{"style":274},[1632],{"type":176,"value":297},{"type":170,"tag":208,"props":1634,"children":1635},{"class":210,"line":309},[1636,1641],{"type":170,"tag":208,"props":1637,"children":1638},{"style":996},[1639],{"type":176,"value":1640},"  return",{"type":170,"tag":208,"props":1642,"children":1643},{"style":225},[1644],{"type":176,"value":1645}," dep\n",{"type":170,"tag":208,"props":1647,"children":1648},{"class":210,"line":364},[1649],{"type":170,"tag":208,"props":1650,"children":1651},{"style":231},[1652],{"type":176,"value":801},{"type":170,"tag":198,"props":1654,"children":1656},{"className":200,"code":1655,"language":202,"meta":163,"style":163},"const valueDep = set('value', b, {})\nvalueDep.addSub(() => { console.log('value changed!') })\n",[1657],{"type":170,"tag":184,"props":1658,"children":1659},{"__ignoreMap":163},[1660,1719],{"type":170,"tag":208,"props":1661,"children":1662},{"class":210,"line":211},[1663,1668,1673,1677,1682,1686,1690,1694,1698,1702,1707,1711,1715],{"type":170,"tag":208,"props":1664,"children":1665},{"style":353},[1666],{"type":176,"value":1667},"const",{"type":170,"tag":208,"props":1669,"children":1670},{"style":1181},[1671],{"type":176,"value":1672}," valueDep",{"type":170,"tag":208,"props":1674,"children":1675},{"style":461},[1676],{"type":176,"value":585},{"type":170,"tag":208,"props":1678,"children":1679},{"style":237},[1680],{"type":176,"value":1681}," set",{"type":170,"tag":208,"props":1683,"children":1684},{"style":225},[1685],{"type":176,"value":245},{"type":170,"tag":208,"props":1687,"children":1688},{"style":248},[1689],{"type":176,"value":251},{"type":170,"tag":208,"props":1691,"children":1692},{"style":254},[1693],{"type":176,"value":431},{"type":170,"tag":208,"props":1695,"children":1696},{"style":248},[1697],{"type":176,"value":251},{"type":170,"tag":208,"props":1699,"children":1700},{"style":231},[1701],{"type":176,"value":266},{"type":170,"tag":208,"props":1703,"children":1704},{"style":225},[1705],{"type":176,"value":1706}," b",{"type":170,"tag":208,"props":1708,"children":1709},{"style":231},[1710],{"type":176,"value":266},{"type":170,"tag":208,"props":1712,"children":1713},{"style":231},[1714],{"type":176,"value":1628},{"type":170,"tag":208,"props":1716,"children":1717},{"style":225},[1718],{"type":176,"value":297},{"type":170,"tag":208,"props":1720,"children":1721},{"class":210,"line":221},[1722,1727,1731,1736,1740,1745,1749,1753,1758,1762,1766,1770,1774,1779,1783,1787,1791],{"type":170,"tag":208,"props":1723,"children":1724},{"style":225},[1725],{"type":176,"value":1726},"valueDep",{"type":170,"tag":208,"props":1728,"children":1729},{"style":231},[1730],{"type":176,"value":234},{"type":170,"tag":208,"props":1732,"children":1733},{"style":237},[1734],{"type":176,"value":1735},"addSub",{"type":170,"tag":208,"props":1737,"children":1738},{"style":225},[1739],{"type":176,"value":245},{"type":170,"tag":208,"props":1741,"children":1742},{"style":231},[1743],{"type":176,"value":1744},"()",{"type":170,"tag":208,"props":1746,"children":1747},{"style":353},[1748],{"type":176,"value":356},{"type":170,"tag":208,"props":1750,"children":1751},{"style":231},[1752],{"type":176,"value":271},{"type":170,"tag":208,"props":1754,"children":1755},{"style":225},[1756],{"type":176,"value":1757}," console",{"type":170,"tag":208,"props":1759,"children":1760},{"style":231},[1761],{"type":176,"value":234},{"type":170,"tag":208,"props":1763,"children":1764},{"style":237},[1765],{"type":176,"value":379},{"type":170,"tag":208,"props":1767,"children":1768},{"style":274},[1769],{"type":176,"value":245},{"type":170,"tag":208,"props":1771,"children":1772},{"style":248},[1773],{"type":176,"value":251},{"type":170,"tag":208,"props":1775,"children":1776},{"style":254},[1777],{"type":176,"value":1778},"value changed!",{"type":170,"tag":208,"props":1780,"children":1781},{"style":248},[1782],{"type":176,"value":251},{"type":170,"tag":208,"props":1784,"children":1785},{"style":274},[1786],{"type":176,"value":1381},{"type":170,"tag":208,"props":1788,"children":1789},{"style":231},[1790],{"type":176,"value":418},{"type":170,"tag":208,"props":1792,"children":1793},{"style":225},[1794],{"type":176,"value":297},{"type":170,"tag":178,"props":1796,"children":1797},{},[1798],{"type":176,"value":1799},"虽然代码能使用了, 就是是看起来怪怪的~ 😋 我们的三轮车开进了岔路~",{"type":170,"tag":171,"props":1801,"children":1803},{"id":1802},"通过-watch-添加订阅",[1804],{"type":176,"value":1805},"通过 watch 添加订阅",{"type":170,"tag":821,"props":1807,"children":1809},{"id":1808},"喝口水我们继续",[1810],{"type":176,"value":1808},{"type":170,"tag":178,"props":1812,"children":1813},{},[1814],{"type":176,"value":1815},"《黑客与画家》中曾经提到这样一个观点, 我深有体会:",{"type":170,"tag":1817,"props":1818,"children":1819},"blockquote",{},[1820],{"type":170,"tag":178,"props":1821,"children":1822},{},[1823],{"type":176,"value":1824},"如果你觉得你的代码奇怪, 那么往往它是错的",{"type":170,"tag":178,"props":1826,"children":1827},{},[1828],{"type":176,"value":1829},"上面的那一串代码仅仅是能跑通的水平, 我们需要加入更多的细节和思考, 有时候只需要坐下来稍微看一下代码, 就会有各种想法蹦出来:",{"type":170,"tag":1817,"props":1831,"children":1832},{},[1833],{"type":170,"tag":178,"props":1834,"children":1835},{},[1836],{"type":176,"value":1837},"构思这种东西有一个特点，那就是它会导致更多的构思。你有没有注意过，坐下来写东西的时候，一半的构思是写作时产生的？",{"type":170,"tag":821,"props":1839,"children":1841},{"id":1840},"隐藏-dep",[1842],{"type":176,"value":1843},"隐藏 Dep",{"type":170,"tag":178,"props":1845,"children":1846},{},[1847],{"type":176,"value":1848},"这些内容应和外部是解耦的. 首先一点, 我们创建一个侦听器类, 用于封装我们侦听所用到的所有方法, 它包含了我们想要的全局对象以及操作它的方法(如 watch,set):",{"type":170,"tag":198,"props":1850,"children":1852},{"className":200,"code":1851,"language":202,"meta":163,"style":163},"class VX {\n  constructor () {\n    this.store = Object.create(null)\n  }\n  watch (key, fn, obj = this.store) {}\n  set (key, val, options = {}, obj = this.store) {}\n}\nconst vx = new VX()\n",[1853],{"type":170,"tag":184,"props":1854,"children":1855},{"__ignoreMap":163},[1856,1872,1887,1935,1942,2002,2070,2077],{"type":170,"tag":208,"props":1857,"children":1858},{"class":210,"line":211},[1859,1863,1868],{"type":170,"tag":208,"props":1860,"children":1861},{"style":353},[1862],{"type":176,"value":535},{"type":170,"tag":208,"props":1864,"children":1865},{"style":538},[1866],{"type":176,"value":1867}," VX",{"type":170,"tag":208,"props":1869,"children":1870},{"style":231},[1871],{"type":176,"value":361},{"type":170,"tag":208,"props":1873,"children":1874},{"class":210,"line":221},[1875,1879,1883],{"type":170,"tag":208,"props":1876,"children":1877},{"style":353},[1878],{"type":176,"value":553},{"type":170,"tag":208,"props":1880,"children":1881},{"style":231},[1882],{"type":176,"value":558},{"type":170,"tag":208,"props":1884,"children":1885},{"style":231},[1886],{"type":176,"value":361},{"type":170,"tag":208,"props":1888,"children":1889},{"class":210,"line":300},[1890,1894,1898,1903,1907,1912,1916,1921,1925,1931],{"type":170,"tag":208,"props":1891,"children":1892},{"style":568},[1893],{"type":176,"value":571},{"type":170,"tag":208,"props":1895,"children":1896},{"style":231},[1897],{"type":176,"value":234},{"type":170,"tag":208,"props":1899,"children":1900},{"style":225},[1901],{"type":176,"value":1902},"store",{"type":170,"tag":208,"props":1904,"children":1905},{"style":461},[1906],{"type":176,"value":585},{"type":170,"tag":208,"props":1908,"children":1909},{"style":225},[1910],{"type":176,"value":1911}," Object",{"type":170,"tag":208,"props":1913,"children":1914},{"style":231},[1915],{"type":176,"value":234},{"type":170,"tag":208,"props":1917,"children":1918},{"style":237},[1919],{"type":176,"value":1920},"create",{"type":170,"tag":208,"props":1922,"children":1923},{"style":274},[1924],{"type":176,"value":245},{"type":170,"tag":208,"props":1926,"children":1928},{"style":1927},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1929],{"type":176,"value":1930},"null",{"type":170,"tag":208,"props":1932,"children":1933},{"style":274},[1934],{"type":176,"value":297},{"type":170,"tag":208,"props":1936,"children":1937},{"class":210,"line":309},[1938],{"type":170,"tag":208,"props":1939,"children":1940},{"style":231},[1941],{"type":176,"value":598},{"type":170,"tag":208,"props":1943,"children":1944},{"class":210,"line":364},[1945,1950,1954,1959,1963,1968,1972,1977,1981,1985,1989,1993,1997],{"type":170,"tag":208,"props":1946,"children":1947},{"style":612},[1948],{"type":176,"value":1949},"  watch",{"type":170,"tag":208,"props":1951,"children":1952},{"style":231},[1953],{"type":176,"value":620},{"type":170,"tag":208,"props":1955,"children":1956},{"style":347},[1957],{"type":176,"value":1958},"key",{"type":170,"tag":208,"props":1960,"children":1961},{"style":231},[1962],{"type":176,"value":266},{"type":170,"tag":208,"props":1964,"children":1965},{"style":347},[1966],{"type":176,"value":1967}," fn",{"type":170,"tag":208,"props":1969,"children":1970},{"style":231},[1971],{"type":176,"value":266},{"type":170,"tag":208,"props":1973,"children":1974},{"style":347},[1975],{"type":176,"value":1976}," obj",{"type":170,"tag":208,"props":1978,"children":1979},{"style":461},[1980],{"type":176,"value":585},{"type":170,"tag":208,"props":1982,"children":1983},{"style":568},[1984],{"type":176,"value":1156},{"type":170,"tag":208,"props":1986,"children":1987},{"style":231},[1988],{"type":176,"value":234},{"type":170,"tag":208,"props":1990,"children":1991},{"style":225},[1992],{"type":176,"value":1902},{"type":170,"tag":208,"props":1994,"children":1995},{"style":231},[1996],{"type":176,"value":630},{"type":170,"tag":208,"props":1998,"children":1999},{"style":231},[2000],{"type":176,"value":2001}," {}\n",{"type":170,"tag":208,"props":2003,"children":2004},{"class":210,"line":412},[2005,2009,2013,2017,2021,2025,2029,2034,2038,2042,2046,2050,2054,2058,2062,2066],{"type":170,"tag":208,"props":2006,"children":2007},{"style":612},[2008],{"type":176,"value":1029},{"type":170,"tag":208,"props":2010,"children":2011},{"style":231},[2012],{"type":176,"value":620},{"type":170,"tag":208,"props":2014,"children":2015},{"style":347},[2016],{"type":176,"value":1958},{"type":170,"tag":208,"props":2018,"children":2019},{"style":231},[2020],{"type":176,"value":266},{"type":170,"tag":208,"props":2022,"children":2023},{"style":347},[2024],{"type":176,"value":277},{"type":170,"tag":208,"props":2026,"children":2027},{"style":231},[2028],{"type":176,"value":266},{"type":170,"tag":208,"props":2030,"children":2031},{"style":347},[2032],{"type":176,"value":2033}," options",{"type":170,"tag":208,"props":2035,"children":2036},{"style":461},[2037],{"type":176,"value":585},{"type":170,"tag":208,"props":2039,"children":2040},{"style":231},[2041],{"type":176,"value":1142},{"type":170,"tag":208,"props":2043,"children":2044},{"style":347},[2045],{"type":176,"value":1976},{"type":170,"tag":208,"props":2047,"children":2048},{"style":461},[2049],{"type":176,"value":585},{"type":170,"tag":208,"props":2051,"children":2052},{"style":568},[2053],{"type":176,"value":1156},{"type":170,"tag":208,"props":2055,"children":2056},{"style":231},[2057],{"type":176,"value":234},{"type":170,"tag":208,"props":2059,"children":2060},{"style":225},[2061],{"type":176,"value":1902},{"type":170,"tag":208,"props":2063,"children":2064},{"style":231},[2065],{"type":176,"value":630},{"type":170,"tag":208,"props":2067,"children":2068},{"style":231},[2069],{"type":176,"value":2001},{"type":170,"tag":208,"props":2071,"children":2072},{"class":210,"line":425},[2073],{"type":170,"tag":208,"props":2074,"children":2075},{"style":231},[2076],{"type":176,"value":801},{"type":170,"tag":208,"props":2078,"children":2079},{"class":210,"line":679},[2080,2084,2089,2093,2097,2101],{"type":170,"tag":208,"props":2081,"children":2082},{"style":353},[2083],{"type":176,"value":1667},{"type":170,"tag":208,"props":2085,"children":2086},{"style":1181},[2087],{"type":176,"value":2088}," vx",{"type":170,"tag":208,"props":2090,"children":2091},{"style":461},[2092],{"type":176,"value":585},{"type":170,"tag":208,"props":2094,"children":2095},{"style":461},[2096],{"type":176,"value":1193},{"type":170,"tag":208,"props":2098,"children":2099},{"style":237},[2100],{"type":176,"value":1867},{"type":170,"tag":208,"props":2102,"children":2103},{"style":225},[2104],{"type":176,"value":1202},{"type":170,"tag":178,"props":2106,"children":2107},{},[2108],{"type":176,"value":2109},"我们可以在 watch 中给对象某个属性添加回调, 就不用去直接操作 Dep 依赖数组了. 只是, 我们在业务代码中调用 watch, 要怎么去获取 obj.key 对应的 dep 呢?",{"type":170,"tag":178,"props":2111,"children":2112},{},[2113],{"type":176,"value":2114},"我们设置一个全局的 depHandler, 在 obj.key 的 getter 中主动将 depHandler 设置为当前 obj.key 的 dep 实例, 那么我们在 watch 函数里, 只要用任意操作触发 obj.key 的 getter, 就能通过 depHandler 得到它的 dep 实例了, 代码形如:",{"type":170,"tag":198,"props":2116,"children":2118},{"className":200,"code":2117,"language":202,"meta":163,"style":163},"  // 一开始没有持有dep实例\n  let handleDep = null\n  class VX {\n    watch (key, fn, obj = this.store) {\n      console.log(obj.key) // 使用任意操作触发obj.key的getter, 那么handleDep将自动引用obj.key的dep实例\n      handleDep.addSub(fn)\n    }\n    set (key, val, options = {}, obj = this.store) {\n      const dep = new Dep()\n      Object.defineProperty(obj, key, {\n        enumerable: true,\n        configurable: true,\n        get: () => {\n          handleDep = dep\n          return val\n        },\n        set: newVal => {}\n      })\n    }\n  }\n",[2119],{"type":170,"tag":184,"props":2120,"children":2121},{"__ignoreMap":163},[2122,2130,2152,2168,2224,2265,2293,2300,2367,2395,2435,2455,2475,2499,2515,2527,2535,2559,2572,2580],{"type":170,"tag":208,"props":2123,"children":2124},{"class":210,"line":211},[2125],{"type":170,"tag":208,"props":2126,"children":2127},{"style":215},[2128],{"type":176,"value":2129},"  // 一开始没有持有dep实例\n",{"type":170,"tag":208,"props":2131,"children":2132},{"class":210,"line":221},[2133,2138,2143,2147],{"type":170,"tag":208,"props":2134,"children":2135},{"style":353},[2136],{"type":176,"value":2137},"  let",{"type":170,"tag":208,"props":2139,"children":2140},{"style":225},[2141],{"type":176,"value":2142}," handleDep ",{"type":170,"tag":208,"props":2144,"children":2145},{"style":461},[2146],{"type":176,"value":464},{"type":170,"tag":208,"props":2148,"children":2149},{"style":1927},[2150],{"type":176,"value":2151}," null\n",{"type":170,"tag":208,"props":2153,"children":2154},{"class":210,"line":300},[2155,2160,2164],{"type":170,"tag":208,"props":2156,"children":2157},{"style":353},[2158],{"type":176,"value":2159},"  class",{"type":170,"tag":208,"props":2161,"children":2162},{"style":538},[2163],{"type":176,"value":1867},{"type":170,"tag":208,"props":2165,"children":2166},{"style":231},[2167],{"type":176,"value":361},{"type":170,"tag":208,"props":2169,"children":2170},{"class":210,"line":309},[2171,2176,2180,2184,2188,2192,2196,2200,2204,2208,2212,2216,2220],{"type":170,"tag":208,"props":2172,"children":2173},{"style":612},[2174],{"type":176,"value":2175},"    watch",{"type":170,"tag":208,"props":2177,"children":2178},{"style":231},[2179],{"type":176,"value":620},{"type":170,"tag":208,"props":2181,"children":2182},{"style":347},[2183],{"type":176,"value":1958},{"type":170,"tag":208,"props":2185,"children":2186},{"style":231},[2187],{"type":176,"value":266},{"type":170,"tag":208,"props":2189,"children":2190},{"style":347},[2191],{"type":176,"value":1967},{"type":170,"tag":208,"props":2193,"children":2194},{"style":231},[2195],{"type":176,"value":266},{"type":170,"tag":208,"props":2197,"children":2198},{"style":347},[2199],{"type":176,"value":1976},{"type":170,"tag":208,"props":2201,"children":2202},{"style":461},[2203],{"type":176,"value":585},{"type":170,"tag":208,"props":2205,"children":2206},{"style":568},[2207],{"type":176,"value":1156},{"type":170,"tag":208,"props":2209,"children":2210},{"style":231},[2211],{"type":176,"value":234},{"type":170,"tag":208,"props":2213,"children":2214},{"style":225},[2215],{"type":176,"value":1902},{"type":170,"tag":208,"props":2217,"children":2218},{"style":231},[2219],{"type":176,"value":630},{"type":170,"tag":208,"props":2221,"children":2222},{"style":231},[2223],{"type":176,"value":361},{"type":170,"tag":208,"props":2225,"children":2226},{"class":210,"line":364},[2227,2232,2236,2240,2244,2248,2252,2256,2260],{"type":170,"tag":208,"props":2228,"children":2229},{"style":225},[2230],{"type":176,"value":2231},"      console",{"type":170,"tag":208,"props":2233,"children":2234},{"style":231},[2235],{"type":176,"value":234},{"type":170,"tag":208,"props":2237,"children":2238},{"style":237},[2239],{"type":176,"value":379},{"type":170,"tag":208,"props":2241,"children":2242},{"style":274},[2243],{"type":176,"value":245},{"type":170,"tag":208,"props":2245,"children":2246},{"style":225},[2247],{"type":176,"value":1227},{"type":170,"tag":208,"props":2249,"children":2250},{"style":231},[2251],{"type":176,"value":234},{"type":170,"tag":208,"props":2253,"children":2254},{"style":225},[2255],{"type":176,"value":1958},{"type":170,"tag":208,"props":2257,"children":2258},{"style":274},[2259],{"type":176,"value":1381},{"type":170,"tag":208,"props":2261,"children":2262},{"style":215},[2263],{"type":176,"value":2264},"// 使用任意操作触发obj.key的getter, 那么handleDep将自动引用obj.key的dep实例\n",{"type":170,"tag":208,"props":2266,"children":2267},{"class":210,"line":412},[2268,2273,2277,2281,2285,2289],{"type":170,"tag":208,"props":2269,"children":2270},{"style":225},[2271],{"type":176,"value":2272},"      handleDep",{"type":170,"tag":208,"props":2274,"children":2275},{"style":231},[2276],{"type":176,"value":234},{"type":170,"tag":208,"props":2278,"children":2279},{"style":237},[2280],{"type":176,"value":1735},{"type":170,"tag":208,"props":2282,"children":2283},{"style":274},[2284],{"type":176,"value":245},{"type":170,"tag":208,"props":2286,"children":2287},{"style":225},[2288],{"type":176,"value":625},{"type":170,"tag":208,"props":2290,"children":2291},{"style":274},[2292],{"type":176,"value":297},{"type":170,"tag":208,"props":2294,"children":2295},{"class":210,"line":425},[2296],{"type":170,"tag":208,"props":2297,"children":2298},{"style":231},[2299],{"type":176,"value":1461},{"type":170,"tag":208,"props":2301,"children":2302},{"class":210,"line":679},[2303,2307,2311,2315,2319,2323,2327,2331,2335,2339,2343,2347,2351,2355,2359,2363],{"type":170,"tag":208,"props":2304,"children":2305},{"style":612},[2306],{"type":176,"value":1335},{"type":170,"tag":208,"props":2308,"children":2309},{"style":231},[2310],{"type":176,"value":620},{"type":170,"tag":208,"props":2312,"children":2313},{"style":347},[2314],{"type":176,"value":1958},{"type":170,"tag":208,"props":2316,"children":2317},{"style":231},[2318],{"type":176,"value":266},{"type":170,"tag":208,"props":2320,"children":2321},{"style":347},[2322],{"type":176,"value":277},{"type":170,"tag":208,"props":2324,"children":2325},{"style":231},[2326],{"type":176,"value":266},{"type":170,"tag":208,"props":2328,"children":2329},{"style":347},[2330],{"type":176,"value":2033},{"type":170,"tag":208,"props":2332,"children":2333},{"style":461},[2334],{"type":176,"value":585},{"type":170,"tag":208,"props":2336,"children":2337},{"style":231},[2338],{"type":176,"value":1142},{"type":170,"tag":208,"props":2340,"children":2341},{"style":347},[2342],{"type":176,"value":1976},{"type":170,"tag":208,"props":2344,"children":2345},{"style":461},[2346],{"type":176,"value":585},{"type":170,"tag":208,"props":2348,"children":2349},{"style":568},[2350],{"type":176,"value":1156},{"type":170,"tag":208,"props":2352,"children":2353},{"style":231},[2354],{"type":176,"value":234},{"type":170,"tag":208,"props":2356,"children":2357},{"style":225},[2358],{"type":176,"value":1902},{"type":170,"tag":208,"props":2360,"children":2361},{"style":231},[2362],{"type":176,"value":630},{"type":170,"tag":208,"props":2364,"children":2365},{"style":231},[2366],{"type":176,"value":361},{"type":170,"tag":208,"props":2368,"children":2369},{"class":210,"line":688},[2370,2375,2379,2383,2387,2391],{"type":170,"tag":208,"props":2371,"children":2372},{"style":353},[2373],{"type":176,"value":2374},"      const",{"type":170,"tag":208,"props":2376,"children":2377},{"style":1181},[2378],{"type":176,"value":1184},{"type":170,"tag":208,"props":2380,"children":2381},{"style":461},[2382],{"type":176,"value":585},{"type":170,"tag":208,"props":2384,"children":2385},{"style":461},[2386],{"type":176,"value":1193},{"type":170,"tag":208,"props":2388,"children":2389},{"style":237},[2390],{"type":176,"value":541},{"type":170,"tag":208,"props":2392,"children":2393},{"style":274},[2394],{"type":176,"value":1202},{"type":170,"tag":208,"props":2396,"children":2397},{"class":210,"line":723},[2398,2403,2407,2411,2415,2419,2423,2427,2431],{"type":170,"tag":208,"props":2399,"children":2400},{"style":225},[2401],{"type":176,"value":2402},"      Object",{"type":170,"tag":208,"props":2404,"children":2405},{"style":231},[2406],{"type":176,"value":234},{"type":170,"tag":208,"props":2408,"children":2409},{"style":237},[2410],{"type":176,"value":826},{"type":170,"tag":208,"props":2412,"children":2413},{"style":274},[2414],{"type":176,"value":245},{"type":170,"tag":208,"props":2416,"children":2417},{"style":225},[2418],{"type":176,"value":1227},{"type":170,"tag":208,"props":2420,"children":2421},{"style":231},[2422],{"type":176,"value":266},{"type":170,"tag":208,"props":2424,"children":2425},{"style":225},[2426],{"type":176,"value":891},{"type":170,"tag":208,"props":2428,"children":2429},{"style":231},[2430],{"type":176,"value":266},{"type":170,"tag":208,"props":2432,"children":2433},{"style":231},[2434],{"type":176,"value":361},{"type":170,"tag":208,"props":2436,"children":2437},{"class":210,"line":787},[2438,2443,2447,2451],{"type":170,"tag":208,"props":2439,"children":2440},{"style":274},[2441],{"type":176,"value":2442},"        enumerable",{"type":170,"tag":208,"props":2444,"children":2445},{"style":231},[2446],{"type":176,"value":282},{"type":170,"tag":208,"props":2448,"children":2449},{"style":922},[2450],{"type":176,"value":925},{"type":170,"tag":208,"props":2452,"children":2453},{"style":231},[2454],{"type":176,"value":930},{"type":170,"tag":208,"props":2456,"children":2457},{"class":210,"line":795},[2458,2463,2467,2471],{"type":170,"tag":208,"props":2459,"children":2460},{"style":274},[2461],{"type":176,"value":2462},"        configurable",{"type":170,"tag":208,"props":2464,"children":2465},{"style":231},[2466],{"type":176,"value":282},{"type":170,"tag":208,"props":2468,"children":2469},{"style":922},[2470],{"type":176,"value":925},{"type":170,"tag":208,"props":2472,"children":2473},{"style":231},[2474],{"type":176,"value":930},{"type":170,"tag":208,"props":2476,"children":2477},{"class":210,"line":1023},[2478,2483,2487,2491,2495],{"type":170,"tag":208,"props":2479,"children":2480},{"style":237},[2481],{"type":176,"value":2482},"        get",{"type":170,"tag":208,"props":2484,"children":2485},{"style":231},[2486],{"type":176,"value":282},{"type":170,"tag":208,"props":2488,"children":2489},{"style":231},[2490],{"type":176,"value":558},{"type":170,"tag":208,"props":2492,"children":2493},{"style":353},[2494],{"type":176,"value":356},{"type":170,"tag":208,"props":2496,"children":2497},{"style":231},[2498],{"type":176,"value":361},{"type":170,"tag":208,"props":2500,"children":2501},{"class":210,"line":1048},[2502,2507,2511],{"type":170,"tag":208,"props":2503,"children":2504},{"style":225},[2505],{"type":176,"value":2506},"          handleDep",{"type":170,"tag":208,"props":2508,"children":2509},{"style":461},[2510],{"type":176,"value":585},{"type":170,"tag":208,"props":2512,"children":2513},{"style":225},[2514],{"type":176,"value":1645},{"type":170,"tag":208,"props":2516,"children":2517},{"class":210,"line":1066},[2518,2523],{"type":170,"tag":208,"props":2519,"children":2520},{"style":996},[2521],{"type":176,"value":2522},"          return",{"type":170,"tag":208,"props":2524,"children":2525},{"style":225},[2526],{"type":176,"value":1004},{"type":170,"tag":208,"props":2528,"children":2529},{"class":210,"line":1074},[2530],{"type":170,"tag":208,"props":2531,"children":2532},{"style":231},[2533],{"type":176,"value":2534},"        },\n",{"type":170,"tag":208,"props":2536,"children":2537},{"class":210,"line":1083},[2538,2543,2547,2551,2555],{"type":170,"tag":208,"props":2539,"children":2540},{"style":237},[2541],{"type":176,"value":2542},"        set",{"type":170,"tag":208,"props":2544,"children":2545},{"style":231},[2546],{"type":176,"value":282},{"type":170,"tag":208,"props":2548,"children":2549},{"style":347},[2550],{"type":176,"value":350},{"type":170,"tag":208,"props":2552,"children":2553},{"style":353},[2554],{"type":176,"value":356},{"type":170,"tag":208,"props":2556,"children":2557},{"style":231},[2558],{"type":176,"value":2001},{"type":170,"tag":208,"props":2560,"children":2562},{"class":210,"line":2561},18,[2563,2568],{"type":170,"tag":208,"props":2564,"children":2565},{"style":231},[2566],{"type":176,"value":2567},"      }",{"type":170,"tag":208,"props":2569,"children":2570},{"style":274},[2571],{"type":176,"value":297},{"type":170,"tag":208,"props":2573,"children":2575},{"class":210,"line":2574},19,[2576],{"type":170,"tag":208,"props":2577,"children":2578},{"style":231},[2579],{"type":176,"value":1461},{"type":170,"tag":208,"props":2581,"children":2583},{"class":210,"line":2582},20,[2584],{"type":170,"tag":208,"props":2585,"children":2586},{"style":231},[2587],{"type":176,"value":598},{"type":170,"tag":821,"props":2589,"children":2591},{"id":2590},"主动收集依赖",[2592],{"type":176,"value":2590},{"type":170,"tag":178,"props":2594,"children":2595},{},[2596,2598,2604,2606,2612,2614,2620],{"type":176,"value":2597},"我们增加",{"type":170,"tag":184,"props":2599,"children":2601},{"className":2600},[],[2602],{"type":176,"value":2603},"handleDep.addSub(fn)",{"type":176,"value":2605},"添加回调函数的逻辑, 其实可以直接放到 getter 中, 首先在 Dep 类中封装一个'主动'收集依赖的",{"type":170,"tag":184,"props":2607,"children":2609},{"className":2608},[],[2610],{"type":176,"value":2611},"collect",{"type":176,"value":2613},"方法, 他会将全局",{"type":170,"tag":184,"props":2615,"children":2617},{"className":2616},[],[2618],{"type":176,"value":2619},"handleFn",{"type":176,"value":2621},"存放到订阅数组中, 这样一来, 在 watch 函数中, 我们只要触发 obj.key 的 getter, 就可以主动收集依赖了:",{"type":170,"tag":198,"props":2623,"children":2625},{"className":200,"code":2624,"language":202,"meta":163,"style":163},"let handleFn = null\nclass Dep {\n  addSub (fn) {}\n  delSub (fn) {}\n  clear () {}\n  collect (fn = handleFn) {\n    if (fn && !this.subs.find(x => x === fn)) {\n      this.addSub(fn)\n    }\n  }\n  notify (newVal, oldVal) {}\n}\n\nlet handleDep = null\nclass VX {\n  watch (key, fn, obj = this.store) {\n    handleFn = fn\n    console.log(obj.key)\n  }\n  set (key, val, options = {}, obj = this.store) {\n    const dep = new Dep()\n    Object.defineProperty(obj, key, {\n      enumerable: true,\n      configurable: true,\n      get: () => {\n        handleDep = dep\n        handleDep.collect()\n        return val\n      },\n      set: newVal => {}\n    })\n  }\n}\n",[2626],{"type":170,"tag":184,"props":2627,"children":2628},{"__ignoreMap":163},[2629,2650,2665,2688,2711,2727,2760,2843,2871,2878,2885,2916,2923,2931,2950,2965,3020,3037,3073,3080,3147,3176,3217,3238,3259,3284,3301,3321,3334,3343,3368,3381,3389],{"type":170,"tag":208,"props":2630,"children":2631},{"class":210,"line":211},[2632,2637,2642,2646],{"type":170,"tag":208,"props":2633,"children":2634},{"style":353},[2635],{"type":176,"value":2636},"let",{"type":170,"tag":208,"props":2638,"children":2639},{"style":225},[2640],{"type":176,"value":2641}," handleFn ",{"type":170,"tag":208,"props":2643,"children":2644},{"style":461},[2645],{"type":176,"value":464},{"type":170,"tag":208,"props":2647,"children":2648},{"style":1927},[2649],{"type":176,"value":2151},{"type":170,"tag":208,"props":2651,"children":2652},{"class":210,"line":221},[2653,2657,2661],{"type":170,"tag":208,"props":2654,"children":2655},{"style":353},[2656],{"type":176,"value":535},{"type":170,"tag":208,"props":2658,"children":2659},{"style":538},[2660],{"type":176,"value":541},{"type":170,"tag":208,"props":2662,"children":2663},{"style":231},[2664],{"type":176,"value":361},{"type":170,"tag":208,"props":2666,"children":2667},{"class":210,"line":300},[2668,2672,2676,2680,2684],{"type":170,"tag":208,"props":2669,"children":2670},{"style":612},[2671],{"type":176,"value":615},{"type":170,"tag":208,"props":2673,"children":2674},{"style":231},[2675],{"type":176,"value":620},{"type":170,"tag":208,"props":2677,"children":2678},{"style":347},[2679],{"type":176,"value":625},{"type":170,"tag":208,"props":2681,"children":2682},{"style":231},[2683],{"type":176,"value":630},{"type":170,"tag":208,"props":2685,"children":2686},{"style":231},[2687],{"type":176,"value":2001},{"type":170,"tag":208,"props":2689,"children":2690},{"class":210,"line":309},[2691,2695,2699,2703,2707],{"type":170,"tag":208,"props":2692,"children":2693},{"style":612},[2694],{"type":176,"value":652},{"type":170,"tag":208,"props":2696,"children":2697},{"style":231},[2698],{"type":176,"value":620},{"type":170,"tag":208,"props":2700,"children":2701},{"style":347},[2702],{"type":176,"value":625},{"type":170,"tag":208,"props":2704,"children":2705},{"style":231},[2706],{"type":176,"value":630},{"type":170,"tag":208,"props":2708,"children":2709},{"style":231},[2710],{"type":176,"value":2001},{"type":170,"tag":208,"props":2712,"children":2713},{"class":210,"line":364},[2714,2719,2723],{"type":170,"tag":208,"props":2715,"children":2716},{"style":612},[2717],{"type":176,"value":2718},"  clear",{"type":170,"tag":208,"props":2720,"children":2721},{"style":231},[2722],{"type":176,"value":558},{"type":170,"tag":208,"props":2724,"children":2725},{"style":231},[2726],{"type":176,"value":2001},{"type":170,"tag":208,"props":2728,"children":2729},{"class":210,"line":412},[2730,2735,2739,2743,2747,2752,2756],{"type":170,"tag":208,"props":2731,"children":2732},{"style":612},[2733],{"type":176,"value":2734},"  collect",{"type":170,"tag":208,"props":2736,"children":2737},{"style":231},[2738],{"type":176,"value":620},{"type":170,"tag":208,"props":2740,"children":2741},{"style":347},[2742],{"type":176,"value":625},{"type":170,"tag":208,"props":2744,"children":2745},{"style":461},[2746],{"type":176,"value":585},{"type":170,"tag":208,"props":2748,"children":2749},{"style":225},[2750],{"type":176,"value":2751}," handleFn",{"type":170,"tag":208,"props":2753,"children":2754},{"style":231},[2755],{"type":176,"value":630},{"type":170,"tag":208,"props":2757,"children":2758},{"style":231},[2759],{"type":176,"value":361},{"type":170,"tag":208,"props":2761,"children":2762},{"class":210,"line":425},[2763,2768,2772,2776,2781,2786,2791,2795,2799,2803,2808,2812,2817,2821,2826,2830,2834,2839],{"type":170,"tag":208,"props":2764,"children":2765},{"style":996},[2766],{"type":176,"value":2767},"    if",{"type":170,"tag":208,"props":2769,"children":2770},{"style":274},[2771],{"type":176,"value":620},{"type":170,"tag":208,"props":2773,"children":2774},{"style":225},[2775],{"type":176,"value":625},{"type":170,"tag":208,"props":2777,"children":2778},{"style":461},[2779],{"type":176,"value":2780}," &&",{"type":170,"tag":208,"props":2782,"children":2783},{"style":461},[2784],{"type":176,"value":2785}," !",{"type":170,"tag":208,"props":2787,"children":2788},{"style":568},[2789],{"type":176,"value":2790},"this",{"type":170,"tag":208,"props":2792,"children":2793},{"style":231},[2794],{"type":176,"value":234},{"type":170,"tag":208,"props":2796,"children":2797},{"style":225},[2798],{"type":176,"value":580},{"type":170,"tag":208,"props":2800,"children":2801},{"style":231},[2802],{"type":176,"value":234},{"type":170,"tag":208,"props":2804,"children":2805},{"style":237},[2806],{"type":176,"value":2807},"find",{"type":170,"tag":208,"props":2809,"children":2810},{"style":274},[2811],{"type":176,"value":245},{"type":170,"tag":208,"props":2813,"children":2814},{"style":347},[2815],{"type":176,"value":2816},"x",{"type":170,"tag":208,"props":2818,"children":2819},{"style":353},[2820],{"type":176,"value":356},{"type":170,"tag":208,"props":2822,"children":2823},{"style":225},[2824],{"type":176,"value":2825}," x",{"type":170,"tag":208,"props":2827,"children":2828},{"style":461},[2829],{"type":176,"value":1372},{"type":170,"tag":208,"props":2831,"children":2832},{"style":225},[2833],{"type":176,"value":1967},{"type":170,"tag":208,"props":2835,"children":2836},{"style":274},[2837],{"type":176,"value":2838},")) ",{"type":170,"tag":208,"props":2840,"children":2841},{"style":231},[2842],{"type":176,"value":1170},{"type":170,"tag":208,"props":2844,"children":2845},{"class":210,"line":679},[2846,2851,2855,2859,2863,2867],{"type":170,"tag":208,"props":2847,"children":2848},{"style":568},[2849],{"type":176,"value":2850},"      this",{"type":170,"tag":208,"props":2852,"children":2853},{"style":231},[2854],{"type":176,"value":234},{"type":170,"tag":208,"props":2856,"children":2857},{"style":237},[2858],{"type":176,"value":1735},{"type":170,"tag":208,"props":2860,"children":2861},{"style":274},[2862],{"type":176,"value":245},{"type":170,"tag":208,"props":2864,"children":2865},{"style":225},[2866],{"type":176,"value":625},{"type":170,"tag":208,"props":2868,"children":2869},{"style":274},[2870],{"type":176,"value":297},{"type":170,"tag":208,"props":2872,"children":2873},{"class":210,"line":688},[2874],{"type":170,"tag":208,"props":2875,"children":2876},{"style":231},[2877],{"type":176,"value":1461},{"type":170,"tag":208,"props":2879,"children":2880},{"class":210,"line":723},[2881],{"type":170,"tag":208,"props":2882,"children":2883},{"style":231},[2884],{"type":176,"value":598},{"type":170,"tag":208,"props":2886,"children":2887},{"class":210,"line":787},[2888,2892,2896,2900,2904,2908,2912],{"type":170,"tag":208,"props":2889,"children":2890},{"style":612},[2891],{"type":176,"value":694},{"type":170,"tag":208,"props":2893,"children":2894},{"style":231},[2895],{"type":176,"value":620},{"type":170,"tag":208,"props":2897,"children":2898},{"style":347},[2899],{"type":176,"value":703},{"type":170,"tag":208,"props":2901,"children":2902},{"style":231},[2903],{"type":176,"value":266},{"type":170,"tag":208,"props":2905,"children":2906},{"style":347},[2907],{"type":176,"value":712},{"type":170,"tag":208,"props":2909,"children":2910},{"style":231},[2911],{"type":176,"value":630},{"type":170,"tag":208,"props":2913,"children":2914},{"style":231},[2915],{"type":176,"value":2001},{"type":170,"tag":208,"props":2917,"children":2918},{"class":210,"line":795},[2919],{"type":170,"tag":208,"props":2920,"children":2921},{"style":231},[2922],{"type":176,"value":801},{"type":170,"tag":208,"props":2924,"children":2925},{"class":210,"line":1023},[2926],{"type":170,"tag":208,"props":2927,"children":2928},{"emptyLinePlaceholder":162},[2929],{"type":176,"value":2930},"\n",{"type":170,"tag":208,"props":2932,"children":2933},{"class":210,"line":1048},[2934,2938,2942,2946],{"type":170,"tag":208,"props":2935,"children":2936},{"style":353},[2937],{"type":176,"value":2636},{"type":170,"tag":208,"props":2939,"children":2940},{"style":225},[2941],{"type":176,"value":2142},{"type":170,"tag":208,"props":2943,"children":2944},{"style":461},[2945],{"type":176,"value":464},{"type":170,"tag":208,"props":2947,"children":2948},{"style":1927},[2949],{"type":176,"value":2151},{"type":170,"tag":208,"props":2951,"children":2952},{"class":210,"line":1066},[2953,2957,2961],{"type":170,"tag":208,"props":2954,"children":2955},{"style":353},[2956],{"type":176,"value":535},{"type":170,"tag":208,"props":2958,"children":2959},{"style":538},[2960],{"type":176,"value":1867},{"type":170,"tag":208,"props":2962,"children":2963},{"style":231},[2964],{"type":176,"value":361},{"type":170,"tag":208,"props":2966,"children":2967},{"class":210,"line":1074},[2968,2972,2976,2980,2984,2988,2992,2996,3000,3004,3008,3012,3016],{"type":170,"tag":208,"props":2969,"children":2970},{"style":612},[2971],{"type":176,"value":1949},{"type":170,"tag":208,"props":2973,"children":2974},{"style":231},[2975],{"type":176,"value":620},{"type":170,"tag":208,"props":2977,"children":2978},{"style":347},[2979],{"type":176,"value":1958},{"type":170,"tag":208,"props":2981,"children":2982},{"style":231},[2983],{"type":176,"value":266},{"type":170,"tag":208,"props":2985,"children":2986},{"style":347},[2987],{"type":176,"value":1967},{"type":170,"tag":208,"props":2989,"children":2990},{"style":231},[2991],{"type":176,"value":266},{"type":170,"tag":208,"props":2993,"children":2994},{"style":347},[2995],{"type":176,"value":1976},{"type":170,"tag":208,"props":2997,"children":2998},{"style":461},[2999],{"type":176,"value":585},{"type":170,"tag":208,"props":3001,"children":3002},{"style":568},[3003],{"type":176,"value":1156},{"type":170,"tag":208,"props":3005,"children":3006},{"style":231},[3007],{"type":176,"value":234},{"type":170,"tag":208,"props":3009,"children":3010},{"style":225},[3011],{"type":176,"value":1902},{"type":170,"tag":208,"props":3013,"children":3014},{"style":231},[3015],{"type":176,"value":630},{"type":170,"tag":208,"props":3017,"children":3018},{"style":231},[3019],{"type":176,"value":361},{"type":170,"tag":208,"props":3021,"children":3022},{"class":210,"line":1083},[3023,3028,3032],{"type":170,"tag":208,"props":3024,"children":3025},{"style":225},[3026],{"type":176,"value":3027},"    handleFn",{"type":170,"tag":208,"props":3029,"children":3030},{"style":461},[3031],{"type":176,"value":585},{"type":170,"tag":208,"props":3033,"children":3034},{"style":225},[3035],{"type":176,"value":3036}," fn\n",{"type":170,"tag":208,"props":3038,"children":3039},{"class":210,"line":2561},[3040,3045,3049,3053,3057,3061,3065,3069],{"type":170,"tag":208,"props":3041,"children":3042},{"style":225},[3043],{"type":176,"value":3044},"    console",{"type":170,"tag":208,"props":3046,"children":3047},{"style":231},[3048],{"type":176,"value":234},{"type":170,"tag":208,"props":3050,"children":3051},{"style":237},[3052],{"type":176,"value":379},{"type":170,"tag":208,"props":3054,"children":3055},{"style":274},[3056],{"type":176,"value":245},{"type":170,"tag":208,"props":3058,"children":3059},{"style":225},[3060],{"type":176,"value":1227},{"type":170,"tag":208,"props":3062,"children":3063},{"style":231},[3064],{"type":176,"value":234},{"type":170,"tag":208,"props":3066,"children":3067},{"style":225},[3068],{"type":176,"value":1958},{"type":170,"tag":208,"props":3070,"children":3071},{"style":274},[3072],{"type":176,"value":297},{"type":170,"tag":208,"props":3074,"children":3075},{"class":210,"line":2574},[3076],{"type":170,"tag":208,"props":3077,"children":3078},{"style":231},[3079],{"type":176,"value":598},{"type":170,"tag":208,"props":3081,"children":3082},{"class":210,"line":2582},[3083,3087,3091,3095,3099,3103,3107,3111,3115,3119,3123,3127,3131,3135,3139,3143],{"type":170,"tag":208,"props":3084,"children":3085},{"style":612},[3086],{"type":176,"value":1029},{"type":170,"tag":208,"props":3088,"children":3089},{"style":231},[3090],{"type":176,"value":620},{"type":170,"tag":208,"props":3092,"children":3093},{"style":347},[3094],{"type":176,"value":1958},{"type":170,"tag":208,"props":3096,"children":3097},{"style":231},[3098],{"type":176,"value":266},{"type":170,"tag":208,"props":3100,"children":3101},{"style":347},[3102],{"type":176,"value":277},{"type":170,"tag":208,"props":3104,"children":3105},{"style":231},[3106],{"type":176,"value":266},{"type":170,"tag":208,"props":3108,"children":3109},{"style":347},[3110],{"type":176,"value":2033},{"type":170,"tag":208,"props":3112,"children":3113},{"style":461},[3114],{"type":176,"value":585},{"type":170,"tag":208,"props":3116,"children":3117},{"style":231},[3118],{"type":176,"value":1142},{"type":170,"tag":208,"props":3120,"children":3121},{"style":347},[3122],{"type":176,"value":1976},{"type":170,"tag":208,"props":3124,"children":3125},{"style":461},[3126],{"type":176,"value":585},{"type":170,"tag":208,"props":3128,"children":3129},{"style":568},[3130],{"type":176,"value":1156},{"type":170,"tag":208,"props":3132,"children":3133},{"style":231},[3134],{"type":176,"value":234},{"type":170,"tag":208,"props":3136,"children":3137},{"style":225},[3138],{"type":176,"value":1902},{"type":170,"tag":208,"props":3140,"children":3141},{"style":231},[3142],{"type":176,"value":630},{"type":170,"tag":208,"props":3144,"children":3145},{"style":231},[3146],{"type":176,"value":361},{"type":170,"tag":208,"props":3148,"children":3150},{"class":210,"line":3149},21,[3151,3156,3160,3164,3168,3172],{"type":170,"tag":208,"props":3152,"children":3153},{"style":353},[3154],{"type":176,"value":3155},"    const",{"type":170,"tag":208,"props":3157,"children":3158},{"style":1181},[3159],{"type":176,"value":1184},{"type":170,"tag":208,"props":3161,"children":3162},{"style":461},[3163],{"type":176,"value":585},{"type":170,"tag":208,"props":3165,"children":3166},{"style":461},[3167],{"type":176,"value":1193},{"type":170,"tag":208,"props":3169,"children":3170},{"style":237},[3171],{"type":176,"value":541},{"type":170,"tag":208,"props":3173,"children":3174},{"style":274},[3175],{"type":176,"value":1202},{"type":170,"tag":208,"props":3177,"children":3179},{"class":210,"line":3178},22,[3180,3185,3189,3193,3197,3201,3205,3209,3213],{"type":170,"tag":208,"props":3181,"children":3182},{"style":225},[3183],{"type":176,"value":3184},"    Object",{"type":170,"tag":208,"props":3186,"children":3187},{"style":231},[3188],{"type":176,"value":234},{"type":170,"tag":208,"props":3190,"children":3191},{"style":237},[3192],{"type":176,"value":826},{"type":170,"tag":208,"props":3194,"children":3195},{"style":274},[3196],{"type":176,"value":245},{"type":170,"tag":208,"props":3198,"children":3199},{"style":225},[3200],{"type":176,"value":1227},{"type":170,"tag":208,"props":3202,"children":3203},{"style":231},[3204],{"type":176,"value":266},{"type":170,"tag":208,"props":3206,"children":3207},{"style":225},[3208],{"type":176,"value":891},{"type":170,"tag":208,"props":3210,"children":3211},{"style":231},[3212],{"type":176,"value":266},{"type":170,"tag":208,"props":3214,"children":3215},{"style":231},[3216],{"type":176,"value":361},{"type":170,"tag":208,"props":3218,"children":3220},{"class":210,"line":3219},23,[3221,3226,3230,3234],{"type":170,"tag":208,"props":3222,"children":3223},{"style":274},[3224],{"type":176,"value":3225},"      enumerable",{"type":170,"tag":208,"props":3227,"children":3228},{"style":231},[3229],{"type":176,"value":282},{"type":170,"tag":208,"props":3231,"children":3232},{"style":922},[3233],{"type":176,"value":925},{"type":170,"tag":208,"props":3235,"children":3236},{"style":231},[3237],{"type":176,"value":930},{"type":170,"tag":208,"props":3239,"children":3241},{"class":210,"line":3240},24,[3242,3247,3251,3255],{"type":170,"tag":208,"props":3243,"children":3244},{"style":274},[3245],{"type":176,"value":3246},"      configurable",{"type":170,"tag":208,"props":3248,"children":3249},{"style":231},[3250],{"type":176,"value":282},{"type":170,"tag":208,"props":3252,"children":3253},{"style":922},[3254],{"type":176,"value":925},{"type":170,"tag":208,"props":3256,"children":3257},{"style":231},[3258],{"type":176,"value":930},{"type":170,"tag":208,"props":3260,"children":3262},{"class":210,"line":3261},25,[3263,3268,3272,3276,3280],{"type":170,"tag":208,"props":3264,"children":3265},{"style":237},[3266],{"type":176,"value":3267},"      get",{"type":170,"tag":208,"props":3269,"children":3270},{"style":231},[3271],{"type":176,"value":282},{"type":170,"tag":208,"props":3273,"children":3274},{"style":231},[3275],{"type":176,"value":558},{"type":170,"tag":208,"props":3277,"children":3278},{"style":353},[3279],{"type":176,"value":356},{"type":170,"tag":208,"props":3281,"children":3282},{"style":231},[3283],{"type":176,"value":361},{"type":170,"tag":208,"props":3285,"children":3287},{"class":210,"line":3286},26,[3288,3293,3297],{"type":170,"tag":208,"props":3289,"children":3290},{"style":225},[3291],{"type":176,"value":3292},"        handleDep",{"type":170,"tag":208,"props":3294,"children":3295},{"style":461},[3296],{"type":176,"value":585},{"type":170,"tag":208,"props":3298,"children":3299},{"style":225},[3300],{"type":176,"value":1645},{"type":170,"tag":208,"props":3302,"children":3304},{"class":210,"line":3303},27,[3305,3309,3313,3317],{"type":170,"tag":208,"props":3306,"children":3307},{"style":225},[3308],{"type":176,"value":3292},{"type":170,"tag":208,"props":3310,"children":3311},{"style":231},[3312],{"type":176,"value":234},{"type":170,"tag":208,"props":3314,"children":3315},{"style":237},[3316],{"type":176,"value":2611},{"type":170,"tag":208,"props":3318,"children":3319},{"style":274},[3320],{"type":176,"value":1202},{"type":170,"tag":208,"props":3322,"children":3324},{"class":210,"line":3323},28,[3325,3330],{"type":170,"tag":208,"props":3326,"children":3327},{"style":996},[3328],{"type":176,"value":3329},"        return",{"type":170,"tag":208,"props":3331,"children":3332},{"style":225},[3333],{"type":176,"value":1004},{"type":170,"tag":208,"props":3335,"children":3337},{"class":210,"line":3336},29,[3338],{"type":170,"tag":208,"props":3339,"children":3340},{"style":231},[3341],{"type":176,"value":3342},"      },\n",{"type":170,"tag":208,"props":3344,"children":3346},{"class":210,"line":3345},30,[3347,3352,3356,3360,3364],{"type":170,"tag":208,"props":3348,"children":3349},{"style":237},[3350],{"type":176,"value":3351},"      set",{"type":170,"tag":208,"props":3353,"children":3354},{"style":231},[3355],{"type":176,"value":282},{"type":170,"tag":208,"props":3357,"children":3358},{"style":347},[3359],{"type":176,"value":350},{"type":170,"tag":208,"props":3361,"children":3362},{"style":353},[3363],{"type":176,"value":356},{"type":170,"tag":208,"props":3365,"children":3366},{"style":231},[3367],{"type":176,"value":2001},{"type":170,"tag":208,"props":3369,"children":3371},{"class":210,"line":3370},31,[3372,3377],{"type":170,"tag":208,"props":3373,"children":3374},{"style":231},[3375],{"type":176,"value":3376},"    }",{"type":170,"tag":208,"props":3378,"children":3379},{"style":274},[3380],{"type":176,"value":297},{"type":170,"tag":208,"props":3382,"children":3384},{"class":210,"line":3383},32,[3385],{"type":170,"tag":208,"props":3386,"children":3387},{"style":231},[3388],{"type":176,"value":598},{"type":170,"tag":208,"props":3390,"children":3392},{"class":210,"line":3391},33,[3393],{"type":170,"tag":208,"props":3394,"children":3395},{"style":231},[3396],{"type":176,"value":801},{"type":170,"tag":171,"props":3398,"children":3400},{"id":3399},"处理-key-值为对象链的情况",[3401],{"type":176,"value":3402},"处理 key 值为对象链的情况",{"type":170,"tag":178,"props":3404,"children":3405},{},[3406,3408,3414],{"type":176,"value":3407},"在先前的 watch 函数中, 我们使用 console.log(obj.key)去触发对应属性的 getter, 如果我们调用方式是",{"type":170,"tag":184,"props":3409,"children":3411},{"className":3410},[],[3412],{"type":176,"value":3413},"watch('a.b.c')",{"type":176,"value":3415},"就无能为力了. 这里我们封装一个通用方法, 用于处理对象链字符串的形式:",{"type":170,"tag":198,"props":3417,"children":3419},{"className":200,"code":3418,"language":202,"meta":163,"style":163},"// 通过将字符串'a.b'分割为['a', 'b'], 再使用一个while循环就可以走完这个对象链\nfunction walkChains (key, obj) {\n  const segments = key.split('.')\n  let deepObj = obj\n  while (segments.length) {\n    deepObj = deepObj[segments.shift()]\n  }\n}\nclass VX {\n  watch (key, fn, obj = this.store) {\n    handleFn = fn\n    walkChains(key, obj)\n  }\n}\n",[3420],{"type":170,"tag":184,"props":3421,"children":3422},{"__ignoreMap":163},[3423,3431,3468,3517,3538,3572,3611,3618,3625,3640,3695,3710,3738,3745],{"type":170,"tag":208,"props":3424,"children":3425},{"class":210,"line":211},[3426],{"type":170,"tag":208,"props":3427,"children":3428},{"style":215},[3429],{"type":176,"value":3430},"// 通过将字符串'a.b'分割为['a', 'b'], 再使用一个while循环就可以走完这个对象链\n",{"type":170,"tag":208,"props":3432,"children":3433},{"class":210,"line":221},[3434,3439,3444,3448,3452,3456,3460,3464],{"type":170,"tag":208,"props":3435,"children":3436},{"style":353},[3437],{"type":176,"value":3438},"function",{"type":170,"tag":208,"props":3440,"children":3441},{"style":237},[3442],{"type":176,"value":3443}," walkChains",{"type":170,"tag":208,"props":3445,"children":3446},{"style":231},[3447],{"type":176,"value":620},{"type":170,"tag":208,"props":3449,"children":3450},{"style":347},[3451],{"type":176,"value":1958},{"type":170,"tag":208,"props":3453,"children":3454},{"style":231},[3455],{"type":176,"value":266},{"type":170,"tag":208,"props":3457,"children":3458},{"style":347},[3459],{"type":176,"value":1976},{"type":170,"tag":208,"props":3461,"children":3462},{"style":231},[3463],{"type":176,"value":630},{"type":170,"tag":208,"props":3465,"children":3466},{"style":231},[3467],{"type":176,"value":361},{"type":170,"tag":208,"props":3469,"children":3470},{"class":210,"line":300},[3471,3475,3480,3484,3488,3492,3497,3501,3505,3509,3513],{"type":170,"tag":208,"props":3472,"children":3473},{"style":353},[3474],{"type":176,"value":1178},{"type":170,"tag":208,"props":3476,"children":3477},{"style":1181},[3478],{"type":176,"value":3479}," segments",{"type":170,"tag":208,"props":3481,"children":3482},{"style":461},[3483],{"type":176,"value":585},{"type":170,"tag":208,"props":3485,"children":3486},{"style":225},[3487],{"type":176,"value":891},{"type":170,"tag":208,"props":3489,"children":3490},{"style":231},[3491],{"type":176,"value":234},{"type":170,"tag":208,"props":3493,"children":3494},{"style":237},[3495],{"type":176,"value":3496},"split",{"type":170,"tag":208,"props":3498,"children":3499},{"style":274},[3500],{"type":176,"value":245},{"type":170,"tag":208,"props":3502,"children":3503},{"style":248},[3504],{"type":176,"value":251},{"type":170,"tag":208,"props":3506,"children":3507},{"style":254},[3508],{"type":176,"value":234},{"type":170,"tag":208,"props":3510,"children":3511},{"style":248},[3512],{"type":176,"value":251},{"type":170,"tag":208,"props":3514,"children":3515},{"style":274},[3516],{"type":176,"value":297},{"type":170,"tag":208,"props":3518,"children":3519},{"class":210,"line":309},[3520,3524,3529,3533],{"type":170,"tag":208,"props":3521,"children":3522},{"style":353},[3523],{"type":176,"value":2137},{"type":170,"tag":208,"props":3525,"children":3526},{"style":225},[3527],{"type":176,"value":3528}," deepObj",{"type":170,"tag":208,"props":3530,"children":3531},{"style":461},[3532],{"type":176,"value":585},{"type":170,"tag":208,"props":3534,"children":3535},{"style":225},[3536],{"type":176,"value":3537}," obj\n",{"type":170,"tag":208,"props":3539,"children":3540},{"class":210,"line":364},[3541,3546,3550,3555,3559,3564,3568],{"type":170,"tag":208,"props":3542,"children":3543},{"style":996},[3544],{"type":176,"value":3545},"  while",{"type":170,"tag":208,"props":3547,"children":3548},{"style":274},[3549],{"type":176,"value":620},{"type":170,"tag":208,"props":3551,"children":3552},{"style":225},[3553],{"type":176,"value":3554},"segments",{"type":170,"tag":208,"props":3556,"children":3557},{"style":231},[3558],{"type":176,"value":234},{"type":170,"tag":208,"props":3560,"children":3561},{"style":1181},[3562],{"type":176,"value":3563},"length",{"type":170,"tag":208,"props":3565,"children":3566},{"style":274},[3567],{"type":176,"value":1381},{"type":170,"tag":208,"props":3569,"children":3570},{"style":231},[3571],{"type":176,"value":1170},{"type":170,"tag":208,"props":3573,"children":3574},{"class":210,"line":412},[3575,3580,3584,3588,3593,3597,3601,3606],{"type":170,"tag":208,"props":3576,"children":3577},{"style":225},[3578],{"type":176,"value":3579},"    deepObj",{"type":170,"tag":208,"props":3581,"children":3582},{"style":461},[3583],{"type":176,"value":585},{"type":170,"tag":208,"props":3585,"children":3586},{"style":225},[3587],{"type":176,"value":3528},{"type":170,"tag":208,"props":3589,"children":3590},{"style":274},[3591],{"type":176,"value":3592},"[",{"type":170,"tag":208,"props":3594,"children":3595},{"style":225},[3596],{"type":176,"value":3554},{"type":170,"tag":208,"props":3598,"children":3599},{"style":231},[3600],{"type":176,"value":234},{"type":170,"tag":208,"props":3602,"children":3603},{"style":237},[3604],{"type":176,"value":3605},"shift",{"type":170,"tag":208,"props":3607,"children":3608},{"style":274},[3609],{"type":176,"value":3610},"()]\n",{"type":170,"tag":208,"props":3612,"children":3613},{"class":210,"line":425},[3614],{"type":170,"tag":208,"props":3615,"children":3616},{"style":231},[3617],{"type":176,"value":598},{"type":170,"tag":208,"props":3619,"children":3620},{"class":210,"line":679},[3621],{"type":170,"tag":208,"props":3622,"children":3623},{"style":231},[3624],{"type":176,"value":801},{"type":170,"tag":208,"props":3626,"children":3627},{"class":210,"line":688},[3628,3632,3636],{"type":170,"tag":208,"props":3629,"children":3630},{"style":353},[3631],{"type":176,"value":535},{"type":170,"tag":208,"props":3633,"children":3634},{"style":538},[3635],{"type":176,"value":1867},{"type":170,"tag":208,"props":3637,"children":3638},{"style":231},[3639],{"type":176,"value":361},{"type":170,"tag":208,"props":3641,"children":3642},{"class":210,"line":723},[3643,3647,3651,3655,3659,3663,3667,3671,3675,3679,3683,3687,3691],{"type":170,"tag":208,"props":3644,"children":3645},{"style":612},[3646],{"type":176,"value":1949},{"type":170,"tag":208,"props":3648,"children":3649},{"style":231},[3650],{"type":176,"value":620},{"type":170,"tag":208,"props":3652,"children":3653},{"style":347},[3654],{"type":176,"value":1958},{"type":170,"tag":208,"props":3656,"children":3657},{"style":231},[3658],{"type":176,"value":266},{"type":170,"tag":208,"props":3660,"children":3661},{"style":347},[3662],{"type":176,"value":1967},{"type":170,"tag":208,"props":3664,"children":3665},{"style":231},[3666],{"type":176,"value":266},{"type":170,"tag":208,"props":3668,"children":3669},{"style":347},[3670],{"type":176,"value":1976},{"type":170,"tag":208,"props":3672,"children":3673},{"style":461},[3674],{"type":176,"value":585},{"type":170,"tag":208,"props":3676,"children":3677},{"style":568},[3678],{"type":176,"value":1156},{"type":170,"tag":208,"props":3680,"children":3681},{"style":231},[3682],{"type":176,"value":234},{"type":170,"tag":208,"props":3684,"children":3685},{"style":225},[3686],{"type":176,"value":1902},{"type":170,"tag":208,"props":3688,"children":3689},{"style":231},[3690],{"type":176,"value":630},{"type":170,"tag":208,"props":3692,"children":3693},{"style":231},[3694],{"type":176,"value":361},{"type":170,"tag":208,"props":3696,"children":3697},{"class":210,"line":787},[3698,3702,3706],{"type":170,"tag":208,"props":3699,"children":3700},{"style":225},[3701],{"type":176,"value":3027},{"type":170,"tag":208,"props":3703,"children":3704},{"style":461},[3705],{"type":176,"value":585},{"type":170,"tag":208,"props":3707,"children":3708},{"style":225},[3709],{"type":176,"value":3036},{"type":170,"tag":208,"props":3711,"children":3712},{"class":210,"line":795},[3713,3718,3722,3726,3730,3734],{"type":170,"tag":208,"props":3714,"children":3715},{"style":237},[3716],{"type":176,"value":3717},"    walkChains",{"type":170,"tag":208,"props":3719,"children":3720},{"style":274},[3721],{"type":176,"value":245},{"type":170,"tag":208,"props":3723,"children":3724},{"style":225},[3725],{"type":176,"value":1958},{"type":170,"tag":208,"props":3727,"children":3728},{"style":231},[3729],{"type":176,"value":266},{"type":170,"tag":208,"props":3731,"children":3732},{"style":225},[3733],{"type":176,"value":1976},{"type":170,"tag":208,"props":3735,"children":3736},{"style":274},[3737],{"type":176,"value":297},{"type":170,"tag":208,"props":3739,"children":3740},{"class":210,"line":1023},[3741],{"type":170,"tag":208,"props":3742,"children":3743},{"style":231},[3744],{"type":176,"value":598},{"type":170,"tag":208,"props":3746,"children":3747},{"class":210,"line":1048},[3748],{"type":170,"tag":208,"props":3749,"children":3750},{"style":231},[3751],{"type":176,"value":801},{"type":170,"tag":178,"props":3753,"children":3754},{},[3755,3757,3763],{"type":176,"value":3756},"在 set 方法中处理对象链字符串稍微有些不同, 因为如果",{"type":170,"tag":184,"props":3758,"children":3760},{"className":3759},[],[3761],{"type":176,"value":3762},"set('a.b')",{"type":176,"value":3764},"时, 没有在我们全局对象中找到 a 属性, 这里应该抛错.",{"type":170,"tag":178,"props":3766,"children":3767},{},[3768,3770,3776],{"type":176,"value":3769},"实际的处理中, 需要推断'obj.a'以及'obj.a.b'是否存在. 假设没有'obj.a', 那么我们应该创建一个新的对象, 并且给新的对象添加属性'b', 所以代码类似",{"type":170,"tag":184,"props":3771,"children":3773},{"className":3772},[],[3774],{"type":176,"value":3775},"walkChains",{"type":176,"value":3777},"函数, 只是稍作一层判断:",{"type":170,"tag":198,"props":3779,"children":3781},{"className":200,"code":3780,"language":202,"meta":163,"style":163},"set (key, val, obj) {\n  const segments = key.split('.')\n  // 这里需要注意, 我们只处理到倒数第二个属性\n  while (segments.length > 1) {\n    const handleKey = segments.shift()\n    const handleVal = obj[handleKey]\n    // 存在'obj.a'的情况\n    if (typeof handleVal === 'object') {\n      obj = handleVal\n    // 不存在'obj.a'则给a属性赋一个非响应式的对象\n    } else if (!handleVal) {\n      obj = (\n        key = handleKey,\n        obj[handleKey] = {},\n        obj[handleKey]\n      )\n    } else {\n      console.trace('already has val')\n    }\n  }\n  // 最后一个属性要手动赋值\n  key = segments[0]\n}\n",[3782],{"type":170,"tag":184,"props":3783,"children":3784},{"__ignoreMap":163},[3785,3817,3864,3872,3913,3945,3979,3987,4033,4050,4058,4097,4113,4133,4163,4182,4190,4205,4242,4249,4256,4264,4293],{"type":170,"tag":208,"props":3786,"children":3787},{"class":210,"line":211},[3788,3792,3796,3800,3804,3808,3813],{"type":170,"tag":208,"props":3789,"children":3790},{"style":237},[3791],{"type":176,"value":240},{"type":170,"tag":208,"props":3793,"children":3794},{"style":225},[3795],{"type":176,"value":1116},{"type":170,"tag":208,"props":3797,"children":3798},{"style":231},[3799],{"type":176,"value":266},{"type":170,"tag":208,"props":3801,"children":3802},{"style":225},[3803],{"type":176,"value":277},{"type":170,"tag":208,"props":3805,"children":3806},{"style":231},[3807],{"type":176,"value":266},{"type":170,"tag":208,"props":3809,"children":3810},{"style":225},[3811],{"type":176,"value":3812}," obj) ",{"type":170,"tag":208,"props":3814,"children":3815},{"style":231},[3816],{"type":176,"value":1170},{"type":170,"tag":208,"props":3818,"children":3819},{"class":210,"line":221},[3820,3824,3828,3832,3836,3840,3844,3848,3852,3856,3860],{"type":170,"tag":208,"props":3821,"children":3822},{"style":353},[3823],{"type":176,"value":1178},{"type":170,"tag":208,"props":3825,"children":3826},{"style":1181},[3827],{"type":176,"value":3479},{"type":170,"tag":208,"props":3829,"children":3830},{"style":461},[3831],{"type":176,"value":585},{"type":170,"tag":208,"props":3833,"children":3834},{"style":225},[3835],{"type":176,"value":891},{"type":170,"tag":208,"props":3837,"children":3838},{"style":231},[3839],{"type":176,"value":234},{"type":170,"tag":208,"props":3841,"children":3842},{"style":237},[3843],{"type":176,"value":3496},{"type":170,"tag":208,"props":3845,"children":3846},{"style":274},[3847],{"type":176,"value":245},{"type":170,"tag":208,"props":3849,"children":3850},{"style":248},[3851],{"type":176,"value":251},{"type":170,"tag":208,"props":3853,"children":3854},{"style":254},[3855],{"type":176,"value":234},{"type":170,"tag":208,"props":3857,"children":3858},{"style":248},[3859],{"type":176,"value":251},{"type":170,"tag":208,"props":3861,"children":3862},{"style":274},[3863],{"type":176,"value":297},{"type":170,"tag":208,"props":3865,"children":3866},{"class":210,"line":300},[3867],{"type":170,"tag":208,"props":3868,"children":3869},{"style":215},[3870],{"type":176,"value":3871},"  // 这里需要注意, 我们只处理到倒数第二个属性\n",{"type":170,"tag":208,"props":3873,"children":3874},{"class":210,"line":309},[3875,3879,3883,3887,3891,3895,3900,3905,3909],{"type":170,"tag":208,"props":3876,"children":3877},{"style":996},[3878],{"type":176,"value":3545},{"type":170,"tag":208,"props":3880,"children":3881},{"style":274},[3882],{"type":176,"value":620},{"type":170,"tag":208,"props":3884,"children":3885},{"style":225},[3886],{"type":176,"value":3554},{"type":170,"tag":208,"props":3888,"children":3889},{"style":231},[3890],{"type":176,"value":234},{"type":170,"tag":208,"props":3892,"children":3893},{"style":1181},[3894],{"type":176,"value":3563},{"type":170,"tag":208,"props":3896,"children":3897},{"style":461},[3898],{"type":176,"value":3899}," >",{"type":170,"tag":208,"props":3901,"children":3902},{"style":467},[3903],{"type":176,"value":3904}," 1",{"type":170,"tag":208,"props":3906,"children":3907},{"style":274},[3908],{"type":176,"value":1381},{"type":170,"tag":208,"props":3910,"children":3911},{"style":231},[3912],{"type":176,"value":1170},{"type":170,"tag":208,"props":3914,"children":3915},{"class":210,"line":364},[3916,3920,3925,3929,3933,3937,3941],{"type":170,"tag":208,"props":3917,"children":3918},{"style":353},[3919],{"type":176,"value":3155},{"type":170,"tag":208,"props":3921,"children":3922},{"style":1181},[3923],{"type":176,"value":3924}," handleKey",{"type":170,"tag":208,"props":3926,"children":3927},{"style":461},[3928],{"type":176,"value":585},{"type":170,"tag":208,"props":3930,"children":3931},{"style":225},[3932],{"type":176,"value":3479},{"type":170,"tag":208,"props":3934,"children":3935},{"style":231},[3936],{"type":176,"value":234},{"type":170,"tag":208,"props":3938,"children":3939},{"style":237},[3940],{"type":176,"value":3605},{"type":170,"tag":208,"props":3942,"children":3943},{"style":274},[3944],{"type":176,"value":1202},{"type":170,"tag":208,"props":3946,"children":3947},{"class":210,"line":412},[3948,3952,3957,3961,3965,3969,3974],{"type":170,"tag":208,"props":3949,"children":3950},{"style":353},[3951],{"type":176,"value":3155},{"type":170,"tag":208,"props":3953,"children":3954},{"style":1181},[3955],{"type":176,"value":3956}," handleVal",{"type":170,"tag":208,"props":3958,"children":3959},{"style":461},[3960],{"type":176,"value":585},{"type":170,"tag":208,"props":3962,"children":3963},{"style":225},[3964],{"type":176,"value":1976},{"type":170,"tag":208,"props":3966,"children":3967},{"style":274},[3968],{"type":176,"value":3592},{"type":170,"tag":208,"props":3970,"children":3971},{"style":225},[3972],{"type":176,"value":3973},"handleKey",{"type":170,"tag":208,"props":3975,"children":3976},{"style":274},[3977],{"type":176,"value":3978},"]\n",{"type":170,"tag":208,"props":3980,"children":3981},{"class":210,"line":425},[3982],{"type":170,"tag":208,"props":3983,"children":3984},{"style":215},[3985],{"type":176,"value":3986},"    // 存在'obj.a'的情况\n",{"type":170,"tag":208,"props":3988,"children":3989},{"class":210,"line":679},[3990,3994,3998,4003,4007,4011,4016,4021,4025,4029],{"type":170,"tag":208,"props":3991,"children":3992},{"style":996},[3993],{"type":176,"value":2767},{"type":170,"tag":208,"props":3995,"children":3996},{"style":274},[3997],{"type":176,"value":620},{"type":170,"tag":208,"props":3999,"children":4000},{"style":461},[4001],{"type":176,"value":4002},"typeof",{"type":170,"tag":208,"props":4004,"children":4005},{"style":225},[4006],{"type":176,"value":3956},{"type":170,"tag":208,"props":4008,"children":4009},{"style":461},[4010],{"type":176,"value":1372},{"type":170,"tag":208,"props":4012,"children":4013},{"style":248},[4014],{"type":176,"value":4015}," '",{"type":170,"tag":208,"props":4017,"children":4018},{"style":254},[4019],{"type":176,"value":4020},"object",{"type":170,"tag":208,"props":4022,"children":4023},{"style":248},[4024],{"type":176,"value":251},{"type":170,"tag":208,"props":4026,"children":4027},{"style":274},[4028],{"type":176,"value":1381},{"type":170,"tag":208,"props":4030,"children":4031},{"style":231},[4032],{"type":176,"value":1170},{"type":170,"tag":208,"props":4034,"children":4035},{"class":210,"line":688},[4036,4041,4045],{"type":170,"tag":208,"props":4037,"children":4038},{"style":225},[4039],{"type":176,"value":4040},"      obj",{"type":170,"tag":208,"props":4042,"children":4043},{"style":461},[4044],{"type":176,"value":585},{"type":170,"tag":208,"props":4046,"children":4047},{"style":225},[4048],{"type":176,"value":4049}," handleVal\n",{"type":170,"tag":208,"props":4051,"children":4052},{"class":210,"line":723},[4053],{"type":170,"tag":208,"props":4054,"children":4055},{"style":215},[4056],{"type":176,"value":4057},"    // 不存在'obj.a'则给a属性赋一个非响应式的对象\n",{"type":170,"tag":208,"props":4059,"children":4060},{"class":210,"line":787},[4061,4065,4070,4075,4079,4084,4089,4093],{"type":170,"tag":208,"props":4062,"children":4063},{"style":231},[4064],{"type":176,"value":3376},{"type":170,"tag":208,"props":4066,"children":4067},{"style":996},[4068],{"type":176,"value":4069}," else",{"type":170,"tag":208,"props":4071,"children":4072},{"style":996},[4073],{"type":176,"value":4074}," if",{"type":170,"tag":208,"props":4076,"children":4077},{"style":274},[4078],{"type":176,"value":620},{"type":170,"tag":208,"props":4080,"children":4081},{"style":461},[4082],{"type":176,"value":4083},"!",{"type":170,"tag":208,"props":4085,"children":4086},{"style":225},[4087],{"type":176,"value":4088},"handleVal",{"type":170,"tag":208,"props":4090,"children":4091},{"style":274},[4092],{"type":176,"value":1381},{"type":170,"tag":208,"props":4094,"children":4095},{"style":231},[4096],{"type":176,"value":1170},{"type":170,"tag":208,"props":4098,"children":4099},{"class":210,"line":795},[4100,4104,4108],{"type":170,"tag":208,"props":4101,"children":4102},{"style":237},[4103],{"type":176,"value":4040},{"type":170,"tag":208,"props":4105,"children":4106},{"style":461},[4107],{"type":176,"value":585},{"type":170,"tag":208,"props":4109,"children":4110},{"style":274},[4111],{"type":176,"value":4112}," (\n",{"type":170,"tag":208,"props":4114,"children":4115},{"class":210,"line":1023},[4116,4121,4125,4129],{"type":170,"tag":208,"props":4117,"children":4118},{"style":225},[4119],{"type":176,"value":4120},"        key",{"type":170,"tag":208,"props":4122,"children":4123},{"style":461},[4124],{"type":176,"value":585},{"type":170,"tag":208,"props":4126,"children":4127},{"style":347},[4128],{"type":176,"value":3924},{"type":170,"tag":208,"props":4130,"children":4131},{"style":231},[4132],{"type":176,"value":930},{"type":170,"tag":208,"props":4134,"children":4135},{"class":210,"line":1048},[4136,4141,4145,4149,4154,4158],{"type":170,"tag":208,"props":4137,"children":4138},{"style":225},[4139],{"type":176,"value":4140},"        obj",{"type":170,"tag":208,"props":4142,"children":4143},{"style":274},[4144],{"type":176,"value":3592},{"type":170,"tag":208,"props":4146,"children":4147},{"style":225},[4148],{"type":176,"value":3973},{"type":170,"tag":208,"props":4150,"children":4151},{"style":274},[4152],{"type":176,"value":4153},"] ",{"type":170,"tag":208,"props":4155,"children":4156},{"style":461},[4157],{"type":176,"value":464},{"type":170,"tag":208,"props":4159,"children":4160},{"style":231},[4161],{"type":176,"value":4162}," {},\n",{"type":170,"tag":208,"props":4164,"children":4165},{"class":210,"line":1066},[4166,4170,4174,4178],{"type":170,"tag":208,"props":4167,"children":4168},{"style":225},[4169],{"type":176,"value":4140},{"type":170,"tag":208,"props":4171,"children":4172},{"style":274},[4173],{"type":176,"value":3592},{"type":170,"tag":208,"props":4175,"children":4176},{"style":225},[4177],{"type":176,"value":3973},{"type":170,"tag":208,"props":4179,"children":4180},{"style":274},[4181],{"type":176,"value":3978},{"type":170,"tag":208,"props":4183,"children":4184},{"class":210,"line":1074},[4185],{"type":170,"tag":208,"props":4186,"children":4187},{"style":274},[4188],{"type":176,"value":4189},"      )\n",{"type":170,"tag":208,"props":4191,"children":4192},{"class":210,"line":1083},[4193,4197,4201],{"type":170,"tag":208,"props":4194,"children":4195},{"style":231},[4196],{"type":176,"value":3376},{"type":170,"tag":208,"props":4198,"children":4199},{"style":996},[4200],{"type":176,"value":4069},{"type":170,"tag":208,"props":4202,"children":4203},{"style":231},[4204],{"type":176,"value":361},{"type":170,"tag":208,"props":4206,"children":4207},{"class":210,"line":2561},[4208,4212,4216,4221,4225,4229,4234,4238],{"type":170,"tag":208,"props":4209,"children":4210},{"style":225},[4211],{"type":176,"value":2231},{"type":170,"tag":208,"props":4213,"children":4214},{"style":231},[4215],{"type":176,"value":234},{"type":170,"tag":208,"props":4217,"children":4218},{"style":237},[4219],{"type":176,"value":4220},"trace",{"type":170,"tag":208,"props":4222,"children":4223},{"style":274},[4224],{"type":176,"value":245},{"type":170,"tag":208,"props":4226,"children":4227},{"style":248},[4228],{"type":176,"value":251},{"type":170,"tag":208,"props":4230,"children":4231},{"style":254},[4232],{"type":176,"value":4233},"already has val",{"type":170,"tag":208,"props":4235,"children":4236},{"style":248},[4237],{"type":176,"value":251},{"type":170,"tag":208,"props":4239,"children":4240},{"style":274},[4241],{"type":176,"value":297},{"type":170,"tag":208,"props":4243,"children":4244},{"class":210,"line":2574},[4245],{"type":170,"tag":208,"props":4246,"children":4247},{"style":231},[4248],{"type":176,"value":1461},{"type":170,"tag":208,"props":4250,"children":4251},{"class":210,"line":2582},[4252],{"type":170,"tag":208,"props":4253,"children":4254},{"style":231},[4255],{"type":176,"value":598},{"type":170,"tag":208,"props":4257,"children":4258},{"class":210,"line":3149},[4259],{"type":170,"tag":208,"props":4260,"children":4261},{"style":215},[4262],{"type":176,"value":4263},"  // 最后一个属性要手动赋值\n",{"type":170,"tag":208,"props":4265,"children":4266},{"class":210,"line":3178},[4267,4272,4276,4280,4284,4289],{"type":170,"tag":208,"props":4268,"children":4269},{"style":225},[4270],{"type":176,"value":4271},"  key",{"type":170,"tag":208,"props":4273,"children":4274},{"style":461},[4275],{"type":176,"value":585},{"type":170,"tag":208,"props":4277,"children":4278},{"style":225},[4279],{"type":176,"value":3479},{"type":170,"tag":208,"props":4281,"children":4282},{"style":274},[4283],{"type":176,"value":3592},{"type":170,"tag":208,"props":4285,"children":4286},{"style":467},[4287],{"type":176,"value":4288},"0",{"type":170,"tag":208,"props":4290,"children":4291},{"style":274},[4292],{"type":176,"value":3978},{"type":170,"tag":208,"props":4294,"children":4295},{"class":210,"line":3219},[4296],{"type":170,"tag":208,"props":4297,"children":4298},{"style":231},[4299],{"type":176,"value":801},{"type":170,"tag":171,"props":4301,"children":4303},{"id":4302},"业务场景应用",[4304],{"type":176,"value":4302},{"type":170,"tag":821,"props":4306,"children":4308},{"id":4307},"小程序跨页面刷新数据",[4309],{"type":176,"value":4307},{"type":170,"tag":178,"props":4311,"children":4312},{},[4313],{"type":176,"value":4314},"我们经常碰到在小程序中由 A 页面跳转到 B 页面, 如果 B 页面进行了一些操作, 希望 A 页面自动刷新数据的情况. 但是由于 A 页面跳转到 B 页面不同(也许是 redirect,也许是 navigate), 处理方法也不尽相同.",{"type":170,"tag":178,"props":4316,"children":4317},{},[4318],{"type":176,"value":4319},"使用 navigate 方式跳转后, A 页面不会被注销, 所以我们一般会通过全局对象去贮存 A 页面实例(也就是 A 页面的 this 对象), 然后在 B 页面直接调用相应的方法(如 A.refreshList())进行刷新操作.",{"type":170,"tag":178,"props":4321,"children":4322},{},[4323,4325,4331],{"type":176,"value":4324},"引入 VX 后, 我们可以在",{"type":170,"tag":184,"props":4326,"children":4328},{"className":4327},[],[4329],{"type":176,"value":4330},"onload",{"type":176,"value":4332},"生命周期直接调用 watch 方法添加订阅:",{"type":170,"tag":198,"props":4334,"children":4336},{"className":200,"code":4335,"language":202,"meta":163,"style":163},"// app.js\nimport VX from '@/utils/suites/vx'\nconst vx = new VX()\napp.vx = vx\napp.store = vx.store\napp.vx.set('userType', '商户')\n\n// page a\nonLoad () {\n  app.vx.watch('userType', userType => {\n    if (userType === '商户') {\n      // ...\n    } else if (userType === '管理员') {\n      // ...\n    }\n  }, {\n    immediate: true\n  })\n}\n\n// page b\nswitchUserType () {\n  app.store.userType = '管理员'\n}\n",[4337],{"type":170,"tag":184,"props":4338,"children":4339},{"__ignoreMap":163},[4340,4348,4380,4407,4433,4466,4527,4534,4542,4559,4616,4655,4663,4711,4718,4725,4737,4754,4765,4772,4779,4787,4803,4842],{"type":170,"tag":208,"props":4341,"children":4342},{"class":210,"line":211},[4343],{"type":170,"tag":208,"props":4344,"children":4345},{"style":215},[4346],{"type":176,"value":4347},"// app.js\n",{"type":170,"tag":208,"props":4349,"children":4350},{"class":210,"line":221},[4351,4356,4361,4366,4370,4375],{"type":170,"tag":208,"props":4352,"children":4353},{"style":996},[4354],{"type":176,"value":4355},"import",{"type":170,"tag":208,"props":4357,"children":4358},{"style":225},[4359],{"type":176,"value":4360}," VX ",{"type":170,"tag":208,"props":4362,"children":4363},{"style":996},[4364],{"type":176,"value":4365},"from",{"type":170,"tag":208,"props":4367,"children":4368},{"style":248},[4369],{"type":176,"value":4015},{"type":170,"tag":208,"props":4371,"children":4372},{"style":254},[4373],{"type":176,"value":4374},"@/utils/suites/vx",{"type":170,"tag":208,"props":4376,"children":4377},{"style":248},[4378],{"type":176,"value":4379},"'\n",{"type":170,"tag":208,"props":4381,"children":4382},{"class":210,"line":300},[4383,4387,4391,4395,4399,4403],{"type":170,"tag":208,"props":4384,"children":4385},{"style":353},[4386],{"type":176,"value":1667},{"type":170,"tag":208,"props":4388,"children":4389},{"style":1181},[4390],{"type":176,"value":2088},{"type":170,"tag":208,"props":4392,"children":4393},{"style":461},[4394],{"type":176,"value":585},{"type":170,"tag":208,"props":4396,"children":4397},{"style":461},[4398],{"type":176,"value":1193},{"type":170,"tag":208,"props":4400,"children":4401},{"style":237},[4402],{"type":176,"value":1867},{"type":170,"tag":208,"props":4404,"children":4405},{"style":225},[4406],{"type":176,"value":1202},{"type":170,"tag":208,"props":4408,"children":4409},{"class":210,"line":309},[4410,4415,4419,4424,4428],{"type":170,"tag":208,"props":4411,"children":4412},{"style":225},[4413],{"type":176,"value":4414},"app",{"type":170,"tag":208,"props":4416,"children":4417},{"style":231},[4418],{"type":176,"value":234},{"type":170,"tag":208,"props":4420,"children":4421},{"style":225},[4422],{"type":176,"value":4423},"vx ",{"type":170,"tag":208,"props":4425,"children":4426},{"style":461},[4427],{"type":176,"value":464},{"type":170,"tag":208,"props":4429,"children":4430},{"style":225},[4431],{"type":176,"value":4432}," vx\n",{"type":170,"tag":208,"props":4434,"children":4435},{"class":210,"line":364},[4436,4440,4444,4449,4453,4457,4461],{"type":170,"tag":208,"props":4437,"children":4438},{"style":225},[4439],{"type":176,"value":4414},{"type":170,"tag":208,"props":4441,"children":4442},{"style":231},[4443],{"type":176,"value":234},{"type":170,"tag":208,"props":4445,"children":4446},{"style":225},[4447],{"type":176,"value":4448},"store ",{"type":170,"tag":208,"props":4450,"children":4451},{"style":461},[4452],{"type":176,"value":464},{"type":170,"tag":208,"props":4454,"children":4455},{"style":225},[4456],{"type":176,"value":2088},{"type":170,"tag":208,"props":4458,"children":4459},{"style":231},[4460],{"type":176,"value":234},{"type":170,"tag":208,"props":4462,"children":4463},{"style":225},[4464],{"type":176,"value":4465},"store\n",{"type":170,"tag":208,"props":4467,"children":4468},{"class":210,"line":412},[4469,4473,4477,4481,4485,4489,4493,4497,4502,4506,4510,4514,4519,4523],{"type":170,"tag":208,"props":4470,"children":4471},{"style":225},[4472],{"type":176,"value":4414},{"type":170,"tag":208,"props":4474,"children":4475},{"style":231},[4476],{"type":176,"value":234},{"type":170,"tag":208,"props":4478,"children":4479},{"style":225},[4480],{"type":176,"value":228},{"type":170,"tag":208,"props":4482,"children":4483},{"style":231},[4484],{"type":176,"value":234},{"type":170,"tag":208,"props":4486,"children":4487},{"style":237},[4488],{"type":176,"value":240},{"type":170,"tag":208,"props":4490,"children":4491},{"style":225},[4492],{"type":176,"value":245},{"type":170,"tag":208,"props":4494,"children":4495},{"style":248},[4496],{"type":176,"value":251},{"type":170,"tag":208,"props":4498,"children":4499},{"style":254},[4500],{"type":176,"value":4501},"userType",{"type":170,"tag":208,"props":4503,"children":4504},{"style":248},[4505],{"type":176,"value":251},{"type":170,"tag":208,"props":4507,"children":4508},{"style":231},[4509],{"type":176,"value":266},{"type":170,"tag":208,"props":4511,"children":4512},{"style":248},[4513],{"type":176,"value":4015},{"type":170,"tag":208,"props":4515,"children":4516},{"style":254},[4517],{"type":176,"value":4518},"商户",{"type":170,"tag":208,"props":4520,"children":4521},{"style":248},[4522],{"type":176,"value":251},{"type":170,"tag":208,"props":4524,"children":4525},{"style":225},[4526],{"type":176,"value":297},{"type":170,"tag":208,"props":4528,"children":4529},{"class":210,"line":425},[4530],{"type":170,"tag":208,"props":4531,"children":4532},{"emptyLinePlaceholder":162},[4533],{"type":176,"value":2930},{"type":170,"tag":208,"props":4535,"children":4536},{"class":210,"line":679},[4537],{"type":170,"tag":208,"props":4538,"children":4539},{"style":215},[4540],{"type":176,"value":4541},"// page a\n",{"type":170,"tag":208,"props":4543,"children":4544},{"class":210,"line":688},[4545,4550,4555],{"type":170,"tag":208,"props":4546,"children":4547},{"style":237},[4548],{"type":176,"value":4549},"onLoad",{"type":170,"tag":208,"props":4551,"children":4552},{"style":225},[4553],{"type":176,"value":4554}," () ",{"type":170,"tag":208,"props":4556,"children":4557},{"style":231},[4558],{"type":176,"value":1170},{"type":170,"tag":208,"props":4560,"children":4561},{"class":210,"line":723},[4562,4567,4571,4575,4579,4583,4587,4591,4595,4599,4603,4608,4612],{"type":170,"tag":208,"props":4563,"children":4564},{"style":225},[4565],{"type":176,"value":4566},"  app",{"type":170,"tag":208,"props":4568,"children":4569},{"style":231},[4570],{"type":176,"value":234},{"type":170,"tag":208,"props":4572,"children":4573},{"style":225},[4574],{"type":176,"value":228},{"type":170,"tag":208,"props":4576,"children":4577},{"style":231},[4578],{"type":176,"value":234},{"type":170,"tag":208,"props":4580,"children":4581},{"style":237},[4582],{"type":176,"value":323},{"type":170,"tag":208,"props":4584,"children":4585},{"style":274},[4586],{"type":176,"value":245},{"type":170,"tag":208,"props":4588,"children":4589},{"style":248},[4590],{"type":176,"value":251},{"type":170,"tag":208,"props":4592,"children":4593},{"style":254},[4594],{"type":176,"value":4501},{"type":170,"tag":208,"props":4596,"children":4597},{"style":248},[4598],{"type":176,"value":251},{"type":170,"tag":208,"props":4600,"children":4601},{"style":231},[4602],{"type":176,"value":266},{"type":170,"tag":208,"props":4604,"children":4605},{"style":347},[4606],{"type":176,"value":4607}," userType",{"type":170,"tag":208,"props":4609,"children":4610},{"style":353},[4611],{"type":176,"value":356},{"type":170,"tag":208,"props":4613,"children":4614},{"style":231},[4615],{"type":176,"value":361},{"type":170,"tag":208,"props":4617,"children":4618},{"class":210,"line":787},[4619,4623,4627,4631,4635,4639,4643,4647,4651],{"type":170,"tag":208,"props":4620,"children":4621},{"style":996},[4622],{"type":176,"value":2767},{"type":170,"tag":208,"props":4624,"children":4625},{"style":274},[4626],{"type":176,"value":620},{"type":170,"tag":208,"props":4628,"children":4629},{"style":225},[4630],{"type":176,"value":4501},{"type":170,"tag":208,"props":4632,"children":4633},{"style":461},[4634],{"type":176,"value":1372},{"type":170,"tag":208,"props":4636,"children":4637},{"style":248},[4638],{"type":176,"value":4015},{"type":170,"tag":208,"props":4640,"children":4641},{"style":254},[4642],{"type":176,"value":4518},{"type":170,"tag":208,"props":4644,"children":4645},{"style":248},[4646],{"type":176,"value":251},{"type":170,"tag":208,"props":4648,"children":4649},{"style":274},[4650],{"type":176,"value":1381},{"type":170,"tag":208,"props":4652,"children":4653},{"style":231},[4654],{"type":176,"value":1170},{"type":170,"tag":208,"props":4656,"children":4657},{"class":210,"line":795},[4658],{"type":170,"tag":208,"props":4659,"children":4660},{"style":215},[4661],{"type":176,"value":4662},"      // ...\n",{"type":170,"tag":208,"props":4664,"children":4665},{"class":210,"line":1023},[4666,4670,4674,4678,4682,4686,4690,4694,4699,4703,4707],{"type":170,"tag":208,"props":4667,"children":4668},{"style":231},[4669],{"type":176,"value":3376},{"type":170,"tag":208,"props":4671,"children":4672},{"style":996},[4673],{"type":176,"value":4069},{"type":170,"tag":208,"props":4675,"children":4676},{"style":996},[4677],{"type":176,"value":4074},{"type":170,"tag":208,"props":4679,"children":4680},{"style":274},[4681],{"type":176,"value":620},{"type":170,"tag":208,"props":4683,"children":4684},{"style":225},[4685],{"type":176,"value":4501},{"type":170,"tag":208,"props":4687,"children":4688},{"style":461},[4689],{"type":176,"value":1372},{"type":170,"tag":208,"props":4691,"children":4692},{"style":248},[4693],{"type":176,"value":4015},{"type":170,"tag":208,"props":4695,"children":4696},{"style":254},[4697],{"type":176,"value":4698},"管理员",{"type":170,"tag":208,"props":4700,"children":4701},{"style":248},[4702],{"type":176,"value":251},{"type":170,"tag":208,"props":4704,"children":4705},{"style":274},[4706],{"type":176,"value":1381},{"type":170,"tag":208,"props":4708,"children":4709},{"style":231},[4710],{"type":176,"value":1170},{"type":170,"tag":208,"props":4712,"children":4713},{"class":210,"line":1048},[4714],{"type":170,"tag":208,"props":4715,"children":4716},{"style":215},[4717],{"type":176,"value":4662},{"type":170,"tag":208,"props":4719,"children":4720},{"class":210,"line":1066},[4721],{"type":170,"tag":208,"props":4722,"children":4723},{"style":231},[4724],{"type":176,"value":1461},{"type":170,"tag":208,"props":4726,"children":4727},{"class":210,"line":1074},[4728,4733],{"type":170,"tag":208,"props":4729,"children":4730},{"style":231},[4731],{"type":176,"value":4732},"  },",{"type":170,"tag":208,"props":4734,"children":4735},{"style":231},[4736],{"type":176,"value":361},{"type":170,"tag":208,"props":4738,"children":4739},{"class":210,"line":1083},[4740,4745,4749],{"type":170,"tag":208,"props":4741,"children":4742},{"style":274},[4743],{"type":176,"value":4744},"    immediate",{"type":170,"tag":208,"props":4746,"children":4747},{"style":231},[4748],{"type":176,"value":282},{"type":170,"tag":208,"props":4750,"children":4751},{"style":922},[4752],{"type":176,"value":4753}," true\n",{"type":170,"tag":208,"props":4755,"children":4756},{"class":210,"line":2561},[4757,4761],{"type":170,"tag":208,"props":4758,"children":4759},{"style":231},[4760],{"type":176,"value":1469},{"type":170,"tag":208,"props":4762,"children":4763},{"style":274},[4764],{"type":176,"value":297},{"type":170,"tag":208,"props":4766,"children":4767},{"class":210,"line":2574},[4768],{"type":170,"tag":208,"props":4769,"children":4770},{"style":231},[4771],{"type":176,"value":801},{"type":170,"tag":208,"props":4773,"children":4774},{"class":210,"line":2582},[4775],{"type":170,"tag":208,"props":4776,"children":4777},{"emptyLinePlaceholder":162},[4778],{"type":176,"value":2930},{"type":170,"tag":208,"props":4780,"children":4781},{"class":210,"line":3149},[4782],{"type":170,"tag":208,"props":4783,"children":4784},{"style":215},[4785],{"type":176,"value":4786},"// page b\n",{"type":170,"tag":208,"props":4788,"children":4789},{"class":210,"line":3178},[4790,4795,4799],{"type":170,"tag":208,"props":4791,"children":4792},{"style":237},[4793],{"type":176,"value":4794},"switchUserType",{"type":170,"tag":208,"props":4796,"children":4797},{"style":225},[4798],{"type":176,"value":4554},{"type":170,"tag":208,"props":4800,"children":4801},{"style":231},[4802],{"type":176,"value":1170},{"type":170,"tag":208,"props":4804,"children":4805},{"class":210,"line":3219},[4806,4810,4814,4818,4822,4826,4830,4834,4838],{"type":170,"tag":208,"props":4807,"children":4808},{"style":225},[4809],{"type":176,"value":4566},{"type":170,"tag":208,"props":4811,"children":4812},{"style":231},[4813],{"type":176,"value":234},{"type":170,"tag":208,"props":4815,"children":4816},{"style":225},[4817],{"type":176,"value":1902},{"type":170,"tag":208,"props":4819,"children":4820},{"style":231},[4821],{"type":176,"value":234},{"type":170,"tag":208,"props":4823,"children":4824},{"style":225},[4825],{"type":176,"value":4501},{"type":170,"tag":208,"props":4827,"children":4828},{"style":461},[4829],{"type":176,"value":585},{"type":170,"tag":208,"props":4831,"children":4832},{"style":248},[4833],{"type":176,"value":4015},{"type":170,"tag":208,"props":4835,"children":4836},{"style":254},[4837],{"type":176,"value":4698},{"type":170,"tag":208,"props":4839,"children":4840},{"style":248},[4841],{"type":176,"value":4379},{"type":170,"tag":208,"props":4843,"children":4844},{"class":210,"line":3240},[4845],{"type":170,"tag":208,"props":4846,"children":4847},{"style":231},[4848],{"type":176,"value":801},{"type":170,"tag":171,"props":4850,"children":4852},{"id":4851},"可能遇到的问题",[4853],{"type":176,"value":4851},{"type":170,"tag":821,"props":4855,"children":4857},{"id":4856},"给-watch-方法添加的函数设置立即执行",[4858],{"type":176,"value":4859},"给 watch 方法添加的函数设置立即执行",{"type":170,"tag":178,"props":4861,"children":4862},{},[4863],{"type":176,"value":4864},"有的时候我们希望通过 watch 添加函数的同时还立即执行该函数一次, 这个时候我们需要再定义额外的参数传递到 watch 中. 问题是这个函数不一定是同步函数.",{"type":170,"tag":178,"props":4866,"children":4867},{},[4868],{"type":176,"value":4869},"简单处理如下:",{"type":170,"tag":198,"props":4871,"children":4873},{"className":200,"code":4872,"language":202,"meta":163,"style":163},"class VX {\n  async watch (key, fn, options = { immediately: false }, obj = this.store) {\n    handleDep = fn\n    walkChains(key, obj)\n    options.immediately && await fn(options.defaultParams)\n  }\n}\n",[4874],{"type":170,"tag":184,"props":4875,"children":4876},{"__ignoreMap":163},[4877,4892,4985,5001,5028,5080,5087],{"type":170,"tag":208,"props":4878,"children":4879},{"class":210,"line":211},[4880,4884,4888],{"type":170,"tag":208,"props":4881,"children":4882},{"style":353},[4883],{"type":176,"value":535},{"type":170,"tag":208,"props":4885,"children":4886},{"style":538},[4887],{"type":176,"value":1867},{"type":170,"tag":208,"props":4889,"children":4890},{"style":231},[4891],{"type":176,"value":361},{"type":170,"tag":208,"props":4893,"children":4894},{"class":210,"line":221},[4895,4901,4906,4910,4914,4918,4922,4926,4930,4934,4938,4943,4947,4952,4957,4961,4965,4969,4973,4977,4981],{"type":170,"tag":208,"props":4896,"children":4898},{"style":4897},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[4899],{"type":176,"value":4900},"  async",{"type":170,"tag":208,"props":4902,"children":4903},{"style":612},[4904],{"type":176,"value":4905}," watch",{"type":170,"tag":208,"props":4907,"children":4908},{"style":231},[4909],{"type":176,"value":620},{"type":170,"tag":208,"props":4911,"children":4912},{"style":347},[4913],{"type":176,"value":1958},{"type":170,"tag":208,"props":4915,"children":4916},{"style":231},[4917],{"type":176,"value":266},{"type":170,"tag":208,"props":4919,"children":4920},{"style":347},[4921],{"type":176,"value":1967},{"type":170,"tag":208,"props":4923,"children":4924},{"style":231},[4925],{"type":176,"value":266},{"type":170,"tag":208,"props":4927,"children":4928},{"style":347},[4929],{"type":176,"value":2033},{"type":170,"tag":208,"props":4931,"children":4932},{"style":461},[4933],{"type":176,"value":585},{"type":170,"tag":208,"props":4935,"children":4936},{"style":231},[4937],{"type":176,"value":271},{"type":170,"tag":208,"props":4939,"children":4940},{"style":274},[4941],{"type":176,"value":4942}," immediately",{"type":170,"tag":208,"props":4944,"children":4945},{"style":231},[4946],{"type":176,"value":282},{"type":170,"tag":208,"props":4948,"children":4949},{"style":922},[4950],{"type":176,"value":4951}," false",{"type":170,"tag":208,"props":4953,"children":4954},{"style":231},[4955],{"type":176,"value":4956}," },",{"type":170,"tag":208,"props":4958,"children":4959},{"style":347},[4960],{"type":176,"value":1976},{"type":170,"tag":208,"props":4962,"children":4963},{"style":461},[4964],{"type":176,"value":585},{"type":170,"tag":208,"props":4966,"children":4967},{"style":568},[4968],{"type":176,"value":1156},{"type":170,"tag":208,"props":4970,"children":4971},{"style":231},[4972],{"type":176,"value":234},{"type":170,"tag":208,"props":4974,"children":4975},{"style":225},[4976],{"type":176,"value":1902},{"type":170,"tag":208,"props":4978,"children":4979},{"style":231},[4980],{"type":176,"value":630},{"type":170,"tag":208,"props":4982,"children":4983},{"style":231},[4984],{"type":176,"value":361},{"type":170,"tag":208,"props":4986,"children":4987},{"class":210,"line":300},[4988,4993,4997],{"type":170,"tag":208,"props":4989,"children":4990},{"style":225},[4991],{"type":176,"value":4992},"    handleDep",{"type":170,"tag":208,"props":4994,"children":4995},{"style":461},[4996],{"type":176,"value":585},{"type":170,"tag":208,"props":4998,"children":4999},{"style":225},[5000],{"type":176,"value":3036},{"type":170,"tag":208,"props":5002,"children":5003},{"class":210,"line":309},[5004,5008,5012,5016,5020,5024],{"type":170,"tag":208,"props":5005,"children":5006},{"style":237},[5007],{"type":176,"value":3717},{"type":170,"tag":208,"props":5009,"children":5010},{"style":274},[5011],{"type":176,"value":245},{"type":170,"tag":208,"props":5013,"children":5014},{"style":225},[5015],{"type":176,"value":1958},{"type":170,"tag":208,"props":5017,"children":5018},{"style":231},[5019],{"type":176,"value":266},{"type":170,"tag":208,"props":5021,"children":5022},{"style":225},[5023],{"type":176,"value":1976},{"type":170,"tag":208,"props":5025,"children":5026},{"style":274},[5027],{"type":176,"value":297},{"type":170,"tag":208,"props":5029,"children":5030},{"class":210,"line":364},[5031,5036,5040,5045,5049,5054,5058,5062,5067,5071,5076],{"type":170,"tag":208,"props":5032,"children":5033},{"style":225},[5034],{"type":176,"value":5035},"    options",{"type":170,"tag":208,"props":5037,"children":5038},{"style":231},[5039],{"type":176,"value":234},{"type":170,"tag":208,"props":5041,"children":5042},{"style":225},[5043],{"type":176,"value":5044},"immediately",{"type":170,"tag":208,"props":5046,"children":5047},{"style":461},[5048],{"type":176,"value":2780},{"type":170,"tag":208,"props":5050,"children":5051},{"style":996},[5052],{"type":176,"value":5053}," await",{"type":170,"tag":208,"props":5055,"children":5056},{"style":237},[5057],{"type":176,"value":1967},{"type":170,"tag":208,"props":5059,"children":5060},{"style":274},[5061],{"type":176,"value":245},{"type":170,"tag":208,"props":5063,"children":5064},{"style":225},[5065],{"type":176,"value":5066},"options",{"type":170,"tag":208,"props":5068,"children":5069},{"style":231},[5070],{"type":176,"value":234},{"type":170,"tag":208,"props":5072,"children":5073},{"style":225},[5074],{"type":176,"value":5075},"defaultParams",{"type":170,"tag":208,"props":5077,"children":5078},{"style":274},[5079],{"type":176,"value":297},{"type":170,"tag":208,"props":5081,"children":5082},{"class":210,"line":412},[5083],{"type":170,"tag":208,"props":5084,"children":5085},{"style":231},[5086],{"type":176,"value":598},{"type":170,"tag":208,"props":5088,"children":5089},{"class":210,"line":425},[5090],{"type":170,"tag":208,"props":5091,"children":5092},{"style":231},[5093],{"type":176,"value":801},{"type":170,"tag":821,"props":5095,"children":5097},{"id":5096},"this-绑定丢失问题",[5098],{"type":176,"value":5099},"this 绑定丢失问题",{"type":170,"tag":178,"props":5101,"children":5102},{},[5103],{"type":176,"value":5104},"在我在对 VX 进行删除属性方法的扩展时, 我往 walkChain 函数中添加了一个执行回调函数的机制, 并且在删除属性这个方法直接调用了 walkChain:",{"type":170,"tag":198,"props":5106,"children":5108},{"className":200,"code":5107,"language":202,"meta":163,"style":163},"  function walkChains (key, obj, fn) {\n    const segments = key.split('.')\n    let deepObj = obj\n    while (segments.length) {\n      deepObj = deepObj[segments.shift()]\n      fn && fn()\n    }\n  }\n",[5109],{"type":170,"tag":184,"props":5110,"children":5111},{"__ignoreMap":163},[5112,5156,5203,5223,5255,5291,5311,5318],{"type":170,"tag":208,"props":5113,"children":5114},{"class":210,"line":211},[5115,5120,5124,5128,5132,5136,5140,5144,5148,5152],{"type":170,"tag":208,"props":5116,"children":5117},{"style":353},[5118],{"type":176,"value":5119},"  function",{"type":170,"tag":208,"props":5121,"children":5122},{"style":237},[5123],{"type":176,"value":3443},{"type":170,"tag":208,"props":5125,"children":5126},{"style":231},[5127],{"type":176,"value":620},{"type":170,"tag":208,"props":5129,"children":5130},{"style":347},[5131],{"type":176,"value":1958},{"type":170,"tag":208,"props":5133,"children":5134},{"style":231},[5135],{"type":176,"value":266},{"type":170,"tag":208,"props":5137,"children":5138},{"style":347},[5139],{"type":176,"value":1976},{"type":170,"tag":208,"props":5141,"children":5142},{"style":231},[5143],{"type":176,"value":266},{"type":170,"tag":208,"props":5145,"children":5146},{"style":347},[5147],{"type":176,"value":1967},{"type":170,"tag":208,"props":5149,"children":5150},{"style":231},[5151],{"type":176,"value":630},{"type":170,"tag":208,"props":5153,"children":5154},{"style":231},[5155],{"type":176,"value":361},{"type":170,"tag":208,"props":5157,"children":5158},{"class":210,"line":221},[5159,5163,5167,5171,5175,5179,5183,5187,5191,5195,5199],{"type":170,"tag":208,"props":5160,"children":5161},{"style":353},[5162],{"type":176,"value":3155},{"type":170,"tag":208,"props":5164,"children":5165},{"style":1181},[5166],{"type":176,"value":3479},{"type":170,"tag":208,"props":5168,"children":5169},{"style":461},[5170],{"type":176,"value":585},{"type":170,"tag":208,"props":5172,"children":5173},{"style":225},[5174],{"type":176,"value":891},{"type":170,"tag":208,"props":5176,"children":5177},{"style":231},[5178],{"type":176,"value":234},{"type":170,"tag":208,"props":5180,"children":5181},{"style":237},[5182],{"type":176,"value":3496},{"type":170,"tag":208,"props":5184,"children":5185},{"style":274},[5186],{"type":176,"value":245},{"type":170,"tag":208,"props":5188,"children":5189},{"style":248},[5190],{"type":176,"value":251},{"type":170,"tag":208,"props":5192,"children":5193},{"style":254},[5194],{"type":176,"value":234},{"type":170,"tag":208,"props":5196,"children":5197},{"style":248},[5198],{"type":176,"value":251},{"type":170,"tag":208,"props":5200,"children":5201},{"style":274},[5202],{"type":176,"value":297},{"type":170,"tag":208,"props":5204,"children":5205},{"class":210,"line":300},[5206,5211,5215,5219],{"type":170,"tag":208,"props":5207,"children":5208},{"style":353},[5209],{"type":176,"value":5210},"    let",{"type":170,"tag":208,"props":5212,"children":5213},{"style":225},[5214],{"type":176,"value":3528},{"type":170,"tag":208,"props":5216,"children":5217},{"style":461},[5218],{"type":176,"value":585},{"type":170,"tag":208,"props":5220,"children":5221},{"style":225},[5222],{"type":176,"value":3537},{"type":170,"tag":208,"props":5224,"children":5225},{"class":210,"line":309},[5226,5231,5235,5239,5243,5247,5251],{"type":170,"tag":208,"props":5227,"children":5228},{"style":996},[5229],{"type":176,"value":5230},"    while",{"type":170,"tag":208,"props":5232,"children":5233},{"style":274},[5234],{"type":176,"value":620},{"type":170,"tag":208,"props":5236,"children":5237},{"style":225},[5238],{"type":176,"value":3554},{"type":170,"tag":208,"props":5240,"children":5241},{"style":231},[5242],{"type":176,"value":234},{"type":170,"tag":208,"props":5244,"children":5245},{"style":1181},[5246],{"type":176,"value":3563},{"type":170,"tag":208,"props":5248,"children":5249},{"style":274},[5250],{"type":176,"value":1381},{"type":170,"tag":208,"props":5252,"children":5253},{"style":231},[5254],{"type":176,"value":1170},{"type":170,"tag":208,"props":5256,"children":5257},{"class":210,"line":364},[5258,5263,5267,5271,5275,5279,5283,5287],{"type":170,"tag":208,"props":5259,"children":5260},{"style":225},[5261],{"type":176,"value":5262},"      deepObj",{"type":170,"tag":208,"props":5264,"children":5265},{"style":461},[5266],{"type":176,"value":585},{"type":170,"tag":208,"props":5268,"children":5269},{"style":225},[5270],{"type":176,"value":3528},{"type":170,"tag":208,"props":5272,"children":5273},{"style":274},[5274],{"type":176,"value":3592},{"type":170,"tag":208,"props":5276,"children":5277},{"style":225},[5278],{"type":176,"value":3554},{"type":170,"tag":208,"props":5280,"children":5281},{"style":231},[5282],{"type":176,"value":234},{"type":170,"tag":208,"props":5284,"children":5285},{"style":237},[5286],{"type":176,"value":3605},{"type":170,"tag":208,"props":5288,"children":5289},{"style":274},[5290],{"type":176,"value":3610},{"type":170,"tag":208,"props":5292,"children":5293},{"class":210,"line":412},[5294,5299,5303,5307],{"type":170,"tag":208,"props":5295,"children":5296},{"style":225},[5297],{"type":176,"value":5298},"      fn",{"type":170,"tag":208,"props":5300,"children":5301},{"style":461},[5302],{"type":176,"value":2780},{"type":170,"tag":208,"props":5304,"children":5305},{"style":237},[5306],{"type":176,"value":1967},{"type":170,"tag":208,"props":5308,"children":5309},{"style":274},[5310],{"type":176,"value":1202},{"type":170,"tag":208,"props":5312,"children":5313},{"class":210,"line":425},[5314],{"type":170,"tag":208,"props":5315,"children":5316},{"style":231},[5317],{"type":176,"value":1461},{"type":170,"tag":208,"props":5319,"children":5320},{"class":210,"line":679},[5321],{"type":170,"tag":208,"props":5322,"children":5323},{"style":231},[5324],{"type":176,"value":598},{"type":170,"tag":198,"props":5326,"children":5328},{"className":200,"code":5327,"language":202,"meta":163,"style":163},"del (key, obj = this.store) {\n  walkChains(key, obj, handleDep.clear)\n  delete obj[key]\n}\n",[5329],{"type":170,"tag":184,"props":5330,"children":5331},{"__ignoreMap":163},[5332,5372,5418,5442],{"type":170,"tag":208,"props":5333,"children":5334},{"class":210,"line":211},[5335,5340,5344,5348,5352,5356,5360,5364,5368],{"type":170,"tag":208,"props":5336,"children":5337},{"style":237},[5338],{"type":176,"value":5339},"del",{"type":170,"tag":208,"props":5341,"children":5342},{"style":225},[5343],{"type":176,"value":1116},{"type":170,"tag":208,"props":5345,"children":5346},{"style":231},[5347],{"type":176,"value":266},{"type":170,"tag":208,"props":5349,"children":5350},{"style":225},[5351],{"type":176,"value":1147},{"type":170,"tag":208,"props":5353,"children":5354},{"style":461},[5355],{"type":176,"value":464},{"type":170,"tag":208,"props":5357,"children":5358},{"style":568},[5359],{"type":176,"value":1156},{"type":170,"tag":208,"props":5361,"children":5362},{"style":231},[5363],{"type":176,"value":234},{"type":170,"tag":208,"props":5365,"children":5366},{"style":225},[5367],{"type":176,"value":1165},{"type":170,"tag":208,"props":5369,"children":5370},{"style":231},[5371],{"type":176,"value":1170},{"type":170,"tag":208,"props":5373,"children":5374},{"class":210,"line":221},[5375,5380,5384,5388,5392,5396,5400,5405,5409,5414],{"type":170,"tag":208,"props":5376,"children":5377},{"style":237},[5378],{"type":176,"value":5379},"  walkChains",{"type":170,"tag":208,"props":5381,"children":5382},{"style":274},[5383],{"type":176,"value":245},{"type":170,"tag":208,"props":5385,"children":5386},{"style":225},[5387],{"type":176,"value":1958},{"type":170,"tag":208,"props":5389,"children":5390},{"style":231},[5391],{"type":176,"value":266},{"type":170,"tag":208,"props":5393,"children":5394},{"style":225},[5395],{"type":176,"value":1976},{"type":170,"tag":208,"props":5397,"children":5398},{"style":231},[5399],{"type":176,"value":266},{"type":170,"tag":208,"props":5401,"children":5402},{"style":225},[5403],{"type":176,"value":5404}," handleDep",{"type":170,"tag":208,"props":5406,"children":5407},{"style":231},[5408],{"type":176,"value":234},{"type":170,"tag":208,"props":5410,"children":5411},{"style":225},[5412],{"type":176,"value":5413},"clear",{"type":170,"tag":208,"props":5415,"children":5416},{"style":274},[5417],{"type":176,"value":297},{"type":170,"tag":208,"props":5419,"children":5420},{"class":210,"line":300},[5421,5426,5430,5434,5438],{"type":170,"tag":208,"props":5422,"children":5423},{"style":461},[5424],{"type":176,"value":5425},"  delete",{"type":170,"tag":208,"props":5427,"children":5428},{"style":225},[5429],{"type":176,"value":1976},{"type":170,"tag":208,"props":5431,"children":5432},{"style":274},[5433],{"type":176,"value":3592},{"type":170,"tag":208,"props":5435,"children":5436},{"style":225},[5437],{"type":176,"value":1958},{"type":170,"tag":208,"props":5439,"children":5440},{"style":274},[5441],{"type":176,"value":3978},{"type":170,"tag":208,"props":5443,"children":5444},{"class":210,"line":309},[5445],{"type":170,"tag":208,"props":5446,"children":5447},{"style":231},[5448],{"type":176,"value":801},{"type":170,"tag":178,"props":5450,"children":5451},{},[5452,5454,5459],{"type":176,"value":5453},"因为 handleDep.clear 当成参数传递进 walkChains 中会",{"type":170,"tag":514,"props":5455,"children":5456},{},[5457],{"type":176,"value":5458},"丢失 this 绑定",{"type":176,"value":5460},", 所以上面那段代码其实是有问题的, 不过稍作修改就好了:",{"type":170,"tag":198,"props":5462,"children":5464},{"className":200,"code":5463,"language":202,"meta":163,"style":163},"  del (key, obj = this.store) {\n    walkChains(key, obj, () => handleDep.clear())\n    delete obj[key]\n  }\n",[5465],{"type":170,"tag":184,"props":5466,"children":5467},{"__ignoreMap":163},[5468,5508,5560,5584],{"type":170,"tag":208,"props":5469,"children":5470},{"class":210,"line":211},[5471,5476,5480,5484,5488,5492,5496,5500,5504],{"type":170,"tag":208,"props":5472,"children":5473},{"style":237},[5474],{"type":176,"value":5475},"  del",{"type":170,"tag":208,"props":5477,"children":5478},{"style":225},[5479],{"type":176,"value":1116},{"type":170,"tag":208,"props":5481,"children":5482},{"style":231},[5483],{"type":176,"value":266},{"type":170,"tag":208,"props":5485,"children":5486},{"style":225},[5487],{"type":176,"value":1147},{"type":170,"tag":208,"props":5489,"children":5490},{"style":461},[5491],{"type":176,"value":464},{"type":170,"tag":208,"props":5493,"children":5494},{"style":568},[5495],{"type":176,"value":1156},{"type":170,"tag":208,"props":5497,"children":5498},{"style":231},[5499],{"type":176,"value":234},{"type":170,"tag":208,"props":5501,"children":5502},{"style":225},[5503],{"type":176,"value":1165},{"type":170,"tag":208,"props":5505,"children":5506},{"style":231},[5507],{"type":176,"value":1170},{"type":170,"tag":208,"props":5509,"children":5510},{"class":210,"line":221},[5511,5515,5519,5523,5527,5531,5535,5539,5543,5547,5551,5555],{"type":170,"tag":208,"props":5512,"children":5513},{"style":237},[5514],{"type":176,"value":3717},{"type":170,"tag":208,"props":5516,"children":5517},{"style":274},[5518],{"type":176,"value":245},{"type":170,"tag":208,"props":5520,"children":5521},{"style":225},[5522],{"type":176,"value":1958},{"type":170,"tag":208,"props":5524,"children":5525},{"style":231},[5526],{"type":176,"value":266},{"type":170,"tag":208,"props":5528,"children":5529},{"style":225},[5530],{"type":176,"value":1976},{"type":170,"tag":208,"props":5532,"children":5533},{"style":231},[5534],{"type":176,"value":266},{"type":170,"tag":208,"props":5536,"children":5537},{"style":231},[5538],{"type":176,"value":558},{"type":170,"tag":208,"props":5540,"children":5541},{"style":353},[5542],{"type":176,"value":356},{"type":170,"tag":208,"props":5544,"children":5545},{"style":225},[5546],{"type":176,"value":5404},{"type":170,"tag":208,"props":5548,"children":5549},{"style":231},[5550],{"type":176,"value":234},{"type":170,"tag":208,"props":5552,"children":5553},{"style":237},[5554],{"type":176,"value":5413},{"type":170,"tag":208,"props":5556,"children":5557},{"style":274},[5558],{"type":176,"value":5559},"())\n",{"type":170,"tag":208,"props":5561,"children":5562},{"class":210,"line":300},[5563,5568,5572,5576,5580],{"type":170,"tag":208,"props":5564,"children":5565},{"style":461},[5566],{"type":176,"value":5567},"    delete",{"type":170,"tag":208,"props":5569,"children":5570},{"style":225},[5571],{"type":176,"value":1976},{"type":170,"tag":208,"props":5573,"children":5574},{"style":274},[5575],{"type":176,"value":3592},{"type":170,"tag":208,"props":5577,"children":5578},{"style":225},[5579],{"type":176,"value":1958},{"type":170,"tag":208,"props":5581,"children":5582},{"style":274},[5583],{"type":176,"value":3978},{"type":170,"tag":208,"props":5585,"children":5586},{"class":210,"line":309},[5587],{"type":170,"tag":208,"props":5588,"children":5589},{"style":231},[5590],{"type":176,"value":598},{"type":170,"tag":171,"props":5592,"children":5594},{"id":5593},"后语",[5595],{"type":176,"value":5593},{"type":170,"tag":178,"props":5597,"children":5598},{},[5599],{"type":176,"value":5600},"在这篇文章中, 我们通过对 defineProperty 进行封装, 实现了一个简单的对象属性侦听器的功能, 以弥补小程序所没有的$watch 能力. 在此基础上, 各位可以再对 VX 进行扩展, 更方便地去书写业务代码.",{"type":170,"tag":178,"props":5602,"children":5603},{},[5604,5606],{"type":176,"value":5605},"完整代码 ",{"type":170,"tag":440,"props":5607,"children":5611},{"href":5608,"rel":5609},"https://github.com/Lionad-Morotar/media-gear/blob/master/src/renderer/utils/suites/vx/index.js",[5610],"nofollow",[5612],{"type":176,"value":5613},"GitHub 直达",{"type":170,"tag":5615,"props":5616,"children":5617},"style",{},[5618],{"type":176,"value":5619},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":163,"searchDepth":221,"depth":221,"links":5621},[5622,5623,5624,5625,5628,5633,5634,5637,5641],{"id":173,"depth":221,"text":173},{"id":495,"depth":221,"text":495},{"id":505,"depth":221,"text":505},{"id":817,"depth":221,"text":817,"children":5626},[5627],{"id":823,"depth":300,"text":826},{"id":1802,"depth":221,"text":1805,"children":5629},[5630,5631,5632],{"id":1808,"depth":300,"text":1808},{"id":1840,"depth":300,"text":1843},{"id":2590,"depth":300,"text":2590},{"id":3399,"depth":221,"text":3402},{"id":4302,"depth":221,"text":4302,"children":5635},[5636],{"id":4307,"depth":300,"text":4307},{"id":4851,"depth":221,"text":4851,"children":5638},[5639,5640],{"id":4856,"depth":300,"text":4859},{"id":5096,"depth":300,"text":5099},{"id":5593,"depth":221,"text":5593},"markdown","content:_achieved:2019-05:reactive-in-150loc.md","content","_achieved/2019-05/reactive-in-150loc.md","_achieved/2019-05/reactive-in-150loc","md",[5649,5652],{"_path":5650,"title":5651,"description":163},"/_achieved/2018-10/noname","🌆 无题",{"_path":5653,"title":5654,"description":163},"/_achieved/2019-06/messy-in-two-years","💖 聊聊此次离职，毕业，及其它杂乱的事情",1742958685057]