[{"data":1,"prerenderedAt":5658},["ShallowReactive",2],{"navigation":3,"/_achieved/2019-05/reactive-in-150loc":161,"/_achieved/2019-05/reactive-in-150loc-surround":5651},[4,35,92,98,125,131,155],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83,86,89],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🖌️ Blockies Animation","/maps/_fe-framework/motion/blockies-animation",{"title":45,"_path":46},"🌪️ Tailwind v4 如何兼容预处理器","/articles/tailwind4-with-sass",{"title":48,"_path":49},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":51,"_path":52},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":54,"_path":55},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":57,"_path":58},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":60,"_path":61},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":63,"_path":64},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":66,"_path":67},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":69,"_path":70},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":72,"_path":73},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":75,"_path":76},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":78,"_path":79},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":81,"_path":82},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":84,"_path":85},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":87,"_path":88},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":90,"_path":91},"📝 技术博客归档","/articles/archive",{"title":93,"_path":94,"children":95},"读书笔记 / Notes","/books",[96],{"title":97,"_path":94},"📕 读书笔记",{"title":99,"_path":100,"children":101},"吉他剧场 / Music","/music",[102,104,107,110,113,116,119,122],{"title":103,"_path":100},"🎸 FingerStyle！",{"title":105,"_path":106},"🌬️ 等待的风","/music/wind",{"title":108,"_path":109},"💕 约定的海洋","/music/ocean",{"title":111,"_path":112},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":114,"_path":115},"🌏 残酷天使的行动纲领","/music/eva",{"title":117,"_path":118},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":120,"_path":121},"🍷 Wu Wei","/music/wu-wei",{"title":123,"_path":124},"🌅 无题","/music/untitled",{"title":126,"_path":127,"children":128},"知识地图 / Maps","/maps",[129],{"title":130,"_path":127},"🏁 知识地图",{"title":132,"_path":133,"children":134},"造物 / Make","/tools",[135,137,140,143,146,149,152],{"title":136,"_path":133},"🧰 工具收集",{"title":138,"_path":139},"📕 博客","/tools/blog",{"title":141,"_path":142},"🥥 Coconut","/tools/coconut",{"title":144,"_path":145},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":147,"_path":148},"🌐 AnySort","/tools/anysort",{"title":150,"_path":151},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":153,"_path":154},"👓 Crapto","/tools/crypto-inline",{"title":156,"_path":157,"children":158},"我 / About","/hire",[159],{"title":160,"_path":157},"📬 技术简历",{"_path":162,"_dir":163,"_draft":164,"_partial":165,"_locale":166,"title":167,"description":168,"body":169,"_type":5645,"_id":5646,"_source":5647,"_file":5648,"_stem":5649,"_extension":5650},"/_achieved/2019-05/reactive-in-150loc","2019-05",false,true,"","🚀 150 行代码带你实现小程序中的数据侦听","本文介绍了在 150 行代码内使用 defineProperty 实现一个简单的拥有事件发布订阅能力的状态管理库的思路。",{"type":170,"children":171,"toc":5623},"root",[172,180,195,200,479,491,496,501,506,511,524,805,818,823,830,842,1096,1101,1484,1489,1494,1499,1656,1798,1803,1809,1814,1819,1828,1833,1841,1847,1852,2108,2113,2118,2591,2596,2625,3400,3406,3419,3755,3768,3781,4303,4308,4313,4318,4323,4336,4852,4857,4863,4868,4873,5097,5103,5108,5328,5452,5464,5594,5599,5604,5617],{"type":173,"tag":174,"props":175,"children":177},"element","h2",{"id":176},"前言",[178],{"type":179,"value":176},"text",{"type":173,"tag":181,"props":182,"children":183},"p",{},[184,186,193],{"type":179,"value":185},"在小程序项目中, 我们的通常会使用到使用到一个全局对象作为各个页面通用的数据存储容器, 将它绑定到 app 对象后, 就能在每一个页面都自由的操纵这个对象. 然而在实践中, 由于这个对象及其属性不具备响应式条件, 它不能直接参与业务逻辑的编写, 能力仅仅局限于数据储存. 若是在 VueJS 项目中, 我们可能经常使用到",{"type":173,"tag":187,"props":188,"children":190},"code",{"className":189},[],[191],{"type":179,"value":192},"Vue.$watch",{"type":179,"value":194},"去侦听某个数据是否发生变化, 小程序却缺乏这种能力.",{"type":173,"tag":181,"props":196,"children":197},{},[198],{"type":179,"value":199},"在这篇文章中, 我将用 150 行代码, 手把手带你打造一个小程序也可以使用的侦听器(下简称 VX):",{"type":173,"tag":201,"props":202,"children":206},"pre",{"className":203,"code":204,"language":205,"meta":166,"style":166},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","// 一个快速赋值的语法糖函数, 可以创建结构为 { value: a { b: { val: ''} } } 的对象\nvx.set('value.a.d', { val: '' })\n// 对某个属性进行侦听, 如果发生改变, 则执行相应函数(可多次watch以执行多个函数)\nvx.watch('value.a.d.val', newVal => {\n  console.log(`val改变为 : `, newVal)\n})\nvalue.a.d.val = 3 // val改编为 : 3\n","js",[207],{"type":173,"tag":187,"props":208,"children":209},{"__ignoreMap":166},[210,222,301,310,365,413,426],{"type":173,"tag":211,"props":212,"children":215},"span",{"class":213,"line":214},"line",1,[216],{"type":173,"tag":211,"props":217,"children":219},{"style":218},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[220],{"type":179,"value":221},"// 一个快速赋值的语法糖函数, 可以创建结构为 { value: a { b: { val: ''} } } 的对象\n",{"type":173,"tag":211,"props":223,"children":225},{"class":213,"line":224},2,[226,232,238,244,249,255,261,265,270,275,281,286,291,296],{"type":173,"tag":211,"props":227,"children":229},{"style":228},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[230],{"type":179,"value":231},"vx",{"type":173,"tag":211,"props":233,"children":235},{"style":234},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[236],{"type":179,"value":237},".",{"type":173,"tag":211,"props":239,"children":241},{"style":240},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[242],{"type":179,"value":243},"set",{"type":173,"tag":211,"props":245,"children":246},{"style":228},[247],{"type":179,"value":248},"(",{"type":173,"tag":211,"props":250,"children":252},{"style":251},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[253],{"type":179,"value":254},"'",{"type":173,"tag":211,"props":256,"children":258},{"style":257},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[259],{"type":179,"value":260},"value.a.d",{"type":173,"tag":211,"props":262,"children":263},{"style":251},[264],{"type":179,"value":254},{"type":173,"tag":211,"props":266,"children":267},{"style":234},[268],{"type":179,"value":269},",",{"type":173,"tag":211,"props":271,"children":272},{"style":234},[273],{"type":179,"value":274}," {",{"type":173,"tag":211,"props":276,"children":278},{"style":277},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[279],{"type":179,"value":280}," val",{"type":173,"tag":211,"props":282,"children":283},{"style":234},[284],{"type":179,"value":285},":",{"type":173,"tag":211,"props":287,"children":288},{"style":251},[289],{"type":179,"value":290}," ''",{"type":173,"tag":211,"props":292,"children":293},{"style":234},[294],{"type":179,"value":295}," }",{"type":173,"tag":211,"props":297,"children":298},{"style":228},[299],{"type":179,"value":300},")\n",{"type":173,"tag":211,"props":302,"children":304},{"class":213,"line":303},3,[305],{"type":173,"tag":211,"props":306,"children":307},{"style":218},[308],{"type":179,"value":309},"// 对某个属性进行侦听, 如果发生改变, 则执行相应函数(可多次watch以执行多个函数)\n",{"type":173,"tag":211,"props":311,"children":313},{"class":213,"line":312},4,[314,318,322,327,331,335,340,344,348,354,360],{"type":173,"tag":211,"props":315,"children":316},{"style":228},[317],{"type":179,"value":231},{"type":173,"tag":211,"props":319,"children":320},{"style":234},[321],{"type":179,"value":237},{"type":173,"tag":211,"props":323,"children":324},{"style":240},[325],{"type":179,"value":326},"watch",{"type":173,"tag":211,"props":328,"children":329},{"style":228},[330],{"type":179,"value":248},{"type":173,"tag":211,"props":332,"children":333},{"style":251},[334],{"type":179,"value":254},{"type":173,"tag":211,"props":336,"children":337},{"style":257},[338],{"type":179,"value":339},"value.a.d.val",{"type":173,"tag":211,"props":341,"children":342},{"style":251},[343],{"type":179,"value":254},{"type":173,"tag":211,"props":345,"children":346},{"style":234},[347],{"type":179,"value":269},{"type":173,"tag":211,"props":349,"children":351},{"style":350},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[352],{"type":179,"value":353}," newVal",{"type":173,"tag":211,"props":355,"children":357},{"style":356},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[358],{"type":179,"value":359}," =>",{"type":173,"tag":211,"props":361,"children":362},{"style":234},[363],{"type":179,"value":364}," {\n",{"type":173,"tag":211,"props":366,"children":368},{"class":213,"line":367},5,[369,374,378,383,387,392,397,401,405,409],{"type":173,"tag":211,"props":370,"children":371},{"style":228},[372],{"type":179,"value":373},"  console",{"type":173,"tag":211,"props":375,"children":376},{"style":234},[377],{"type":179,"value":237},{"type":173,"tag":211,"props":379,"children":380},{"style":240},[381],{"type":179,"value":382},"log",{"type":173,"tag":211,"props":384,"children":385},{"style":277},[386],{"type":179,"value":248},{"type":173,"tag":211,"props":388,"children":389},{"style":251},[390],{"type":179,"value":391},"`",{"type":173,"tag":211,"props":393,"children":394},{"style":257},[395],{"type":179,"value":396},"val改变为 : ",{"type":173,"tag":211,"props":398,"children":399},{"style":251},[400],{"type":179,"value":391},{"type":173,"tag":211,"props":402,"children":403},{"style":234},[404],{"type":179,"value":269},{"type":173,"tag":211,"props":406,"children":407},{"style":228},[408],{"type":179,"value":353},{"type":173,"tag":211,"props":410,"children":411},{"style":277},[412],{"type":179,"value":300},{"type":173,"tag":211,"props":414,"children":416},{"class":213,"line":415},6,[417,422],{"type":173,"tag":211,"props":418,"children":419},{"style":234},[420],{"type":179,"value":421},"}",{"type":173,"tag":211,"props":423,"children":424},{"style":228},[425],{"type":179,"value":300},{"type":173,"tag":211,"props":427,"children":429},{"class":213,"line":428},7,[430,435,439,444,448,453,457,462,468,474],{"type":173,"tag":211,"props":431,"children":432},{"style":228},[433],{"type":179,"value":434},"value",{"type":173,"tag":211,"props":436,"children":437},{"style":234},[438],{"type":179,"value":237},{"type":173,"tag":211,"props":440,"children":441},{"style":228},[442],{"type":179,"value":443},"a",{"type":173,"tag":211,"props":445,"children":446},{"style":234},[447],{"type":179,"value":237},{"type":173,"tag":211,"props":449,"children":450},{"style":228},[451],{"type":179,"value":452},"d",{"type":173,"tag":211,"props":454,"children":455},{"style":234},[456],{"type":179,"value":237},{"type":173,"tag":211,"props":458,"children":459},{"style":228},[460],{"type":179,"value":461},"val ",{"type":173,"tag":211,"props":463,"children":465},{"style":464},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[466],{"type":179,"value":467},"=",{"type":173,"tag":211,"props":469,"children":471},{"style":470},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[472],{"type":179,"value":473}," 3",{"type":173,"tag":211,"props":475,"children":476},{"style":218},[477],{"type":179,"value":478}," // val改编为 : 3\n",{"type":173,"tag":181,"props":480,"children":481},{},[482,484,489],{"type":179,"value":483},"使用 VX 侦听器, 我们可以更加方便的管理各个页面的状态. 同时, 我们凭借",{"type":173,"tag":187,"props":485,"children":487},{"className":486},[],[488],{"type":179,"value":326},{"type":179,"value":490},"语法, 可以更优雅地编写业务逻辑.",{"type":173,"tag":181,"props":492,"children":493},{},[494],{"type":179,"value":495},"坐稳了, 三轮车准备启动了~ 各位评论见~ 😋",{"type":173,"tag":174,"props":497,"children":499},{"id":498},"稍微理一理思路",[500],{"type":179,"value":498},{"type":173,"tag":181,"props":502,"children":503},{},[504],{"type":179,"value":505},"在全局对象中, 我们不一定要对每一个属性都进行侦听, 所以 VX 主要的功能就是通过 set 去设置某个具体属性的 setter/getter, 同时通过 watch 向添加该属性添加需要订阅的回调函数.",{"type":173,"tag":174,"props":507,"children":509},{"id":508},"依赖对象的实现",[510],{"type":179,"value":508},{"type":173,"tag":181,"props":512,"children":513},{},[514,516,522],{"type":179,"value":515},"首先我们需要造一个通用的",{"type":173,"tag":517,"props":518,"children":519},"strong",{},[520],{"type":179,"value":521},"依赖对象",{"type":179,"value":523},", 依赖对象携带一个订阅数组用于存放一组回调函数, 同时它还应该包括一些操作订阅数组能力(如添加订阅, 清空订阅)的函数",{"type":173,"tag":201,"props":525,"children":527},{"className":203,"code":526,"language":205,"meta":166,"style":166},"class Dep {\n  constructor () {\n    this.subs = []\n  }\n  // 将回调添加到数组中\n  addSub (fn) { /*...*/ }\n  delSub (fn) { /*...*/ }\n  // 执行数组中每一项函数\n  notify (newVal, oldVal) {\n    this.subs.forEach(func => func(newVal, oldVal))\n  }\n}\n",[528],{"type":173,"tag":187,"props":529,"children":530},{"__ignoreMap":166},[531,549,566,594,602,610,648,680,689,724,788,796],{"type":173,"tag":211,"props":532,"children":533},{"class":213,"line":214},[534,539,545],{"type":173,"tag":211,"props":535,"children":536},{"style":356},[537],{"type":179,"value":538},"class",{"type":173,"tag":211,"props":540,"children":542},{"style":541},"--shiki-light:#E2931D;--shiki-light-text-decoration:inherit;--shiki-default:#6F42C1;--shiki-default-text-decoration:inherit;--shiki-dark:#B392F0;--shiki-dark-text-decoration:inherit;--shiki-sepia:#A6E22E;--shiki-sepia-text-decoration:underline",[543],{"type":179,"value":544}," Dep",{"type":173,"tag":211,"props":546,"children":547},{"style":234},[548],{"type":179,"value":364},{"type":173,"tag":211,"props":550,"children":551},{"class":213,"line":224},[552,557,562],{"type":173,"tag":211,"props":553,"children":554},{"style":356},[555],{"type":179,"value":556},"  constructor",{"type":173,"tag":211,"props":558,"children":559},{"style":234},[560],{"type":179,"value":561}," ()",{"type":173,"tag":211,"props":563,"children":564},{"style":234},[565],{"type":179,"value":364},{"type":173,"tag":211,"props":567,"children":568},{"class":213,"line":303},[569,575,579,584,589],{"type":173,"tag":211,"props":570,"children":572},{"style":571},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[573],{"type":179,"value":574},"    this",{"type":173,"tag":211,"props":576,"children":577},{"style":234},[578],{"type":179,"value":237},{"type":173,"tag":211,"props":580,"children":581},{"style":228},[582],{"type":179,"value":583},"subs",{"type":173,"tag":211,"props":585,"children":586},{"style":464},[587],{"type":179,"value":588}," =",{"type":173,"tag":211,"props":590,"children":591},{"style":277},[592],{"type":179,"value":593}," []\n",{"type":173,"tag":211,"props":595,"children":596},{"class":213,"line":312},[597],{"type":173,"tag":211,"props":598,"children":599},{"style":234},[600],{"type":179,"value":601},"  }\n",{"type":173,"tag":211,"props":603,"children":604},{"class":213,"line":367},[605],{"type":173,"tag":211,"props":606,"children":607},{"style":218},[608],{"type":179,"value":609},"  // 将回调添加到数组中\n",{"type":173,"tag":211,"props":611,"children":612},{"class":213,"line":415},[613,619,624,629,634,638,643],{"type":173,"tag":211,"props":614,"children":616},{"style":615},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[617],{"type":179,"value":618},"  addSub",{"type":173,"tag":211,"props":620,"children":621},{"style":234},[622],{"type":179,"value":623}," (",{"type":173,"tag":211,"props":625,"children":626},{"style":350},[627],{"type":179,"value":628},"fn",{"type":173,"tag":211,"props":630,"children":631},{"style":234},[632],{"type":179,"value":633},")",{"type":173,"tag":211,"props":635,"children":636},{"style":234},[637],{"type":179,"value":274},{"type":173,"tag":211,"props":639,"children":640},{"style":218},[641],{"type":179,"value":642}," /*...*/",{"type":173,"tag":211,"props":644,"children":645},{"style":234},[646],{"type":179,"value":647}," }\n",{"type":173,"tag":211,"props":649,"children":650},{"class":213,"line":428},[651,656,660,664,668,672,676],{"type":173,"tag":211,"props":652,"children":653},{"style":615},[654],{"type":179,"value":655},"  delSub",{"type":173,"tag":211,"props":657,"children":658},{"style":234},[659],{"type":179,"value":623},{"type":173,"tag":211,"props":661,"children":662},{"style":350},[663],{"type":179,"value":628},{"type":173,"tag":211,"props":665,"children":666},{"style":234},[667],{"type":179,"value":633},{"type":173,"tag":211,"props":669,"children":670},{"style":234},[671],{"type":179,"value":274},{"type":173,"tag":211,"props":673,"children":674},{"style":218},[675],{"type":179,"value":642},{"type":173,"tag":211,"props":677,"children":678},{"style":234},[679],{"type":179,"value":647},{"type":173,"tag":211,"props":681,"children":683},{"class":213,"line":682},8,[684],{"type":173,"tag":211,"props":685,"children":686},{"style":218},[687],{"type":179,"value":688},"  // 执行数组中每一项函数\n",{"type":173,"tag":211,"props":690,"children":692},{"class":213,"line":691},9,[693,698,702,707,711,716,720],{"type":173,"tag":211,"props":694,"children":695},{"style":615},[696],{"type":179,"value":697},"  notify",{"type":173,"tag":211,"props":699,"children":700},{"style":234},[701],{"type":179,"value":623},{"type":173,"tag":211,"props":703,"children":704},{"style":350},[705],{"type":179,"value":706},"newVal",{"type":173,"tag":211,"props":708,"children":709},{"style":234},[710],{"type":179,"value":269},{"type":173,"tag":211,"props":712,"children":713},{"style":350},[714],{"type":179,"value":715}," oldVal",{"type":173,"tag":211,"props":717,"children":718},{"style":234},[719],{"type":179,"value":633},{"type":173,"tag":211,"props":721,"children":722},{"style":234},[723],{"type":179,"value":364},{"type":173,"tag":211,"props":725,"children":727},{"class":213,"line":726},10,[728,732,736,740,744,749,753,758,762,767,771,775,779,783],{"type":173,"tag":211,"props":729,"children":730},{"style":571},[731],{"type":179,"value":574},{"type":173,"tag":211,"props":733,"children":734},{"style":234},[735],{"type":179,"value":237},{"type":173,"tag":211,"props":737,"children":738},{"style":228},[739],{"type":179,"value":583},{"type":173,"tag":211,"props":741,"children":742},{"style":234},[743],{"type":179,"value":237},{"type":173,"tag":211,"props":745,"children":746},{"style":240},[747],{"type":179,"value":748},"forEach",{"type":173,"tag":211,"props":750,"children":751},{"style":277},[752],{"type":179,"value":248},{"type":173,"tag":211,"props":754,"children":755},{"style":350},[756],{"type":179,"value":757},"func",{"type":173,"tag":211,"props":759,"children":760},{"style":356},[761],{"type":179,"value":359},{"type":173,"tag":211,"props":763,"children":764},{"style":240},[765],{"type":179,"value":766}," func",{"type":173,"tag":211,"props":768,"children":769},{"style":277},[770],{"type":179,"value":248},{"type":173,"tag":211,"props":772,"children":773},{"style":228},[774],{"type":179,"value":706},{"type":173,"tag":211,"props":776,"children":777},{"style":234},[778],{"type":179,"value":269},{"type":173,"tag":211,"props":780,"children":781},{"style":228},[782],{"type":179,"value":715},{"type":173,"tag":211,"props":784,"children":785},{"style":277},[786],{"type":179,"value":787},"))\n",{"type":173,"tag":211,"props":789,"children":791},{"class":213,"line":790},11,[792],{"type":173,"tag":211,"props":793,"children":794},{"style":234},[795],{"type":179,"value":601},{"type":173,"tag":211,"props":797,"children":799},{"class":213,"line":798},12,[800],{"type":173,"tag":211,"props":801,"children":802},{"style":234},[803],{"type":179,"value":804},"}\n",{"type":173,"tag":181,"props":806,"children":807},{},[808,810,816],{"type":179,"value":809},"全局对象中每一个响应式属性(及其每一个子属性), 都应该和一个新的 Dep 实例保持一一对应的关系, 这样我们进行侦听变化, 执行订阅的回调函数时, 只需要找到对应的实例执行",{"type":173,"tag":187,"props":811,"children":813},{"className":812},[],[814],{"type":179,"value":815},"notify",{"type":179,"value":817},"通知更新即可.",{"type":173,"tag":174,"props":819,"children":821},{"id":820},"设置响应式属性",[822],{"type":179,"value":820},{"type":173,"tag":824,"props":825,"children":827},"h3",{"id":826},"defineproperty",[828],{"type":179,"value":829},"defineProperty",{"type":173,"tag":181,"props":831,"children":832},{},[833,835,840],{"type":179,"value":834},"可能是因为接触 DefineProperty 要比接触 Proxy 早一些的缘故, 代码使用了前者进行响应式的实现, Object.defineProperty 方法会直接在一个对象上定义一个新属性, 这里快速过一遍",{"type":173,"tag":187,"props":836,"children":838},{"className":837},[],[839],{"type":179,"value":829},{"type":179,"value":841},"具体配置:",{"type":173,"tag":201,"props":843,"children":845},{"className":203,"code":844,"language":205,"meta":166,"style":166},"// @param obj 要在其上定义属性的对象\n// @param key 要定义或修改的属性的名称\nObject.defineProperty(obj, key, {\n  // 该属性是否能被枚举\n  enumerable: true,\n  // 该属性能否被删除\n  configurable: true,\n  // 访问该属性则会执行此方法\n  get: () => {\n    return val\n  },\n  // 修改该属性时会执行此方法\n  set: newVal => {\n    val = newVal\n  },\n  // value & writeble 不能和 getter/setter 同时出现\n})\n",[846],{"type":173,"tag":187,"props":847,"children":848},{"__ignoreMap":166},[849,857,865,903,911,934,942,962,970,994,1008,1016,1024,1049,1067,1075,1084],{"type":173,"tag":211,"props":850,"children":851},{"class":213,"line":214},[852],{"type":173,"tag":211,"props":853,"children":854},{"style":218},[855],{"type":179,"value":856},"// @param obj 要在其上定义属性的对象\n",{"type":173,"tag":211,"props":858,"children":859},{"class":213,"line":224},[860],{"type":173,"tag":211,"props":861,"children":862},{"style":218},[863],{"type":179,"value":864},"// @param key 要定义或修改的属性的名称\n",{"type":173,"tag":211,"props":866,"children":867},{"class":213,"line":303},[868,873,877,881,886,890,895,899],{"type":173,"tag":211,"props":869,"children":870},{"style":228},[871],{"type":179,"value":872},"Object",{"type":173,"tag":211,"props":874,"children":875},{"style":234},[876],{"type":179,"value":237},{"type":173,"tag":211,"props":878,"children":879},{"style":240},[880],{"type":179,"value":829},{"type":173,"tag":211,"props":882,"children":883},{"style":228},[884],{"type":179,"value":885},"(obj",{"type":173,"tag":211,"props":887,"children":888},{"style":234},[889],{"type":179,"value":269},{"type":173,"tag":211,"props":891,"children":892},{"style":228},[893],{"type":179,"value":894}," key",{"type":173,"tag":211,"props":896,"children":897},{"style":234},[898],{"type":179,"value":269},{"type":173,"tag":211,"props":900,"children":901},{"style":234},[902],{"type":179,"value":364},{"type":173,"tag":211,"props":904,"children":905},{"class":213,"line":312},[906],{"type":173,"tag":211,"props":907,"children":908},{"style":218},[909],{"type":179,"value":910},"  // 该属性是否能被枚举\n",{"type":173,"tag":211,"props":912,"children":913},{"class":213,"line":367},[914,919,923,929],{"type":173,"tag":211,"props":915,"children":916},{"style":277},[917],{"type":179,"value":918},"  enumerable",{"type":173,"tag":211,"props":920,"children":921},{"style":234},[922],{"type":179,"value":285},{"type":173,"tag":211,"props":924,"children":926},{"style":925},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[927],{"type":179,"value":928}," true",{"type":173,"tag":211,"props":930,"children":931},{"style":234},[932],{"type":179,"value":933},",\n",{"type":173,"tag":211,"props":935,"children":936},{"class":213,"line":415},[937],{"type":173,"tag":211,"props":938,"children":939},{"style":218},[940],{"type":179,"value":941},"  // 该属性能否被删除\n",{"type":173,"tag":211,"props":943,"children":944},{"class":213,"line":428},[945,950,954,958],{"type":173,"tag":211,"props":946,"children":947},{"style":277},[948],{"type":179,"value":949},"  configurable",{"type":173,"tag":211,"props":951,"children":952},{"style":234},[953],{"type":179,"value":285},{"type":173,"tag":211,"props":955,"children":956},{"style":925},[957],{"type":179,"value":928},{"type":173,"tag":211,"props":959,"children":960},{"style":234},[961],{"type":179,"value":933},{"type":173,"tag":211,"props":963,"children":964},{"class":213,"line":682},[965],{"type":173,"tag":211,"props":966,"children":967},{"style":218},[968],{"type":179,"value":969},"  // 访问该属性则会执行此方法\n",{"type":173,"tag":211,"props":971,"children":972},{"class":213,"line":691},[973,978,982,986,990],{"type":173,"tag":211,"props":974,"children":975},{"style":240},[976],{"type":179,"value":977},"  get",{"type":173,"tag":211,"props":979,"children":980},{"style":234},[981],{"type":179,"value":285},{"type":173,"tag":211,"props":983,"children":984},{"style":234},[985],{"type":179,"value":561},{"type":173,"tag":211,"props":987,"children":988},{"style":356},[989],{"type":179,"value":359},{"type":173,"tag":211,"props":991,"children":992},{"style":234},[993],{"type":179,"value":364},{"type":173,"tag":211,"props":995,"children":996},{"class":213,"line":726},[997,1003],{"type":173,"tag":211,"props":998,"children":1000},{"style":999},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[1001],{"type":179,"value":1002},"    return",{"type":173,"tag":211,"props":1004,"children":1005},{"style":228},[1006],{"type":179,"value":1007}," val\n",{"type":173,"tag":211,"props":1009,"children":1010},{"class":213,"line":790},[1011],{"type":173,"tag":211,"props":1012,"children":1013},{"style":234},[1014],{"type":179,"value":1015},"  },\n",{"type":173,"tag":211,"props":1017,"children":1018},{"class":213,"line":798},[1019],{"type":173,"tag":211,"props":1020,"children":1021},{"style":218},[1022],{"type":179,"value":1023},"  // 修改该属性时会执行此方法\n",{"type":173,"tag":211,"props":1025,"children":1027},{"class":213,"line":1026},13,[1028,1033,1037,1041,1045],{"type":173,"tag":211,"props":1029,"children":1030},{"style":240},[1031],{"type":179,"value":1032},"  set",{"type":173,"tag":211,"props":1034,"children":1035},{"style":234},[1036],{"type":179,"value":285},{"type":173,"tag":211,"props":1038,"children":1039},{"style":350},[1040],{"type":179,"value":353},{"type":173,"tag":211,"props":1042,"children":1043},{"style":356},[1044],{"type":179,"value":359},{"type":173,"tag":211,"props":1046,"children":1047},{"style":234},[1048],{"type":179,"value":364},{"type":173,"tag":211,"props":1050,"children":1052},{"class":213,"line":1051},14,[1053,1058,1062],{"type":173,"tag":211,"props":1054,"children":1055},{"style":228},[1056],{"type":179,"value":1057},"    val",{"type":173,"tag":211,"props":1059,"children":1060},{"style":464},[1061],{"type":179,"value":588},{"type":173,"tag":211,"props":1063,"children":1064},{"style":228},[1065],{"type":179,"value":1066}," newVal\n",{"type":173,"tag":211,"props":1068,"children":1070},{"class":213,"line":1069},15,[1071],{"type":173,"tag":211,"props":1072,"children":1073},{"style":234},[1074],{"type":179,"value":1015},{"type":173,"tag":211,"props":1076,"children":1078},{"class":213,"line":1077},16,[1079],{"type":173,"tag":211,"props":1080,"children":1081},{"style":218},[1082],{"type":179,"value":1083},"  // value & writeble 不能和 getter/setter 同时出现\n",{"type":173,"tag":211,"props":1085,"children":1087},{"class":213,"line":1086},17,[1088,1092],{"type":173,"tag":211,"props":1089,"children":1090},{"style":234},[1091],{"type":179,"value":421},{"type":173,"tag":211,"props":1093,"children":1094},{"style":228},[1095],{"type":179,"value":300},{"type":173,"tag":181,"props":1097,"children":1098},{},[1099],{"type":179,"value":1100},"通过对 defineProperty 进行上层封装, 我们可以轻松的实现在全局对象上设置响应式属性功能, 在此, 我们结合刚才定义的 Dep 对象, 将一个新的 dep 实例绑定到新增属性的 setter 中:",{"type":173,"tag":201,"props":1102,"children":1104},{"className":203,"code":1103,"language":205,"meta":166,"style":166},"set (key, val, options = {}, obj = this.store) {\n  const dep = new Dep()\n  Object.defineProperty(obj, key, {\n    enumerable: true,\n    configurable: true,\n    get: () => {\n      return val\n    },\n    set: newVal => {\n      if (newVal === val) {\n        return\n      }\n      dep.notify(newVal, val)\n      val = newVal\n    }\n  })\n}\n",[1105],{"type":173,"tag":187,"props":1106,"children":1107},{"__ignoreMap":166},[1108,1174,1206,1247,1267,1287,1311,1323,1331,1355,1389,1397,1405,1441,1457,1465,1477],{"type":173,"tag":211,"props":1109,"children":1110},{"class":213,"line":214},[1111,1115,1120,1124,1128,1132,1137,1141,1146,1151,1155,1160,1164,1169],{"type":173,"tag":211,"props":1112,"children":1113},{"style":240},[1114],{"type":179,"value":243},{"type":173,"tag":211,"props":1116,"children":1117},{"style":228},[1118],{"type":179,"value":1119}," (key",{"type":173,"tag":211,"props":1121,"children":1122},{"style":234},[1123],{"type":179,"value":269},{"type":173,"tag":211,"props":1125,"children":1126},{"style":228},[1127],{"type":179,"value":280},{"type":173,"tag":211,"props":1129,"children":1130},{"style":234},[1131],{"type":179,"value":269},{"type":173,"tag":211,"props":1133,"children":1134},{"style":228},[1135],{"type":179,"value":1136}," options ",{"type":173,"tag":211,"props":1138,"children":1139},{"style":464},[1140],{"type":179,"value":467},{"type":173,"tag":211,"props":1142,"children":1143},{"style":234},[1144],{"type":179,"value":1145}," {},",{"type":173,"tag":211,"props":1147,"children":1148},{"style":228},[1149],{"type":179,"value":1150}," obj ",{"type":173,"tag":211,"props":1152,"children":1153},{"style":464},[1154],{"type":179,"value":467},{"type":173,"tag":211,"props":1156,"children":1157},{"style":571},[1158],{"type":179,"value":1159}," this",{"type":173,"tag":211,"props":1161,"children":1162},{"style":234},[1163],{"type":179,"value":237},{"type":173,"tag":211,"props":1165,"children":1166},{"style":228},[1167],{"type":179,"value":1168},"store) ",{"type":173,"tag":211,"props":1170,"children":1171},{"style":234},[1172],{"type":179,"value":1173},"{\n",{"type":173,"tag":211,"props":1175,"children":1176},{"class":213,"line":224},[1177,1182,1188,1192,1197,1201],{"type":173,"tag":211,"props":1178,"children":1179},{"style":356},[1180],{"type":179,"value":1181},"  const",{"type":173,"tag":211,"props":1183,"children":1185},{"style":1184},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[1186],{"type":179,"value":1187}," dep",{"type":173,"tag":211,"props":1189,"children":1190},{"style":464},[1191],{"type":179,"value":588},{"type":173,"tag":211,"props":1193,"children":1194},{"style":464},[1195],{"type":179,"value":1196}," new",{"type":173,"tag":211,"props":1198,"children":1199},{"style":240},[1200],{"type":179,"value":544},{"type":173,"tag":211,"props":1202,"children":1203},{"style":277},[1204],{"type":179,"value":1205},"()\n",{"type":173,"tag":211,"props":1207,"children":1208},{"class":213,"line":303},[1209,1214,1218,1222,1226,1231,1235,1239,1243],{"type":173,"tag":211,"props":1210,"children":1211},{"style":228},[1212],{"type":179,"value":1213},"  Object",{"type":173,"tag":211,"props":1215,"children":1216},{"style":234},[1217],{"type":179,"value":237},{"type":173,"tag":211,"props":1219,"children":1220},{"style":240},[1221],{"type":179,"value":829},{"type":173,"tag":211,"props":1223,"children":1224},{"style":277},[1225],{"type":179,"value":248},{"type":173,"tag":211,"props":1227,"children":1228},{"style":228},[1229],{"type":179,"value":1230},"obj",{"type":173,"tag":211,"props":1232,"children":1233},{"style":234},[1234],{"type":179,"value":269},{"type":173,"tag":211,"props":1236,"children":1237},{"style":228},[1238],{"type":179,"value":894},{"type":173,"tag":211,"props":1240,"children":1241},{"style":234},[1242],{"type":179,"value":269},{"type":173,"tag":211,"props":1244,"children":1245},{"style":234},[1246],{"type":179,"value":364},{"type":173,"tag":211,"props":1248,"children":1249},{"class":213,"line":312},[1250,1255,1259,1263],{"type":173,"tag":211,"props":1251,"children":1252},{"style":277},[1253],{"type":179,"value":1254},"    enumerable",{"type":173,"tag":211,"props":1256,"children":1257},{"style":234},[1258],{"type":179,"value":285},{"type":173,"tag":211,"props":1260,"children":1261},{"style":925},[1262],{"type":179,"value":928},{"type":173,"tag":211,"props":1264,"children":1265},{"style":234},[1266],{"type":179,"value":933},{"type":173,"tag":211,"props":1268,"children":1269},{"class":213,"line":367},[1270,1275,1279,1283],{"type":173,"tag":211,"props":1271,"children":1272},{"style":277},[1273],{"type":179,"value":1274},"    configurable",{"type":173,"tag":211,"props":1276,"children":1277},{"style":234},[1278],{"type":179,"value":285},{"type":173,"tag":211,"props":1280,"children":1281},{"style":925},[1282],{"type":179,"value":928},{"type":173,"tag":211,"props":1284,"children":1285},{"style":234},[1286],{"type":179,"value":933},{"type":173,"tag":211,"props":1288,"children":1289},{"class":213,"line":415},[1290,1295,1299,1303,1307],{"type":173,"tag":211,"props":1291,"children":1292},{"style":240},[1293],{"type":179,"value":1294},"    get",{"type":173,"tag":211,"props":1296,"children":1297},{"style":234},[1298],{"type":179,"value":285},{"type":173,"tag":211,"props":1300,"children":1301},{"style":234},[1302],{"type":179,"value":561},{"type":173,"tag":211,"props":1304,"children":1305},{"style":356},[1306],{"type":179,"value":359},{"type":173,"tag":211,"props":1308,"children":1309},{"style":234},[1310],{"type":179,"value":364},{"type":173,"tag":211,"props":1312,"children":1313},{"class":213,"line":428},[1314,1319],{"type":173,"tag":211,"props":1315,"children":1316},{"style":999},[1317],{"type":179,"value":1318},"      return",{"type":173,"tag":211,"props":1320,"children":1321},{"style":228},[1322],{"type":179,"value":1007},{"type":173,"tag":211,"props":1324,"children":1325},{"class":213,"line":682},[1326],{"type":173,"tag":211,"props":1327,"children":1328},{"style":234},[1329],{"type":179,"value":1330},"    },\n",{"type":173,"tag":211,"props":1332,"children":1333},{"class":213,"line":691},[1334,1339,1343,1347,1351],{"type":173,"tag":211,"props":1335,"children":1336},{"style":240},[1337],{"type":179,"value":1338},"    set",{"type":173,"tag":211,"props":1340,"children":1341},{"style":234},[1342],{"type":179,"value":285},{"type":173,"tag":211,"props":1344,"children":1345},{"style":350},[1346],{"type":179,"value":353},{"type":173,"tag":211,"props":1348,"children":1349},{"style":356},[1350],{"type":179,"value":359},{"type":173,"tag":211,"props":1352,"children":1353},{"style":234},[1354],{"type":179,"value":364},{"type":173,"tag":211,"props":1356,"children":1357},{"class":213,"line":726},[1358,1363,1367,1371,1376,1380,1385],{"type":173,"tag":211,"props":1359,"children":1360},{"style":999},[1361],{"type":179,"value":1362},"      if",{"type":173,"tag":211,"props":1364,"children":1365},{"style":277},[1366],{"type":179,"value":623},{"type":173,"tag":211,"props":1368,"children":1369},{"style":228},[1370],{"type":179,"value":706},{"type":173,"tag":211,"props":1372,"children":1373},{"style":464},[1374],{"type":179,"value":1375}," ===",{"type":173,"tag":211,"props":1377,"children":1378},{"style":228},[1379],{"type":179,"value":280},{"type":173,"tag":211,"props":1381,"children":1382},{"style":277},[1383],{"type":179,"value":1384},") ",{"type":173,"tag":211,"props":1386,"children":1387},{"style":234},[1388],{"type":179,"value":1173},{"type":173,"tag":211,"props":1390,"children":1391},{"class":213,"line":790},[1392],{"type":173,"tag":211,"props":1393,"children":1394},{"style":999},[1395],{"type":179,"value":1396},"        return\n",{"type":173,"tag":211,"props":1398,"children":1399},{"class":213,"line":798},[1400],{"type":173,"tag":211,"props":1401,"children":1402},{"style":234},[1403],{"type":179,"value":1404},"      }\n",{"type":173,"tag":211,"props":1406,"children":1407},{"class":213,"line":1026},[1408,1413,1417,1421,1425,1429,1433,1437],{"type":173,"tag":211,"props":1409,"children":1410},{"style":228},[1411],{"type":179,"value":1412},"      dep",{"type":173,"tag":211,"props":1414,"children":1415},{"style":234},[1416],{"type":179,"value":237},{"type":173,"tag":211,"props":1418,"children":1419},{"style":240},[1420],{"type":179,"value":815},{"type":173,"tag":211,"props":1422,"children":1423},{"style":277},[1424],{"type":179,"value":248},{"type":173,"tag":211,"props":1426,"children":1427},{"style":228},[1428],{"type":179,"value":706},{"type":173,"tag":211,"props":1430,"children":1431},{"style":234},[1432],{"type":179,"value":269},{"type":173,"tag":211,"props":1434,"children":1435},{"style":228},[1436],{"type":179,"value":280},{"type":173,"tag":211,"props":1438,"children":1439},{"style":277},[1440],{"type":179,"value":300},{"type":173,"tag":211,"props":1442,"children":1443},{"class":213,"line":1051},[1444,1449,1453],{"type":173,"tag":211,"props":1445,"children":1446},{"style":228},[1447],{"type":179,"value":1448},"      val",{"type":173,"tag":211,"props":1450,"children":1451},{"style":464},[1452],{"type":179,"value":588},{"type":173,"tag":211,"props":1454,"children":1455},{"style":228},[1456],{"type":179,"value":1066},{"type":173,"tag":211,"props":1458,"children":1459},{"class":213,"line":1069},[1460],{"type":173,"tag":211,"props":1461,"children":1462},{"style":234},[1463],{"type":179,"value":1464},"    }\n",{"type":173,"tag":211,"props":1466,"children":1467},{"class":213,"line":1077},[1468,1473],{"type":173,"tag":211,"props":1469,"children":1470},{"style":234},[1471],{"type":179,"value":1472},"  }",{"type":173,"tag":211,"props":1474,"children":1475},{"style":277},[1476],{"type":179,"value":300},{"type":173,"tag":211,"props":1478,"children":1479},{"class":213,"line":1086},[1480],{"type":173,"tag":211,"props":1481,"children":1482},{"style":234},[1483],{"type":179,"value":804},{"type":173,"tag":181,"props":1485,"children":1486},{},[1487],{"type":179,"value":1488},"每当对应属性被赋值, 就会执行依赖数组中的回调函数.",{"type":173,"tag":181,"props":1490,"children":1491},{},[1492],{"type":179,"value":1493},"不过这样还不够, 我们还得想办法获取到这个 dep 实例, 才能给它的依赖数组填充函数.",{"type":173,"tag":181,"props":1495,"children":1496},{},[1497],{"type":179,"value":1498},"这边提供一个很简单的思路, 并不推荐实践中这么做:",{"type":173,"tag":201,"props":1500,"children":1502},{"className":203,"code":1501,"language":205,"meta":166,"style":166},"set (key, val, options = {}, obj = this.store) {\n  const dep = new Dep()\n  Object.defineProperty(obj, key, {})\n  return dep\n}\n",[1503],{"type":173,"tag":187,"props":1504,"children":1505},{"__ignoreMap":166},[1506,1565,1592,1636,1649],{"type":173,"tag":211,"props":1507,"children":1508},{"class":213,"line":214},[1509,1513,1517,1521,1525,1529,1533,1537,1541,1545,1549,1553,1557,1561],{"type":173,"tag":211,"props":1510,"children":1511},{"style":240},[1512],{"type":179,"value":243},{"type":173,"tag":211,"props":1514,"children":1515},{"style":228},[1516],{"type":179,"value":1119},{"type":173,"tag":211,"props":1518,"children":1519},{"style":234},[1520],{"type":179,"value":269},{"type":173,"tag":211,"props":1522,"children":1523},{"style":228},[1524],{"type":179,"value":280},{"type":173,"tag":211,"props":1526,"children":1527},{"style":234},[1528],{"type":179,"value":269},{"type":173,"tag":211,"props":1530,"children":1531},{"style":228},[1532],{"type":179,"value":1136},{"type":173,"tag":211,"props":1534,"children":1535},{"style":464},[1536],{"type":179,"value":467},{"type":173,"tag":211,"props":1538,"children":1539},{"style":234},[1540],{"type":179,"value":1145},{"type":173,"tag":211,"props":1542,"children":1543},{"style":228},[1544],{"type":179,"value":1150},{"type":173,"tag":211,"props":1546,"children":1547},{"style":464},[1548],{"type":179,"value":467},{"type":173,"tag":211,"props":1550,"children":1551},{"style":571},[1552],{"type":179,"value":1159},{"type":173,"tag":211,"props":1554,"children":1555},{"style":234},[1556],{"type":179,"value":237},{"type":173,"tag":211,"props":1558,"children":1559},{"style":228},[1560],{"type":179,"value":1168},{"type":173,"tag":211,"props":1562,"children":1563},{"style":234},[1564],{"type":179,"value":1173},{"type":173,"tag":211,"props":1566,"children":1567},{"class":213,"line":224},[1568,1572,1576,1580,1584,1588],{"type":173,"tag":211,"props":1569,"children":1570},{"style":356},[1571],{"type":179,"value":1181},{"type":173,"tag":211,"props":1573,"children":1574},{"style":1184},[1575],{"type":179,"value":1187},{"type":173,"tag":211,"props":1577,"children":1578},{"style":464},[1579],{"type":179,"value":588},{"type":173,"tag":211,"props":1581,"children":1582},{"style":464},[1583],{"type":179,"value":1196},{"type":173,"tag":211,"props":1585,"children":1586},{"style":240},[1587],{"type":179,"value":544},{"type":173,"tag":211,"props":1589,"children":1590},{"style":277},[1591],{"type":179,"value":1205},{"type":173,"tag":211,"props":1593,"children":1594},{"class":213,"line":303},[1595,1599,1603,1607,1611,1615,1619,1623,1627,1632],{"type":173,"tag":211,"props":1596,"children":1597},{"style":228},[1598],{"type":179,"value":1213},{"type":173,"tag":211,"props":1600,"children":1601},{"style":234},[1602],{"type":179,"value":237},{"type":173,"tag":211,"props":1604,"children":1605},{"style":240},[1606],{"type":179,"value":829},{"type":173,"tag":211,"props":1608,"children":1609},{"style":277},[1610],{"type":179,"value":248},{"type":173,"tag":211,"props":1612,"children":1613},{"style":228},[1614],{"type":179,"value":1230},{"type":173,"tag":211,"props":1616,"children":1617},{"style":234},[1618],{"type":179,"value":269},{"type":173,"tag":211,"props":1620,"children":1621},{"style":228},[1622],{"type":179,"value":894},{"type":173,"tag":211,"props":1624,"children":1625},{"style":234},[1626],{"type":179,"value":269},{"type":173,"tag":211,"props":1628,"children":1629},{"style":234},[1630],{"type":179,"value":1631}," {}",{"type":173,"tag":211,"props":1633,"children":1634},{"style":277},[1635],{"type":179,"value":300},{"type":173,"tag":211,"props":1637,"children":1638},{"class":213,"line":312},[1639,1644],{"type":173,"tag":211,"props":1640,"children":1641},{"style":999},[1642],{"type":179,"value":1643},"  return",{"type":173,"tag":211,"props":1645,"children":1646},{"style":228},[1647],{"type":179,"value":1648}," dep\n",{"type":173,"tag":211,"props":1650,"children":1651},{"class":213,"line":367},[1652],{"type":173,"tag":211,"props":1653,"children":1654},{"style":234},[1655],{"type":179,"value":804},{"type":173,"tag":201,"props":1657,"children":1659},{"className":203,"code":1658,"language":205,"meta":166,"style":166},"const valueDep = set('value', b, {})\nvalueDep.addSub(() => { console.log('value changed!') })\n",[1660],{"type":173,"tag":187,"props":1661,"children":1662},{"__ignoreMap":166},[1663,1722],{"type":173,"tag":211,"props":1664,"children":1665},{"class":213,"line":214},[1666,1671,1676,1680,1685,1689,1693,1697,1701,1705,1710,1714,1718],{"type":173,"tag":211,"props":1667,"children":1668},{"style":356},[1669],{"type":179,"value":1670},"const",{"type":173,"tag":211,"props":1672,"children":1673},{"style":1184},[1674],{"type":179,"value":1675}," valueDep",{"type":173,"tag":211,"props":1677,"children":1678},{"style":464},[1679],{"type":179,"value":588},{"type":173,"tag":211,"props":1681,"children":1682},{"style":240},[1683],{"type":179,"value":1684}," set",{"type":173,"tag":211,"props":1686,"children":1687},{"style":228},[1688],{"type":179,"value":248},{"type":173,"tag":211,"props":1690,"children":1691},{"style":251},[1692],{"type":179,"value":254},{"type":173,"tag":211,"props":1694,"children":1695},{"style":257},[1696],{"type":179,"value":434},{"type":173,"tag":211,"props":1698,"children":1699},{"style":251},[1700],{"type":179,"value":254},{"type":173,"tag":211,"props":1702,"children":1703},{"style":234},[1704],{"type":179,"value":269},{"type":173,"tag":211,"props":1706,"children":1707},{"style":228},[1708],{"type":179,"value":1709}," b",{"type":173,"tag":211,"props":1711,"children":1712},{"style":234},[1713],{"type":179,"value":269},{"type":173,"tag":211,"props":1715,"children":1716},{"style":234},[1717],{"type":179,"value":1631},{"type":173,"tag":211,"props":1719,"children":1720},{"style":228},[1721],{"type":179,"value":300},{"type":173,"tag":211,"props":1723,"children":1724},{"class":213,"line":224},[1725,1730,1734,1739,1743,1748,1752,1756,1761,1765,1769,1773,1777,1782,1786,1790,1794],{"type":173,"tag":211,"props":1726,"children":1727},{"style":228},[1728],{"type":179,"value":1729},"valueDep",{"type":173,"tag":211,"props":1731,"children":1732},{"style":234},[1733],{"type":179,"value":237},{"type":173,"tag":211,"props":1735,"children":1736},{"style":240},[1737],{"type":179,"value":1738},"addSub",{"type":173,"tag":211,"props":1740,"children":1741},{"style":228},[1742],{"type":179,"value":248},{"type":173,"tag":211,"props":1744,"children":1745},{"style":234},[1746],{"type":179,"value":1747},"()",{"type":173,"tag":211,"props":1749,"children":1750},{"style":356},[1751],{"type":179,"value":359},{"type":173,"tag":211,"props":1753,"children":1754},{"style":234},[1755],{"type":179,"value":274},{"type":173,"tag":211,"props":1757,"children":1758},{"style":228},[1759],{"type":179,"value":1760}," console",{"type":173,"tag":211,"props":1762,"children":1763},{"style":234},[1764],{"type":179,"value":237},{"type":173,"tag":211,"props":1766,"children":1767},{"style":240},[1768],{"type":179,"value":382},{"type":173,"tag":211,"props":1770,"children":1771},{"style":277},[1772],{"type":179,"value":248},{"type":173,"tag":211,"props":1774,"children":1775},{"style":251},[1776],{"type":179,"value":254},{"type":173,"tag":211,"props":1778,"children":1779},{"style":257},[1780],{"type":179,"value":1781},"value changed!",{"type":173,"tag":211,"props":1783,"children":1784},{"style":251},[1785],{"type":179,"value":254},{"type":173,"tag":211,"props":1787,"children":1788},{"style":277},[1789],{"type":179,"value":1384},{"type":173,"tag":211,"props":1791,"children":1792},{"style":234},[1793],{"type":179,"value":421},{"type":173,"tag":211,"props":1795,"children":1796},{"style":228},[1797],{"type":179,"value":300},{"type":173,"tag":181,"props":1799,"children":1800},{},[1801],{"type":179,"value":1802},"虽然代码能使用了, 就是是看起来怪怪的~ 😋 我们的三轮车开进了岔路~",{"type":173,"tag":174,"props":1804,"children":1806},{"id":1805},"通过-watch-添加订阅",[1807],{"type":179,"value":1808},"通过 watch 添加订阅",{"type":173,"tag":824,"props":1810,"children":1812},{"id":1811},"喝口水我们继续",[1813],{"type":179,"value":1811},{"type":173,"tag":181,"props":1815,"children":1816},{},[1817],{"type":179,"value":1818},"《黑客与画家》中曾经提到这样一个观点, 我深有体会:",{"type":173,"tag":1820,"props":1821,"children":1822},"blockquote",{},[1823],{"type":173,"tag":181,"props":1824,"children":1825},{},[1826],{"type":179,"value":1827},"如果你觉得你的代码奇怪, 那么往往它是错的",{"type":173,"tag":181,"props":1829,"children":1830},{},[1831],{"type":179,"value":1832},"上面的那一串代码仅仅是能跑通的水平, 我们需要加入更多的细节和思考, 有时候只需要坐下来稍微看一下代码, 就会有各种想法蹦出来:",{"type":173,"tag":1820,"props":1834,"children":1835},{},[1836],{"type":173,"tag":181,"props":1837,"children":1838},{},[1839],{"type":179,"value":1840},"构思这种东西有一个特点，那就是它会导致更多的构思。你有没有注意过，坐下来写东西的时候，一半的构思是写作时产生的？",{"type":173,"tag":824,"props":1842,"children":1844},{"id":1843},"隐藏-dep",[1845],{"type":179,"value":1846},"隐藏 Dep",{"type":173,"tag":181,"props":1848,"children":1849},{},[1850],{"type":179,"value":1851},"这些内容应和外部是解耦的. 首先一点, 我们创建一个侦听器类, 用于封装我们侦听所用到的所有方法, 它包含了我们想要的全局对象以及操作它的方法(如 watch,set):",{"type":173,"tag":201,"props":1853,"children":1855},{"className":203,"code":1854,"language":205,"meta":166,"style":166},"class VX {\n  constructor () {\n    this.store = Object.create(null)\n  }\n  watch (key, fn, obj = this.store) {}\n  set (key, val, options = {}, obj = this.store) {}\n}\nconst vx = new VX()\n",[1856],{"type":173,"tag":187,"props":1857,"children":1858},{"__ignoreMap":166},[1859,1875,1890,1938,1945,2005,2073,2080],{"type":173,"tag":211,"props":1860,"children":1861},{"class":213,"line":214},[1862,1866,1871],{"type":173,"tag":211,"props":1863,"children":1864},{"style":356},[1865],{"type":179,"value":538},{"type":173,"tag":211,"props":1867,"children":1868},{"style":541},[1869],{"type":179,"value":1870}," VX",{"type":173,"tag":211,"props":1872,"children":1873},{"style":234},[1874],{"type":179,"value":364},{"type":173,"tag":211,"props":1876,"children":1877},{"class":213,"line":224},[1878,1882,1886],{"type":173,"tag":211,"props":1879,"children":1880},{"style":356},[1881],{"type":179,"value":556},{"type":173,"tag":211,"props":1883,"children":1884},{"style":234},[1885],{"type":179,"value":561},{"type":173,"tag":211,"props":1887,"children":1888},{"style":234},[1889],{"type":179,"value":364},{"type":173,"tag":211,"props":1891,"children":1892},{"class":213,"line":303},[1893,1897,1901,1906,1910,1915,1919,1924,1928,1934],{"type":173,"tag":211,"props":1894,"children":1895},{"style":571},[1896],{"type":179,"value":574},{"type":173,"tag":211,"props":1898,"children":1899},{"style":234},[1900],{"type":179,"value":237},{"type":173,"tag":211,"props":1902,"children":1903},{"style":228},[1904],{"type":179,"value":1905},"store",{"type":173,"tag":211,"props":1907,"children":1908},{"style":464},[1909],{"type":179,"value":588},{"type":173,"tag":211,"props":1911,"children":1912},{"style":228},[1913],{"type":179,"value":1914}," Object",{"type":173,"tag":211,"props":1916,"children":1917},{"style":234},[1918],{"type":179,"value":237},{"type":173,"tag":211,"props":1920,"children":1921},{"style":240},[1922],{"type":179,"value":1923},"create",{"type":173,"tag":211,"props":1925,"children":1926},{"style":277},[1927],{"type":179,"value":248},{"type":173,"tag":211,"props":1929,"children":1931},{"style":1930},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1932],{"type":179,"value":1933},"null",{"type":173,"tag":211,"props":1935,"children":1936},{"style":277},[1937],{"type":179,"value":300},{"type":173,"tag":211,"props":1939,"children":1940},{"class":213,"line":312},[1941],{"type":173,"tag":211,"props":1942,"children":1943},{"style":234},[1944],{"type":179,"value":601},{"type":173,"tag":211,"props":1946,"children":1947},{"class":213,"line":367},[1948,1953,1957,1962,1966,1971,1975,1980,1984,1988,1992,1996,2000],{"type":173,"tag":211,"props":1949,"children":1950},{"style":615},[1951],{"type":179,"value":1952},"  watch",{"type":173,"tag":211,"props":1954,"children":1955},{"style":234},[1956],{"type":179,"value":623},{"type":173,"tag":211,"props":1958,"children":1959},{"style":350},[1960],{"type":179,"value":1961},"key",{"type":173,"tag":211,"props":1963,"children":1964},{"style":234},[1965],{"type":179,"value":269},{"type":173,"tag":211,"props":1967,"children":1968},{"style":350},[1969],{"type":179,"value":1970}," fn",{"type":173,"tag":211,"props":1972,"children":1973},{"style":234},[1974],{"type":179,"value":269},{"type":173,"tag":211,"props":1976,"children":1977},{"style":350},[1978],{"type":179,"value":1979}," obj",{"type":173,"tag":211,"props":1981,"children":1982},{"style":464},[1983],{"type":179,"value":588},{"type":173,"tag":211,"props":1985,"children":1986},{"style":571},[1987],{"type":179,"value":1159},{"type":173,"tag":211,"props":1989,"children":1990},{"style":234},[1991],{"type":179,"value":237},{"type":173,"tag":211,"props":1993,"children":1994},{"style":228},[1995],{"type":179,"value":1905},{"type":173,"tag":211,"props":1997,"children":1998},{"style":234},[1999],{"type":179,"value":633},{"type":173,"tag":211,"props":2001,"children":2002},{"style":234},[2003],{"type":179,"value":2004}," {}\n",{"type":173,"tag":211,"props":2006,"children":2007},{"class":213,"line":415},[2008,2012,2016,2020,2024,2028,2032,2037,2041,2045,2049,2053,2057,2061,2065,2069],{"type":173,"tag":211,"props":2009,"children":2010},{"style":615},[2011],{"type":179,"value":1032},{"type":173,"tag":211,"props":2013,"children":2014},{"style":234},[2015],{"type":179,"value":623},{"type":173,"tag":211,"props":2017,"children":2018},{"style":350},[2019],{"type":179,"value":1961},{"type":173,"tag":211,"props":2021,"children":2022},{"style":234},[2023],{"type":179,"value":269},{"type":173,"tag":211,"props":2025,"children":2026},{"style":350},[2027],{"type":179,"value":280},{"type":173,"tag":211,"props":2029,"children":2030},{"style":234},[2031],{"type":179,"value":269},{"type":173,"tag":211,"props":2033,"children":2034},{"style":350},[2035],{"type":179,"value":2036}," options",{"type":173,"tag":211,"props":2038,"children":2039},{"style":464},[2040],{"type":179,"value":588},{"type":173,"tag":211,"props":2042,"children":2043},{"style":234},[2044],{"type":179,"value":1145},{"type":173,"tag":211,"props":2046,"children":2047},{"style":350},[2048],{"type":179,"value":1979},{"type":173,"tag":211,"props":2050,"children":2051},{"style":464},[2052],{"type":179,"value":588},{"type":173,"tag":211,"props":2054,"children":2055},{"style":571},[2056],{"type":179,"value":1159},{"type":173,"tag":211,"props":2058,"children":2059},{"style":234},[2060],{"type":179,"value":237},{"type":173,"tag":211,"props":2062,"children":2063},{"style":228},[2064],{"type":179,"value":1905},{"type":173,"tag":211,"props":2066,"children":2067},{"style":234},[2068],{"type":179,"value":633},{"type":173,"tag":211,"props":2070,"children":2071},{"style":234},[2072],{"type":179,"value":2004},{"type":173,"tag":211,"props":2074,"children":2075},{"class":213,"line":428},[2076],{"type":173,"tag":211,"props":2077,"children":2078},{"style":234},[2079],{"type":179,"value":804},{"type":173,"tag":211,"props":2081,"children":2082},{"class":213,"line":682},[2083,2087,2092,2096,2100,2104],{"type":173,"tag":211,"props":2084,"children":2085},{"style":356},[2086],{"type":179,"value":1670},{"type":173,"tag":211,"props":2088,"children":2089},{"style":1184},[2090],{"type":179,"value":2091}," vx",{"type":173,"tag":211,"props":2093,"children":2094},{"style":464},[2095],{"type":179,"value":588},{"type":173,"tag":211,"props":2097,"children":2098},{"style":464},[2099],{"type":179,"value":1196},{"type":173,"tag":211,"props":2101,"children":2102},{"style":240},[2103],{"type":179,"value":1870},{"type":173,"tag":211,"props":2105,"children":2106},{"style":228},[2107],{"type":179,"value":1205},{"type":173,"tag":181,"props":2109,"children":2110},{},[2111],{"type":179,"value":2112},"我们可以在 watch 中给对象某个属性添加回调, 就不用去直接操作 Dep 依赖数组了. 只是, 我们在业务代码中调用 watch, 要怎么去获取 obj.key 对应的 dep 呢?",{"type":173,"tag":181,"props":2114,"children":2115},{},[2116],{"type":179,"value":2117},"我们设置一个全局的 depHandler, 在 obj.key 的 getter 中主动将 depHandler 设置为当前 obj.key 的 dep 实例, 那么我们在 watch 函数里, 只要用任意操作触发 obj.key 的 getter, 就能通过 depHandler 得到它的 dep 实例了, 代码形如:",{"type":173,"tag":201,"props":2119,"children":2121},{"className":203,"code":2120,"language":205,"meta":166,"style":166},"  // 一开始没有持有dep实例\n  let handleDep = null\n  class VX {\n    watch (key, fn, obj = this.store) {\n      console.log(obj.key) // 使用任意操作触发obj.key的getter, 那么handleDep将自动引用obj.key的dep实例\n      handleDep.addSub(fn)\n    }\n    set (key, val, options = {}, obj = this.store) {\n      const dep = new Dep()\n      Object.defineProperty(obj, key, {\n        enumerable: true,\n        configurable: true,\n        get: () => {\n          handleDep = dep\n          return val\n        },\n        set: newVal => {}\n      })\n    }\n  }\n",[2122],{"type":173,"tag":187,"props":2123,"children":2124},{"__ignoreMap":166},[2125,2133,2155,2171,2227,2268,2296,2303,2370,2398,2438,2458,2478,2502,2518,2530,2538,2562,2575,2583],{"type":173,"tag":211,"props":2126,"children":2127},{"class":213,"line":214},[2128],{"type":173,"tag":211,"props":2129,"children":2130},{"style":218},[2131],{"type":179,"value":2132},"  // 一开始没有持有dep实例\n",{"type":173,"tag":211,"props":2134,"children":2135},{"class":213,"line":224},[2136,2141,2146,2150],{"type":173,"tag":211,"props":2137,"children":2138},{"style":356},[2139],{"type":179,"value":2140},"  let",{"type":173,"tag":211,"props":2142,"children":2143},{"style":228},[2144],{"type":179,"value":2145}," handleDep ",{"type":173,"tag":211,"props":2147,"children":2148},{"style":464},[2149],{"type":179,"value":467},{"type":173,"tag":211,"props":2151,"children":2152},{"style":1930},[2153],{"type":179,"value":2154}," null\n",{"type":173,"tag":211,"props":2156,"children":2157},{"class":213,"line":303},[2158,2163,2167],{"type":173,"tag":211,"props":2159,"children":2160},{"style":356},[2161],{"type":179,"value":2162},"  class",{"type":173,"tag":211,"props":2164,"children":2165},{"style":541},[2166],{"type":179,"value":1870},{"type":173,"tag":211,"props":2168,"children":2169},{"style":234},[2170],{"type":179,"value":364},{"type":173,"tag":211,"props":2172,"children":2173},{"class":213,"line":312},[2174,2179,2183,2187,2191,2195,2199,2203,2207,2211,2215,2219,2223],{"type":173,"tag":211,"props":2175,"children":2176},{"style":615},[2177],{"type":179,"value":2178},"    watch",{"type":173,"tag":211,"props":2180,"children":2181},{"style":234},[2182],{"type":179,"value":623},{"type":173,"tag":211,"props":2184,"children":2185},{"style":350},[2186],{"type":179,"value":1961},{"type":173,"tag":211,"props":2188,"children":2189},{"style":234},[2190],{"type":179,"value":269},{"type":173,"tag":211,"props":2192,"children":2193},{"style":350},[2194],{"type":179,"value":1970},{"type":173,"tag":211,"props":2196,"children":2197},{"style":234},[2198],{"type":179,"value":269},{"type":173,"tag":211,"props":2200,"children":2201},{"style":350},[2202],{"type":179,"value":1979},{"type":173,"tag":211,"props":2204,"children":2205},{"style":464},[2206],{"type":179,"value":588},{"type":173,"tag":211,"props":2208,"children":2209},{"style":571},[2210],{"type":179,"value":1159},{"type":173,"tag":211,"props":2212,"children":2213},{"style":234},[2214],{"type":179,"value":237},{"type":173,"tag":211,"props":2216,"children":2217},{"style":228},[2218],{"type":179,"value":1905},{"type":173,"tag":211,"props":2220,"children":2221},{"style":234},[2222],{"type":179,"value":633},{"type":173,"tag":211,"props":2224,"children":2225},{"style":234},[2226],{"type":179,"value":364},{"type":173,"tag":211,"props":2228,"children":2229},{"class":213,"line":367},[2230,2235,2239,2243,2247,2251,2255,2259,2263],{"type":173,"tag":211,"props":2231,"children":2232},{"style":228},[2233],{"type":179,"value":2234},"      console",{"type":173,"tag":211,"props":2236,"children":2237},{"style":234},[2238],{"type":179,"value":237},{"type":173,"tag":211,"props":2240,"children":2241},{"style":240},[2242],{"type":179,"value":382},{"type":173,"tag":211,"props":2244,"children":2245},{"style":277},[2246],{"type":179,"value":248},{"type":173,"tag":211,"props":2248,"children":2249},{"style":228},[2250],{"type":179,"value":1230},{"type":173,"tag":211,"props":2252,"children":2253},{"style":234},[2254],{"type":179,"value":237},{"type":173,"tag":211,"props":2256,"children":2257},{"style":228},[2258],{"type":179,"value":1961},{"type":173,"tag":211,"props":2260,"children":2261},{"style":277},[2262],{"type":179,"value":1384},{"type":173,"tag":211,"props":2264,"children":2265},{"style":218},[2266],{"type":179,"value":2267},"// 使用任意操作触发obj.key的getter, 那么handleDep将自动引用obj.key的dep实例\n",{"type":173,"tag":211,"props":2269,"children":2270},{"class":213,"line":415},[2271,2276,2280,2284,2288,2292],{"type":173,"tag":211,"props":2272,"children":2273},{"style":228},[2274],{"type":179,"value":2275},"      handleDep",{"type":173,"tag":211,"props":2277,"children":2278},{"style":234},[2279],{"type":179,"value":237},{"type":173,"tag":211,"props":2281,"children":2282},{"style":240},[2283],{"type":179,"value":1738},{"type":173,"tag":211,"props":2285,"children":2286},{"style":277},[2287],{"type":179,"value":248},{"type":173,"tag":211,"props":2289,"children":2290},{"style":228},[2291],{"type":179,"value":628},{"type":173,"tag":211,"props":2293,"children":2294},{"style":277},[2295],{"type":179,"value":300},{"type":173,"tag":211,"props":2297,"children":2298},{"class":213,"line":428},[2299],{"type":173,"tag":211,"props":2300,"children":2301},{"style":234},[2302],{"type":179,"value":1464},{"type":173,"tag":211,"props":2304,"children":2305},{"class":213,"line":682},[2306,2310,2314,2318,2322,2326,2330,2334,2338,2342,2346,2350,2354,2358,2362,2366],{"type":173,"tag":211,"props":2307,"children":2308},{"style":615},[2309],{"type":179,"value":1338},{"type":173,"tag":211,"props":2311,"children":2312},{"style":234},[2313],{"type":179,"value":623},{"type":173,"tag":211,"props":2315,"children":2316},{"style":350},[2317],{"type":179,"value":1961},{"type":173,"tag":211,"props":2319,"children":2320},{"style":234},[2321],{"type":179,"value":269},{"type":173,"tag":211,"props":2323,"children":2324},{"style":350},[2325],{"type":179,"value":280},{"type":173,"tag":211,"props":2327,"children":2328},{"style":234},[2329],{"type":179,"value":269},{"type":173,"tag":211,"props":2331,"children":2332},{"style":350},[2333],{"type":179,"value":2036},{"type":173,"tag":211,"props":2335,"children":2336},{"style":464},[2337],{"type":179,"value":588},{"type":173,"tag":211,"props":2339,"children":2340},{"style":234},[2341],{"type":179,"value":1145},{"type":173,"tag":211,"props":2343,"children":2344},{"style":350},[2345],{"type":179,"value":1979},{"type":173,"tag":211,"props":2347,"children":2348},{"style":464},[2349],{"type":179,"value":588},{"type":173,"tag":211,"props":2351,"children":2352},{"style":571},[2353],{"type":179,"value":1159},{"type":173,"tag":211,"props":2355,"children":2356},{"style":234},[2357],{"type":179,"value":237},{"type":173,"tag":211,"props":2359,"children":2360},{"style":228},[2361],{"type":179,"value":1905},{"type":173,"tag":211,"props":2363,"children":2364},{"style":234},[2365],{"type":179,"value":633},{"type":173,"tag":211,"props":2367,"children":2368},{"style":234},[2369],{"type":179,"value":364},{"type":173,"tag":211,"props":2371,"children":2372},{"class":213,"line":691},[2373,2378,2382,2386,2390,2394],{"type":173,"tag":211,"props":2374,"children":2375},{"style":356},[2376],{"type":179,"value":2377},"      const",{"type":173,"tag":211,"props":2379,"children":2380},{"style":1184},[2381],{"type":179,"value":1187},{"type":173,"tag":211,"props":2383,"children":2384},{"style":464},[2385],{"type":179,"value":588},{"type":173,"tag":211,"props":2387,"children":2388},{"style":464},[2389],{"type":179,"value":1196},{"type":173,"tag":211,"props":2391,"children":2392},{"style":240},[2393],{"type":179,"value":544},{"type":173,"tag":211,"props":2395,"children":2396},{"style":277},[2397],{"type":179,"value":1205},{"type":173,"tag":211,"props":2399,"children":2400},{"class":213,"line":726},[2401,2406,2410,2414,2418,2422,2426,2430,2434],{"type":173,"tag":211,"props":2402,"children":2403},{"style":228},[2404],{"type":179,"value":2405},"      Object",{"type":173,"tag":211,"props":2407,"children":2408},{"style":234},[2409],{"type":179,"value":237},{"type":173,"tag":211,"props":2411,"children":2412},{"style":240},[2413],{"type":179,"value":829},{"type":173,"tag":211,"props":2415,"children":2416},{"style":277},[2417],{"type":179,"value":248},{"type":173,"tag":211,"props":2419,"children":2420},{"style":228},[2421],{"type":179,"value":1230},{"type":173,"tag":211,"props":2423,"children":2424},{"style":234},[2425],{"type":179,"value":269},{"type":173,"tag":211,"props":2427,"children":2428},{"style":228},[2429],{"type":179,"value":894},{"type":173,"tag":211,"props":2431,"children":2432},{"style":234},[2433],{"type":179,"value":269},{"type":173,"tag":211,"props":2435,"children":2436},{"style":234},[2437],{"type":179,"value":364},{"type":173,"tag":211,"props":2439,"children":2440},{"class":213,"line":790},[2441,2446,2450,2454],{"type":173,"tag":211,"props":2442,"children":2443},{"style":277},[2444],{"type":179,"value":2445},"        enumerable",{"type":173,"tag":211,"props":2447,"children":2448},{"style":234},[2449],{"type":179,"value":285},{"type":173,"tag":211,"props":2451,"children":2452},{"style":925},[2453],{"type":179,"value":928},{"type":173,"tag":211,"props":2455,"children":2456},{"style":234},[2457],{"type":179,"value":933},{"type":173,"tag":211,"props":2459,"children":2460},{"class":213,"line":798},[2461,2466,2470,2474],{"type":173,"tag":211,"props":2462,"children":2463},{"style":277},[2464],{"type":179,"value":2465},"        configurable",{"type":173,"tag":211,"props":2467,"children":2468},{"style":234},[2469],{"type":179,"value":285},{"type":173,"tag":211,"props":2471,"children":2472},{"style":925},[2473],{"type":179,"value":928},{"type":173,"tag":211,"props":2475,"children":2476},{"style":234},[2477],{"type":179,"value":933},{"type":173,"tag":211,"props":2479,"children":2480},{"class":213,"line":1026},[2481,2486,2490,2494,2498],{"type":173,"tag":211,"props":2482,"children":2483},{"style":240},[2484],{"type":179,"value":2485},"        get",{"type":173,"tag":211,"props":2487,"children":2488},{"style":234},[2489],{"type":179,"value":285},{"type":173,"tag":211,"props":2491,"children":2492},{"style":234},[2493],{"type":179,"value":561},{"type":173,"tag":211,"props":2495,"children":2496},{"style":356},[2497],{"type":179,"value":359},{"type":173,"tag":211,"props":2499,"children":2500},{"style":234},[2501],{"type":179,"value":364},{"type":173,"tag":211,"props":2503,"children":2504},{"class":213,"line":1051},[2505,2510,2514],{"type":173,"tag":211,"props":2506,"children":2507},{"style":228},[2508],{"type":179,"value":2509},"          handleDep",{"type":173,"tag":211,"props":2511,"children":2512},{"style":464},[2513],{"type":179,"value":588},{"type":173,"tag":211,"props":2515,"children":2516},{"style":228},[2517],{"type":179,"value":1648},{"type":173,"tag":211,"props":2519,"children":2520},{"class":213,"line":1069},[2521,2526],{"type":173,"tag":211,"props":2522,"children":2523},{"style":999},[2524],{"type":179,"value":2525},"          return",{"type":173,"tag":211,"props":2527,"children":2528},{"style":228},[2529],{"type":179,"value":1007},{"type":173,"tag":211,"props":2531,"children":2532},{"class":213,"line":1077},[2533],{"type":173,"tag":211,"props":2534,"children":2535},{"style":234},[2536],{"type":179,"value":2537},"        },\n",{"type":173,"tag":211,"props":2539,"children":2540},{"class":213,"line":1086},[2541,2546,2550,2554,2558],{"type":173,"tag":211,"props":2542,"children":2543},{"style":240},[2544],{"type":179,"value":2545},"        set",{"type":173,"tag":211,"props":2547,"children":2548},{"style":234},[2549],{"type":179,"value":285},{"type":173,"tag":211,"props":2551,"children":2552},{"style":350},[2553],{"type":179,"value":353},{"type":173,"tag":211,"props":2555,"children":2556},{"style":356},[2557],{"type":179,"value":359},{"type":173,"tag":211,"props":2559,"children":2560},{"style":234},[2561],{"type":179,"value":2004},{"type":173,"tag":211,"props":2563,"children":2565},{"class":213,"line":2564},18,[2566,2571],{"type":173,"tag":211,"props":2567,"children":2568},{"style":234},[2569],{"type":179,"value":2570},"      }",{"type":173,"tag":211,"props":2572,"children":2573},{"style":277},[2574],{"type":179,"value":300},{"type":173,"tag":211,"props":2576,"children":2578},{"class":213,"line":2577},19,[2579],{"type":173,"tag":211,"props":2580,"children":2581},{"style":234},[2582],{"type":179,"value":1464},{"type":173,"tag":211,"props":2584,"children":2586},{"class":213,"line":2585},20,[2587],{"type":173,"tag":211,"props":2588,"children":2589},{"style":234},[2590],{"type":179,"value":601},{"type":173,"tag":824,"props":2592,"children":2594},{"id":2593},"主动收集依赖",[2595],{"type":179,"value":2593},{"type":173,"tag":181,"props":2597,"children":2598},{},[2599,2601,2607,2609,2615,2617,2623],{"type":179,"value":2600},"我们增加",{"type":173,"tag":187,"props":2602,"children":2604},{"className":2603},[],[2605],{"type":179,"value":2606},"handleDep.addSub(fn)",{"type":179,"value":2608},"添加回调函数的逻辑, 其实可以直接放到 getter 中, 首先在 Dep 类中封装一个'主动'收集依赖的",{"type":173,"tag":187,"props":2610,"children":2612},{"className":2611},[],[2613],{"type":179,"value":2614},"collect",{"type":179,"value":2616},"方法, 他会将全局",{"type":173,"tag":187,"props":2618,"children":2620},{"className":2619},[],[2621],{"type":179,"value":2622},"handleFn",{"type":179,"value":2624},"存放到订阅数组中, 这样一来, 在 watch 函数中, 我们只要触发 obj.key 的 getter, 就可以主动收集依赖了:",{"type":173,"tag":201,"props":2626,"children":2628},{"className":203,"code":2627,"language":205,"meta":166,"style":166},"let handleFn = null\nclass Dep {\n  addSub (fn) {}\n  delSub (fn) {}\n  clear () {}\n  collect (fn = handleFn) {\n    if (fn && !this.subs.find(x => x === fn)) {\n      this.addSub(fn)\n    }\n  }\n  notify (newVal, oldVal) {}\n}\n\nlet handleDep = null\nclass VX {\n  watch (key, fn, obj = this.store) {\n    handleFn = fn\n    console.log(obj.key)\n  }\n  set (key, val, options = {}, obj = this.store) {\n    const dep = new Dep()\n    Object.defineProperty(obj, key, {\n      enumerable: true,\n      configurable: true,\n      get: () => {\n        handleDep = dep\n        handleDep.collect()\n        return val\n      },\n      set: newVal => {}\n    })\n  }\n}\n",[2629],{"type":173,"tag":187,"props":2630,"children":2631},{"__ignoreMap":166},[2632,2653,2668,2691,2714,2730,2763,2846,2874,2881,2888,2919,2926,2934,2953,2968,3023,3040,3076,3083,3150,3179,3220,3241,3262,3287,3304,3324,3337,3346,3371,3384,3392],{"type":173,"tag":211,"props":2633,"children":2634},{"class":213,"line":214},[2635,2640,2645,2649],{"type":173,"tag":211,"props":2636,"children":2637},{"style":356},[2638],{"type":179,"value":2639},"let",{"type":173,"tag":211,"props":2641,"children":2642},{"style":228},[2643],{"type":179,"value":2644}," handleFn ",{"type":173,"tag":211,"props":2646,"children":2647},{"style":464},[2648],{"type":179,"value":467},{"type":173,"tag":211,"props":2650,"children":2651},{"style":1930},[2652],{"type":179,"value":2154},{"type":173,"tag":211,"props":2654,"children":2655},{"class":213,"line":224},[2656,2660,2664],{"type":173,"tag":211,"props":2657,"children":2658},{"style":356},[2659],{"type":179,"value":538},{"type":173,"tag":211,"props":2661,"children":2662},{"style":541},[2663],{"type":179,"value":544},{"type":173,"tag":211,"props":2665,"children":2666},{"style":234},[2667],{"type":179,"value":364},{"type":173,"tag":211,"props":2669,"children":2670},{"class":213,"line":303},[2671,2675,2679,2683,2687],{"type":173,"tag":211,"props":2672,"children":2673},{"style":615},[2674],{"type":179,"value":618},{"type":173,"tag":211,"props":2676,"children":2677},{"style":234},[2678],{"type":179,"value":623},{"type":173,"tag":211,"props":2680,"children":2681},{"style":350},[2682],{"type":179,"value":628},{"type":173,"tag":211,"props":2684,"children":2685},{"style":234},[2686],{"type":179,"value":633},{"type":173,"tag":211,"props":2688,"children":2689},{"style":234},[2690],{"type":179,"value":2004},{"type":173,"tag":211,"props":2692,"children":2693},{"class":213,"line":312},[2694,2698,2702,2706,2710],{"type":173,"tag":211,"props":2695,"children":2696},{"style":615},[2697],{"type":179,"value":655},{"type":173,"tag":211,"props":2699,"children":2700},{"style":234},[2701],{"type":179,"value":623},{"type":173,"tag":211,"props":2703,"children":2704},{"style":350},[2705],{"type":179,"value":628},{"type":173,"tag":211,"props":2707,"children":2708},{"style":234},[2709],{"type":179,"value":633},{"type":173,"tag":211,"props":2711,"children":2712},{"style":234},[2713],{"type":179,"value":2004},{"type":173,"tag":211,"props":2715,"children":2716},{"class":213,"line":367},[2717,2722,2726],{"type":173,"tag":211,"props":2718,"children":2719},{"style":615},[2720],{"type":179,"value":2721},"  clear",{"type":173,"tag":211,"props":2723,"children":2724},{"style":234},[2725],{"type":179,"value":561},{"type":173,"tag":211,"props":2727,"children":2728},{"style":234},[2729],{"type":179,"value":2004},{"type":173,"tag":211,"props":2731,"children":2732},{"class":213,"line":415},[2733,2738,2742,2746,2750,2755,2759],{"type":173,"tag":211,"props":2734,"children":2735},{"style":615},[2736],{"type":179,"value":2737},"  collect",{"type":173,"tag":211,"props":2739,"children":2740},{"style":234},[2741],{"type":179,"value":623},{"type":173,"tag":211,"props":2743,"children":2744},{"style":350},[2745],{"type":179,"value":628},{"type":173,"tag":211,"props":2747,"children":2748},{"style":464},[2749],{"type":179,"value":588},{"type":173,"tag":211,"props":2751,"children":2752},{"style":228},[2753],{"type":179,"value":2754}," handleFn",{"type":173,"tag":211,"props":2756,"children":2757},{"style":234},[2758],{"type":179,"value":633},{"type":173,"tag":211,"props":2760,"children":2761},{"style":234},[2762],{"type":179,"value":364},{"type":173,"tag":211,"props":2764,"children":2765},{"class":213,"line":428},[2766,2771,2775,2779,2784,2789,2794,2798,2802,2806,2811,2815,2820,2824,2829,2833,2837,2842],{"type":173,"tag":211,"props":2767,"children":2768},{"style":999},[2769],{"type":179,"value":2770},"    if",{"type":173,"tag":211,"props":2772,"children":2773},{"style":277},[2774],{"type":179,"value":623},{"type":173,"tag":211,"props":2776,"children":2777},{"style":228},[2778],{"type":179,"value":628},{"type":173,"tag":211,"props":2780,"children":2781},{"style":464},[2782],{"type":179,"value":2783}," &&",{"type":173,"tag":211,"props":2785,"children":2786},{"style":464},[2787],{"type":179,"value":2788}," !",{"type":173,"tag":211,"props":2790,"children":2791},{"style":571},[2792],{"type":179,"value":2793},"this",{"type":173,"tag":211,"props":2795,"children":2796},{"style":234},[2797],{"type":179,"value":237},{"type":173,"tag":211,"props":2799,"children":2800},{"style":228},[2801],{"type":179,"value":583},{"type":173,"tag":211,"props":2803,"children":2804},{"style":234},[2805],{"type":179,"value":237},{"type":173,"tag":211,"props":2807,"children":2808},{"style":240},[2809],{"type":179,"value":2810},"find",{"type":173,"tag":211,"props":2812,"children":2813},{"style":277},[2814],{"type":179,"value":248},{"type":173,"tag":211,"props":2816,"children":2817},{"style":350},[2818],{"type":179,"value":2819},"x",{"type":173,"tag":211,"props":2821,"children":2822},{"style":356},[2823],{"type":179,"value":359},{"type":173,"tag":211,"props":2825,"children":2826},{"style":228},[2827],{"type":179,"value":2828}," x",{"type":173,"tag":211,"props":2830,"children":2831},{"style":464},[2832],{"type":179,"value":1375},{"type":173,"tag":211,"props":2834,"children":2835},{"style":228},[2836],{"type":179,"value":1970},{"type":173,"tag":211,"props":2838,"children":2839},{"style":277},[2840],{"type":179,"value":2841},")) ",{"type":173,"tag":211,"props":2843,"children":2844},{"style":234},[2845],{"type":179,"value":1173},{"type":173,"tag":211,"props":2847,"children":2848},{"class":213,"line":682},[2849,2854,2858,2862,2866,2870],{"type":173,"tag":211,"props":2850,"children":2851},{"style":571},[2852],{"type":179,"value":2853},"      this",{"type":173,"tag":211,"props":2855,"children":2856},{"style":234},[2857],{"type":179,"value":237},{"type":173,"tag":211,"props":2859,"children":2860},{"style":240},[2861],{"type":179,"value":1738},{"type":173,"tag":211,"props":2863,"children":2864},{"style":277},[2865],{"type":179,"value":248},{"type":173,"tag":211,"props":2867,"children":2868},{"style":228},[2869],{"type":179,"value":628},{"type":173,"tag":211,"props":2871,"children":2872},{"style":277},[2873],{"type":179,"value":300},{"type":173,"tag":211,"props":2875,"children":2876},{"class":213,"line":691},[2877],{"type":173,"tag":211,"props":2878,"children":2879},{"style":234},[2880],{"type":179,"value":1464},{"type":173,"tag":211,"props":2882,"children":2883},{"class":213,"line":726},[2884],{"type":173,"tag":211,"props":2885,"children":2886},{"style":234},[2887],{"type":179,"value":601},{"type":173,"tag":211,"props":2889,"children":2890},{"class":213,"line":790},[2891,2895,2899,2903,2907,2911,2915],{"type":173,"tag":211,"props":2892,"children":2893},{"style":615},[2894],{"type":179,"value":697},{"type":173,"tag":211,"props":2896,"children":2897},{"style":234},[2898],{"type":179,"value":623},{"type":173,"tag":211,"props":2900,"children":2901},{"style":350},[2902],{"type":179,"value":706},{"type":173,"tag":211,"props":2904,"children":2905},{"style":234},[2906],{"type":179,"value":269},{"type":173,"tag":211,"props":2908,"children":2909},{"style":350},[2910],{"type":179,"value":715},{"type":173,"tag":211,"props":2912,"children":2913},{"style":234},[2914],{"type":179,"value":633},{"type":173,"tag":211,"props":2916,"children":2917},{"style":234},[2918],{"type":179,"value":2004},{"type":173,"tag":211,"props":2920,"children":2921},{"class":213,"line":798},[2922],{"type":173,"tag":211,"props":2923,"children":2924},{"style":234},[2925],{"type":179,"value":804},{"type":173,"tag":211,"props":2927,"children":2928},{"class":213,"line":1026},[2929],{"type":173,"tag":211,"props":2930,"children":2931},{"emptyLinePlaceholder":165},[2932],{"type":179,"value":2933},"\n",{"type":173,"tag":211,"props":2935,"children":2936},{"class":213,"line":1051},[2937,2941,2945,2949],{"type":173,"tag":211,"props":2938,"children":2939},{"style":356},[2940],{"type":179,"value":2639},{"type":173,"tag":211,"props":2942,"children":2943},{"style":228},[2944],{"type":179,"value":2145},{"type":173,"tag":211,"props":2946,"children":2947},{"style":464},[2948],{"type":179,"value":467},{"type":173,"tag":211,"props":2950,"children":2951},{"style":1930},[2952],{"type":179,"value":2154},{"type":173,"tag":211,"props":2954,"children":2955},{"class":213,"line":1069},[2956,2960,2964],{"type":173,"tag":211,"props":2957,"children":2958},{"style":356},[2959],{"type":179,"value":538},{"type":173,"tag":211,"props":2961,"children":2962},{"style":541},[2963],{"type":179,"value":1870},{"type":173,"tag":211,"props":2965,"children":2966},{"style":234},[2967],{"type":179,"value":364},{"type":173,"tag":211,"props":2969,"children":2970},{"class":213,"line":1077},[2971,2975,2979,2983,2987,2991,2995,2999,3003,3007,3011,3015,3019],{"type":173,"tag":211,"props":2972,"children":2973},{"style":615},[2974],{"type":179,"value":1952},{"type":173,"tag":211,"props":2976,"children":2977},{"style":234},[2978],{"type":179,"value":623},{"type":173,"tag":211,"props":2980,"children":2981},{"style":350},[2982],{"type":179,"value":1961},{"type":173,"tag":211,"props":2984,"children":2985},{"style":234},[2986],{"type":179,"value":269},{"type":173,"tag":211,"props":2988,"children":2989},{"style":350},[2990],{"type":179,"value":1970},{"type":173,"tag":211,"props":2992,"children":2993},{"style":234},[2994],{"type":179,"value":269},{"type":173,"tag":211,"props":2996,"children":2997},{"style":350},[2998],{"type":179,"value":1979},{"type":173,"tag":211,"props":3000,"children":3001},{"style":464},[3002],{"type":179,"value":588},{"type":173,"tag":211,"props":3004,"children":3005},{"style":571},[3006],{"type":179,"value":1159},{"type":173,"tag":211,"props":3008,"children":3009},{"style":234},[3010],{"type":179,"value":237},{"type":173,"tag":211,"props":3012,"children":3013},{"style":228},[3014],{"type":179,"value":1905},{"type":173,"tag":211,"props":3016,"children":3017},{"style":234},[3018],{"type":179,"value":633},{"type":173,"tag":211,"props":3020,"children":3021},{"style":234},[3022],{"type":179,"value":364},{"type":173,"tag":211,"props":3024,"children":3025},{"class":213,"line":1086},[3026,3031,3035],{"type":173,"tag":211,"props":3027,"children":3028},{"style":228},[3029],{"type":179,"value":3030},"    handleFn",{"type":173,"tag":211,"props":3032,"children":3033},{"style":464},[3034],{"type":179,"value":588},{"type":173,"tag":211,"props":3036,"children":3037},{"style":228},[3038],{"type":179,"value":3039}," fn\n",{"type":173,"tag":211,"props":3041,"children":3042},{"class":213,"line":2564},[3043,3048,3052,3056,3060,3064,3068,3072],{"type":173,"tag":211,"props":3044,"children":3045},{"style":228},[3046],{"type":179,"value":3047},"    console",{"type":173,"tag":211,"props":3049,"children":3050},{"style":234},[3051],{"type":179,"value":237},{"type":173,"tag":211,"props":3053,"children":3054},{"style":240},[3055],{"type":179,"value":382},{"type":173,"tag":211,"props":3057,"children":3058},{"style":277},[3059],{"type":179,"value":248},{"type":173,"tag":211,"props":3061,"children":3062},{"style":228},[3063],{"type":179,"value":1230},{"type":173,"tag":211,"props":3065,"children":3066},{"style":234},[3067],{"type":179,"value":237},{"type":173,"tag":211,"props":3069,"children":3070},{"style":228},[3071],{"type":179,"value":1961},{"type":173,"tag":211,"props":3073,"children":3074},{"style":277},[3075],{"type":179,"value":300},{"type":173,"tag":211,"props":3077,"children":3078},{"class":213,"line":2577},[3079],{"type":173,"tag":211,"props":3080,"children":3081},{"style":234},[3082],{"type":179,"value":601},{"type":173,"tag":211,"props":3084,"children":3085},{"class":213,"line":2585},[3086,3090,3094,3098,3102,3106,3110,3114,3118,3122,3126,3130,3134,3138,3142,3146],{"type":173,"tag":211,"props":3087,"children":3088},{"style":615},[3089],{"type":179,"value":1032},{"type":173,"tag":211,"props":3091,"children":3092},{"style":234},[3093],{"type":179,"value":623},{"type":173,"tag":211,"props":3095,"children":3096},{"style":350},[3097],{"type":179,"value":1961},{"type":173,"tag":211,"props":3099,"children":3100},{"style":234},[3101],{"type":179,"value":269},{"type":173,"tag":211,"props":3103,"children":3104},{"style":350},[3105],{"type":179,"value":280},{"type":173,"tag":211,"props":3107,"children":3108},{"style":234},[3109],{"type":179,"value":269},{"type":173,"tag":211,"props":3111,"children":3112},{"style":350},[3113],{"type":179,"value":2036},{"type":173,"tag":211,"props":3115,"children":3116},{"style":464},[3117],{"type":179,"value":588},{"type":173,"tag":211,"props":3119,"children":3120},{"style":234},[3121],{"type":179,"value":1145},{"type":173,"tag":211,"props":3123,"children":3124},{"style":350},[3125],{"type":179,"value":1979},{"type":173,"tag":211,"props":3127,"children":3128},{"style":464},[3129],{"type":179,"value":588},{"type":173,"tag":211,"props":3131,"children":3132},{"style":571},[3133],{"type":179,"value":1159},{"type":173,"tag":211,"props":3135,"children":3136},{"style":234},[3137],{"type":179,"value":237},{"type":173,"tag":211,"props":3139,"children":3140},{"style":228},[3141],{"type":179,"value":1905},{"type":173,"tag":211,"props":3143,"children":3144},{"style":234},[3145],{"type":179,"value":633},{"type":173,"tag":211,"props":3147,"children":3148},{"style":234},[3149],{"type":179,"value":364},{"type":173,"tag":211,"props":3151,"children":3153},{"class":213,"line":3152},21,[3154,3159,3163,3167,3171,3175],{"type":173,"tag":211,"props":3155,"children":3156},{"style":356},[3157],{"type":179,"value":3158},"    const",{"type":173,"tag":211,"props":3160,"children":3161},{"style":1184},[3162],{"type":179,"value":1187},{"type":173,"tag":211,"props":3164,"children":3165},{"style":464},[3166],{"type":179,"value":588},{"type":173,"tag":211,"props":3168,"children":3169},{"style":464},[3170],{"type":179,"value":1196},{"type":173,"tag":211,"props":3172,"children":3173},{"style":240},[3174],{"type":179,"value":544},{"type":173,"tag":211,"props":3176,"children":3177},{"style":277},[3178],{"type":179,"value":1205},{"type":173,"tag":211,"props":3180,"children":3182},{"class":213,"line":3181},22,[3183,3188,3192,3196,3200,3204,3208,3212,3216],{"type":173,"tag":211,"props":3184,"children":3185},{"style":228},[3186],{"type":179,"value":3187},"    Object",{"type":173,"tag":211,"props":3189,"children":3190},{"style":234},[3191],{"type":179,"value":237},{"type":173,"tag":211,"props":3193,"children":3194},{"style":240},[3195],{"type":179,"value":829},{"type":173,"tag":211,"props":3197,"children":3198},{"style":277},[3199],{"type":179,"value":248},{"type":173,"tag":211,"props":3201,"children":3202},{"style":228},[3203],{"type":179,"value":1230},{"type":173,"tag":211,"props":3205,"children":3206},{"style":234},[3207],{"type":179,"value":269},{"type":173,"tag":211,"props":3209,"children":3210},{"style":228},[3211],{"type":179,"value":894},{"type":173,"tag":211,"props":3213,"children":3214},{"style":234},[3215],{"type":179,"value":269},{"type":173,"tag":211,"props":3217,"children":3218},{"style":234},[3219],{"type":179,"value":364},{"type":173,"tag":211,"props":3221,"children":3223},{"class":213,"line":3222},23,[3224,3229,3233,3237],{"type":173,"tag":211,"props":3225,"children":3226},{"style":277},[3227],{"type":179,"value":3228},"      enumerable",{"type":173,"tag":211,"props":3230,"children":3231},{"style":234},[3232],{"type":179,"value":285},{"type":173,"tag":211,"props":3234,"children":3235},{"style":925},[3236],{"type":179,"value":928},{"type":173,"tag":211,"props":3238,"children":3239},{"style":234},[3240],{"type":179,"value":933},{"type":173,"tag":211,"props":3242,"children":3244},{"class":213,"line":3243},24,[3245,3250,3254,3258],{"type":173,"tag":211,"props":3246,"children":3247},{"style":277},[3248],{"type":179,"value":3249},"      configurable",{"type":173,"tag":211,"props":3251,"children":3252},{"style":234},[3253],{"type":179,"value":285},{"type":173,"tag":211,"props":3255,"children":3256},{"style":925},[3257],{"type":179,"value":928},{"type":173,"tag":211,"props":3259,"children":3260},{"style":234},[3261],{"type":179,"value":933},{"type":173,"tag":211,"props":3263,"children":3265},{"class":213,"line":3264},25,[3266,3271,3275,3279,3283],{"type":173,"tag":211,"props":3267,"children":3268},{"style":240},[3269],{"type":179,"value":3270},"      get",{"type":173,"tag":211,"props":3272,"children":3273},{"style":234},[3274],{"type":179,"value":285},{"type":173,"tag":211,"props":3276,"children":3277},{"style":234},[3278],{"type":179,"value":561},{"type":173,"tag":211,"props":3280,"children":3281},{"style":356},[3282],{"type":179,"value":359},{"type":173,"tag":211,"props":3284,"children":3285},{"style":234},[3286],{"type":179,"value":364},{"type":173,"tag":211,"props":3288,"children":3290},{"class":213,"line":3289},26,[3291,3296,3300],{"type":173,"tag":211,"props":3292,"children":3293},{"style":228},[3294],{"type":179,"value":3295},"        handleDep",{"type":173,"tag":211,"props":3297,"children":3298},{"style":464},[3299],{"type":179,"value":588},{"type":173,"tag":211,"props":3301,"children":3302},{"style":228},[3303],{"type":179,"value":1648},{"type":173,"tag":211,"props":3305,"children":3307},{"class":213,"line":3306},27,[3308,3312,3316,3320],{"type":173,"tag":211,"props":3309,"children":3310},{"style":228},[3311],{"type":179,"value":3295},{"type":173,"tag":211,"props":3313,"children":3314},{"style":234},[3315],{"type":179,"value":237},{"type":173,"tag":211,"props":3317,"children":3318},{"style":240},[3319],{"type":179,"value":2614},{"type":173,"tag":211,"props":3321,"children":3322},{"style":277},[3323],{"type":179,"value":1205},{"type":173,"tag":211,"props":3325,"children":3327},{"class":213,"line":3326},28,[3328,3333],{"type":173,"tag":211,"props":3329,"children":3330},{"style":999},[3331],{"type":179,"value":3332},"        return",{"type":173,"tag":211,"props":3334,"children":3335},{"style":228},[3336],{"type":179,"value":1007},{"type":173,"tag":211,"props":3338,"children":3340},{"class":213,"line":3339},29,[3341],{"type":173,"tag":211,"props":3342,"children":3343},{"style":234},[3344],{"type":179,"value":3345},"      },\n",{"type":173,"tag":211,"props":3347,"children":3349},{"class":213,"line":3348},30,[3350,3355,3359,3363,3367],{"type":173,"tag":211,"props":3351,"children":3352},{"style":240},[3353],{"type":179,"value":3354},"      set",{"type":173,"tag":211,"props":3356,"children":3357},{"style":234},[3358],{"type":179,"value":285},{"type":173,"tag":211,"props":3360,"children":3361},{"style":350},[3362],{"type":179,"value":353},{"type":173,"tag":211,"props":3364,"children":3365},{"style":356},[3366],{"type":179,"value":359},{"type":173,"tag":211,"props":3368,"children":3369},{"style":234},[3370],{"type":179,"value":2004},{"type":173,"tag":211,"props":3372,"children":3374},{"class":213,"line":3373},31,[3375,3380],{"type":173,"tag":211,"props":3376,"children":3377},{"style":234},[3378],{"type":179,"value":3379},"    }",{"type":173,"tag":211,"props":3381,"children":3382},{"style":277},[3383],{"type":179,"value":300},{"type":173,"tag":211,"props":3385,"children":3387},{"class":213,"line":3386},32,[3388],{"type":173,"tag":211,"props":3389,"children":3390},{"style":234},[3391],{"type":179,"value":601},{"type":173,"tag":211,"props":3393,"children":3395},{"class":213,"line":3394},33,[3396],{"type":173,"tag":211,"props":3397,"children":3398},{"style":234},[3399],{"type":179,"value":804},{"type":173,"tag":174,"props":3401,"children":3403},{"id":3402},"处理-key-值为对象链的情况",[3404],{"type":179,"value":3405},"处理 key 值为对象链的情况",{"type":173,"tag":181,"props":3407,"children":3408},{},[3409,3411,3417],{"type":179,"value":3410},"在先前的 watch 函数中, 我们使用 console.log(obj.key)去触发对应属性的 getter, 如果我们调用方式是",{"type":173,"tag":187,"props":3412,"children":3414},{"className":3413},[],[3415],{"type":179,"value":3416},"watch('a.b.c')",{"type":179,"value":3418},"就无能为力了. 这里我们封装一个通用方法, 用于处理对象链字符串的形式:",{"type":173,"tag":201,"props":3420,"children":3422},{"className":203,"code":3421,"language":205,"meta":166,"style":166},"// 通过将字符串'a.b'分割为['a', 'b'], 再使用一个while循环就可以走完这个对象链\nfunction walkChains (key, obj) {\n  const segments = key.split('.')\n  let deepObj = obj\n  while (segments.length) {\n    deepObj = deepObj[segments.shift()]\n  }\n}\nclass VX {\n  watch (key, fn, obj = this.store) {\n    handleFn = fn\n    walkChains(key, obj)\n  }\n}\n",[3423],{"type":173,"tag":187,"props":3424,"children":3425},{"__ignoreMap":166},[3426,3434,3471,3520,3541,3575,3614,3621,3628,3643,3698,3713,3741,3748],{"type":173,"tag":211,"props":3427,"children":3428},{"class":213,"line":214},[3429],{"type":173,"tag":211,"props":3430,"children":3431},{"style":218},[3432],{"type":179,"value":3433},"// 通过将字符串'a.b'分割为['a', 'b'], 再使用一个while循环就可以走完这个对象链\n",{"type":173,"tag":211,"props":3435,"children":3436},{"class":213,"line":224},[3437,3442,3447,3451,3455,3459,3463,3467],{"type":173,"tag":211,"props":3438,"children":3439},{"style":356},[3440],{"type":179,"value":3441},"function",{"type":173,"tag":211,"props":3443,"children":3444},{"style":240},[3445],{"type":179,"value":3446}," walkChains",{"type":173,"tag":211,"props":3448,"children":3449},{"style":234},[3450],{"type":179,"value":623},{"type":173,"tag":211,"props":3452,"children":3453},{"style":350},[3454],{"type":179,"value":1961},{"type":173,"tag":211,"props":3456,"children":3457},{"style":234},[3458],{"type":179,"value":269},{"type":173,"tag":211,"props":3460,"children":3461},{"style":350},[3462],{"type":179,"value":1979},{"type":173,"tag":211,"props":3464,"children":3465},{"style":234},[3466],{"type":179,"value":633},{"type":173,"tag":211,"props":3468,"children":3469},{"style":234},[3470],{"type":179,"value":364},{"type":173,"tag":211,"props":3472,"children":3473},{"class":213,"line":303},[3474,3478,3483,3487,3491,3495,3500,3504,3508,3512,3516],{"type":173,"tag":211,"props":3475,"children":3476},{"style":356},[3477],{"type":179,"value":1181},{"type":173,"tag":211,"props":3479,"children":3480},{"style":1184},[3481],{"type":179,"value":3482}," segments",{"type":173,"tag":211,"props":3484,"children":3485},{"style":464},[3486],{"type":179,"value":588},{"type":173,"tag":211,"props":3488,"children":3489},{"style":228},[3490],{"type":179,"value":894},{"type":173,"tag":211,"props":3492,"children":3493},{"style":234},[3494],{"type":179,"value":237},{"type":173,"tag":211,"props":3496,"children":3497},{"style":240},[3498],{"type":179,"value":3499},"split",{"type":173,"tag":211,"props":3501,"children":3502},{"style":277},[3503],{"type":179,"value":248},{"type":173,"tag":211,"props":3505,"children":3506},{"style":251},[3507],{"type":179,"value":254},{"type":173,"tag":211,"props":3509,"children":3510},{"style":257},[3511],{"type":179,"value":237},{"type":173,"tag":211,"props":3513,"children":3514},{"style":251},[3515],{"type":179,"value":254},{"type":173,"tag":211,"props":3517,"children":3518},{"style":277},[3519],{"type":179,"value":300},{"type":173,"tag":211,"props":3521,"children":3522},{"class":213,"line":312},[3523,3527,3532,3536],{"type":173,"tag":211,"props":3524,"children":3525},{"style":356},[3526],{"type":179,"value":2140},{"type":173,"tag":211,"props":3528,"children":3529},{"style":228},[3530],{"type":179,"value":3531}," deepObj",{"type":173,"tag":211,"props":3533,"children":3534},{"style":464},[3535],{"type":179,"value":588},{"type":173,"tag":211,"props":3537,"children":3538},{"style":228},[3539],{"type":179,"value":3540}," obj\n",{"type":173,"tag":211,"props":3542,"children":3543},{"class":213,"line":367},[3544,3549,3553,3558,3562,3567,3571],{"type":173,"tag":211,"props":3545,"children":3546},{"style":999},[3547],{"type":179,"value":3548},"  while",{"type":173,"tag":211,"props":3550,"children":3551},{"style":277},[3552],{"type":179,"value":623},{"type":173,"tag":211,"props":3554,"children":3555},{"style":228},[3556],{"type":179,"value":3557},"segments",{"type":173,"tag":211,"props":3559,"children":3560},{"style":234},[3561],{"type":179,"value":237},{"type":173,"tag":211,"props":3563,"children":3564},{"style":1184},[3565],{"type":179,"value":3566},"length",{"type":173,"tag":211,"props":3568,"children":3569},{"style":277},[3570],{"type":179,"value":1384},{"type":173,"tag":211,"props":3572,"children":3573},{"style":234},[3574],{"type":179,"value":1173},{"type":173,"tag":211,"props":3576,"children":3577},{"class":213,"line":415},[3578,3583,3587,3591,3596,3600,3604,3609],{"type":173,"tag":211,"props":3579,"children":3580},{"style":228},[3581],{"type":179,"value":3582},"    deepObj",{"type":173,"tag":211,"props":3584,"children":3585},{"style":464},[3586],{"type":179,"value":588},{"type":173,"tag":211,"props":3588,"children":3589},{"style":228},[3590],{"type":179,"value":3531},{"type":173,"tag":211,"props":3592,"children":3593},{"style":277},[3594],{"type":179,"value":3595},"[",{"type":173,"tag":211,"props":3597,"children":3598},{"style":228},[3599],{"type":179,"value":3557},{"type":173,"tag":211,"props":3601,"children":3602},{"style":234},[3603],{"type":179,"value":237},{"type":173,"tag":211,"props":3605,"children":3606},{"style":240},[3607],{"type":179,"value":3608},"shift",{"type":173,"tag":211,"props":3610,"children":3611},{"style":277},[3612],{"type":179,"value":3613},"()]\n",{"type":173,"tag":211,"props":3615,"children":3616},{"class":213,"line":428},[3617],{"type":173,"tag":211,"props":3618,"children":3619},{"style":234},[3620],{"type":179,"value":601},{"type":173,"tag":211,"props":3622,"children":3623},{"class":213,"line":682},[3624],{"type":173,"tag":211,"props":3625,"children":3626},{"style":234},[3627],{"type":179,"value":804},{"type":173,"tag":211,"props":3629,"children":3630},{"class":213,"line":691},[3631,3635,3639],{"type":173,"tag":211,"props":3632,"children":3633},{"style":356},[3634],{"type":179,"value":538},{"type":173,"tag":211,"props":3636,"children":3637},{"style":541},[3638],{"type":179,"value":1870},{"type":173,"tag":211,"props":3640,"children":3641},{"style":234},[3642],{"type":179,"value":364},{"type":173,"tag":211,"props":3644,"children":3645},{"class":213,"line":726},[3646,3650,3654,3658,3662,3666,3670,3674,3678,3682,3686,3690,3694],{"type":173,"tag":211,"props":3647,"children":3648},{"style":615},[3649],{"type":179,"value":1952},{"type":173,"tag":211,"props":3651,"children":3652},{"style":234},[3653],{"type":179,"value":623},{"type":173,"tag":211,"props":3655,"children":3656},{"style":350},[3657],{"type":179,"value":1961},{"type":173,"tag":211,"props":3659,"children":3660},{"style":234},[3661],{"type":179,"value":269},{"type":173,"tag":211,"props":3663,"children":3664},{"style":350},[3665],{"type":179,"value":1970},{"type":173,"tag":211,"props":3667,"children":3668},{"style":234},[3669],{"type":179,"value":269},{"type":173,"tag":211,"props":3671,"children":3672},{"style":350},[3673],{"type":179,"value":1979},{"type":173,"tag":211,"props":3675,"children":3676},{"style":464},[3677],{"type":179,"value":588},{"type":173,"tag":211,"props":3679,"children":3680},{"style":571},[3681],{"type":179,"value":1159},{"type":173,"tag":211,"props":3683,"children":3684},{"style":234},[3685],{"type":179,"value":237},{"type":173,"tag":211,"props":3687,"children":3688},{"style":228},[3689],{"type":179,"value":1905},{"type":173,"tag":211,"props":3691,"children":3692},{"style":234},[3693],{"type":179,"value":633},{"type":173,"tag":211,"props":3695,"children":3696},{"style":234},[3697],{"type":179,"value":364},{"type":173,"tag":211,"props":3699,"children":3700},{"class":213,"line":790},[3701,3705,3709],{"type":173,"tag":211,"props":3702,"children":3703},{"style":228},[3704],{"type":179,"value":3030},{"type":173,"tag":211,"props":3706,"children":3707},{"style":464},[3708],{"type":179,"value":588},{"type":173,"tag":211,"props":3710,"children":3711},{"style":228},[3712],{"type":179,"value":3039},{"type":173,"tag":211,"props":3714,"children":3715},{"class":213,"line":798},[3716,3721,3725,3729,3733,3737],{"type":173,"tag":211,"props":3717,"children":3718},{"style":240},[3719],{"type":179,"value":3720},"    walkChains",{"type":173,"tag":211,"props":3722,"children":3723},{"style":277},[3724],{"type":179,"value":248},{"type":173,"tag":211,"props":3726,"children":3727},{"style":228},[3728],{"type":179,"value":1961},{"type":173,"tag":211,"props":3730,"children":3731},{"style":234},[3732],{"type":179,"value":269},{"type":173,"tag":211,"props":3734,"children":3735},{"style":228},[3736],{"type":179,"value":1979},{"type":173,"tag":211,"props":3738,"children":3739},{"style":277},[3740],{"type":179,"value":300},{"type":173,"tag":211,"props":3742,"children":3743},{"class":213,"line":1026},[3744],{"type":173,"tag":211,"props":3745,"children":3746},{"style":234},[3747],{"type":179,"value":601},{"type":173,"tag":211,"props":3749,"children":3750},{"class":213,"line":1051},[3751],{"type":173,"tag":211,"props":3752,"children":3753},{"style":234},[3754],{"type":179,"value":804},{"type":173,"tag":181,"props":3756,"children":3757},{},[3758,3760,3766],{"type":179,"value":3759},"在 set 方法中处理对象链字符串稍微有些不同, 因为如果",{"type":173,"tag":187,"props":3761,"children":3763},{"className":3762},[],[3764],{"type":179,"value":3765},"set('a.b')",{"type":179,"value":3767},"时, 没有在我们全局对象中找到 a 属性, 这里应该抛错.",{"type":173,"tag":181,"props":3769,"children":3770},{},[3771,3773,3779],{"type":179,"value":3772},"实际的处理中, 需要推断'obj.a'以及'obj.a.b'是否存在. 假设没有'obj.a', 那么我们应该创建一个新的对象, 并且给新的对象添加属性'b', 所以代码类似",{"type":173,"tag":187,"props":3774,"children":3776},{"className":3775},[],[3777],{"type":179,"value":3778},"walkChains",{"type":179,"value":3780},"函数, 只是稍作一层判断:",{"type":173,"tag":201,"props":3782,"children":3784},{"className":203,"code":3783,"language":205,"meta":166,"style":166},"set (key, val, obj) {\n  const segments = key.split('.')\n  // 这里需要注意, 我们只处理到倒数第二个属性\n  while (segments.length > 1) {\n    const handleKey = segments.shift()\n    const handleVal = obj[handleKey]\n    // 存在'obj.a'的情况\n    if (typeof handleVal === 'object') {\n      obj = handleVal\n    // 不存在'obj.a'则给a属性赋一个非响应式的对象\n    } else if (!handleVal) {\n      obj = (\n        key = handleKey,\n        obj[handleKey] = {},\n        obj[handleKey]\n      )\n    } else {\n      console.trace('already has val')\n    }\n  }\n  // 最后一个属性要手动赋值\n  key = segments[0]\n}\n",[3785],{"type":173,"tag":187,"props":3786,"children":3787},{"__ignoreMap":166},[3788,3820,3867,3875,3916,3948,3982,3990,4036,4053,4061,4100,4116,4136,4166,4185,4193,4208,4245,4252,4259,4267,4296],{"type":173,"tag":211,"props":3789,"children":3790},{"class":213,"line":214},[3791,3795,3799,3803,3807,3811,3816],{"type":173,"tag":211,"props":3792,"children":3793},{"style":240},[3794],{"type":179,"value":243},{"type":173,"tag":211,"props":3796,"children":3797},{"style":228},[3798],{"type":179,"value":1119},{"type":173,"tag":211,"props":3800,"children":3801},{"style":234},[3802],{"type":179,"value":269},{"type":173,"tag":211,"props":3804,"children":3805},{"style":228},[3806],{"type":179,"value":280},{"type":173,"tag":211,"props":3808,"children":3809},{"style":234},[3810],{"type":179,"value":269},{"type":173,"tag":211,"props":3812,"children":3813},{"style":228},[3814],{"type":179,"value":3815}," obj) ",{"type":173,"tag":211,"props":3817,"children":3818},{"style":234},[3819],{"type":179,"value":1173},{"type":173,"tag":211,"props":3821,"children":3822},{"class":213,"line":224},[3823,3827,3831,3835,3839,3843,3847,3851,3855,3859,3863],{"type":173,"tag":211,"props":3824,"children":3825},{"style":356},[3826],{"type":179,"value":1181},{"type":173,"tag":211,"props":3828,"children":3829},{"style":1184},[3830],{"type":179,"value":3482},{"type":173,"tag":211,"props":3832,"children":3833},{"style":464},[3834],{"type":179,"value":588},{"type":173,"tag":211,"props":3836,"children":3837},{"style":228},[3838],{"type":179,"value":894},{"type":173,"tag":211,"props":3840,"children":3841},{"style":234},[3842],{"type":179,"value":237},{"type":173,"tag":211,"props":3844,"children":3845},{"style":240},[3846],{"type":179,"value":3499},{"type":173,"tag":211,"props":3848,"children":3849},{"style":277},[3850],{"type":179,"value":248},{"type":173,"tag":211,"props":3852,"children":3853},{"style":251},[3854],{"type":179,"value":254},{"type":173,"tag":211,"props":3856,"children":3857},{"style":257},[3858],{"type":179,"value":237},{"type":173,"tag":211,"props":3860,"children":3861},{"style":251},[3862],{"type":179,"value":254},{"type":173,"tag":211,"props":3864,"children":3865},{"style":277},[3866],{"type":179,"value":300},{"type":173,"tag":211,"props":3868,"children":3869},{"class":213,"line":303},[3870],{"type":173,"tag":211,"props":3871,"children":3872},{"style":218},[3873],{"type":179,"value":3874},"  // 这里需要注意, 我们只处理到倒数第二个属性\n",{"type":173,"tag":211,"props":3876,"children":3877},{"class":213,"line":312},[3878,3882,3886,3890,3894,3898,3903,3908,3912],{"type":173,"tag":211,"props":3879,"children":3880},{"style":999},[3881],{"type":179,"value":3548},{"type":173,"tag":211,"props":3883,"children":3884},{"style":277},[3885],{"type":179,"value":623},{"type":173,"tag":211,"props":3887,"children":3888},{"style":228},[3889],{"type":179,"value":3557},{"type":173,"tag":211,"props":3891,"children":3892},{"style":234},[3893],{"type":179,"value":237},{"type":173,"tag":211,"props":3895,"children":3896},{"style":1184},[3897],{"type":179,"value":3566},{"type":173,"tag":211,"props":3899,"children":3900},{"style":464},[3901],{"type":179,"value":3902}," >",{"type":173,"tag":211,"props":3904,"children":3905},{"style":470},[3906],{"type":179,"value":3907}," 1",{"type":173,"tag":211,"props":3909,"children":3910},{"style":277},[3911],{"type":179,"value":1384},{"type":173,"tag":211,"props":3913,"children":3914},{"style":234},[3915],{"type":179,"value":1173},{"type":173,"tag":211,"props":3917,"children":3918},{"class":213,"line":367},[3919,3923,3928,3932,3936,3940,3944],{"type":173,"tag":211,"props":3920,"children":3921},{"style":356},[3922],{"type":179,"value":3158},{"type":173,"tag":211,"props":3924,"children":3925},{"style":1184},[3926],{"type":179,"value":3927}," handleKey",{"type":173,"tag":211,"props":3929,"children":3930},{"style":464},[3931],{"type":179,"value":588},{"type":173,"tag":211,"props":3933,"children":3934},{"style":228},[3935],{"type":179,"value":3482},{"type":173,"tag":211,"props":3937,"children":3938},{"style":234},[3939],{"type":179,"value":237},{"type":173,"tag":211,"props":3941,"children":3942},{"style":240},[3943],{"type":179,"value":3608},{"type":173,"tag":211,"props":3945,"children":3946},{"style":277},[3947],{"type":179,"value":1205},{"type":173,"tag":211,"props":3949,"children":3950},{"class":213,"line":415},[3951,3955,3960,3964,3968,3972,3977],{"type":173,"tag":211,"props":3952,"children":3953},{"style":356},[3954],{"type":179,"value":3158},{"type":173,"tag":211,"props":3956,"children":3957},{"style":1184},[3958],{"type":179,"value":3959}," handleVal",{"type":173,"tag":211,"props":3961,"children":3962},{"style":464},[3963],{"type":179,"value":588},{"type":173,"tag":211,"props":3965,"children":3966},{"style":228},[3967],{"type":179,"value":1979},{"type":173,"tag":211,"props":3969,"children":3970},{"style":277},[3971],{"type":179,"value":3595},{"type":173,"tag":211,"props":3973,"children":3974},{"style":228},[3975],{"type":179,"value":3976},"handleKey",{"type":173,"tag":211,"props":3978,"children":3979},{"style":277},[3980],{"type":179,"value":3981},"]\n",{"type":173,"tag":211,"props":3983,"children":3984},{"class":213,"line":428},[3985],{"type":173,"tag":211,"props":3986,"children":3987},{"style":218},[3988],{"type":179,"value":3989},"    // 存在'obj.a'的情况\n",{"type":173,"tag":211,"props":3991,"children":3992},{"class":213,"line":682},[3993,3997,4001,4006,4010,4014,4019,4024,4028,4032],{"type":173,"tag":211,"props":3994,"children":3995},{"style":999},[3996],{"type":179,"value":2770},{"type":173,"tag":211,"props":3998,"children":3999},{"style":277},[4000],{"type":179,"value":623},{"type":173,"tag":211,"props":4002,"children":4003},{"style":464},[4004],{"type":179,"value":4005},"typeof",{"type":173,"tag":211,"props":4007,"children":4008},{"style":228},[4009],{"type":179,"value":3959},{"type":173,"tag":211,"props":4011,"children":4012},{"style":464},[4013],{"type":179,"value":1375},{"type":173,"tag":211,"props":4015,"children":4016},{"style":251},[4017],{"type":179,"value":4018}," '",{"type":173,"tag":211,"props":4020,"children":4021},{"style":257},[4022],{"type":179,"value":4023},"object",{"type":173,"tag":211,"props":4025,"children":4026},{"style":251},[4027],{"type":179,"value":254},{"type":173,"tag":211,"props":4029,"children":4030},{"style":277},[4031],{"type":179,"value":1384},{"type":173,"tag":211,"props":4033,"children":4034},{"style":234},[4035],{"type":179,"value":1173},{"type":173,"tag":211,"props":4037,"children":4038},{"class":213,"line":691},[4039,4044,4048],{"type":173,"tag":211,"props":4040,"children":4041},{"style":228},[4042],{"type":179,"value":4043},"      obj",{"type":173,"tag":211,"props":4045,"children":4046},{"style":464},[4047],{"type":179,"value":588},{"type":173,"tag":211,"props":4049,"children":4050},{"style":228},[4051],{"type":179,"value":4052}," handleVal\n",{"type":173,"tag":211,"props":4054,"children":4055},{"class":213,"line":726},[4056],{"type":173,"tag":211,"props":4057,"children":4058},{"style":218},[4059],{"type":179,"value":4060},"    // 不存在'obj.a'则给a属性赋一个非响应式的对象\n",{"type":173,"tag":211,"props":4062,"children":4063},{"class":213,"line":790},[4064,4068,4073,4078,4082,4087,4092,4096],{"type":173,"tag":211,"props":4065,"children":4066},{"style":234},[4067],{"type":179,"value":3379},{"type":173,"tag":211,"props":4069,"children":4070},{"style":999},[4071],{"type":179,"value":4072}," else",{"type":173,"tag":211,"props":4074,"children":4075},{"style":999},[4076],{"type":179,"value":4077}," if",{"type":173,"tag":211,"props":4079,"children":4080},{"style":277},[4081],{"type":179,"value":623},{"type":173,"tag":211,"props":4083,"children":4084},{"style":464},[4085],{"type":179,"value":4086},"!",{"type":173,"tag":211,"props":4088,"children":4089},{"style":228},[4090],{"type":179,"value":4091},"handleVal",{"type":173,"tag":211,"props":4093,"children":4094},{"style":277},[4095],{"type":179,"value":1384},{"type":173,"tag":211,"props":4097,"children":4098},{"style":234},[4099],{"type":179,"value":1173},{"type":173,"tag":211,"props":4101,"children":4102},{"class":213,"line":798},[4103,4107,4111],{"type":173,"tag":211,"props":4104,"children":4105},{"style":240},[4106],{"type":179,"value":4043},{"type":173,"tag":211,"props":4108,"children":4109},{"style":464},[4110],{"type":179,"value":588},{"type":173,"tag":211,"props":4112,"children":4113},{"style":277},[4114],{"type":179,"value":4115}," (\n",{"type":173,"tag":211,"props":4117,"children":4118},{"class":213,"line":1026},[4119,4124,4128,4132],{"type":173,"tag":211,"props":4120,"children":4121},{"style":228},[4122],{"type":179,"value":4123},"        key",{"type":173,"tag":211,"props":4125,"children":4126},{"style":464},[4127],{"type":179,"value":588},{"type":173,"tag":211,"props":4129,"children":4130},{"style":350},[4131],{"type":179,"value":3927},{"type":173,"tag":211,"props":4133,"children":4134},{"style":234},[4135],{"type":179,"value":933},{"type":173,"tag":211,"props":4137,"children":4138},{"class":213,"line":1051},[4139,4144,4148,4152,4157,4161],{"type":173,"tag":211,"props":4140,"children":4141},{"style":228},[4142],{"type":179,"value":4143},"        obj",{"type":173,"tag":211,"props":4145,"children":4146},{"style":277},[4147],{"type":179,"value":3595},{"type":173,"tag":211,"props":4149,"children":4150},{"style":228},[4151],{"type":179,"value":3976},{"type":173,"tag":211,"props":4153,"children":4154},{"style":277},[4155],{"type":179,"value":4156},"] ",{"type":173,"tag":211,"props":4158,"children":4159},{"style":464},[4160],{"type":179,"value":467},{"type":173,"tag":211,"props":4162,"children":4163},{"style":234},[4164],{"type":179,"value":4165}," {},\n",{"type":173,"tag":211,"props":4167,"children":4168},{"class":213,"line":1069},[4169,4173,4177,4181],{"type":173,"tag":211,"props":4170,"children":4171},{"style":228},[4172],{"type":179,"value":4143},{"type":173,"tag":211,"props":4174,"children":4175},{"style":277},[4176],{"type":179,"value":3595},{"type":173,"tag":211,"props":4178,"children":4179},{"style":228},[4180],{"type":179,"value":3976},{"type":173,"tag":211,"props":4182,"children":4183},{"style":277},[4184],{"type":179,"value":3981},{"type":173,"tag":211,"props":4186,"children":4187},{"class":213,"line":1077},[4188],{"type":173,"tag":211,"props":4189,"children":4190},{"style":277},[4191],{"type":179,"value":4192},"      )\n",{"type":173,"tag":211,"props":4194,"children":4195},{"class":213,"line":1086},[4196,4200,4204],{"type":173,"tag":211,"props":4197,"children":4198},{"style":234},[4199],{"type":179,"value":3379},{"type":173,"tag":211,"props":4201,"children":4202},{"style":999},[4203],{"type":179,"value":4072},{"type":173,"tag":211,"props":4205,"children":4206},{"style":234},[4207],{"type":179,"value":364},{"type":173,"tag":211,"props":4209,"children":4210},{"class":213,"line":2564},[4211,4215,4219,4224,4228,4232,4237,4241],{"type":173,"tag":211,"props":4212,"children":4213},{"style":228},[4214],{"type":179,"value":2234},{"type":173,"tag":211,"props":4216,"children":4217},{"style":234},[4218],{"type":179,"value":237},{"type":173,"tag":211,"props":4220,"children":4221},{"style":240},[4222],{"type":179,"value":4223},"trace",{"type":173,"tag":211,"props":4225,"children":4226},{"style":277},[4227],{"type":179,"value":248},{"type":173,"tag":211,"props":4229,"children":4230},{"style":251},[4231],{"type":179,"value":254},{"type":173,"tag":211,"props":4233,"children":4234},{"style":257},[4235],{"type":179,"value":4236},"already has val",{"type":173,"tag":211,"props":4238,"children":4239},{"style":251},[4240],{"type":179,"value":254},{"type":173,"tag":211,"props":4242,"children":4243},{"style":277},[4244],{"type":179,"value":300},{"type":173,"tag":211,"props":4246,"children":4247},{"class":213,"line":2577},[4248],{"type":173,"tag":211,"props":4249,"children":4250},{"style":234},[4251],{"type":179,"value":1464},{"type":173,"tag":211,"props":4253,"children":4254},{"class":213,"line":2585},[4255],{"type":173,"tag":211,"props":4256,"children":4257},{"style":234},[4258],{"type":179,"value":601},{"type":173,"tag":211,"props":4260,"children":4261},{"class":213,"line":3152},[4262],{"type":173,"tag":211,"props":4263,"children":4264},{"style":218},[4265],{"type":179,"value":4266},"  // 最后一个属性要手动赋值\n",{"type":173,"tag":211,"props":4268,"children":4269},{"class":213,"line":3181},[4270,4275,4279,4283,4287,4292],{"type":173,"tag":211,"props":4271,"children":4272},{"style":228},[4273],{"type":179,"value":4274},"  key",{"type":173,"tag":211,"props":4276,"children":4277},{"style":464},[4278],{"type":179,"value":588},{"type":173,"tag":211,"props":4280,"children":4281},{"style":228},[4282],{"type":179,"value":3482},{"type":173,"tag":211,"props":4284,"children":4285},{"style":277},[4286],{"type":179,"value":3595},{"type":173,"tag":211,"props":4288,"children":4289},{"style":470},[4290],{"type":179,"value":4291},"0",{"type":173,"tag":211,"props":4293,"children":4294},{"style":277},[4295],{"type":179,"value":3981},{"type":173,"tag":211,"props":4297,"children":4298},{"class":213,"line":3222},[4299],{"type":173,"tag":211,"props":4300,"children":4301},{"style":234},[4302],{"type":179,"value":804},{"type":173,"tag":174,"props":4304,"children":4306},{"id":4305},"业务场景应用",[4307],{"type":179,"value":4305},{"type":173,"tag":824,"props":4309,"children":4311},{"id":4310},"小程序跨页面刷新数据",[4312],{"type":179,"value":4310},{"type":173,"tag":181,"props":4314,"children":4315},{},[4316],{"type":179,"value":4317},"我们经常碰到在小程序中由 A 页面跳转到 B 页面, 如果 B 页面进行了一些操作, 希望 A 页面自动刷新数据的情况. 但是由于 A 页面跳转到 B 页面不同(也许是 redirect,也许是 navigate), 处理方法也不尽相同.",{"type":173,"tag":181,"props":4319,"children":4320},{},[4321],{"type":179,"value":4322},"使用 navigate 方式跳转后, A 页面不会被注销, 所以我们一般会通过全局对象去贮存 A 页面实例(也就是 A 页面的 this 对象), 然后在 B 页面直接调用相应的方法(如 A.refreshList())进行刷新操作.",{"type":173,"tag":181,"props":4324,"children":4325},{},[4326,4328,4334],{"type":179,"value":4327},"引入 VX 后, 我们可以在",{"type":173,"tag":187,"props":4329,"children":4331},{"className":4330},[],[4332],{"type":179,"value":4333},"onload",{"type":179,"value":4335},"生命周期直接调用 watch 方法添加订阅:",{"type":173,"tag":201,"props":4337,"children":4339},{"className":203,"code":4338,"language":205,"meta":166,"style":166},"// app.js\nimport VX from '@/utils/suites/vx'\nconst vx = new VX()\napp.vx = vx\napp.store = vx.store\napp.vx.set('userType', '商户')\n\n// page a\nonLoad () {\n  app.vx.watch('userType', userType => {\n    if (userType === '商户') {\n      // ...\n    } else if (userType === '管理员') {\n      // ...\n    }\n  }, {\n    immediate: true\n  })\n}\n\n// page b\nswitchUserType () {\n  app.store.userType = '管理员'\n}\n",[4340],{"type":173,"tag":187,"props":4341,"children":4342},{"__ignoreMap":166},[4343,4351,4383,4410,4436,4469,4530,4537,4545,4562,4619,4658,4666,4714,4721,4728,4740,4757,4768,4775,4782,4790,4806,4845],{"type":173,"tag":211,"props":4344,"children":4345},{"class":213,"line":214},[4346],{"type":173,"tag":211,"props":4347,"children":4348},{"style":218},[4349],{"type":179,"value":4350},"// app.js\n",{"type":173,"tag":211,"props":4352,"children":4353},{"class":213,"line":224},[4354,4359,4364,4369,4373,4378],{"type":173,"tag":211,"props":4355,"children":4356},{"style":999},[4357],{"type":179,"value":4358},"import",{"type":173,"tag":211,"props":4360,"children":4361},{"style":228},[4362],{"type":179,"value":4363}," VX ",{"type":173,"tag":211,"props":4365,"children":4366},{"style":999},[4367],{"type":179,"value":4368},"from",{"type":173,"tag":211,"props":4370,"children":4371},{"style":251},[4372],{"type":179,"value":4018},{"type":173,"tag":211,"props":4374,"children":4375},{"style":257},[4376],{"type":179,"value":4377},"@/utils/suites/vx",{"type":173,"tag":211,"props":4379,"children":4380},{"style":251},[4381],{"type":179,"value":4382},"'\n",{"type":173,"tag":211,"props":4384,"children":4385},{"class":213,"line":303},[4386,4390,4394,4398,4402,4406],{"type":173,"tag":211,"props":4387,"children":4388},{"style":356},[4389],{"type":179,"value":1670},{"type":173,"tag":211,"props":4391,"children":4392},{"style":1184},[4393],{"type":179,"value":2091},{"type":173,"tag":211,"props":4395,"children":4396},{"style":464},[4397],{"type":179,"value":588},{"type":173,"tag":211,"props":4399,"children":4400},{"style":464},[4401],{"type":179,"value":1196},{"type":173,"tag":211,"props":4403,"children":4404},{"style":240},[4405],{"type":179,"value":1870},{"type":173,"tag":211,"props":4407,"children":4408},{"style":228},[4409],{"type":179,"value":1205},{"type":173,"tag":211,"props":4411,"children":4412},{"class":213,"line":312},[4413,4418,4422,4427,4431],{"type":173,"tag":211,"props":4414,"children":4415},{"style":228},[4416],{"type":179,"value":4417},"app",{"type":173,"tag":211,"props":4419,"children":4420},{"style":234},[4421],{"type":179,"value":237},{"type":173,"tag":211,"props":4423,"children":4424},{"style":228},[4425],{"type":179,"value":4426},"vx ",{"type":173,"tag":211,"props":4428,"children":4429},{"style":464},[4430],{"type":179,"value":467},{"type":173,"tag":211,"props":4432,"children":4433},{"style":228},[4434],{"type":179,"value":4435}," vx\n",{"type":173,"tag":211,"props":4437,"children":4438},{"class":213,"line":367},[4439,4443,4447,4452,4456,4460,4464],{"type":173,"tag":211,"props":4440,"children":4441},{"style":228},[4442],{"type":179,"value":4417},{"type":173,"tag":211,"props":4444,"children":4445},{"style":234},[4446],{"type":179,"value":237},{"type":173,"tag":211,"props":4448,"children":4449},{"style":228},[4450],{"type":179,"value":4451},"store ",{"type":173,"tag":211,"props":4453,"children":4454},{"style":464},[4455],{"type":179,"value":467},{"type":173,"tag":211,"props":4457,"children":4458},{"style":228},[4459],{"type":179,"value":2091},{"type":173,"tag":211,"props":4461,"children":4462},{"style":234},[4463],{"type":179,"value":237},{"type":173,"tag":211,"props":4465,"children":4466},{"style":228},[4467],{"type":179,"value":4468},"store\n",{"type":173,"tag":211,"props":4470,"children":4471},{"class":213,"line":415},[4472,4476,4480,4484,4488,4492,4496,4500,4505,4509,4513,4517,4522,4526],{"type":173,"tag":211,"props":4473,"children":4474},{"style":228},[4475],{"type":179,"value":4417},{"type":173,"tag":211,"props":4477,"children":4478},{"style":234},[4479],{"type":179,"value":237},{"type":173,"tag":211,"props":4481,"children":4482},{"style":228},[4483],{"type":179,"value":231},{"type":173,"tag":211,"props":4485,"children":4486},{"style":234},[4487],{"type":179,"value":237},{"type":173,"tag":211,"props":4489,"children":4490},{"style":240},[4491],{"type":179,"value":243},{"type":173,"tag":211,"props":4493,"children":4494},{"style":228},[4495],{"type":179,"value":248},{"type":173,"tag":211,"props":4497,"children":4498},{"style":251},[4499],{"type":179,"value":254},{"type":173,"tag":211,"props":4501,"children":4502},{"style":257},[4503],{"type":179,"value":4504},"userType",{"type":173,"tag":211,"props":4506,"children":4507},{"style":251},[4508],{"type":179,"value":254},{"type":173,"tag":211,"props":4510,"children":4511},{"style":234},[4512],{"type":179,"value":269},{"type":173,"tag":211,"props":4514,"children":4515},{"style":251},[4516],{"type":179,"value":4018},{"type":173,"tag":211,"props":4518,"children":4519},{"style":257},[4520],{"type":179,"value":4521},"商户",{"type":173,"tag":211,"props":4523,"children":4524},{"style":251},[4525],{"type":179,"value":254},{"type":173,"tag":211,"props":4527,"children":4528},{"style":228},[4529],{"type":179,"value":300},{"type":173,"tag":211,"props":4531,"children":4532},{"class":213,"line":428},[4533],{"type":173,"tag":211,"props":4534,"children":4535},{"emptyLinePlaceholder":165},[4536],{"type":179,"value":2933},{"type":173,"tag":211,"props":4538,"children":4539},{"class":213,"line":682},[4540],{"type":173,"tag":211,"props":4541,"children":4542},{"style":218},[4543],{"type":179,"value":4544},"// page a\n",{"type":173,"tag":211,"props":4546,"children":4547},{"class":213,"line":691},[4548,4553,4558],{"type":173,"tag":211,"props":4549,"children":4550},{"style":240},[4551],{"type":179,"value":4552},"onLoad",{"type":173,"tag":211,"props":4554,"children":4555},{"style":228},[4556],{"type":179,"value":4557}," () ",{"type":173,"tag":211,"props":4559,"children":4560},{"style":234},[4561],{"type":179,"value":1173},{"type":173,"tag":211,"props":4563,"children":4564},{"class":213,"line":726},[4565,4570,4574,4578,4582,4586,4590,4594,4598,4602,4606,4611,4615],{"type":173,"tag":211,"props":4566,"children":4567},{"style":228},[4568],{"type":179,"value":4569},"  app",{"type":173,"tag":211,"props":4571,"children":4572},{"style":234},[4573],{"type":179,"value":237},{"type":173,"tag":211,"props":4575,"children":4576},{"style":228},[4577],{"type":179,"value":231},{"type":173,"tag":211,"props":4579,"children":4580},{"style":234},[4581],{"type":179,"value":237},{"type":173,"tag":211,"props":4583,"children":4584},{"style":240},[4585],{"type":179,"value":326},{"type":173,"tag":211,"props":4587,"children":4588},{"style":277},[4589],{"type":179,"value":248},{"type":173,"tag":211,"props":4591,"children":4592},{"style":251},[4593],{"type":179,"value":254},{"type":173,"tag":211,"props":4595,"children":4596},{"style":257},[4597],{"type":179,"value":4504},{"type":173,"tag":211,"props":4599,"children":4600},{"style":251},[4601],{"type":179,"value":254},{"type":173,"tag":211,"props":4603,"children":4604},{"style":234},[4605],{"type":179,"value":269},{"type":173,"tag":211,"props":4607,"children":4608},{"style":350},[4609],{"type":179,"value":4610}," userType",{"type":173,"tag":211,"props":4612,"children":4613},{"style":356},[4614],{"type":179,"value":359},{"type":173,"tag":211,"props":4616,"children":4617},{"style":234},[4618],{"type":179,"value":364},{"type":173,"tag":211,"props":4620,"children":4621},{"class":213,"line":790},[4622,4626,4630,4634,4638,4642,4646,4650,4654],{"type":173,"tag":211,"props":4623,"children":4624},{"style":999},[4625],{"type":179,"value":2770},{"type":173,"tag":211,"props":4627,"children":4628},{"style":277},[4629],{"type":179,"value":623},{"type":173,"tag":211,"props":4631,"children":4632},{"style":228},[4633],{"type":179,"value":4504},{"type":173,"tag":211,"props":4635,"children":4636},{"style":464},[4637],{"type":179,"value":1375},{"type":173,"tag":211,"props":4639,"children":4640},{"style":251},[4641],{"type":179,"value":4018},{"type":173,"tag":211,"props":4643,"children":4644},{"style":257},[4645],{"type":179,"value":4521},{"type":173,"tag":211,"props":4647,"children":4648},{"style":251},[4649],{"type":179,"value":254},{"type":173,"tag":211,"props":4651,"children":4652},{"style":277},[4653],{"type":179,"value":1384},{"type":173,"tag":211,"props":4655,"children":4656},{"style":234},[4657],{"type":179,"value":1173},{"type":173,"tag":211,"props":4659,"children":4660},{"class":213,"line":798},[4661],{"type":173,"tag":211,"props":4662,"children":4663},{"style":218},[4664],{"type":179,"value":4665},"      // ...\n",{"type":173,"tag":211,"props":4667,"children":4668},{"class":213,"line":1026},[4669,4673,4677,4681,4685,4689,4693,4697,4702,4706,4710],{"type":173,"tag":211,"props":4670,"children":4671},{"style":234},[4672],{"type":179,"value":3379},{"type":173,"tag":211,"props":4674,"children":4675},{"style":999},[4676],{"type":179,"value":4072},{"type":173,"tag":211,"props":4678,"children":4679},{"style":999},[4680],{"type":179,"value":4077},{"type":173,"tag":211,"props":4682,"children":4683},{"style":277},[4684],{"type":179,"value":623},{"type":173,"tag":211,"props":4686,"children":4687},{"style":228},[4688],{"type":179,"value":4504},{"type":173,"tag":211,"props":4690,"children":4691},{"style":464},[4692],{"type":179,"value":1375},{"type":173,"tag":211,"props":4694,"children":4695},{"style":251},[4696],{"type":179,"value":4018},{"type":173,"tag":211,"props":4698,"children":4699},{"style":257},[4700],{"type":179,"value":4701},"管理员",{"type":173,"tag":211,"props":4703,"children":4704},{"style":251},[4705],{"type":179,"value":254},{"type":173,"tag":211,"props":4707,"children":4708},{"style":277},[4709],{"type":179,"value":1384},{"type":173,"tag":211,"props":4711,"children":4712},{"style":234},[4713],{"type":179,"value":1173},{"type":173,"tag":211,"props":4715,"children":4716},{"class":213,"line":1051},[4717],{"type":173,"tag":211,"props":4718,"children":4719},{"style":218},[4720],{"type":179,"value":4665},{"type":173,"tag":211,"props":4722,"children":4723},{"class":213,"line":1069},[4724],{"type":173,"tag":211,"props":4725,"children":4726},{"style":234},[4727],{"type":179,"value":1464},{"type":173,"tag":211,"props":4729,"children":4730},{"class":213,"line":1077},[4731,4736],{"type":173,"tag":211,"props":4732,"children":4733},{"style":234},[4734],{"type":179,"value":4735},"  },",{"type":173,"tag":211,"props":4737,"children":4738},{"style":234},[4739],{"type":179,"value":364},{"type":173,"tag":211,"props":4741,"children":4742},{"class":213,"line":1086},[4743,4748,4752],{"type":173,"tag":211,"props":4744,"children":4745},{"style":277},[4746],{"type":179,"value":4747},"    immediate",{"type":173,"tag":211,"props":4749,"children":4750},{"style":234},[4751],{"type":179,"value":285},{"type":173,"tag":211,"props":4753,"children":4754},{"style":925},[4755],{"type":179,"value":4756}," true\n",{"type":173,"tag":211,"props":4758,"children":4759},{"class":213,"line":2564},[4760,4764],{"type":173,"tag":211,"props":4761,"children":4762},{"style":234},[4763],{"type":179,"value":1472},{"type":173,"tag":211,"props":4765,"children":4766},{"style":277},[4767],{"type":179,"value":300},{"type":173,"tag":211,"props":4769,"children":4770},{"class":213,"line":2577},[4771],{"type":173,"tag":211,"props":4772,"children":4773},{"style":234},[4774],{"type":179,"value":804},{"type":173,"tag":211,"props":4776,"children":4777},{"class":213,"line":2585},[4778],{"type":173,"tag":211,"props":4779,"children":4780},{"emptyLinePlaceholder":165},[4781],{"type":179,"value":2933},{"type":173,"tag":211,"props":4783,"children":4784},{"class":213,"line":3152},[4785],{"type":173,"tag":211,"props":4786,"children":4787},{"style":218},[4788],{"type":179,"value":4789},"// page b\n",{"type":173,"tag":211,"props":4791,"children":4792},{"class":213,"line":3181},[4793,4798,4802],{"type":173,"tag":211,"props":4794,"children":4795},{"style":240},[4796],{"type":179,"value":4797},"switchUserType",{"type":173,"tag":211,"props":4799,"children":4800},{"style":228},[4801],{"type":179,"value":4557},{"type":173,"tag":211,"props":4803,"children":4804},{"style":234},[4805],{"type":179,"value":1173},{"type":173,"tag":211,"props":4807,"children":4808},{"class":213,"line":3222},[4809,4813,4817,4821,4825,4829,4833,4837,4841],{"type":173,"tag":211,"props":4810,"children":4811},{"style":228},[4812],{"type":179,"value":4569},{"type":173,"tag":211,"props":4814,"children":4815},{"style":234},[4816],{"type":179,"value":237},{"type":173,"tag":211,"props":4818,"children":4819},{"style":228},[4820],{"type":179,"value":1905},{"type":173,"tag":211,"props":4822,"children":4823},{"style":234},[4824],{"type":179,"value":237},{"type":173,"tag":211,"props":4826,"children":4827},{"style":228},[4828],{"type":179,"value":4504},{"type":173,"tag":211,"props":4830,"children":4831},{"style":464},[4832],{"type":179,"value":588},{"type":173,"tag":211,"props":4834,"children":4835},{"style":251},[4836],{"type":179,"value":4018},{"type":173,"tag":211,"props":4838,"children":4839},{"style":257},[4840],{"type":179,"value":4701},{"type":173,"tag":211,"props":4842,"children":4843},{"style":251},[4844],{"type":179,"value":4382},{"type":173,"tag":211,"props":4846,"children":4847},{"class":213,"line":3243},[4848],{"type":173,"tag":211,"props":4849,"children":4850},{"style":234},[4851],{"type":179,"value":804},{"type":173,"tag":174,"props":4853,"children":4855},{"id":4854},"可能遇到的问题",[4856],{"type":179,"value":4854},{"type":173,"tag":824,"props":4858,"children":4860},{"id":4859},"给-watch-方法添加的函数设置立即执行",[4861],{"type":179,"value":4862},"给 watch 方法添加的函数设置立即执行",{"type":173,"tag":181,"props":4864,"children":4865},{},[4866],{"type":179,"value":4867},"有的时候我们希望通过 watch 添加函数的同时还立即执行该函数一次, 这个时候我们需要再定义额外的参数传递到 watch 中. 问题是这个函数不一定是同步函数.",{"type":173,"tag":181,"props":4869,"children":4870},{},[4871],{"type":179,"value":4872},"简单处理如下:",{"type":173,"tag":201,"props":4874,"children":4876},{"className":203,"code":4875,"language":205,"meta":166,"style":166},"class VX {\n  async watch (key, fn, options = { immediately: false }, obj = this.store) {\n    handleDep = fn\n    walkChains(key, obj)\n    options.immediately && await fn(options.defaultParams)\n  }\n}\n",[4877],{"type":173,"tag":187,"props":4878,"children":4879},{"__ignoreMap":166},[4880,4895,4988,5004,5031,5083,5090],{"type":173,"tag":211,"props":4881,"children":4882},{"class":213,"line":214},[4883,4887,4891],{"type":173,"tag":211,"props":4884,"children":4885},{"style":356},[4886],{"type":179,"value":538},{"type":173,"tag":211,"props":4888,"children":4889},{"style":541},[4890],{"type":179,"value":1870},{"type":173,"tag":211,"props":4892,"children":4893},{"style":234},[4894],{"type":179,"value":364},{"type":173,"tag":211,"props":4896,"children":4897},{"class":213,"line":224},[4898,4904,4909,4913,4917,4921,4925,4929,4933,4937,4941,4946,4950,4955,4960,4964,4968,4972,4976,4980,4984],{"type":173,"tag":211,"props":4899,"children":4901},{"style":4900},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[4902],{"type":179,"value":4903},"  async",{"type":173,"tag":211,"props":4905,"children":4906},{"style":615},[4907],{"type":179,"value":4908}," watch",{"type":173,"tag":211,"props":4910,"children":4911},{"style":234},[4912],{"type":179,"value":623},{"type":173,"tag":211,"props":4914,"children":4915},{"style":350},[4916],{"type":179,"value":1961},{"type":173,"tag":211,"props":4918,"children":4919},{"style":234},[4920],{"type":179,"value":269},{"type":173,"tag":211,"props":4922,"children":4923},{"style":350},[4924],{"type":179,"value":1970},{"type":173,"tag":211,"props":4926,"children":4927},{"style":234},[4928],{"type":179,"value":269},{"type":173,"tag":211,"props":4930,"children":4931},{"style":350},[4932],{"type":179,"value":2036},{"type":173,"tag":211,"props":4934,"children":4935},{"style":464},[4936],{"type":179,"value":588},{"type":173,"tag":211,"props":4938,"children":4939},{"style":234},[4940],{"type":179,"value":274},{"type":173,"tag":211,"props":4942,"children":4943},{"style":277},[4944],{"type":179,"value":4945}," immediately",{"type":173,"tag":211,"props":4947,"children":4948},{"style":234},[4949],{"type":179,"value":285},{"type":173,"tag":211,"props":4951,"children":4952},{"style":925},[4953],{"type":179,"value":4954}," false",{"type":173,"tag":211,"props":4956,"children":4957},{"style":234},[4958],{"type":179,"value":4959}," },",{"type":173,"tag":211,"props":4961,"children":4962},{"style":350},[4963],{"type":179,"value":1979},{"type":173,"tag":211,"props":4965,"children":4966},{"style":464},[4967],{"type":179,"value":588},{"type":173,"tag":211,"props":4969,"children":4970},{"style":571},[4971],{"type":179,"value":1159},{"type":173,"tag":211,"props":4973,"children":4974},{"style":234},[4975],{"type":179,"value":237},{"type":173,"tag":211,"props":4977,"children":4978},{"style":228},[4979],{"type":179,"value":1905},{"type":173,"tag":211,"props":4981,"children":4982},{"style":234},[4983],{"type":179,"value":633},{"type":173,"tag":211,"props":4985,"children":4986},{"style":234},[4987],{"type":179,"value":364},{"type":173,"tag":211,"props":4989,"children":4990},{"class":213,"line":303},[4991,4996,5000],{"type":173,"tag":211,"props":4992,"children":4993},{"style":228},[4994],{"type":179,"value":4995},"    handleDep",{"type":173,"tag":211,"props":4997,"children":4998},{"style":464},[4999],{"type":179,"value":588},{"type":173,"tag":211,"props":5001,"children":5002},{"style":228},[5003],{"type":179,"value":3039},{"type":173,"tag":211,"props":5005,"children":5006},{"class":213,"line":312},[5007,5011,5015,5019,5023,5027],{"type":173,"tag":211,"props":5008,"children":5009},{"style":240},[5010],{"type":179,"value":3720},{"type":173,"tag":211,"props":5012,"children":5013},{"style":277},[5014],{"type":179,"value":248},{"type":173,"tag":211,"props":5016,"children":5017},{"style":228},[5018],{"type":179,"value":1961},{"type":173,"tag":211,"props":5020,"children":5021},{"style":234},[5022],{"type":179,"value":269},{"type":173,"tag":211,"props":5024,"children":5025},{"style":228},[5026],{"type":179,"value":1979},{"type":173,"tag":211,"props":5028,"children":5029},{"style":277},[5030],{"type":179,"value":300},{"type":173,"tag":211,"props":5032,"children":5033},{"class":213,"line":367},[5034,5039,5043,5048,5052,5057,5061,5065,5070,5074,5079],{"type":173,"tag":211,"props":5035,"children":5036},{"style":228},[5037],{"type":179,"value":5038},"    options",{"type":173,"tag":211,"props":5040,"children":5041},{"style":234},[5042],{"type":179,"value":237},{"type":173,"tag":211,"props":5044,"children":5045},{"style":228},[5046],{"type":179,"value":5047},"immediately",{"type":173,"tag":211,"props":5049,"children":5050},{"style":464},[5051],{"type":179,"value":2783},{"type":173,"tag":211,"props":5053,"children":5054},{"style":999},[5055],{"type":179,"value":5056}," await",{"type":173,"tag":211,"props":5058,"children":5059},{"style":240},[5060],{"type":179,"value":1970},{"type":173,"tag":211,"props":5062,"children":5063},{"style":277},[5064],{"type":179,"value":248},{"type":173,"tag":211,"props":5066,"children":5067},{"style":228},[5068],{"type":179,"value":5069},"options",{"type":173,"tag":211,"props":5071,"children":5072},{"style":234},[5073],{"type":179,"value":237},{"type":173,"tag":211,"props":5075,"children":5076},{"style":228},[5077],{"type":179,"value":5078},"defaultParams",{"type":173,"tag":211,"props":5080,"children":5081},{"style":277},[5082],{"type":179,"value":300},{"type":173,"tag":211,"props":5084,"children":5085},{"class":213,"line":415},[5086],{"type":173,"tag":211,"props":5087,"children":5088},{"style":234},[5089],{"type":179,"value":601},{"type":173,"tag":211,"props":5091,"children":5092},{"class":213,"line":428},[5093],{"type":173,"tag":211,"props":5094,"children":5095},{"style":234},[5096],{"type":179,"value":804},{"type":173,"tag":824,"props":5098,"children":5100},{"id":5099},"this-绑定丢失问题",[5101],{"type":179,"value":5102},"this 绑定丢失问题",{"type":173,"tag":181,"props":5104,"children":5105},{},[5106],{"type":179,"value":5107},"在我在对 VX 进行删除属性方法的扩展时, 我往 walkChain 函数中添加了一个执行回调函数的机制, 并且在删除属性这个方法直接调用了 walkChain:",{"type":173,"tag":201,"props":5109,"children":5111},{"className":203,"code":5110,"language":205,"meta":166,"style":166},"  function walkChains (key, obj, fn) {\n    const segments = key.split('.')\n    let deepObj = obj\n    while (segments.length) {\n      deepObj = deepObj[segments.shift()]\n      fn && fn()\n    }\n  }\n",[5112],{"type":173,"tag":187,"props":5113,"children":5114},{"__ignoreMap":166},[5115,5159,5206,5226,5258,5294,5314,5321],{"type":173,"tag":211,"props":5116,"children":5117},{"class":213,"line":214},[5118,5123,5127,5131,5135,5139,5143,5147,5151,5155],{"type":173,"tag":211,"props":5119,"children":5120},{"style":356},[5121],{"type":179,"value":5122},"  function",{"type":173,"tag":211,"props":5124,"children":5125},{"style":240},[5126],{"type":179,"value":3446},{"type":173,"tag":211,"props":5128,"children":5129},{"style":234},[5130],{"type":179,"value":623},{"type":173,"tag":211,"props":5132,"children":5133},{"style":350},[5134],{"type":179,"value":1961},{"type":173,"tag":211,"props":5136,"children":5137},{"style":234},[5138],{"type":179,"value":269},{"type":173,"tag":211,"props":5140,"children":5141},{"style":350},[5142],{"type":179,"value":1979},{"type":173,"tag":211,"props":5144,"children":5145},{"style":234},[5146],{"type":179,"value":269},{"type":173,"tag":211,"props":5148,"children":5149},{"style":350},[5150],{"type":179,"value":1970},{"type":173,"tag":211,"props":5152,"children":5153},{"style":234},[5154],{"type":179,"value":633},{"type":173,"tag":211,"props":5156,"children":5157},{"style":234},[5158],{"type":179,"value":364},{"type":173,"tag":211,"props":5160,"children":5161},{"class":213,"line":224},[5162,5166,5170,5174,5178,5182,5186,5190,5194,5198,5202],{"type":173,"tag":211,"props":5163,"children":5164},{"style":356},[5165],{"type":179,"value":3158},{"type":173,"tag":211,"props":5167,"children":5168},{"style":1184},[5169],{"type":179,"value":3482},{"type":173,"tag":211,"props":5171,"children":5172},{"style":464},[5173],{"type":179,"value":588},{"type":173,"tag":211,"props":5175,"children":5176},{"style":228},[5177],{"type":179,"value":894},{"type":173,"tag":211,"props":5179,"children":5180},{"style":234},[5181],{"type":179,"value":237},{"type":173,"tag":211,"props":5183,"children":5184},{"style":240},[5185],{"type":179,"value":3499},{"type":173,"tag":211,"props":5187,"children":5188},{"style":277},[5189],{"type":179,"value":248},{"type":173,"tag":211,"props":5191,"children":5192},{"style":251},[5193],{"type":179,"value":254},{"type":173,"tag":211,"props":5195,"children":5196},{"style":257},[5197],{"type":179,"value":237},{"type":173,"tag":211,"props":5199,"children":5200},{"style":251},[5201],{"type":179,"value":254},{"type":173,"tag":211,"props":5203,"children":5204},{"style":277},[5205],{"type":179,"value":300},{"type":173,"tag":211,"props":5207,"children":5208},{"class":213,"line":303},[5209,5214,5218,5222],{"type":173,"tag":211,"props":5210,"children":5211},{"style":356},[5212],{"type":179,"value":5213},"    let",{"type":173,"tag":211,"props":5215,"children":5216},{"style":228},[5217],{"type":179,"value":3531},{"type":173,"tag":211,"props":5219,"children":5220},{"style":464},[5221],{"type":179,"value":588},{"type":173,"tag":211,"props":5223,"children":5224},{"style":228},[5225],{"type":179,"value":3540},{"type":173,"tag":211,"props":5227,"children":5228},{"class":213,"line":312},[5229,5234,5238,5242,5246,5250,5254],{"type":173,"tag":211,"props":5230,"children":5231},{"style":999},[5232],{"type":179,"value":5233},"    while",{"type":173,"tag":211,"props":5235,"children":5236},{"style":277},[5237],{"type":179,"value":623},{"type":173,"tag":211,"props":5239,"children":5240},{"style":228},[5241],{"type":179,"value":3557},{"type":173,"tag":211,"props":5243,"children":5244},{"style":234},[5245],{"type":179,"value":237},{"type":173,"tag":211,"props":5247,"children":5248},{"style":1184},[5249],{"type":179,"value":3566},{"type":173,"tag":211,"props":5251,"children":5252},{"style":277},[5253],{"type":179,"value":1384},{"type":173,"tag":211,"props":5255,"children":5256},{"style":234},[5257],{"type":179,"value":1173},{"type":173,"tag":211,"props":5259,"children":5260},{"class":213,"line":367},[5261,5266,5270,5274,5278,5282,5286,5290],{"type":173,"tag":211,"props":5262,"children":5263},{"style":228},[5264],{"type":179,"value":5265},"      deepObj",{"type":173,"tag":211,"props":5267,"children":5268},{"style":464},[5269],{"type":179,"value":588},{"type":173,"tag":211,"props":5271,"children":5272},{"style":228},[5273],{"type":179,"value":3531},{"type":173,"tag":211,"props":5275,"children":5276},{"style":277},[5277],{"type":179,"value":3595},{"type":173,"tag":211,"props":5279,"children":5280},{"style":228},[5281],{"type":179,"value":3557},{"type":173,"tag":211,"props":5283,"children":5284},{"style":234},[5285],{"type":179,"value":237},{"type":173,"tag":211,"props":5287,"children":5288},{"style":240},[5289],{"type":179,"value":3608},{"type":173,"tag":211,"props":5291,"children":5292},{"style":277},[5293],{"type":179,"value":3613},{"type":173,"tag":211,"props":5295,"children":5296},{"class":213,"line":415},[5297,5302,5306,5310],{"type":173,"tag":211,"props":5298,"children":5299},{"style":228},[5300],{"type":179,"value":5301},"      fn",{"type":173,"tag":211,"props":5303,"children":5304},{"style":464},[5305],{"type":179,"value":2783},{"type":173,"tag":211,"props":5307,"children":5308},{"style":240},[5309],{"type":179,"value":1970},{"type":173,"tag":211,"props":5311,"children":5312},{"style":277},[5313],{"type":179,"value":1205},{"type":173,"tag":211,"props":5315,"children":5316},{"class":213,"line":428},[5317],{"type":173,"tag":211,"props":5318,"children":5319},{"style":234},[5320],{"type":179,"value":1464},{"type":173,"tag":211,"props":5322,"children":5323},{"class":213,"line":682},[5324],{"type":173,"tag":211,"props":5325,"children":5326},{"style":234},[5327],{"type":179,"value":601},{"type":173,"tag":201,"props":5329,"children":5331},{"className":203,"code":5330,"language":205,"meta":166,"style":166},"del (key, obj = this.store) {\n  walkChains(key, obj, handleDep.clear)\n  delete obj[key]\n}\n",[5332],{"type":173,"tag":187,"props":5333,"children":5334},{"__ignoreMap":166},[5335,5375,5421,5445],{"type":173,"tag":211,"props":5336,"children":5337},{"class":213,"line":214},[5338,5343,5347,5351,5355,5359,5363,5367,5371],{"type":173,"tag":211,"props":5339,"children":5340},{"style":240},[5341],{"type":179,"value":5342},"del",{"type":173,"tag":211,"props":5344,"children":5345},{"style":228},[5346],{"type":179,"value":1119},{"type":173,"tag":211,"props":5348,"children":5349},{"style":234},[5350],{"type":179,"value":269},{"type":173,"tag":211,"props":5352,"children":5353},{"style":228},[5354],{"type":179,"value":1150},{"type":173,"tag":211,"props":5356,"children":5357},{"style":464},[5358],{"type":179,"value":467},{"type":173,"tag":211,"props":5360,"children":5361},{"style":571},[5362],{"type":179,"value":1159},{"type":173,"tag":211,"props":5364,"children":5365},{"style":234},[5366],{"type":179,"value":237},{"type":173,"tag":211,"props":5368,"children":5369},{"style":228},[5370],{"type":179,"value":1168},{"type":173,"tag":211,"props":5372,"children":5373},{"style":234},[5374],{"type":179,"value":1173},{"type":173,"tag":211,"props":5376,"children":5377},{"class":213,"line":224},[5378,5383,5387,5391,5395,5399,5403,5408,5412,5417],{"type":173,"tag":211,"props":5379,"children":5380},{"style":240},[5381],{"type":179,"value":5382},"  walkChains",{"type":173,"tag":211,"props":5384,"children":5385},{"style":277},[5386],{"type":179,"value":248},{"type":173,"tag":211,"props":5388,"children":5389},{"style":228},[5390],{"type":179,"value":1961},{"type":173,"tag":211,"props":5392,"children":5393},{"style":234},[5394],{"type":179,"value":269},{"type":173,"tag":211,"props":5396,"children":5397},{"style":228},[5398],{"type":179,"value":1979},{"type":173,"tag":211,"props":5400,"children":5401},{"style":234},[5402],{"type":179,"value":269},{"type":173,"tag":211,"props":5404,"children":5405},{"style":228},[5406],{"type":179,"value":5407}," handleDep",{"type":173,"tag":211,"props":5409,"children":5410},{"style":234},[5411],{"type":179,"value":237},{"type":173,"tag":211,"props":5413,"children":5414},{"style":228},[5415],{"type":179,"value":5416},"clear",{"type":173,"tag":211,"props":5418,"children":5419},{"style":277},[5420],{"type":179,"value":300},{"type":173,"tag":211,"props":5422,"children":5423},{"class":213,"line":303},[5424,5429,5433,5437,5441],{"type":173,"tag":211,"props":5425,"children":5426},{"style":464},[5427],{"type":179,"value":5428},"  delete",{"type":173,"tag":211,"props":5430,"children":5431},{"style":228},[5432],{"type":179,"value":1979},{"type":173,"tag":211,"props":5434,"children":5435},{"style":277},[5436],{"type":179,"value":3595},{"type":173,"tag":211,"props":5438,"children":5439},{"style":228},[5440],{"type":179,"value":1961},{"type":173,"tag":211,"props":5442,"children":5443},{"style":277},[5444],{"type":179,"value":3981},{"type":173,"tag":211,"props":5446,"children":5447},{"class":213,"line":312},[5448],{"type":173,"tag":211,"props":5449,"children":5450},{"style":234},[5451],{"type":179,"value":804},{"type":173,"tag":181,"props":5453,"children":5454},{},[5455,5457,5462],{"type":179,"value":5456},"因为 handleDep.clear 当成参数传递进 walkChains 中会",{"type":173,"tag":517,"props":5458,"children":5459},{},[5460],{"type":179,"value":5461},"丢失 this 绑定",{"type":179,"value":5463},", 所以上面那段代码其实是有问题的, 不过稍作修改就好了:",{"type":173,"tag":201,"props":5465,"children":5467},{"className":203,"code":5466,"language":205,"meta":166,"style":166},"  del (key, obj = this.store) {\n    walkChains(key, obj, () => handleDep.clear())\n    delete obj[key]\n  }\n",[5468],{"type":173,"tag":187,"props":5469,"children":5470},{"__ignoreMap":166},[5471,5511,5563,5587],{"type":173,"tag":211,"props":5472,"children":5473},{"class":213,"line":214},[5474,5479,5483,5487,5491,5495,5499,5503,5507],{"type":173,"tag":211,"props":5475,"children":5476},{"style":240},[5477],{"type":179,"value":5478},"  del",{"type":173,"tag":211,"props":5480,"children":5481},{"style":228},[5482],{"type":179,"value":1119},{"type":173,"tag":211,"props":5484,"children":5485},{"style":234},[5486],{"type":179,"value":269},{"type":173,"tag":211,"props":5488,"children":5489},{"style":228},[5490],{"type":179,"value":1150},{"type":173,"tag":211,"props":5492,"children":5493},{"style":464},[5494],{"type":179,"value":467},{"type":173,"tag":211,"props":5496,"children":5497},{"style":571},[5498],{"type":179,"value":1159},{"type":173,"tag":211,"props":5500,"children":5501},{"style":234},[5502],{"type":179,"value":237},{"type":173,"tag":211,"props":5504,"children":5505},{"style":228},[5506],{"type":179,"value":1168},{"type":173,"tag":211,"props":5508,"children":5509},{"style":234},[5510],{"type":179,"value":1173},{"type":173,"tag":211,"props":5512,"children":5513},{"class":213,"line":224},[5514,5518,5522,5526,5530,5534,5538,5542,5546,5550,5554,5558],{"type":173,"tag":211,"props":5515,"children":5516},{"style":240},[5517],{"type":179,"value":3720},{"type":173,"tag":211,"props":5519,"children":5520},{"style":277},[5521],{"type":179,"value":248},{"type":173,"tag":211,"props":5523,"children":5524},{"style":228},[5525],{"type":179,"value":1961},{"type":173,"tag":211,"props":5527,"children":5528},{"style":234},[5529],{"type":179,"value":269},{"type":173,"tag":211,"props":5531,"children":5532},{"style":228},[5533],{"type":179,"value":1979},{"type":173,"tag":211,"props":5535,"children":5536},{"style":234},[5537],{"type":179,"value":269},{"type":173,"tag":211,"props":5539,"children":5540},{"style":234},[5541],{"type":179,"value":561},{"type":173,"tag":211,"props":5543,"children":5544},{"style":356},[5545],{"type":179,"value":359},{"type":173,"tag":211,"props":5547,"children":5548},{"style":228},[5549],{"type":179,"value":5407},{"type":173,"tag":211,"props":5551,"children":5552},{"style":234},[5553],{"type":179,"value":237},{"type":173,"tag":211,"props":5555,"children":5556},{"style":240},[5557],{"type":179,"value":5416},{"type":173,"tag":211,"props":5559,"children":5560},{"style":277},[5561],{"type":179,"value":5562},"())\n",{"type":173,"tag":211,"props":5564,"children":5565},{"class":213,"line":303},[5566,5571,5575,5579,5583],{"type":173,"tag":211,"props":5567,"children":5568},{"style":464},[5569],{"type":179,"value":5570},"    delete",{"type":173,"tag":211,"props":5572,"children":5573},{"style":228},[5574],{"type":179,"value":1979},{"type":173,"tag":211,"props":5576,"children":5577},{"style":277},[5578],{"type":179,"value":3595},{"type":173,"tag":211,"props":5580,"children":5581},{"style":228},[5582],{"type":179,"value":1961},{"type":173,"tag":211,"props":5584,"children":5585},{"style":277},[5586],{"type":179,"value":3981},{"type":173,"tag":211,"props":5588,"children":5589},{"class":213,"line":312},[5590],{"type":173,"tag":211,"props":5591,"children":5592},{"style":234},[5593],{"type":179,"value":601},{"type":173,"tag":174,"props":5595,"children":5597},{"id":5596},"后语",[5598],{"type":179,"value":5596},{"type":173,"tag":181,"props":5600,"children":5601},{},[5602],{"type":179,"value":5603},"在这篇文章中, 我们通过对 defineProperty 进行封装, 实现了一个简单的对象属性侦听器的功能, 以弥补小程序所没有的$watch 能力. 在此基础上, 各位可以再对 VX 进行扩展, 更方便地去书写业务代码.",{"type":173,"tag":181,"props":5605,"children":5606},{},[5607,5609],{"type":179,"value":5608},"完整代码 ",{"type":173,"tag":443,"props":5610,"children":5614},{"href":5611,"rel":5612},"https://github.com/Lionad-Morotar/media-gear/blob/master/src/renderer/utils/suites/vx/index.js",[5613],"nofollow",[5615],{"type":179,"value":5616},"GitHub 直达",{"type":173,"tag":5618,"props":5619,"children":5620},"style",{},[5621],{"type":179,"value":5622},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":166,"searchDepth":224,"depth":224,"links":5624},[5625,5626,5627,5628,5631,5636,5637,5640,5644],{"id":176,"depth":224,"text":176},{"id":498,"depth":224,"text":498},{"id":508,"depth":224,"text":508},{"id":820,"depth":224,"text":820,"children":5629},[5630],{"id":826,"depth":303,"text":829},{"id":1805,"depth":224,"text":1808,"children":5632},[5633,5634,5635],{"id":1811,"depth":303,"text":1811},{"id":1843,"depth":303,"text":1846},{"id":2593,"depth":303,"text":2593},{"id":3402,"depth":224,"text":3405},{"id":4305,"depth":224,"text":4305,"children":5638},[5639],{"id":4310,"depth":303,"text":4310},{"id":4854,"depth":224,"text":4854,"children":5641},[5642,5643],{"id":4859,"depth":303,"text":4862},{"id":5099,"depth":303,"text":5102},{"id":5596,"depth":224,"text":5596},"markdown","content:_achieved:2019-05:reactive-in-150loc.md","content","_achieved/2019-05/reactive-in-150loc.md","_achieved/2019-05/reactive-in-150loc","md",[5652,5655],{"_path":5653,"title":5654,"description":166},"/_achieved/2018-10/noname","🌆 无题",{"_path":5656,"title":5657,"description":166},"/_achieved/2019-06/messy-in-two-years","💖 聊聊此次离职，毕业，及其它杂乱的事情",1761757111425]