[{"data":1,"prerenderedAt":5881},["ShallowReactive",2],{"navigation":3,"/_achieved/2019-05/reactive-in-150loc":384,"/_achieved/2019-05/reactive-in-150loc-surround":5874},[4,35,86,105,132,138,144,150,378],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":45,"_path":46},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":48,"_path":49},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":51,"_path":52},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":54,"_path":55},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":57,"_path":58},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":60,"_path":61},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":63,"_path":64},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":66,"_path":67},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":69,"_path":70},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":72,"_path":73},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":75,"_path":76},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":78,"_path":79},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":81,"_path":82},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":84,"_path":85},"📝 技术博客归档","/articles/archive",{"title":87,"_path":88,"children":89},"造物 / Make","/tools",[90,93,96,99,102],{"title":91,"_path":92},"🥥 Coconut","/tools/coconut",{"title":94,"_path":95},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":97,"_path":98},"🌐 AnySort","/tools/anysort",{"title":100,"_path":101},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":103,"_path":104},"👓 Crapto","/tools/crypto-inline",{"title":106,"_path":107,"children":108},"吉他剧场 / Music","/music",[109,111,114,117,120,123,126,129],{"title":110,"_path":107},"🎸 FingerStyle！",{"title":112,"_path":113},"🌬️ 等待的风","/music/wind",{"title":115,"_path":116},"💕 约定的海洋","/music/ocean",{"title":118,"_path":119},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":121,"_path":122},"🌏 残酷天使的行动纲领","/music/eva",{"title":124,"_path":125},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":127,"_path":128},"🍷 Wu Wei","/music/wu-wei",{"title":130,"_path":131},"🌅 无题","/music/untitled",{"title":133,"_path":134,"children":135},"画点什么 / Paint","/paint",[136],{"title":137,"_path":134},"🚧 正在施工",{"title":139,"_path":140,"children":141},"读书笔记 / Notes","/books",[142],{"title":143,"_path":140},"📕 读书笔记",{"title":145,"_path":146,"children":147},"知识地图 / Maps","/maps",[148],{"title":149,"_path":146},"🏁 知识地图",{"title":151,"_path":152,"children":153},"零散的笔记 / Gists","/gists",[154,156,159,162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243,246,249,252,255,258,261,264,267,270,273,276,279,282,285,288,291,294,297,300,303,306,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375],{"title":155,"_path":152},"🧊 Gists",{"title":157,"_path":158},"网站的可访问性","/gists/accessibility",{"title":160,"_path":161},"Bit","/gists/bit",{"title":163,"_path":164},"图片模糊","/gists/blur",{"title":166,"_path":167},"渲染相关笔记","/gists/c4d",{"title":169,"_path":170},"CDN 问题记录","/gists/cdn",{"title":172,"_path":173},"消毒剂","/gists/cleaner",{"title":175,"_path":176},"Windows Command","/gists/cmd",{"title":178,"_path":179},"Command","/gists/command",{"title":181,"_path":182},"复杂科学","/gists/complexity-science",{"title":184,"_path":185},"GitHub Copilot","/gists/copilot",{"title":187,"_path":188},"宇宙","/gists/cosmos",{"title":190,"_path":191},"C++","/gists/cpp",{"title":193,"_path":194},"DEPRESSION","/gists/depression",{"title":196,"_path":197},"Developer Experience","/gists/developer-experience",{"title":199,"_path":200},"Device Metrics","/gists/device-metrix",{"title":202,"_path":203},"ECMAScript Language Specification","/gists/ecmascript-specification",{"title":205,"_path":206},"正则表达式","/gists/eegex",{"title":208,"_path":209},"Emoji","/gists/emoji",{"title":211,"_path":212},"工程","/gists/engineering",{"title":214,"_path":215},"熵","/gists/entropy",{"title":217,"_path":218},"Environment","/gists/environment",{"title":220,"_path":221},"Erlang","/gists/erlang",{"title":223,"_path":224},"逃离塔克夫","/gists/escape-from-tarkov",{"title":226,"_path":227},"ESNext (ES6-ES11)","/gists/esnext",{"title":229,"_path":230},"Eval！","/gists/eval",{"title":232,"_path":233},"Flutter","/gists/flutter",{"title":235,"_path":236},"字体","/gists/font",{"title":238,"_path":239},"JS 函数式编程","/gists/functional",{"title":241,"_path":242},"游戏化","/gists/gamification",{"title":244,"_path":245},"Google C++ Standard","/gists/google-cpp-standard",{"title":247,"_path":248},"双向链接完全体","/gists/graph",{"title":250,"_path":251},"Hardwares","/gists/hardwares",{"title":253,"_path":254},"哈希冲突","/gists/hash-collision",{"title":256,"_path":257},"信息设计","/gists/information-design",{"title":259,"_path":260},"InstantPage","/gists/instant.page",{"title":262,"_path":263},"ISUX 遇见大数据可视化系列","/gists/isux-data-visualization",{"title":265,"_path":266},"KVStore","/gists/key-value-db",{"title":268,"_path":269},"Kubernetes","/gists/kubernetes",{"title":271,"_path":272},"Makefile","/gists/makefile",{"title":274,"_path":275},"Markdown Inline Style","/gists/markdown-nice",{"title":277,"_path":278},"减小页面快照体积","/gists/minify-html",{"title":280,"_path":281},"mklink","/gists/mklink",{"title":283,"_path":284},"Mock","/gists/mock",{"title":286,"_path":287},"多人协作系统","/gists/multiplayer",{"title":289,"_path":290},"多端应用","/gists/multy-end-app",{"title":292,"_path":293},"神经科学","/gists/neuroscience",{"title":295,"_path":296},"Opinioned Personal Folder","/gists/opinioned-personal-folder",{"title":298,"_path":299},"PInvoke","/gists/pinvoke",{"title":301,"_path":302},"像素","/gists/pixel",{"title":304,"_path":305},"PowerShell","/gists/powershell",{"title":307,"_path":308},"量子","/gists/quantum",{"title":310,"_path":311},"保持好奇心","/gists/questions",{"title":313,"_path":314},"React Native","/gists/react-native",{"title":316,"_path":317},"博客改版碰到的浏览器平滑滚动问题","/gists/scroll",{"title":319,"_path":320},"SEO","/gists/seo",{"title":322,"_path":323},"Shader","/gists/shader",{"title":325,"_path":326},"Shape Up","/gists/shape-up",{"title":328,"_path":329},"睡觉","/gists/sleep",{"title":331,"_path":332},"记录奇怪的问题","/gists/solved",{"title":334,"_path":335},"States","/gists/states",{"title":337,"_path":338},"Storage","/gists/storage",{"title":340,"_path":341},"音视频流处理","/gists/stream-cli",{"title":343,"_path":344},"Symbol","/gists/symbol",{"title":346,"_path":347},"系统论","/gists/systems-theory",{"title":349,"_path":350},"任务切片","/gists/task-slice",{"title":352,"_path":353},"技术偏好","/gists/tech-dudge",{"title":355,"_path":356},"Untitled","/gists/untitled",{"title":358,"_path":359},"可变字体","/gists/variable-font",{"title":361,"_path":362},"视觉错觉","/gists/visual-illusion",{"title":364,"_path":365},"SS(SSR)","/gists/vpn",{"title":367,"_path":368},"VS Code 插件开发","/gists/vscode-plugin",{"title":370,"_path":371},"Web Components","/gists/web-components",{"title":373,"_path":374},"Windows","/gists/windows",{"title":376,"_path":377},"查缺补漏","/gists/wrong",{"title":379,"_path":380,"children":381},"我 / About","/hire",[382],{"title":383,"_path":380},"📬 技术简历",{"_path":385,"_dir":386,"_draft":387,"_partial":388,"_locale":389,"title":390,"description":391,"body":392,"_type":5868,"_id":5869,"_source":5870,"_file":5871,"_stem":5872,"_extension":5873},"/_achieved/2019-05/reactive-in-150loc","2019-05",false,true,"","🚀 150 行代码带你实现小程序中的数据侦听","本文介绍了在 150 行代码内使用 defineProperty 实现一个简单的拥有事件发布订阅能力的状态管理库的思路。",{"type":393,"children":394,"toc":5846},"root",[395,403,418,423,702,714,719,724,729,734,747,1028,1041,1046,1053,1065,1319,1324,1707,1712,1717,1722,1879,2021,2026,2032,2037,2042,2051,2056,2064,2070,2075,2331,2336,2341,2814,2819,2848,3623,3629,3642,3978,3991,4004,4526,4531,4536,4541,4546,4559,5075,5080,5086,5091,5096,5320,5326,5331,5551,5675,5687,5817,5822,5827,5840],{"type":396,"tag":397,"props":398,"children":400},"element","h2",{"id":399},"前言",[401],{"type":402,"value":399},"text",{"type":396,"tag":404,"props":405,"children":406},"p",{},[407,409,416],{"type":402,"value":408},"在小程序项目中, 我们的通常会使用到使用到一个全局对象作为各个页面通用的数据存储容器, 将它绑定到 app 对象后, 就能在每一个页面都自由的操纵这个对象. 然而在实践中, 由于这个对象及其属性不具备响应式条件, 它不能直接参与业务逻辑的编写, 能力仅仅局限于数据储存. 若是在 VueJS 项目中, 我们可能经常使用到",{"type":396,"tag":410,"props":411,"children":413},"code",{"className":412},[],[414],{"type":402,"value":415},"Vue.$watch",{"type":402,"value":417},"去侦听某个数据是否发生变化, 小程序却缺乏这种能力.",{"type":396,"tag":404,"props":419,"children":420},{},[421],{"type":402,"value":422},"在这篇文章中, 我将用 150 行代码, 手把手带你打造一个小程序也可以使用的侦听器(下简称 VX):",{"type":396,"tag":424,"props":425,"children":429},"pre",{"className":426,"code":427,"language":428,"meta":389,"style":389},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","// 一个快速赋值的语法糖函数, 可以创建结构为 { value: a { b: { val: ''} } } 的对象\nvx.set('value.a.d', { val: '' })\n// 对某个属性进行侦听, 如果发生改变, 则执行相应函数(可多次watch以执行多个函数)\nvx.watch('value.a.d.val', newVal => {\n  console.log(`val改变为 : `, newVal)\n})\nvalue.a.d.val = 3 // val改编为 : 3\n","js",[430],{"type":396,"tag":410,"props":431,"children":432},{"__ignoreMap":389},[433,445,524,533,588,636,649],{"type":396,"tag":434,"props":435,"children":438},"span",{"class":436,"line":437},"line",1,[439],{"type":396,"tag":434,"props":440,"children":442},{"style":441},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[443],{"type":402,"value":444},"// 一个快速赋值的语法糖函数, 可以创建结构为 { value: a { b: { val: ''} } } 的对象\n",{"type":396,"tag":434,"props":446,"children":448},{"class":436,"line":447},2,[449,455,461,467,472,478,484,488,493,498,504,509,514,519],{"type":396,"tag":434,"props":450,"children":452},{"style":451},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[453],{"type":402,"value":454},"vx",{"type":396,"tag":434,"props":456,"children":458},{"style":457},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[459],{"type":402,"value":460},".",{"type":396,"tag":434,"props":462,"children":464},{"style":463},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[465],{"type":402,"value":466},"set",{"type":396,"tag":434,"props":468,"children":469},{"style":451},[470],{"type":402,"value":471},"(",{"type":396,"tag":434,"props":473,"children":475},{"style":474},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[476],{"type":402,"value":477},"'",{"type":396,"tag":434,"props":479,"children":481},{"style":480},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[482],{"type":402,"value":483},"value.a.d",{"type":396,"tag":434,"props":485,"children":486},{"style":474},[487],{"type":402,"value":477},{"type":396,"tag":434,"props":489,"children":490},{"style":457},[491],{"type":402,"value":492},",",{"type":396,"tag":434,"props":494,"children":495},{"style":457},[496],{"type":402,"value":497}," {",{"type":396,"tag":434,"props":499,"children":501},{"style":500},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[502],{"type":402,"value":503}," val",{"type":396,"tag":434,"props":505,"children":506},{"style":457},[507],{"type":402,"value":508},":",{"type":396,"tag":434,"props":510,"children":511},{"style":474},[512],{"type":402,"value":513}," ''",{"type":396,"tag":434,"props":515,"children":516},{"style":457},[517],{"type":402,"value":518}," }",{"type":396,"tag":434,"props":520,"children":521},{"style":451},[522],{"type":402,"value":523},")\n",{"type":396,"tag":434,"props":525,"children":527},{"class":436,"line":526},3,[528],{"type":396,"tag":434,"props":529,"children":530},{"style":441},[531],{"type":402,"value":532},"// 对某个属性进行侦听, 如果发生改变, 则执行相应函数(可多次watch以执行多个函数)\n",{"type":396,"tag":434,"props":534,"children":536},{"class":436,"line":535},4,[537,541,545,550,554,558,563,567,571,577,583],{"type":396,"tag":434,"props":538,"children":539},{"style":451},[540],{"type":402,"value":454},{"type":396,"tag":434,"props":542,"children":543},{"style":457},[544],{"type":402,"value":460},{"type":396,"tag":434,"props":546,"children":547},{"style":463},[548],{"type":402,"value":549},"watch",{"type":396,"tag":434,"props":551,"children":552},{"style":451},[553],{"type":402,"value":471},{"type":396,"tag":434,"props":555,"children":556},{"style":474},[557],{"type":402,"value":477},{"type":396,"tag":434,"props":559,"children":560},{"style":480},[561],{"type":402,"value":562},"value.a.d.val",{"type":396,"tag":434,"props":564,"children":565},{"style":474},[566],{"type":402,"value":477},{"type":396,"tag":434,"props":568,"children":569},{"style":457},[570],{"type":402,"value":492},{"type":396,"tag":434,"props":572,"children":574},{"style":573},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[575],{"type":402,"value":576}," newVal",{"type":396,"tag":434,"props":578,"children":580},{"style":579},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[581],{"type":402,"value":582}," =>",{"type":396,"tag":434,"props":584,"children":585},{"style":457},[586],{"type":402,"value":587}," {\n",{"type":396,"tag":434,"props":589,"children":591},{"class":436,"line":590},5,[592,597,601,606,610,615,620,624,628,632],{"type":396,"tag":434,"props":593,"children":594},{"style":451},[595],{"type":402,"value":596},"  console",{"type":396,"tag":434,"props":598,"children":599},{"style":457},[600],{"type":402,"value":460},{"type":396,"tag":434,"props":602,"children":603},{"style":463},[604],{"type":402,"value":605},"log",{"type":396,"tag":434,"props":607,"children":608},{"style":500},[609],{"type":402,"value":471},{"type":396,"tag":434,"props":611,"children":612},{"style":474},[613],{"type":402,"value":614},"`",{"type":396,"tag":434,"props":616,"children":617},{"style":480},[618],{"type":402,"value":619},"val改变为 : ",{"type":396,"tag":434,"props":621,"children":622},{"style":474},[623],{"type":402,"value":614},{"type":396,"tag":434,"props":625,"children":626},{"style":457},[627],{"type":402,"value":492},{"type":396,"tag":434,"props":629,"children":630},{"style":451},[631],{"type":402,"value":576},{"type":396,"tag":434,"props":633,"children":634},{"style":500},[635],{"type":402,"value":523},{"type":396,"tag":434,"props":637,"children":639},{"class":436,"line":638},6,[640,645],{"type":396,"tag":434,"props":641,"children":642},{"style":457},[643],{"type":402,"value":644},"}",{"type":396,"tag":434,"props":646,"children":647},{"style":451},[648],{"type":402,"value":523},{"type":396,"tag":434,"props":650,"children":652},{"class":436,"line":651},7,[653,658,662,667,671,676,680,685,691,697],{"type":396,"tag":434,"props":654,"children":655},{"style":451},[656],{"type":402,"value":657},"value",{"type":396,"tag":434,"props":659,"children":660},{"style":457},[661],{"type":402,"value":460},{"type":396,"tag":434,"props":663,"children":664},{"style":451},[665],{"type":402,"value":666},"a",{"type":396,"tag":434,"props":668,"children":669},{"style":457},[670],{"type":402,"value":460},{"type":396,"tag":434,"props":672,"children":673},{"style":451},[674],{"type":402,"value":675},"d",{"type":396,"tag":434,"props":677,"children":678},{"style":457},[679],{"type":402,"value":460},{"type":396,"tag":434,"props":681,"children":682},{"style":451},[683],{"type":402,"value":684},"val ",{"type":396,"tag":434,"props":686,"children":688},{"style":687},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[689],{"type":402,"value":690},"=",{"type":396,"tag":434,"props":692,"children":694},{"style":693},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[695],{"type":402,"value":696}," 3",{"type":396,"tag":434,"props":698,"children":699},{"style":441},[700],{"type":402,"value":701}," // val改编为 : 3\n",{"type":396,"tag":404,"props":703,"children":704},{},[705,707,712],{"type":402,"value":706},"使用 VX 侦听器, 我们可以更加方便的管理各个页面的状态. 同时, 我们凭借",{"type":396,"tag":410,"props":708,"children":710},{"className":709},[],[711],{"type":402,"value":549},{"type":402,"value":713},"语法, 可以更优雅地编写业务逻辑.",{"type":396,"tag":404,"props":715,"children":716},{},[717],{"type":402,"value":718},"坐稳了, 三轮车准备启动了~ 各位评论见~ 😋",{"type":396,"tag":397,"props":720,"children":722},{"id":721},"稍微理一理思路",[723],{"type":402,"value":721},{"type":396,"tag":404,"props":725,"children":726},{},[727],{"type":402,"value":728},"在全局对象中, 我们不一定要对每一个属性都进行侦听, 所以 VX 主要的功能就是通过 set 去设置某个具体属性的 setter/getter, 同时通过 watch 向添加该属性添加需要订阅的回调函数.",{"type":396,"tag":397,"props":730,"children":732},{"id":731},"依赖对象的实现",[733],{"type":402,"value":731},{"type":396,"tag":404,"props":735,"children":736},{},[737,739,745],{"type":402,"value":738},"首先我们需要造一个通用的",{"type":396,"tag":740,"props":741,"children":742},"strong",{},[743],{"type":402,"value":744},"依赖对象",{"type":402,"value":746},", 依赖对象携带一个订阅数组用于存放一组回调函数, 同时它还应该包括一些操作订阅数组能力(如添加订阅, 清空订阅)的函数",{"type":396,"tag":424,"props":748,"children":750},{"className":426,"code":749,"language":428,"meta":389,"style":389},"class Dep {\n  constructor () {\n    this.subs = []\n  }\n  // 将回调添加到数组中\n  addSub (fn) { /*...*/ }\n  delSub (fn) { /*...*/ }\n  // 执行数组中每一项函数\n  notify (newVal, oldVal) {\n    this.subs.forEach(func => func(newVal, oldVal))\n  }\n}\n",[751],{"type":396,"tag":410,"props":752,"children":753},{"__ignoreMap":389},[754,772,789,817,825,833,871,903,912,947,1011,1019],{"type":396,"tag":434,"props":755,"children":756},{"class":436,"line":437},[757,762,768],{"type":396,"tag":434,"props":758,"children":759},{"style":579},[760],{"type":402,"value":761},"class",{"type":396,"tag":434,"props":763,"children":765},{"style":764},"--shiki-light:#E2931D;--shiki-light-text-decoration:inherit;--shiki-default:#6F42C1;--shiki-default-text-decoration:inherit;--shiki-dark:#B392F0;--shiki-dark-text-decoration:inherit;--shiki-sepia:#A6E22E;--shiki-sepia-text-decoration:underline",[766],{"type":402,"value":767}," Dep",{"type":396,"tag":434,"props":769,"children":770},{"style":457},[771],{"type":402,"value":587},{"type":396,"tag":434,"props":773,"children":774},{"class":436,"line":447},[775,780,785],{"type":396,"tag":434,"props":776,"children":777},{"style":579},[778],{"type":402,"value":779},"  constructor",{"type":396,"tag":434,"props":781,"children":782},{"style":457},[783],{"type":402,"value":784}," ()",{"type":396,"tag":434,"props":786,"children":787},{"style":457},[788],{"type":402,"value":587},{"type":396,"tag":434,"props":790,"children":791},{"class":436,"line":526},[792,798,802,807,812],{"type":396,"tag":434,"props":793,"children":795},{"style":794},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[796],{"type":402,"value":797},"    this",{"type":396,"tag":434,"props":799,"children":800},{"style":457},[801],{"type":402,"value":460},{"type":396,"tag":434,"props":803,"children":804},{"style":451},[805],{"type":402,"value":806},"subs",{"type":396,"tag":434,"props":808,"children":809},{"style":687},[810],{"type":402,"value":811}," =",{"type":396,"tag":434,"props":813,"children":814},{"style":500},[815],{"type":402,"value":816}," []\n",{"type":396,"tag":434,"props":818,"children":819},{"class":436,"line":535},[820],{"type":396,"tag":434,"props":821,"children":822},{"style":457},[823],{"type":402,"value":824},"  }\n",{"type":396,"tag":434,"props":826,"children":827},{"class":436,"line":590},[828],{"type":396,"tag":434,"props":829,"children":830},{"style":441},[831],{"type":402,"value":832},"  // 将回调添加到数组中\n",{"type":396,"tag":434,"props":834,"children":835},{"class":436,"line":638},[836,842,847,852,857,861,866],{"type":396,"tag":434,"props":837,"children":839},{"style":838},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[840],{"type":402,"value":841},"  addSub",{"type":396,"tag":434,"props":843,"children":844},{"style":457},[845],{"type":402,"value":846}," (",{"type":396,"tag":434,"props":848,"children":849},{"style":573},[850],{"type":402,"value":851},"fn",{"type":396,"tag":434,"props":853,"children":854},{"style":457},[855],{"type":402,"value":856},")",{"type":396,"tag":434,"props":858,"children":859},{"style":457},[860],{"type":402,"value":497},{"type":396,"tag":434,"props":862,"children":863},{"style":441},[864],{"type":402,"value":865}," /*...*/",{"type":396,"tag":434,"props":867,"children":868},{"style":457},[869],{"type":402,"value":870}," }\n",{"type":396,"tag":434,"props":872,"children":873},{"class":436,"line":651},[874,879,883,887,891,895,899],{"type":396,"tag":434,"props":875,"children":876},{"style":838},[877],{"type":402,"value":878},"  delSub",{"type":396,"tag":434,"props":880,"children":881},{"style":457},[882],{"type":402,"value":846},{"type":396,"tag":434,"props":884,"children":885},{"style":573},[886],{"type":402,"value":851},{"type":396,"tag":434,"props":888,"children":889},{"style":457},[890],{"type":402,"value":856},{"type":396,"tag":434,"props":892,"children":893},{"style":457},[894],{"type":402,"value":497},{"type":396,"tag":434,"props":896,"children":897},{"style":441},[898],{"type":402,"value":865},{"type":396,"tag":434,"props":900,"children":901},{"style":457},[902],{"type":402,"value":870},{"type":396,"tag":434,"props":904,"children":906},{"class":436,"line":905},8,[907],{"type":396,"tag":434,"props":908,"children":909},{"style":441},[910],{"type":402,"value":911},"  // 执行数组中每一项函数\n",{"type":396,"tag":434,"props":913,"children":915},{"class":436,"line":914},9,[916,921,925,930,934,939,943],{"type":396,"tag":434,"props":917,"children":918},{"style":838},[919],{"type":402,"value":920},"  notify",{"type":396,"tag":434,"props":922,"children":923},{"style":457},[924],{"type":402,"value":846},{"type":396,"tag":434,"props":926,"children":927},{"style":573},[928],{"type":402,"value":929},"newVal",{"type":396,"tag":434,"props":931,"children":932},{"style":457},[933],{"type":402,"value":492},{"type":396,"tag":434,"props":935,"children":936},{"style":573},[937],{"type":402,"value":938}," oldVal",{"type":396,"tag":434,"props":940,"children":941},{"style":457},[942],{"type":402,"value":856},{"type":396,"tag":434,"props":944,"children":945},{"style":457},[946],{"type":402,"value":587},{"type":396,"tag":434,"props":948,"children":950},{"class":436,"line":949},10,[951,955,959,963,967,972,976,981,985,990,994,998,1002,1006],{"type":396,"tag":434,"props":952,"children":953},{"style":794},[954],{"type":402,"value":797},{"type":396,"tag":434,"props":956,"children":957},{"style":457},[958],{"type":402,"value":460},{"type":396,"tag":434,"props":960,"children":961},{"style":451},[962],{"type":402,"value":806},{"type":396,"tag":434,"props":964,"children":965},{"style":457},[966],{"type":402,"value":460},{"type":396,"tag":434,"props":968,"children":969},{"style":463},[970],{"type":402,"value":971},"forEach",{"type":396,"tag":434,"props":973,"children":974},{"style":500},[975],{"type":402,"value":471},{"type":396,"tag":434,"props":977,"children":978},{"style":573},[979],{"type":402,"value":980},"func",{"type":396,"tag":434,"props":982,"children":983},{"style":579},[984],{"type":402,"value":582},{"type":396,"tag":434,"props":986,"children":987},{"style":463},[988],{"type":402,"value":989}," func",{"type":396,"tag":434,"props":991,"children":992},{"style":500},[993],{"type":402,"value":471},{"type":396,"tag":434,"props":995,"children":996},{"style":451},[997],{"type":402,"value":929},{"type":396,"tag":434,"props":999,"children":1000},{"style":457},[1001],{"type":402,"value":492},{"type":396,"tag":434,"props":1003,"children":1004},{"style":451},[1005],{"type":402,"value":938},{"type":396,"tag":434,"props":1007,"children":1008},{"style":500},[1009],{"type":402,"value":1010},"))\n",{"type":396,"tag":434,"props":1012,"children":1014},{"class":436,"line":1013},11,[1015],{"type":396,"tag":434,"props":1016,"children":1017},{"style":457},[1018],{"type":402,"value":824},{"type":396,"tag":434,"props":1020,"children":1022},{"class":436,"line":1021},12,[1023],{"type":396,"tag":434,"props":1024,"children":1025},{"style":457},[1026],{"type":402,"value":1027},"}\n",{"type":396,"tag":404,"props":1029,"children":1030},{},[1031,1033,1039],{"type":402,"value":1032},"全局对象中每一个响应式属性(及其每一个子属性), 都应该和一个新的 Dep 实例保持一一对应的关系, 这样我们进行侦听变化, 执行订阅的回调函数时, 只需要找到对应的实例执行",{"type":396,"tag":410,"props":1034,"children":1036},{"className":1035},[],[1037],{"type":402,"value":1038},"notify",{"type":402,"value":1040},"通知更新即可.",{"type":396,"tag":397,"props":1042,"children":1044},{"id":1043},"设置响应式属性",[1045],{"type":402,"value":1043},{"type":396,"tag":1047,"props":1048,"children":1050},"h3",{"id":1049},"defineproperty",[1051],{"type":402,"value":1052},"defineProperty",{"type":396,"tag":404,"props":1054,"children":1055},{},[1056,1058,1063],{"type":402,"value":1057},"可能是因为接触 DefineProperty 要比接触 Proxy 早一些的缘故, 代码使用了前者进行响应式的实现, Object.defineProperty 方法会直接在一个对象上定义一个新属性, 这里快速过一遍",{"type":396,"tag":410,"props":1059,"children":1061},{"className":1060},[],[1062],{"type":402,"value":1052},{"type":402,"value":1064},"具体配置:",{"type":396,"tag":424,"props":1066,"children":1068},{"className":426,"code":1067,"language":428,"meta":389,"style":389},"// @param obj 要在其上定义属性的对象\n// @param key 要定义或修改的属性的名称\nObject.defineProperty(obj, key, {\n  // 该属性是否能被枚举\n  enumerable: true,\n  // 该属性能否被删除\n  configurable: true,\n  // 访问该属性则会执行此方法\n  get: () => {\n    return val\n  },\n  // 修改该属性时会执行此方法\n  set: newVal => {\n    val = newVal\n  },\n  // value & writeble 不能和 getter/setter 同时出现\n})\n",[1069],{"type":396,"tag":410,"props":1070,"children":1071},{"__ignoreMap":389},[1072,1080,1088,1126,1134,1157,1165,1185,1193,1217,1231,1239,1247,1272,1290,1298,1307],{"type":396,"tag":434,"props":1073,"children":1074},{"class":436,"line":437},[1075],{"type":396,"tag":434,"props":1076,"children":1077},{"style":441},[1078],{"type":402,"value":1079},"// @param obj 要在其上定义属性的对象\n",{"type":396,"tag":434,"props":1081,"children":1082},{"class":436,"line":447},[1083],{"type":396,"tag":434,"props":1084,"children":1085},{"style":441},[1086],{"type":402,"value":1087},"// @param key 要定义或修改的属性的名称\n",{"type":396,"tag":434,"props":1089,"children":1090},{"class":436,"line":526},[1091,1096,1100,1104,1109,1113,1118,1122],{"type":396,"tag":434,"props":1092,"children":1093},{"style":451},[1094],{"type":402,"value":1095},"Object",{"type":396,"tag":434,"props":1097,"children":1098},{"style":457},[1099],{"type":402,"value":460},{"type":396,"tag":434,"props":1101,"children":1102},{"style":463},[1103],{"type":402,"value":1052},{"type":396,"tag":434,"props":1105,"children":1106},{"style":451},[1107],{"type":402,"value":1108},"(obj",{"type":396,"tag":434,"props":1110,"children":1111},{"style":457},[1112],{"type":402,"value":492},{"type":396,"tag":434,"props":1114,"children":1115},{"style":451},[1116],{"type":402,"value":1117}," key",{"type":396,"tag":434,"props":1119,"children":1120},{"style":457},[1121],{"type":402,"value":492},{"type":396,"tag":434,"props":1123,"children":1124},{"style":457},[1125],{"type":402,"value":587},{"type":396,"tag":434,"props":1127,"children":1128},{"class":436,"line":535},[1129],{"type":396,"tag":434,"props":1130,"children":1131},{"style":441},[1132],{"type":402,"value":1133},"  // 该属性是否能被枚举\n",{"type":396,"tag":434,"props":1135,"children":1136},{"class":436,"line":590},[1137,1142,1146,1152],{"type":396,"tag":434,"props":1138,"children":1139},{"style":500},[1140],{"type":402,"value":1141},"  enumerable",{"type":396,"tag":434,"props":1143,"children":1144},{"style":457},[1145],{"type":402,"value":508},{"type":396,"tag":434,"props":1147,"children":1149},{"style":1148},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1150],{"type":402,"value":1151}," true",{"type":396,"tag":434,"props":1153,"children":1154},{"style":457},[1155],{"type":402,"value":1156},",\n",{"type":396,"tag":434,"props":1158,"children":1159},{"class":436,"line":638},[1160],{"type":396,"tag":434,"props":1161,"children":1162},{"style":441},[1163],{"type":402,"value":1164},"  // 该属性能否被删除\n",{"type":396,"tag":434,"props":1166,"children":1167},{"class":436,"line":651},[1168,1173,1177,1181],{"type":396,"tag":434,"props":1169,"children":1170},{"style":500},[1171],{"type":402,"value":1172},"  configurable",{"type":396,"tag":434,"props":1174,"children":1175},{"style":457},[1176],{"type":402,"value":508},{"type":396,"tag":434,"props":1178,"children":1179},{"style":1148},[1180],{"type":402,"value":1151},{"type":396,"tag":434,"props":1182,"children":1183},{"style":457},[1184],{"type":402,"value":1156},{"type":396,"tag":434,"props":1186,"children":1187},{"class":436,"line":905},[1188],{"type":396,"tag":434,"props":1189,"children":1190},{"style":441},[1191],{"type":402,"value":1192},"  // 访问该属性则会执行此方法\n",{"type":396,"tag":434,"props":1194,"children":1195},{"class":436,"line":914},[1196,1201,1205,1209,1213],{"type":396,"tag":434,"props":1197,"children":1198},{"style":463},[1199],{"type":402,"value":1200},"  get",{"type":396,"tag":434,"props":1202,"children":1203},{"style":457},[1204],{"type":402,"value":508},{"type":396,"tag":434,"props":1206,"children":1207},{"style":457},[1208],{"type":402,"value":784},{"type":396,"tag":434,"props":1210,"children":1211},{"style":579},[1212],{"type":402,"value":582},{"type":396,"tag":434,"props":1214,"children":1215},{"style":457},[1216],{"type":402,"value":587},{"type":396,"tag":434,"props":1218,"children":1219},{"class":436,"line":949},[1220,1226],{"type":396,"tag":434,"props":1221,"children":1223},{"style":1222},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[1224],{"type":402,"value":1225},"    return",{"type":396,"tag":434,"props":1227,"children":1228},{"style":451},[1229],{"type":402,"value":1230}," val\n",{"type":396,"tag":434,"props":1232,"children":1233},{"class":436,"line":1013},[1234],{"type":396,"tag":434,"props":1235,"children":1236},{"style":457},[1237],{"type":402,"value":1238},"  },\n",{"type":396,"tag":434,"props":1240,"children":1241},{"class":436,"line":1021},[1242],{"type":396,"tag":434,"props":1243,"children":1244},{"style":441},[1245],{"type":402,"value":1246},"  // 修改该属性时会执行此方法\n",{"type":396,"tag":434,"props":1248,"children":1250},{"class":436,"line":1249},13,[1251,1256,1260,1264,1268],{"type":396,"tag":434,"props":1252,"children":1253},{"style":463},[1254],{"type":402,"value":1255},"  set",{"type":396,"tag":434,"props":1257,"children":1258},{"style":457},[1259],{"type":402,"value":508},{"type":396,"tag":434,"props":1261,"children":1262},{"style":573},[1263],{"type":402,"value":576},{"type":396,"tag":434,"props":1265,"children":1266},{"style":579},[1267],{"type":402,"value":582},{"type":396,"tag":434,"props":1269,"children":1270},{"style":457},[1271],{"type":402,"value":587},{"type":396,"tag":434,"props":1273,"children":1275},{"class":436,"line":1274},14,[1276,1281,1285],{"type":396,"tag":434,"props":1277,"children":1278},{"style":451},[1279],{"type":402,"value":1280},"    val",{"type":396,"tag":434,"props":1282,"children":1283},{"style":687},[1284],{"type":402,"value":811},{"type":396,"tag":434,"props":1286,"children":1287},{"style":451},[1288],{"type":402,"value":1289}," newVal\n",{"type":396,"tag":434,"props":1291,"children":1293},{"class":436,"line":1292},15,[1294],{"type":396,"tag":434,"props":1295,"children":1296},{"style":457},[1297],{"type":402,"value":1238},{"type":396,"tag":434,"props":1299,"children":1301},{"class":436,"line":1300},16,[1302],{"type":396,"tag":434,"props":1303,"children":1304},{"style":441},[1305],{"type":402,"value":1306},"  // value & writeble 不能和 getter/setter 同时出现\n",{"type":396,"tag":434,"props":1308,"children":1310},{"class":436,"line":1309},17,[1311,1315],{"type":396,"tag":434,"props":1312,"children":1313},{"style":457},[1314],{"type":402,"value":644},{"type":396,"tag":434,"props":1316,"children":1317},{"style":451},[1318],{"type":402,"value":523},{"type":396,"tag":404,"props":1320,"children":1321},{},[1322],{"type":402,"value":1323},"通过对 defineProperty 进行上层封装, 我们可以轻松的实现在全局对象上设置响应式属性功能, 在此, 我们结合刚才定义的 Dep 对象, 将一个新的 dep 实例绑定到新增属性的 setter 中:",{"type":396,"tag":424,"props":1325,"children":1327},{"className":426,"code":1326,"language":428,"meta":389,"style":389},"set (key, val, options = {}, obj = this.store) {\n  const dep = new Dep()\n  Object.defineProperty(obj, key, {\n    enumerable: true,\n    configurable: true,\n    get: () => {\n      return val\n    },\n    set: newVal => {\n      if (newVal === val) {\n        return\n      }\n      dep.notify(newVal, val)\n      val = newVal\n    }\n  })\n}\n",[1328],{"type":396,"tag":410,"props":1329,"children":1330},{"__ignoreMap":389},[1331,1397,1429,1470,1490,1510,1534,1546,1554,1578,1612,1620,1628,1664,1680,1688,1700],{"type":396,"tag":434,"props":1332,"children":1333},{"class":436,"line":437},[1334,1338,1343,1347,1351,1355,1360,1364,1369,1374,1378,1383,1387,1392],{"type":396,"tag":434,"props":1335,"children":1336},{"style":463},[1337],{"type":402,"value":466},{"type":396,"tag":434,"props":1339,"children":1340},{"style":451},[1341],{"type":402,"value":1342}," (key",{"type":396,"tag":434,"props":1344,"children":1345},{"style":457},[1346],{"type":402,"value":492},{"type":396,"tag":434,"props":1348,"children":1349},{"style":451},[1350],{"type":402,"value":503},{"type":396,"tag":434,"props":1352,"children":1353},{"style":457},[1354],{"type":402,"value":492},{"type":396,"tag":434,"props":1356,"children":1357},{"style":451},[1358],{"type":402,"value":1359}," options ",{"type":396,"tag":434,"props":1361,"children":1362},{"style":687},[1363],{"type":402,"value":690},{"type":396,"tag":434,"props":1365,"children":1366},{"style":457},[1367],{"type":402,"value":1368}," {},",{"type":396,"tag":434,"props":1370,"children":1371},{"style":451},[1372],{"type":402,"value":1373}," obj ",{"type":396,"tag":434,"props":1375,"children":1376},{"style":687},[1377],{"type":402,"value":690},{"type":396,"tag":434,"props":1379,"children":1380},{"style":794},[1381],{"type":402,"value":1382}," this",{"type":396,"tag":434,"props":1384,"children":1385},{"style":457},[1386],{"type":402,"value":460},{"type":396,"tag":434,"props":1388,"children":1389},{"style":451},[1390],{"type":402,"value":1391},"store) ",{"type":396,"tag":434,"props":1393,"children":1394},{"style":457},[1395],{"type":402,"value":1396},"{\n",{"type":396,"tag":434,"props":1398,"children":1399},{"class":436,"line":447},[1400,1405,1411,1415,1420,1424],{"type":396,"tag":434,"props":1401,"children":1402},{"style":579},[1403],{"type":402,"value":1404},"  const",{"type":396,"tag":434,"props":1406,"children":1408},{"style":1407},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[1409],{"type":402,"value":1410}," dep",{"type":396,"tag":434,"props":1412,"children":1413},{"style":687},[1414],{"type":402,"value":811},{"type":396,"tag":434,"props":1416,"children":1417},{"style":687},[1418],{"type":402,"value":1419}," new",{"type":396,"tag":434,"props":1421,"children":1422},{"style":463},[1423],{"type":402,"value":767},{"type":396,"tag":434,"props":1425,"children":1426},{"style":500},[1427],{"type":402,"value":1428},"()\n",{"type":396,"tag":434,"props":1430,"children":1431},{"class":436,"line":526},[1432,1437,1441,1445,1449,1454,1458,1462,1466],{"type":396,"tag":434,"props":1433,"children":1434},{"style":451},[1435],{"type":402,"value":1436},"  Object",{"type":396,"tag":434,"props":1438,"children":1439},{"style":457},[1440],{"type":402,"value":460},{"type":396,"tag":434,"props":1442,"children":1443},{"style":463},[1444],{"type":402,"value":1052},{"type":396,"tag":434,"props":1446,"children":1447},{"style":500},[1448],{"type":402,"value":471},{"type":396,"tag":434,"props":1450,"children":1451},{"style":451},[1452],{"type":402,"value":1453},"obj",{"type":396,"tag":434,"props":1455,"children":1456},{"style":457},[1457],{"type":402,"value":492},{"type":396,"tag":434,"props":1459,"children":1460},{"style":451},[1461],{"type":402,"value":1117},{"type":396,"tag":434,"props":1463,"children":1464},{"style":457},[1465],{"type":402,"value":492},{"type":396,"tag":434,"props":1467,"children":1468},{"style":457},[1469],{"type":402,"value":587},{"type":396,"tag":434,"props":1471,"children":1472},{"class":436,"line":535},[1473,1478,1482,1486],{"type":396,"tag":434,"props":1474,"children":1475},{"style":500},[1476],{"type":402,"value":1477},"    enumerable",{"type":396,"tag":434,"props":1479,"children":1480},{"style":457},[1481],{"type":402,"value":508},{"type":396,"tag":434,"props":1483,"children":1484},{"style":1148},[1485],{"type":402,"value":1151},{"type":396,"tag":434,"props":1487,"children":1488},{"style":457},[1489],{"type":402,"value":1156},{"type":396,"tag":434,"props":1491,"children":1492},{"class":436,"line":590},[1493,1498,1502,1506],{"type":396,"tag":434,"props":1494,"children":1495},{"style":500},[1496],{"type":402,"value":1497},"    configurable",{"type":396,"tag":434,"props":1499,"children":1500},{"style":457},[1501],{"type":402,"value":508},{"type":396,"tag":434,"props":1503,"children":1504},{"style":1148},[1505],{"type":402,"value":1151},{"type":396,"tag":434,"props":1507,"children":1508},{"style":457},[1509],{"type":402,"value":1156},{"type":396,"tag":434,"props":1511,"children":1512},{"class":436,"line":638},[1513,1518,1522,1526,1530],{"type":396,"tag":434,"props":1514,"children":1515},{"style":463},[1516],{"type":402,"value":1517},"    get",{"type":396,"tag":434,"props":1519,"children":1520},{"style":457},[1521],{"type":402,"value":508},{"type":396,"tag":434,"props":1523,"children":1524},{"style":457},[1525],{"type":402,"value":784},{"type":396,"tag":434,"props":1527,"children":1528},{"style":579},[1529],{"type":402,"value":582},{"type":396,"tag":434,"props":1531,"children":1532},{"style":457},[1533],{"type":402,"value":587},{"type":396,"tag":434,"props":1535,"children":1536},{"class":436,"line":651},[1537,1542],{"type":396,"tag":434,"props":1538,"children":1539},{"style":1222},[1540],{"type":402,"value":1541},"      return",{"type":396,"tag":434,"props":1543,"children":1544},{"style":451},[1545],{"type":402,"value":1230},{"type":396,"tag":434,"props":1547,"children":1548},{"class":436,"line":905},[1549],{"type":396,"tag":434,"props":1550,"children":1551},{"style":457},[1552],{"type":402,"value":1553},"    },\n",{"type":396,"tag":434,"props":1555,"children":1556},{"class":436,"line":914},[1557,1562,1566,1570,1574],{"type":396,"tag":434,"props":1558,"children":1559},{"style":463},[1560],{"type":402,"value":1561},"    set",{"type":396,"tag":434,"props":1563,"children":1564},{"style":457},[1565],{"type":402,"value":508},{"type":396,"tag":434,"props":1567,"children":1568},{"style":573},[1569],{"type":402,"value":576},{"type":396,"tag":434,"props":1571,"children":1572},{"style":579},[1573],{"type":402,"value":582},{"type":396,"tag":434,"props":1575,"children":1576},{"style":457},[1577],{"type":402,"value":587},{"type":396,"tag":434,"props":1579,"children":1580},{"class":436,"line":949},[1581,1586,1590,1594,1599,1603,1608],{"type":396,"tag":434,"props":1582,"children":1583},{"style":1222},[1584],{"type":402,"value":1585},"      if",{"type":396,"tag":434,"props":1587,"children":1588},{"style":500},[1589],{"type":402,"value":846},{"type":396,"tag":434,"props":1591,"children":1592},{"style":451},[1593],{"type":402,"value":929},{"type":396,"tag":434,"props":1595,"children":1596},{"style":687},[1597],{"type":402,"value":1598}," ===",{"type":396,"tag":434,"props":1600,"children":1601},{"style":451},[1602],{"type":402,"value":503},{"type":396,"tag":434,"props":1604,"children":1605},{"style":500},[1606],{"type":402,"value":1607},") ",{"type":396,"tag":434,"props":1609,"children":1610},{"style":457},[1611],{"type":402,"value":1396},{"type":396,"tag":434,"props":1613,"children":1614},{"class":436,"line":1013},[1615],{"type":396,"tag":434,"props":1616,"children":1617},{"style":1222},[1618],{"type":402,"value":1619},"        return\n",{"type":396,"tag":434,"props":1621,"children":1622},{"class":436,"line":1021},[1623],{"type":396,"tag":434,"props":1624,"children":1625},{"style":457},[1626],{"type":402,"value":1627},"      }\n",{"type":396,"tag":434,"props":1629,"children":1630},{"class":436,"line":1249},[1631,1636,1640,1644,1648,1652,1656,1660],{"type":396,"tag":434,"props":1632,"children":1633},{"style":451},[1634],{"type":402,"value":1635},"      dep",{"type":396,"tag":434,"props":1637,"children":1638},{"style":457},[1639],{"type":402,"value":460},{"type":396,"tag":434,"props":1641,"children":1642},{"style":463},[1643],{"type":402,"value":1038},{"type":396,"tag":434,"props":1645,"children":1646},{"style":500},[1647],{"type":402,"value":471},{"type":396,"tag":434,"props":1649,"children":1650},{"style":451},[1651],{"type":402,"value":929},{"type":396,"tag":434,"props":1653,"children":1654},{"style":457},[1655],{"type":402,"value":492},{"type":396,"tag":434,"props":1657,"children":1658},{"style":451},[1659],{"type":402,"value":503},{"type":396,"tag":434,"props":1661,"children":1662},{"style":500},[1663],{"type":402,"value":523},{"type":396,"tag":434,"props":1665,"children":1666},{"class":436,"line":1274},[1667,1672,1676],{"type":396,"tag":434,"props":1668,"children":1669},{"style":451},[1670],{"type":402,"value":1671},"      val",{"type":396,"tag":434,"props":1673,"children":1674},{"style":687},[1675],{"type":402,"value":811},{"type":396,"tag":434,"props":1677,"children":1678},{"style":451},[1679],{"type":402,"value":1289},{"type":396,"tag":434,"props":1681,"children":1682},{"class":436,"line":1292},[1683],{"type":396,"tag":434,"props":1684,"children":1685},{"style":457},[1686],{"type":402,"value":1687},"    }\n",{"type":396,"tag":434,"props":1689,"children":1690},{"class":436,"line":1300},[1691,1696],{"type":396,"tag":434,"props":1692,"children":1693},{"style":457},[1694],{"type":402,"value":1695},"  }",{"type":396,"tag":434,"props":1697,"children":1698},{"style":500},[1699],{"type":402,"value":523},{"type":396,"tag":434,"props":1701,"children":1702},{"class":436,"line":1309},[1703],{"type":396,"tag":434,"props":1704,"children":1705},{"style":457},[1706],{"type":402,"value":1027},{"type":396,"tag":404,"props":1708,"children":1709},{},[1710],{"type":402,"value":1711},"每当对应属性被赋值, 就会执行依赖数组中的回调函数.",{"type":396,"tag":404,"props":1713,"children":1714},{},[1715],{"type":402,"value":1716},"不过这样还不够, 我们还得想办法获取到这个 dep 实例, 才能给它的依赖数组填充函数.",{"type":396,"tag":404,"props":1718,"children":1719},{},[1720],{"type":402,"value":1721},"这边提供一个很简单的思路, 并不推荐实践中这么做:",{"type":396,"tag":424,"props":1723,"children":1725},{"className":426,"code":1724,"language":428,"meta":389,"style":389},"set (key, val, options = {}, obj = this.store) {\n  const dep = new Dep()\n  Object.defineProperty(obj, key, {})\n  return dep\n}\n",[1726],{"type":396,"tag":410,"props":1727,"children":1728},{"__ignoreMap":389},[1729,1788,1815,1859,1872],{"type":396,"tag":434,"props":1730,"children":1731},{"class":436,"line":437},[1732,1736,1740,1744,1748,1752,1756,1760,1764,1768,1772,1776,1780,1784],{"type":396,"tag":434,"props":1733,"children":1734},{"style":463},[1735],{"type":402,"value":466},{"type":396,"tag":434,"props":1737,"children":1738},{"style":451},[1739],{"type":402,"value":1342},{"type":396,"tag":434,"props":1741,"children":1742},{"style":457},[1743],{"type":402,"value":492},{"type":396,"tag":434,"props":1745,"children":1746},{"style":451},[1747],{"type":402,"value":503},{"type":396,"tag":434,"props":1749,"children":1750},{"style":457},[1751],{"type":402,"value":492},{"type":396,"tag":434,"props":1753,"children":1754},{"style":451},[1755],{"type":402,"value":1359},{"type":396,"tag":434,"props":1757,"children":1758},{"style":687},[1759],{"type":402,"value":690},{"type":396,"tag":434,"props":1761,"children":1762},{"style":457},[1763],{"type":402,"value":1368},{"type":396,"tag":434,"props":1765,"children":1766},{"style":451},[1767],{"type":402,"value":1373},{"type":396,"tag":434,"props":1769,"children":1770},{"style":687},[1771],{"type":402,"value":690},{"type":396,"tag":434,"props":1773,"children":1774},{"style":794},[1775],{"type":402,"value":1382},{"type":396,"tag":434,"props":1777,"children":1778},{"style":457},[1779],{"type":402,"value":460},{"type":396,"tag":434,"props":1781,"children":1782},{"style":451},[1783],{"type":402,"value":1391},{"type":396,"tag":434,"props":1785,"children":1786},{"style":457},[1787],{"type":402,"value":1396},{"type":396,"tag":434,"props":1789,"children":1790},{"class":436,"line":447},[1791,1795,1799,1803,1807,1811],{"type":396,"tag":434,"props":1792,"children":1793},{"style":579},[1794],{"type":402,"value":1404},{"type":396,"tag":434,"props":1796,"children":1797},{"style":1407},[1798],{"type":402,"value":1410},{"type":396,"tag":434,"props":1800,"children":1801},{"style":687},[1802],{"type":402,"value":811},{"type":396,"tag":434,"props":1804,"children":1805},{"style":687},[1806],{"type":402,"value":1419},{"type":396,"tag":434,"props":1808,"children":1809},{"style":463},[1810],{"type":402,"value":767},{"type":396,"tag":434,"props":1812,"children":1813},{"style":500},[1814],{"type":402,"value":1428},{"type":396,"tag":434,"props":1816,"children":1817},{"class":436,"line":526},[1818,1822,1826,1830,1834,1838,1842,1846,1850,1855],{"type":396,"tag":434,"props":1819,"children":1820},{"style":451},[1821],{"type":402,"value":1436},{"type":396,"tag":434,"props":1823,"children":1824},{"style":457},[1825],{"type":402,"value":460},{"type":396,"tag":434,"props":1827,"children":1828},{"style":463},[1829],{"type":402,"value":1052},{"type":396,"tag":434,"props":1831,"children":1832},{"style":500},[1833],{"type":402,"value":471},{"type":396,"tag":434,"props":1835,"children":1836},{"style":451},[1837],{"type":402,"value":1453},{"type":396,"tag":434,"props":1839,"children":1840},{"style":457},[1841],{"type":402,"value":492},{"type":396,"tag":434,"props":1843,"children":1844},{"style":451},[1845],{"type":402,"value":1117},{"type":396,"tag":434,"props":1847,"children":1848},{"style":457},[1849],{"type":402,"value":492},{"type":396,"tag":434,"props":1851,"children":1852},{"style":457},[1853],{"type":402,"value":1854}," {}",{"type":396,"tag":434,"props":1856,"children":1857},{"style":500},[1858],{"type":402,"value":523},{"type":396,"tag":434,"props":1860,"children":1861},{"class":436,"line":535},[1862,1867],{"type":396,"tag":434,"props":1863,"children":1864},{"style":1222},[1865],{"type":402,"value":1866},"  return",{"type":396,"tag":434,"props":1868,"children":1869},{"style":451},[1870],{"type":402,"value":1871}," dep\n",{"type":396,"tag":434,"props":1873,"children":1874},{"class":436,"line":590},[1875],{"type":396,"tag":434,"props":1876,"children":1877},{"style":457},[1878],{"type":402,"value":1027},{"type":396,"tag":424,"props":1880,"children":1882},{"className":426,"code":1881,"language":428,"meta":389,"style":389},"const valueDep = set('value', b, {})\nvalueDep.addSub(() => { console.log('value changed!') })\n",[1883],{"type":396,"tag":410,"props":1884,"children":1885},{"__ignoreMap":389},[1886,1945],{"type":396,"tag":434,"props":1887,"children":1888},{"class":436,"line":437},[1889,1894,1899,1903,1908,1912,1916,1920,1924,1928,1933,1937,1941],{"type":396,"tag":434,"props":1890,"children":1891},{"style":579},[1892],{"type":402,"value":1893},"const",{"type":396,"tag":434,"props":1895,"children":1896},{"style":1407},[1897],{"type":402,"value":1898}," valueDep",{"type":396,"tag":434,"props":1900,"children":1901},{"style":687},[1902],{"type":402,"value":811},{"type":396,"tag":434,"props":1904,"children":1905},{"style":463},[1906],{"type":402,"value":1907}," set",{"type":396,"tag":434,"props":1909,"children":1910},{"style":451},[1911],{"type":402,"value":471},{"type":396,"tag":434,"props":1913,"children":1914},{"style":474},[1915],{"type":402,"value":477},{"type":396,"tag":434,"props":1917,"children":1918},{"style":480},[1919],{"type":402,"value":657},{"type":396,"tag":434,"props":1921,"children":1922},{"style":474},[1923],{"type":402,"value":477},{"type":396,"tag":434,"props":1925,"children":1926},{"style":457},[1927],{"type":402,"value":492},{"type":396,"tag":434,"props":1929,"children":1930},{"style":451},[1931],{"type":402,"value":1932}," b",{"type":396,"tag":434,"props":1934,"children":1935},{"style":457},[1936],{"type":402,"value":492},{"type":396,"tag":434,"props":1938,"children":1939},{"style":457},[1940],{"type":402,"value":1854},{"type":396,"tag":434,"props":1942,"children":1943},{"style":451},[1944],{"type":402,"value":523},{"type":396,"tag":434,"props":1946,"children":1947},{"class":436,"line":447},[1948,1953,1957,1962,1966,1971,1975,1979,1984,1988,1992,1996,2000,2005,2009,2013,2017],{"type":396,"tag":434,"props":1949,"children":1950},{"style":451},[1951],{"type":402,"value":1952},"valueDep",{"type":396,"tag":434,"props":1954,"children":1955},{"style":457},[1956],{"type":402,"value":460},{"type":396,"tag":434,"props":1958,"children":1959},{"style":463},[1960],{"type":402,"value":1961},"addSub",{"type":396,"tag":434,"props":1963,"children":1964},{"style":451},[1965],{"type":402,"value":471},{"type":396,"tag":434,"props":1967,"children":1968},{"style":457},[1969],{"type":402,"value":1970},"()",{"type":396,"tag":434,"props":1972,"children":1973},{"style":579},[1974],{"type":402,"value":582},{"type":396,"tag":434,"props":1976,"children":1977},{"style":457},[1978],{"type":402,"value":497},{"type":396,"tag":434,"props":1980,"children":1981},{"style":451},[1982],{"type":402,"value":1983}," console",{"type":396,"tag":434,"props":1985,"children":1986},{"style":457},[1987],{"type":402,"value":460},{"type":396,"tag":434,"props":1989,"children":1990},{"style":463},[1991],{"type":402,"value":605},{"type":396,"tag":434,"props":1993,"children":1994},{"style":500},[1995],{"type":402,"value":471},{"type":396,"tag":434,"props":1997,"children":1998},{"style":474},[1999],{"type":402,"value":477},{"type":396,"tag":434,"props":2001,"children":2002},{"style":480},[2003],{"type":402,"value":2004},"value changed!",{"type":396,"tag":434,"props":2006,"children":2007},{"style":474},[2008],{"type":402,"value":477},{"type":396,"tag":434,"props":2010,"children":2011},{"style":500},[2012],{"type":402,"value":1607},{"type":396,"tag":434,"props":2014,"children":2015},{"style":457},[2016],{"type":402,"value":644},{"type":396,"tag":434,"props":2018,"children":2019},{"style":451},[2020],{"type":402,"value":523},{"type":396,"tag":404,"props":2022,"children":2023},{},[2024],{"type":402,"value":2025},"虽然代码能使用了, 就是是看起来怪怪的~ 😋 我们的三轮车开进了岔路~",{"type":396,"tag":397,"props":2027,"children":2029},{"id":2028},"通过-watch-添加订阅",[2030],{"type":402,"value":2031},"通过 watch 添加订阅",{"type":396,"tag":1047,"props":2033,"children":2035},{"id":2034},"喝口水我们继续",[2036],{"type":402,"value":2034},{"type":396,"tag":404,"props":2038,"children":2039},{},[2040],{"type":402,"value":2041},"《黑客与画家》中曾经提到这样一个观点, 我深有体会:",{"type":396,"tag":2043,"props":2044,"children":2045},"blockquote",{},[2046],{"type":396,"tag":404,"props":2047,"children":2048},{},[2049],{"type":402,"value":2050},"如果你觉得你的代码奇怪, 那么往往它是错的",{"type":396,"tag":404,"props":2052,"children":2053},{},[2054],{"type":402,"value":2055},"上面的那一串代码仅仅是能跑通的水平, 我们需要加入更多的细节和思考, 有时候只需要坐下来稍微看一下代码, 就会有各种想法蹦出来:",{"type":396,"tag":2043,"props":2057,"children":2058},{},[2059],{"type":396,"tag":404,"props":2060,"children":2061},{},[2062],{"type":402,"value":2063},"构思这种东西有一个特点，那就是它会导致更多的构思。你有没有注意过，坐下来写东西的时候，一半的构思是写作时产生的？",{"type":396,"tag":1047,"props":2065,"children":2067},{"id":2066},"隐藏-dep",[2068],{"type":402,"value":2069},"隐藏 Dep",{"type":396,"tag":404,"props":2071,"children":2072},{},[2073],{"type":402,"value":2074},"这些内容应和外部是解耦的. 首先一点, 我们创建一个侦听器类, 用于封装我们侦听所用到的所有方法, 它包含了我们想要的全局对象以及操作它的方法(如 watch,set):",{"type":396,"tag":424,"props":2076,"children":2078},{"className":426,"code":2077,"language":428,"meta":389,"style":389},"class VX {\n  constructor () {\n    this.store = Object.create(null)\n  }\n  watch (key, fn, obj = this.store) {}\n  set (key, val, options = {}, obj = this.store) {}\n}\nconst vx = new VX()\n",[2079],{"type":396,"tag":410,"props":2080,"children":2081},{"__ignoreMap":389},[2082,2098,2113,2161,2168,2228,2296,2303],{"type":396,"tag":434,"props":2083,"children":2084},{"class":436,"line":437},[2085,2089,2094],{"type":396,"tag":434,"props":2086,"children":2087},{"style":579},[2088],{"type":402,"value":761},{"type":396,"tag":434,"props":2090,"children":2091},{"style":764},[2092],{"type":402,"value":2093}," VX",{"type":396,"tag":434,"props":2095,"children":2096},{"style":457},[2097],{"type":402,"value":587},{"type":396,"tag":434,"props":2099,"children":2100},{"class":436,"line":447},[2101,2105,2109],{"type":396,"tag":434,"props":2102,"children":2103},{"style":579},[2104],{"type":402,"value":779},{"type":396,"tag":434,"props":2106,"children":2107},{"style":457},[2108],{"type":402,"value":784},{"type":396,"tag":434,"props":2110,"children":2111},{"style":457},[2112],{"type":402,"value":587},{"type":396,"tag":434,"props":2114,"children":2115},{"class":436,"line":526},[2116,2120,2124,2129,2133,2138,2142,2147,2151,2157],{"type":396,"tag":434,"props":2117,"children":2118},{"style":794},[2119],{"type":402,"value":797},{"type":396,"tag":434,"props":2121,"children":2122},{"style":457},[2123],{"type":402,"value":460},{"type":396,"tag":434,"props":2125,"children":2126},{"style":451},[2127],{"type":402,"value":2128},"store",{"type":396,"tag":434,"props":2130,"children":2131},{"style":687},[2132],{"type":402,"value":811},{"type":396,"tag":434,"props":2134,"children":2135},{"style":451},[2136],{"type":402,"value":2137}," Object",{"type":396,"tag":434,"props":2139,"children":2140},{"style":457},[2141],{"type":402,"value":460},{"type":396,"tag":434,"props":2143,"children":2144},{"style":463},[2145],{"type":402,"value":2146},"create",{"type":396,"tag":434,"props":2148,"children":2149},{"style":500},[2150],{"type":402,"value":471},{"type":396,"tag":434,"props":2152,"children":2154},{"style":2153},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[2155],{"type":402,"value":2156},"null",{"type":396,"tag":434,"props":2158,"children":2159},{"style":500},[2160],{"type":402,"value":523},{"type":396,"tag":434,"props":2162,"children":2163},{"class":436,"line":535},[2164],{"type":396,"tag":434,"props":2165,"children":2166},{"style":457},[2167],{"type":402,"value":824},{"type":396,"tag":434,"props":2169,"children":2170},{"class":436,"line":590},[2171,2176,2180,2185,2189,2194,2198,2203,2207,2211,2215,2219,2223],{"type":396,"tag":434,"props":2172,"children":2173},{"style":838},[2174],{"type":402,"value":2175},"  watch",{"type":396,"tag":434,"props":2177,"children":2178},{"style":457},[2179],{"type":402,"value":846},{"type":396,"tag":434,"props":2181,"children":2182},{"style":573},[2183],{"type":402,"value":2184},"key",{"type":396,"tag":434,"props":2186,"children":2187},{"style":457},[2188],{"type":402,"value":492},{"type":396,"tag":434,"props":2190,"children":2191},{"style":573},[2192],{"type":402,"value":2193}," fn",{"type":396,"tag":434,"props":2195,"children":2196},{"style":457},[2197],{"type":402,"value":492},{"type":396,"tag":434,"props":2199,"children":2200},{"style":573},[2201],{"type":402,"value":2202}," obj",{"type":396,"tag":434,"props":2204,"children":2205},{"style":687},[2206],{"type":402,"value":811},{"type":396,"tag":434,"props":2208,"children":2209},{"style":794},[2210],{"type":402,"value":1382},{"type":396,"tag":434,"props":2212,"children":2213},{"style":457},[2214],{"type":402,"value":460},{"type":396,"tag":434,"props":2216,"children":2217},{"style":451},[2218],{"type":402,"value":2128},{"type":396,"tag":434,"props":2220,"children":2221},{"style":457},[2222],{"type":402,"value":856},{"type":396,"tag":434,"props":2224,"children":2225},{"style":457},[2226],{"type":402,"value":2227}," {}\n",{"type":396,"tag":434,"props":2229,"children":2230},{"class":436,"line":638},[2231,2235,2239,2243,2247,2251,2255,2260,2264,2268,2272,2276,2280,2284,2288,2292],{"type":396,"tag":434,"props":2232,"children":2233},{"style":838},[2234],{"type":402,"value":1255},{"type":396,"tag":434,"props":2236,"children":2237},{"style":457},[2238],{"type":402,"value":846},{"type":396,"tag":434,"props":2240,"children":2241},{"style":573},[2242],{"type":402,"value":2184},{"type":396,"tag":434,"props":2244,"children":2245},{"style":457},[2246],{"type":402,"value":492},{"type":396,"tag":434,"props":2248,"children":2249},{"style":573},[2250],{"type":402,"value":503},{"type":396,"tag":434,"props":2252,"children":2253},{"style":457},[2254],{"type":402,"value":492},{"type":396,"tag":434,"props":2256,"children":2257},{"style":573},[2258],{"type":402,"value":2259}," options",{"type":396,"tag":434,"props":2261,"children":2262},{"style":687},[2263],{"type":402,"value":811},{"type":396,"tag":434,"props":2265,"children":2266},{"style":457},[2267],{"type":402,"value":1368},{"type":396,"tag":434,"props":2269,"children":2270},{"style":573},[2271],{"type":402,"value":2202},{"type":396,"tag":434,"props":2273,"children":2274},{"style":687},[2275],{"type":402,"value":811},{"type":396,"tag":434,"props":2277,"children":2278},{"style":794},[2279],{"type":402,"value":1382},{"type":396,"tag":434,"props":2281,"children":2282},{"style":457},[2283],{"type":402,"value":460},{"type":396,"tag":434,"props":2285,"children":2286},{"style":451},[2287],{"type":402,"value":2128},{"type":396,"tag":434,"props":2289,"children":2290},{"style":457},[2291],{"type":402,"value":856},{"type":396,"tag":434,"props":2293,"children":2294},{"style":457},[2295],{"type":402,"value":2227},{"type":396,"tag":434,"props":2297,"children":2298},{"class":436,"line":651},[2299],{"type":396,"tag":434,"props":2300,"children":2301},{"style":457},[2302],{"type":402,"value":1027},{"type":396,"tag":434,"props":2304,"children":2305},{"class":436,"line":905},[2306,2310,2315,2319,2323,2327],{"type":396,"tag":434,"props":2307,"children":2308},{"style":579},[2309],{"type":402,"value":1893},{"type":396,"tag":434,"props":2311,"children":2312},{"style":1407},[2313],{"type":402,"value":2314}," vx",{"type":396,"tag":434,"props":2316,"children":2317},{"style":687},[2318],{"type":402,"value":811},{"type":396,"tag":434,"props":2320,"children":2321},{"style":687},[2322],{"type":402,"value":1419},{"type":396,"tag":434,"props":2324,"children":2325},{"style":463},[2326],{"type":402,"value":2093},{"type":396,"tag":434,"props":2328,"children":2329},{"style":451},[2330],{"type":402,"value":1428},{"type":396,"tag":404,"props":2332,"children":2333},{},[2334],{"type":402,"value":2335},"我们可以在 watch 中给对象某个属性添加回调, 就不用去直接操作 Dep 依赖数组了. 只是, 我们在业务代码中调用 watch, 要怎么去获取 obj.key 对应的 dep 呢?",{"type":396,"tag":404,"props":2337,"children":2338},{},[2339],{"type":402,"value":2340},"我们设置一个全局的 depHandler, 在 obj.key 的 getter 中主动将 depHandler 设置为当前 obj.key 的 dep 实例, 那么我们在 watch 函数里, 只要用任意操作触发 obj.key 的 getter, 就能通过 depHandler 得到它的 dep 实例了, 代码形如:",{"type":396,"tag":424,"props":2342,"children":2344},{"className":426,"code":2343,"language":428,"meta":389,"style":389},"  // 一开始没有持有dep实例\n  let handleDep = null\n  class VX {\n    watch (key, fn, obj = this.store) {\n      console.log(obj.key) // 使用任意操作触发obj.key的getter, 那么handleDep将自动引用obj.key的dep实例\n      handleDep.addSub(fn)\n    }\n    set (key, val, options = {}, obj = this.store) {\n      const dep = new Dep()\n      Object.defineProperty(obj, key, {\n        enumerable: true,\n        configurable: true,\n        get: () => {\n          handleDep = dep\n          return val\n        },\n        set: newVal => {}\n      })\n    }\n  }\n",[2345],{"type":396,"tag":410,"props":2346,"children":2347},{"__ignoreMap":389},[2348,2356,2378,2394,2450,2491,2519,2526,2593,2621,2661,2681,2701,2725,2741,2753,2761,2785,2798,2806],{"type":396,"tag":434,"props":2349,"children":2350},{"class":436,"line":437},[2351],{"type":396,"tag":434,"props":2352,"children":2353},{"style":441},[2354],{"type":402,"value":2355},"  // 一开始没有持有dep实例\n",{"type":396,"tag":434,"props":2357,"children":2358},{"class":436,"line":447},[2359,2364,2369,2373],{"type":396,"tag":434,"props":2360,"children":2361},{"style":579},[2362],{"type":402,"value":2363},"  let",{"type":396,"tag":434,"props":2365,"children":2366},{"style":451},[2367],{"type":402,"value":2368}," handleDep ",{"type":396,"tag":434,"props":2370,"children":2371},{"style":687},[2372],{"type":402,"value":690},{"type":396,"tag":434,"props":2374,"children":2375},{"style":2153},[2376],{"type":402,"value":2377}," null\n",{"type":396,"tag":434,"props":2379,"children":2380},{"class":436,"line":526},[2381,2386,2390],{"type":396,"tag":434,"props":2382,"children":2383},{"style":579},[2384],{"type":402,"value":2385},"  class",{"type":396,"tag":434,"props":2387,"children":2388},{"style":764},[2389],{"type":402,"value":2093},{"type":396,"tag":434,"props":2391,"children":2392},{"style":457},[2393],{"type":402,"value":587},{"type":396,"tag":434,"props":2395,"children":2396},{"class":436,"line":535},[2397,2402,2406,2410,2414,2418,2422,2426,2430,2434,2438,2442,2446],{"type":396,"tag":434,"props":2398,"children":2399},{"style":838},[2400],{"type":402,"value":2401},"    watch",{"type":396,"tag":434,"props":2403,"children":2404},{"style":457},[2405],{"type":402,"value":846},{"type":396,"tag":434,"props":2407,"children":2408},{"style":573},[2409],{"type":402,"value":2184},{"type":396,"tag":434,"props":2411,"children":2412},{"style":457},[2413],{"type":402,"value":492},{"type":396,"tag":434,"props":2415,"children":2416},{"style":573},[2417],{"type":402,"value":2193},{"type":396,"tag":434,"props":2419,"children":2420},{"style":457},[2421],{"type":402,"value":492},{"type":396,"tag":434,"props":2423,"children":2424},{"style":573},[2425],{"type":402,"value":2202},{"type":396,"tag":434,"props":2427,"children":2428},{"style":687},[2429],{"type":402,"value":811},{"type":396,"tag":434,"props":2431,"children":2432},{"style":794},[2433],{"type":402,"value":1382},{"type":396,"tag":434,"props":2435,"children":2436},{"style":457},[2437],{"type":402,"value":460},{"type":396,"tag":434,"props":2439,"children":2440},{"style":451},[2441],{"type":402,"value":2128},{"type":396,"tag":434,"props":2443,"children":2444},{"style":457},[2445],{"type":402,"value":856},{"type":396,"tag":434,"props":2447,"children":2448},{"style":457},[2449],{"type":402,"value":587},{"type":396,"tag":434,"props":2451,"children":2452},{"class":436,"line":590},[2453,2458,2462,2466,2470,2474,2478,2482,2486],{"type":396,"tag":434,"props":2454,"children":2455},{"style":451},[2456],{"type":402,"value":2457},"      console",{"type":396,"tag":434,"props":2459,"children":2460},{"style":457},[2461],{"type":402,"value":460},{"type":396,"tag":434,"props":2463,"children":2464},{"style":463},[2465],{"type":402,"value":605},{"type":396,"tag":434,"props":2467,"children":2468},{"style":500},[2469],{"type":402,"value":471},{"type":396,"tag":434,"props":2471,"children":2472},{"style":451},[2473],{"type":402,"value":1453},{"type":396,"tag":434,"props":2475,"children":2476},{"style":457},[2477],{"type":402,"value":460},{"type":396,"tag":434,"props":2479,"children":2480},{"style":451},[2481],{"type":402,"value":2184},{"type":396,"tag":434,"props":2483,"children":2484},{"style":500},[2485],{"type":402,"value":1607},{"type":396,"tag":434,"props":2487,"children":2488},{"style":441},[2489],{"type":402,"value":2490},"// 使用任意操作触发obj.key的getter, 那么handleDep将自动引用obj.key的dep实例\n",{"type":396,"tag":434,"props":2492,"children":2493},{"class":436,"line":638},[2494,2499,2503,2507,2511,2515],{"type":396,"tag":434,"props":2495,"children":2496},{"style":451},[2497],{"type":402,"value":2498},"      handleDep",{"type":396,"tag":434,"props":2500,"children":2501},{"style":457},[2502],{"type":402,"value":460},{"type":396,"tag":434,"props":2504,"children":2505},{"style":463},[2506],{"type":402,"value":1961},{"type":396,"tag":434,"props":2508,"children":2509},{"style":500},[2510],{"type":402,"value":471},{"type":396,"tag":434,"props":2512,"children":2513},{"style":451},[2514],{"type":402,"value":851},{"type":396,"tag":434,"props":2516,"children":2517},{"style":500},[2518],{"type":402,"value":523},{"type":396,"tag":434,"props":2520,"children":2521},{"class":436,"line":651},[2522],{"type":396,"tag":434,"props":2523,"children":2524},{"style":457},[2525],{"type":402,"value":1687},{"type":396,"tag":434,"props":2527,"children":2528},{"class":436,"line":905},[2529,2533,2537,2541,2545,2549,2553,2557,2561,2565,2569,2573,2577,2581,2585,2589],{"type":396,"tag":434,"props":2530,"children":2531},{"style":838},[2532],{"type":402,"value":1561},{"type":396,"tag":434,"props":2534,"children":2535},{"style":457},[2536],{"type":402,"value":846},{"type":396,"tag":434,"props":2538,"children":2539},{"style":573},[2540],{"type":402,"value":2184},{"type":396,"tag":434,"props":2542,"children":2543},{"style":457},[2544],{"type":402,"value":492},{"type":396,"tag":434,"props":2546,"children":2547},{"style":573},[2548],{"type":402,"value":503},{"type":396,"tag":434,"props":2550,"children":2551},{"style":457},[2552],{"type":402,"value":492},{"type":396,"tag":434,"props":2554,"children":2555},{"style":573},[2556],{"type":402,"value":2259},{"type":396,"tag":434,"props":2558,"children":2559},{"style":687},[2560],{"type":402,"value":811},{"type":396,"tag":434,"props":2562,"children":2563},{"style":457},[2564],{"type":402,"value":1368},{"type":396,"tag":434,"props":2566,"children":2567},{"style":573},[2568],{"type":402,"value":2202},{"type":396,"tag":434,"props":2570,"children":2571},{"style":687},[2572],{"type":402,"value":811},{"type":396,"tag":434,"props":2574,"children":2575},{"style":794},[2576],{"type":402,"value":1382},{"type":396,"tag":434,"props":2578,"children":2579},{"style":457},[2580],{"type":402,"value":460},{"type":396,"tag":434,"props":2582,"children":2583},{"style":451},[2584],{"type":402,"value":2128},{"type":396,"tag":434,"props":2586,"children":2587},{"style":457},[2588],{"type":402,"value":856},{"type":396,"tag":434,"props":2590,"children":2591},{"style":457},[2592],{"type":402,"value":587},{"type":396,"tag":434,"props":2594,"children":2595},{"class":436,"line":914},[2596,2601,2605,2609,2613,2617],{"type":396,"tag":434,"props":2597,"children":2598},{"style":579},[2599],{"type":402,"value":2600},"      const",{"type":396,"tag":434,"props":2602,"children":2603},{"style":1407},[2604],{"type":402,"value":1410},{"type":396,"tag":434,"props":2606,"children":2607},{"style":687},[2608],{"type":402,"value":811},{"type":396,"tag":434,"props":2610,"children":2611},{"style":687},[2612],{"type":402,"value":1419},{"type":396,"tag":434,"props":2614,"children":2615},{"style":463},[2616],{"type":402,"value":767},{"type":396,"tag":434,"props":2618,"children":2619},{"style":500},[2620],{"type":402,"value":1428},{"type":396,"tag":434,"props":2622,"children":2623},{"class":436,"line":949},[2624,2629,2633,2637,2641,2645,2649,2653,2657],{"type":396,"tag":434,"props":2625,"children":2626},{"style":451},[2627],{"type":402,"value":2628},"      Object",{"type":396,"tag":434,"props":2630,"children":2631},{"style":457},[2632],{"type":402,"value":460},{"type":396,"tag":434,"props":2634,"children":2635},{"style":463},[2636],{"type":402,"value":1052},{"type":396,"tag":434,"props":2638,"children":2639},{"style":500},[2640],{"type":402,"value":471},{"type":396,"tag":434,"props":2642,"children":2643},{"style":451},[2644],{"type":402,"value":1453},{"type":396,"tag":434,"props":2646,"children":2647},{"style":457},[2648],{"type":402,"value":492},{"type":396,"tag":434,"props":2650,"children":2651},{"style":451},[2652],{"type":402,"value":1117},{"type":396,"tag":434,"props":2654,"children":2655},{"style":457},[2656],{"type":402,"value":492},{"type":396,"tag":434,"props":2658,"children":2659},{"style":457},[2660],{"type":402,"value":587},{"type":396,"tag":434,"props":2662,"children":2663},{"class":436,"line":1013},[2664,2669,2673,2677],{"type":396,"tag":434,"props":2665,"children":2666},{"style":500},[2667],{"type":402,"value":2668},"        enumerable",{"type":396,"tag":434,"props":2670,"children":2671},{"style":457},[2672],{"type":402,"value":508},{"type":396,"tag":434,"props":2674,"children":2675},{"style":1148},[2676],{"type":402,"value":1151},{"type":396,"tag":434,"props":2678,"children":2679},{"style":457},[2680],{"type":402,"value":1156},{"type":396,"tag":434,"props":2682,"children":2683},{"class":436,"line":1021},[2684,2689,2693,2697],{"type":396,"tag":434,"props":2685,"children":2686},{"style":500},[2687],{"type":402,"value":2688},"        configurable",{"type":396,"tag":434,"props":2690,"children":2691},{"style":457},[2692],{"type":402,"value":508},{"type":396,"tag":434,"props":2694,"children":2695},{"style":1148},[2696],{"type":402,"value":1151},{"type":396,"tag":434,"props":2698,"children":2699},{"style":457},[2700],{"type":402,"value":1156},{"type":396,"tag":434,"props":2702,"children":2703},{"class":436,"line":1249},[2704,2709,2713,2717,2721],{"type":396,"tag":434,"props":2705,"children":2706},{"style":463},[2707],{"type":402,"value":2708},"        get",{"type":396,"tag":434,"props":2710,"children":2711},{"style":457},[2712],{"type":402,"value":508},{"type":396,"tag":434,"props":2714,"children":2715},{"style":457},[2716],{"type":402,"value":784},{"type":396,"tag":434,"props":2718,"children":2719},{"style":579},[2720],{"type":402,"value":582},{"type":396,"tag":434,"props":2722,"children":2723},{"style":457},[2724],{"type":402,"value":587},{"type":396,"tag":434,"props":2726,"children":2727},{"class":436,"line":1274},[2728,2733,2737],{"type":396,"tag":434,"props":2729,"children":2730},{"style":451},[2731],{"type":402,"value":2732},"          handleDep",{"type":396,"tag":434,"props":2734,"children":2735},{"style":687},[2736],{"type":402,"value":811},{"type":396,"tag":434,"props":2738,"children":2739},{"style":451},[2740],{"type":402,"value":1871},{"type":396,"tag":434,"props":2742,"children":2743},{"class":436,"line":1292},[2744,2749],{"type":396,"tag":434,"props":2745,"children":2746},{"style":1222},[2747],{"type":402,"value":2748},"          return",{"type":396,"tag":434,"props":2750,"children":2751},{"style":451},[2752],{"type":402,"value":1230},{"type":396,"tag":434,"props":2754,"children":2755},{"class":436,"line":1300},[2756],{"type":396,"tag":434,"props":2757,"children":2758},{"style":457},[2759],{"type":402,"value":2760},"        },\n",{"type":396,"tag":434,"props":2762,"children":2763},{"class":436,"line":1309},[2764,2769,2773,2777,2781],{"type":396,"tag":434,"props":2765,"children":2766},{"style":463},[2767],{"type":402,"value":2768},"        set",{"type":396,"tag":434,"props":2770,"children":2771},{"style":457},[2772],{"type":402,"value":508},{"type":396,"tag":434,"props":2774,"children":2775},{"style":573},[2776],{"type":402,"value":576},{"type":396,"tag":434,"props":2778,"children":2779},{"style":579},[2780],{"type":402,"value":582},{"type":396,"tag":434,"props":2782,"children":2783},{"style":457},[2784],{"type":402,"value":2227},{"type":396,"tag":434,"props":2786,"children":2788},{"class":436,"line":2787},18,[2789,2794],{"type":396,"tag":434,"props":2790,"children":2791},{"style":457},[2792],{"type":402,"value":2793},"      }",{"type":396,"tag":434,"props":2795,"children":2796},{"style":500},[2797],{"type":402,"value":523},{"type":396,"tag":434,"props":2799,"children":2801},{"class":436,"line":2800},19,[2802],{"type":396,"tag":434,"props":2803,"children":2804},{"style":457},[2805],{"type":402,"value":1687},{"type":396,"tag":434,"props":2807,"children":2809},{"class":436,"line":2808},20,[2810],{"type":396,"tag":434,"props":2811,"children":2812},{"style":457},[2813],{"type":402,"value":824},{"type":396,"tag":1047,"props":2815,"children":2817},{"id":2816},"主动收集依赖",[2818],{"type":402,"value":2816},{"type":396,"tag":404,"props":2820,"children":2821},{},[2822,2824,2830,2832,2838,2840,2846],{"type":402,"value":2823},"我们增加",{"type":396,"tag":410,"props":2825,"children":2827},{"className":2826},[],[2828],{"type":402,"value":2829},"handleDep.addSub(fn)",{"type":402,"value":2831},"添加回调函数的逻辑, 其实可以直接放到 getter 中, 首先在 Dep 类中封装一个'主动'收集依赖的",{"type":396,"tag":410,"props":2833,"children":2835},{"className":2834},[],[2836],{"type":402,"value":2837},"collect",{"type":402,"value":2839},"方法, 他会将全局",{"type":396,"tag":410,"props":2841,"children":2843},{"className":2842},[],[2844],{"type":402,"value":2845},"handleFn",{"type":402,"value":2847},"存放到订阅数组中, 这样一来, 在 watch 函数中, 我们只要触发 obj.key 的 getter, 就可以主动收集依赖了:",{"type":396,"tag":424,"props":2849,"children":2851},{"className":426,"code":2850,"language":428,"meta":389,"style":389},"let handleFn = null\nclass Dep {\n  addSub (fn) {}\n  delSub (fn) {}\n  clear () {}\n  collect (fn = handleFn) {\n    if (fn && !this.subs.find(x => x === fn)) {\n      this.addSub(fn)\n    }\n  }\n  notify (newVal, oldVal) {}\n}\n\nlet handleDep = null\nclass VX {\n  watch (key, fn, obj = this.store) {\n    handleFn = fn\n    console.log(obj.key)\n  }\n  set (key, val, options = {}, obj = this.store) {\n    const dep = new Dep()\n    Object.defineProperty(obj, key, {\n      enumerable: true,\n      configurable: true,\n      get: () => {\n        handleDep = dep\n        handleDep.collect()\n        return val\n      },\n      set: newVal => {}\n    })\n  }\n}\n",[2852],{"type":396,"tag":410,"props":2853,"children":2854},{"__ignoreMap":389},[2855,2876,2891,2914,2937,2953,2986,3069,3097,3104,3111,3142,3149,3157,3176,3191,3246,3263,3299,3306,3373,3402,3443,3464,3485,3510,3527,3547,3560,3569,3594,3607,3615],{"type":396,"tag":434,"props":2856,"children":2857},{"class":436,"line":437},[2858,2863,2868,2872],{"type":396,"tag":434,"props":2859,"children":2860},{"style":579},[2861],{"type":402,"value":2862},"let",{"type":396,"tag":434,"props":2864,"children":2865},{"style":451},[2866],{"type":402,"value":2867}," handleFn ",{"type":396,"tag":434,"props":2869,"children":2870},{"style":687},[2871],{"type":402,"value":690},{"type":396,"tag":434,"props":2873,"children":2874},{"style":2153},[2875],{"type":402,"value":2377},{"type":396,"tag":434,"props":2877,"children":2878},{"class":436,"line":447},[2879,2883,2887],{"type":396,"tag":434,"props":2880,"children":2881},{"style":579},[2882],{"type":402,"value":761},{"type":396,"tag":434,"props":2884,"children":2885},{"style":764},[2886],{"type":402,"value":767},{"type":396,"tag":434,"props":2888,"children":2889},{"style":457},[2890],{"type":402,"value":587},{"type":396,"tag":434,"props":2892,"children":2893},{"class":436,"line":526},[2894,2898,2902,2906,2910],{"type":396,"tag":434,"props":2895,"children":2896},{"style":838},[2897],{"type":402,"value":841},{"type":396,"tag":434,"props":2899,"children":2900},{"style":457},[2901],{"type":402,"value":846},{"type":396,"tag":434,"props":2903,"children":2904},{"style":573},[2905],{"type":402,"value":851},{"type":396,"tag":434,"props":2907,"children":2908},{"style":457},[2909],{"type":402,"value":856},{"type":396,"tag":434,"props":2911,"children":2912},{"style":457},[2913],{"type":402,"value":2227},{"type":396,"tag":434,"props":2915,"children":2916},{"class":436,"line":535},[2917,2921,2925,2929,2933],{"type":396,"tag":434,"props":2918,"children":2919},{"style":838},[2920],{"type":402,"value":878},{"type":396,"tag":434,"props":2922,"children":2923},{"style":457},[2924],{"type":402,"value":846},{"type":396,"tag":434,"props":2926,"children":2927},{"style":573},[2928],{"type":402,"value":851},{"type":396,"tag":434,"props":2930,"children":2931},{"style":457},[2932],{"type":402,"value":856},{"type":396,"tag":434,"props":2934,"children":2935},{"style":457},[2936],{"type":402,"value":2227},{"type":396,"tag":434,"props":2938,"children":2939},{"class":436,"line":590},[2940,2945,2949],{"type":396,"tag":434,"props":2941,"children":2942},{"style":838},[2943],{"type":402,"value":2944},"  clear",{"type":396,"tag":434,"props":2946,"children":2947},{"style":457},[2948],{"type":402,"value":784},{"type":396,"tag":434,"props":2950,"children":2951},{"style":457},[2952],{"type":402,"value":2227},{"type":396,"tag":434,"props":2954,"children":2955},{"class":436,"line":638},[2956,2961,2965,2969,2973,2978,2982],{"type":396,"tag":434,"props":2957,"children":2958},{"style":838},[2959],{"type":402,"value":2960},"  collect",{"type":396,"tag":434,"props":2962,"children":2963},{"style":457},[2964],{"type":402,"value":846},{"type":396,"tag":434,"props":2966,"children":2967},{"style":573},[2968],{"type":402,"value":851},{"type":396,"tag":434,"props":2970,"children":2971},{"style":687},[2972],{"type":402,"value":811},{"type":396,"tag":434,"props":2974,"children":2975},{"style":451},[2976],{"type":402,"value":2977}," handleFn",{"type":396,"tag":434,"props":2979,"children":2980},{"style":457},[2981],{"type":402,"value":856},{"type":396,"tag":434,"props":2983,"children":2984},{"style":457},[2985],{"type":402,"value":587},{"type":396,"tag":434,"props":2987,"children":2988},{"class":436,"line":651},[2989,2994,2998,3002,3007,3012,3017,3021,3025,3029,3034,3038,3043,3047,3052,3056,3060,3065],{"type":396,"tag":434,"props":2990,"children":2991},{"style":1222},[2992],{"type":402,"value":2993},"    if",{"type":396,"tag":434,"props":2995,"children":2996},{"style":500},[2997],{"type":402,"value":846},{"type":396,"tag":434,"props":2999,"children":3000},{"style":451},[3001],{"type":402,"value":851},{"type":396,"tag":434,"props":3003,"children":3004},{"style":687},[3005],{"type":402,"value":3006}," &&",{"type":396,"tag":434,"props":3008,"children":3009},{"style":687},[3010],{"type":402,"value":3011}," !",{"type":396,"tag":434,"props":3013,"children":3014},{"style":794},[3015],{"type":402,"value":3016},"this",{"type":396,"tag":434,"props":3018,"children":3019},{"style":457},[3020],{"type":402,"value":460},{"type":396,"tag":434,"props":3022,"children":3023},{"style":451},[3024],{"type":402,"value":806},{"type":396,"tag":434,"props":3026,"children":3027},{"style":457},[3028],{"type":402,"value":460},{"type":396,"tag":434,"props":3030,"children":3031},{"style":463},[3032],{"type":402,"value":3033},"find",{"type":396,"tag":434,"props":3035,"children":3036},{"style":500},[3037],{"type":402,"value":471},{"type":396,"tag":434,"props":3039,"children":3040},{"style":573},[3041],{"type":402,"value":3042},"x",{"type":396,"tag":434,"props":3044,"children":3045},{"style":579},[3046],{"type":402,"value":582},{"type":396,"tag":434,"props":3048,"children":3049},{"style":451},[3050],{"type":402,"value":3051}," x",{"type":396,"tag":434,"props":3053,"children":3054},{"style":687},[3055],{"type":402,"value":1598},{"type":396,"tag":434,"props":3057,"children":3058},{"style":451},[3059],{"type":402,"value":2193},{"type":396,"tag":434,"props":3061,"children":3062},{"style":500},[3063],{"type":402,"value":3064},")) ",{"type":396,"tag":434,"props":3066,"children":3067},{"style":457},[3068],{"type":402,"value":1396},{"type":396,"tag":434,"props":3070,"children":3071},{"class":436,"line":905},[3072,3077,3081,3085,3089,3093],{"type":396,"tag":434,"props":3073,"children":3074},{"style":794},[3075],{"type":402,"value":3076},"      this",{"type":396,"tag":434,"props":3078,"children":3079},{"style":457},[3080],{"type":402,"value":460},{"type":396,"tag":434,"props":3082,"children":3083},{"style":463},[3084],{"type":402,"value":1961},{"type":396,"tag":434,"props":3086,"children":3087},{"style":500},[3088],{"type":402,"value":471},{"type":396,"tag":434,"props":3090,"children":3091},{"style":451},[3092],{"type":402,"value":851},{"type":396,"tag":434,"props":3094,"children":3095},{"style":500},[3096],{"type":402,"value":523},{"type":396,"tag":434,"props":3098,"children":3099},{"class":436,"line":914},[3100],{"type":396,"tag":434,"props":3101,"children":3102},{"style":457},[3103],{"type":402,"value":1687},{"type":396,"tag":434,"props":3105,"children":3106},{"class":436,"line":949},[3107],{"type":396,"tag":434,"props":3108,"children":3109},{"style":457},[3110],{"type":402,"value":824},{"type":396,"tag":434,"props":3112,"children":3113},{"class":436,"line":1013},[3114,3118,3122,3126,3130,3134,3138],{"type":396,"tag":434,"props":3115,"children":3116},{"style":838},[3117],{"type":402,"value":920},{"type":396,"tag":434,"props":3119,"children":3120},{"style":457},[3121],{"type":402,"value":846},{"type":396,"tag":434,"props":3123,"children":3124},{"style":573},[3125],{"type":402,"value":929},{"type":396,"tag":434,"props":3127,"children":3128},{"style":457},[3129],{"type":402,"value":492},{"type":396,"tag":434,"props":3131,"children":3132},{"style":573},[3133],{"type":402,"value":938},{"type":396,"tag":434,"props":3135,"children":3136},{"style":457},[3137],{"type":402,"value":856},{"type":396,"tag":434,"props":3139,"children":3140},{"style":457},[3141],{"type":402,"value":2227},{"type":396,"tag":434,"props":3143,"children":3144},{"class":436,"line":1021},[3145],{"type":396,"tag":434,"props":3146,"children":3147},{"style":457},[3148],{"type":402,"value":1027},{"type":396,"tag":434,"props":3150,"children":3151},{"class":436,"line":1249},[3152],{"type":396,"tag":434,"props":3153,"children":3154},{"emptyLinePlaceholder":388},[3155],{"type":402,"value":3156},"\n",{"type":396,"tag":434,"props":3158,"children":3159},{"class":436,"line":1274},[3160,3164,3168,3172],{"type":396,"tag":434,"props":3161,"children":3162},{"style":579},[3163],{"type":402,"value":2862},{"type":396,"tag":434,"props":3165,"children":3166},{"style":451},[3167],{"type":402,"value":2368},{"type":396,"tag":434,"props":3169,"children":3170},{"style":687},[3171],{"type":402,"value":690},{"type":396,"tag":434,"props":3173,"children":3174},{"style":2153},[3175],{"type":402,"value":2377},{"type":396,"tag":434,"props":3177,"children":3178},{"class":436,"line":1292},[3179,3183,3187],{"type":396,"tag":434,"props":3180,"children":3181},{"style":579},[3182],{"type":402,"value":761},{"type":396,"tag":434,"props":3184,"children":3185},{"style":764},[3186],{"type":402,"value":2093},{"type":396,"tag":434,"props":3188,"children":3189},{"style":457},[3190],{"type":402,"value":587},{"type":396,"tag":434,"props":3192,"children":3193},{"class":436,"line":1300},[3194,3198,3202,3206,3210,3214,3218,3222,3226,3230,3234,3238,3242],{"type":396,"tag":434,"props":3195,"children":3196},{"style":838},[3197],{"type":402,"value":2175},{"type":396,"tag":434,"props":3199,"children":3200},{"style":457},[3201],{"type":402,"value":846},{"type":396,"tag":434,"props":3203,"children":3204},{"style":573},[3205],{"type":402,"value":2184},{"type":396,"tag":434,"props":3207,"children":3208},{"style":457},[3209],{"type":402,"value":492},{"type":396,"tag":434,"props":3211,"children":3212},{"style":573},[3213],{"type":402,"value":2193},{"type":396,"tag":434,"props":3215,"children":3216},{"style":457},[3217],{"type":402,"value":492},{"type":396,"tag":434,"props":3219,"children":3220},{"style":573},[3221],{"type":402,"value":2202},{"type":396,"tag":434,"props":3223,"children":3224},{"style":687},[3225],{"type":402,"value":811},{"type":396,"tag":434,"props":3227,"children":3228},{"style":794},[3229],{"type":402,"value":1382},{"type":396,"tag":434,"props":3231,"children":3232},{"style":457},[3233],{"type":402,"value":460},{"type":396,"tag":434,"props":3235,"children":3236},{"style":451},[3237],{"type":402,"value":2128},{"type":396,"tag":434,"props":3239,"children":3240},{"style":457},[3241],{"type":402,"value":856},{"type":396,"tag":434,"props":3243,"children":3244},{"style":457},[3245],{"type":402,"value":587},{"type":396,"tag":434,"props":3247,"children":3248},{"class":436,"line":1309},[3249,3254,3258],{"type":396,"tag":434,"props":3250,"children":3251},{"style":451},[3252],{"type":402,"value":3253},"    handleFn",{"type":396,"tag":434,"props":3255,"children":3256},{"style":687},[3257],{"type":402,"value":811},{"type":396,"tag":434,"props":3259,"children":3260},{"style":451},[3261],{"type":402,"value":3262}," fn\n",{"type":396,"tag":434,"props":3264,"children":3265},{"class":436,"line":2787},[3266,3271,3275,3279,3283,3287,3291,3295],{"type":396,"tag":434,"props":3267,"children":3268},{"style":451},[3269],{"type":402,"value":3270},"    console",{"type":396,"tag":434,"props":3272,"children":3273},{"style":457},[3274],{"type":402,"value":460},{"type":396,"tag":434,"props":3276,"children":3277},{"style":463},[3278],{"type":402,"value":605},{"type":396,"tag":434,"props":3280,"children":3281},{"style":500},[3282],{"type":402,"value":471},{"type":396,"tag":434,"props":3284,"children":3285},{"style":451},[3286],{"type":402,"value":1453},{"type":396,"tag":434,"props":3288,"children":3289},{"style":457},[3290],{"type":402,"value":460},{"type":396,"tag":434,"props":3292,"children":3293},{"style":451},[3294],{"type":402,"value":2184},{"type":396,"tag":434,"props":3296,"children":3297},{"style":500},[3298],{"type":402,"value":523},{"type":396,"tag":434,"props":3300,"children":3301},{"class":436,"line":2800},[3302],{"type":396,"tag":434,"props":3303,"children":3304},{"style":457},[3305],{"type":402,"value":824},{"type":396,"tag":434,"props":3307,"children":3308},{"class":436,"line":2808},[3309,3313,3317,3321,3325,3329,3333,3337,3341,3345,3349,3353,3357,3361,3365,3369],{"type":396,"tag":434,"props":3310,"children":3311},{"style":838},[3312],{"type":402,"value":1255},{"type":396,"tag":434,"props":3314,"children":3315},{"style":457},[3316],{"type":402,"value":846},{"type":396,"tag":434,"props":3318,"children":3319},{"style":573},[3320],{"type":402,"value":2184},{"type":396,"tag":434,"props":3322,"children":3323},{"style":457},[3324],{"type":402,"value":492},{"type":396,"tag":434,"props":3326,"children":3327},{"style":573},[3328],{"type":402,"value":503},{"type":396,"tag":434,"props":3330,"children":3331},{"style":457},[3332],{"type":402,"value":492},{"type":396,"tag":434,"props":3334,"children":3335},{"style":573},[3336],{"type":402,"value":2259},{"type":396,"tag":434,"props":3338,"children":3339},{"style":687},[3340],{"type":402,"value":811},{"type":396,"tag":434,"props":3342,"children":3343},{"style":457},[3344],{"type":402,"value":1368},{"type":396,"tag":434,"props":3346,"children":3347},{"style":573},[3348],{"type":402,"value":2202},{"type":396,"tag":434,"props":3350,"children":3351},{"style":687},[3352],{"type":402,"value":811},{"type":396,"tag":434,"props":3354,"children":3355},{"style":794},[3356],{"type":402,"value":1382},{"type":396,"tag":434,"props":3358,"children":3359},{"style":457},[3360],{"type":402,"value":460},{"type":396,"tag":434,"props":3362,"children":3363},{"style":451},[3364],{"type":402,"value":2128},{"type":396,"tag":434,"props":3366,"children":3367},{"style":457},[3368],{"type":402,"value":856},{"type":396,"tag":434,"props":3370,"children":3371},{"style":457},[3372],{"type":402,"value":587},{"type":396,"tag":434,"props":3374,"children":3376},{"class":436,"line":3375},21,[3377,3382,3386,3390,3394,3398],{"type":396,"tag":434,"props":3378,"children":3379},{"style":579},[3380],{"type":402,"value":3381},"    const",{"type":396,"tag":434,"props":3383,"children":3384},{"style":1407},[3385],{"type":402,"value":1410},{"type":396,"tag":434,"props":3387,"children":3388},{"style":687},[3389],{"type":402,"value":811},{"type":396,"tag":434,"props":3391,"children":3392},{"style":687},[3393],{"type":402,"value":1419},{"type":396,"tag":434,"props":3395,"children":3396},{"style":463},[3397],{"type":402,"value":767},{"type":396,"tag":434,"props":3399,"children":3400},{"style":500},[3401],{"type":402,"value":1428},{"type":396,"tag":434,"props":3403,"children":3405},{"class":436,"line":3404},22,[3406,3411,3415,3419,3423,3427,3431,3435,3439],{"type":396,"tag":434,"props":3407,"children":3408},{"style":451},[3409],{"type":402,"value":3410},"    Object",{"type":396,"tag":434,"props":3412,"children":3413},{"style":457},[3414],{"type":402,"value":460},{"type":396,"tag":434,"props":3416,"children":3417},{"style":463},[3418],{"type":402,"value":1052},{"type":396,"tag":434,"props":3420,"children":3421},{"style":500},[3422],{"type":402,"value":471},{"type":396,"tag":434,"props":3424,"children":3425},{"style":451},[3426],{"type":402,"value":1453},{"type":396,"tag":434,"props":3428,"children":3429},{"style":457},[3430],{"type":402,"value":492},{"type":396,"tag":434,"props":3432,"children":3433},{"style":451},[3434],{"type":402,"value":1117},{"type":396,"tag":434,"props":3436,"children":3437},{"style":457},[3438],{"type":402,"value":492},{"type":396,"tag":434,"props":3440,"children":3441},{"style":457},[3442],{"type":402,"value":587},{"type":396,"tag":434,"props":3444,"children":3446},{"class":436,"line":3445},23,[3447,3452,3456,3460],{"type":396,"tag":434,"props":3448,"children":3449},{"style":500},[3450],{"type":402,"value":3451},"      enumerable",{"type":396,"tag":434,"props":3453,"children":3454},{"style":457},[3455],{"type":402,"value":508},{"type":396,"tag":434,"props":3457,"children":3458},{"style":1148},[3459],{"type":402,"value":1151},{"type":396,"tag":434,"props":3461,"children":3462},{"style":457},[3463],{"type":402,"value":1156},{"type":396,"tag":434,"props":3465,"children":3467},{"class":436,"line":3466},24,[3468,3473,3477,3481],{"type":396,"tag":434,"props":3469,"children":3470},{"style":500},[3471],{"type":402,"value":3472},"      configurable",{"type":396,"tag":434,"props":3474,"children":3475},{"style":457},[3476],{"type":402,"value":508},{"type":396,"tag":434,"props":3478,"children":3479},{"style":1148},[3480],{"type":402,"value":1151},{"type":396,"tag":434,"props":3482,"children":3483},{"style":457},[3484],{"type":402,"value":1156},{"type":396,"tag":434,"props":3486,"children":3488},{"class":436,"line":3487},25,[3489,3494,3498,3502,3506],{"type":396,"tag":434,"props":3490,"children":3491},{"style":463},[3492],{"type":402,"value":3493},"      get",{"type":396,"tag":434,"props":3495,"children":3496},{"style":457},[3497],{"type":402,"value":508},{"type":396,"tag":434,"props":3499,"children":3500},{"style":457},[3501],{"type":402,"value":784},{"type":396,"tag":434,"props":3503,"children":3504},{"style":579},[3505],{"type":402,"value":582},{"type":396,"tag":434,"props":3507,"children":3508},{"style":457},[3509],{"type":402,"value":587},{"type":396,"tag":434,"props":3511,"children":3513},{"class":436,"line":3512},26,[3514,3519,3523],{"type":396,"tag":434,"props":3515,"children":3516},{"style":451},[3517],{"type":402,"value":3518},"        handleDep",{"type":396,"tag":434,"props":3520,"children":3521},{"style":687},[3522],{"type":402,"value":811},{"type":396,"tag":434,"props":3524,"children":3525},{"style":451},[3526],{"type":402,"value":1871},{"type":396,"tag":434,"props":3528,"children":3530},{"class":436,"line":3529},27,[3531,3535,3539,3543],{"type":396,"tag":434,"props":3532,"children":3533},{"style":451},[3534],{"type":402,"value":3518},{"type":396,"tag":434,"props":3536,"children":3537},{"style":457},[3538],{"type":402,"value":460},{"type":396,"tag":434,"props":3540,"children":3541},{"style":463},[3542],{"type":402,"value":2837},{"type":396,"tag":434,"props":3544,"children":3545},{"style":500},[3546],{"type":402,"value":1428},{"type":396,"tag":434,"props":3548,"children":3550},{"class":436,"line":3549},28,[3551,3556],{"type":396,"tag":434,"props":3552,"children":3553},{"style":1222},[3554],{"type":402,"value":3555},"        return",{"type":396,"tag":434,"props":3557,"children":3558},{"style":451},[3559],{"type":402,"value":1230},{"type":396,"tag":434,"props":3561,"children":3563},{"class":436,"line":3562},29,[3564],{"type":396,"tag":434,"props":3565,"children":3566},{"style":457},[3567],{"type":402,"value":3568},"      },\n",{"type":396,"tag":434,"props":3570,"children":3572},{"class":436,"line":3571},30,[3573,3578,3582,3586,3590],{"type":396,"tag":434,"props":3574,"children":3575},{"style":463},[3576],{"type":402,"value":3577},"      set",{"type":396,"tag":434,"props":3579,"children":3580},{"style":457},[3581],{"type":402,"value":508},{"type":396,"tag":434,"props":3583,"children":3584},{"style":573},[3585],{"type":402,"value":576},{"type":396,"tag":434,"props":3587,"children":3588},{"style":579},[3589],{"type":402,"value":582},{"type":396,"tag":434,"props":3591,"children":3592},{"style":457},[3593],{"type":402,"value":2227},{"type":396,"tag":434,"props":3595,"children":3597},{"class":436,"line":3596},31,[3598,3603],{"type":396,"tag":434,"props":3599,"children":3600},{"style":457},[3601],{"type":402,"value":3602},"    }",{"type":396,"tag":434,"props":3604,"children":3605},{"style":500},[3606],{"type":402,"value":523},{"type":396,"tag":434,"props":3608,"children":3610},{"class":436,"line":3609},32,[3611],{"type":396,"tag":434,"props":3612,"children":3613},{"style":457},[3614],{"type":402,"value":824},{"type":396,"tag":434,"props":3616,"children":3618},{"class":436,"line":3617},33,[3619],{"type":396,"tag":434,"props":3620,"children":3621},{"style":457},[3622],{"type":402,"value":1027},{"type":396,"tag":397,"props":3624,"children":3626},{"id":3625},"处理-key-值为对象链的情况",[3627],{"type":402,"value":3628},"处理 key 值为对象链的情况",{"type":396,"tag":404,"props":3630,"children":3631},{},[3632,3634,3640],{"type":402,"value":3633},"在先前的 watch 函数中, 我们使用 console.log(obj.key)去触发对应属性的 getter, 如果我们调用方式是",{"type":396,"tag":410,"props":3635,"children":3637},{"className":3636},[],[3638],{"type":402,"value":3639},"watch('a.b.c')",{"type":402,"value":3641},"就无能为力了. 这里我们封装一个通用方法, 用于处理对象链字符串的形式:",{"type":396,"tag":424,"props":3643,"children":3645},{"className":426,"code":3644,"language":428,"meta":389,"style":389},"// 通过将字符串'a.b'分割为['a', 'b'], 再使用一个while循环就可以走完这个对象链\nfunction walkChains (key, obj) {\n  const segments = key.split('.')\n  let deepObj = obj\n  while (segments.length) {\n    deepObj = deepObj[segments.shift()]\n  }\n}\nclass VX {\n  watch (key, fn, obj = this.store) {\n    handleFn = fn\n    walkChains(key, obj)\n  }\n}\n",[3646],{"type":396,"tag":410,"props":3647,"children":3648},{"__ignoreMap":389},[3649,3657,3694,3743,3764,3798,3837,3844,3851,3866,3921,3936,3964,3971],{"type":396,"tag":434,"props":3650,"children":3651},{"class":436,"line":437},[3652],{"type":396,"tag":434,"props":3653,"children":3654},{"style":441},[3655],{"type":402,"value":3656},"// 通过将字符串'a.b'分割为['a', 'b'], 再使用一个while循环就可以走完这个对象链\n",{"type":396,"tag":434,"props":3658,"children":3659},{"class":436,"line":447},[3660,3665,3670,3674,3678,3682,3686,3690],{"type":396,"tag":434,"props":3661,"children":3662},{"style":579},[3663],{"type":402,"value":3664},"function",{"type":396,"tag":434,"props":3666,"children":3667},{"style":463},[3668],{"type":402,"value":3669}," walkChains",{"type":396,"tag":434,"props":3671,"children":3672},{"style":457},[3673],{"type":402,"value":846},{"type":396,"tag":434,"props":3675,"children":3676},{"style":573},[3677],{"type":402,"value":2184},{"type":396,"tag":434,"props":3679,"children":3680},{"style":457},[3681],{"type":402,"value":492},{"type":396,"tag":434,"props":3683,"children":3684},{"style":573},[3685],{"type":402,"value":2202},{"type":396,"tag":434,"props":3687,"children":3688},{"style":457},[3689],{"type":402,"value":856},{"type":396,"tag":434,"props":3691,"children":3692},{"style":457},[3693],{"type":402,"value":587},{"type":396,"tag":434,"props":3695,"children":3696},{"class":436,"line":526},[3697,3701,3706,3710,3714,3718,3723,3727,3731,3735,3739],{"type":396,"tag":434,"props":3698,"children":3699},{"style":579},[3700],{"type":402,"value":1404},{"type":396,"tag":434,"props":3702,"children":3703},{"style":1407},[3704],{"type":402,"value":3705}," segments",{"type":396,"tag":434,"props":3707,"children":3708},{"style":687},[3709],{"type":402,"value":811},{"type":396,"tag":434,"props":3711,"children":3712},{"style":451},[3713],{"type":402,"value":1117},{"type":396,"tag":434,"props":3715,"children":3716},{"style":457},[3717],{"type":402,"value":460},{"type":396,"tag":434,"props":3719,"children":3720},{"style":463},[3721],{"type":402,"value":3722},"split",{"type":396,"tag":434,"props":3724,"children":3725},{"style":500},[3726],{"type":402,"value":471},{"type":396,"tag":434,"props":3728,"children":3729},{"style":474},[3730],{"type":402,"value":477},{"type":396,"tag":434,"props":3732,"children":3733},{"style":480},[3734],{"type":402,"value":460},{"type":396,"tag":434,"props":3736,"children":3737},{"style":474},[3738],{"type":402,"value":477},{"type":396,"tag":434,"props":3740,"children":3741},{"style":500},[3742],{"type":402,"value":523},{"type":396,"tag":434,"props":3744,"children":3745},{"class":436,"line":535},[3746,3750,3755,3759],{"type":396,"tag":434,"props":3747,"children":3748},{"style":579},[3749],{"type":402,"value":2363},{"type":396,"tag":434,"props":3751,"children":3752},{"style":451},[3753],{"type":402,"value":3754}," deepObj",{"type":396,"tag":434,"props":3756,"children":3757},{"style":687},[3758],{"type":402,"value":811},{"type":396,"tag":434,"props":3760,"children":3761},{"style":451},[3762],{"type":402,"value":3763}," obj\n",{"type":396,"tag":434,"props":3765,"children":3766},{"class":436,"line":590},[3767,3772,3776,3781,3785,3790,3794],{"type":396,"tag":434,"props":3768,"children":3769},{"style":1222},[3770],{"type":402,"value":3771},"  while",{"type":396,"tag":434,"props":3773,"children":3774},{"style":500},[3775],{"type":402,"value":846},{"type":396,"tag":434,"props":3777,"children":3778},{"style":451},[3779],{"type":402,"value":3780},"segments",{"type":396,"tag":434,"props":3782,"children":3783},{"style":457},[3784],{"type":402,"value":460},{"type":396,"tag":434,"props":3786,"children":3787},{"style":1407},[3788],{"type":402,"value":3789},"length",{"type":396,"tag":434,"props":3791,"children":3792},{"style":500},[3793],{"type":402,"value":1607},{"type":396,"tag":434,"props":3795,"children":3796},{"style":457},[3797],{"type":402,"value":1396},{"type":396,"tag":434,"props":3799,"children":3800},{"class":436,"line":638},[3801,3806,3810,3814,3819,3823,3827,3832],{"type":396,"tag":434,"props":3802,"children":3803},{"style":451},[3804],{"type":402,"value":3805},"    deepObj",{"type":396,"tag":434,"props":3807,"children":3808},{"style":687},[3809],{"type":402,"value":811},{"type":396,"tag":434,"props":3811,"children":3812},{"style":451},[3813],{"type":402,"value":3754},{"type":396,"tag":434,"props":3815,"children":3816},{"style":500},[3817],{"type":402,"value":3818},"[",{"type":396,"tag":434,"props":3820,"children":3821},{"style":451},[3822],{"type":402,"value":3780},{"type":396,"tag":434,"props":3824,"children":3825},{"style":457},[3826],{"type":402,"value":460},{"type":396,"tag":434,"props":3828,"children":3829},{"style":463},[3830],{"type":402,"value":3831},"shift",{"type":396,"tag":434,"props":3833,"children":3834},{"style":500},[3835],{"type":402,"value":3836},"()]\n",{"type":396,"tag":434,"props":3838,"children":3839},{"class":436,"line":651},[3840],{"type":396,"tag":434,"props":3841,"children":3842},{"style":457},[3843],{"type":402,"value":824},{"type":396,"tag":434,"props":3845,"children":3846},{"class":436,"line":905},[3847],{"type":396,"tag":434,"props":3848,"children":3849},{"style":457},[3850],{"type":402,"value":1027},{"type":396,"tag":434,"props":3852,"children":3853},{"class":436,"line":914},[3854,3858,3862],{"type":396,"tag":434,"props":3855,"children":3856},{"style":579},[3857],{"type":402,"value":761},{"type":396,"tag":434,"props":3859,"children":3860},{"style":764},[3861],{"type":402,"value":2093},{"type":396,"tag":434,"props":3863,"children":3864},{"style":457},[3865],{"type":402,"value":587},{"type":396,"tag":434,"props":3867,"children":3868},{"class":436,"line":949},[3869,3873,3877,3881,3885,3889,3893,3897,3901,3905,3909,3913,3917],{"type":396,"tag":434,"props":3870,"children":3871},{"style":838},[3872],{"type":402,"value":2175},{"type":396,"tag":434,"props":3874,"children":3875},{"style":457},[3876],{"type":402,"value":846},{"type":396,"tag":434,"props":3878,"children":3879},{"style":573},[3880],{"type":402,"value":2184},{"type":396,"tag":434,"props":3882,"children":3883},{"style":457},[3884],{"type":402,"value":492},{"type":396,"tag":434,"props":3886,"children":3887},{"style":573},[3888],{"type":402,"value":2193},{"type":396,"tag":434,"props":3890,"children":3891},{"style":457},[3892],{"type":402,"value":492},{"type":396,"tag":434,"props":3894,"children":3895},{"style":573},[3896],{"type":402,"value":2202},{"type":396,"tag":434,"props":3898,"children":3899},{"style":687},[3900],{"type":402,"value":811},{"type":396,"tag":434,"props":3902,"children":3903},{"style":794},[3904],{"type":402,"value":1382},{"type":396,"tag":434,"props":3906,"children":3907},{"style":457},[3908],{"type":402,"value":460},{"type":396,"tag":434,"props":3910,"children":3911},{"style":451},[3912],{"type":402,"value":2128},{"type":396,"tag":434,"props":3914,"children":3915},{"style":457},[3916],{"type":402,"value":856},{"type":396,"tag":434,"props":3918,"children":3919},{"style":457},[3920],{"type":402,"value":587},{"type":396,"tag":434,"props":3922,"children":3923},{"class":436,"line":1013},[3924,3928,3932],{"type":396,"tag":434,"props":3925,"children":3926},{"style":451},[3927],{"type":402,"value":3253},{"type":396,"tag":434,"props":3929,"children":3930},{"style":687},[3931],{"type":402,"value":811},{"type":396,"tag":434,"props":3933,"children":3934},{"style":451},[3935],{"type":402,"value":3262},{"type":396,"tag":434,"props":3937,"children":3938},{"class":436,"line":1021},[3939,3944,3948,3952,3956,3960],{"type":396,"tag":434,"props":3940,"children":3941},{"style":463},[3942],{"type":402,"value":3943},"    walkChains",{"type":396,"tag":434,"props":3945,"children":3946},{"style":500},[3947],{"type":402,"value":471},{"type":396,"tag":434,"props":3949,"children":3950},{"style":451},[3951],{"type":402,"value":2184},{"type":396,"tag":434,"props":3953,"children":3954},{"style":457},[3955],{"type":402,"value":492},{"type":396,"tag":434,"props":3957,"children":3958},{"style":451},[3959],{"type":402,"value":2202},{"type":396,"tag":434,"props":3961,"children":3962},{"style":500},[3963],{"type":402,"value":523},{"type":396,"tag":434,"props":3965,"children":3966},{"class":436,"line":1249},[3967],{"type":396,"tag":434,"props":3968,"children":3969},{"style":457},[3970],{"type":402,"value":824},{"type":396,"tag":434,"props":3972,"children":3973},{"class":436,"line":1274},[3974],{"type":396,"tag":434,"props":3975,"children":3976},{"style":457},[3977],{"type":402,"value":1027},{"type":396,"tag":404,"props":3979,"children":3980},{},[3981,3983,3989],{"type":402,"value":3982},"在 set 方法中处理对象链字符串稍微有些不同, 因为如果",{"type":396,"tag":410,"props":3984,"children":3986},{"className":3985},[],[3987],{"type":402,"value":3988},"set('a.b')",{"type":402,"value":3990},"时, 没有在我们全局对象中找到 a 属性, 这里应该抛错.",{"type":396,"tag":404,"props":3992,"children":3993},{},[3994,3996,4002],{"type":402,"value":3995},"实际的处理中, 需要推断'obj.a'以及'obj.a.b'是否存在. 假设没有'obj.a', 那么我们应该创建一个新的对象, 并且给新的对象添加属性'b', 所以代码类似",{"type":396,"tag":410,"props":3997,"children":3999},{"className":3998},[],[4000],{"type":402,"value":4001},"walkChains",{"type":402,"value":4003},"函数, 只是稍作一层判断:",{"type":396,"tag":424,"props":4005,"children":4007},{"className":426,"code":4006,"language":428,"meta":389,"style":389},"set (key, val, obj) {\n  const segments = key.split('.')\n  // 这里需要注意, 我们只处理到倒数第二个属性\n  while (segments.length > 1) {\n    const handleKey = segments.shift()\n    const handleVal = obj[handleKey]\n    // 存在'obj.a'的情况\n    if (typeof handleVal === 'object') {\n      obj = handleVal\n    // 不存在'obj.a'则给a属性赋一个非响应式的对象\n    } else if (!handleVal) {\n      obj = (\n        key = handleKey,\n        obj[handleKey] = {},\n        obj[handleKey]\n      )\n    } else {\n      console.trace('already has val')\n    }\n  }\n  // 最后一个属性要手动赋值\n  key = segments[0]\n}\n",[4008],{"type":396,"tag":410,"props":4009,"children":4010},{"__ignoreMap":389},[4011,4043,4090,4098,4139,4171,4205,4213,4259,4276,4284,4323,4339,4359,4389,4408,4416,4431,4468,4475,4482,4490,4519],{"type":396,"tag":434,"props":4012,"children":4013},{"class":436,"line":437},[4014,4018,4022,4026,4030,4034,4039],{"type":396,"tag":434,"props":4015,"children":4016},{"style":463},[4017],{"type":402,"value":466},{"type":396,"tag":434,"props":4019,"children":4020},{"style":451},[4021],{"type":402,"value":1342},{"type":396,"tag":434,"props":4023,"children":4024},{"style":457},[4025],{"type":402,"value":492},{"type":396,"tag":434,"props":4027,"children":4028},{"style":451},[4029],{"type":402,"value":503},{"type":396,"tag":434,"props":4031,"children":4032},{"style":457},[4033],{"type":402,"value":492},{"type":396,"tag":434,"props":4035,"children":4036},{"style":451},[4037],{"type":402,"value":4038}," obj) ",{"type":396,"tag":434,"props":4040,"children":4041},{"style":457},[4042],{"type":402,"value":1396},{"type":396,"tag":434,"props":4044,"children":4045},{"class":436,"line":447},[4046,4050,4054,4058,4062,4066,4070,4074,4078,4082,4086],{"type":396,"tag":434,"props":4047,"children":4048},{"style":579},[4049],{"type":402,"value":1404},{"type":396,"tag":434,"props":4051,"children":4052},{"style":1407},[4053],{"type":402,"value":3705},{"type":396,"tag":434,"props":4055,"children":4056},{"style":687},[4057],{"type":402,"value":811},{"type":396,"tag":434,"props":4059,"children":4060},{"style":451},[4061],{"type":402,"value":1117},{"type":396,"tag":434,"props":4063,"children":4064},{"style":457},[4065],{"type":402,"value":460},{"type":396,"tag":434,"props":4067,"children":4068},{"style":463},[4069],{"type":402,"value":3722},{"type":396,"tag":434,"props":4071,"children":4072},{"style":500},[4073],{"type":402,"value":471},{"type":396,"tag":434,"props":4075,"children":4076},{"style":474},[4077],{"type":402,"value":477},{"type":396,"tag":434,"props":4079,"children":4080},{"style":480},[4081],{"type":402,"value":460},{"type":396,"tag":434,"props":4083,"children":4084},{"style":474},[4085],{"type":402,"value":477},{"type":396,"tag":434,"props":4087,"children":4088},{"style":500},[4089],{"type":402,"value":523},{"type":396,"tag":434,"props":4091,"children":4092},{"class":436,"line":526},[4093],{"type":396,"tag":434,"props":4094,"children":4095},{"style":441},[4096],{"type":402,"value":4097},"  // 这里需要注意, 我们只处理到倒数第二个属性\n",{"type":396,"tag":434,"props":4099,"children":4100},{"class":436,"line":535},[4101,4105,4109,4113,4117,4121,4126,4131,4135],{"type":396,"tag":434,"props":4102,"children":4103},{"style":1222},[4104],{"type":402,"value":3771},{"type":396,"tag":434,"props":4106,"children":4107},{"style":500},[4108],{"type":402,"value":846},{"type":396,"tag":434,"props":4110,"children":4111},{"style":451},[4112],{"type":402,"value":3780},{"type":396,"tag":434,"props":4114,"children":4115},{"style":457},[4116],{"type":402,"value":460},{"type":396,"tag":434,"props":4118,"children":4119},{"style":1407},[4120],{"type":402,"value":3789},{"type":396,"tag":434,"props":4122,"children":4123},{"style":687},[4124],{"type":402,"value":4125}," >",{"type":396,"tag":434,"props":4127,"children":4128},{"style":693},[4129],{"type":402,"value":4130}," 1",{"type":396,"tag":434,"props":4132,"children":4133},{"style":500},[4134],{"type":402,"value":1607},{"type":396,"tag":434,"props":4136,"children":4137},{"style":457},[4138],{"type":402,"value":1396},{"type":396,"tag":434,"props":4140,"children":4141},{"class":436,"line":590},[4142,4146,4151,4155,4159,4163,4167],{"type":396,"tag":434,"props":4143,"children":4144},{"style":579},[4145],{"type":402,"value":3381},{"type":396,"tag":434,"props":4147,"children":4148},{"style":1407},[4149],{"type":402,"value":4150}," handleKey",{"type":396,"tag":434,"props":4152,"children":4153},{"style":687},[4154],{"type":402,"value":811},{"type":396,"tag":434,"props":4156,"children":4157},{"style":451},[4158],{"type":402,"value":3705},{"type":396,"tag":434,"props":4160,"children":4161},{"style":457},[4162],{"type":402,"value":460},{"type":396,"tag":434,"props":4164,"children":4165},{"style":463},[4166],{"type":402,"value":3831},{"type":396,"tag":434,"props":4168,"children":4169},{"style":500},[4170],{"type":402,"value":1428},{"type":396,"tag":434,"props":4172,"children":4173},{"class":436,"line":638},[4174,4178,4183,4187,4191,4195,4200],{"type":396,"tag":434,"props":4175,"children":4176},{"style":579},[4177],{"type":402,"value":3381},{"type":396,"tag":434,"props":4179,"children":4180},{"style":1407},[4181],{"type":402,"value":4182}," handleVal",{"type":396,"tag":434,"props":4184,"children":4185},{"style":687},[4186],{"type":402,"value":811},{"type":396,"tag":434,"props":4188,"children":4189},{"style":451},[4190],{"type":402,"value":2202},{"type":396,"tag":434,"props":4192,"children":4193},{"style":500},[4194],{"type":402,"value":3818},{"type":396,"tag":434,"props":4196,"children":4197},{"style":451},[4198],{"type":402,"value":4199},"handleKey",{"type":396,"tag":434,"props":4201,"children":4202},{"style":500},[4203],{"type":402,"value":4204},"]\n",{"type":396,"tag":434,"props":4206,"children":4207},{"class":436,"line":651},[4208],{"type":396,"tag":434,"props":4209,"children":4210},{"style":441},[4211],{"type":402,"value":4212},"    // 存在'obj.a'的情况\n",{"type":396,"tag":434,"props":4214,"children":4215},{"class":436,"line":905},[4216,4220,4224,4229,4233,4237,4242,4247,4251,4255],{"type":396,"tag":434,"props":4217,"children":4218},{"style":1222},[4219],{"type":402,"value":2993},{"type":396,"tag":434,"props":4221,"children":4222},{"style":500},[4223],{"type":402,"value":846},{"type":396,"tag":434,"props":4225,"children":4226},{"style":687},[4227],{"type":402,"value":4228},"typeof",{"type":396,"tag":434,"props":4230,"children":4231},{"style":451},[4232],{"type":402,"value":4182},{"type":396,"tag":434,"props":4234,"children":4235},{"style":687},[4236],{"type":402,"value":1598},{"type":396,"tag":434,"props":4238,"children":4239},{"style":474},[4240],{"type":402,"value":4241}," '",{"type":396,"tag":434,"props":4243,"children":4244},{"style":480},[4245],{"type":402,"value":4246},"object",{"type":396,"tag":434,"props":4248,"children":4249},{"style":474},[4250],{"type":402,"value":477},{"type":396,"tag":434,"props":4252,"children":4253},{"style":500},[4254],{"type":402,"value":1607},{"type":396,"tag":434,"props":4256,"children":4257},{"style":457},[4258],{"type":402,"value":1396},{"type":396,"tag":434,"props":4260,"children":4261},{"class":436,"line":914},[4262,4267,4271],{"type":396,"tag":434,"props":4263,"children":4264},{"style":451},[4265],{"type":402,"value":4266},"      obj",{"type":396,"tag":434,"props":4268,"children":4269},{"style":687},[4270],{"type":402,"value":811},{"type":396,"tag":434,"props":4272,"children":4273},{"style":451},[4274],{"type":402,"value":4275}," handleVal\n",{"type":396,"tag":434,"props":4277,"children":4278},{"class":436,"line":949},[4279],{"type":396,"tag":434,"props":4280,"children":4281},{"style":441},[4282],{"type":402,"value":4283},"    // 不存在'obj.a'则给a属性赋一个非响应式的对象\n",{"type":396,"tag":434,"props":4285,"children":4286},{"class":436,"line":1013},[4287,4291,4296,4301,4305,4310,4315,4319],{"type":396,"tag":434,"props":4288,"children":4289},{"style":457},[4290],{"type":402,"value":3602},{"type":396,"tag":434,"props":4292,"children":4293},{"style":1222},[4294],{"type":402,"value":4295}," else",{"type":396,"tag":434,"props":4297,"children":4298},{"style":1222},[4299],{"type":402,"value":4300}," if",{"type":396,"tag":434,"props":4302,"children":4303},{"style":500},[4304],{"type":402,"value":846},{"type":396,"tag":434,"props":4306,"children":4307},{"style":687},[4308],{"type":402,"value":4309},"!",{"type":396,"tag":434,"props":4311,"children":4312},{"style":451},[4313],{"type":402,"value":4314},"handleVal",{"type":396,"tag":434,"props":4316,"children":4317},{"style":500},[4318],{"type":402,"value":1607},{"type":396,"tag":434,"props":4320,"children":4321},{"style":457},[4322],{"type":402,"value":1396},{"type":396,"tag":434,"props":4324,"children":4325},{"class":436,"line":1021},[4326,4330,4334],{"type":396,"tag":434,"props":4327,"children":4328},{"style":463},[4329],{"type":402,"value":4266},{"type":396,"tag":434,"props":4331,"children":4332},{"style":687},[4333],{"type":402,"value":811},{"type":396,"tag":434,"props":4335,"children":4336},{"style":500},[4337],{"type":402,"value":4338}," (\n",{"type":396,"tag":434,"props":4340,"children":4341},{"class":436,"line":1249},[4342,4347,4351,4355],{"type":396,"tag":434,"props":4343,"children":4344},{"style":451},[4345],{"type":402,"value":4346},"        key",{"type":396,"tag":434,"props":4348,"children":4349},{"style":687},[4350],{"type":402,"value":811},{"type":396,"tag":434,"props":4352,"children":4353},{"style":573},[4354],{"type":402,"value":4150},{"type":396,"tag":434,"props":4356,"children":4357},{"style":457},[4358],{"type":402,"value":1156},{"type":396,"tag":434,"props":4360,"children":4361},{"class":436,"line":1274},[4362,4367,4371,4375,4380,4384],{"type":396,"tag":434,"props":4363,"children":4364},{"style":451},[4365],{"type":402,"value":4366},"        obj",{"type":396,"tag":434,"props":4368,"children":4369},{"style":500},[4370],{"type":402,"value":3818},{"type":396,"tag":434,"props":4372,"children":4373},{"style":451},[4374],{"type":402,"value":4199},{"type":396,"tag":434,"props":4376,"children":4377},{"style":500},[4378],{"type":402,"value":4379},"] ",{"type":396,"tag":434,"props":4381,"children":4382},{"style":687},[4383],{"type":402,"value":690},{"type":396,"tag":434,"props":4385,"children":4386},{"style":457},[4387],{"type":402,"value":4388}," {},\n",{"type":396,"tag":434,"props":4390,"children":4391},{"class":436,"line":1292},[4392,4396,4400,4404],{"type":396,"tag":434,"props":4393,"children":4394},{"style":451},[4395],{"type":402,"value":4366},{"type":396,"tag":434,"props":4397,"children":4398},{"style":500},[4399],{"type":402,"value":3818},{"type":396,"tag":434,"props":4401,"children":4402},{"style":451},[4403],{"type":402,"value":4199},{"type":396,"tag":434,"props":4405,"children":4406},{"style":500},[4407],{"type":402,"value":4204},{"type":396,"tag":434,"props":4409,"children":4410},{"class":436,"line":1300},[4411],{"type":396,"tag":434,"props":4412,"children":4413},{"style":500},[4414],{"type":402,"value":4415},"      )\n",{"type":396,"tag":434,"props":4417,"children":4418},{"class":436,"line":1309},[4419,4423,4427],{"type":396,"tag":434,"props":4420,"children":4421},{"style":457},[4422],{"type":402,"value":3602},{"type":396,"tag":434,"props":4424,"children":4425},{"style":1222},[4426],{"type":402,"value":4295},{"type":396,"tag":434,"props":4428,"children":4429},{"style":457},[4430],{"type":402,"value":587},{"type":396,"tag":434,"props":4432,"children":4433},{"class":436,"line":2787},[4434,4438,4442,4447,4451,4455,4460,4464],{"type":396,"tag":434,"props":4435,"children":4436},{"style":451},[4437],{"type":402,"value":2457},{"type":396,"tag":434,"props":4439,"children":4440},{"style":457},[4441],{"type":402,"value":460},{"type":396,"tag":434,"props":4443,"children":4444},{"style":463},[4445],{"type":402,"value":4446},"trace",{"type":396,"tag":434,"props":4448,"children":4449},{"style":500},[4450],{"type":402,"value":471},{"type":396,"tag":434,"props":4452,"children":4453},{"style":474},[4454],{"type":402,"value":477},{"type":396,"tag":434,"props":4456,"children":4457},{"style":480},[4458],{"type":402,"value":4459},"already has val",{"type":396,"tag":434,"props":4461,"children":4462},{"style":474},[4463],{"type":402,"value":477},{"type":396,"tag":434,"props":4465,"children":4466},{"style":500},[4467],{"type":402,"value":523},{"type":396,"tag":434,"props":4469,"children":4470},{"class":436,"line":2800},[4471],{"type":396,"tag":434,"props":4472,"children":4473},{"style":457},[4474],{"type":402,"value":1687},{"type":396,"tag":434,"props":4476,"children":4477},{"class":436,"line":2808},[4478],{"type":396,"tag":434,"props":4479,"children":4480},{"style":457},[4481],{"type":402,"value":824},{"type":396,"tag":434,"props":4483,"children":4484},{"class":436,"line":3375},[4485],{"type":396,"tag":434,"props":4486,"children":4487},{"style":441},[4488],{"type":402,"value":4489},"  // 最后一个属性要手动赋值\n",{"type":396,"tag":434,"props":4491,"children":4492},{"class":436,"line":3404},[4493,4498,4502,4506,4510,4515],{"type":396,"tag":434,"props":4494,"children":4495},{"style":451},[4496],{"type":402,"value":4497},"  key",{"type":396,"tag":434,"props":4499,"children":4500},{"style":687},[4501],{"type":402,"value":811},{"type":396,"tag":434,"props":4503,"children":4504},{"style":451},[4505],{"type":402,"value":3705},{"type":396,"tag":434,"props":4507,"children":4508},{"style":500},[4509],{"type":402,"value":3818},{"type":396,"tag":434,"props":4511,"children":4512},{"style":693},[4513],{"type":402,"value":4514},"0",{"type":396,"tag":434,"props":4516,"children":4517},{"style":500},[4518],{"type":402,"value":4204},{"type":396,"tag":434,"props":4520,"children":4521},{"class":436,"line":3445},[4522],{"type":396,"tag":434,"props":4523,"children":4524},{"style":457},[4525],{"type":402,"value":1027},{"type":396,"tag":397,"props":4527,"children":4529},{"id":4528},"业务场景应用",[4530],{"type":402,"value":4528},{"type":396,"tag":1047,"props":4532,"children":4534},{"id":4533},"小程序跨页面刷新数据",[4535],{"type":402,"value":4533},{"type":396,"tag":404,"props":4537,"children":4538},{},[4539],{"type":402,"value":4540},"我们经常碰到在小程序中由 A 页面跳转到 B 页面, 如果 B 页面进行了一些操作, 希望 A 页面自动刷新数据的情况. 但是由于 A 页面跳转到 B 页面不同(也许是 redirect,也许是 navigate), 处理方法也不尽相同.",{"type":396,"tag":404,"props":4542,"children":4543},{},[4544],{"type":402,"value":4545},"使用 navigate 方式跳转后, A 页面不会被注销, 所以我们一般会通过全局对象去贮存 A 页面实例(也就是 A 页面的 this 对象), 然后在 B 页面直接调用相应的方法(如 A.refreshList())进行刷新操作.",{"type":396,"tag":404,"props":4547,"children":4548},{},[4549,4551,4557],{"type":402,"value":4550},"引入 VX 后, 我们可以在",{"type":396,"tag":410,"props":4552,"children":4554},{"className":4553},[],[4555],{"type":402,"value":4556},"onload",{"type":402,"value":4558},"生命周期直接调用 watch 方法添加订阅:",{"type":396,"tag":424,"props":4560,"children":4562},{"className":426,"code":4561,"language":428,"meta":389,"style":389},"// app.js\nimport VX from '@/utils/suites/vx'\nconst vx = new VX()\napp.vx = vx\napp.store = vx.store\napp.vx.set('userType', '商户')\n\n// page a\nonLoad () {\n  app.vx.watch('userType', userType => {\n    if (userType === '商户') {\n      // ...\n    } else if (userType === '管理员') {\n      // ...\n    }\n  }, {\n    immediate: true\n  })\n}\n\n// page b\nswitchUserType () {\n  app.store.userType = '管理员'\n}\n",[4563],{"type":396,"tag":410,"props":4564,"children":4565},{"__ignoreMap":389},[4566,4574,4606,4633,4659,4692,4753,4760,4768,4785,4842,4881,4889,4937,4944,4951,4963,4980,4991,4998,5005,5013,5029,5068],{"type":396,"tag":434,"props":4567,"children":4568},{"class":436,"line":437},[4569],{"type":396,"tag":434,"props":4570,"children":4571},{"style":441},[4572],{"type":402,"value":4573},"// app.js\n",{"type":396,"tag":434,"props":4575,"children":4576},{"class":436,"line":447},[4577,4582,4587,4592,4596,4601],{"type":396,"tag":434,"props":4578,"children":4579},{"style":1222},[4580],{"type":402,"value":4581},"import",{"type":396,"tag":434,"props":4583,"children":4584},{"style":451},[4585],{"type":402,"value":4586}," VX ",{"type":396,"tag":434,"props":4588,"children":4589},{"style":1222},[4590],{"type":402,"value":4591},"from",{"type":396,"tag":434,"props":4593,"children":4594},{"style":474},[4595],{"type":402,"value":4241},{"type":396,"tag":434,"props":4597,"children":4598},{"style":480},[4599],{"type":402,"value":4600},"@/utils/suites/vx",{"type":396,"tag":434,"props":4602,"children":4603},{"style":474},[4604],{"type":402,"value":4605},"'\n",{"type":396,"tag":434,"props":4607,"children":4608},{"class":436,"line":526},[4609,4613,4617,4621,4625,4629],{"type":396,"tag":434,"props":4610,"children":4611},{"style":579},[4612],{"type":402,"value":1893},{"type":396,"tag":434,"props":4614,"children":4615},{"style":1407},[4616],{"type":402,"value":2314},{"type":396,"tag":434,"props":4618,"children":4619},{"style":687},[4620],{"type":402,"value":811},{"type":396,"tag":434,"props":4622,"children":4623},{"style":687},[4624],{"type":402,"value":1419},{"type":396,"tag":434,"props":4626,"children":4627},{"style":463},[4628],{"type":402,"value":2093},{"type":396,"tag":434,"props":4630,"children":4631},{"style":451},[4632],{"type":402,"value":1428},{"type":396,"tag":434,"props":4634,"children":4635},{"class":436,"line":535},[4636,4641,4645,4650,4654],{"type":396,"tag":434,"props":4637,"children":4638},{"style":451},[4639],{"type":402,"value":4640},"app",{"type":396,"tag":434,"props":4642,"children":4643},{"style":457},[4644],{"type":402,"value":460},{"type":396,"tag":434,"props":4646,"children":4647},{"style":451},[4648],{"type":402,"value":4649},"vx ",{"type":396,"tag":434,"props":4651,"children":4652},{"style":687},[4653],{"type":402,"value":690},{"type":396,"tag":434,"props":4655,"children":4656},{"style":451},[4657],{"type":402,"value":4658}," vx\n",{"type":396,"tag":434,"props":4660,"children":4661},{"class":436,"line":590},[4662,4666,4670,4675,4679,4683,4687],{"type":396,"tag":434,"props":4663,"children":4664},{"style":451},[4665],{"type":402,"value":4640},{"type":396,"tag":434,"props":4667,"children":4668},{"style":457},[4669],{"type":402,"value":460},{"type":396,"tag":434,"props":4671,"children":4672},{"style":451},[4673],{"type":402,"value":4674},"store ",{"type":396,"tag":434,"props":4676,"children":4677},{"style":687},[4678],{"type":402,"value":690},{"type":396,"tag":434,"props":4680,"children":4681},{"style":451},[4682],{"type":402,"value":2314},{"type":396,"tag":434,"props":4684,"children":4685},{"style":457},[4686],{"type":402,"value":460},{"type":396,"tag":434,"props":4688,"children":4689},{"style":451},[4690],{"type":402,"value":4691},"store\n",{"type":396,"tag":434,"props":4693,"children":4694},{"class":436,"line":638},[4695,4699,4703,4707,4711,4715,4719,4723,4728,4732,4736,4740,4745,4749],{"type":396,"tag":434,"props":4696,"children":4697},{"style":451},[4698],{"type":402,"value":4640},{"type":396,"tag":434,"props":4700,"children":4701},{"style":457},[4702],{"type":402,"value":460},{"type":396,"tag":434,"props":4704,"children":4705},{"style":451},[4706],{"type":402,"value":454},{"type":396,"tag":434,"props":4708,"children":4709},{"style":457},[4710],{"type":402,"value":460},{"type":396,"tag":434,"props":4712,"children":4713},{"style":463},[4714],{"type":402,"value":466},{"type":396,"tag":434,"props":4716,"children":4717},{"style":451},[4718],{"type":402,"value":471},{"type":396,"tag":434,"props":4720,"children":4721},{"style":474},[4722],{"type":402,"value":477},{"type":396,"tag":434,"props":4724,"children":4725},{"style":480},[4726],{"type":402,"value":4727},"userType",{"type":396,"tag":434,"props":4729,"children":4730},{"style":474},[4731],{"type":402,"value":477},{"type":396,"tag":434,"props":4733,"children":4734},{"style":457},[4735],{"type":402,"value":492},{"type":396,"tag":434,"props":4737,"children":4738},{"style":474},[4739],{"type":402,"value":4241},{"type":396,"tag":434,"props":4741,"children":4742},{"style":480},[4743],{"type":402,"value":4744},"商户",{"type":396,"tag":434,"props":4746,"children":4747},{"style":474},[4748],{"type":402,"value":477},{"type":396,"tag":434,"props":4750,"children":4751},{"style":451},[4752],{"type":402,"value":523},{"type":396,"tag":434,"props":4754,"children":4755},{"class":436,"line":651},[4756],{"type":396,"tag":434,"props":4757,"children":4758},{"emptyLinePlaceholder":388},[4759],{"type":402,"value":3156},{"type":396,"tag":434,"props":4761,"children":4762},{"class":436,"line":905},[4763],{"type":396,"tag":434,"props":4764,"children":4765},{"style":441},[4766],{"type":402,"value":4767},"// page a\n",{"type":396,"tag":434,"props":4769,"children":4770},{"class":436,"line":914},[4771,4776,4781],{"type":396,"tag":434,"props":4772,"children":4773},{"style":463},[4774],{"type":402,"value":4775},"onLoad",{"type":396,"tag":434,"props":4777,"children":4778},{"style":451},[4779],{"type":402,"value":4780}," () ",{"type":396,"tag":434,"props":4782,"children":4783},{"style":457},[4784],{"type":402,"value":1396},{"type":396,"tag":434,"props":4786,"children":4787},{"class":436,"line":949},[4788,4793,4797,4801,4805,4809,4813,4817,4821,4825,4829,4834,4838],{"type":396,"tag":434,"props":4789,"children":4790},{"style":451},[4791],{"type":402,"value":4792},"  app",{"type":396,"tag":434,"props":4794,"children":4795},{"style":457},[4796],{"type":402,"value":460},{"type":396,"tag":434,"props":4798,"children":4799},{"style":451},[4800],{"type":402,"value":454},{"type":396,"tag":434,"props":4802,"children":4803},{"style":457},[4804],{"type":402,"value":460},{"type":396,"tag":434,"props":4806,"children":4807},{"style":463},[4808],{"type":402,"value":549},{"type":396,"tag":434,"props":4810,"children":4811},{"style":500},[4812],{"type":402,"value":471},{"type":396,"tag":434,"props":4814,"children":4815},{"style":474},[4816],{"type":402,"value":477},{"type":396,"tag":434,"props":4818,"children":4819},{"style":480},[4820],{"type":402,"value":4727},{"type":396,"tag":434,"props":4822,"children":4823},{"style":474},[4824],{"type":402,"value":477},{"type":396,"tag":434,"props":4826,"children":4827},{"style":457},[4828],{"type":402,"value":492},{"type":396,"tag":434,"props":4830,"children":4831},{"style":573},[4832],{"type":402,"value":4833}," userType",{"type":396,"tag":434,"props":4835,"children":4836},{"style":579},[4837],{"type":402,"value":582},{"type":396,"tag":434,"props":4839,"children":4840},{"style":457},[4841],{"type":402,"value":587},{"type":396,"tag":434,"props":4843,"children":4844},{"class":436,"line":1013},[4845,4849,4853,4857,4861,4865,4869,4873,4877],{"type":396,"tag":434,"props":4846,"children":4847},{"style":1222},[4848],{"type":402,"value":2993},{"type":396,"tag":434,"props":4850,"children":4851},{"style":500},[4852],{"type":402,"value":846},{"type":396,"tag":434,"props":4854,"children":4855},{"style":451},[4856],{"type":402,"value":4727},{"type":396,"tag":434,"props":4858,"children":4859},{"style":687},[4860],{"type":402,"value":1598},{"type":396,"tag":434,"props":4862,"children":4863},{"style":474},[4864],{"type":402,"value":4241},{"type":396,"tag":434,"props":4866,"children":4867},{"style":480},[4868],{"type":402,"value":4744},{"type":396,"tag":434,"props":4870,"children":4871},{"style":474},[4872],{"type":402,"value":477},{"type":396,"tag":434,"props":4874,"children":4875},{"style":500},[4876],{"type":402,"value":1607},{"type":396,"tag":434,"props":4878,"children":4879},{"style":457},[4880],{"type":402,"value":1396},{"type":396,"tag":434,"props":4882,"children":4883},{"class":436,"line":1021},[4884],{"type":396,"tag":434,"props":4885,"children":4886},{"style":441},[4887],{"type":402,"value":4888},"      // ...\n",{"type":396,"tag":434,"props":4890,"children":4891},{"class":436,"line":1249},[4892,4896,4900,4904,4908,4912,4916,4920,4925,4929,4933],{"type":396,"tag":434,"props":4893,"children":4894},{"style":457},[4895],{"type":402,"value":3602},{"type":396,"tag":434,"props":4897,"children":4898},{"style":1222},[4899],{"type":402,"value":4295},{"type":396,"tag":434,"props":4901,"children":4902},{"style":1222},[4903],{"type":402,"value":4300},{"type":396,"tag":434,"props":4905,"children":4906},{"style":500},[4907],{"type":402,"value":846},{"type":396,"tag":434,"props":4909,"children":4910},{"style":451},[4911],{"type":402,"value":4727},{"type":396,"tag":434,"props":4913,"children":4914},{"style":687},[4915],{"type":402,"value":1598},{"type":396,"tag":434,"props":4917,"children":4918},{"style":474},[4919],{"type":402,"value":4241},{"type":396,"tag":434,"props":4921,"children":4922},{"style":480},[4923],{"type":402,"value":4924},"管理员",{"type":396,"tag":434,"props":4926,"children":4927},{"style":474},[4928],{"type":402,"value":477},{"type":396,"tag":434,"props":4930,"children":4931},{"style":500},[4932],{"type":402,"value":1607},{"type":396,"tag":434,"props":4934,"children":4935},{"style":457},[4936],{"type":402,"value":1396},{"type":396,"tag":434,"props":4938,"children":4939},{"class":436,"line":1274},[4940],{"type":396,"tag":434,"props":4941,"children":4942},{"style":441},[4943],{"type":402,"value":4888},{"type":396,"tag":434,"props":4945,"children":4946},{"class":436,"line":1292},[4947],{"type":396,"tag":434,"props":4948,"children":4949},{"style":457},[4950],{"type":402,"value":1687},{"type":396,"tag":434,"props":4952,"children":4953},{"class":436,"line":1300},[4954,4959],{"type":396,"tag":434,"props":4955,"children":4956},{"style":457},[4957],{"type":402,"value":4958},"  },",{"type":396,"tag":434,"props":4960,"children":4961},{"style":457},[4962],{"type":402,"value":587},{"type":396,"tag":434,"props":4964,"children":4965},{"class":436,"line":1309},[4966,4971,4975],{"type":396,"tag":434,"props":4967,"children":4968},{"style":500},[4969],{"type":402,"value":4970},"    immediate",{"type":396,"tag":434,"props":4972,"children":4973},{"style":457},[4974],{"type":402,"value":508},{"type":396,"tag":434,"props":4976,"children":4977},{"style":1148},[4978],{"type":402,"value":4979}," true\n",{"type":396,"tag":434,"props":4981,"children":4982},{"class":436,"line":2787},[4983,4987],{"type":396,"tag":434,"props":4984,"children":4985},{"style":457},[4986],{"type":402,"value":1695},{"type":396,"tag":434,"props":4988,"children":4989},{"style":500},[4990],{"type":402,"value":523},{"type":396,"tag":434,"props":4992,"children":4993},{"class":436,"line":2800},[4994],{"type":396,"tag":434,"props":4995,"children":4996},{"style":457},[4997],{"type":402,"value":1027},{"type":396,"tag":434,"props":4999,"children":5000},{"class":436,"line":2808},[5001],{"type":396,"tag":434,"props":5002,"children":5003},{"emptyLinePlaceholder":388},[5004],{"type":402,"value":3156},{"type":396,"tag":434,"props":5006,"children":5007},{"class":436,"line":3375},[5008],{"type":396,"tag":434,"props":5009,"children":5010},{"style":441},[5011],{"type":402,"value":5012},"// page b\n",{"type":396,"tag":434,"props":5014,"children":5015},{"class":436,"line":3404},[5016,5021,5025],{"type":396,"tag":434,"props":5017,"children":5018},{"style":463},[5019],{"type":402,"value":5020},"switchUserType",{"type":396,"tag":434,"props":5022,"children":5023},{"style":451},[5024],{"type":402,"value":4780},{"type":396,"tag":434,"props":5026,"children":5027},{"style":457},[5028],{"type":402,"value":1396},{"type":396,"tag":434,"props":5030,"children":5031},{"class":436,"line":3445},[5032,5036,5040,5044,5048,5052,5056,5060,5064],{"type":396,"tag":434,"props":5033,"children":5034},{"style":451},[5035],{"type":402,"value":4792},{"type":396,"tag":434,"props":5037,"children":5038},{"style":457},[5039],{"type":402,"value":460},{"type":396,"tag":434,"props":5041,"children":5042},{"style":451},[5043],{"type":402,"value":2128},{"type":396,"tag":434,"props":5045,"children":5046},{"style":457},[5047],{"type":402,"value":460},{"type":396,"tag":434,"props":5049,"children":5050},{"style":451},[5051],{"type":402,"value":4727},{"type":396,"tag":434,"props":5053,"children":5054},{"style":687},[5055],{"type":402,"value":811},{"type":396,"tag":434,"props":5057,"children":5058},{"style":474},[5059],{"type":402,"value":4241},{"type":396,"tag":434,"props":5061,"children":5062},{"style":480},[5063],{"type":402,"value":4924},{"type":396,"tag":434,"props":5065,"children":5066},{"style":474},[5067],{"type":402,"value":4605},{"type":396,"tag":434,"props":5069,"children":5070},{"class":436,"line":3466},[5071],{"type":396,"tag":434,"props":5072,"children":5073},{"style":457},[5074],{"type":402,"value":1027},{"type":396,"tag":397,"props":5076,"children":5078},{"id":5077},"可能遇到的问题",[5079],{"type":402,"value":5077},{"type":396,"tag":1047,"props":5081,"children":5083},{"id":5082},"给-watch-方法添加的函数设置立即执行",[5084],{"type":402,"value":5085},"给 watch 方法添加的函数设置立即执行",{"type":396,"tag":404,"props":5087,"children":5088},{},[5089],{"type":402,"value":5090},"有的时候我们希望通过 watch 添加函数的同时还立即执行该函数一次, 这个时候我们需要再定义额外的参数传递到 watch 中. 问题是这个函数不一定是同步函数.",{"type":396,"tag":404,"props":5092,"children":5093},{},[5094],{"type":402,"value":5095},"简单处理如下:",{"type":396,"tag":424,"props":5097,"children":5099},{"className":426,"code":5098,"language":428,"meta":389,"style":389},"class VX {\n  async watch (key, fn, options = { immediately: false }, obj = this.store) {\n    handleDep = fn\n    walkChains(key, obj)\n    options.immediately && await fn(options.defaultParams)\n  }\n}\n",[5100],{"type":396,"tag":410,"props":5101,"children":5102},{"__ignoreMap":389},[5103,5118,5211,5227,5254,5306,5313],{"type":396,"tag":434,"props":5104,"children":5105},{"class":436,"line":437},[5106,5110,5114],{"type":396,"tag":434,"props":5107,"children":5108},{"style":579},[5109],{"type":402,"value":761},{"type":396,"tag":434,"props":5111,"children":5112},{"style":764},[5113],{"type":402,"value":2093},{"type":396,"tag":434,"props":5115,"children":5116},{"style":457},[5117],{"type":402,"value":587},{"type":396,"tag":434,"props":5119,"children":5120},{"class":436,"line":447},[5121,5127,5132,5136,5140,5144,5148,5152,5156,5160,5164,5169,5173,5178,5183,5187,5191,5195,5199,5203,5207],{"type":396,"tag":434,"props":5122,"children":5124},{"style":5123},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[5125],{"type":402,"value":5126},"  async",{"type":396,"tag":434,"props":5128,"children":5129},{"style":838},[5130],{"type":402,"value":5131}," watch",{"type":396,"tag":434,"props":5133,"children":5134},{"style":457},[5135],{"type":402,"value":846},{"type":396,"tag":434,"props":5137,"children":5138},{"style":573},[5139],{"type":402,"value":2184},{"type":396,"tag":434,"props":5141,"children":5142},{"style":457},[5143],{"type":402,"value":492},{"type":396,"tag":434,"props":5145,"children":5146},{"style":573},[5147],{"type":402,"value":2193},{"type":396,"tag":434,"props":5149,"children":5150},{"style":457},[5151],{"type":402,"value":492},{"type":396,"tag":434,"props":5153,"children":5154},{"style":573},[5155],{"type":402,"value":2259},{"type":396,"tag":434,"props":5157,"children":5158},{"style":687},[5159],{"type":402,"value":811},{"type":396,"tag":434,"props":5161,"children":5162},{"style":457},[5163],{"type":402,"value":497},{"type":396,"tag":434,"props":5165,"children":5166},{"style":500},[5167],{"type":402,"value":5168}," immediately",{"type":396,"tag":434,"props":5170,"children":5171},{"style":457},[5172],{"type":402,"value":508},{"type":396,"tag":434,"props":5174,"children":5175},{"style":1148},[5176],{"type":402,"value":5177}," false",{"type":396,"tag":434,"props":5179,"children":5180},{"style":457},[5181],{"type":402,"value":5182}," },",{"type":396,"tag":434,"props":5184,"children":5185},{"style":573},[5186],{"type":402,"value":2202},{"type":396,"tag":434,"props":5188,"children":5189},{"style":687},[5190],{"type":402,"value":811},{"type":396,"tag":434,"props":5192,"children":5193},{"style":794},[5194],{"type":402,"value":1382},{"type":396,"tag":434,"props":5196,"children":5197},{"style":457},[5198],{"type":402,"value":460},{"type":396,"tag":434,"props":5200,"children":5201},{"style":451},[5202],{"type":402,"value":2128},{"type":396,"tag":434,"props":5204,"children":5205},{"style":457},[5206],{"type":402,"value":856},{"type":396,"tag":434,"props":5208,"children":5209},{"style":457},[5210],{"type":402,"value":587},{"type":396,"tag":434,"props":5212,"children":5213},{"class":436,"line":526},[5214,5219,5223],{"type":396,"tag":434,"props":5215,"children":5216},{"style":451},[5217],{"type":402,"value":5218},"    handleDep",{"type":396,"tag":434,"props":5220,"children":5221},{"style":687},[5222],{"type":402,"value":811},{"type":396,"tag":434,"props":5224,"children":5225},{"style":451},[5226],{"type":402,"value":3262},{"type":396,"tag":434,"props":5228,"children":5229},{"class":436,"line":535},[5230,5234,5238,5242,5246,5250],{"type":396,"tag":434,"props":5231,"children":5232},{"style":463},[5233],{"type":402,"value":3943},{"type":396,"tag":434,"props":5235,"children":5236},{"style":500},[5237],{"type":402,"value":471},{"type":396,"tag":434,"props":5239,"children":5240},{"style":451},[5241],{"type":402,"value":2184},{"type":396,"tag":434,"props":5243,"children":5244},{"style":457},[5245],{"type":402,"value":492},{"type":396,"tag":434,"props":5247,"children":5248},{"style":451},[5249],{"type":402,"value":2202},{"type":396,"tag":434,"props":5251,"children":5252},{"style":500},[5253],{"type":402,"value":523},{"type":396,"tag":434,"props":5255,"children":5256},{"class":436,"line":590},[5257,5262,5266,5271,5275,5280,5284,5288,5293,5297,5302],{"type":396,"tag":434,"props":5258,"children":5259},{"style":451},[5260],{"type":402,"value":5261},"    options",{"type":396,"tag":434,"props":5263,"children":5264},{"style":457},[5265],{"type":402,"value":460},{"type":396,"tag":434,"props":5267,"children":5268},{"style":451},[5269],{"type":402,"value":5270},"immediately",{"type":396,"tag":434,"props":5272,"children":5273},{"style":687},[5274],{"type":402,"value":3006},{"type":396,"tag":434,"props":5276,"children":5277},{"style":1222},[5278],{"type":402,"value":5279}," await",{"type":396,"tag":434,"props":5281,"children":5282},{"style":463},[5283],{"type":402,"value":2193},{"type":396,"tag":434,"props":5285,"children":5286},{"style":500},[5287],{"type":402,"value":471},{"type":396,"tag":434,"props":5289,"children":5290},{"style":451},[5291],{"type":402,"value":5292},"options",{"type":396,"tag":434,"props":5294,"children":5295},{"style":457},[5296],{"type":402,"value":460},{"type":396,"tag":434,"props":5298,"children":5299},{"style":451},[5300],{"type":402,"value":5301},"defaultParams",{"type":396,"tag":434,"props":5303,"children":5304},{"style":500},[5305],{"type":402,"value":523},{"type":396,"tag":434,"props":5307,"children":5308},{"class":436,"line":638},[5309],{"type":396,"tag":434,"props":5310,"children":5311},{"style":457},[5312],{"type":402,"value":824},{"type":396,"tag":434,"props":5314,"children":5315},{"class":436,"line":651},[5316],{"type":396,"tag":434,"props":5317,"children":5318},{"style":457},[5319],{"type":402,"value":1027},{"type":396,"tag":1047,"props":5321,"children":5323},{"id":5322},"this-绑定丢失问题",[5324],{"type":402,"value":5325},"this 绑定丢失问题",{"type":396,"tag":404,"props":5327,"children":5328},{},[5329],{"type":402,"value":5330},"在我在对 VX 进行删除属性方法的扩展时, 我往 walkChain 函数中添加了一个执行回调函数的机制, 并且在删除属性这个方法直接调用了 walkChain:",{"type":396,"tag":424,"props":5332,"children":5334},{"className":426,"code":5333,"language":428,"meta":389,"style":389},"  function walkChains (key, obj, fn) {\n    const segments = key.split('.')\n    let deepObj = obj\n    while (segments.length) {\n      deepObj = deepObj[segments.shift()]\n      fn && fn()\n    }\n  }\n",[5335],{"type":396,"tag":410,"props":5336,"children":5337},{"__ignoreMap":389},[5338,5382,5429,5449,5481,5517,5537,5544],{"type":396,"tag":434,"props":5339,"children":5340},{"class":436,"line":437},[5341,5346,5350,5354,5358,5362,5366,5370,5374,5378],{"type":396,"tag":434,"props":5342,"children":5343},{"style":579},[5344],{"type":402,"value":5345},"  function",{"type":396,"tag":434,"props":5347,"children":5348},{"style":463},[5349],{"type":402,"value":3669},{"type":396,"tag":434,"props":5351,"children":5352},{"style":457},[5353],{"type":402,"value":846},{"type":396,"tag":434,"props":5355,"children":5356},{"style":573},[5357],{"type":402,"value":2184},{"type":396,"tag":434,"props":5359,"children":5360},{"style":457},[5361],{"type":402,"value":492},{"type":396,"tag":434,"props":5363,"children":5364},{"style":573},[5365],{"type":402,"value":2202},{"type":396,"tag":434,"props":5367,"children":5368},{"style":457},[5369],{"type":402,"value":492},{"type":396,"tag":434,"props":5371,"children":5372},{"style":573},[5373],{"type":402,"value":2193},{"type":396,"tag":434,"props":5375,"children":5376},{"style":457},[5377],{"type":402,"value":856},{"type":396,"tag":434,"props":5379,"children":5380},{"style":457},[5381],{"type":402,"value":587},{"type":396,"tag":434,"props":5383,"children":5384},{"class":436,"line":447},[5385,5389,5393,5397,5401,5405,5409,5413,5417,5421,5425],{"type":396,"tag":434,"props":5386,"children":5387},{"style":579},[5388],{"type":402,"value":3381},{"type":396,"tag":434,"props":5390,"children":5391},{"style":1407},[5392],{"type":402,"value":3705},{"type":396,"tag":434,"props":5394,"children":5395},{"style":687},[5396],{"type":402,"value":811},{"type":396,"tag":434,"props":5398,"children":5399},{"style":451},[5400],{"type":402,"value":1117},{"type":396,"tag":434,"props":5402,"children":5403},{"style":457},[5404],{"type":402,"value":460},{"type":396,"tag":434,"props":5406,"children":5407},{"style":463},[5408],{"type":402,"value":3722},{"type":396,"tag":434,"props":5410,"children":5411},{"style":500},[5412],{"type":402,"value":471},{"type":396,"tag":434,"props":5414,"children":5415},{"style":474},[5416],{"type":402,"value":477},{"type":396,"tag":434,"props":5418,"children":5419},{"style":480},[5420],{"type":402,"value":460},{"type":396,"tag":434,"props":5422,"children":5423},{"style":474},[5424],{"type":402,"value":477},{"type":396,"tag":434,"props":5426,"children":5427},{"style":500},[5428],{"type":402,"value":523},{"type":396,"tag":434,"props":5430,"children":5431},{"class":436,"line":526},[5432,5437,5441,5445],{"type":396,"tag":434,"props":5433,"children":5434},{"style":579},[5435],{"type":402,"value":5436},"    let",{"type":396,"tag":434,"props":5438,"children":5439},{"style":451},[5440],{"type":402,"value":3754},{"type":396,"tag":434,"props":5442,"children":5443},{"style":687},[5444],{"type":402,"value":811},{"type":396,"tag":434,"props":5446,"children":5447},{"style":451},[5448],{"type":402,"value":3763},{"type":396,"tag":434,"props":5450,"children":5451},{"class":436,"line":535},[5452,5457,5461,5465,5469,5473,5477],{"type":396,"tag":434,"props":5453,"children":5454},{"style":1222},[5455],{"type":402,"value":5456},"    while",{"type":396,"tag":434,"props":5458,"children":5459},{"style":500},[5460],{"type":402,"value":846},{"type":396,"tag":434,"props":5462,"children":5463},{"style":451},[5464],{"type":402,"value":3780},{"type":396,"tag":434,"props":5466,"children":5467},{"style":457},[5468],{"type":402,"value":460},{"type":396,"tag":434,"props":5470,"children":5471},{"style":1407},[5472],{"type":402,"value":3789},{"type":396,"tag":434,"props":5474,"children":5475},{"style":500},[5476],{"type":402,"value":1607},{"type":396,"tag":434,"props":5478,"children":5479},{"style":457},[5480],{"type":402,"value":1396},{"type":396,"tag":434,"props":5482,"children":5483},{"class":436,"line":590},[5484,5489,5493,5497,5501,5505,5509,5513],{"type":396,"tag":434,"props":5485,"children":5486},{"style":451},[5487],{"type":402,"value":5488},"      deepObj",{"type":396,"tag":434,"props":5490,"children":5491},{"style":687},[5492],{"type":402,"value":811},{"type":396,"tag":434,"props":5494,"children":5495},{"style":451},[5496],{"type":402,"value":3754},{"type":396,"tag":434,"props":5498,"children":5499},{"style":500},[5500],{"type":402,"value":3818},{"type":396,"tag":434,"props":5502,"children":5503},{"style":451},[5504],{"type":402,"value":3780},{"type":396,"tag":434,"props":5506,"children":5507},{"style":457},[5508],{"type":402,"value":460},{"type":396,"tag":434,"props":5510,"children":5511},{"style":463},[5512],{"type":402,"value":3831},{"type":396,"tag":434,"props":5514,"children":5515},{"style":500},[5516],{"type":402,"value":3836},{"type":396,"tag":434,"props":5518,"children":5519},{"class":436,"line":638},[5520,5525,5529,5533],{"type":396,"tag":434,"props":5521,"children":5522},{"style":451},[5523],{"type":402,"value":5524},"      fn",{"type":396,"tag":434,"props":5526,"children":5527},{"style":687},[5528],{"type":402,"value":3006},{"type":396,"tag":434,"props":5530,"children":5531},{"style":463},[5532],{"type":402,"value":2193},{"type":396,"tag":434,"props":5534,"children":5535},{"style":500},[5536],{"type":402,"value":1428},{"type":396,"tag":434,"props":5538,"children":5539},{"class":436,"line":651},[5540],{"type":396,"tag":434,"props":5541,"children":5542},{"style":457},[5543],{"type":402,"value":1687},{"type":396,"tag":434,"props":5545,"children":5546},{"class":436,"line":905},[5547],{"type":396,"tag":434,"props":5548,"children":5549},{"style":457},[5550],{"type":402,"value":824},{"type":396,"tag":424,"props":5552,"children":5554},{"className":426,"code":5553,"language":428,"meta":389,"style":389},"del (key, obj = this.store) {\n  walkChains(key, obj, handleDep.clear)\n  delete obj[key]\n}\n",[5555],{"type":396,"tag":410,"props":5556,"children":5557},{"__ignoreMap":389},[5558,5598,5644,5668],{"type":396,"tag":434,"props":5559,"children":5560},{"class":436,"line":437},[5561,5566,5570,5574,5578,5582,5586,5590,5594],{"type":396,"tag":434,"props":5562,"children":5563},{"style":463},[5564],{"type":402,"value":5565},"del",{"type":396,"tag":434,"props":5567,"children":5568},{"style":451},[5569],{"type":402,"value":1342},{"type":396,"tag":434,"props":5571,"children":5572},{"style":457},[5573],{"type":402,"value":492},{"type":396,"tag":434,"props":5575,"children":5576},{"style":451},[5577],{"type":402,"value":1373},{"type":396,"tag":434,"props":5579,"children":5580},{"style":687},[5581],{"type":402,"value":690},{"type":396,"tag":434,"props":5583,"children":5584},{"style":794},[5585],{"type":402,"value":1382},{"type":396,"tag":434,"props":5587,"children":5588},{"style":457},[5589],{"type":402,"value":460},{"type":396,"tag":434,"props":5591,"children":5592},{"style":451},[5593],{"type":402,"value":1391},{"type":396,"tag":434,"props":5595,"children":5596},{"style":457},[5597],{"type":402,"value":1396},{"type":396,"tag":434,"props":5599,"children":5600},{"class":436,"line":447},[5601,5606,5610,5614,5618,5622,5626,5631,5635,5640],{"type":396,"tag":434,"props":5602,"children":5603},{"style":463},[5604],{"type":402,"value":5605},"  walkChains",{"type":396,"tag":434,"props":5607,"children":5608},{"style":500},[5609],{"type":402,"value":471},{"type":396,"tag":434,"props":5611,"children":5612},{"style":451},[5613],{"type":402,"value":2184},{"type":396,"tag":434,"props":5615,"children":5616},{"style":457},[5617],{"type":402,"value":492},{"type":396,"tag":434,"props":5619,"children":5620},{"style":451},[5621],{"type":402,"value":2202},{"type":396,"tag":434,"props":5623,"children":5624},{"style":457},[5625],{"type":402,"value":492},{"type":396,"tag":434,"props":5627,"children":5628},{"style":451},[5629],{"type":402,"value":5630}," handleDep",{"type":396,"tag":434,"props":5632,"children":5633},{"style":457},[5634],{"type":402,"value":460},{"type":396,"tag":434,"props":5636,"children":5637},{"style":451},[5638],{"type":402,"value":5639},"clear",{"type":396,"tag":434,"props":5641,"children":5642},{"style":500},[5643],{"type":402,"value":523},{"type":396,"tag":434,"props":5645,"children":5646},{"class":436,"line":526},[5647,5652,5656,5660,5664],{"type":396,"tag":434,"props":5648,"children":5649},{"style":687},[5650],{"type":402,"value":5651},"  delete",{"type":396,"tag":434,"props":5653,"children":5654},{"style":451},[5655],{"type":402,"value":2202},{"type":396,"tag":434,"props":5657,"children":5658},{"style":500},[5659],{"type":402,"value":3818},{"type":396,"tag":434,"props":5661,"children":5662},{"style":451},[5663],{"type":402,"value":2184},{"type":396,"tag":434,"props":5665,"children":5666},{"style":500},[5667],{"type":402,"value":4204},{"type":396,"tag":434,"props":5669,"children":5670},{"class":436,"line":535},[5671],{"type":396,"tag":434,"props":5672,"children":5673},{"style":457},[5674],{"type":402,"value":1027},{"type":396,"tag":404,"props":5676,"children":5677},{},[5678,5680,5685],{"type":402,"value":5679},"因为 handleDep.clear 当成参数传递进 walkChains 中会",{"type":396,"tag":740,"props":5681,"children":5682},{},[5683],{"type":402,"value":5684},"丢失 this 绑定",{"type":402,"value":5686},", 所以上面那段代码其实是有问题的, 不过稍作修改就好了:",{"type":396,"tag":424,"props":5688,"children":5690},{"className":426,"code":5689,"language":428,"meta":389,"style":389},"  del (key, obj = this.store) {\n    walkChains(key, obj, () => handleDep.clear())\n    delete obj[key]\n  }\n",[5691],{"type":396,"tag":410,"props":5692,"children":5693},{"__ignoreMap":389},[5694,5734,5786,5810],{"type":396,"tag":434,"props":5695,"children":5696},{"class":436,"line":437},[5697,5702,5706,5710,5714,5718,5722,5726,5730],{"type":396,"tag":434,"props":5698,"children":5699},{"style":463},[5700],{"type":402,"value":5701},"  del",{"type":396,"tag":434,"props":5703,"children":5704},{"style":451},[5705],{"type":402,"value":1342},{"type":396,"tag":434,"props":5707,"children":5708},{"style":457},[5709],{"type":402,"value":492},{"type":396,"tag":434,"props":5711,"children":5712},{"style":451},[5713],{"type":402,"value":1373},{"type":396,"tag":434,"props":5715,"children":5716},{"style":687},[5717],{"type":402,"value":690},{"type":396,"tag":434,"props":5719,"children":5720},{"style":794},[5721],{"type":402,"value":1382},{"type":396,"tag":434,"props":5723,"children":5724},{"style":457},[5725],{"type":402,"value":460},{"type":396,"tag":434,"props":5727,"children":5728},{"style":451},[5729],{"type":402,"value":1391},{"type":396,"tag":434,"props":5731,"children":5732},{"style":457},[5733],{"type":402,"value":1396},{"type":396,"tag":434,"props":5735,"children":5736},{"class":436,"line":447},[5737,5741,5745,5749,5753,5757,5761,5765,5769,5773,5777,5781],{"type":396,"tag":434,"props":5738,"children":5739},{"style":463},[5740],{"type":402,"value":3943},{"type":396,"tag":434,"props":5742,"children":5743},{"style":500},[5744],{"type":402,"value":471},{"type":396,"tag":434,"props":5746,"children":5747},{"style":451},[5748],{"type":402,"value":2184},{"type":396,"tag":434,"props":5750,"children":5751},{"style":457},[5752],{"type":402,"value":492},{"type":396,"tag":434,"props":5754,"children":5755},{"style":451},[5756],{"type":402,"value":2202},{"type":396,"tag":434,"props":5758,"children":5759},{"style":457},[5760],{"type":402,"value":492},{"type":396,"tag":434,"props":5762,"children":5763},{"style":457},[5764],{"type":402,"value":784},{"type":396,"tag":434,"props":5766,"children":5767},{"style":579},[5768],{"type":402,"value":582},{"type":396,"tag":434,"props":5770,"children":5771},{"style":451},[5772],{"type":402,"value":5630},{"type":396,"tag":434,"props":5774,"children":5775},{"style":457},[5776],{"type":402,"value":460},{"type":396,"tag":434,"props":5778,"children":5779},{"style":463},[5780],{"type":402,"value":5639},{"type":396,"tag":434,"props":5782,"children":5783},{"style":500},[5784],{"type":402,"value":5785},"())\n",{"type":396,"tag":434,"props":5787,"children":5788},{"class":436,"line":526},[5789,5794,5798,5802,5806],{"type":396,"tag":434,"props":5790,"children":5791},{"style":687},[5792],{"type":402,"value":5793},"    delete",{"type":396,"tag":434,"props":5795,"children":5796},{"style":451},[5797],{"type":402,"value":2202},{"type":396,"tag":434,"props":5799,"children":5800},{"style":500},[5801],{"type":402,"value":3818},{"type":396,"tag":434,"props":5803,"children":5804},{"style":451},[5805],{"type":402,"value":2184},{"type":396,"tag":434,"props":5807,"children":5808},{"style":500},[5809],{"type":402,"value":4204},{"type":396,"tag":434,"props":5811,"children":5812},{"class":436,"line":535},[5813],{"type":396,"tag":434,"props":5814,"children":5815},{"style":457},[5816],{"type":402,"value":824},{"type":396,"tag":397,"props":5818,"children":5820},{"id":5819},"后语",[5821],{"type":402,"value":5819},{"type":396,"tag":404,"props":5823,"children":5824},{},[5825],{"type":402,"value":5826},"在这篇文章中, 我们通过对 defineProperty 进行封装, 实现了一个简单的对象属性侦听器的功能, 以弥补小程序所没有的$watch 能力. 在此基础上, 各位可以再对 VX 进行扩展, 更方便地去书写业务代码.",{"type":396,"tag":404,"props":5828,"children":5829},{},[5830,5832],{"type":402,"value":5831},"完整代码 ",{"type":396,"tag":666,"props":5833,"children":5837},{"href":5834,"rel":5835},"https://github.com/Lionad-Morotar/media-gear/blob/master/src/renderer/utils/suites/vx/index.js",[5836],"nofollow",[5838],{"type":402,"value":5839},"GitHub 直达",{"type":396,"tag":5841,"props":5842,"children":5843},"style",{},[5844],{"type":402,"value":5845},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":389,"searchDepth":447,"depth":447,"links":5847},[5848,5849,5850,5851,5854,5859,5860,5863,5867],{"id":399,"depth":447,"text":399},{"id":721,"depth":447,"text":721},{"id":731,"depth":447,"text":731},{"id":1043,"depth":447,"text":1043,"children":5852},[5853],{"id":1049,"depth":526,"text":1052},{"id":2028,"depth":447,"text":2031,"children":5855},[5856,5857,5858],{"id":2034,"depth":526,"text":2034},{"id":2066,"depth":526,"text":2069},{"id":2816,"depth":526,"text":2816},{"id":3625,"depth":447,"text":3628},{"id":4528,"depth":447,"text":4528,"children":5861},[5862],{"id":4533,"depth":526,"text":4533},{"id":5077,"depth":447,"text":5077,"children":5864},[5865,5866],{"id":5082,"depth":526,"text":5085},{"id":5322,"depth":526,"text":5325},{"id":5819,"depth":447,"text":5819},"markdown","content:_achieved:2019-05:reactive-in-150loc.md","content","_achieved/2019-05/reactive-in-150loc.md","_achieved/2019-05/reactive-in-150loc","md",[5875,5878],{"_path":5876,"title":5877,"description":389},"/_achieved/2018-10/noname","🌆 无题",{"_path":5879,"title":5880,"description":389},"/_achieved/2019-06/messy-in-two-years","💖 聊聊此次离职，毕业，及其它杂乱的事情",1742040364094]