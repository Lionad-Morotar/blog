[{"data":1,"prerenderedAt":5652},["ShallowReactive",2],{"navigation":3,"/_achieved/2019-05/reactive-in-150loc":155,"/_achieved/2019-05/reactive-in-150loc-surround":5645},[4,35,86,92,119,125,149],{"title":5,"_path":6,"children":7},"心流思绪 / Heart Flows","/flows",[8,11,14,17,20,23,26,29,32],{"title":9,"_path":10},"📕 狮子的书单推荐","/flows/books",{"title":12,"_path":13},"🚝 四十二篇系列","/flows/fourty-two",{"title":15,"_path":16},"🌃 长夜梦","/flows/long-night-dream",{"title":18,"_path":19},"🌌 万物联结与幸福感","/flows/everything",{"title":21,"_path":22},"⌛ 偷取时间","/flows/stealing-time-from-god",{"title":24,"_path":25},"🌆 表达和孤独","/flows/expression-and-loneliness",{"title":27,"_path":28},"🌧️ 我的腼腆","/flows/shy",{"title":30,"_path":31},"🥛 新工作，喝新饮料","/flows/drinking-while-thinking",{"title":33,"_path":34},"📝 心流归档","/flows/archive",{"title":36,"_path":37,"children":38},"技术博客 / Coder","/articles",[39,41,44,47,50,53,56,59,62,65,68,71,74,77,80,83],{"title":40,"_path":37},"🦁 欢迎",{"title":42,"_path":43},"🥞 在 tailwind 中使用现代化 CSS Layers","/articles/tailwind-sass-and-css-layer",{"title":45,"_path":46},"💻 本地部署 Qwen 翻译网页","/articles/local-translator",{"title":48,"_path":49},"🧊 模板解析器轻考古","/articles/micro-templating",{"title":51,"_path":52},"Ⓜ️ Mini CSS Parser","/articles/mini-css-parser",{"title":54,"_path":55},"🚩 向AI咨询前端问题","/articles/use-gpt-learn-complex-frontend",{"title":57,"_path":58},"⛸️ 怎样定制复杂组件的自定义滚动条？","/articles/use-scrollbars",{"title":60,"_path":61},"⚖️ 统一多组件库的层叠顺序","/articles/zindex-manager",{"title":63,"_path":64},"🕷️ 滑动验证码破解思路","/articles/crack-the-slider",{"title":66,"_path":67},"🌟 探秘 CSS 光影效果","/articles/css-light-travel",{"title":69,"_path":70},"🍲 设计模式与 JS 魔法锅","/articles/design-patterns-and-js-magic-pot",{"title":72,"_path":73},"🌐 Anysort：灵活、优雅的多属性排序","/articles/anysort-2th",{"title":75,"_path":76},"💫 CSS 幻术 | 抗锯齿","/articles/css-poaa",{"title":78,"_path":79},"❓ 用纯CSS判断鼠标进入的方向","/articles/css-judge-direction",{"title":81,"_path":82},"📝 你本可以少写些 if-else","/articles/no-more-if-else",{"title":84,"_path":85},"📝 技术博客归档","/articles/archive",{"title":87,"_path":88,"children":89},"读书笔记 / Notes","/books",[90],{"title":91,"_path":88},"📕 读书笔记",{"title":93,"_path":94,"children":95},"吉他剧场 / Music","/music",[96,98,101,104,107,110,113,116],{"title":97,"_path":94},"🎸 FingerStyle！",{"title":99,"_path":100},"🌬️ 等待的风","/music/wind",{"title":102,"_path":103},"💕 约定的海洋","/music/ocean",{"title":105,"_path":106},"🎼 Wings~You are the Hero！","/music/wings-you-are-the-hero",{"title":108,"_path":109},"🌏 残酷天使的行动纲领","/music/eva",{"title":111,"_path":112},"🏔️ 奇跡の山","/music/miracle-mountain",{"title":114,"_path":115},"🍷 Wu Wei","/music/wu-wei",{"title":117,"_path":118},"🌅 无题","/music/untitled",{"title":120,"_path":121,"children":122},"知识地图 / Maps","/maps",[123],{"title":124,"_path":121},"🏁 知识地图",{"title":126,"_path":127,"children":128},"造物 / Make","/tools",[129,131,134,137,140,143,146],{"title":130,"_path":127},"🧰 工具收集",{"title":132,"_path":133},"📕 博客","/tools/blog",{"title":135,"_path":136},"🥥 Coconut","/tools/coconut",{"title":138,"_path":139},"🧶 网易云音乐歌单排序","/tools/netease-sorter",{"title":141,"_path":142},"🌐 AnySort","/tools/anysort",{"title":144,"_path":145},"⛸️ UseScrollbar","/tools/use-scrollbar",{"title":147,"_path":148},"👓 Crapto","/tools/crypto-inline",{"title":150,"_path":151,"children":152},"我 / About","/hire",[153],{"title":154,"_path":151},"📬 技术简历",{"_path":156,"_dir":157,"_draft":158,"_partial":159,"_locale":160,"title":161,"description":162,"body":163,"_type":5639,"_id":5640,"_source":5641,"_file":5642,"_stem":5643,"_extension":5644},"/_achieved/2019-05/reactive-in-150loc","2019-05",false,true,"","🚀 150 行代码带你实现小程序中的数据侦听","本文介绍了在 150 行代码内使用 defineProperty 实现一个简单的拥有事件发布订阅能力的状态管理库的思路。",{"type":164,"children":165,"toc":5617},"root",[166,174,189,194,473,485,490,495,500,505,518,799,812,817,824,836,1090,1095,1478,1483,1488,1493,1650,1792,1797,1803,1808,1813,1822,1827,1835,1841,1846,2102,2107,2112,2585,2590,2619,3394,3400,3413,3749,3762,3775,4297,4302,4307,4312,4317,4330,4846,4851,4857,4862,4867,5091,5097,5102,5322,5446,5458,5588,5593,5598,5611],{"type":167,"tag":168,"props":169,"children":171},"element","h2",{"id":170},"前言",[172],{"type":173,"value":170},"text",{"type":167,"tag":175,"props":176,"children":177},"p",{},[178,180,187],{"type":173,"value":179},"在小程序项目中, 我们的通常会使用到使用到一个全局对象作为各个页面通用的数据存储容器, 将它绑定到 app 对象后, 就能在每一个页面都自由的操纵这个对象. 然而在实践中, 由于这个对象及其属性不具备响应式条件, 它不能直接参与业务逻辑的编写, 能力仅仅局限于数据储存. 若是在 VueJS 项目中, 我们可能经常使用到",{"type":167,"tag":181,"props":182,"children":184},"code",{"className":183},[],[185],{"type":173,"value":186},"Vue.$watch",{"type":173,"value":188},"去侦听某个数据是否发生变化, 小程序却缺乏这种能力.",{"type":167,"tag":175,"props":190,"children":191},{},[192],{"type":173,"value":193},"在这篇文章中, 我将用 150 行代码, 手把手带你打造一个小程序也可以使用的侦听器(下简称 VX):",{"type":167,"tag":195,"props":196,"children":200},"pre",{"className":197,"code":198,"language":199,"meta":160,"style":160},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","// 一个快速赋值的语法糖函数, 可以创建结构为 { value: a { b: { val: ''} } } 的对象\nvx.set('value.a.d', { val: '' })\n// 对某个属性进行侦听, 如果发生改变, 则执行相应函数(可多次watch以执行多个函数)\nvx.watch('value.a.d.val', newVal => {\n  console.log(`val改变为 : `, newVal)\n})\nvalue.a.d.val = 3 // val改编为 : 3\n","js",[201],{"type":167,"tag":181,"props":202,"children":203},{"__ignoreMap":160},[204,216,295,304,359,407,420],{"type":167,"tag":205,"props":206,"children":209},"span",{"class":207,"line":208},"line",1,[210],{"type":167,"tag":205,"props":211,"children":213},{"style":212},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit",[214],{"type":173,"value":215},"// 一个快速赋值的语法糖函数, 可以创建结构为 { value: a { b: { val: ''} } } 的对象\n",{"type":167,"tag":205,"props":217,"children":219},{"class":207,"line":218},2,[220,226,232,238,243,249,255,259,264,269,275,280,285,290],{"type":167,"tag":205,"props":221,"children":223},{"style":222},"--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[224],{"type":173,"value":225},"vx",{"type":167,"tag":205,"props":227,"children":229},{"style":228},"--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[230],{"type":173,"value":231},".",{"type":167,"tag":205,"props":233,"children":235},{"style":234},"--shiki-light:#6182B8;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[236],{"type":173,"value":237},"set",{"type":167,"tag":205,"props":239,"children":240},{"style":222},[241],{"type":173,"value":242},"(",{"type":167,"tag":205,"props":244,"children":246},{"style":245},"--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[247],{"type":173,"value":248},"'",{"type":167,"tag":205,"props":250,"children":252},{"style":251},"--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[253],{"type":173,"value":254},"value.a.d",{"type":167,"tag":205,"props":256,"children":257},{"style":245},[258],{"type":173,"value":248},{"type":167,"tag":205,"props":260,"children":261},{"style":228},[262],{"type":173,"value":263},",",{"type":167,"tag":205,"props":265,"children":266},{"style":228},[267],{"type":173,"value":268}," {",{"type":167,"tag":205,"props":270,"children":272},{"style":271},"--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[273],{"type":173,"value":274}," val",{"type":167,"tag":205,"props":276,"children":277},{"style":228},[278],{"type":173,"value":279},":",{"type":167,"tag":205,"props":281,"children":282},{"style":245},[283],{"type":173,"value":284}," ''",{"type":167,"tag":205,"props":286,"children":287},{"style":228},[288],{"type":173,"value":289}," }",{"type":167,"tag":205,"props":291,"children":292},{"style":222},[293],{"type":173,"value":294},")\n",{"type":167,"tag":205,"props":296,"children":298},{"class":207,"line":297},3,[299],{"type":167,"tag":205,"props":300,"children":301},{"style":212},[302],{"type":173,"value":303},"// 对某个属性进行侦听, 如果发生改变, 则执行相应函数(可多次watch以执行多个函数)\n",{"type":167,"tag":205,"props":305,"children":307},{"class":207,"line":306},4,[308,312,316,321,325,329,334,338,342,348,354],{"type":167,"tag":205,"props":309,"children":310},{"style":222},[311],{"type":173,"value":225},{"type":167,"tag":205,"props":313,"children":314},{"style":228},[315],{"type":173,"value":231},{"type":167,"tag":205,"props":317,"children":318},{"style":234},[319],{"type":173,"value":320},"watch",{"type":167,"tag":205,"props":322,"children":323},{"style":222},[324],{"type":173,"value":242},{"type":167,"tag":205,"props":326,"children":327},{"style":245},[328],{"type":173,"value":248},{"type":167,"tag":205,"props":330,"children":331},{"style":251},[332],{"type":173,"value":333},"value.a.d.val",{"type":167,"tag":205,"props":335,"children":336},{"style":245},[337],{"type":173,"value":248},{"type":167,"tag":205,"props":339,"children":340},{"style":228},[341],{"type":173,"value":263},{"type":167,"tag":205,"props":343,"children":345},{"style":344},"--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#E36209;--shiki-default-font-style:inherit;--shiki-dark:#FFAB70;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic",[346],{"type":173,"value":347}," newVal",{"type":167,"tag":205,"props":349,"children":351},{"style":350},"--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic",[352],{"type":173,"value":353}," =>",{"type":167,"tag":205,"props":355,"children":356},{"style":228},[357],{"type":173,"value":358}," {\n",{"type":167,"tag":205,"props":360,"children":362},{"class":207,"line":361},5,[363,368,372,377,381,386,391,395,399,403],{"type":167,"tag":205,"props":364,"children":365},{"style":222},[366],{"type":173,"value":367},"  console",{"type":167,"tag":205,"props":369,"children":370},{"style":228},[371],{"type":173,"value":231},{"type":167,"tag":205,"props":373,"children":374},{"style":234},[375],{"type":173,"value":376},"log",{"type":167,"tag":205,"props":378,"children":379},{"style":271},[380],{"type":173,"value":242},{"type":167,"tag":205,"props":382,"children":383},{"style":245},[384],{"type":173,"value":385},"`",{"type":167,"tag":205,"props":387,"children":388},{"style":251},[389],{"type":173,"value":390},"val改变为 : ",{"type":167,"tag":205,"props":392,"children":393},{"style":245},[394],{"type":173,"value":385},{"type":167,"tag":205,"props":396,"children":397},{"style":228},[398],{"type":173,"value":263},{"type":167,"tag":205,"props":400,"children":401},{"style":222},[402],{"type":173,"value":347},{"type":167,"tag":205,"props":404,"children":405},{"style":271},[406],{"type":173,"value":294},{"type":167,"tag":205,"props":408,"children":410},{"class":207,"line":409},6,[411,416],{"type":167,"tag":205,"props":412,"children":413},{"style":228},[414],{"type":173,"value":415},"}",{"type":167,"tag":205,"props":417,"children":418},{"style":222},[419],{"type":173,"value":294},{"type":167,"tag":205,"props":421,"children":423},{"class":207,"line":422},7,[424,429,433,438,442,447,451,456,462,468],{"type":167,"tag":205,"props":425,"children":426},{"style":222},[427],{"type":173,"value":428},"value",{"type":167,"tag":205,"props":430,"children":431},{"style":228},[432],{"type":173,"value":231},{"type":167,"tag":205,"props":434,"children":435},{"style":222},[436],{"type":173,"value":437},"a",{"type":167,"tag":205,"props":439,"children":440},{"style":228},[441],{"type":173,"value":231},{"type":167,"tag":205,"props":443,"children":444},{"style":222},[445],{"type":173,"value":446},"d",{"type":167,"tag":205,"props":448,"children":449},{"style":228},[450],{"type":173,"value":231},{"type":167,"tag":205,"props":452,"children":453},{"style":222},[454],{"type":173,"value":455},"val ",{"type":167,"tag":205,"props":457,"children":459},{"style":458},"--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[460],{"type":173,"value":461},"=",{"type":167,"tag":205,"props":463,"children":465},{"style":464},"--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[466],{"type":173,"value":467}," 3",{"type":167,"tag":205,"props":469,"children":470},{"style":212},[471],{"type":173,"value":472}," // val改编为 : 3\n",{"type":167,"tag":175,"props":474,"children":475},{},[476,478,483],{"type":173,"value":477},"使用 VX 侦听器, 我们可以更加方便的管理各个页面的状态. 同时, 我们凭借",{"type":167,"tag":181,"props":479,"children":481},{"className":480},[],[482],{"type":173,"value":320},{"type":173,"value":484},"语法, 可以更优雅地编写业务逻辑.",{"type":167,"tag":175,"props":486,"children":487},{},[488],{"type":173,"value":489},"坐稳了, 三轮车准备启动了~ 各位评论见~ 😋",{"type":167,"tag":168,"props":491,"children":493},{"id":492},"稍微理一理思路",[494],{"type":173,"value":492},{"type":167,"tag":175,"props":496,"children":497},{},[498],{"type":173,"value":499},"在全局对象中, 我们不一定要对每一个属性都进行侦听, 所以 VX 主要的功能就是通过 set 去设置某个具体属性的 setter/getter, 同时通过 watch 向添加该属性添加需要订阅的回调函数.",{"type":167,"tag":168,"props":501,"children":503},{"id":502},"依赖对象的实现",[504],{"type":173,"value":502},{"type":167,"tag":175,"props":506,"children":507},{},[508,510,516],{"type":173,"value":509},"首先我们需要造一个通用的",{"type":167,"tag":511,"props":512,"children":513},"strong",{},[514],{"type":173,"value":515},"依赖对象",{"type":173,"value":517},", 依赖对象携带一个订阅数组用于存放一组回调函数, 同时它还应该包括一些操作订阅数组能力(如添加订阅, 清空订阅)的函数",{"type":167,"tag":195,"props":519,"children":521},{"className":197,"code":520,"language":199,"meta":160,"style":160},"class Dep {\n  constructor () {\n    this.subs = []\n  }\n  // 将回调添加到数组中\n  addSub (fn) { /*...*/ }\n  delSub (fn) { /*...*/ }\n  // 执行数组中每一项函数\n  notify (newVal, oldVal) {\n    this.subs.forEach(func => func(newVal, oldVal))\n  }\n}\n",[522],{"type":167,"tag":181,"props":523,"children":524},{"__ignoreMap":160},[525,543,560,588,596,604,642,674,683,718,782,790],{"type":167,"tag":205,"props":526,"children":527},{"class":207,"line":208},[528,533,539],{"type":167,"tag":205,"props":529,"children":530},{"style":350},[531],{"type":173,"value":532},"class",{"type":167,"tag":205,"props":534,"children":536},{"style":535},"--shiki-light:#E2931D;--shiki-light-text-decoration:inherit;--shiki-default:#6F42C1;--shiki-default-text-decoration:inherit;--shiki-dark:#B392F0;--shiki-dark-text-decoration:inherit;--shiki-sepia:#A6E22E;--shiki-sepia-text-decoration:underline",[537],{"type":173,"value":538}," Dep",{"type":167,"tag":205,"props":540,"children":541},{"style":228},[542],{"type":173,"value":358},{"type":167,"tag":205,"props":544,"children":545},{"class":207,"line":218},[546,551,556],{"type":167,"tag":205,"props":547,"children":548},{"style":350},[549],{"type":173,"value":550},"  constructor",{"type":167,"tag":205,"props":552,"children":553},{"style":228},[554],{"type":173,"value":555}," ()",{"type":167,"tag":205,"props":557,"children":558},{"style":228},[559],{"type":173,"value":358},{"type":167,"tag":205,"props":561,"children":562},{"class":207,"line":297},[563,569,573,578,583],{"type":167,"tag":205,"props":564,"children":566},{"style":565},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[567],{"type":173,"value":568},"    this",{"type":167,"tag":205,"props":570,"children":571},{"style":228},[572],{"type":173,"value":231},{"type":167,"tag":205,"props":574,"children":575},{"style":222},[576],{"type":173,"value":577},"subs",{"type":167,"tag":205,"props":579,"children":580},{"style":458},[581],{"type":173,"value":582}," =",{"type":167,"tag":205,"props":584,"children":585},{"style":271},[586],{"type":173,"value":587}," []\n",{"type":167,"tag":205,"props":589,"children":590},{"class":207,"line":306},[591],{"type":167,"tag":205,"props":592,"children":593},{"style":228},[594],{"type":173,"value":595},"  }\n",{"type":167,"tag":205,"props":597,"children":598},{"class":207,"line":361},[599],{"type":167,"tag":205,"props":600,"children":601},{"style":212},[602],{"type":173,"value":603},"  // 将回调添加到数组中\n",{"type":167,"tag":205,"props":605,"children":606},{"class":207,"line":409},[607,613,618,623,628,632,637],{"type":167,"tag":205,"props":608,"children":610},{"style":609},"--shiki-light:#E53935;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[611],{"type":173,"value":612},"  addSub",{"type":167,"tag":205,"props":614,"children":615},{"style":228},[616],{"type":173,"value":617}," (",{"type":167,"tag":205,"props":619,"children":620},{"style":344},[621],{"type":173,"value":622},"fn",{"type":167,"tag":205,"props":624,"children":625},{"style":228},[626],{"type":173,"value":627},")",{"type":167,"tag":205,"props":629,"children":630},{"style":228},[631],{"type":173,"value":268},{"type":167,"tag":205,"props":633,"children":634},{"style":212},[635],{"type":173,"value":636}," /*...*/",{"type":167,"tag":205,"props":638,"children":639},{"style":228},[640],{"type":173,"value":641}," }\n",{"type":167,"tag":205,"props":643,"children":644},{"class":207,"line":422},[645,650,654,658,662,666,670],{"type":167,"tag":205,"props":646,"children":647},{"style":609},[648],{"type":173,"value":649},"  delSub",{"type":167,"tag":205,"props":651,"children":652},{"style":228},[653],{"type":173,"value":617},{"type":167,"tag":205,"props":655,"children":656},{"style":344},[657],{"type":173,"value":622},{"type":167,"tag":205,"props":659,"children":660},{"style":228},[661],{"type":173,"value":627},{"type":167,"tag":205,"props":663,"children":664},{"style":228},[665],{"type":173,"value":268},{"type":167,"tag":205,"props":667,"children":668},{"style":212},[669],{"type":173,"value":636},{"type":167,"tag":205,"props":671,"children":672},{"style":228},[673],{"type":173,"value":641},{"type":167,"tag":205,"props":675,"children":677},{"class":207,"line":676},8,[678],{"type":167,"tag":205,"props":679,"children":680},{"style":212},[681],{"type":173,"value":682},"  // 执行数组中每一项函数\n",{"type":167,"tag":205,"props":684,"children":686},{"class":207,"line":685},9,[687,692,696,701,705,710,714],{"type":167,"tag":205,"props":688,"children":689},{"style":609},[690],{"type":173,"value":691},"  notify",{"type":167,"tag":205,"props":693,"children":694},{"style":228},[695],{"type":173,"value":617},{"type":167,"tag":205,"props":697,"children":698},{"style":344},[699],{"type":173,"value":700},"newVal",{"type":167,"tag":205,"props":702,"children":703},{"style":228},[704],{"type":173,"value":263},{"type":167,"tag":205,"props":706,"children":707},{"style":344},[708],{"type":173,"value":709}," oldVal",{"type":167,"tag":205,"props":711,"children":712},{"style":228},[713],{"type":173,"value":627},{"type":167,"tag":205,"props":715,"children":716},{"style":228},[717],{"type":173,"value":358},{"type":167,"tag":205,"props":719,"children":721},{"class":207,"line":720},10,[722,726,730,734,738,743,747,752,756,761,765,769,773,777],{"type":167,"tag":205,"props":723,"children":724},{"style":565},[725],{"type":173,"value":568},{"type":167,"tag":205,"props":727,"children":728},{"style":228},[729],{"type":173,"value":231},{"type":167,"tag":205,"props":731,"children":732},{"style":222},[733],{"type":173,"value":577},{"type":167,"tag":205,"props":735,"children":736},{"style":228},[737],{"type":173,"value":231},{"type":167,"tag":205,"props":739,"children":740},{"style":234},[741],{"type":173,"value":742},"forEach",{"type":167,"tag":205,"props":744,"children":745},{"style":271},[746],{"type":173,"value":242},{"type":167,"tag":205,"props":748,"children":749},{"style":344},[750],{"type":173,"value":751},"func",{"type":167,"tag":205,"props":753,"children":754},{"style":350},[755],{"type":173,"value":353},{"type":167,"tag":205,"props":757,"children":758},{"style":234},[759],{"type":173,"value":760}," func",{"type":167,"tag":205,"props":762,"children":763},{"style":271},[764],{"type":173,"value":242},{"type":167,"tag":205,"props":766,"children":767},{"style":222},[768],{"type":173,"value":700},{"type":167,"tag":205,"props":770,"children":771},{"style":228},[772],{"type":173,"value":263},{"type":167,"tag":205,"props":774,"children":775},{"style":222},[776],{"type":173,"value":709},{"type":167,"tag":205,"props":778,"children":779},{"style":271},[780],{"type":173,"value":781},"))\n",{"type":167,"tag":205,"props":783,"children":785},{"class":207,"line":784},11,[786],{"type":167,"tag":205,"props":787,"children":788},{"style":228},[789],{"type":173,"value":595},{"type":167,"tag":205,"props":791,"children":793},{"class":207,"line":792},12,[794],{"type":167,"tag":205,"props":795,"children":796},{"style":228},[797],{"type":173,"value":798},"}\n",{"type":167,"tag":175,"props":800,"children":801},{},[802,804,810],{"type":173,"value":803},"全局对象中每一个响应式属性(及其每一个子属性), 都应该和一个新的 Dep 实例保持一一对应的关系, 这样我们进行侦听变化, 执行订阅的回调函数时, 只需要找到对应的实例执行",{"type":167,"tag":181,"props":805,"children":807},{"className":806},[],[808],{"type":173,"value":809},"notify",{"type":173,"value":811},"通知更新即可.",{"type":167,"tag":168,"props":813,"children":815},{"id":814},"设置响应式属性",[816],{"type":173,"value":814},{"type":167,"tag":818,"props":819,"children":821},"h3",{"id":820},"defineproperty",[822],{"type":173,"value":823},"defineProperty",{"type":167,"tag":175,"props":825,"children":826},{},[827,829,834],{"type":173,"value":828},"可能是因为接触 DefineProperty 要比接触 Proxy 早一些的缘故, 代码使用了前者进行响应式的实现, Object.defineProperty 方法会直接在一个对象上定义一个新属性, 这里快速过一遍",{"type":167,"tag":181,"props":830,"children":832},{"className":831},[],[833],{"type":173,"value":823},{"type":173,"value":835},"具体配置:",{"type":167,"tag":195,"props":837,"children":839},{"className":197,"code":838,"language":199,"meta":160,"style":160},"// @param obj 要在其上定义属性的对象\n// @param key 要定义或修改的属性的名称\nObject.defineProperty(obj, key, {\n  // 该属性是否能被枚举\n  enumerable: true,\n  // 该属性能否被删除\n  configurable: true,\n  // 访问该属性则会执行此方法\n  get: () => {\n    return val\n  },\n  // 修改该属性时会执行此方法\n  set: newVal => {\n    val = newVal\n  },\n  // value & writeble 不能和 getter/setter 同时出现\n})\n",[840],{"type":167,"tag":181,"props":841,"children":842},{"__ignoreMap":160},[843,851,859,897,905,928,936,956,964,988,1002,1010,1018,1043,1061,1069,1078],{"type":167,"tag":205,"props":844,"children":845},{"class":207,"line":208},[846],{"type":167,"tag":205,"props":847,"children":848},{"style":212},[849],{"type":173,"value":850},"// @param obj 要在其上定义属性的对象\n",{"type":167,"tag":205,"props":852,"children":853},{"class":207,"line":218},[854],{"type":167,"tag":205,"props":855,"children":856},{"style":212},[857],{"type":173,"value":858},"// @param key 要定义或修改的属性的名称\n",{"type":167,"tag":205,"props":860,"children":861},{"class":207,"line":297},[862,867,871,875,880,884,889,893],{"type":167,"tag":205,"props":863,"children":864},{"style":222},[865],{"type":173,"value":866},"Object",{"type":167,"tag":205,"props":868,"children":869},{"style":228},[870],{"type":173,"value":231},{"type":167,"tag":205,"props":872,"children":873},{"style":234},[874],{"type":173,"value":823},{"type":167,"tag":205,"props":876,"children":877},{"style":222},[878],{"type":173,"value":879},"(obj",{"type":167,"tag":205,"props":881,"children":882},{"style":228},[883],{"type":173,"value":263},{"type":167,"tag":205,"props":885,"children":886},{"style":222},[887],{"type":173,"value":888}," key",{"type":167,"tag":205,"props":890,"children":891},{"style":228},[892],{"type":173,"value":263},{"type":167,"tag":205,"props":894,"children":895},{"style":228},[896],{"type":173,"value":358},{"type":167,"tag":205,"props":898,"children":899},{"class":207,"line":306},[900],{"type":167,"tag":205,"props":901,"children":902},{"style":212},[903],{"type":173,"value":904},"  // 该属性是否能被枚举\n",{"type":167,"tag":205,"props":906,"children":907},{"class":207,"line":361},[908,913,917,923],{"type":167,"tag":205,"props":909,"children":910},{"style":271},[911],{"type":173,"value":912},"  enumerable",{"type":167,"tag":205,"props":914,"children":915},{"style":228},[916],{"type":173,"value":279},{"type":167,"tag":205,"props":918,"children":920},{"style":919},"--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[921],{"type":173,"value":922}," true",{"type":167,"tag":205,"props":924,"children":925},{"style":228},[926],{"type":173,"value":927},",\n",{"type":167,"tag":205,"props":929,"children":930},{"class":207,"line":409},[931],{"type":167,"tag":205,"props":932,"children":933},{"style":212},[934],{"type":173,"value":935},"  // 该属性能否被删除\n",{"type":167,"tag":205,"props":937,"children":938},{"class":207,"line":422},[939,944,948,952],{"type":167,"tag":205,"props":940,"children":941},{"style":271},[942],{"type":173,"value":943},"  configurable",{"type":167,"tag":205,"props":945,"children":946},{"style":228},[947],{"type":173,"value":279},{"type":167,"tag":205,"props":949,"children":950},{"style":919},[951],{"type":173,"value":922},{"type":167,"tag":205,"props":953,"children":954},{"style":228},[955],{"type":173,"value":927},{"type":167,"tag":205,"props":957,"children":958},{"class":207,"line":676},[959],{"type":167,"tag":205,"props":960,"children":961},{"style":212},[962],{"type":173,"value":963},"  // 访问该属性则会执行此方法\n",{"type":167,"tag":205,"props":965,"children":966},{"class":207,"line":685},[967,972,976,980,984],{"type":167,"tag":205,"props":968,"children":969},{"style":234},[970],{"type":173,"value":971},"  get",{"type":167,"tag":205,"props":973,"children":974},{"style":228},[975],{"type":173,"value":279},{"type":167,"tag":205,"props":977,"children":978},{"style":228},[979],{"type":173,"value":555},{"type":167,"tag":205,"props":981,"children":982},{"style":350},[983],{"type":173,"value":353},{"type":167,"tag":205,"props":985,"children":986},{"style":228},[987],{"type":173,"value":358},{"type":167,"tag":205,"props":989,"children":990},{"class":207,"line":720},[991,997],{"type":167,"tag":205,"props":992,"children":994},{"style":993},"--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit",[995],{"type":173,"value":996},"    return",{"type":167,"tag":205,"props":998,"children":999},{"style":222},[1000],{"type":173,"value":1001}," val\n",{"type":167,"tag":205,"props":1003,"children":1004},{"class":207,"line":784},[1005],{"type":167,"tag":205,"props":1006,"children":1007},{"style":228},[1008],{"type":173,"value":1009},"  },\n",{"type":167,"tag":205,"props":1011,"children":1012},{"class":207,"line":792},[1013],{"type":167,"tag":205,"props":1014,"children":1015},{"style":212},[1016],{"type":173,"value":1017},"  // 修改该属性时会执行此方法\n",{"type":167,"tag":205,"props":1019,"children":1021},{"class":207,"line":1020},13,[1022,1027,1031,1035,1039],{"type":167,"tag":205,"props":1023,"children":1024},{"style":234},[1025],{"type":173,"value":1026},"  set",{"type":167,"tag":205,"props":1028,"children":1029},{"style":228},[1030],{"type":173,"value":279},{"type":167,"tag":205,"props":1032,"children":1033},{"style":344},[1034],{"type":173,"value":347},{"type":167,"tag":205,"props":1036,"children":1037},{"style":350},[1038],{"type":173,"value":353},{"type":167,"tag":205,"props":1040,"children":1041},{"style":228},[1042],{"type":173,"value":358},{"type":167,"tag":205,"props":1044,"children":1046},{"class":207,"line":1045},14,[1047,1052,1056],{"type":167,"tag":205,"props":1048,"children":1049},{"style":222},[1050],{"type":173,"value":1051},"    val",{"type":167,"tag":205,"props":1053,"children":1054},{"style":458},[1055],{"type":173,"value":582},{"type":167,"tag":205,"props":1057,"children":1058},{"style":222},[1059],{"type":173,"value":1060}," newVal\n",{"type":167,"tag":205,"props":1062,"children":1064},{"class":207,"line":1063},15,[1065],{"type":167,"tag":205,"props":1066,"children":1067},{"style":228},[1068],{"type":173,"value":1009},{"type":167,"tag":205,"props":1070,"children":1072},{"class":207,"line":1071},16,[1073],{"type":167,"tag":205,"props":1074,"children":1075},{"style":212},[1076],{"type":173,"value":1077},"  // value & writeble 不能和 getter/setter 同时出现\n",{"type":167,"tag":205,"props":1079,"children":1081},{"class":207,"line":1080},17,[1082,1086],{"type":167,"tag":205,"props":1083,"children":1084},{"style":228},[1085],{"type":173,"value":415},{"type":167,"tag":205,"props":1087,"children":1088},{"style":222},[1089],{"type":173,"value":294},{"type":167,"tag":175,"props":1091,"children":1092},{},[1093],{"type":173,"value":1094},"通过对 defineProperty 进行上层封装, 我们可以轻松的实现在全局对象上设置响应式属性功能, 在此, 我们结合刚才定义的 Dep 对象, 将一个新的 dep 实例绑定到新增属性的 setter 中:",{"type":167,"tag":195,"props":1096,"children":1098},{"className":197,"code":1097,"language":199,"meta":160,"style":160},"set (key, val, options = {}, obj = this.store) {\n  const dep = new Dep()\n  Object.defineProperty(obj, key, {\n    enumerable: true,\n    configurable: true,\n    get: () => {\n      return val\n    },\n    set: newVal => {\n      if (newVal === val) {\n        return\n      }\n      dep.notify(newVal, val)\n      val = newVal\n    }\n  })\n}\n",[1099],{"type":167,"tag":181,"props":1100,"children":1101},{"__ignoreMap":160},[1102,1168,1200,1241,1261,1281,1305,1317,1325,1349,1383,1391,1399,1435,1451,1459,1471],{"type":167,"tag":205,"props":1103,"children":1104},{"class":207,"line":208},[1105,1109,1114,1118,1122,1126,1131,1135,1140,1145,1149,1154,1158,1163],{"type":167,"tag":205,"props":1106,"children":1107},{"style":234},[1108],{"type":173,"value":237},{"type":167,"tag":205,"props":1110,"children":1111},{"style":222},[1112],{"type":173,"value":1113}," (key",{"type":167,"tag":205,"props":1115,"children":1116},{"style":228},[1117],{"type":173,"value":263},{"type":167,"tag":205,"props":1119,"children":1120},{"style":222},[1121],{"type":173,"value":274},{"type":167,"tag":205,"props":1123,"children":1124},{"style":228},[1125],{"type":173,"value":263},{"type":167,"tag":205,"props":1127,"children":1128},{"style":222},[1129],{"type":173,"value":1130}," options ",{"type":167,"tag":205,"props":1132,"children":1133},{"style":458},[1134],{"type":173,"value":461},{"type":167,"tag":205,"props":1136,"children":1137},{"style":228},[1138],{"type":173,"value":1139}," {},",{"type":167,"tag":205,"props":1141,"children":1142},{"style":222},[1143],{"type":173,"value":1144}," obj ",{"type":167,"tag":205,"props":1146,"children":1147},{"style":458},[1148],{"type":173,"value":461},{"type":167,"tag":205,"props":1150,"children":1151},{"style":565},[1152],{"type":173,"value":1153}," this",{"type":167,"tag":205,"props":1155,"children":1156},{"style":228},[1157],{"type":173,"value":231},{"type":167,"tag":205,"props":1159,"children":1160},{"style":222},[1161],{"type":173,"value":1162},"store) ",{"type":167,"tag":205,"props":1164,"children":1165},{"style":228},[1166],{"type":173,"value":1167},"{\n",{"type":167,"tag":205,"props":1169,"children":1170},{"class":207,"line":218},[1171,1176,1182,1186,1191,1195],{"type":167,"tag":205,"props":1172,"children":1173},{"style":350},[1174],{"type":173,"value":1175},"  const",{"type":167,"tag":205,"props":1177,"children":1179},{"style":1178},"--shiki-light:#90A4AE;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[1180],{"type":173,"value":1181}," dep",{"type":167,"tag":205,"props":1183,"children":1184},{"style":458},[1185],{"type":173,"value":582},{"type":167,"tag":205,"props":1187,"children":1188},{"style":458},[1189],{"type":173,"value":1190}," new",{"type":167,"tag":205,"props":1192,"children":1193},{"style":234},[1194],{"type":173,"value":538},{"type":167,"tag":205,"props":1196,"children":1197},{"style":271},[1198],{"type":173,"value":1199},"()\n",{"type":167,"tag":205,"props":1201,"children":1202},{"class":207,"line":297},[1203,1208,1212,1216,1220,1225,1229,1233,1237],{"type":167,"tag":205,"props":1204,"children":1205},{"style":222},[1206],{"type":173,"value":1207},"  Object",{"type":167,"tag":205,"props":1209,"children":1210},{"style":228},[1211],{"type":173,"value":231},{"type":167,"tag":205,"props":1213,"children":1214},{"style":234},[1215],{"type":173,"value":823},{"type":167,"tag":205,"props":1217,"children":1218},{"style":271},[1219],{"type":173,"value":242},{"type":167,"tag":205,"props":1221,"children":1222},{"style":222},[1223],{"type":173,"value":1224},"obj",{"type":167,"tag":205,"props":1226,"children":1227},{"style":228},[1228],{"type":173,"value":263},{"type":167,"tag":205,"props":1230,"children":1231},{"style":222},[1232],{"type":173,"value":888},{"type":167,"tag":205,"props":1234,"children":1235},{"style":228},[1236],{"type":173,"value":263},{"type":167,"tag":205,"props":1238,"children":1239},{"style":228},[1240],{"type":173,"value":358},{"type":167,"tag":205,"props":1242,"children":1243},{"class":207,"line":306},[1244,1249,1253,1257],{"type":167,"tag":205,"props":1245,"children":1246},{"style":271},[1247],{"type":173,"value":1248},"    enumerable",{"type":167,"tag":205,"props":1250,"children":1251},{"style":228},[1252],{"type":173,"value":279},{"type":167,"tag":205,"props":1254,"children":1255},{"style":919},[1256],{"type":173,"value":922},{"type":167,"tag":205,"props":1258,"children":1259},{"style":228},[1260],{"type":173,"value":927},{"type":167,"tag":205,"props":1262,"children":1263},{"class":207,"line":361},[1264,1269,1273,1277],{"type":167,"tag":205,"props":1265,"children":1266},{"style":271},[1267],{"type":173,"value":1268},"    configurable",{"type":167,"tag":205,"props":1270,"children":1271},{"style":228},[1272],{"type":173,"value":279},{"type":167,"tag":205,"props":1274,"children":1275},{"style":919},[1276],{"type":173,"value":922},{"type":167,"tag":205,"props":1278,"children":1279},{"style":228},[1280],{"type":173,"value":927},{"type":167,"tag":205,"props":1282,"children":1283},{"class":207,"line":409},[1284,1289,1293,1297,1301],{"type":167,"tag":205,"props":1285,"children":1286},{"style":234},[1287],{"type":173,"value":1288},"    get",{"type":167,"tag":205,"props":1290,"children":1291},{"style":228},[1292],{"type":173,"value":279},{"type":167,"tag":205,"props":1294,"children":1295},{"style":228},[1296],{"type":173,"value":555},{"type":167,"tag":205,"props":1298,"children":1299},{"style":350},[1300],{"type":173,"value":353},{"type":167,"tag":205,"props":1302,"children":1303},{"style":228},[1304],{"type":173,"value":358},{"type":167,"tag":205,"props":1306,"children":1307},{"class":207,"line":422},[1308,1313],{"type":167,"tag":205,"props":1309,"children":1310},{"style":993},[1311],{"type":173,"value":1312},"      return",{"type":167,"tag":205,"props":1314,"children":1315},{"style":222},[1316],{"type":173,"value":1001},{"type":167,"tag":205,"props":1318,"children":1319},{"class":207,"line":676},[1320],{"type":167,"tag":205,"props":1321,"children":1322},{"style":228},[1323],{"type":173,"value":1324},"    },\n",{"type":167,"tag":205,"props":1326,"children":1327},{"class":207,"line":685},[1328,1333,1337,1341,1345],{"type":167,"tag":205,"props":1329,"children":1330},{"style":234},[1331],{"type":173,"value":1332},"    set",{"type":167,"tag":205,"props":1334,"children":1335},{"style":228},[1336],{"type":173,"value":279},{"type":167,"tag":205,"props":1338,"children":1339},{"style":344},[1340],{"type":173,"value":347},{"type":167,"tag":205,"props":1342,"children":1343},{"style":350},[1344],{"type":173,"value":353},{"type":167,"tag":205,"props":1346,"children":1347},{"style":228},[1348],{"type":173,"value":358},{"type":167,"tag":205,"props":1350,"children":1351},{"class":207,"line":720},[1352,1357,1361,1365,1370,1374,1379],{"type":167,"tag":205,"props":1353,"children":1354},{"style":993},[1355],{"type":173,"value":1356},"      if",{"type":167,"tag":205,"props":1358,"children":1359},{"style":271},[1360],{"type":173,"value":617},{"type":167,"tag":205,"props":1362,"children":1363},{"style":222},[1364],{"type":173,"value":700},{"type":167,"tag":205,"props":1366,"children":1367},{"style":458},[1368],{"type":173,"value":1369}," ===",{"type":167,"tag":205,"props":1371,"children":1372},{"style":222},[1373],{"type":173,"value":274},{"type":167,"tag":205,"props":1375,"children":1376},{"style":271},[1377],{"type":173,"value":1378},") ",{"type":167,"tag":205,"props":1380,"children":1381},{"style":228},[1382],{"type":173,"value":1167},{"type":167,"tag":205,"props":1384,"children":1385},{"class":207,"line":784},[1386],{"type":167,"tag":205,"props":1387,"children":1388},{"style":993},[1389],{"type":173,"value":1390},"        return\n",{"type":167,"tag":205,"props":1392,"children":1393},{"class":207,"line":792},[1394],{"type":167,"tag":205,"props":1395,"children":1396},{"style":228},[1397],{"type":173,"value":1398},"      }\n",{"type":167,"tag":205,"props":1400,"children":1401},{"class":207,"line":1020},[1402,1407,1411,1415,1419,1423,1427,1431],{"type":167,"tag":205,"props":1403,"children":1404},{"style":222},[1405],{"type":173,"value":1406},"      dep",{"type":167,"tag":205,"props":1408,"children":1409},{"style":228},[1410],{"type":173,"value":231},{"type":167,"tag":205,"props":1412,"children":1413},{"style":234},[1414],{"type":173,"value":809},{"type":167,"tag":205,"props":1416,"children":1417},{"style":271},[1418],{"type":173,"value":242},{"type":167,"tag":205,"props":1420,"children":1421},{"style":222},[1422],{"type":173,"value":700},{"type":167,"tag":205,"props":1424,"children":1425},{"style":228},[1426],{"type":173,"value":263},{"type":167,"tag":205,"props":1428,"children":1429},{"style":222},[1430],{"type":173,"value":274},{"type":167,"tag":205,"props":1432,"children":1433},{"style":271},[1434],{"type":173,"value":294},{"type":167,"tag":205,"props":1436,"children":1437},{"class":207,"line":1045},[1438,1443,1447],{"type":167,"tag":205,"props":1439,"children":1440},{"style":222},[1441],{"type":173,"value":1442},"      val",{"type":167,"tag":205,"props":1444,"children":1445},{"style":458},[1446],{"type":173,"value":582},{"type":167,"tag":205,"props":1448,"children":1449},{"style":222},[1450],{"type":173,"value":1060},{"type":167,"tag":205,"props":1452,"children":1453},{"class":207,"line":1063},[1454],{"type":167,"tag":205,"props":1455,"children":1456},{"style":228},[1457],{"type":173,"value":1458},"    }\n",{"type":167,"tag":205,"props":1460,"children":1461},{"class":207,"line":1071},[1462,1467],{"type":167,"tag":205,"props":1463,"children":1464},{"style":228},[1465],{"type":173,"value":1466},"  }",{"type":167,"tag":205,"props":1468,"children":1469},{"style":271},[1470],{"type":173,"value":294},{"type":167,"tag":205,"props":1472,"children":1473},{"class":207,"line":1080},[1474],{"type":167,"tag":205,"props":1475,"children":1476},{"style":228},[1477],{"type":173,"value":798},{"type":167,"tag":175,"props":1479,"children":1480},{},[1481],{"type":173,"value":1482},"每当对应属性被赋值, 就会执行依赖数组中的回调函数.",{"type":167,"tag":175,"props":1484,"children":1485},{},[1486],{"type":173,"value":1487},"不过这样还不够, 我们还得想办法获取到这个 dep 实例, 才能给它的依赖数组填充函数.",{"type":167,"tag":175,"props":1489,"children":1490},{},[1491],{"type":173,"value":1492},"这边提供一个很简单的思路, 并不推荐实践中这么做:",{"type":167,"tag":195,"props":1494,"children":1496},{"className":197,"code":1495,"language":199,"meta":160,"style":160},"set (key, val, options = {}, obj = this.store) {\n  const dep = new Dep()\n  Object.defineProperty(obj, key, {})\n  return dep\n}\n",[1497],{"type":167,"tag":181,"props":1498,"children":1499},{"__ignoreMap":160},[1500,1559,1586,1630,1643],{"type":167,"tag":205,"props":1501,"children":1502},{"class":207,"line":208},[1503,1507,1511,1515,1519,1523,1527,1531,1535,1539,1543,1547,1551,1555],{"type":167,"tag":205,"props":1504,"children":1505},{"style":234},[1506],{"type":173,"value":237},{"type":167,"tag":205,"props":1508,"children":1509},{"style":222},[1510],{"type":173,"value":1113},{"type":167,"tag":205,"props":1512,"children":1513},{"style":228},[1514],{"type":173,"value":263},{"type":167,"tag":205,"props":1516,"children":1517},{"style":222},[1518],{"type":173,"value":274},{"type":167,"tag":205,"props":1520,"children":1521},{"style":228},[1522],{"type":173,"value":263},{"type":167,"tag":205,"props":1524,"children":1525},{"style":222},[1526],{"type":173,"value":1130},{"type":167,"tag":205,"props":1528,"children":1529},{"style":458},[1530],{"type":173,"value":461},{"type":167,"tag":205,"props":1532,"children":1533},{"style":228},[1534],{"type":173,"value":1139},{"type":167,"tag":205,"props":1536,"children":1537},{"style":222},[1538],{"type":173,"value":1144},{"type":167,"tag":205,"props":1540,"children":1541},{"style":458},[1542],{"type":173,"value":461},{"type":167,"tag":205,"props":1544,"children":1545},{"style":565},[1546],{"type":173,"value":1153},{"type":167,"tag":205,"props":1548,"children":1549},{"style":228},[1550],{"type":173,"value":231},{"type":167,"tag":205,"props":1552,"children":1553},{"style":222},[1554],{"type":173,"value":1162},{"type":167,"tag":205,"props":1556,"children":1557},{"style":228},[1558],{"type":173,"value":1167},{"type":167,"tag":205,"props":1560,"children":1561},{"class":207,"line":218},[1562,1566,1570,1574,1578,1582],{"type":167,"tag":205,"props":1563,"children":1564},{"style":350},[1565],{"type":173,"value":1175},{"type":167,"tag":205,"props":1567,"children":1568},{"style":1178},[1569],{"type":173,"value":1181},{"type":167,"tag":205,"props":1571,"children":1572},{"style":458},[1573],{"type":173,"value":582},{"type":167,"tag":205,"props":1575,"children":1576},{"style":458},[1577],{"type":173,"value":1190},{"type":167,"tag":205,"props":1579,"children":1580},{"style":234},[1581],{"type":173,"value":538},{"type":167,"tag":205,"props":1583,"children":1584},{"style":271},[1585],{"type":173,"value":1199},{"type":167,"tag":205,"props":1587,"children":1588},{"class":207,"line":297},[1589,1593,1597,1601,1605,1609,1613,1617,1621,1626],{"type":167,"tag":205,"props":1590,"children":1591},{"style":222},[1592],{"type":173,"value":1207},{"type":167,"tag":205,"props":1594,"children":1595},{"style":228},[1596],{"type":173,"value":231},{"type":167,"tag":205,"props":1598,"children":1599},{"style":234},[1600],{"type":173,"value":823},{"type":167,"tag":205,"props":1602,"children":1603},{"style":271},[1604],{"type":173,"value":242},{"type":167,"tag":205,"props":1606,"children":1607},{"style":222},[1608],{"type":173,"value":1224},{"type":167,"tag":205,"props":1610,"children":1611},{"style":228},[1612],{"type":173,"value":263},{"type":167,"tag":205,"props":1614,"children":1615},{"style":222},[1616],{"type":173,"value":888},{"type":167,"tag":205,"props":1618,"children":1619},{"style":228},[1620],{"type":173,"value":263},{"type":167,"tag":205,"props":1622,"children":1623},{"style":228},[1624],{"type":173,"value":1625}," {}",{"type":167,"tag":205,"props":1627,"children":1628},{"style":271},[1629],{"type":173,"value":294},{"type":167,"tag":205,"props":1631,"children":1632},{"class":207,"line":306},[1633,1638],{"type":167,"tag":205,"props":1634,"children":1635},{"style":993},[1636],{"type":173,"value":1637},"  return",{"type":167,"tag":205,"props":1639,"children":1640},{"style":222},[1641],{"type":173,"value":1642}," dep\n",{"type":167,"tag":205,"props":1644,"children":1645},{"class":207,"line":361},[1646],{"type":167,"tag":205,"props":1647,"children":1648},{"style":228},[1649],{"type":173,"value":798},{"type":167,"tag":195,"props":1651,"children":1653},{"className":197,"code":1652,"language":199,"meta":160,"style":160},"const valueDep = set('value', b, {})\nvalueDep.addSub(() => { console.log('value changed!') })\n",[1654],{"type":167,"tag":181,"props":1655,"children":1656},{"__ignoreMap":160},[1657,1716],{"type":167,"tag":205,"props":1658,"children":1659},{"class":207,"line":208},[1660,1665,1670,1674,1679,1683,1687,1691,1695,1699,1704,1708,1712],{"type":167,"tag":205,"props":1661,"children":1662},{"style":350},[1663],{"type":173,"value":1664},"const",{"type":167,"tag":205,"props":1666,"children":1667},{"style":1178},[1668],{"type":173,"value":1669}," valueDep",{"type":167,"tag":205,"props":1671,"children":1672},{"style":458},[1673],{"type":173,"value":582},{"type":167,"tag":205,"props":1675,"children":1676},{"style":234},[1677],{"type":173,"value":1678}," set",{"type":167,"tag":205,"props":1680,"children":1681},{"style":222},[1682],{"type":173,"value":242},{"type":167,"tag":205,"props":1684,"children":1685},{"style":245},[1686],{"type":173,"value":248},{"type":167,"tag":205,"props":1688,"children":1689},{"style":251},[1690],{"type":173,"value":428},{"type":167,"tag":205,"props":1692,"children":1693},{"style":245},[1694],{"type":173,"value":248},{"type":167,"tag":205,"props":1696,"children":1697},{"style":228},[1698],{"type":173,"value":263},{"type":167,"tag":205,"props":1700,"children":1701},{"style":222},[1702],{"type":173,"value":1703}," b",{"type":167,"tag":205,"props":1705,"children":1706},{"style":228},[1707],{"type":173,"value":263},{"type":167,"tag":205,"props":1709,"children":1710},{"style":228},[1711],{"type":173,"value":1625},{"type":167,"tag":205,"props":1713,"children":1714},{"style":222},[1715],{"type":173,"value":294},{"type":167,"tag":205,"props":1717,"children":1718},{"class":207,"line":218},[1719,1724,1728,1733,1737,1742,1746,1750,1755,1759,1763,1767,1771,1776,1780,1784,1788],{"type":167,"tag":205,"props":1720,"children":1721},{"style":222},[1722],{"type":173,"value":1723},"valueDep",{"type":167,"tag":205,"props":1725,"children":1726},{"style":228},[1727],{"type":173,"value":231},{"type":167,"tag":205,"props":1729,"children":1730},{"style":234},[1731],{"type":173,"value":1732},"addSub",{"type":167,"tag":205,"props":1734,"children":1735},{"style":222},[1736],{"type":173,"value":242},{"type":167,"tag":205,"props":1738,"children":1739},{"style":228},[1740],{"type":173,"value":1741},"()",{"type":167,"tag":205,"props":1743,"children":1744},{"style":350},[1745],{"type":173,"value":353},{"type":167,"tag":205,"props":1747,"children":1748},{"style":228},[1749],{"type":173,"value":268},{"type":167,"tag":205,"props":1751,"children":1752},{"style":222},[1753],{"type":173,"value":1754}," console",{"type":167,"tag":205,"props":1756,"children":1757},{"style":228},[1758],{"type":173,"value":231},{"type":167,"tag":205,"props":1760,"children":1761},{"style":234},[1762],{"type":173,"value":376},{"type":167,"tag":205,"props":1764,"children":1765},{"style":271},[1766],{"type":173,"value":242},{"type":167,"tag":205,"props":1768,"children":1769},{"style":245},[1770],{"type":173,"value":248},{"type":167,"tag":205,"props":1772,"children":1773},{"style":251},[1774],{"type":173,"value":1775},"value changed!",{"type":167,"tag":205,"props":1777,"children":1778},{"style":245},[1779],{"type":173,"value":248},{"type":167,"tag":205,"props":1781,"children":1782},{"style":271},[1783],{"type":173,"value":1378},{"type":167,"tag":205,"props":1785,"children":1786},{"style":228},[1787],{"type":173,"value":415},{"type":167,"tag":205,"props":1789,"children":1790},{"style":222},[1791],{"type":173,"value":294},{"type":167,"tag":175,"props":1793,"children":1794},{},[1795],{"type":173,"value":1796},"虽然代码能使用了, 就是是看起来怪怪的~ 😋 我们的三轮车开进了岔路~",{"type":167,"tag":168,"props":1798,"children":1800},{"id":1799},"通过-watch-添加订阅",[1801],{"type":173,"value":1802},"通过 watch 添加订阅",{"type":167,"tag":818,"props":1804,"children":1806},{"id":1805},"喝口水我们继续",[1807],{"type":173,"value":1805},{"type":167,"tag":175,"props":1809,"children":1810},{},[1811],{"type":173,"value":1812},"《黑客与画家》中曾经提到这样一个观点, 我深有体会:",{"type":167,"tag":1814,"props":1815,"children":1816},"blockquote",{},[1817],{"type":167,"tag":175,"props":1818,"children":1819},{},[1820],{"type":173,"value":1821},"如果你觉得你的代码奇怪, 那么往往它是错的",{"type":167,"tag":175,"props":1823,"children":1824},{},[1825],{"type":173,"value":1826},"上面的那一串代码仅仅是能跑通的水平, 我们需要加入更多的细节和思考, 有时候只需要坐下来稍微看一下代码, 就会有各种想法蹦出来:",{"type":167,"tag":1814,"props":1828,"children":1829},{},[1830],{"type":167,"tag":175,"props":1831,"children":1832},{},[1833],{"type":173,"value":1834},"构思这种东西有一个特点，那就是它会导致更多的构思。你有没有注意过，坐下来写东西的时候，一半的构思是写作时产生的？",{"type":167,"tag":818,"props":1836,"children":1838},{"id":1837},"隐藏-dep",[1839],{"type":173,"value":1840},"隐藏 Dep",{"type":167,"tag":175,"props":1842,"children":1843},{},[1844],{"type":173,"value":1845},"这些内容应和外部是解耦的. 首先一点, 我们创建一个侦听器类, 用于封装我们侦听所用到的所有方法, 它包含了我们想要的全局对象以及操作它的方法(如 watch,set):",{"type":167,"tag":195,"props":1847,"children":1849},{"className":197,"code":1848,"language":199,"meta":160,"style":160},"class VX {\n  constructor () {\n    this.store = Object.create(null)\n  }\n  watch (key, fn, obj = this.store) {}\n  set (key, val, options = {}, obj = this.store) {}\n}\nconst vx = new VX()\n",[1850],{"type":167,"tag":181,"props":1851,"children":1852},{"__ignoreMap":160},[1853,1869,1884,1932,1939,1999,2067,2074],{"type":167,"tag":205,"props":1854,"children":1855},{"class":207,"line":208},[1856,1860,1865],{"type":167,"tag":205,"props":1857,"children":1858},{"style":350},[1859],{"type":173,"value":532},{"type":167,"tag":205,"props":1861,"children":1862},{"style":535},[1863],{"type":173,"value":1864}," VX",{"type":167,"tag":205,"props":1866,"children":1867},{"style":228},[1868],{"type":173,"value":358},{"type":167,"tag":205,"props":1870,"children":1871},{"class":207,"line":218},[1872,1876,1880],{"type":167,"tag":205,"props":1873,"children":1874},{"style":350},[1875],{"type":173,"value":550},{"type":167,"tag":205,"props":1877,"children":1878},{"style":228},[1879],{"type":173,"value":555},{"type":167,"tag":205,"props":1881,"children":1882},{"style":228},[1883],{"type":173,"value":358},{"type":167,"tag":205,"props":1885,"children":1886},{"class":207,"line":297},[1887,1891,1895,1900,1904,1909,1913,1918,1922,1928],{"type":167,"tag":205,"props":1888,"children":1889},{"style":565},[1890],{"type":173,"value":568},{"type":167,"tag":205,"props":1892,"children":1893},{"style":228},[1894],{"type":173,"value":231},{"type":167,"tag":205,"props":1896,"children":1897},{"style":222},[1898],{"type":173,"value":1899},"store",{"type":167,"tag":205,"props":1901,"children":1902},{"style":458},[1903],{"type":173,"value":582},{"type":167,"tag":205,"props":1905,"children":1906},{"style":222},[1907],{"type":173,"value":1908}," Object",{"type":167,"tag":205,"props":1910,"children":1911},{"style":228},[1912],{"type":173,"value":231},{"type":167,"tag":205,"props":1914,"children":1915},{"style":234},[1916],{"type":173,"value":1917},"create",{"type":167,"tag":205,"props":1919,"children":1920},{"style":271},[1921],{"type":173,"value":242},{"type":167,"tag":205,"props":1923,"children":1925},{"style":1924},"--shiki-light:#39ADB5;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[1926],{"type":173,"value":1927},"null",{"type":167,"tag":205,"props":1929,"children":1930},{"style":271},[1931],{"type":173,"value":294},{"type":167,"tag":205,"props":1933,"children":1934},{"class":207,"line":306},[1935],{"type":167,"tag":205,"props":1936,"children":1937},{"style":228},[1938],{"type":173,"value":595},{"type":167,"tag":205,"props":1940,"children":1941},{"class":207,"line":361},[1942,1947,1951,1956,1960,1965,1969,1974,1978,1982,1986,1990,1994],{"type":167,"tag":205,"props":1943,"children":1944},{"style":609},[1945],{"type":173,"value":1946},"  watch",{"type":167,"tag":205,"props":1948,"children":1949},{"style":228},[1950],{"type":173,"value":617},{"type":167,"tag":205,"props":1952,"children":1953},{"style":344},[1954],{"type":173,"value":1955},"key",{"type":167,"tag":205,"props":1957,"children":1958},{"style":228},[1959],{"type":173,"value":263},{"type":167,"tag":205,"props":1961,"children":1962},{"style":344},[1963],{"type":173,"value":1964}," fn",{"type":167,"tag":205,"props":1966,"children":1967},{"style":228},[1968],{"type":173,"value":263},{"type":167,"tag":205,"props":1970,"children":1971},{"style":344},[1972],{"type":173,"value":1973}," obj",{"type":167,"tag":205,"props":1975,"children":1976},{"style":458},[1977],{"type":173,"value":582},{"type":167,"tag":205,"props":1979,"children":1980},{"style":565},[1981],{"type":173,"value":1153},{"type":167,"tag":205,"props":1983,"children":1984},{"style":228},[1985],{"type":173,"value":231},{"type":167,"tag":205,"props":1987,"children":1988},{"style":222},[1989],{"type":173,"value":1899},{"type":167,"tag":205,"props":1991,"children":1992},{"style":228},[1993],{"type":173,"value":627},{"type":167,"tag":205,"props":1995,"children":1996},{"style":228},[1997],{"type":173,"value":1998}," {}\n",{"type":167,"tag":205,"props":2000,"children":2001},{"class":207,"line":409},[2002,2006,2010,2014,2018,2022,2026,2031,2035,2039,2043,2047,2051,2055,2059,2063],{"type":167,"tag":205,"props":2003,"children":2004},{"style":609},[2005],{"type":173,"value":1026},{"type":167,"tag":205,"props":2007,"children":2008},{"style":228},[2009],{"type":173,"value":617},{"type":167,"tag":205,"props":2011,"children":2012},{"style":344},[2013],{"type":173,"value":1955},{"type":167,"tag":205,"props":2015,"children":2016},{"style":228},[2017],{"type":173,"value":263},{"type":167,"tag":205,"props":2019,"children":2020},{"style":344},[2021],{"type":173,"value":274},{"type":167,"tag":205,"props":2023,"children":2024},{"style":228},[2025],{"type":173,"value":263},{"type":167,"tag":205,"props":2027,"children":2028},{"style":344},[2029],{"type":173,"value":2030}," options",{"type":167,"tag":205,"props":2032,"children":2033},{"style":458},[2034],{"type":173,"value":582},{"type":167,"tag":205,"props":2036,"children":2037},{"style":228},[2038],{"type":173,"value":1139},{"type":167,"tag":205,"props":2040,"children":2041},{"style":344},[2042],{"type":173,"value":1973},{"type":167,"tag":205,"props":2044,"children":2045},{"style":458},[2046],{"type":173,"value":582},{"type":167,"tag":205,"props":2048,"children":2049},{"style":565},[2050],{"type":173,"value":1153},{"type":167,"tag":205,"props":2052,"children":2053},{"style":228},[2054],{"type":173,"value":231},{"type":167,"tag":205,"props":2056,"children":2057},{"style":222},[2058],{"type":173,"value":1899},{"type":167,"tag":205,"props":2060,"children":2061},{"style":228},[2062],{"type":173,"value":627},{"type":167,"tag":205,"props":2064,"children":2065},{"style":228},[2066],{"type":173,"value":1998},{"type":167,"tag":205,"props":2068,"children":2069},{"class":207,"line":422},[2070],{"type":167,"tag":205,"props":2071,"children":2072},{"style":228},[2073],{"type":173,"value":798},{"type":167,"tag":205,"props":2075,"children":2076},{"class":207,"line":676},[2077,2081,2086,2090,2094,2098],{"type":167,"tag":205,"props":2078,"children":2079},{"style":350},[2080],{"type":173,"value":1664},{"type":167,"tag":205,"props":2082,"children":2083},{"style":1178},[2084],{"type":173,"value":2085}," vx",{"type":167,"tag":205,"props":2087,"children":2088},{"style":458},[2089],{"type":173,"value":582},{"type":167,"tag":205,"props":2091,"children":2092},{"style":458},[2093],{"type":173,"value":1190},{"type":167,"tag":205,"props":2095,"children":2096},{"style":234},[2097],{"type":173,"value":1864},{"type":167,"tag":205,"props":2099,"children":2100},{"style":222},[2101],{"type":173,"value":1199},{"type":167,"tag":175,"props":2103,"children":2104},{},[2105],{"type":173,"value":2106},"我们可以在 watch 中给对象某个属性添加回调, 就不用去直接操作 Dep 依赖数组了. 只是, 我们在业务代码中调用 watch, 要怎么去获取 obj.key 对应的 dep 呢?",{"type":167,"tag":175,"props":2108,"children":2109},{},[2110],{"type":173,"value":2111},"我们设置一个全局的 depHandler, 在 obj.key 的 getter 中主动将 depHandler 设置为当前 obj.key 的 dep 实例, 那么我们在 watch 函数里, 只要用任意操作触发 obj.key 的 getter, 就能通过 depHandler 得到它的 dep 实例了, 代码形如:",{"type":167,"tag":195,"props":2113,"children":2115},{"className":197,"code":2114,"language":199,"meta":160,"style":160},"  // 一开始没有持有dep实例\n  let handleDep = null\n  class VX {\n    watch (key, fn, obj = this.store) {\n      console.log(obj.key) // 使用任意操作触发obj.key的getter, 那么handleDep将自动引用obj.key的dep实例\n      handleDep.addSub(fn)\n    }\n    set (key, val, options = {}, obj = this.store) {\n      const dep = new Dep()\n      Object.defineProperty(obj, key, {\n        enumerable: true,\n        configurable: true,\n        get: () => {\n          handleDep = dep\n          return val\n        },\n        set: newVal => {}\n      })\n    }\n  }\n",[2116],{"type":167,"tag":181,"props":2117,"children":2118},{"__ignoreMap":160},[2119,2127,2149,2165,2221,2262,2290,2297,2364,2392,2432,2452,2472,2496,2512,2524,2532,2556,2569,2577],{"type":167,"tag":205,"props":2120,"children":2121},{"class":207,"line":208},[2122],{"type":167,"tag":205,"props":2123,"children":2124},{"style":212},[2125],{"type":173,"value":2126},"  // 一开始没有持有dep实例\n",{"type":167,"tag":205,"props":2128,"children":2129},{"class":207,"line":218},[2130,2135,2140,2144],{"type":167,"tag":205,"props":2131,"children":2132},{"style":350},[2133],{"type":173,"value":2134},"  let",{"type":167,"tag":205,"props":2136,"children":2137},{"style":222},[2138],{"type":173,"value":2139}," handleDep ",{"type":167,"tag":205,"props":2141,"children":2142},{"style":458},[2143],{"type":173,"value":461},{"type":167,"tag":205,"props":2145,"children":2146},{"style":1924},[2147],{"type":173,"value":2148}," null\n",{"type":167,"tag":205,"props":2150,"children":2151},{"class":207,"line":297},[2152,2157,2161],{"type":167,"tag":205,"props":2153,"children":2154},{"style":350},[2155],{"type":173,"value":2156},"  class",{"type":167,"tag":205,"props":2158,"children":2159},{"style":535},[2160],{"type":173,"value":1864},{"type":167,"tag":205,"props":2162,"children":2163},{"style":228},[2164],{"type":173,"value":358},{"type":167,"tag":205,"props":2166,"children":2167},{"class":207,"line":306},[2168,2173,2177,2181,2185,2189,2193,2197,2201,2205,2209,2213,2217],{"type":167,"tag":205,"props":2169,"children":2170},{"style":609},[2171],{"type":173,"value":2172},"    watch",{"type":167,"tag":205,"props":2174,"children":2175},{"style":228},[2176],{"type":173,"value":617},{"type":167,"tag":205,"props":2178,"children":2179},{"style":344},[2180],{"type":173,"value":1955},{"type":167,"tag":205,"props":2182,"children":2183},{"style":228},[2184],{"type":173,"value":263},{"type":167,"tag":205,"props":2186,"children":2187},{"style":344},[2188],{"type":173,"value":1964},{"type":167,"tag":205,"props":2190,"children":2191},{"style":228},[2192],{"type":173,"value":263},{"type":167,"tag":205,"props":2194,"children":2195},{"style":344},[2196],{"type":173,"value":1973},{"type":167,"tag":205,"props":2198,"children":2199},{"style":458},[2200],{"type":173,"value":582},{"type":167,"tag":205,"props":2202,"children":2203},{"style":565},[2204],{"type":173,"value":1153},{"type":167,"tag":205,"props":2206,"children":2207},{"style":228},[2208],{"type":173,"value":231},{"type":167,"tag":205,"props":2210,"children":2211},{"style":222},[2212],{"type":173,"value":1899},{"type":167,"tag":205,"props":2214,"children":2215},{"style":228},[2216],{"type":173,"value":627},{"type":167,"tag":205,"props":2218,"children":2219},{"style":228},[2220],{"type":173,"value":358},{"type":167,"tag":205,"props":2222,"children":2223},{"class":207,"line":361},[2224,2229,2233,2237,2241,2245,2249,2253,2257],{"type":167,"tag":205,"props":2225,"children":2226},{"style":222},[2227],{"type":173,"value":2228},"      console",{"type":167,"tag":205,"props":2230,"children":2231},{"style":228},[2232],{"type":173,"value":231},{"type":167,"tag":205,"props":2234,"children":2235},{"style":234},[2236],{"type":173,"value":376},{"type":167,"tag":205,"props":2238,"children":2239},{"style":271},[2240],{"type":173,"value":242},{"type":167,"tag":205,"props":2242,"children":2243},{"style":222},[2244],{"type":173,"value":1224},{"type":167,"tag":205,"props":2246,"children":2247},{"style":228},[2248],{"type":173,"value":231},{"type":167,"tag":205,"props":2250,"children":2251},{"style":222},[2252],{"type":173,"value":1955},{"type":167,"tag":205,"props":2254,"children":2255},{"style":271},[2256],{"type":173,"value":1378},{"type":167,"tag":205,"props":2258,"children":2259},{"style":212},[2260],{"type":173,"value":2261},"// 使用任意操作触发obj.key的getter, 那么handleDep将自动引用obj.key的dep实例\n",{"type":167,"tag":205,"props":2263,"children":2264},{"class":207,"line":409},[2265,2270,2274,2278,2282,2286],{"type":167,"tag":205,"props":2266,"children":2267},{"style":222},[2268],{"type":173,"value":2269},"      handleDep",{"type":167,"tag":205,"props":2271,"children":2272},{"style":228},[2273],{"type":173,"value":231},{"type":167,"tag":205,"props":2275,"children":2276},{"style":234},[2277],{"type":173,"value":1732},{"type":167,"tag":205,"props":2279,"children":2280},{"style":271},[2281],{"type":173,"value":242},{"type":167,"tag":205,"props":2283,"children":2284},{"style":222},[2285],{"type":173,"value":622},{"type":167,"tag":205,"props":2287,"children":2288},{"style":271},[2289],{"type":173,"value":294},{"type":167,"tag":205,"props":2291,"children":2292},{"class":207,"line":422},[2293],{"type":167,"tag":205,"props":2294,"children":2295},{"style":228},[2296],{"type":173,"value":1458},{"type":167,"tag":205,"props":2298,"children":2299},{"class":207,"line":676},[2300,2304,2308,2312,2316,2320,2324,2328,2332,2336,2340,2344,2348,2352,2356,2360],{"type":167,"tag":205,"props":2301,"children":2302},{"style":609},[2303],{"type":173,"value":1332},{"type":167,"tag":205,"props":2305,"children":2306},{"style":228},[2307],{"type":173,"value":617},{"type":167,"tag":205,"props":2309,"children":2310},{"style":344},[2311],{"type":173,"value":1955},{"type":167,"tag":205,"props":2313,"children":2314},{"style":228},[2315],{"type":173,"value":263},{"type":167,"tag":205,"props":2317,"children":2318},{"style":344},[2319],{"type":173,"value":274},{"type":167,"tag":205,"props":2321,"children":2322},{"style":228},[2323],{"type":173,"value":263},{"type":167,"tag":205,"props":2325,"children":2326},{"style":344},[2327],{"type":173,"value":2030},{"type":167,"tag":205,"props":2329,"children":2330},{"style":458},[2331],{"type":173,"value":582},{"type":167,"tag":205,"props":2333,"children":2334},{"style":228},[2335],{"type":173,"value":1139},{"type":167,"tag":205,"props":2337,"children":2338},{"style":344},[2339],{"type":173,"value":1973},{"type":167,"tag":205,"props":2341,"children":2342},{"style":458},[2343],{"type":173,"value":582},{"type":167,"tag":205,"props":2345,"children":2346},{"style":565},[2347],{"type":173,"value":1153},{"type":167,"tag":205,"props":2349,"children":2350},{"style":228},[2351],{"type":173,"value":231},{"type":167,"tag":205,"props":2353,"children":2354},{"style":222},[2355],{"type":173,"value":1899},{"type":167,"tag":205,"props":2357,"children":2358},{"style":228},[2359],{"type":173,"value":627},{"type":167,"tag":205,"props":2361,"children":2362},{"style":228},[2363],{"type":173,"value":358},{"type":167,"tag":205,"props":2365,"children":2366},{"class":207,"line":685},[2367,2372,2376,2380,2384,2388],{"type":167,"tag":205,"props":2368,"children":2369},{"style":350},[2370],{"type":173,"value":2371},"      const",{"type":167,"tag":205,"props":2373,"children":2374},{"style":1178},[2375],{"type":173,"value":1181},{"type":167,"tag":205,"props":2377,"children":2378},{"style":458},[2379],{"type":173,"value":582},{"type":167,"tag":205,"props":2381,"children":2382},{"style":458},[2383],{"type":173,"value":1190},{"type":167,"tag":205,"props":2385,"children":2386},{"style":234},[2387],{"type":173,"value":538},{"type":167,"tag":205,"props":2389,"children":2390},{"style":271},[2391],{"type":173,"value":1199},{"type":167,"tag":205,"props":2393,"children":2394},{"class":207,"line":720},[2395,2400,2404,2408,2412,2416,2420,2424,2428],{"type":167,"tag":205,"props":2396,"children":2397},{"style":222},[2398],{"type":173,"value":2399},"      Object",{"type":167,"tag":205,"props":2401,"children":2402},{"style":228},[2403],{"type":173,"value":231},{"type":167,"tag":205,"props":2405,"children":2406},{"style":234},[2407],{"type":173,"value":823},{"type":167,"tag":205,"props":2409,"children":2410},{"style":271},[2411],{"type":173,"value":242},{"type":167,"tag":205,"props":2413,"children":2414},{"style":222},[2415],{"type":173,"value":1224},{"type":167,"tag":205,"props":2417,"children":2418},{"style":228},[2419],{"type":173,"value":263},{"type":167,"tag":205,"props":2421,"children":2422},{"style":222},[2423],{"type":173,"value":888},{"type":167,"tag":205,"props":2425,"children":2426},{"style":228},[2427],{"type":173,"value":263},{"type":167,"tag":205,"props":2429,"children":2430},{"style":228},[2431],{"type":173,"value":358},{"type":167,"tag":205,"props":2433,"children":2434},{"class":207,"line":784},[2435,2440,2444,2448],{"type":167,"tag":205,"props":2436,"children":2437},{"style":271},[2438],{"type":173,"value":2439},"        enumerable",{"type":167,"tag":205,"props":2441,"children":2442},{"style":228},[2443],{"type":173,"value":279},{"type":167,"tag":205,"props":2445,"children":2446},{"style":919},[2447],{"type":173,"value":922},{"type":167,"tag":205,"props":2449,"children":2450},{"style":228},[2451],{"type":173,"value":927},{"type":167,"tag":205,"props":2453,"children":2454},{"class":207,"line":792},[2455,2460,2464,2468],{"type":167,"tag":205,"props":2456,"children":2457},{"style":271},[2458],{"type":173,"value":2459},"        configurable",{"type":167,"tag":205,"props":2461,"children":2462},{"style":228},[2463],{"type":173,"value":279},{"type":167,"tag":205,"props":2465,"children":2466},{"style":919},[2467],{"type":173,"value":922},{"type":167,"tag":205,"props":2469,"children":2470},{"style":228},[2471],{"type":173,"value":927},{"type":167,"tag":205,"props":2473,"children":2474},{"class":207,"line":1020},[2475,2480,2484,2488,2492],{"type":167,"tag":205,"props":2476,"children":2477},{"style":234},[2478],{"type":173,"value":2479},"        get",{"type":167,"tag":205,"props":2481,"children":2482},{"style":228},[2483],{"type":173,"value":279},{"type":167,"tag":205,"props":2485,"children":2486},{"style":228},[2487],{"type":173,"value":555},{"type":167,"tag":205,"props":2489,"children":2490},{"style":350},[2491],{"type":173,"value":353},{"type":167,"tag":205,"props":2493,"children":2494},{"style":228},[2495],{"type":173,"value":358},{"type":167,"tag":205,"props":2497,"children":2498},{"class":207,"line":1045},[2499,2504,2508],{"type":167,"tag":205,"props":2500,"children":2501},{"style":222},[2502],{"type":173,"value":2503},"          handleDep",{"type":167,"tag":205,"props":2505,"children":2506},{"style":458},[2507],{"type":173,"value":582},{"type":167,"tag":205,"props":2509,"children":2510},{"style":222},[2511],{"type":173,"value":1642},{"type":167,"tag":205,"props":2513,"children":2514},{"class":207,"line":1063},[2515,2520],{"type":167,"tag":205,"props":2516,"children":2517},{"style":993},[2518],{"type":173,"value":2519},"          return",{"type":167,"tag":205,"props":2521,"children":2522},{"style":222},[2523],{"type":173,"value":1001},{"type":167,"tag":205,"props":2525,"children":2526},{"class":207,"line":1071},[2527],{"type":167,"tag":205,"props":2528,"children":2529},{"style":228},[2530],{"type":173,"value":2531},"        },\n",{"type":167,"tag":205,"props":2533,"children":2534},{"class":207,"line":1080},[2535,2540,2544,2548,2552],{"type":167,"tag":205,"props":2536,"children":2537},{"style":234},[2538],{"type":173,"value":2539},"        set",{"type":167,"tag":205,"props":2541,"children":2542},{"style":228},[2543],{"type":173,"value":279},{"type":167,"tag":205,"props":2545,"children":2546},{"style":344},[2547],{"type":173,"value":347},{"type":167,"tag":205,"props":2549,"children":2550},{"style":350},[2551],{"type":173,"value":353},{"type":167,"tag":205,"props":2553,"children":2554},{"style":228},[2555],{"type":173,"value":1998},{"type":167,"tag":205,"props":2557,"children":2559},{"class":207,"line":2558},18,[2560,2565],{"type":167,"tag":205,"props":2561,"children":2562},{"style":228},[2563],{"type":173,"value":2564},"      }",{"type":167,"tag":205,"props":2566,"children":2567},{"style":271},[2568],{"type":173,"value":294},{"type":167,"tag":205,"props":2570,"children":2572},{"class":207,"line":2571},19,[2573],{"type":167,"tag":205,"props":2574,"children":2575},{"style":228},[2576],{"type":173,"value":1458},{"type":167,"tag":205,"props":2578,"children":2580},{"class":207,"line":2579},20,[2581],{"type":167,"tag":205,"props":2582,"children":2583},{"style":228},[2584],{"type":173,"value":595},{"type":167,"tag":818,"props":2586,"children":2588},{"id":2587},"主动收集依赖",[2589],{"type":173,"value":2587},{"type":167,"tag":175,"props":2591,"children":2592},{},[2593,2595,2601,2603,2609,2611,2617],{"type":173,"value":2594},"我们增加",{"type":167,"tag":181,"props":2596,"children":2598},{"className":2597},[],[2599],{"type":173,"value":2600},"handleDep.addSub(fn)",{"type":173,"value":2602},"添加回调函数的逻辑, 其实可以直接放到 getter 中, 首先在 Dep 类中封装一个'主动'收集依赖的",{"type":167,"tag":181,"props":2604,"children":2606},{"className":2605},[],[2607],{"type":173,"value":2608},"collect",{"type":173,"value":2610},"方法, 他会将全局",{"type":167,"tag":181,"props":2612,"children":2614},{"className":2613},[],[2615],{"type":173,"value":2616},"handleFn",{"type":173,"value":2618},"存放到订阅数组中, 这样一来, 在 watch 函数中, 我们只要触发 obj.key 的 getter, 就可以主动收集依赖了:",{"type":167,"tag":195,"props":2620,"children":2622},{"className":197,"code":2621,"language":199,"meta":160,"style":160},"let handleFn = null\nclass Dep {\n  addSub (fn) {}\n  delSub (fn) {}\n  clear () {}\n  collect (fn = handleFn) {\n    if (fn && !this.subs.find(x => x === fn)) {\n      this.addSub(fn)\n    }\n  }\n  notify (newVal, oldVal) {}\n}\n\nlet handleDep = null\nclass VX {\n  watch (key, fn, obj = this.store) {\n    handleFn = fn\n    console.log(obj.key)\n  }\n  set (key, val, options = {}, obj = this.store) {\n    const dep = new Dep()\n    Object.defineProperty(obj, key, {\n      enumerable: true,\n      configurable: true,\n      get: () => {\n        handleDep = dep\n        handleDep.collect()\n        return val\n      },\n      set: newVal => {}\n    })\n  }\n}\n",[2623],{"type":167,"tag":181,"props":2624,"children":2625},{"__ignoreMap":160},[2626,2647,2662,2685,2708,2724,2757,2840,2868,2875,2882,2913,2920,2928,2947,2962,3017,3034,3070,3077,3144,3173,3214,3235,3256,3281,3298,3318,3331,3340,3365,3378,3386],{"type":167,"tag":205,"props":2627,"children":2628},{"class":207,"line":208},[2629,2634,2639,2643],{"type":167,"tag":205,"props":2630,"children":2631},{"style":350},[2632],{"type":173,"value":2633},"let",{"type":167,"tag":205,"props":2635,"children":2636},{"style":222},[2637],{"type":173,"value":2638}," handleFn ",{"type":167,"tag":205,"props":2640,"children":2641},{"style":458},[2642],{"type":173,"value":461},{"type":167,"tag":205,"props":2644,"children":2645},{"style":1924},[2646],{"type":173,"value":2148},{"type":167,"tag":205,"props":2648,"children":2649},{"class":207,"line":218},[2650,2654,2658],{"type":167,"tag":205,"props":2651,"children":2652},{"style":350},[2653],{"type":173,"value":532},{"type":167,"tag":205,"props":2655,"children":2656},{"style":535},[2657],{"type":173,"value":538},{"type":167,"tag":205,"props":2659,"children":2660},{"style":228},[2661],{"type":173,"value":358},{"type":167,"tag":205,"props":2663,"children":2664},{"class":207,"line":297},[2665,2669,2673,2677,2681],{"type":167,"tag":205,"props":2666,"children":2667},{"style":609},[2668],{"type":173,"value":612},{"type":167,"tag":205,"props":2670,"children":2671},{"style":228},[2672],{"type":173,"value":617},{"type":167,"tag":205,"props":2674,"children":2675},{"style":344},[2676],{"type":173,"value":622},{"type":167,"tag":205,"props":2678,"children":2679},{"style":228},[2680],{"type":173,"value":627},{"type":167,"tag":205,"props":2682,"children":2683},{"style":228},[2684],{"type":173,"value":1998},{"type":167,"tag":205,"props":2686,"children":2687},{"class":207,"line":306},[2688,2692,2696,2700,2704],{"type":167,"tag":205,"props":2689,"children":2690},{"style":609},[2691],{"type":173,"value":649},{"type":167,"tag":205,"props":2693,"children":2694},{"style":228},[2695],{"type":173,"value":617},{"type":167,"tag":205,"props":2697,"children":2698},{"style":344},[2699],{"type":173,"value":622},{"type":167,"tag":205,"props":2701,"children":2702},{"style":228},[2703],{"type":173,"value":627},{"type":167,"tag":205,"props":2705,"children":2706},{"style":228},[2707],{"type":173,"value":1998},{"type":167,"tag":205,"props":2709,"children":2710},{"class":207,"line":361},[2711,2716,2720],{"type":167,"tag":205,"props":2712,"children":2713},{"style":609},[2714],{"type":173,"value":2715},"  clear",{"type":167,"tag":205,"props":2717,"children":2718},{"style":228},[2719],{"type":173,"value":555},{"type":167,"tag":205,"props":2721,"children":2722},{"style":228},[2723],{"type":173,"value":1998},{"type":167,"tag":205,"props":2725,"children":2726},{"class":207,"line":409},[2727,2732,2736,2740,2744,2749,2753],{"type":167,"tag":205,"props":2728,"children":2729},{"style":609},[2730],{"type":173,"value":2731},"  collect",{"type":167,"tag":205,"props":2733,"children":2734},{"style":228},[2735],{"type":173,"value":617},{"type":167,"tag":205,"props":2737,"children":2738},{"style":344},[2739],{"type":173,"value":622},{"type":167,"tag":205,"props":2741,"children":2742},{"style":458},[2743],{"type":173,"value":582},{"type":167,"tag":205,"props":2745,"children":2746},{"style":222},[2747],{"type":173,"value":2748}," handleFn",{"type":167,"tag":205,"props":2750,"children":2751},{"style":228},[2752],{"type":173,"value":627},{"type":167,"tag":205,"props":2754,"children":2755},{"style":228},[2756],{"type":173,"value":358},{"type":167,"tag":205,"props":2758,"children":2759},{"class":207,"line":422},[2760,2765,2769,2773,2778,2783,2788,2792,2796,2800,2805,2809,2814,2818,2823,2827,2831,2836],{"type":167,"tag":205,"props":2761,"children":2762},{"style":993},[2763],{"type":173,"value":2764},"    if",{"type":167,"tag":205,"props":2766,"children":2767},{"style":271},[2768],{"type":173,"value":617},{"type":167,"tag":205,"props":2770,"children":2771},{"style":222},[2772],{"type":173,"value":622},{"type":167,"tag":205,"props":2774,"children":2775},{"style":458},[2776],{"type":173,"value":2777}," &&",{"type":167,"tag":205,"props":2779,"children":2780},{"style":458},[2781],{"type":173,"value":2782}," !",{"type":167,"tag":205,"props":2784,"children":2785},{"style":565},[2786],{"type":173,"value":2787},"this",{"type":167,"tag":205,"props":2789,"children":2790},{"style":228},[2791],{"type":173,"value":231},{"type":167,"tag":205,"props":2793,"children":2794},{"style":222},[2795],{"type":173,"value":577},{"type":167,"tag":205,"props":2797,"children":2798},{"style":228},[2799],{"type":173,"value":231},{"type":167,"tag":205,"props":2801,"children":2802},{"style":234},[2803],{"type":173,"value":2804},"find",{"type":167,"tag":205,"props":2806,"children":2807},{"style":271},[2808],{"type":173,"value":242},{"type":167,"tag":205,"props":2810,"children":2811},{"style":344},[2812],{"type":173,"value":2813},"x",{"type":167,"tag":205,"props":2815,"children":2816},{"style":350},[2817],{"type":173,"value":353},{"type":167,"tag":205,"props":2819,"children":2820},{"style":222},[2821],{"type":173,"value":2822}," x",{"type":167,"tag":205,"props":2824,"children":2825},{"style":458},[2826],{"type":173,"value":1369},{"type":167,"tag":205,"props":2828,"children":2829},{"style":222},[2830],{"type":173,"value":1964},{"type":167,"tag":205,"props":2832,"children":2833},{"style":271},[2834],{"type":173,"value":2835},")) ",{"type":167,"tag":205,"props":2837,"children":2838},{"style":228},[2839],{"type":173,"value":1167},{"type":167,"tag":205,"props":2841,"children":2842},{"class":207,"line":676},[2843,2848,2852,2856,2860,2864],{"type":167,"tag":205,"props":2844,"children":2845},{"style":565},[2846],{"type":173,"value":2847},"      this",{"type":167,"tag":205,"props":2849,"children":2850},{"style":228},[2851],{"type":173,"value":231},{"type":167,"tag":205,"props":2853,"children":2854},{"style":234},[2855],{"type":173,"value":1732},{"type":167,"tag":205,"props":2857,"children":2858},{"style":271},[2859],{"type":173,"value":242},{"type":167,"tag":205,"props":2861,"children":2862},{"style":222},[2863],{"type":173,"value":622},{"type":167,"tag":205,"props":2865,"children":2866},{"style":271},[2867],{"type":173,"value":294},{"type":167,"tag":205,"props":2869,"children":2870},{"class":207,"line":685},[2871],{"type":167,"tag":205,"props":2872,"children":2873},{"style":228},[2874],{"type":173,"value":1458},{"type":167,"tag":205,"props":2876,"children":2877},{"class":207,"line":720},[2878],{"type":167,"tag":205,"props":2879,"children":2880},{"style":228},[2881],{"type":173,"value":595},{"type":167,"tag":205,"props":2883,"children":2884},{"class":207,"line":784},[2885,2889,2893,2897,2901,2905,2909],{"type":167,"tag":205,"props":2886,"children":2887},{"style":609},[2888],{"type":173,"value":691},{"type":167,"tag":205,"props":2890,"children":2891},{"style":228},[2892],{"type":173,"value":617},{"type":167,"tag":205,"props":2894,"children":2895},{"style":344},[2896],{"type":173,"value":700},{"type":167,"tag":205,"props":2898,"children":2899},{"style":228},[2900],{"type":173,"value":263},{"type":167,"tag":205,"props":2902,"children":2903},{"style":344},[2904],{"type":173,"value":709},{"type":167,"tag":205,"props":2906,"children":2907},{"style":228},[2908],{"type":173,"value":627},{"type":167,"tag":205,"props":2910,"children":2911},{"style":228},[2912],{"type":173,"value":1998},{"type":167,"tag":205,"props":2914,"children":2915},{"class":207,"line":792},[2916],{"type":167,"tag":205,"props":2917,"children":2918},{"style":228},[2919],{"type":173,"value":798},{"type":167,"tag":205,"props":2921,"children":2922},{"class":207,"line":1020},[2923],{"type":167,"tag":205,"props":2924,"children":2925},{"emptyLinePlaceholder":159},[2926],{"type":173,"value":2927},"\n",{"type":167,"tag":205,"props":2929,"children":2930},{"class":207,"line":1045},[2931,2935,2939,2943],{"type":167,"tag":205,"props":2932,"children":2933},{"style":350},[2934],{"type":173,"value":2633},{"type":167,"tag":205,"props":2936,"children":2937},{"style":222},[2938],{"type":173,"value":2139},{"type":167,"tag":205,"props":2940,"children":2941},{"style":458},[2942],{"type":173,"value":461},{"type":167,"tag":205,"props":2944,"children":2945},{"style":1924},[2946],{"type":173,"value":2148},{"type":167,"tag":205,"props":2948,"children":2949},{"class":207,"line":1063},[2950,2954,2958],{"type":167,"tag":205,"props":2951,"children":2952},{"style":350},[2953],{"type":173,"value":532},{"type":167,"tag":205,"props":2955,"children":2956},{"style":535},[2957],{"type":173,"value":1864},{"type":167,"tag":205,"props":2959,"children":2960},{"style":228},[2961],{"type":173,"value":358},{"type":167,"tag":205,"props":2963,"children":2964},{"class":207,"line":1071},[2965,2969,2973,2977,2981,2985,2989,2993,2997,3001,3005,3009,3013],{"type":167,"tag":205,"props":2966,"children":2967},{"style":609},[2968],{"type":173,"value":1946},{"type":167,"tag":205,"props":2970,"children":2971},{"style":228},[2972],{"type":173,"value":617},{"type":167,"tag":205,"props":2974,"children":2975},{"style":344},[2976],{"type":173,"value":1955},{"type":167,"tag":205,"props":2978,"children":2979},{"style":228},[2980],{"type":173,"value":263},{"type":167,"tag":205,"props":2982,"children":2983},{"style":344},[2984],{"type":173,"value":1964},{"type":167,"tag":205,"props":2986,"children":2987},{"style":228},[2988],{"type":173,"value":263},{"type":167,"tag":205,"props":2990,"children":2991},{"style":344},[2992],{"type":173,"value":1973},{"type":167,"tag":205,"props":2994,"children":2995},{"style":458},[2996],{"type":173,"value":582},{"type":167,"tag":205,"props":2998,"children":2999},{"style":565},[3000],{"type":173,"value":1153},{"type":167,"tag":205,"props":3002,"children":3003},{"style":228},[3004],{"type":173,"value":231},{"type":167,"tag":205,"props":3006,"children":3007},{"style":222},[3008],{"type":173,"value":1899},{"type":167,"tag":205,"props":3010,"children":3011},{"style":228},[3012],{"type":173,"value":627},{"type":167,"tag":205,"props":3014,"children":3015},{"style":228},[3016],{"type":173,"value":358},{"type":167,"tag":205,"props":3018,"children":3019},{"class":207,"line":1080},[3020,3025,3029],{"type":167,"tag":205,"props":3021,"children":3022},{"style":222},[3023],{"type":173,"value":3024},"    handleFn",{"type":167,"tag":205,"props":3026,"children":3027},{"style":458},[3028],{"type":173,"value":582},{"type":167,"tag":205,"props":3030,"children":3031},{"style":222},[3032],{"type":173,"value":3033}," fn\n",{"type":167,"tag":205,"props":3035,"children":3036},{"class":207,"line":2558},[3037,3042,3046,3050,3054,3058,3062,3066],{"type":167,"tag":205,"props":3038,"children":3039},{"style":222},[3040],{"type":173,"value":3041},"    console",{"type":167,"tag":205,"props":3043,"children":3044},{"style":228},[3045],{"type":173,"value":231},{"type":167,"tag":205,"props":3047,"children":3048},{"style":234},[3049],{"type":173,"value":376},{"type":167,"tag":205,"props":3051,"children":3052},{"style":271},[3053],{"type":173,"value":242},{"type":167,"tag":205,"props":3055,"children":3056},{"style":222},[3057],{"type":173,"value":1224},{"type":167,"tag":205,"props":3059,"children":3060},{"style":228},[3061],{"type":173,"value":231},{"type":167,"tag":205,"props":3063,"children":3064},{"style":222},[3065],{"type":173,"value":1955},{"type":167,"tag":205,"props":3067,"children":3068},{"style":271},[3069],{"type":173,"value":294},{"type":167,"tag":205,"props":3071,"children":3072},{"class":207,"line":2571},[3073],{"type":167,"tag":205,"props":3074,"children":3075},{"style":228},[3076],{"type":173,"value":595},{"type":167,"tag":205,"props":3078,"children":3079},{"class":207,"line":2579},[3080,3084,3088,3092,3096,3100,3104,3108,3112,3116,3120,3124,3128,3132,3136,3140],{"type":167,"tag":205,"props":3081,"children":3082},{"style":609},[3083],{"type":173,"value":1026},{"type":167,"tag":205,"props":3085,"children":3086},{"style":228},[3087],{"type":173,"value":617},{"type":167,"tag":205,"props":3089,"children":3090},{"style":344},[3091],{"type":173,"value":1955},{"type":167,"tag":205,"props":3093,"children":3094},{"style":228},[3095],{"type":173,"value":263},{"type":167,"tag":205,"props":3097,"children":3098},{"style":344},[3099],{"type":173,"value":274},{"type":167,"tag":205,"props":3101,"children":3102},{"style":228},[3103],{"type":173,"value":263},{"type":167,"tag":205,"props":3105,"children":3106},{"style":344},[3107],{"type":173,"value":2030},{"type":167,"tag":205,"props":3109,"children":3110},{"style":458},[3111],{"type":173,"value":582},{"type":167,"tag":205,"props":3113,"children":3114},{"style":228},[3115],{"type":173,"value":1139},{"type":167,"tag":205,"props":3117,"children":3118},{"style":344},[3119],{"type":173,"value":1973},{"type":167,"tag":205,"props":3121,"children":3122},{"style":458},[3123],{"type":173,"value":582},{"type":167,"tag":205,"props":3125,"children":3126},{"style":565},[3127],{"type":173,"value":1153},{"type":167,"tag":205,"props":3129,"children":3130},{"style":228},[3131],{"type":173,"value":231},{"type":167,"tag":205,"props":3133,"children":3134},{"style":222},[3135],{"type":173,"value":1899},{"type":167,"tag":205,"props":3137,"children":3138},{"style":228},[3139],{"type":173,"value":627},{"type":167,"tag":205,"props":3141,"children":3142},{"style":228},[3143],{"type":173,"value":358},{"type":167,"tag":205,"props":3145,"children":3147},{"class":207,"line":3146},21,[3148,3153,3157,3161,3165,3169],{"type":167,"tag":205,"props":3149,"children":3150},{"style":350},[3151],{"type":173,"value":3152},"    const",{"type":167,"tag":205,"props":3154,"children":3155},{"style":1178},[3156],{"type":173,"value":1181},{"type":167,"tag":205,"props":3158,"children":3159},{"style":458},[3160],{"type":173,"value":582},{"type":167,"tag":205,"props":3162,"children":3163},{"style":458},[3164],{"type":173,"value":1190},{"type":167,"tag":205,"props":3166,"children":3167},{"style":234},[3168],{"type":173,"value":538},{"type":167,"tag":205,"props":3170,"children":3171},{"style":271},[3172],{"type":173,"value":1199},{"type":167,"tag":205,"props":3174,"children":3176},{"class":207,"line":3175},22,[3177,3182,3186,3190,3194,3198,3202,3206,3210],{"type":167,"tag":205,"props":3178,"children":3179},{"style":222},[3180],{"type":173,"value":3181},"    Object",{"type":167,"tag":205,"props":3183,"children":3184},{"style":228},[3185],{"type":173,"value":231},{"type":167,"tag":205,"props":3187,"children":3188},{"style":234},[3189],{"type":173,"value":823},{"type":167,"tag":205,"props":3191,"children":3192},{"style":271},[3193],{"type":173,"value":242},{"type":167,"tag":205,"props":3195,"children":3196},{"style":222},[3197],{"type":173,"value":1224},{"type":167,"tag":205,"props":3199,"children":3200},{"style":228},[3201],{"type":173,"value":263},{"type":167,"tag":205,"props":3203,"children":3204},{"style":222},[3205],{"type":173,"value":888},{"type":167,"tag":205,"props":3207,"children":3208},{"style":228},[3209],{"type":173,"value":263},{"type":167,"tag":205,"props":3211,"children":3212},{"style":228},[3213],{"type":173,"value":358},{"type":167,"tag":205,"props":3215,"children":3217},{"class":207,"line":3216},23,[3218,3223,3227,3231],{"type":167,"tag":205,"props":3219,"children":3220},{"style":271},[3221],{"type":173,"value":3222},"      enumerable",{"type":167,"tag":205,"props":3224,"children":3225},{"style":228},[3226],{"type":173,"value":279},{"type":167,"tag":205,"props":3228,"children":3229},{"style":919},[3230],{"type":173,"value":922},{"type":167,"tag":205,"props":3232,"children":3233},{"style":228},[3234],{"type":173,"value":927},{"type":167,"tag":205,"props":3236,"children":3238},{"class":207,"line":3237},24,[3239,3244,3248,3252],{"type":167,"tag":205,"props":3240,"children":3241},{"style":271},[3242],{"type":173,"value":3243},"      configurable",{"type":167,"tag":205,"props":3245,"children":3246},{"style":228},[3247],{"type":173,"value":279},{"type":167,"tag":205,"props":3249,"children":3250},{"style":919},[3251],{"type":173,"value":922},{"type":167,"tag":205,"props":3253,"children":3254},{"style":228},[3255],{"type":173,"value":927},{"type":167,"tag":205,"props":3257,"children":3259},{"class":207,"line":3258},25,[3260,3265,3269,3273,3277],{"type":167,"tag":205,"props":3261,"children":3262},{"style":234},[3263],{"type":173,"value":3264},"      get",{"type":167,"tag":205,"props":3266,"children":3267},{"style":228},[3268],{"type":173,"value":279},{"type":167,"tag":205,"props":3270,"children":3271},{"style":228},[3272],{"type":173,"value":555},{"type":167,"tag":205,"props":3274,"children":3275},{"style":350},[3276],{"type":173,"value":353},{"type":167,"tag":205,"props":3278,"children":3279},{"style":228},[3280],{"type":173,"value":358},{"type":167,"tag":205,"props":3282,"children":3284},{"class":207,"line":3283},26,[3285,3290,3294],{"type":167,"tag":205,"props":3286,"children":3287},{"style":222},[3288],{"type":173,"value":3289},"        handleDep",{"type":167,"tag":205,"props":3291,"children":3292},{"style":458},[3293],{"type":173,"value":582},{"type":167,"tag":205,"props":3295,"children":3296},{"style":222},[3297],{"type":173,"value":1642},{"type":167,"tag":205,"props":3299,"children":3301},{"class":207,"line":3300},27,[3302,3306,3310,3314],{"type":167,"tag":205,"props":3303,"children":3304},{"style":222},[3305],{"type":173,"value":3289},{"type":167,"tag":205,"props":3307,"children":3308},{"style":228},[3309],{"type":173,"value":231},{"type":167,"tag":205,"props":3311,"children":3312},{"style":234},[3313],{"type":173,"value":2608},{"type":167,"tag":205,"props":3315,"children":3316},{"style":271},[3317],{"type":173,"value":1199},{"type":167,"tag":205,"props":3319,"children":3321},{"class":207,"line":3320},28,[3322,3327],{"type":167,"tag":205,"props":3323,"children":3324},{"style":993},[3325],{"type":173,"value":3326},"        return",{"type":167,"tag":205,"props":3328,"children":3329},{"style":222},[3330],{"type":173,"value":1001},{"type":167,"tag":205,"props":3332,"children":3334},{"class":207,"line":3333},29,[3335],{"type":167,"tag":205,"props":3336,"children":3337},{"style":228},[3338],{"type":173,"value":3339},"      },\n",{"type":167,"tag":205,"props":3341,"children":3343},{"class":207,"line":3342},30,[3344,3349,3353,3357,3361],{"type":167,"tag":205,"props":3345,"children":3346},{"style":234},[3347],{"type":173,"value":3348},"      set",{"type":167,"tag":205,"props":3350,"children":3351},{"style":228},[3352],{"type":173,"value":279},{"type":167,"tag":205,"props":3354,"children":3355},{"style":344},[3356],{"type":173,"value":347},{"type":167,"tag":205,"props":3358,"children":3359},{"style":350},[3360],{"type":173,"value":353},{"type":167,"tag":205,"props":3362,"children":3363},{"style":228},[3364],{"type":173,"value":1998},{"type":167,"tag":205,"props":3366,"children":3368},{"class":207,"line":3367},31,[3369,3374],{"type":167,"tag":205,"props":3370,"children":3371},{"style":228},[3372],{"type":173,"value":3373},"    }",{"type":167,"tag":205,"props":3375,"children":3376},{"style":271},[3377],{"type":173,"value":294},{"type":167,"tag":205,"props":3379,"children":3381},{"class":207,"line":3380},32,[3382],{"type":167,"tag":205,"props":3383,"children":3384},{"style":228},[3385],{"type":173,"value":595},{"type":167,"tag":205,"props":3387,"children":3389},{"class":207,"line":3388},33,[3390],{"type":167,"tag":205,"props":3391,"children":3392},{"style":228},[3393],{"type":173,"value":798},{"type":167,"tag":168,"props":3395,"children":3397},{"id":3396},"处理-key-值为对象链的情况",[3398],{"type":173,"value":3399},"处理 key 值为对象链的情况",{"type":167,"tag":175,"props":3401,"children":3402},{},[3403,3405,3411],{"type":173,"value":3404},"在先前的 watch 函数中, 我们使用 console.log(obj.key)去触发对应属性的 getter, 如果我们调用方式是",{"type":167,"tag":181,"props":3406,"children":3408},{"className":3407},[],[3409],{"type":173,"value":3410},"watch('a.b.c')",{"type":173,"value":3412},"就无能为力了. 这里我们封装一个通用方法, 用于处理对象链字符串的形式:",{"type":167,"tag":195,"props":3414,"children":3416},{"className":197,"code":3415,"language":199,"meta":160,"style":160},"// 通过将字符串'a.b'分割为['a', 'b'], 再使用一个while循环就可以走完这个对象链\nfunction walkChains (key, obj) {\n  const segments = key.split('.')\n  let deepObj = obj\n  while (segments.length) {\n    deepObj = deepObj[segments.shift()]\n  }\n}\nclass VX {\n  watch (key, fn, obj = this.store) {\n    handleFn = fn\n    walkChains(key, obj)\n  }\n}\n",[3417],{"type":167,"tag":181,"props":3418,"children":3419},{"__ignoreMap":160},[3420,3428,3465,3514,3535,3569,3608,3615,3622,3637,3692,3707,3735,3742],{"type":167,"tag":205,"props":3421,"children":3422},{"class":207,"line":208},[3423],{"type":167,"tag":205,"props":3424,"children":3425},{"style":212},[3426],{"type":173,"value":3427},"// 通过将字符串'a.b'分割为['a', 'b'], 再使用一个while循环就可以走完这个对象链\n",{"type":167,"tag":205,"props":3429,"children":3430},{"class":207,"line":218},[3431,3436,3441,3445,3449,3453,3457,3461],{"type":167,"tag":205,"props":3432,"children":3433},{"style":350},[3434],{"type":173,"value":3435},"function",{"type":167,"tag":205,"props":3437,"children":3438},{"style":234},[3439],{"type":173,"value":3440}," walkChains",{"type":167,"tag":205,"props":3442,"children":3443},{"style":228},[3444],{"type":173,"value":617},{"type":167,"tag":205,"props":3446,"children":3447},{"style":344},[3448],{"type":173,"value":1955},{"type":167,"tag":205,"props":3450,"children":3451},{"style":228},[3452],{"type":173,"value":263},{"type":167,"tag":205,"props":3454,"children":3455},{"style":344},[3456],{"type":173,"value":1973},{"type":167,"tag":205,"props":3458,"children":3459},{"style":228},[3460],{"type":173,"value":627},{"type":167,"tag":205,"props":3462,"children":3463},{"style":228},[3464],{"type":173,"value":358},{"type":167,"tag":205,"props":3466,"children":3467},{"class":207,"line":297},[3468,3472,3477,3481,3485,3489,3494,3498,3502,3506,3510],{"type":167,"tag":205,"props":3469,"children":3470},{"style":350},[3471],{"type":173,"value":1175},{"type":167,"tag":205,"props":3473,"children":3474},{"style":1178},[3475],{"type":173,"value":3476}," segments",{"type":167,"tag":205,"props":3478,"children":3479},{"style":458},[3480],{"type":173,"value":582},{"type":167,"tag":205,"props":3482,"children":3483},{"style":222},[3484],{"type":173,"value":888},{"type":167,"tag":205,"props":3486,"children":3487},{"style":228},[3488],{"type":173,"value":231},{"type":167,"tag":205,"props":3490,"children":3491},{"style":234},[3492],{"type":173,"value":3493},"split",{"type":167,"tag":205,"props":3495,"children":3496},{"style":271},[3497],{"type":173,"value":242},{"type":167,"tag":205,"props":3499,"children":3500},{"style":245},[3501],{"type":173,"value":248},{"type":167,"tag":205,"props":3503,"children":3504},{"style":251},[3505],{"type":173,"value":231},{"type":167,"tag":205,"props":3507,"children":3508},{"style":245},[3509],{"type":173,"value":248},{"type":167,"tag":205,"props":3511,"children":3512},{"style":271},[3513],{"type":173,"value":294},{"type":167,"tag":205,"props":3515,"children":3516},{"class":207,"line":306},[3517,3521,3526,3530],{"type":167,"tag":205,"props":3518,"children":3519},{"style":350},[3520],{"type":173,"value":2134},{"type":167,"tag":205,"props":3522,"children":3523},{"style":222},[3524],{"type":173,"value":3525}," deepObj",{"type":167,"tag":205,"props":3527,"children":3528},{"style":458},[3529],{"type":173,"value":582},{"type":167,"tag":205,"props":3531,"children":3532},{"style":222},[3533],{"type":173,"value":3534}," obj\n",{"type":167,"tag":205,"props":3536,"children":3537},{"class":207,"line":361},[3538,3543,3547,3552,3556,3561,3565],{"type":167,"tag":205,"props":3539,"children":3540},{"style":993},[3541],{"type":173,"value":3542},"  while",{"type":167,"tag":205,"props":3544,"children":3545},{"style":271},[3546],{"type":173,"value":617},{"type":167,"tag":205,"props":3548,"children":3549},{"style":222},[3550],{"type":173,"value":3551},"segments",{"type":167,"tag":205,"props":3553,"children":3554},{"style":228},[3555],{"type":173,"value":231},{"type":167,"tag":205,"props":3557,"children":3558},{"style":1178},[3559],{"type":173,"value":3560},"length",{"type":167,"tag":205,"props":3562,"children":3563},{"style":271},[3564],{"type":173,"value":1378},{"type":167,"tag":205,"props":3566,"children":3567},{"style":228},[3568],{"type":173,"value":1167},{"type":167,"tag":205,"props":3570,"children":3571},{"class":207,"line":409},[3572,3577,3581,3585,3590,3594,3598,3603],{"type":167,"tag":205,"props":3573,"children":3574},{"style":222},[3575],{"type":173,"value":3576},"    deepObj",{"type":167,"tag":205,"props":3578,"children":3579},{"style":458},[3580],{"type":173,"value":582},{"type":167,"tag":205,"props":3582,"children":3583},{"style":222},[3584],{"type":173,"value":3525},{"type":167,"tag":205,"props":3586,"children":3587},{"style":271},[3588],{"type":173,"value":3589},"[",{"type":167,"tag":205,"props":3591,"children":3592},{"style":222},[3593],{"type":173,"value":3551},{"type":167,"tag":205,"props":3595,"children":3596},{"style":228},[3597],{"type":173,"value":231},{"type":167,"tag":205,"props":3599,"children":3600},{"style":234},[3601],{"type":173,"value":3602},"shift",{"type":167,"tag":205,"props":3604,"children":3605},{"style":271},[3606],{"type":173,"value":3607},"()]\n",{"type":167,"tag":205,"props":3609,"children":3610},{"class":207,"line":422},[3611],{"type":167,"tag":205,"props":3612,"children":3613},{"style":228},[3614],{"type":173,"value":595},{"type":167,"tag":205,"props":3616,"children":3617},{"class":207,"line":676},[3618],{"type":167,"tag":205,"props":3619,"children":3620},{"style":228},[3621],{"type":173,"value":798},{"type":167,"tag":205,"props":3623,"children":3624},{"class":207,"line":685},[3625,3629,3633],{"type":167,"tag":205,"props":3626,"children":3627},{"style":350},[3628],{"type":173,"value":532},{"type":167,"tag":205,"props":3630,"children":3631},{"style":535},[3632],{"type":173,"value":1864},{"type":167,"tag":205,"props":3634,"children":3635},{"style":228},[3636],{"type":173,"value":358},{"type":167,"tag":205,"props":3638,"children":3639},{"class":207,"line":720},[3640,3644,3648,3652,3656,3660,3664,3668,3672,3676,3680,3684,3688],{"type":167,"tag":205,"props":3641,"children":3642},{"style":609},[3643],{"type":173,"value":1946},{"type":167,"tag":205,"props":3645,"children":3646},{"style":228},[3647],{"type":173,"value":617},{"type":167,"tag":205,"props":3649,"children":3650},{"style":344},[3651],{"type":173,"value":1955},{"type":167,"tag":205,"props":3653,"children":3654},{"style":228},[3655],{"type":173,"value":263},{"type":167,"tag":205,"props":3657,"children":3658},{"style":344},[3659],{"type":173,"value":1964},{"type":167,"tag":205,"props":3661,"children":3662},{"style":228},[3663],{"type":173,"value":263},{"type":167,"tag":205,"props":3665,"children":3666},{"style":344},[3667],{"type":173,"value":1973},{"type":167,"tag":205,"props":3669,"children":3670},{"style":458},[3671],{"type":173,"value":582},{"type":167,"tag":205,"props":3673,"children":3674},{"style":565},[3675],{"type":173,"value":1153},{"type":167,"tag":205,"props":3677,"children":3678},{"style":228},[3679],{"type":173,"value":231},{"type":167,"tag":205,"props":3681,"children":3682},{"style":222},[3683],{"type":173,"value":1899},{"type":167,"tag":205,"props":3685,"children":3686},{"style":228},[3687],{"type":173,"value":627},{"type":167,"tag":205,"props":3689,"children":3690},{"style":228},[3691],{"type":173,"value":358},{"type":167,"tag":205,"props":3693,"children":3694},{"class":207,"line":784},[3695,3699,3703],{"type":167,"tag":205,"props":3696,"children":3697},{"style":222},[3698],{"type":173,"value":3024},{"type":167,"tag":205,"props":3700,"children":3701},{"style":458},[3702],{"type":173,"value":582},{"type":167,"tag":205,"props":3704,"children":3705},{"style":222},[3706],{"type":173,"value":3033},{"type":167,"tag":205,"props":3708,"children":3709},{"class":207,"line":792},[3710,3715,3719,3723,3727,3731],{"type":167,"tag":205,"props":3711,"children":3712},{"style":234},[3713],{"type":173,"value":3714},"    walkChains",{"type":167,"tag":205,"props":3716,"children":3717},{"style":271},[3718],{"type":173,"value":242},{"type":167,"tag":205,"props":3720,"children":3721},{"style":222},[3722],{"type":173,"value":1955},{"type":167,"tag":205,"props":3724,"children":3725},{"style":228},[3726],{"type":173,"value":263},{"type":167,"tag":205,"props":3728,"children":3729},{"style":222},[3730],{"type":173,"value":1973},{"type":167,"tag":205,"props":3732,"children":3733},{"style":271},[3734],{"type":173,"value":294},{"type":167,"tag":205,"props":3736,"children":3737},{"class":207,"line":1020},[3738],{"type":167,"tag":205,"props":3739,"children":3740},{"style":228},[3741],{"type":173,"value":595},{"type":167,"tag":205,"props":3743,"children":3744},{"class":207,"line":1045},[3745],{"type":167,"tag":205,"props":3746,"children":3747},{"style":228},[3748],{"type":173,"value":798},{"type":167,"tag":175,"props":3750,"children":3751},{},[3752,3754,3760],{"type":173,"value":3753},"在 set 方法中处理对象链字符串稍微有些不同, 因为如果",{"type":167,"tag":181,"props":3755,"children":3757},{"className":3756},[],[3758],{"type":173,"value":3759},"set('a.b')",{"type":173,"value":3761},"时, 没有在我们全局对象中找到 a 属性, 这里应该抛错.",{"type":167,"tag":175,"props":3763,"children":3764},{},[3765,3767,3773],{"type":173,"value":3766},"实际的处理中, 需要推断'obj.a'以及'obj.a.b'是否存在. 假设没有'obj.a', 那么我们应该创建一个新的对象, 并且给新的对象添加属性'b', 所以代码类似",{"type":167,"tag":181,"props":3768,"children":3770},{"className":3769},[],[3771],{"type":173,"value":3772},"walkChains",{"type":173,"value":3774},"函数, 只是稍作一层判断:",{"type":167,"tag":195,"props":3776,"children":3778},{"className":197,"code":3777,"language":199,"meta":160,"style":160},"set (key, val, obj) {\n  const segments = key.split('.')\n  // 这里需要注意, 我们只处理到倒数第二个属性\n  while (segments.length > 1) {\n    const handleKey = segments.shift()\n    const handleVal = obj[handleKey]\n    // 存在'obj.a'的情况\n    if (typeof handleVal === 'object') {\n      obj = handleVal\n    // 不存在'obj.a'则给a属性赋一个非响应式的对象\n    } else if (!handleVal) {\n      obj = (\n        key = handleKey,\n        obj[handleKey] = {},\n        obj[handleKey]\n      )\n    } else {\n      console.trace('already has val')\n    }\n  }\n  // 最后一个属性要手动赋值\n  key = segments[0]\n}\n",[3779],{"type":167,"tag":181,"props":3780,"children":3781},{"__ignoreMap":160},[3782,3814,3861,3869,3910,3942,3976,3984,4030,4047,4055,4094,4110,4130,4160,4179,4187,4202,4239,4246,4253,4261,4290],{"type":167,"tag":205,"props":3783,"children":3784},{"class":207,"line":208},[3785,3789,3793,3797,3801,3805,3810],{"type":167,"tag":205,"props":3786,"children":3787},{"style":234},[3788],{"type":173,"value":237},{"type":167,"tag":205,"props":3790,"children":3791},{"style":222},[3792],{"type":173,"value":1113},{"type":167,"tag":205,"props":3794,"children":3795},{"style":228},[3796],{"type":173,"value":263},{"type":167,"tag":205,"props":3798,"children":3799},{"style":222},[3800],{"type":173,"value":274},{"type":167,"tag":205,"props":3802,"children":3803},{"style":228},[3804],{"type":173,"value":263},{"type":167,"tag":205,"props":3806,"children":3807},{"style":222},[3808],{"type":173,"value":3809}," obj) ",{"type":167,"tag":205,"props":3811,"children":3812},{"style":228},[3813],{"type":173,"value":1167},{"type":167,"tag":205,"props":3815,"children":3816},{"class":207,"line":218},[3817,3821,3825,3829,3833,3837,3841,3845,3849,3853,3857],{"type":167,"tag":205,"props":3818,"children":3819},{"style":350},[3820],{"type":173,"value":1175},{"type":167,"tag":205,"props":3822,"children":3823},{"style":1178},[3824],{"type":173,"value":3476},{"type":167,"tag":205,"props":3826,"children":3827},{"style":458},[3828],{"type":173,"value":582},{"type":167,"tag":205,"props":3830,"children":3831},{"style":222},[3832],{"type":173,"value":888},{"type":167,"tag":205,"props":3834,"children":3835},{"style":228},[3836],{"type":173,"value":231},{"type":167,"tag":205,"props":3838,"children":3839},{"style":234},[3840],{"type":173,"value":3493},{"type":167,"tag":205,"props":3842,"children":3843},{"style":271},[3844],{"type":173,"value":242},{"type":167,"tag":205,"props":3846,"children":3847},{"style":245},[3848],{"type":173,"value":248},{"type":167,"tag":205,"props":3850,"children":3851},{"style":251},[3852],{"type":173,"value":231},{"type":167,"tag":205,"props":3854,"children":3855},{"style":245},[3856],{"type":173,"value":248},{"type":167,"tag":205,"props":3858,"children":3859},{"style":271},[3860],{"type":173,"value":294},{"type":167,"tag":205,"props":3862,"children":3863},{"class":207,"line":297},[3864],{"type":167,"tag":205,"props":3865,"children":3866},{"style":212},[3867],{"type":173,"value":3868},"  // 这里需要注意, 我们只处理到倒数第二个属性\n",{"type":167,"tag":205,"props":3870,"children":3871},{"class":207,"line":306},[3872,3876,3880,3884,3888,3892,3897,3902,3906],{"type":167,"tag":205,"props":3873,"children":3874},{"style":993},[3875],{"type":173,"value":3542},{"type":167,"tag":205,"props":3877,"children":3878},{"style":271},[3879],{"type":173,"value":617},{"type":167,"tag":205,"props":3881,"children":3882},{"style":222},[3883],{"type":173,"value":3551},{"type":167,"tag":205,"props":3885,"children":3886},{"style":228},[3887],{"type":173,"value":231},{"type":167,"tag":205,"props":3889,"children":3890},{"style":1178},[3891],{"type":173,"value":3560},{"type":167,"tag":205,"props":3893,"children":3894},{"style":458},[3895],{"type":173,"value":3896}," >",{"type":167,"tag":205,"props":3898,"children":3899},{"style":464},[3900],{"type":173,"value":3901}," 1",{"type":167,"tag":205,"props":3903,"children":3904},{"style":271},[3905],{"type":173,"value":1378},{"type":167,"tag":205,"props":3907,"children":3908},{"style":228},[3909],{"type":173,"value":1167},{"type":167,"tag":205,"props":3911,"children":3912},{"class":207,"line":361},[3913,3917,3922,3926,3930,3934,3938],{"type":167,"tag":205,"props":3914,"children":3915},{"style":350},[3916],{"type":173,"value":3152},{"type":167,"tag":205,"props":3918,"children":3919},{"style":1178},[3920],{"type":173,"value":3921}," handleKey",{"type":167,"tag":205,"props":3923,"children":3924},{"style":458},[3925],{"type":173,"value":582},{"type":167,"tag":205,"props":3927,"children":3928},{"style":222},[3929],{"type":173,"value":3476},{"type":167,"tag":205,"props":3931,"children":3932},{"style":228},[3933],{"type":173,"value":231},{"type":167,"tag":205,"props":3935,"children":3936},{"style":234},[3937],{"type":173,"value":3602},{"type":167,"tag":205,"props":3939,"children":3940},{"style":271},[3941],{"type":173,"value":1199},{"type":167,"tag":205,"props":3943,"children":3944},{"class":207,"line":409},[3945,3949,3954,3958,3962,3966,3971],{"type":167,"tag":205,"props":3946,"children":3947},{"style":350},[3948],{"type":173,"value":3152},{"type":167,"tag":205,"props":3950,"children":3951},{"style":1178},[3952],{"type":173,"value":3953}," handleVal",{"type":167,"tag":205,"props":3955,"children":3956},{"style":458},[3957],{"type":173,"value":582},{"type":167,"tag":205,"props":3959,"children":3960},{"style":222},[3961],{"type":173,"value":1973},{"type":167,"tag":205,"props":3963,"children":3964},{"style":271},[3965],{"type":173,"value":3589},{"type":167,"tag":205,"props":3967,"children":3968},{"style":222},[3969],{"type":173,"value":3970},"handleKey",{"type":167,"tag":205,"props":3972,"children":3973},{"style":271},[3974],{"type":173,"value":3975},"]\n",{"type":167,"tag":205,"props":3977,"children":3978},{"class":207,"line":422},[3979],{"type":167,"tag":205,"props":3980,"children":3981},{"style":212},[3982],{"type":173,"value":3983},"    // 存在'obj.a'的情况\n",{"type":167,"tag":205,"props":3985,"children":3986},{"class":207,"line":676},[3987,3991,3995,4000,4004,4008,4013,4018,4022,4026],{"type":167,"tag":205,"props":3988,"children":3989},{"style":993},[3990],{"type":173,"value":2764},{"type":167,"tag":205,"props":3992,"children":3993},{"style":271},[3994],{"type":173,"value":617},{"type":167,"tag":205,"props":3996,"children":3997},{"style":458},[3998],{"type":173,"value":3999},"typeof",{"type":167,"tag":205,"props":4001,"children":4002},{"style":222},[4003],{"type":173,"value":3953},{"type":167,"tag":205,"props":4005,"children":4006},{"style":458},[4007],{"type":173,"value":1369},{"type":167,"tag":205,"props":4009,"children":4010},{"style":245},[4011],{"type":173,"value":4012}," '",{"type":167,"tag":205,"props":4014,"children":4015},{"style":251},[4016],{"type":173,"value":4017},"object",{"type":167,"tag":205,"props":4019,"children":4020},{"style":245},[4021],{"type":173,"value":248},{"type":167,"tag":205,"props":4023,"children":4024},{"style":271},[4025],{"type":173,"value":1378},{"type":167,"tag":205,"props":4027,"children":4028},{"style":228},[4029],{"type":173,"value":1167},{"type":167,"tag":205,"props":4031,"children":4032},{"class":207,"line":685},[4033,4038,4042],{"type":167,"tag":205,"props":4034,"children":4035},{"style":222},[4036],{"type":173,"value":4037},"      obj",{"type":167,"tag":205,"props":4039,"children":4040},{"style":458},[4041],{"type":173,"value":582},{"type":167,"tag":205,"props":4043,"children":4044},{"style":222},[4045],{"type":173,"value":4046}," handleVal\n",{"type":167,"tag":205,"props":4048,"children":4049},{"class":207,"line":720},[4050],{"type":167,"tag":205,"props":4051,"children":4052},{"style":212},[4053],{"type":173,"value":4054},"    // 不存在'obj.a'则给a属性赋一个非响应式的对象\n",{"type":167,"tag":205,"props":4056,"children":4057},{"class":207,"line":784},[4058,4062,4067,4072,4076,4081,4086,4090],{"type":167,"tag":205,"props":4059,"children":4060},{"style":228},[4061],{"type":173,"value":3373},{"type":167,"tag":205,"props":4063,"children":4064},{"style":993},[4065],{"type":173,"value":4066}," else",{"type":167,"tag":205,"props":4068,"children":4069},{"style":993},[4070],{"type":173,"value":4071}," if",{"type":167,"tag":205,"props":4073,"children":4074},{"style":271},[4075],{"type":173,"value":617},{"type":167,"tag":205,"props":4077,"children":4078},{"style":458},[4079],{"type":173,"value":4080},"!",{"type":167,"tag":205,"props":4082,"children":4083},{"style":222},[4084],{"type":173,"value":4085},"handleVal",{"type":167,"tag":205,"props":4087,"children":4088},{"style":271},[4089],{"type":173,"value":1378},{"type":167,"tag":205,"props":4091,"children":4092},{"style":228},[4093],{"type":173,"value":1167},{"type":167,"tag":205,"props":4095,"children":4096},{"class":207,"line":792},[4097,4101,4105],{"type":167,"tag":205,"props":4098,"children":4099},{"style":234},[4100],{"type":173,"value":4037},{"type":167,"tag":205,"props":4102,"children":4103},{"style":458},[4104],{"type":173,"value":582},{"type":167,"tag":205,"props":4106,"children":4107},{"style":271},[4108],{"type":173,"value":4109}," (\n",{"type":167,"tag":205,"props":4111,"children":4112},{"class":207,"line":1020},[4113,4118,4122,4126],{"type":167,"tag":205,"props":4114,"children":4115},{"style":222},[4116],{"type":173,"value":4117},"        key",{"type":167,"tag":205,"props":4119,"children":4120},{"style":458},[4121],{"type":173,"value":582},{"type":167,"tag":205,"props":4123,"children":4124},{"style":344},[4125],{"type":173,"value":3921},{"type":167,"tag":205,"props":4127,"children":4128},{"style":228},[4129],{"type":173,"value":927},{"type":167,"tag":205,"props":4131,"children":4132},{"class":207,"line":1045},[4133,4138,4142,4146,4151,4155],{"type":167,"tag":205,"props":4134,"children":4135},{"style":222},[4136],{"type":173,"value":4137},"        obj",{"type":167,"tag":205,"props":4139,"children":4140},{"style":271},[4141],{"type":173,"value":3589},{"type":167,"tag":205,"props":4143,"children":4144},{"style":222},[4145],{"type":173,"value":3970},{"type":167,"tag":205,"props":4147,"children":4148},{"style":271},[4149],{"type":173,"value":4150},"] ",{"type":167,"tag":205,"props":4152,"children":4153},{"style":458},[4154],{"type":173,"value":461},{"type":167,"tag":205,"props":4156,"children":4157},{"style":228},[4158],{"type":173,"value":4159}," {},\n",{"type":167,"tag":205,"props":4161,"children":4162},{"class":207,"line":1063},[4163,4167,4171,4175],{"type":167,"tag":205,"props":4164,"children":4165},{"style":222},[4166],{"type":173,"value":4137},{"type":167,"tag":205,"props":4168,"children":4169},{"style":271},[4170],{"type":173,"value":3589},{"type":167,"tag":205,"props":4172,"children":4173},{"style":222},[4174],{"type":173,"value":3970},{"type":167,"tag":205,"props":4176,"children":4177},{"style":271},[4178],{"type":173,"value":3975},{"type":167,"tag":205,"props":4180,"children":4181},{"class":207,"line":1071},[4182],{"type":167,"tag":205,"props":4183,"children":4184},{"style":271},[4185],{"type":173,"value":4186},"      )\n",{"type":167,"tag":205,"props":4188,"children":4189},{"class":207,"line":1080},[4190,4194,4198],{"type":167,"tag":205,"props":4191,"children":4192},{"style":228},[4193],{"type":173,"value":3373},{"type":167,"tag":205,"props":4195,"children":4196},{"style":993},[4197],{"type":173,"value":4066},{"type":167,"tag":205,"props":4199,"children":4200},{"style":228},[4201],{"type":173,"value":358},{"type":167,"tag":205,"props":4203,"children":4204},{"class":207,"line":2558},[4205,4209,4213,4218,4222,4226,4231,4235],{"type":167,"tag":205,"props":4206,"children":4207},{"style":222},[4208],{"type":173,"value":2228},{"type":167,"tag":205,"props":4210,"children":4211},{"style":228},[4212],{"type":173,"value":231},{"type":167,"tag":205,"props":4214,"children":4215},{"style":234},[4216],{"type":173,"value":4217},"trace",{"type":167,"tag":205,"props":4219,"children":4220},{"style":271},[4221],{"type":173,"value":242},{"type":167,"tag":205,"props":4223,"children":4224},{"style":245},[4225],{"type":173,"value":248},{"type":167,"tag":205,"props":4227,"children":4228},{"style":251},[4229],{"type":173,"value":4230},"already has val",{"type":167,"tag":205,"props":4232,"children":4233},{"style":245},[4234],{"type":173,"value":248},{"type":167,"tag":205,"props":4236,"children":4237},{"style":271},[4238],{"type":173,"value":294},{"type":167,"tag":205,"props":4240,"children":4241},{"class":207,"line":2571},[4242],{"type":167,"tag":205,"props":4243,"children":4244},{"style":228},[4245],{"type":173,"value":1458},{"type":167,"tag":205,"props":4247,"children":4248},{"class":207,"line":2579},[4249],{"type":167,"tag":205,"props":4250,"children":4251},{"style":228},[4252],{"type":173,"value":595},{"type":167,"tag":205,"props":4254,"children":4255},{"class":207,"line":3146},[4256],{"type":167,"tag":205,"props":4257,"children":4258},{"style":212},[4259],{"type":173,"value":4260},"  // 最后一个属性要手动赋值\n",{"type":167,"tag":205,"props":4262,"children":4263},{"class":207,"line":3175},[4264,4269,4273,4277,4281,4286],{"type":167,"tag":205,"props":4265,"children":4266},{"style":222},[4267],{"type":173,"value":4268},"  key",{"type":167,"tag":205,"props":4270,"children":4271},{"style":458},[4272],{"type":173,"value":582},{"type":167,"tag":205,"props":4274,"children":4275},{"style":222},[4276],{"type":173,"value":3476},{"type":167,"tag":205,"props":4278,"children":4279},{"style":271},[4280],{"type":173,"value":3589},{"type":167,"tag":205,"props":4282,"children":4283},{"style":464},[4284],{"type":173,"value":4285},"0",{"type":167,"tag":205,"props":4287,"children":4288},{"style":271},[4289],{"type":173,"value":3975},{"type":167,"tag":205,"props":4291,"children":4292},{"class":207,"line":3216},[4293],{"type":167,"tag":205,"props":4294,"children":4295},{"style":228},[4296],{"type":173,"value":798},{"type":167,"tag":168,"props":4298,"children":4300},{"id":4299},"业务场景应用",[4301],{"type":173,"value":4299},{"type":167,"tag":818,"props":4303,"children":4305},{"id":4304},"小程序跨页面刷新数据",[4306],{"type":173,"value":4304},{"type":167,"tag":175,"props":4308,"children":4309},{},[4310],{"type":173,"value":4311},"我们经常碰到在小程序中由 A 页面跳转到 B 页面, 如果 B 页面进行了一些操作, 希望 A 页面自动刷新数据的情况. 但是由于 A 页面跳转到 B 页面不同(也许是 redirect,也许是 navigate), 处理方法也不尽相同.",{"type":167,"tag":175,"props":4313,"children":4314},{},[4315],{"type":173,"value":4316},"使用 navigate 方式跳转后, A 页面不会被注销, 所以我们一般会通过全局对象去贮存 A 页面实例(也就是 A 页面的 this 对象), 然后在 B 页面直接调用相应的方法(如 A.refreshList())进行刷新操作.",{"type":167,"tag":175,"props":4318,"children":4319},{},[4320,4322,4328],{"type":173,"value":4321},"引入 VX 后, 我们可以在",{"type":167,"tag":181,"props":4323,"children":4325},{"className":4324},[],[4326],{"type":173,"value":4327},"onload",{"type":173,"value":4329},"生命周期直接调用 watch 方法添加订阅:",{"type":167,"tag":195,"props":4331,"children":4333},{"className":197,"code":4332,"language":199,"meta":160,"style":160},"// app.js\nimport VX from '@/utils/suites/vx'\nconst vx = new VX()\napp.vx = vx\napp.store = vx.store\napp.vx.set('userType', '商户')\n\n// page a\nonLoad () {\n  app.vx.watch('userType', userType => {\n    if (userType === '商户') {\n      // ...\n    } else if (userType === '管理员') {\n      // ...\n    }\n  }, {\n    immediate: true\n  })\n}\n\n// page b\nswitchUserType () {\n  app.store.userType = '管理员'\n}\n",[4334],{"type":167,"tag":181,"props":4335,"children":4336},{"__ignoreMap":160},[4337,4345,4377,4404,4430,4463,4524,4531,4539,4556,4613,4652,4660,4708,4715,4722,4734,4751,4762,4769,4776,4784,4800,4839],{"type":167,"tag":205,"props":4338,"children":4339},{"class":207,"line":208},[4340],{"type":167,"tag":205,"props":4341,"children":4342},{"style":212},[4343],{"type":173,"value":4344},"// app.js\n",{"type":167,"tag":205,"props":4346,"children":4347},{"class":207,"line":218},[4348,4353,4358,4363,4367,4372],{"type":167,"tag":205,"props":4349,"children":4350},{"style":993},[4351],{"type":173,"value":4352},"import",{"type":167,"tag":205,"props":4354,"children":4355},{"style":222},[4356],{"type":173,"value":4357}," VX ",{"type":167,"tag":205,"props":4359,"children":4360},{"style":993},[4361],{"type":173,"value":4362},"from",{"type":167,"tag":205,"props":4364,"children":4365},{"style":245},[4366],{"type":173,"value":4012},{"type":167,"tag":205,"props":4368,"children":4369},{"style":251},[4370],{"type":173,"value":4371},"@/utils/suites/vx",{"type":167,"tag":205,"props":4373,"children":4374},{"style":245},[4375],{"type":173,"value":4376},"'\n",{"type":167,"tag":205,"props":4378,"children":4379},{"class":207,"line":297},[4380,4384,4388,4392,4396,4400],{"type":167,"tag":205,"props":4381,"children":4382},{"style":350},[4383],{"type":173,"value":1664},{"type":167,"tag":205,"props":4385,"children":4386},{"style":1178},[4387],{"type":173,"value":2085},{"type":167,"tag":205,"props":4389,"children":4390},{"style":458},[4391],{"type":173,"value":582},{"type":167,"tag":205,"props":4393,"children":4394},{"style":458},[4395],{"type":173,"value":1190},{"type":167,"tag":205,"props":4397,"children":4398},{"style":234},[4399],{"type":173,"value":1864},{"type":167,"tag":205,"props":4401,"children":4402},{"style":222},[4403],{"type":173,"value":1199},{"type":167,"tag":205,"props":4405,"children":4406},{"class":207,"line":306},[4407,4412,4416,4421,4425],{"type":167,"tag":205,"props":4408,"children":4409},{"style":222},[4410],{"type":173,"value":4411},"app",{"type":167,"tag":205,"props":4413,"children":4414},{"style":228},[4415],{"type":173,"value":231},{"type":167,"tag":205,"props":4417,"children":4418},{"style":222},[4419],{"type":173,"value":4420},"vx ",{"type":167,"tag":205,"props":4422,"children":4423},{"style":458},[4424],{"type":173,"value":461},{"type":167,"tag":205,"props":4426,"children":4427},{"style":222},[4428],{"type":173,"value":4429}," vx\n",{"type":167,"tag":205,"props":4431,"children":4432},{"class":207,"line":361},[4433,4437,4441,4446,4450,4454,4458],{"type":167,"tag":205,"props":4434,"children":4435},{"style":222},[4436],{"type":173,"value":4411},{"type":167,"tag":205,"props":4438,"children":4439},{"style":228},[4440],{"type":173,"value":231},{"type":167,"tag":205,"props":4442,"children":4443},{"style":222},[4444],{"type":173,"value":4445},"store ",{"type":167,"tag":205,"props":4447,"children":4448},{"style":458},[4449],{"type":173,"value":461},{"type":167,"tag":205,"props":4451,"children":4452},{"style":222},[4453],{"type":173,"value":2085},{"type":167,"tag":205,"props":4455,"children":4456},{"style":228},[4457],{"type":173,"value":231},{"type":167,"tag":205,"props":4459,"children":4460},{"style":222},[4461],{"type":173,"value":4462},"store\n",{"type":167,"tag":205,"props":4464,"children":4465},{"class":207,"line":409},[4466,4470,4474,4478,4482,4486,4490,4494,4499,4503,4507,4511,4516,4520],{"type":167,"tag":205,"props":4467,"children":4468},{"style":222},[4469],{"type":173,"value":4411},{"type":167,"tag":205,"props":4471,"children":4472},{"style":228},[4473],{"type":173,"value":231},{"type":167,"tag":205,"props":4475,"children":4476},{"style":222},[4477],{"type":173,"value":225},{"type":167,"tag":205,"props":4479,"children":4480},{"style":228},[4481],{"type":173,"value":231},{"type":167,"tag":205,"props":4483,"children":4484},{"style":234},[4485],{"type":173,"value":237},{"type":167,"tag":205,"props":4487,"children":4488},{"style":222},[4489],{"type":173,"value":242},{"type":167,"tag":205,"props":4491,"children":4492},{"style":245},[4493],{"type":173,"value":248},{"type":167,"tag":205,"props":4495,"children":4496},{"style":251},[4497],{"type":173,"value":4498},"userType",{"type":167,"tag":205,"props":4500,"children":4501},{"style":245},[4502],{"type":173,"value":248},{"type":167,"tag":205,"props":4504,"children":4505},{"style":228},[4506],{"type":173,"value":263},{"type":167,"tag":205,"props":4508,"children":4509},{"style":245},[4510],{"type":173,"value":4012},{"type":167,"tag":205,"props":4512,"children":4513},{"style":251},[4514],{"type":173,"value":4515},"商户",{"type":167,"tag":205,"props":4517,"children":4518},{"style":245},[4519],{"type":173,"value":248},{"type":167,"tag":205,"props":4521,"children":4522},{"style":222},[4523],{"type":173,"value":294},{"type":167,"tag":205,"props":4525,"children":4526},{"class":207,"line":422},[4527],{"type":167,"tag":205,"props":4528,"children":4529},{"emptyLinePlaceholder":159},[4530],{"type":173,"value":2927},{"type":167,"tag":205,"props":4532,"children":4533},{"class":207,"line":676},[4534],{"type":167,"tag":205,"props":4535,"children":4536},{"style":212},[4537],{"type":173,"value":4538},"// page a\n",{"type":167,"tag":205,"props":4540,"children":4541},{"class":207,"line":685},[4542,4547,4552],{"type":167,"tag":205,"props":4543,"children":4544},{"style":234},[4545],{"type":173,"value":4546},"onLoad",{"type":167,"tag":205,"props":4548,"children":4549},{"style":222},[4550],{"type":173,"value":4551}," () ",{"type":167,"tag":205,"props":4553,"children":4554},{"style":228},[4555],{"type":173,"value":1167},{"type":167,"tag":205,"props":4557,"children":4558},{"class":207,"line":720},[4559,4564,4568,4572,4576,4580,4584,4588,4592,4596,4600,4605,4609],{"type":167,"tag":205,"props":4560,"children":4561},{"style":222},[4562],{"type":173,"value":4563},"  app",{"type":167,"tag":205,"props":4565,"children":4566},{"style":228},[4567],{"type":173,"value":231},{"type":167,"tag":205,"props":4569,"children":4570},{"style":222},[4571],{"type":173,"value":225},{"type":167,"tag":205,"props":4573,"children":4574},{"style":228},[4575],{"type":173,"value":231},{"type":167,"tag":205,"props":4577,"children":4578},{"style":234},[4579],{"type":173,"value":320},{"type":167,"tag":205,"props":4581,"children":4582},{"style":271},[4583],{"type":173,"value":242},{"type":167,"tag":205,"props":4585,"children":4586},{"style":245},[4587],{"type":173,"value":248},{"type":167,"tag":205,"props":4589,"children":4590},{"style":251},[4591],{"type":173,"value":4498},{"type":167,"tag":205,"props":4593,"children":4594},{"style":245},[4595],{"type":173,"value":248},{"type":167,"tag":205,"props":4597,"children":4598},{"style":228},[4599],{"type":173,"value":263},{"type":167,"tag":205,"props":4601,"children":4602},{"style":344},[4603],{"type":173,"value":4604}," userType",{"type":167,"tag":205,"props":4606,"children":4607},{"style":350},[4608],{"type":173,"value":353},{"type":167,"tag":205,"props":4610,"children":4611},{"style":228},[4612],{"type":173,"value":358},{"type":167,"tag":205,"props":4614,"children":4615},{"class":207,"line":784},[4616,4620,4624,4628,4632,4636,4640,4644,4648],{"type":167,"tag":205,"props":4617,"children":4618},{"style":993},[4619],{"type":173,"value":2764},{"type":167,"tag":205,"props":4621,"children":4622},{"style":271},[4623],{"type":173,"value":617},{"type":167,"tag":205,"props":4625,"children":4626},{"style":222},[4627],{"type":173,"value":4498},{"type":167,"tag":205,"props":4629,"children":4630},{"style":458},[4631],{"type":173,"value":1369},{"type":167,"tag":205,"props":4633,"children":4634},{"style":245},[4635],{"type":173,"value":4012},{"type":167,"tag":205,"props":4637,"children":4638},{"style":251},[4639],{"type":173,"value":4515},{"type":167,"tag":205,"props":4641,"children":4642},{"style":245},[4643],{"type":173,"value":248},{"type":167,"tag":205,"props":4645,"children":4646},{"style":271},[4647],{"type":173,"value":1378},{"type":167,"tag":205,"props":4649,"children":4650},{"style":228},[4651],{"type":173,"value":1167},{"type":167,"tag":205,"props":4653,"children":4654},{"class":207,"line":792},[4655],{"type":167,"tag":205,"props":4656,"children":4657},{"style":212},[4658],{"type":173,"value":4659},"      // ...\n",{"type":167,"tag":205,"props":4661,"children":4662},{"class":207,"line":1020},[4663,4667,4671,4675,4679,4683,4687,4691,4696,4700,4704],{"type":167,"tag":205,"props":4664,"children":4665},{"style":228},[4666],{"type":173,"value":3373},{"type":167,"tag":205,"props":4668,"children":4669},{"style":993},[4670],{"type":173,"value":4066},{"type":167,"tag":205,"props":4672,"children":4673},{"style":993},[4674],{"type":173,"value":4071},{"type":167,"tag":205,"props":4676,"children":4677},{"style":271},[4678],{"type":173,"value":617},{"type":167,"tag":205,"props":4680,"children":4681},{"style":222},[4682],{"type":173,"value":4498},{"type":167,"tag":205,"props":4684,"children":4685},{"style":458},[4686],{"type":173,"value":1369},{"type":167,"tag":205,"props":4688,"children":4689},{"style":245},[4690],{"type":173,"value":4012},{"type":167,"tag":205,"props":4692,"children":4693},{"style":251},[4694],{"type":173,"value":4695},"管理员",{"type":167,"tag":205,"props":4697,"children":4698},{"style":245},[4699],{"type":173,"value":248},{"type":167,"tag":205,"props":4701,"children":4702},{"style":271},[4703],{"type":173,"value":1378},{"type":167,"tag":205,"props":4705,"children":4706},{"style":228},[4707],{"type":173,"value":1167},{"type":167,"tag":205,"props":4709,"children":4710},{"class":207,"line":1045},[4711],{"type":167,"tag":205,"props":4712,"children":4713},{"style":212},[4714],{"type":173,"value":4659},{"type":167,"tag":205,"props":4716,"children":4717},{"class":207,"line":1063},[4718],{"type":167,"tag":205,"props":4719,"children":4720},{"style":228},[4721],{"type":173,"value":1458},{"type":167,"tag":205,"props":4723,"children":4724},{"class":207,"line":1071},[4725,4730],{"type":167,"tag":205,"props":4726,"children":4727},{"style":228},[4728],{"type":173,"value":4729},"  },",{"type":167,"tag":205,"props":4731,"children":4732},{"style":228},[4733],{"type":173,"value":358},{"type":167,"tag":205,"props":4735,"children":4736},{"class":207,"line":1080},[4737,4742,4746],{"type":167,"tag":205,"props":4738,"children":4739},{"style":271},[4740],{"type":173,"value":4741},"    immediate",{"type":167,"tag":205,"props":4743,"children":4744},{"style":228},[4745],{"type":173,"value":279},{"type":167,"tag":205,"props":4747,"children":4748},{"style":919},[4749],{"type":173,"value":4750}," true\n",{"type":167,"tag":205,"props":4752,"children":4753},{"class":207,"line":2558},[4754,4758],{"type":167,"tag":205,"props":4755,"children":4756},{"style":228},[4757],{"type":173,"value":1466},{"type":167,"tag":205,"props":4759,"children":4760},{"style":271},[4761],{"type":173,"value":294},{"type":167,"tag":205,"props":4763,"children":4764},{"class":207,"line":2571},[4765],{"type":167,"tag":205,"props":4766,"children":4767},{"style":228},[4768],{"type":173,"value":798},{"type":167,"tag":205,"props":4770,"children":4771},{"class":207,"line":2579},[4772],{"type":167,"tag":205,"props":4773,"children":4774},{"emptyLinePlaceholder":159},[4775],{"type":173,"value":2927},{"type":167,"tag":205,"props":4777,"children":4778},{"class":207,"line":3146},[4779],{"type":167,"tag":205,"props":4780,"children":4781},{"style":212},[4782],{"type":173,"value":4783},"// page b\n",{"type":167,"tag":205,"props":4785,"children":4786},{"class":207,"line":3175},[4787,4792,4796],{"type":167,"tag":205,"props":4788,"children":4789},{"style":234},[4790],{"type":173,"value":4791},"switchUserType",{"type":167,"tag":205,"props":4793,"children":4794},{"style":222},[4795],{"type":173,"value":4551},{"type":167,"tag":205,"props":4797,"children":4798},{"style":228},[4799],{"type":173,"value":1167},{"type":167,"tag":205,"props":4801,"children":4802},{"class":207,"line":3216},[4803,4807,4811,4815,4819,4823,4827,4831,4835],{"type":167,"tag":205,"props":4804,"children":4805},{"style":222},[4806],{"type":173,"value":4563},{"type":167,"tag":205,"props":4808,"children":4809},{"style":228},[4810],{"type":173,"value":231},{"type":167,"tag":205,"props":4812,"children":4813},{"style":222},[4814],{"type":173,"value":1899},{"type":167,"tag":205,"props":4816,"children":4817},{"style":228},[4818],{"type":173,"value":231},{"type":167,"tag":205,"props":4820,"children":4821},{"style":222},[4822],{"type":173,"value":4498},{"type":167,"tag":205,"props":4824,"children":4825},{"style":458},[4826],{"type":173,"value":582},{"type":167,"tag":205,"props":4828,"children":4829},{"style":245},[4830],{"type":173,"value":4012},{"type":167,"tag":205,"props":4832,"children":4833},{"style":251},[4834],{"type":173,"value":4695},{"type":167,"tag":205,"props":4836,"children":4837},{"style":245},[4838],{"type":173,"value":4376},{"type":167,"tag":205,"props":4840,"children":4841},{"class":207,"line":3237},[4842],{"type":167,"tag":205,"props":4843,"children":4844},{"style":228},[4845],{"type":173,"value":798},{"type":167,"tag":168,"props":4847,"children":4849},{"id":4848},"可能遇到的问题",[4850],{"type":173,"value":4848},{"type":167,"tag":818,"props":4852,"children":4854},{"id":4853},"给-watch-方法添加的函数设置立即执行",[4855],{"type":173,"value":4856},"给 watch 方法添加的函数设置立即执行",{"type":167,"tag":175,"props":4858,"children":4859},{},[4860],{"type":173,"value":4861},"有的时候我们希望通过 watch 添加函数的同时还立即执行该函数一次, 这个时候我们需要再定义额外的参数传递到 watch 中. 问题是这个函数不一定是同步函数.",{"type":167,"tag":175,"props":4863,"children":4864},{},[4865],{"type":173,"value":4866},"简单处理如下:",{"type":167,"tag":195,"props":4868,"children":4870},{"className":197,"code":4869,"language":199,"meta":160,"style":160},"class VX {\n  async watch (key, fn, options = { immediately: false }, obj = this.store) {\n    handleDep = fn\n    walkChains(key, obj)\n    options.immediately && await fn(options.defaultParams)\n  }\n}\n",[4871],{"type":167,"tag":181,"props":4872,"children":4873},{"__ignoreMap":160},[4874,4889,4982,4998,5025,5077,5084],{"type":167,"tag":205,"props":4875,"children":4876},{"class":207,"line":208},[4877,4881,4885],{"type":167,"tag":205,"props":4878,"children":4879},{"style":350},[4880],{"type":173,"value":532},{"type":167,"tag":205,"props":4882,"children":4883},{"style":535},[4884],{"type":173,"value":1864},{"type":167,"tag":205,"props":4886,"children":4887},{"style":228},[4888],{"type":173,"value":358},{"type":167,"tag":205,"props":4890,"children":4891},{"class":207,"line":218},[4892,4898,4903,4907,4911,4915,4919,4923,4927,4931,4935,4940,4944,4949,4954,4958,4962,4966,4970,4974,4978],{"type":167,"tag":205,"props":4893,"children":4895},{"style":4894},"--shiki-light:#9C3EDA;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[4896],{"type":173,"value":4897},"  async",{"type":167,"tag":205,"props":4899,"children":4900},{"style":609},[4901],{"type":173,"value":4902}," watch",{"type":167,"tag":205,"props":4904,"children":4905},{"style":228},[4906],{"type":173,"value":617},{"type":167,"tag":205,"props":4908,"children":4909},{"style":344},[4910],{"type":173,"value":1955},{"type":167,"tag":205,"props":4912,"children":4913},{"style":228},[4914],{"type":173,"value":263},{"type":167,"tag":205,"props":4916,"children":4917},{"style":344},[4918],{"type":173,"value":1964},{"type":167,"tag":205,"props":4920,"children":4921},{"style":228},[4922],{"type":173,"value":263},{"type":167,"tag":205,"props":4924,"children":4925},{"style":344},[4926],{"type":173,"value":2030},{"type":167,"tag":205,"props":4928,"children":4929},{"style":458},[4930],{"type":173,"value":582},{"type":167,"tag":205,"props":4932,"children":4933},{"style":228},[4934],{"type":173,"value":268},{"type":167,"tag":205,"props":4936,"children":4937},{"style":271},[4938],{"type":173,"value":4939}," immediately",{"type":167,"tag":205,"props":4941,"children":4942},{"style":228},[4943],{"type":173,"value":279},{"type":167,"tag":205,"props":4945,"children":4946},{"style":919},[4947],{"type":173,"value":4948}," false",{"type":167,"tag":205,"props":4950,"children":4951},{"style":228},[4952],{"type":173,"value":4953}," },",{"type":167,"tag":205,"props":4955,"children":4956},{"style":344},[4957],{"type":173,"value":1973},{"type":167,"tag":205,"props":4959,"children":4960},{"style":458},[4961],{"type":173,"value":582},{"type":167,"tag":205,"props":4963,"children":4964},{"style":565},[4965],{"type":173,"value":1153},{"type":167,"tag":205,"props":4967,"children":4968},{"style":228},[4969],{"type":173,"value":231},{"type":167,"tag":205,"props":4971,"children":4972},{"style":222},[4973],{"type":173,"value":1899},{"type":167,"tag":205,"props":4975,"children":4976},{"style":228},[4977],{"type":173,"value":627},{"type":167,"tag":205,"props":4979,"children":4980},{"style":228},[4981],{"type":173,"value":358},{"type":167,"tag":205,"props":4983,"children":4984},{"class":207,"line":297},[4985,4990,4994],{"type":167,"tag":205,"props":4986,"children":4987},{"style":222},[4988],{"type":173,"value":4989},"    handleDep",{"type":167,"tag":205,"props":4991,"children":4992},{"style":458},[4993],{"type":173,"value":582},{"type":167,"tag":205,"props":4995,"children":4996},{"style":222},[4997],{"type":173,"value":3033},{"type":167,"tag":205,"props":4999,"children":5000},{"class":207,"line":306},[5001,5005,5009,5013,5017,5021],{"type":167,"tag":205,"props":5002,"children":5003},{"style":234},[5004],{"type":173,"value":3714},{"type":167,"tag":205,"props":5006,"children":5007},{"style":271},[5008],{"type":173,"value":242},{"type":167,"tag":205,"props":5010,"children":5011},{"style":222},[5012],{"type":173,"value":1955},{"type":167,"tag":205,"props":5014,"children":5015},{"style":228},[5016],{"type":173,"value":263},{"type":167,"tag":205,"props":5018,"children":5019},{"style":222},[5020],{"type":173,"value":1973},{"type":167,"tag":205,"props":5022,"children":5023},{"style":271},[5024],{"type":173,"value":294},{"type":167,"tag":205,"props":5026,"children":5027},{"class":207,"line":361},[5028,5033,5037,5042,5046,5051,5055,5059,5064,5068,5073],{"type":167,"tag":205,"props":5029,"children":5030},{"style":222},[5031],{"type":173,"value":5032},"    options",{"type":167,"tag":205,"props":5034,"children":5035},{"style":228},[5036],{"type":173,"value":231},{"type":167,"tag":205,"props":5038,"children":5039},{"style":222},[5040],{"type":173,"value":5041},"immediately",{"type":167,"tag":205,"props":5043,"children":5044},{"style":458},[5045],{"type":173,"value":2777},{"type":167,"tag":205,"props":5047,"children":5048},{"style":993},[5049],{"type":173,"value":5050}," await",{"type":167,"tag":205,"props":5052,"children":5053},{"style":234},[5054],{"type":173,"value":1964},{"type":167,"tag":205,"props":5056,"children":5057},{"style":271},[5058],{"type":173,"value":242},{"type":167,"tag":205,"props":5060,"children":5061},{"style":222},[5062],{"type":173,"value":5063},"options",{"type":167,"tag":205,"props":5065,"children":5066},{"style":228},[5067],{"type":173,"value":231},{"type":167,"tag":205,"props":5069,"children":5070},{"style":222},[5071],{"type":173,"value":5072},"defaultParams",{"type":167,"tag":205,"props":5074,"children":5075},{"style":271},[5076],{"type":173,"value":294},{"type":167,"tag":205,"props":5078,"children":5079},{"class":207,"line":409},[5080],{"type":167,"tag":205,"props":5081,"children":5082},{"style":228},[5083],{"type":173,"value":595},{"type":167,"tag":205,"props":5085,"children":5086},{"class":207,"line":422},[5087],{"type":167,"tag":205,"props":5088,"children":5089},{"style":228},[5090],{"type":173,"value":798},{"type":167,"tag":818,"props":5092,"children":5094},{"id":5093},"this-绑定丢失问题",[5095],{"type":173,"value":5096},"this 绑定丢失问题",{"type":167,"tag":175,"props":5098,"children":5099},{},[5100],{"type":173,"value":5101},"在我在对 VX 进行删除属性方法的扩展时, 我往 walkChain 函数中添加了一个执行回调函数的机制, 并且在删除属性这个方法直接调用了 walkChain:",{"type":167,"tag":195,"props":5103,"children":5105},{"className":197,"code":5104,"language":199,"meta":160,"style":160},"  function walkChains (key, obj, fn) {\n    const segments = key.split('.')\n    let deepObj = obj\n    while (segments.length) {\n      deepObj = deepObj[segments.shift()]\n      fn && fn()\n    }\n  }\n",[5106],{"type":167,"tag":181,"props":5107,"children":5108},{"__ignoreMap":160},[5109,5153,5200,5220,5252,5288,5308,5315],{"type":167,"tag":205,"props":5110,"children":5111},{"class":207,"line":208},[5112,5117,5121,5125,5129,5133,5137,5141,5145,5149],{"type":167,"tag":205,"props":5113,"children":5114},{"style":350},[5115],{"type":173,"value":5116},"  function",{"type":167,"tag":205,"props":5118,"children":5119},{"style":234},[5120],{"type":173,"value":3440},{"type":167,"tag":205,"props":5122,"children":5123},{"style":228},[5124],{"type":173,"value":617},{"type":167,"tag":205,"props":5126,"children":5127},{"style":344},[5128],{"type":173,"value":1955},{"type":167,"tag":205,"props":5130,"children":5131},{"style":228},[5132],{"type":173,"value":263},{"type":167,"tag":205,"props":5134,"children":5135},{"style":344},[5136],{"type":173,"value":1973},{"type":167,"tag":205,"props":5138,"children":5139},{"style":228},[5140],{"type":173,"value":263},{"type":167,"tag":205,"props":5142,"children":5143},{"style":344},[5144],{"type":173,"value":1964},{"type":167,"tag":205,"props":5146,"children":5147},{"style":228},[5148],{"type":173,"value":627},{"type":167,"tag":205,"props":5150,"children":5151},{"style":228},[5152],{"type":173,"value":358},{"type":167,"tag":205,"props":5154,"children":5155},{"class":207,"line":218},[5156,5160,5164,5168,5172,5176,5180,5184,5188,5192,5196],{"type":167,"tag":205,"props":5157,"children":5158},{"style":350},[5159],{"type":173,"value":3152},{"type":167,"tag":205,"props":5161,"children":5162},{"style":1178},[5163],{"type":173,"value":3476},{"type":167,"tag":205,"props":5165,"children":5166},{"style":458},[5167],{"type":173,"value":582},{"type":167,"tag":205,"props":5169,"children":5170},{"style":222},[5171],{"type":173,"value":888},{"type":167,"tag":205,"props":5173,"children":5174},{"style":228},[5175],{"type":173,"value":231},{"type":167,"tag":205,"props":5177,"children":5178},{"style":234},[5179],{"type":173,"value":3493},{"type":167,"tag":205,"props":5181,"children":5182},{"style":271},[5183],{"type":173,"value":242},{"type":167,"tag":205,"props":5185,"children":5186},{"style":245},[5187],{"type":173,"value":248},{"type":167,"tag":205,"props":5189,"children":5190},{"style":251},[5191],{"type":173,"value":231},{"type":167,"tag":205,"props":5193,"children":5194},{"style":245},[5195],{"type":173,"value":248},{"type":167,"tag":205,"props":5197,"children":5198},{"style":271},[5199],{"type":173,"value":294},{"type":167,"tag":205,"props":5201,"children":5202},{"class":207,"line":297},[5203,5208,5212,5216],{"type":167,"tag":205,"props":5204,"children":5205},{"style":350},[5206],{"type":173,"value":5207},"    let",{"type":167,"tag":205,"props":5209,"children":5210},{"style":222},[5211],{"type":173,"value":3525},{"type":167,"tag":205,"props":5213,"children":5214},{"style":458},[5215],{"type":173,"value":582},{"type":167,"tag":205,"props":5217,"children":5218},{"style":222},[5219],{"type":173,"value":3534},{"type":167,"tag":205,"props":5221,"children":5222},{"class":207,"line":306},[5223,5228,5232,5236,5240,5244,5248],{"type":167,"tag":205,"props":5224,"children":5225},{"style":993},[5226],{"type":173,"value":5227},"    while",{"type":167,"tag":205,"props":5229,"children":5230},{"style":271},[5231],{"type":173,"value":617},{"type":167,"tag":205,"props":5233,"children":5234},{"style":222},[5235],{"type":173,"value":3551},{"type":167,"tag":205,"props":5237,"children":5238},{"style":228},[5239],{"type":173,"value":231},{"type":167,"tag":205,"props":5241,"children":5242},{"style":1178},[5243],{"type":173,"value":3560},{"type":167,"tag":205,"props":5245,"children":5246},{"style":271},[5247],{"type":173,"value":1378},{"type":167,"tag":205,"props":5249,"children":5250},{"style":228},[5251],{"type":173,"value":1167},{"type":167,"tag":205,"props":5253,"children":5254},{"class":207,"line":361},[5255,5260,5264,5268,5272,5276,5280,5284],{"type":167,"tag":205,"props":5256,"children":5257},{"style":222},[5258],{"type":173,"value":5259},"      deepObj",{"type":167,"tag":205,"props":5261,"children":5262},{"style":458},[5263],{"type":173,"value":582},{"type":167,"tag":205,"props":5265,"children":5266},{"style":222},[5267],{"type":173,"value":3525},{"type":167,"tag":205,"props":5269,"children":5270},{"style":271},[5271],{"type":173,"value":3589},{"type":167,"tag":205,"props":5273,"children":5274},{"style":222},[5275],{"type":173,"value":3551},{"type":167,"tag":205,"props":5277,"children":5278},{"style":228},[5279],{"type":173,"value":231},{"type":167,"tag":205,"props":5281,"children":5282},{"style":234},[5283],{"type":173,"value":3602},{"type":167,"tag":205,"props":5285,"children":5286},{"style":271},[5287],{"type":173,"value":3607},{"type":167,"tag":205,"props":5289,"children":5290},{"class":207,"line":409},[5291,5296,5300,5304],{"type":167,"tag":205,"props":5292,"children":5293},{"style":222},[5294],{"type":173,"value":5295},"      fn",{"type":167,"tag":205,"props":5297,"children":5298},{"style":458},[5299],{"type":173,"value":2777},{"type":167,"tag":205,"props":5301,"children":5302},{"style":234},[5303],{"type":173,"value":1964},{"type":167,"tag":205,"props":5305,"children":5306},{"style":271},[5307],{"type":173,"value":1199},{"type":167,"tag":205,"props":5309,"children":5310},{"class":207,"line":422},[5311],{"type":167,"tag":205,"props":5312,"children":5313},{"style":228},[5314],{"type":173,"value":1458},{"type":167,"tag":205,"props":5316,"children":5317},{"class":207,"line":676},[5318],{"type":167,"tag":205,"props":5319,"children":5320},{"style":228},[5321],{"type":173,"value":595},{"type":167,"tag":195,"props":5323,"children":5325},{"className":197,"code":5324,"language":199,"meta":160,"style":160},"del (key, obj = this.store) {\n  walkChains(key, obj, handleDep.clear)\n  delete obj[key]\n}\n",[5326],{"type":167,"tag":181,"props":5327,"children":5328},{"__ignoreMap":160},[5329,5369,5415,5439],{"type":167,"tag":205,"props":5330,"children":5331},{"class":207,"line":208},[5332,5337,5341,5345,5349,5353,5357,5361,5365],{"type":167,"tag":205,"props":5333,"children":5334},{"style":234},[5335],{"type":173,"value":5336},"del",{"type":167,"tag":205,"props":5338,"children":5339},{"style":222},[5340],{"type":173,"value":1113},{"type":167,"tag":205,"props":5342,"children":5343},{"style":228},[5344],{"type":173,"value":263},{"type":167,"tag":205,"props":5346,"children":5347},{"style":222},[5348],{"type":173,"value":1144},{"type":167,"tag":205,"props":5350,"children":5351},{"style":458},[5352],{"type":173,"value":461},{"type":167,"tag":205,"props":5354,"children":5355},{"style":565},[5356],{"type":173,"value":1153},{"type":167,"tag":205,"props":5358,"children":5359},{"style":228},[5360],{"type":173,"value":231},{"type":167,"tag":205,"props":5362,"children":5363},{"style":222},[5364],{"type":173,"value":1162},{"type":167,"tag":205,"props":5366,"children":5367},{"style":228},[5368],{"type":173,"value":1167},{"type":167,"tag":205,"props":5370,"children":5371},{"class":207,"line":218},[5372,5377,5381,5385,5389,5393,5397,5402,5406,5411],{"type":167,"tag":205,"props":5373,"children":5374},{"style":234},[5375],{"type":173,"value":5376},"  walkChains",{"type":167,"tag":205,"props":5378,"children":5379},{"style":271},[5380],{"type":173,"value":242},{"type":167,"tag":205,"props":5382,"children":5383},{"style":222},[5384],{"type":173,"value":1955},{"type":167,"tag":205,"props":5386,"children":5387},{"style":228},[5388],{"type":173,"value":263},{"type":167,"tag":205,"props":5390,"children":5391},{"style":222},[5392],{"type":173,"value":1973},{"type":167,"tag":205,"props":5394,"children":5395},{"style":228},[5396],{"type":173,"value":263},{"type":167,"tag":205,"props":5398,"children":5399},{"style":222},[5400],{"type":173,"value":5401}," handleDep",{"type":167,"tag":205,"props":5403,"children":5404},{"style":228},[5405],{"type":173,"value":231},{"type":167,"tag":205,"props":5407,"children":5408},{"style":222},[5409],{"type":173,"value":5410},"clear",{"type":167,"tag":205,"props":5412,"children":5413},{"style":271},[5414],{"type":173,"value":294},{"type":167,"tag":205,"props":5416,"children":5417},{"class":207,"line":297},[5418,5423,5427,5431,5435],{"type":167,"tag":205,"props":5419,"children":5420},{"style":458},[5421],{"type":173,"value":5422},"  delete",{"type":167,"tag":205,"props":5424,"children":5425},{"style":222},[5426],{"type":173,"value":1973},{"type":167,"tag":205,"props":5428,"children":5429},{"style":271},[5430],{"type":173,"value":3589},{"type":167,"tag":205,"props":5432,"children":5433},{"style":222},[5434],{"type":173,"value":1955},{"type":167,"tag":205,"props":5436,"children":5437},{"style":271},[5438],{"type":173,"value":3975},{"type":167,"tag":205,"props":5440,"children":5441},{"class":207,"line":306},[5442],{"type":167,"tag":205,"props":5443,"children":5444},{"style":228},[5445],{"type":173,"value":798},{"type":167,"tag":175,"props":5447,"children":5448},{},[5449,5451,5456],{"type":173,"value":5450},"因为 handleDep.clear 当成参数传递进 walkChains 中会",{"type":167,"tag":511,"props":5452,"children":5453},{},[5454],{"type":173,"value":5455},"丢失 this 绑定",{"type":173,"value":5457},", 所以上面那段代码其实是有问题的, 不过稍作修改就好了:",{"type":167,"tag":195,"props":5459,"children":5461},{"className":197,"code":5460,"language":199,"meta":160,"style":160},"  del (key, obj = this.store) {\n    walkChains(key, obj, () => handleDep.clear())\n    delete obj[key]\n  }\n",[5462],{"type":167,"tag":181,"props":5463,"children":5464},{"__ignoreMap":160},[5465,5505,5557,5581],{"type":167,"tag":205,"props":5466,"children":5467},{"class":207,"line":208},[5468,5473,5477,5481,5485,5489,5493,5497,5501],{"type":167,"tag":205,"props":5469,"children":5470},{"style":234},[5471],{"type":173,"value":5472},"  del",{"type":167,"tag":205,"props":5474,"children":5475},{"style":222},[5476],{"type":173,"value":1113},{"type":167,"tag":205,"props":5478,"children":5479},{"style":228},[5480],{"type":173,"value":263},{"type":167,"tag":205,"props":5482,"children":5483},{"style":222},[5484],{"type":173,"value":1144},{"type":167,"tag":205,"props":5486,"children":5487},{"style":458},[5488],{"type":173,"value":461},{"type":167,"tag":205,"props":5490,"children":5491},{"style":565},[5492],{"type":173,"value":1153},{"type":167,"tag":205,"props":5494,"children":5495},{"style":228},[5496],{"type":173,"value":231},{"type":167,"tag":205,"props":5498,"children":5499},{"style":222},[5500],{"type":173,"value":1162},{"type":167,"tag":205,"props":5502,"children":5503},{"style":228},[5504],{"type":173,"value":1167},{"type":167,"tag":205,"props":5506,"children":5507},{"class":207,"line":218},[5508,5512,5516,5520,5524,5528,5532,5536,5540,5544,5548,5552],{"type":167,"tag":205,"props":5509,"children":5510},{"style":234},[5511],{"type":173,"value":3714},{"type":167,"tag":205,"props":5513,"children":5514},{"style":271},[5515],{"type":173,"value":242},{"type":167,"tag":205,"props":5517,"children":5518},{"style":222},[5519],{"type":173,"value":1955},{"type":167,"tag":205,"props":5521,"children":5522},{"style":228},[5523],{"type":173,"value":263},{"type":167,"tag":205,"props":5525,"children":5526},{"style":222},[5527],{"type":173,"value":1973},{"type":167,"tag":205,"props":5529,"children":5530},{"style":228},[5531],{"type":173,"value":263},{"type":167,"tag":205,"props":5533,"children":5534},{"style":228},[5535],{"type":173,"value":555},{"type":167,"tag":205,"props":5537,"children":5538},{"style":350},[5539],{"type":173,"value":353},{"type":167,"tag":205,"props":5541,"children":5542},{"style":222},[5543],{"type":173,"value":5401},{"type":167,"tag":205,"props":5545,"children":5546},{"style":228},[5547],{"type":173,"value":231},{"type":167,"tag":205,"props":5549,"children":5550},{"style":234},[5551],{"type":173,"value":5410},{"type":167,"tag":205,"props":5553,"children":5554},{"style":271},[5555],{"type":173,"value":5556},"())\n",{"type":167,"tag":205,"props":5558,"children":5559},{"class":207,"line":297},[5560,5565,5569,5573,5577],{"type":167,"tag":205,"props":5561,"children":5562},{"style":458},[5563],{"type":173,"value":5564},"    delete",{"type":167,"tag":205,"props":5566,"children":5567},{"style":222},[5568],{"type":173,"value":1973},{"type":167,"tag":205,"props":5570,"children":5571},{"style":271},[5572],{"type":173,"value":3589},{"type":167,"tag":205,"props":5574,"children":5575},{"style":222},[5576],{"type":173,"value":1955},{"type":167,"tag":205,"props":5578,"children":5579},{"style":271},[5580],{"type":173,"value":3975},{"type":167,"tag":205,"props":5582,"children":5583},{"class":207,"line":306},[5584],{"type":167,"tag":205,"props":5585,"children":5586},{"style":228},[5587],{"type":173,"value":595},{"type":167,"tag":168,"props":5589,"children":5591},{"id":5590},"后语",[5592],{"type":173,"value":5590},{"type":167,"tag":175,"props":5594,"children":5595},{},[5596],{"type":173,"value":5597},"在这篇文章中, 我们通过对 defineProperty 进行封装, 实现了一个简单的对象属性侦听器的功能, 以弥补小程序所没有的$watch 能力. 在此基础上, 各位可以再对 VX 进行扩展, 更方便地去书写业务代码.",{"type":167,"tag":175,"props":5599,"children":5600},{},[5601,5603],{"type":173,"value":5602},"完整代码 ",{"type":167,"tag":437,"props":5604,"children":5608},{"href":5605,"rel":5606},"https://github.com/Lionad-Morotar/media-gear/blob/master/src/renderer/utils/suites/vx/index.js",[5607],"nofollow",[5609],{"type":173,"value":5610},"GitHub 直达",{"type":167,"tag":5612,"props":5613,"children":5614},"style",{},[5615],{"type":173,"value":5616},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":160,"searchDepth":218,"depth":218,"links":5618},[5619,5620,5621,5622,5625,5630,5631,5634,5638],{"id":170,"depth":218,"text":170},{"id":492,"depth":218,"text":492},{"id":502,"depth":218,"text":502},{"id":814,"depth":218,"text":814,"children":5623},[5624],{"id":820,"depth":297,"text":823},{"id":1799,"depth":218,"text":1802,"children":5626},[5627,5628,5629],{"id":1805,"depth":297,"text":1805},{"id":1837,"depth":297,"text":1840},{"id":2587,"depth":297,"text":2587},{"id":3396,"depth":218,"text":3399},{"id":4299,"depth":218,"text":4299,"children":5632},[5633],{"id":4304,"depth":297,"text":4304},{"id":4848,"depth":218,"text":4848,"children":5635},[5636,5637],{"id":4853,"depth":297,"text":4856},{"id":5093,"depth":297,"text":5096},{"id":5590,"depth":218,"text":5590},"markdown","content:_achieved:2019-05:reactive-in-150loc.md","content","_achieved/2019-05/reactive-in-150loc.md","_achieved/2019-05/reactive-in-150loc","md",[5646,5649],{"_path":5647,"title":5648,"description":160},"/_achieved/2018-10/noname","🌆 无题",{"_path":5650,"title":5651,"description":160},"/_achieved/2019-06/messy-in-two-years","💖 聊聊此次离职，毕业，及其它杂乱的事情",1742348687786]