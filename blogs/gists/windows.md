# Windows

[TOC]

## æ“ä½œç³»ç»Ÿ

### ç¡¬é“¾æ¥ã€è½¯é“¾æ¥ã€ç¬¦å·é“¾æ¥

ğŸ”— ç¡¬é“¾æ¥ä½¿å¾—ä¸€ä¸ªä¸€ä¸ªæ–‡ä»¶æœ‰å¤šä¸ªè®¿é—®å…¥å£ã€‚å½“æ‰€æœ‰å…¥å£è¢«åˆ é™¤æ—¶ï¼Œæ–‡ä»¶æ‰çœŸæ­£è¢«åˆ é™¤ã€‚

ğŸ‘ï¼šå…¼å®¹æ€§å¥½ã€ä¸å—ç›˜ç¬¦å½±å“
<br>
ğŸ‘ï¼šä¸æ”¯æŒæ–‡ä»¶å¤¹ã€åªæ”¯æŒæœ¬åœ°é©±åŠ¨å™¨çš„ç›¸åŒåˆ†åŒº

ğŸ”— è½¯é“¾æ¥ï¼ˆå¦‚ Junctionï¼‰å°†å¯¹æ–‡ä»¶å¤¹è¿›è¡Œé‡å®šå‘ã€‚ç±»ä¼¼äºç¯å¢ƒå˜é‡ï¼Œå¤–éƒ¨ç¨‹åºå¹¶ä¸ä¼šçŸ¥é“è‡ªå·±åœ¨å¤„ç†ä¸€ä¸ªè½¯é“¾æ¥ã€‚

ğŸ‘ï¼šå…¼å®¹æ€§ä¸é”™ã€æ”¯æŒæ–‡ä»¶å¤¹å’Œæ–‡ä»¶ï¼ˆJunction æ”¯æŒæ–‡ä»¶å¤¹ï¼‰ã€æ”¯æŒè·¨åˆ†åŒº
<br>
ğŸ‘ï¼šä¸æ”¯æŒç›¸å¯¹è·¯å¾„ã€å—ç›˜ç¬¦å½±å“ã€æŸäº›ç³»ç»Ÿçš„æ ¸å¿ƒæ–‡ä»¶å¤¹ä¸æ”¯æŒè½¯é“¾æ¥

ğŸ”— ç¬¦å·é“¾æ¥æ˜¯è½¯é“¾æ¥çš„å‡çº§ç‰ˆã€‚

ğŸ‘ï¼šæ”¯æŒä»»æ„è·¯å¾„ï¼Œç”šè‡³æ˜¯ä¸å­˜åœ¨çš„è·¯å¾„
<br>
ğŸ‘ï¼šå…¼å®¹æ€§è¾ƒå·®ã€éœ€è¦ç®¡ç†å‘˜æƒé™

#### å¦‚ä½•è·å¾—é“¾æ¥çš„çœŸå®åœ°å€ï¼Ÿ

```powershell
dir <parentPath> | format-table | findstr <childPath>
```

## ç¯å¢ƒå˜é‡

##### <Link type="h5" to="https://mgear-file.oss-cn-shanghai.aliyuncs.com/%E6%80%8E%E6%A0%B7%E6%89%8D%E8%83%BD%E7%9B%B4%E6%8E%A5%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8FPath%E4%B8%AD%E7%9B%AE%E5%BD%95%E7%9A%84%E5%AD%90%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84%E7%A8%8B%E5%BA%8F_CSDN%E7%A4%BE%E5%8C%BA.html" source="https://bbs.csdn.net/topics/390354388" >ã€Šæ€æ ·æ‰èƒ½ç›´æ¥è¿è¡Œç¯å¢ƒå˜é‡Pathä¸­ç›®å½•çš„å­ç›®å½•ä¸­çš„ç¨‹åºã€‹</Link>

æ€ä¹ˆæ ·åœ¨ cmd ä¸­ç›´æ¥è®¿é—®æŸæ–‡ä»¶å¤¹åŠå…¶å­æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰ç¨‹åºå‘¢ï¼Ÿå½“ç„¶æ˜¯æŠŠå®ƒä»¬æ·»åŠ åˆ°ç¯å¢ƒå˜é‡é‡Œé¢å•¦~

æ–‡ä¸­æœ‰ä¸€æ®µç®€å•çš„ cmd è„šæœ¬ç”¨æ¥é€’å½’æŸ¥æ‰¾æ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰ç›®å½•ï¼Œè¿™ä¹‹åå¯ä»¥æŠŠè¿™äº›ç›®å½•æ·»åŠ çš„ Path ä¸­ï¼Œè¿™æ ·ï¼Œç›®å½•ä¸‹çš„ç¨‹åºå°±å¯ä»¥ç›´æ¥è®¿é—®äº†ã€‚

**è‡ªåŠ¨è®¾ç½®ç¯å¢ƒå˜é‡è„šæœ¬**ï¼šæˆ‘çš„éœ€æ±‚å’Œæ–‡ç« æè¿°çš„ä¸å¤ªä¸€æ ·ã€‚é¦–å…ˆæˆ‘åœ¨ OneDrive é‡Œæœ‰ä¸€ä¸ª Code çš„æ–‡ä»¶å¤¹ï¼Œè£…äº†è¯¸å¦‚ Python2ã€Python3ã€NodeJS ç­‰è®¸è®¸å¤šå¤šçš„ä¾èµ–æ–‡ä»¶ï¼Œæˆ‘æƒ³é€šè¿‡è„šæœ¬ä¸€æ¬¡æ€§å…¨éƒ¨å°†ä»–ä»¬åŠ å…¥ CodeBin å˜é‡ä¸‹ã€‚ä»¥ä¸‹æ˜¯æˆ‘çš„ä»£ç ï¼Œååˆ†ç®€é™‹ï¼Œä»…ä¾›å‚è€ƒæ€è·¯ã€‚

![C:\Users\lionad\OneDrive\Code](https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20210917151711.png?type=win11)

é¦–å…ˆï¼Œåœ¨â€œæ–‡æ¡£\WindowsPowerShellâ€ç›®å½•ä¸‹æ–°å»ºâ€œCustom\Set-Env.ps1â€è„šæœ¬ï¼Œå†™å¥½è®¾ç½®ç¯å¢ƒå˜é‡çš„å‡½æ•°ã€‚

```powershell
param(
  $name = $(throw 'å…¨å±€å˜é‡é”®åå¿…å¡«'),
  $path = $(throw 'è·¯å¾„å¿…å¡«'),
  # æ˜¯å¦è¦†ç›–æºé”®å€¼å¯¹
  $overwrite = $False
)

"name=$name"
"path=$path"
"overwrite=$overwrite"

# è·å–æ‰€æœ‰å­æ–‡ä»¶å¤¹
$values = if (test-path $path) {
  Get-ChildItem $path | 
    Where-Object { $_.getType().name -ne 'FileInfo' } | 
    ForEach-Object { $_.FullName }
} else {
  $path
}

# æ˜¯å¦åˆå¹¶åŸæœ‰æ•°æ®
$old = [environment]::GetEnvironmentVariable($name, 'Machine')
$val = If ($overwrite) { $values -join ';' } Else { $old + ($values -join ';') }

# å»é™¤é‡å¤
$washed = ($val.split(';') | Sort-Object -unique) -join ';'

Write-Output ("[Set-Env] " + $washed)

# è®¾ç½®ç¯å¢ƒå˜é‡
[environment]::SetEnvironmentVariable($name, $washed, 'Machine')
```

ç„¶åï¼Œä¿®æ”¹â€œæ–‡æ¡£\WindowsPowerShell\Microsoft.PowerShell_profile.ps1â€æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶ä¼šåœ¨æ‰“å¼€ PowerShell æ—¶è‡ªåŠ¨æ‰§è¡Œï¼Œæˆ‘æŠŠå®ƒç†è§£ä¸ºç”¨æˆ·çš„å…¨å±€é…ç½®ã€‚

```powershell
# æ‰§è¡Œè„šæœ¬å¹¶ç­‰å¾…ç»“æœ
function Execution ($scripts = @()) {
  $jobs = @()
  foreach ($script in $scripts) {
    $jobs += Start-Job -FilePath $script.path -ArgumentList $script.args
  }
  Wait-Job $jobs
  foreach ($job in $jobs) {
    " "
    "*" * 60
    " "
    "Receive Job Script output:"
    Receive-Job $job
  }
}

# è®¾ç½®ç¯å¢ƒå˜é‡
function Set-Env (
  [String]$name = $(throw "Args Error, env keyname should be an String"),
  [String]$value= $(throw "Args Error, path should be an String"),
  [Boolean]$overwrite = $False
) {
  $customdir = Join-Path -Path $profiledir -ChildPath 'Custom/'
  $script = @{
    path = (Join-Path -Path $customdir -ChildPath 'Set-Env.ps1');
    args = @($name,$value,$overwrite)
  }
  Execution($script)
}
```

è¿™ä¹‹åï¼Œä¿å­˜å¹¶é‡å¯ PowerShellï¼Œå°±å¯ä»¥æ„‰å¿«çš„è°ƒç”¨ set-env å‡½æ•°äº†ã€‚

æµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬çš„è„šæœ¬èƒ½ä¸èƒ½è·‘é€šã€‚

```js
set-env "test" "C:\\Users\\18062\\OneDrive\\WebSaver"
```

è„šæœ¬è¿”å›äº†å†…å®¹ï¼Œå†æŸ¥çœ‹ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼Œä¹Ÿæ²¡å•¥é—®é¢˜~

![test](https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20210917152840.png?type=win11-square)

**é˜²æ­¢å•ä¸ªç¯å¢ƒå˜é‡è¿‡äºè‡ƒè‚¿**ï¼šæˆ‘æ²¡è®°é”™çš„è¯ï¼Œå•ä¸ªç¯å¢ƒå˜é‡çš„å€¼é•¿åº¦æ˜¯æœ‰é™çš„ï¼Œå¾ˆå®¹æ˜“å°±è¶…è¿‡äº†ã€‚æ‰€ä»¥ä¸€åŠä¸ä¼šç›´æ¥æŠŠä¸€æ®µå¸¸å¸¸çš„æ–‡æœ¬è®°å½•åˆ° Path å˜é‡ä¸‹ï¼Œè€Œæ˜¯åœ¨ Path ä¸‹å†å¼•ç”¨ä¸€ä¸ªæ–°çš„ç¯å¢ƒå˜é‡ã€‚

æˆ‘åœ¨ Path å˜é‡ä¸‹å¼•ç”¨äº† CodeBin å˜é‡ï¼š

![Path](https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20210917150802.png?type=win11)

åœ¨ CodeBin å˜é‡é‡Œé¢å¡æ»¡å…¶å®ƒè·¯å¾„ï¼Œä¸è‡³äºæ’‘çˆ† Path å˜é‡ï¼š

![CodeBin](https://mgear-image.oss-cn-shanghai.aliyuncs.com/image/other/20210917150717.png?type=win11)
