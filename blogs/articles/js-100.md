# 🏆 学习 JS，从忍者到杀手

<style lang="styl">
label-idx { }
details .correct { color: #7ec699; &:before { content: '回答正确：' } }
details .wrong { color: #f08d49; &:before { content: '回答错误：' } }
.label-idx { margin-top: 4em;  }

corrects = 'Empty', 'D', 'D', 'C', 'A', 'D', 'B','C', 'B','B','A','C', 'A','D','B','B','C',

len = 16
for i in (1..len) {
    correct = corrects[i]
    #js-100-{i} {
        content: correct;
        details {
          display: none;
        }
        input:checked ~ details  {
          display: block;
          .correct {
      	    display: none;
    	  }
          .wrong {
      	    display: inline;
    	  }
        }
    	input[value=\'{correct}\']:checked ~ details {
          /* summary + p {
            display: none;
          } */
          .correct {
      	    display: inline;
    	  }
          .wrong {
      	    display: none;
    	  }
        }
    }
}
</style>

相信大家对《JS 忍者秘籍》一定非常熟悉。想要成为忍者，必须<del>自宫</del>对原型、闭包、函数、作用域等概念极其熟悉，对各种语言核心概念倒背如流。如果你有幸能将这些原理应用到实战，创建各种精巧的原型，并通过社区的考验，最后才能获得忍者勋章。

不过，杀手和忍者不同，杀手天生就追求每一个细节。确切的说，JS 杀手追求回归 JS 语言本身（而不是编程实践）。

以下，我准备了一些 JS 难题，它们和某些 JS 核心概念相关。每一个 JS 杀手，或者想成为 JS 杀手的开发都可以来试试，看看自己对 JS 的掌握程度。如果回答不出来的话也请不要气馁，因为其中涉及的内容和日常的编程实践相差甚远。

前置说明：

- 代码执行以 ES6 语言规范为标准。
- 每一个代码片段都以全局代码的形式运行。
- 每一个题目都互相独立，其变量互不干涉。

**准备好了吗？杀手试炼开始了！**

<b><span class="label-idx">1.</span>出门前先做个热身运动~</b>

```js
do = {
  get ['exercise']() {
    delete do.exercise
    return do.exercise
  }
}
do.exercise()
```

<form id="js-100-1" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=1 value='A'>undefined</input>
  <input type=radio name=1 value='B'>null</input>
  <input type=radio name=1 value='C'>Maxmum call stack size exceeded</input>
  <input type=radio name=1 value='D'>Syntax Error</input>

  <details open>
    <summary><span class='correct'>热身运动完成！</span><span class='wrong'>不小心扭到腰了！</span></summary>
    <p>`do` 是 JS 中的关键字，一般用在 `do while` 语句中。而这个例子里的代码是会在静态分析阶段报语法错误的。</p>
  </details>
</form>

<b><span class="label-idx">2.</span>检查一下防弹衣和弹药~</b>

```js
;[Number.isNaN('AKM'), isNaN('7.62 x 39mm Ammo')]
```

<form id="js-100-2" action="" onsubmit="return false">
  <label>请填写答案：</label>
  <input type=radio name=2 value='A'>true,true</input>
  <input type=radio name=2 value='B'>true,false</input>
  <input type=radio name=2 value='C'>false,false</input>
  <input type=radio name=2 value='D'>false,true</input>

  <details open>
    <summary><span class='correct'>弹药补充完毕！</span><span class='wrong'>居然没弹药！不会吧！？</span></summary>
    <p> isNaN 会对传入的值进行 toNumber 转换，而 Number.isNaN 不会。见：<a href="http://mgear-blogs.obs-website.cn-east-3.myhuaweicloud.com/articles/gists/interview-prepare/not-a-number.html">Number.isNaN VS isNaN</a>。</p>
  </details>
</form>

<b><span class="label-idx">3.</span>你会在打开车门的时候犹豫么？</b>

```js
;(function(where, undefined, where) {
  console.log(arguments[1] + where)
})('left', 'sunroof', 'right')
```

<form id="js-100-3" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=3 value='A'>'rightright'</input>
  <input type=radio name=3 value='B'>'rightleft'</input>
  <input type=radio name=3 value='C'>'sunroofright'</input>
  <input type=radio name=3 value='D'>'sunroofleft'</input>

  <details open>
    <summary><span class='correct'>上路！</span><span class='wrong'>天，钥匙没拿！</span></summary>
    <p>简单参数类型（如没有默认值）的声明行为类似 var，而非简单参数类型则会报错。</p>
  </details>
</form>

<b><span class="label-idx">4.</span>汽车启动，坐稳了！</b>

```js
;(function(x = 1, undefined, y = 2) {
  return [...arguments].reduce((speed, acceleration) => speed + acceleration, 0)
})()
```

<form id="js-100-4" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=4 value='A'>0</input>
  <input type=radio name=4 value='B'>1</input>
  <input type=radio name=4 value='C'>2</input>
  <input type=radio name=4 value='D'>3</input>

  <details open>
    <summary><span class='correct'>时速 80！</span><span class='wrong'>哦豁，发动机在冒烟！</span></summary>
    <p>非简单参数类型不会绑定到 arguments 中，所以 arguments 为空，累加得 0。</p>
  </details>
</form>

<b><span class="label-idx">5.</span>在街道上四处乱窜~</b>

```js
;[
  function() {}.__proto__ === Function.prototype,
  Function.prototype === Object.prototype,
  Function.__proto__ === Object.__proto__,
  Function.prototype.__proto__ === Object.prototype
].filter(Boolean).length
```

<form id="js-100-5" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=5 value='A'>0</input>
  <input type=radio name=5 value='B'>1</input>
  <input type=radio name=5 value='C'>2</input>
  <input type=radio name=5 value='D'>3</input>

  <details open>
    <summary><span class='correct'>搜索目标的同时还能看看风景~</span><span class='wrong'>天，好像迷路了！</span></summary>
    <p>这个题目的话... 需要杀手操练无数次并刻在脑子里。可以康康 <a href="https://www.google.com.hk/search?q=JS+prototype+%2B+Hursh+Jain&tbm=isch&oq=JS+prototype+%2B+Hursh+Jain"  target="_blank" rel="nofollow">Hursh Jain 的 JS 原型链图片</a>，非常清晰。</p>
  </details>
</form>

<b><span class="label-idx">6.</span>终于找到目标了！</b>

```js
var target = {
  seen() {
    console.log(this === target)
  }
}
;('haha', target.seen)()
```

<form id="js-100-6" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=6 value='A'>true</input>
  <input type=radio name=6 value='B'>false</input>
  <input type=radio name=6 value='C'>Error</input>
  <input type=radio name=6 value='D'>undefined</input>

  <details open>
    <summary><span class='correct'>目标能看得一清二楚！</span><span class='wrong'>等等，目标消失在了人群中！</span></summary>
    <p>表达式将返回“值”，这个“值”不会携带计算时上下文信息。可以想象为先把 target.seen 赋值给一个变量，然后单独调用该变量。</p>
  </details>
</form>

<b><span class="label-idx">7.</span>首先要破坏掉报警系统！</b>

```js
// 浏览器环境
var alert = (...args) => console.log(args)
delete alert
console.log(alert)
```

<form id="js-100-7" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=7 value='A'>true</input>
  <input type=radio name=7 value='B'>false</input>
  <input type=radio name=7 value='C'>Error</input>
  <input type=radio name=7 value='D'>undefined</input>

  <details open>
    <summary><span class='correct'>一枪打爆了摄像头！</span><span class='wrong'>什么！？这子弹连摄像头都打不烂！？</span></summary>
    <p>试试使用 Object.getOwnPropertyDescriptor(window, 'alert') 看看会发生什么？</p>
  </details>
</form>

<b><span class="label-idx">8.</span>精确计算开枪距离！</b>

```js
let carX = 1,
  cameraX = 2,
  targetX = 3
console.log(carX < cameraX < targetX, targetX < cameraX < carX)
```

<form id="js-100-8" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=8 value='A'>true,false</input>
  <input type=radio name=8 value='B'>true,true</input>
  <input type=radio name=8 value='C'>false,false</input>
  <input type=radio name=8 value='D'>Error</input>

  <details open>
    <summary><span class='correct'>目标已锁定~</span><span class='wrong'>哦豁，今天风好像有点大~</span></summary>
    <p>在这题，杀手你需要注意运算顺序和 JS 中独特的隐式转换特性。</p>
  </details>
</form>

<b><span class="label-idx">9.</span>删除目标！</b>

```js
;[
  void "killer's target" === undefined,
  delete void "killer's target" === delete undefined,
  delete undefined === delete null
].filter(Boolean).length
```

<form id="js-100-9" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=9 value='A'>0</input>
  <input type=radio name=9 value='B'>1</input>
  <input type=radio name=9 value='C'>2</input>
  <input type=radio name=9 value='D'>3</input>

  <details open>
    <summary><span class='correct'>目标已删除~</span><span class='wrong'>我们未能击穿他的防弹衣！</span></summary>
    <p>TODO</p>
  </details>
</form>

<b><span class="label-idx">10.</span>“邪恶的”内心的挣扎！</b>

```js
eval(`typeof typeof ghost === typeof ${typeof ghost}`)
```

<form id="js-100-10" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=10 value='A'>false</input>
  <input type=radio name=10 value='B'>true</input>
  <input type=radio name=10 value='C'>Error</input>
  <input type=radio name=10 value='D'>undefined</input>

  <details open>
    <summary><span class='correct'>血腥场面对杀手造成不了任何影响。</span><span class='wrong'>血腥场面使你有些反胃。</span></summary>
    <p>TODO</p>
  </details>
</form>

<b><span class="label-idx">11.</span>更多的“邪恶”😈，它会淹没你吗？</b>

```js
;(function(ghost) {
  const code = `typeof ${ghost}`
  return eval(code) + ('magic', eval)(code)
})('ghost')
```

<form id="js-100-11" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=11 value='A'>'ghostmagic'</input>
  <input type=radio name=11 value='B'>'stringmagic'</input>
  <input type=radio name=11 value='C'>'stringundefined'</input>
  <input type=radio name=11 value='D'>'stringstring'</input>

  <details open>
    <summary><span class='correct'>血腥场面对杀手造成不了任何影响。</span><span class='wrong'>你的精神状态更糟糕了，仿佛看到了目标的幽灵。</span></summary>
    <p>TODO</p>
  </details>
</form>

<b><span class="label-idx">12.</span>SAN 值狂减！</b>

```js
// finally 中的 console.log 会输出么？最后返回的 san 是多少？
;(function() {
  let san = 3
  try {
    --san
    return san
  } finally {
    --san
    console.log(san)
  }
})()
```

<form id="js-100-12" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=12 value='A'>输出 1，返回 2</input>
  <input type=radio name=12 value='B'>输出 2，返回 1</input>
  <input type=radio name=12 value='C'>输出 1，返回 1</input>
  <input type=radio name=12 value='D'>不输出，返回 2</input>

  <details open> 
    <summary><span class='correct'>对杀手而言，掉一点 SAN 值并不是什么大不了的事情。</span><span class='wrong'>眼前的世界逐渐转为黑白！</span></summary>
    <p>TODO</p>
  </details>
</form>

<b><span class="label-idx">13.</span>快醒醒！千万别大意！</b>

```js
;[
  // Killers have to be careful
  0.1 + 0.2 === 0.3,
  Number.MAX_SAFE_INTEGER === Number.MAX_SAFE_INTEGER + 1
]
```

<form id="js-100-13" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=13 value='A'>true,true</input>
  <input type=radio name=13 value='B'>true,false</input>
  <input type=radio name=13 value='C'>false,true</input>
  <input type=radio name=13 value='D'>false,false</input>

  <details open> 
    <summary><span class='correct'>显然，杀手也不会过于骄傲大意。</span><span class='wrong'>对面的大楼传来尖叫，有人发现了现场！</span></summary>
    <p>TODO</p>
  </details>
</form>

<b><span class="label-idx">14.</span>打开窗户，把目标绑起来运走！</b>

```js
window.glass = { exist: true }
target = function() {
  return this.exist
}
isExist = target.bind(window.glass)
delete window.glass
console.log(window.glass, isExist())
```

<form id="js-100-14" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=14 value='A'>undefined,undefined</input>
  <input type=radio name=14 value='B'>undefined,true</input>
  <input type=radio name=14 value='C'>true,true</input>
  <input type=radio name=14 value='D'>Error</input>

  <details open> 
    <summary><span class='correct'>轻而易举~</span><span class='wrong'>乏力使你头晕眼花，完全无法动手！</span></summary>
    <p>TODO</p>
  </details>
</form>

<b><span class="label-idx">15.</span>将行李放到后备箱，回家！</b>

```js
drivetime = 0
isArived = false
console.log('go')
setTimeout(() => (isArived = true), 1000 * 60 * 5 /* 5 minutes */)
while (++drivetime && !isArived) {}
console.log('home')
```

<form id="js-100-2" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=2 value='A'>'go','home'</input>
  <input type=radio name=2 value='B'>'go'</input>
  <input type=radio name=2 value='C'>'home'</input>
  <input type=radio name=2 value='D'>Empty Log</input>

  <details open> 
    <summary><span class='correct'>钥匙插上，回归 80 迈！</span><span class='wrong'>你靠在行李箱前呼呼喘气，街对面似乎传来警笛声。</span></summary>
    <p>TODO</p>
  </details>
</form>

<b><span class="label-idx">16.</span>开车时请务必确认好方向！</b>

```js
;[
  // Do not turn left or turn right.
  +0 === -0,
  String(+0) === String(-0),
  +0 * 'go home' === -0 * 'go home',
  1 / +0 === 1 / -0
].filter(Boolean).length
```

<form id="js-100-16" action="" onsubmit="return false">
  <label>请选择答案：</label>
  <input type=radio name=16 value='A'>0</input>
  <input type=radio name=16 value='B'>1</input>
  <input type=radio name=16 value='C'>2</input>
  <input type=radio name=16 value='D'>3</input>
  <details open> 
    <summary><span class='correct'>成功逃脱！</span><span class='wrong'>你迷失在了城市中混乱的车流里。</span></summary>
    <p>TODO</p>
  </details>
</form>

## 阅读更多

**wow，不错哟，居然成功从现场撤退了~**

如果你仍意犹未尽，可以试试这些难题（内内，别忘了先给我点赞投币关注三连呐）：

- [Javascript Quiz（2013）](http://perfectionkills.com/javascript-quiz/)
- [Javascript Puzzlers](http://javascript-puzzlers.herokuapp.com/)
