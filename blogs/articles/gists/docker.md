# Docker

## 基本概念

1. 隔离环境：虚拟文件系统；POSIX API；文件的只读和屏蔽；命名空间、环境变量等；
2. 生命周期：created、running、pausing、paused、stopped；可以通过 update 动态调整硬件资源使用率
3. 数据卷：数据卷由自己的独立的生命周期
4. 网络：独立的网络命名空间、共享其他实例的网络命名空间、共享主机的网络命名空间

## 架构

Docker 引擎实际上由 Dockerd、Containerd、RunC 等组件构成

Dockerd：容器管理 -> 编排管理和集群管理。它接受来自外部的 HTTP 请求并作为 API 调用执行，对内与 Containerd 进行通讯。

Containerd：对镜像、容器的管理提供了一个更进一步的抽象，提供了内容、快照、差异、容器、镜像、任务等更加细粒度的概念。

Container 包含 Containerd-shim，用于正确处理由操作系统发送过来的信号。

RunC：Containerd 提供的容器管理等 API 的执行者是 RunC。

## 原理

Docker 和虚拟机都希望能提供一个虚拟、完整、独立的运行时环境，通过提高虚拟环境的隔离型，以便管理。一般来说，虚拟机的原理是模拟硬件环境，所以需要安装客户端操作系统，而 Docker 并不需要这层客户端操作系统，所以 Docker 更加轻量，硬件利用率也更高。

利用操作系统的：文件系统、命名空间、控制组。
